(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41c9053c"],{"0003":function(t,e,a){},"001f":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAHk2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAxOC0wNy0xMlQwOTozOToyMCswODowMCIgeG1wOk1vZGlmeURhdGU9IjIwMTgtMDctMTJUMDk6NDM6MjQrMDg6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTgtMDctMTJUMDk6NDM6MjQrMDg6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Y2U5MTI4ZTEtMzU0ZS05ZTQzLWJlYTUtZDYzNDE1ZTRkOWY1IiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6NWRjNmQxMDUtZTU2NS1kZTQ2LWE0ZmEtMzdiNWM4OWI2MDhmIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YzUwMzFjYjItYzgxMy0zNTRhLWFiZmEtOWM4ZmFhNGIwOGU3Ij4gPHBob3Rvc2hvcDpEb2N1bWVudEFuY2VzdG9ycz4gPHJkZjpCYWc+IDxyZGY6bGk+N0E3ODRCOTQwMDJEMTY4ODVDNkM3MjQ1NEYwMEM4MDU8L3JkZjpsaT4gPHJkZjpsaT5EQTIxRjg4N0JDNDE4ODA0RDQzRjEzMzZCMzVBMjZGNzwvcmRmOmxpPiA8cmRmOmxpPmFkb2JlOmRvY2lkOnBob3Rvc2hvcDo2MmY0MDM0NC0xYzViLTJhNGEtOTU2Mi01OGZlMGZjMTk4Zjc8L3JkZjpsaT4gPHJkZjpsaT54bXAuZGlkOjE2M2Y2NGUyLTc3ZGItOTg0NC04ZjQ0LTY1YWQ3YzEzYzgxZjwvcmRmOmxpPiA8L3JkZjpCYWc+IDwvcGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmM1MDMxY2IyLWM4MTMtMzU0YS1hYmZhLTljOGZhYTRiMDhlNyIgc3RFdnQ6d2hlbj0iMjAxOC0wNy0xMlQwOTozOToyMCswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjZTkxMjhlMS0zNTRlLTllNDMtYmVhNS1kNjM0MTVlNGQ5ZjUiIHN0RXZ0OndoZW49IjIwMTgtMDctMTJUMDk6NDM6MjQrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+99Q8UQAABHdJREFUaN7tWmlsTVEQbsW+KxVB7PuSp7FLVcQSIX6QUMQWS+2pWBPLHyEhEcT2S5BYf2giBFEpglZjX4PaYispUvuuzxyZ1xxf5t57eu+7tyV+fOG1352Z73XOmTlzbkw4HI75FxDzXwgjJSXFK2YQThE+EMKMj4RMQurfICSBcFUL3go3CJ1LqpC+BgIQ/UuakF4Wge4hzCHMJuwi/BA48SVFSKIQ3AVCa8FuM8JZ4KaVBCHdBREq0Fgb27GEp/BMveIU0pVQAAGdtxOh2R8Bz00vLiGdhXxX6VRa/d7AfiXCZ+3ZzcUhpCPhO4i4TCgT4Rj6yNWe3xG0EFUnvoKIa4RyOs/AfmXCF83GpiCFhMB5pLBVQK6B/VFgZ2pQQtpBTivc4lyPcSHkGdiqE4SQttwn6Y7vEKoAbwUXPifbJ8DW3iDqSCto/BTuEqqBiFTt98Nt7B4DW2rni/NbSAvCO3D8kFADRMwSimJHwWa6wOvrd6+lWok34PQRoRaImC4Et1vxwN5RgTfE1+6XHDQh5IPTx4TaIGKaENwWXCP0+YjAG+rreYQcNCK8BqeqcNUBEVOE4LbirkX/PyTwhoHPLoTD0lpxK6IB4RU4fUGoCyImC8Ftx+2X/j0o8JJtUljthM09CSED9Ql54DSPf66LmCgEt0OoJfsF3kjw2VhI4QzXQlQLzd+8blClV0MIboIQ3E5DEaMNUli19gmuhHDaPAeD+fxt6cGNs9idUESawBsrpPBLaR26WiNcsXPB4D1CU4OFvQ04qn3fJ/DGgc+QkMI31RfqateiB/sJTs+oLhYq+waBNxdEVOXmUed8xSkJfR4o2Eq3O4g5iegjGMwUKvt6gTcPRKh+Kwc43zDX6fMAwVaG6zpCD/d0EsG8tQJvIYhQZ4rbwPmO7Yka+Qi2TrouiFyx8YydJfDWCI4XgYhK3MZjA9gJCqI06zrladLIDd8f0w6BM9NARAVeoDrnJ5/j9YLYW1qHnma/ZGABGLyOi4wbQnS8RBBxHTjqr9wNeEmCrSxPQ2zeGj9ACsQLYieB41UQXDk+n2OAPQwGdtkmYyInIclgdLlF6q0Enh5cWcIVIcBE4PUQOOcIpTxfK/DMVc/lGhZC5kMA4zk4dRq8JASYZDCw+z3risr9CHyT2TZbcysh2OPCoCDMCxkHdj+Bo8SXidpFD/RSWx2K5W6TqwCDgd3VSJcQTSF6l7nRQUisxYkuzOeGfsLA7puwI5aP+tUbH1ML7ysMG8rJPPHI4RRZLRywQsLUUdWXir7cIXIzWDgFidIQu73dwM4vIdg3hTwKUe3/J7uBnV9CcG9P9yCktcnAzrfraT4w6c7HuBDSkvAe7NwnVC/q7NeLEOkgNbgIQtQW+1aYOsa5GWJ77X73CGKWSfu9wUhUmjoGI4QDPC0E9YQbxEGEDrwjqb/gUosmUYmIt9sQAnmFgxwdcHGxH8FFQk2n7Tmwd1HI2WLhzsMJ60yvrQN9qYYr9XIuZAUWwT/gSUqborxE8P81p39VyC+nWIivxf5+ZwAAAABJRU5ErkJggg=="},"01a5":function(t,e,a){"use strict";var n=a("8ade"),i=a.n(n);i.a},"0227":function(t,e,a){"use strict";e["a"]={data:function(){return{}}}},"0496":function(t,e,a){var n=a("efe2");t.exports=function(t){return n((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},"0720":function(t,e,a){"use strict";(function(e){var n=a("2c23"),i=a("f62cd"),r=e.document,s=u,o=c,l=[];function u(t,e,a,n){return t.addEventListener(e,a,n)}function d(t,e,a){return t.attachEvent("on"+e,f(t,e,a))}function c(t,e,a,n){return t.removeEventListener(e,a,n)}function p(t,e,a){var n=m(t,e,a);if(n)return t.detachEvent("on"+e,n)}function h(t,e,a){var s=-1===i.indexOf(e)?l():o();function o(){var t;return r.createEvent?(t=r.createEvent("Event"),t.initEvent(e,!0,!0)):r.createEventObject&&(t=r.createEventObject()),t}function l(){return new n(e,{detail:a})}t.dispatchEvent?t.dispatchEvent(s):t.fireEvent("on"+e,s)}function g(t,a,n){return function(a){var i=a||e.event;i.target=i.target||i.srcElement,i.preventDefault=i.preventDefault||function(){i.returnValue=!1},i.stopPropagation=i.stopPropagation||function(){i.cancelBubble=!0},i.which=i.which||i.keyCode,n.call(t,i)}}function f(t,e,a){var n=m(t,e,a)||g(t,e,a);return l.push({wrapper:n,element:t,type:e,fn:a}),n}function m(t,e,a){var n=v(t,e,a);if(n){var i=l[n].wrapper;return l.splice(n,1),i}}function v(t,e,a){var n,i;for(n=0;n<l.length;n++)if(i=l[n],i.element===t&&i.type===e&&i.fn===a)return n}e.addEventListener||(s=d,o=p),t.exports={add:s,remove:o,fabricate:h}}).call(this,a("532c"))},"087f":function(t,e,a){},"0ada":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("bedb"),i=u(n),r=a("9acd"),s=u(r),o=a("8cea"),l=u(o);function u(t){return t&&t.__esModule?t:{default:t}}e.default={CanvasRenderer:i.default,SVGRenderer:s.default,ObjectRenderer:l.default}},"0b37":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=a("61b1"),r=u(i),s=a("0ada"),o=u(s),l=a("0bab");function u(t){return t&&t.__esModule?t:{default:t}}function d(t){if("string"===typeof t)return c(t);if(Array.isArray(t)){for(var e=[],a=0;a<t.length;a++)e.push(d(t[a]));return e}if("undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLImageElement)return p(t);if(t&&"svg"===t.nodeName||"undefined"!==typeof SVGElement&&t instanceof SVGElement)return{element:t,options:(0,r.default)(t),renderer:o.default.SVGRenderer};if("undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement)return{element:t,options:(0,r.default)(t),renderer:o.default.CanvasRenderer};if(t&&t.getContext)return{element:t,renderer:o.default.CanvasRenderer};if(t&&"object"===("undefined"===typeof t?"undefined":n(t))&&!t.nodeName)return{element:t,renderer:o.default.ObjectRenderer};throw new l.InvalidElementException}function c(t){var e=document.querySelectorAll(t);if(0!==e.length){for(var a=[],n=0;n<e.length;n++)a.push(d(e[n]));return a}}function p(t){var e=document.createElement("canvas");return{element:e,options:(0,r.default)(t),renderer:o.default.CanvasRenderer,afterRender:function(){t.setAttribute("src",e.toDataURL())}}}e.default=d},"0bab":function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function r(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(t,a){n(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.name="InvalidInputException",r.symbology=t,r.input=a,r.message='"'+r.input+'" is not a valid input for '+r.symbology,r}return r(e,t),e}(Error),o=function(t){function e(){n(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return r(e,t),e}(Error),l=function(t){function e(){n(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}return r(e,t),e}(Error);e.InvalidInputException=s,e.InvalidElementException=o,e.NoElementException=l},"0d91":function(t,e,a){"use strict";var n=a("8a35"),i=a.n(n);i.a},"0df1":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("eaf2"),r=s(i);function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){var e=t.substr(0,13).split("").map((function(t){return parseInt(t,10)})).reduce((function(t,e,a){return t+e*(3-a%2*2)}),0);return 10*Math.ceil(e/10)-e},c=function(t){function e(t,a){return o(this,e),-1!==t.search(/^[0-9]{13}$/)&&(t+=d(t)),l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a))}return u(e,t),n(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{14}$/)&&+this.data[13]===d(this.data)}}]),e}(r.default);e.default=c},"0e07":function(t,e,a){},"0fd3":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAkCAYAAAD7PHgWAAAFyklEQVRYR82Ya2wUVRTH/2emS7s7sw3yMiFASDAhsbwSPighNbtTKAEfAQJBgzE+ouIDEoFA3Wl1pZ0tyMOIQgJ+QEJMEFCihIjY3S2ElITYII0gGAEhJkrVQLuv0t29x8x0F0q7ZWcLLd5Pk5n/Oec393HuuZdQQJu7lYtvtkcqSSryMIvpIJoA5mEAhgCIAPgToHMMapKL5CMNa4t/KcB9TinZceCpT4yXWaxm5qUAhtqxsTREzQBvE53KnkY/pWzbdRPeFdDjb1WlYtUPIVYAcHSza2PGSZJwnhmtEtDJIDcI48A8FURTwSzf1vMlSZZWNFQphwuF7BPQY0SnSeADAE3I9EYSTF9CpHcNb1GP7d9P6b6CVQTahwPyIjCWMXjabR193pZ0vdXsp7hd0JyAmhGbC+AAwC5rpEDfyEJ652iN87Jdx1mdVh9fAOYtYB5vvWOcJsLcoK5es+OrF6DX6JhDSH3bNfEpTsRvBn3qbjvO+tJUbmQlnYpvZ8EvZDS/FnVy+dEP3K35/N4B6F0XKSOZmgCUMpCQwE8GdXc4nxO7372BmEHMvsyo/JhOusob/dRxN/tbgFYKicROAZgC0E0AC0K68p3d4HZ1WiBeDxZV1mgT7Qj7lGW2ADUjpgNc15UdaFnQp+ywG7RQnWbE9wDieRAxszQ7rDuDffmwerA8EBnpYOkSwCqAH0K6Wllo0EL0Hj+rkiN+FuBxAM6Fkspk+Enk8mEBakbMD/D7AASneUr4PffZQgL2R6vVxReDxL6uhS0tCesu67lnIzCTFohdBTDGTCdBXZnfn4CF2zBpRqwFwCQCnQjqSnlOQG8gPpNYnLA+Mj0TqlYOFR6sfxZaIPIGmLabkVNCnnA8R54lrxGrIfA6APFrSeWhs37q7F+4wq3MHYchX7O2RaLXQj7ls15DrNVFD4HwFAihkE+tKDzMvVlogWgLGJPB2BWqVl/uDWhEzwOYCNAnIV0xi4IBax4/l5AjvlkCXQrqrs3WAq2L7ATRq9Zq1tUy812FEX2Yga1EdIY0I3rdLKGYsTZcrX44YHQAvLWxeSSxVdEQYUvQp67SAvHVYLERwPWQrg6r3MijUp0xc/d6FMANE9Cccw4Cvx3U3dsGEnDGFnY6E9EgQDOykER0QQg2N4W0cGCMlKIGMJeBzGqJXyLNiEQAUhlYGdbVjwYS0PQ9cwO7i1PR77OQAH42U01XXPoN4EdMOIL0StDn3E1eI3qVgLHEHAhWu/WBBuwD8nbYbnAWsjcQDRPDA9CBkK4sHgzAPiF7wFmAFYHox8wwV+8fIV0dO1iAvSBzwGV6ML6QWHzVNWm5LOhznxtMSI+/fYTkkGvBdDRU7TrYKw8+5v+31OUo/osAJ8BGSHdXDyZgvlhWNVMRiO5lxhIwWhMuZfzJlZTIZzhY3y1AT13b4xLJJ81nhrQmrLvMxPm/aLdK/gojdoTBc8wbAkmWJzVUOc0S7IG3W4DeDR0TKZUy6zPzNNfUNsLlaX6dkg+a8I5TXYURX8UQmzJZ/WDbFdeS5p33F3L2htjoVGfaHa4pvWDn53uci80qN74P4EUZyK/brrievV+Qs+o7ZgmRMlOaQuSYEvQV501pvQ7uXcfPxGFAZGpDapLkm881VA27hznJVBFILOeuqsWcQh0Q8qRQTcnFfL2Y8+rD479cIjlGfQHwwoyDCEOqbU86txVyr2Laeutj00mwCebN+LrBxPPDPvexfHDW5tG3yDrUrGGglrI3W4xWkLRLQOxt1JUzAHEue7NiKRGJeYL5RTDPoWwcwulUmpcer3HbvjfMez9oXYcUyVvBQusB8zcDLQS6TMTtzOQAeCSIJoJ5MoCibvp2Bm1qH+FaX2hmyAuYDaKtTzyBtFgO4GmAi+0MD4DfAdotkulPG/2l/9i0uUNmGzBr5fFfH0pDijUJmAkWZUwYDUYpwEkC3RCMiyThJ4YUDr/rPGVWIP0By9r8B5TCYD7Tv+ZxAAAAAElFTkSuQmCC"},"11ae":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("b4fb"),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("fe59"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("b130"),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("ecb4"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("77ad"),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("513c"),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("e35a"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("90aa"),core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("f4e3"),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("5e9f"),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("08ba"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_10__),moment__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("35f4e"),moment__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_11__),_form_controller_plugins_formPluginBase__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("a05f");__webpack_exports__["a"]=Object(_form_controller_plugins_formPluginBase__WEBPACK_IMPORTED_MODULE_12__["b"])(_form_controller_plugins_formPluginBase__WEBPACK_IMPORTED_MODULE_12__["a"],{name:"dCalendar",data:{pickerOptionstime:{disabledDate:function(t){return!1}},nowPlugin:"",inRepeatKey:"",cyclictimeObj:{y:(new Date).getFullYear(),M:(new Date).getMonth(),d:(new Date).getDate()},moment:moment__WEBPACK_IMPORTED_MODULE_11___default.a,enMonth:{"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"}},props:["plugin","forminfo","ptablesendmessage"],created:function(){this.isInRepeat()},watch:{pluginData:function(t,e){this.updateData(t)},upData:function(){this.updateData(this.pluginData),this.updatefn()}},computed:{upData:function(){return this.pluginData.data}},methods:{isInRepeat:function(){var t=this,e=this.plugin.plugins,a=function(a){e.hasOwnProperty(a)&&a.includes("RepeatTable")&&(i=e[a].attr.data.tableData||e[a].attr.data,i.trs[1].tds.forEach((function(e){if(!e.dataid)return!1;t.plugin.rtplugins[e.dataid].key==t.pluginData.model&&(t.inRepeatKey=a)})))};for(var n in e){var i;a(n)}},updateData:function(t){this.updateClassData(t),this.updateTime()},updateDataTo:function(t){if(this.inRepeatKey){var e=0;e=this.pluginData.status.ispc?$('[data-key="'+this.pluginData.key+'"]').parents("tr").index()-2:$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow").index(),this.$emit("ptablesendmessage",{type:"resetRtable",method:"setCPlugin",key:this.inRepeatKey,targetColumn:1,rownum:e,ckey:this.pluginData.attr.data.thistimeBind,data:t})}else this.plugin.plugins[this.pluginData.attr.data.thistimeBind].data=t,this.postMessage(this.plugin.plugins[this.pluginData.attr.data.thistimeBind])},totopvalue:function(t){var e=this.plugin.plugins;if(this.inRepeatKey?this.pluginData.status.ispc?this.nowPlugin=this.pluginData.attr.data.thistimeBind&&e[this.inRepeatKey].data[$('[data-key="'+this.pluginData.key+'"]').parents("tr").index()-2][this.pluginData.attr.data.thistimeBind]:this.nowPlugin=this.pluginData.attr.data.thistimeBind&&e[this.inRepeatKey].data[$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow").index()][this.pluginData.attr.data.thistimeBind]:this.nowPlugin=this.pluginData.attr.data.thistimeBind&&this.allplugin.plugins[this.pluginData.attr.data.thistimeBind].data,this.pluginData.attr.data.thistimeType&&this.pluginData.attr.data.thistimeBind&&(this.allplugin.plugins[this.pluginData.attr.data.thistimeBind]||this.allplugin.rtplugins[this.pluginData.attr.data.thistimeBind])&&"start"==this.pluginData.attr.data.thistimeType&&this.nowPlugin){if(moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).isBefore(this.pluginData.data))return this.nowPlugin=moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data).add(+this.pluginData.attr.data.thistimeMin+1,"days").format(),this.updateDataTo(this.nowPlugin),!1;if(this.pluginData.attr.data.thistimeMin&&this.pluginData.attr.data.thistimeMax&&!moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).isBetween(moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data).add(this.pluginData.attr.data.thistimeMin-1,"days").format(),moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data).add(+this.pluginData.attr.data.thistimeMax+1,"days").format()))return this.nowPlugin=moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data).add(+this.pluginData.attr.data.thistimeMin+1,"days").format(),this.updateDataTo(this.nowPlugin),!1;if(this.pluginData.attr.data.thistimeMin&&!this.pluginData.attr.data.thistimeMax&&!moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).isAfter(moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data).add(this.pluginData.attr.data.thistimeMin-1,"days").format()))return this.nowPlugin=moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data).add(+this.pluginData.attr.data.thistimeMin+1,"days").format(),this.updateDataTo(this.nowPlugin),!1;if(!this.pluginData.attr.data.thistimeMin&&this.pluginData.attr.data.thistimeMax&&!moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).isBefore(moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data).add(+this.pluginData.attr.data.thistimeMax+2,"days").format()))return this.nowPlugin=moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data).add(+this.pluginData.attr.data.thistimeMin+1,"days").format(),this.updateDataTo(this.nowPlugin),!1}if(this.pluginData.attr.data.thistimeType&&this.pluginData.attr.data.thistimeBind&&(this.allplugin.plugins[this.pluginData.attr.data.thistimeBind]||this.allplugin.rtplugins[this.pluginData.attr.data.thistimeBind])&&"end"==this.pluginData.attr.data.thistimeType&&this.nowPlugin){if(1==this.pluginData.attr.data.thistimeMin&&1==this.pluginData.attr.data.thistimeMax)var a=86400;else a=0;if(moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data).isBefore(this.nowPlugin))return!t&&this.$message({message:"开始时间不能大于结束时间",type:"warning"}),this.pluginData.data=null,this.postMessage(this.pluginData),!1;if(this.pluginData.attr.data.thistimeMin&&this.pluginData.attr.data.thistimeMax&&!moment__WEBPACK_IMPORTED_MODULE_11___default()(Date.parse(this.pluginData.data)).isBetween(moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).add(24*this.pluginData.attr.data.thistimeMin*60*60-a-1,"seconds").format(),moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).add(24*this.pluginData.attr.data.thistimeMax*60*60+1,"seconds").format()))return!t&&this.$message({message:"结束时间范围只能在：（开始时间+".concat(this.pluginData.attr.data.thistimeMin,"天）~（开始时间+").concat(this.pluginData.attr.data.thistimeMax,"天）"),type:"warning"}),this.pluginData.data=null,this.postMessage(this.pluginData),!1;if(this.pluginData.attr.data.thistimeMin&&!this.pluginData.attr.data.thistimeMax&&!moment__WEBPACK_IMPORTED_MODULE_11___default()(Date.parse(this.pluginData.data)).isAfter(moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).add(24*this.pluginData.attr.data.thistimeMin*60*60-1,"seconds").format()))return!t&&this.$message({message:"结束时间范围只能在：（开始时间+".concat(this.pluginData.attr.data.thistimeMin,"天）之后"),type:"warning"}),this.pluginData.data=null,this.postMessage(this.pluginData),!1;if(!this.pluginData.attr.data.thistimeMin&&this.pluginData.attr.data.thistimeMax&&!moment__WEBPACK_IMPORTED_MODULE_11___default()(Date.parse(this.pluginData.data)).isBefore(moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).add(24*+this.pluginData.attr.data.thistimeMax*60*60+1,"seconds").format()))return!t&&this.$message({message:"结束时间范围只能在：（开始时间+".concat(this.pluginData.attr.data.thistimeMax,"天）之前"),type:"warning"}),this.pluginData.data=null,this.postMessage(this.pluginData),!1;if(0<new Date(this.pluginData.data).getTime()-new Date(this.nowPlugin).getTime()&&new Date(this.pluginData.data).getTime()-new Date(this.nowPlugin).getTime()<6e4)return!t&&this.$message({message:"开始时间不能等于结束时间",type:"warning"}),this.pluginData.data=null,this.postMessage(this.pluginData),!1}return 0==this.pluginData.status.modeedit&&this.$emit("sendmessage",this.pluginData),!0},returnweekdata:function(t){if(null==t||void 0==t||""==t)return" ";if(-1!==JSON.stringify(t).indexOf("T"))t=new Date(t);else{if(isNaN(t)||!(Number(t)>1e8))return t;t=1e3*Number(t)}var e=this.pluginData.attr.data.dateformat.replace("yyyy","YYYY").replace("dd","DD");return t=moment__WEBPACK_IMPORTED_MODULE_11___default()(t).format(e),"MM dd, yyyy"===this.pluginData.attr.data.dateformat?this.enMonth[t.slice(0,2)]+t.slice(2):t},updateTime:function(){if(this.pluginData.data instanceof Date)return!1;if(0==this.pluginData.status.formmodeedit&&!isNaN(this.pluginData.data)&&this.pluginData.data>1e9&&"thistime"==this.pluginData.attr.data.defaulttime){var t=new Date;t.setTime(1e3*this.pluginData.data),this.pluginData.data=t}else if("string"==typeof this.pluginData.data&&-1==JSON.stringify(this.pluginData.data).indexOf("T")&&isNaN(this.pluginData.data)){var e=this.pluginData.attr.data.dateformat.replace("yyyy","YYYY").replace("dd","DD"),a=moment__WEBPACK_IMPORTED_MODULE_11___default()(this.pluginData.data,e);this.$set(this.pluginData,"data",new Date(a))}},handleTime:function handleTime(){var _this=this;if(!this.pluginData.status.formmodeedit&&!this.pluginData.data){var dateformat=this.pluginData.attr.data.dateformat.replace("yyyy","YYYY").replace("dd","DD");if("delayedtime"==this.pluginData.attr.data.defaulttime)this.pluginData.data=moment__WEBPACK_IMPORTED_MODULE_11___default()().add(+this.pluginData.attr.data.delayedtimeDays,"days").format(dateformat),this.postMessage(this.pluginData);else if("cyclictime"==this.pluginData.attr.data.defaulttime){var y="",m="",d="",_this$pluginData$attr=this.pluginData.attr.data,cyclictimeY=_this$pluginData$attr.cyclictimeY,cyclictimeM=_this$pluginData$attr.cyclictimeM,cyclictimeD=_this$pluginData$attr.cyclictimeD;y=this.cyclictimeSet(cyclictimeY,"y"),m=this.cyclictimeSet(cyclictimeM,"M"),d=this.cyclictimeSet(cyclictimeD,"d"),this.pluginData.data=eval("_this.moment(".concat(JSON.stringify(this.cyclictimeObj),")").concat(y).concat(m).concat(d,".format('").concat(dateformat,"')")),this.postMessage(this.pluginData)}}},cyclictimeSet:function(t,e){if(!t)return"";if(isNaN(+t)){var a=+t.match("\\{(.+?)\\}")[1];return a<0?".subtract(".concat(Math.abs(a),", '").concat(n(e),"')"):".add(".concat(a,", '").concat(n(e),"')")}return this.cyclictimeObj[e]="M"==e?t-1:t,"";function n(t){switch(t){case"y":return"year";case"M":return"months";case"d":return"days"}}},handleCurrentTime:function(){this.pluginData.status.formmodeedit&&!this.pluginData.data||this.pluginData.attr.data.thistimeBind&&this.pluginData.attr.data.thistimeType&&this.pluginData.attr.data.thistimeMin&&"start"==this.pluginData.attr.data.thistimeType&&(this.totopvalue()||(this.pluginData.data=moment__WEBPACK_IMPORTED_MODULE_11___default()().add(+this.pluginData.attr.data.thistimeMin,"days").format()))},blurFn:function(){this.$i18n.locale="zh"},focus:function(){var t=this.plugin.plugins;this.inRepeatKey?this.pluginData.status.ispc?this.nowPlugin=this.pluginData.attr.data.thistimeBind&&t[this.inRepeatKey].data[$('[data-key="'+this.pluginData.key+'"]').parents("tr").index()-2][this.pluginData.attr.data.thistimeBind]:this.nowPlugin=this.pluginData.attr.data.thistimeBind&&t[this.inRepeatKey].data[$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow").index()][this.pluginData.attr.data.thistimeBind]:this.nowPlugin=this.pluginData.attr.data.thistimeBind&&this.allplugin.plugins[this.pluginData.attr.data.thistimeBind].data;var e=this;if("en"==this.pluginData.attr.data.languageType?this.$i18n.locale="en":this.$i18n.locale="zh",this.pluginData.attr.data.thistimeType&&this.pluginData.attr.data.thistimeBind&&(this.allplugin.plugins[this.pluginData.attr.data.thistimeBind]||this.allplugin.rtplugins[this.pluginData.attr.data.thistimeBind])&&"end"==this.pluginData.attr.data.thistimeType)if(this.nowPlugin){var a=moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).valueOf(),n=moment__WEBPACK_IMPORTED_MODULE_11___default()(this.nowPlugin).hours();if(n>0)var i=0;else i=1;this.pickerOptionstime={disabledDate:function(t){if(e.pluginData.attr.data.thistimeMin&&e.pluginData.attr.data.thistimeMax){var n=t.getTime()>a+864e5*(Number(e.pluginData.attr.data.thistimeMin)-1)&&t.getTime()<a+864e5*(Number(e.pluginData.attr.data.thistimeMax)+i);return!n}if(e.pluginData.attr.data.thistimeMin&&!e.pluginData.attr.data.thistimeMax){n=t.getTime()>a+864e5*(Number(e.pluginData.attr.data.thistimeMin)-1);return!n}if(!e.pluginData.attr.data.thistimeMin&&e.pluginData.attr.data.thistimeMax){n=t.getTime()>a+864e5*(Number(e.pluginData.attr.data.thistimeMin)-1)&&t.getTime()<a+864e5*(Number(e.pluginData.attr.data.thistimeMax)+i);return!n}n=t.getTime()>a+864e5*(Number(e.pluginData.attr.data.thistimeMin)-1);return!n}}}else this.pickerOptionstime={disabledDate:function(t){return!1}}},disableTypeFn:function(t){var e=!0,a=["/v2/matter/start","/v2/matter/startStep","/v2/matter/m_startStep","/v2/matter/m_start","/v2/form/formpreview"].includes(window.location.pathname),n=t;n.getFullYear(),n.getMonth(),n.getMonth(),n.getDate(),n.getDate();if("relative"==this.pluginData.attr.data.disableType){var i=a?moment__WEBPACK_IMPORTED_MODULE_11___default()(moment__WEBPACK_IMPORTED_MODULE_11___default()().format("YYYY-MM-DD")).valueOf():new Date(window.localStorage.getItem("createdTime")).getTime();String(this.pluginData.attr.data.beforeDays).length&&String(this.pluginData.attr.data.laterDays).length?e=t.getTime()>=i-864e5*Number(this.pluginData.attr.data.beforeDays)&&t.getTime()<=i+864e5*Number(this.pluginData.attr.data.laterDays):String(this.pluginData.attr.data.beforeDays).length?e=t.getTime()>=i-864e5*Number(this.pluginData.attr.data.beforeDays):String(this.pluginData.attr.data.laterDays).length&&(e=t.getTime()<=i+864e5*Number(this.pluginData.attr.data.laterDays))}else"absolute"==this.pluginData.attr.data.disableType&&(this.pluginData.attr.data.beforeTime&&this.pluginData.attr.data.laterTime?e=t.getTime()>=new Date(this.pluginData.attr.data.beforeTime).getTime()&&t.getTime()<=new Date(this.pluginData.attr.data.laterTime).getTime():this.pluginData.attr.data.beforeTime?e=t.getTime()>=new Date(this.pluginData.attr.data.beforeTime).getTime():this.pluginData.attr.data.laterTime&&(e=t.getTime()<=new Date(this.pluginData.attr.data.laterTime).getTime()));return!e},reTableThistime:function(){this.pluginData.status.formmodeedit||this.pluginData.data||!this.pluginData.pkey||(this.pluginData.data=moment__WEBPACK_IMPORTED_MODULE_11___default()().format(),this.postMessage(this.pluginData))},updatefn:function(){this.pluginData.status.modeedit||this.$emit("sendmessage",this.pluginData)}},mounted:function(){var t=this,e=this;e.pickerOptionstime={disabledDate:function(t){if(e.pluginData.attr.data.disableType)return e.disableTypeFn(t);if("notime"==e.pluginData.attr.data.defaulttime&&1==e.pluginData.attr.data.editappro){if(""!=e.pluginData.attr.data.datarange[0]&&""!=e.pluginData.attr.data.datarange[1]){var a=t.getTime()>Date.now()+864e5*Number(e.pluginData.attr.data.datarange[0])-1728e5&&t.getTime()<Date.now()+864e5*Number(e.pluginData.attr.data.datarange[1])-864e5;return!a}return!1}return!1}},this.handleTime(),this.handleCurrentTime(),this.updateData(this.pluginData),"date"==this.pluginData.attr.data.datetype&&this.pluginData.data&&!this.pluginData.status.readonly&&window.setTimeout((function(){t.pluginData.data=moment__WEBPACK_IMPORTED_MODULE_11___default()(moment__WEBPACK_IMPORTED_MODULE_11___default()(new Date(t.pluginData.data)).format("YYYY-MM-DD 00:00:00")).format()}),50)},destroyed:function(){this.plugin.plugins;if(this.inRepeatKey)this.allplugin.rtplugins[this.pluginData.attr.data.thistimeBind];else this.allplugin.plugins[this.pluginData.attr.data.thistimeBind]&&this.allplugin.plugins[this.pluginData.attr.data.thistimeBind];this.pluginData.status.formmodeedit&&"thistime"==this.pluginData.attr.data.defaulttime&&this.pluginData.attr.data.thistimeBind&&this.pluginData.attr.data.thistimeType&&!this.allplugin.plugins[this.pluginData.key]&&(this.allplugin.plugins[this.pluginData.attr.data.thistimeBind]||this.allplugin.rtplugins[this.pluginData.attr.data.thistimeBind])&&(nowPlugin.attr.data.thistimeType="",nowPlugin.attr.data.thistimeBind="",nowPlugin.attr.data.thistimeMin="",nowPlugin.attr.data.thistimeMax="",this.$emit("sendmessage",nowPlugin))}})},"133e":function(t,e,a){},1458:function(t,e,a){"use strict";var n=a("1c8b"),i=a("aa6b").f,r=a("d88d"),s=a("07a2"),o=a("2732"),l=a("783d"),u=a("9b9d"),d="".endsWith,c=Math.min,p=l("endsWith"),h=!u&&!p&&!!function(){var t=i(String.prototype,"endsWith");return t&&!t.writable}();n({target:"String",proto:!0,forced:!h&&!p},{endsWith:function(t){var e=String(o(this));s(t);var a=arguments.length>1?arguments[1]:void 0,n=r(e.length),i=void 0===a?n:c(r(a),n),l=String(t);return d?d.call(e,l,i):e.slice(i-l.length,i)===l}})},"152b":function(module,exports,__webpack_require__){__webpack_require__("ecb4"),__webpack_require__("9302"),__webpack_require__("053b"),__webpack_require__("84c2"),__webpack_require__("e35a"),__webpack_require__("1c2e"),__webpack_require__("5e9f");var $=__webpack_require__("a336"),ksH5upload=function(t){this.options={upload_url:"",file_post_name:"ksFiledata",post_params:{},file_types:["*"],file_size_limit:"0",auto_upload:!0,button_placeholder_id:"ksUploadButton",uploadInputId:"ksH5UploadInput",uploadInputBox:"ksH5UploadInputBox",fileKeyPrefix:"ksH5Upload_",file_queue_before:function(){},file_queued_handler:function(){},file_queue_error_handler:function(){},upload_start_handler:function(){},upload_progress_handler:function(){},upload_error_handler:function(){},upload_success_handler:function(){},upload_complete_handler:function(){}},this.locked=!1,this.movenum=0,this.queueArr=[],this.uploading={},this.xhr=null,this.init(t)};ksH5upload.prototype.msg={"-110":"文件大小超过限制","-130":"文件类型错误","-140":"文件上传失败","-150":"没有选择可上传文件"},ksH5upload.prototype.file_queue_before=function(){return!1!==this.options.file_queue_before()},ksH5upload.prototype.file_queued=function(t){if(!1===this.options.file_queued_handler(t))return!1;this.queueArr.push(t),this.options.auto_upload&&this.startUpload()},ksH5upload.prototype.file_queue_error=function(t,e){this.options.file_queue_error_handler(this.msg[e])},ksH5upload.prototype.upload_start=function(t){this.options.upload_start_handler(t),this.uploading=t},ksH5upload.prototype.upload_progress=function(t,e,a){this.options.upload_progress_handler(t,e,a)},ksH5upload.prototype.upload_error=function(t,e){this.options.upload_error_handler(this.msg[e],t)},ksH5upload.prototype.upload_success=function(t,e){this.options.upload_success_handler(t,e)},ksH5upload.prototype.upload_complete=function(t){this.options.upload_complete_handler(t),this.uploading={},this.loadInput(),this.queueArr.length&&this.startUpload(!0)},ksH5upload.prototype.remove=function(t){if(t==this.uploading.id)this.xhr.abort();else{var e=[];for(var a in this.queueArr)t!=this.queueArr.id&&e.push(this.queueArr[a]);this.queueArr=e}this.queueArr.length&&this.startUpload(!0)},ksH5upload.prototype.init=function(t){if(!this.checkhtml5())return console.error("当前浏览器不支持h5文件上传插件"),!1;if(!t.upload_url)return console.error("缺少必要参数"),!1;for(var e in this.options)void 0!==t[e]&&(this.options[e]=t[e]);for(var a in this.options.uploadInputId+=this.options.button_placeholder_id+Math.floor(1e4*Math.random()),this.options.uploadInputBox+=this.options.button_placeholder_id,this.msg)void 0!==t.msg[a]&&(this.msg[a]=t.msg[a]);this.loadHtml(),this.loadEvent()},ksH5upload.prototype.loadHtml=function(){$("#"+this.options.button_placeholder_id).length||console.error("html id '"+this.options.button_placeholder_id+"' 不存在"),$("#"+this.options.uploadInputBox).length||$("body").append("<div id='"+this.options.uploadInputBox+"' style='width:0px;height:0px;overflow:hidden'></div>"),this.loadInput()},ksH5upload.prototype.loadInput=function(){var t=$("#"+this.options.uploadInputBox);t.html(""),t.append("<input id='"+this.options.uploadInputId+"' name='"+this.options.file_post_name+"' type='file' />")},ksH5upload.prototype.loadEvent=function(){var t=this;$("#"+this.options.button_placeholder_id).click((function(){if(!t.file_queue_before())return!1;$("#"+t.options.uploadInputId).trigger("click")})),$(document).on("change","#"+this.options.uploadInputId,(function(e){var a=void 0!==e.target.files?e.target.files[0]:e.target.value?{name:e.target.value.replace(/^.+\\/,"")}:null;if(a.id=t.options.fileKeyPrefix+t.movenum,t.movenum++,!t.checkFile(a))return!1;t.file_queued(a)}))},ksH5upload.prototype.checkFile=function(t){var e="\\.("+this.options.file_types.join("|")+")",a=new RegExp(e,"i");if(!a.test("name"+t.name))return this.file_queue_error(t,"-130"),!1;var n=-1!==this.options.file_size_limit.indexOf("M")?1024*parseInt(this.options.file_size_limit.replace("M",""))*1024:parseInt(this.options.file_size_limit);return!(n<t.size)||(this.file_queue_error(t,"-110"),!1)},ksH5upload.prototype.checkhtml5=function(){var t=!1;return void 0!==window.FileReader&&void 0!==window.FormData&&(t=!0),t},ksH5upload.prototype.startUpload=function(){var _this=this;if(_this.locked)return!1;_this.locked=!0;var uploadFile=_this.queueArr.shift(),formdata=new FormData;if(!uploadFile)return _this.upload_error(uploadFile,"-150"),!1;for(var name in this.options.post_params)formdata.append(name,_this.options.post_params[name]);formdata.append(_this.options.file_post_name,uploadFile),_this.upload_start(uploadFile),this.xhr=void 0!==XMLHttpRequest?new XMLHttpRequest:new ActiveXObject,this.xhr.open("POST",_this.options.upload_url,!0),this.xhr.withCredentials=!0,this.xhr.upload.addEventListener("progress",(function(t){_this.upload_progress(uploadFile,t.loaded,t.total)})),this.xhr.send(formdata),this.xhr.onreadystatechange=function(e){4==_this.xhr.readyState&&(_this.locked=!1,200==_this.xhr.status?(_this.upload_success(uploadFile,eval("("+_this.xhr.responseText+")")),_this.upload_complete(uploadFile)):(0==_this.xhr.status||_this.upload_error(uploadFile,"-140"),_this.upload_complete(uploadFile)))},this.xhr.onerror=function(t){_this.locked=!1,_this.upload_error(uploadFile,"-140"),_this.upload_complete(uploadFile)}},module.exports=ksH5upload},"16e4":function(t,e,a){},"18af":function(t,e,a){"use strict";var n=a("1c8b"),i=a("5197"),r=a("0496");n({target:"String",proto:!0,forced:r("strike")},{strike:function(){return i(this,"strike","","")}})},"19fc":function(t,e,a){"use strict";var n=a("3553"),i=a("e1d6"),r=a("d88d"),s=Math.min;t.exports=[].copyWithin||function(t,e){var a=n(this),o=r(a.length),l=i(t,o),u=i(e,o),d=arguments.length>2?arguments[2]:void 0,c=s((void 0===d?o:i(d,o))-u,o-l),p=1;u<l&&l<u+c&&(p=-1,u+=c-1,l+=c-1);while(c-- >0)u in a?a[l]=a[u]:delete a[l],l+=p,u+=p;return a}},"1b84":function(t,e,a){"use strict";var n=a("8216"),i=a("be57");t.exports=n("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),i)},"1bb1":function(t,e,a){"use strict";var n=a("d890"),i=a("5a9e"),r=a("efe2"),s=n.Int8Array,o=i.aTypedArray,l=i.exportTypedArrayMethod,u=[].toLocaleString,d=[].slice,c=!!s&&r((function(){u.call(new s(1))})),p=r((function(){return[1,2].toLocaleString()!=new s([1,2]).toLocaleString()}))||!r((function(){s.prototype.toLocaleString.call([1,2])}));l("toLocaleString",(function(){return u.apply(c?d.call(o(this)):o(this),arguments)}),p)},"1c0a":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();e.checksum=h;var i=a("bdd1"),r=l(i),s=a("2986"),o=l(s);function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function c(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var p=function(t){function e(t,a){u(this,e),-1!==t.search(/^[0-9]{11}$/)&&(t+=h(t));var n=d(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a));return n.displayValue=a.displayValue,a.fontSize>10*a.width?n.fontSize=10*a.width:n.fontSize=a.fontSize,n.guardHeight=a.height+n.fontSize/2+a.textMargin,n}return c(e,t),n(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{12}$/)&&this.data[11]==h(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var t="";return t+="101",t+=(0,r.default)(this.data.substr(0,6),"LLLLLL"),t+="01010",t+=(0,r.default)(this.data.substr(6,6),"RRRRRR"),t+="101",{data:t,text:this.text}}},{key:"guardedEncoding",value:function(){var t=[];return this.displayValue&&t.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),t.push({data:"101"+(0,r.default)(this.data[0],"L"),options:{height:this.guardHeight}}),t.push({data:(0,r.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),t.push({data:"01010",options:{height:this.guardHeight}}),t.push({data:(0,r.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),t.push({data:(0,r.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&t.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),t}}]),e}(o.default);function h(t){var e,a=0;for(e=1;e<11;e+=2)a+=parseInt(t[e]);for(e=0;e<11;e+=2)a+=3*parseInt(t[e]);return(10-a%10)%10}e.default=p},"1c2e9":function(t,e,a){"use strict";var n=a("d890"),i=a("1e2c"),r=a("d77f"),s=a("0fc1"),o=a("99ab"),l=a("efe2"),u=a("c4e4"),d=a("3da3"),c=a("d88d"),p=a("3ccd"),h=a("e026"),g=a("908e"),f=a("50fb"),m=a("b338").f,v=a("d910").f,b=a("fa41"),y=a("27b5"),_=a("b702"),D=_.get,C=_.set,w="ArrayBuffer",x="DataView",k="prototype",S="Wrong length",A="Wrong index",E=n[w],T=E,I=n[x],P=I&&I[k],N=Object.prototype,R=n.RangeError,B=h.pack,O=h.unpack,M=function(t){return[255&t]},L=function(t){return[255&t,t>>8&255]},U=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},F=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},$=function(t){return B(t,23,4)},H=function(t){return B(t,52,8)},j=function(t,e){v(t[k],e,{get:function(){return D(this)[e]}})},W=function(t,e,a,n){var i=p(a),r=D(t);if(i+e>r.byteLength)throw R(A);var s=D(r.buffer).bytes,o=i+r.byteOffset,l=s.slice(o,o+e);return n?l:l.reverse()},z=function(t,e,a,n,i,r){var s=p(a),o=D(t);if(s+e>o.byteLength)throw R(A);for(var l=D(o.buffer).bytes,u=s+o.byteOffset,d=n(+i),c=0;c<e;c++)l[u+c]=d[r?c:e-c-1]};if(r){if(!l((function(){E(1)}))||!l((function(){new E(-1)}))||l((function(){return new E,new E(1.5),new E(NaN),E.name!=w}))){T=function(t){return u(this,T),new E(p(t))};for(var V,q=T[k]=E[k],G=m(E),K=0;G.length>K;)(V=G[K++])in T||s(T,V,E[V]);q.constructor=T}f&&g(P)!==N&&f(P,N);var X=new I(new T(2)),Y=P.setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||o(P,{setInt8:function(t,e){Y.call(this,t,e<<24>>24)},setUint8:function(t,e){Y.call(this,t,e<<24>>24)}},{unsafe:!0})}else T=function(t){u(this,T,w);var e=p(t);C(this,{bytes:b.call(new Array(e),0),byteLength:e}),i||(this.byteLength=e)},I=function(t,e,a){u(this,I,x),u(t,T,x);var n=D(t).byteLength,r=d(e);if(r<0||r>n)throw R("Wrong offset");if(a=void 0===a?n-r:c(a),r+a>n)throw R(S);C(this,{buffer:t,byteLength:a,byteOffset:r}),i||(this.buffer=t,this.byteLength=a,this.byteOffset=r)},i&&(j(T,"byteLength"),j(I,"buffer"),j(I,"byteLength"),j(I,"byteOffset")),o(I[k],{getInt8:function(t){return W(this,1,t)[0]<<24>>24},getUint8:function(t){return W(this,1,t)[0]},getInt16:function(t){var e=W(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=W(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return F(W(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return F(W(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return O(W(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return O(W(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){z(this,1,t,M,e)},setUint8:function(t,e){z(this,1,t,M,e)},setInt16:function(t,e){z(this,2,t,L,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){z(this,2,t,L,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){z(this,4,t,U,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){z(this,4,t,U,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){z(this,4,t,$,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){z(this,8,t,H,e,arguments.length>2?arguments[2]:void 0)}});y(T,w),y(I,x),t.exports={ArrayBuffer:T,DataView:I}},"1cc1":function(t,e,a){"use strict";var n=a("5a9e"),i=a("5dfd").find,r=n.aTypedArray,s=n.exportTypedArrayMethod;s("find",(function(t){return i(r(this),t,arguments.length>1?arguments[1]:void 0)}))},"20a5":function(t,e,a){"use strict";var n=a("1c8b"),i=a("3da3"),r=a("e1d9"),s=a("c7e6"),o=a("efe2"),l=1..toFixed,u=Math.floor,d=function(t,e,a){return 0===e?a:e%2===1?d(t,e-1,a*t):d(t*t,e/2,a)},c=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},p=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){l.call({})}));n({target:"Number",proto:!0,forced:p},{toFixed:function(t){var e,a,n,o,l=r(this),p=i(t),h=[0,0,0,0,0,0],g="",f="0",m=function(t,e){var a=-1,n=e;while(++a<6)n+=t*h[a],h[a]=n%1e7,n=u(n/1e7)},v=function(t){var e=6,a=0;while(--e>=0)a+=h[e],h[e]=u(a/t),a=a%t*1e7},b=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==h[t]){var a=String(h[t]);e=""===e?a:e+s.call("0",7-a.length)+a}return e};if(p<0||p>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(e=c(l*d(2,69,1))-69,a=e<0?l*d(2,-e,1):l/d(2,e,1),a*=4503599627370496,e=52-e,e>0){m(0,a),n=p;while(n>=7)m(1e7,0),n-=7;m(d(10,n,1),0),n=e-1;while(n>=23)v(1<<23),n-=23;v(1<<n),m(1,1),v(2),f=b()}else m(0,a),m(1<<-e,0),f=b()+s.call("0",p);return p>0?(o=f.length,f=g+(o<=p?"0."+s.call("0",p-o)+f:f.slice(0,o-p)+"."+f.slice(o-p))):f=g+f,f}})},"20c5":function(t,e,a){a("9302"),a("e35a"),a("5e9f"),a("0d7a"),function(){window.UEDITOR_HOME_URL="/v2/static/ueditor/";var t=window.UEDITOR_HOME_URL||e();function e(t,e){return n(t||self.document.URL||self.location.href,e||a())}function a(){var t=document.getElementsByTagName("script");return t[t.length-1].src}function n(t,e){var a=e;return/^(\/|\\\\)/.test(e)?a=/^.+?\w(\/|\\\\)/.exec(t)[0]+e.replace(/^(\/|\\\\)/,""):/^[a-z]+:/i.test(e)||(t=t.split("#")[0].split("?")[0].replace(/[^\\\/]+$/,""),a=t+""+e),i(a)}function i(t){var e=/^[a-z]+:\/\//.exec(t)[0],a=null,n=[];t=t.replace(e,"").split("?")[0].split("#")[0],t=t.replace(/\\/g,"/").split(/\//),t[t.length-1]="";while(t.length)".."===(a=t.shift())?n.pop():"."!==a&&n.push(a);return e+n.join("/")}"undefined"===typeof location.origin?(location.protocol,location.host):window.location.origin,window.UEDITOR_CONFIG={UEDITOR_HOME_URL:t,serverUrl:appConfig.apiBaseUrl+"/api/upload/index",toolbars:[["fullscreen","source","|","bold","italic","underline","fontborder","strikethrough","forecolor","backcolor","insertorderedlist","insertunorderedlist","selectall","cleardoc","|","rowspacingtop","rowspacingbottom","lineheight","|","fontfamily","fontsize","|","justifyleft","justifycenter","justifyright","justifyjustify","|","touppercase","tolowercase","|","imagenone","imageleft","imageright","imagecenter","|","simpleupload","attachment","link"]],enableAutoSave:!1,saveInterval:0,fontfamily:[{label:"",name:"songti",val:"宋体,SimSun"},{label:"",name:"kaiti",val:"楷体, SimKai"},{label:"",name:"yahei",val:"微软雅黑,Microsoft YaHei"},{label:"",name:"heiti",val:"黑体, SimHei"},{label:"",name:"lishu",val:"隶书, SimLi"},{label:"",name:"andaleMono",val:"andale mono"},{label:"",name:"arial",val:"arial, helvetica,sans-serif"},{label:"",name:"arialBlack",val:"arial black,avant garde"},{label:"",name:"comicSansMs",val:"comic sans ms"},{label:"",name:"impact",val:"impact,chicago"},{label:"",name:"timesNewRoman",val:"times new roman"},{label:"",name:"FangSong",val:"仿宋, FangSong"},{label:"",name:"FangSong_GB2312",val:"仿宋gb2312, FangSong_GB2312"},{label:"",name:"FZXiaoBiaoSong-B05S",val:"方正小宋简体, FZXiaoBiaoSong-B05S"},{label:"",name:"STZhongsong",val:"华文中宋, STZhongsong"},{label:"",name:"kaiti_GB2312",val:"楷体gb2312, kaiti_GB2312"}],xssFilterRules:!0,inputXssFilter:!0,outputXssFilter:!0,whitList:{a:["target","href","title","class","style"],abbr:["title","class","style"],address:["class","style"],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src","class","style"],b:["class","style"],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite","class","style"],br:[],caption:["class","style"],center:[],cite:[],code:["class","style"],col:["align","valign","span","width","class","style"],colgroup:["align","valign","span","width","class","style"],dd:["class","style"],del:["datetime"],details:["open"],div:["class","style"],dl:["class","style"],dt:["class","style"],em:["class","style"],font:["color","size","face"],footer:[],h1:["class","style"],h2:["class","style"],h3:["class","style"],h4:["class","style"],h5:["class","style"],h6:["class","style"],header:[],hr:[],i:["class","style"],img:["src","alt","title","width","height","id","_src","loadingclass","class","data-latex"],ins:["datetime"],li:["class","style"],mark:[],nav:[],ol:["class","style"],p:["class","style"],pre:["class","style"],s:[],section:[],small:[],span:["class","style"],sub:["class","style"],sup:["class","style"],strong:["class","style"],table:["width","border","align","valign","class","style"],tbody:["align","valign","class","style"],td:["width","rowspan","colspan","align","valign","class","style"],tfoot:["align","valign","class","style"],th:["width","rowspan","colspan","align","valign","class","style"],thead:["align","valign","class","style"],tr:["rowspan","align","valign","class","style"],tt:[],u:[],ul:["class","style"],video:["autoplay","controls","loop","preload","src","height","width","class","style"]}},window.UE={getUEBasePath:e}}()},"2452e":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("25cd"),r=a("bdd1"),s=u(r),o=a("2986"),l=u(o);function u(t){return t&&t.__esModule?t:{default:t}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function p(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=function(t){var e=t.split("").map((function(t){return+t})).reduce((function(t,e,a){return a%2?t+9*e:t+3*e}),0);return e%10},g=function(t){function e(t,a){return d(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a))}return p(e,t),n(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{5}$/)}},{key:"encode",value:function(){var t=i.EAN5_STRUCTURE[h(this.data)];return{data:"1011"+(0,s.default)(this.data,t,"01"),text:this.text}}}]),e}(l.default);e.default=g},"25cd":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.SIDE_BIN="101",e.MIDDLE_BIN="01010",e.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},e.EAN2_STRUCTURE=["LL","LG","GL","GG"],e.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],e.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]},"26a2":function(t,e,a){"use strict";var n=a("1c8b"),i=a("d890"),r=a("1e2c"),s=a("a4c7"),o=a("5a9e"),l=a("1c2e9"),u=a("c4e4"),d=a("38b9"),c=a("0fc1"),p=a("d88d"),h=a("3ccd"),g=a("7aeb"),f=a("9f67"),m=a("faa8"),v=a("2a91"),b=a("a719"),y=a("6d60"),_=a("50fb"),D=a("b338").f,C=a("6f82"),w=a("5dfd").forEach,x=a("403f"),k=a("d910"),S=a("aa6b"),A=a("b702"),E=a("7063"),T=A.get,I=A.set,P=k.f,N=S.f,R=Math.round,B=i.RangeError,O=l.ArrayBuffer,M=l.DataView,L=o.NATIVE_ARRAY_BUFFER_VIEWS,U=o.TYPED_ARRAY_TAG,F=o.TypedArray,$=o.TypedArrayPrototype,H=o.aTypedArrayConstructor,j=o.isTypedArray,W="BYTES_PER_ELEMENT",z="Wrong length",V=function(t,e){var a=0,n=e.length,i=new(H(t))(n);while(n>a)i[a]=e[a++];return i},q=function(t,e){P(t,e,{get:function(){return T(this)[e]}})},G=function(t){var e;return t instanceof O||"ArrayBuffer"==(e=v(t))||"SharedArrayBuffer"==e},K=function(t,e){return j(t)&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},X=function(t,e){return K(t,e=f(e,!0))?d(2,t[e]):N(t,e)},Y=function(t,e,a){return!(K(t,e=f(e,!0))&&b(a)&&m(a,"value"))||m(a,"get")||m(a,"set")||a.configurable||m(a,"writable")&&!a.writable||m(a,"enumerable")&&!a.enumerable?P(t,e,a):(t[e]=a.value,t)};r?(L||(S.f=X,k.f=Y,q($,"buffer"),q($,"byteOffset"),q($,"byteLength"),q($,"length")),n({target:"Object",stat:!0,forced:!L},{getOwnPropertyDescriptor:X,defineProperty:Y}),t.exports=function(t,e,a){var r=t.match(/\d+$/)[0]/8,o=t+(a?"Clamped":"")+"Array",l="get"+t,d="set"+t,f=i[o],m=f,v=m&&m.prototype,k={},S=function(t,e){var a=T(t);return a.view[l](e*r+a.byteOffset,!0)},A=function(t,e,n){var i=T(t);a&&(n=(n=R(n))<0?0:n>255?255:255&n),i.view[d](e*r+i.byteOffset,n,!0)},N=function(t,e){P(t,e,{get:function(){return S(this,e)},set:function(t){return A(this,e,t)},enumerable:!0})};L?s&&(m=e((function(t,e,a,n){return u(t,m,o),E(function(){return b(e)?G(e)?void 0!==n?new f(e,g(a,r),n):void 0!==a?new f(e,g(a,r)):new f(e):j(e)?V(m,e):C.call(m,e):new f(h(e))}(),t,m)})),_&&_(m,F),w(D(f),(function(t){t in m||c(m,t,f[t])})),m.prototype=v):(m=e((function(t,e,a,n){u(t,m,o);var i,s,l,d=0,c=0;if(b(e)){if(!G(e))return j(e)?V(m,e):C.call(m,e);i=e,c=g(a,r);var f=e.byteLength;if(void 0===n){if(f%r)throw B(z);if(s=f-c,s<0)throw B(z)}else if(s=p(n)*r,s+c>f)throw B(z);l=s/r}else l=h(e),s=l*r,i=new O(s);I(t,{buffer:i,byteOffset:c,byteLength:s,length:l,view:new M(i)});while(d<l)N(t,d++)})),_&&_(m,F),v=m.prototype=y($)),v.constructor!==m&&c(v,"constructor",m),U&&c(v,U,o),k[o]=m,n({global:!0,forced:m!=f,sham:!L},k),W in m||c(m,W,r),W in v||c(v,W,r),x(o)}):t.exports=function(){}},2744:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[a("span",{staticClass:"doneplugin-value whitespace",style:Object.assign({},t.appCommonH.getStyle(t.getTextStyle()),{display:"inline-block"}),domProps:{innerHTML:t._s(t.nowText)}})]):a("div",{staticClass:"dplugin-mobile dplugin-doneplugin dplugin-mobile-doneinput"},[a("span",{staticClass:"doneplugin-value whitespace",style:t.appCommonH.getStyle(t.getTextStyle()),domProps:{innerHTML:t._s(t.nowText)}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t \n\t\t\t")])],t._v(" "),t.pluginData.status.ispc&&t.sort_show&&!t.pluginData.status.formmodeedit&&!t.Rreadonly?a("div",{staticClass:"dplugin-box-icon-box"},[a("i",{staticClass:"iconfont iconshishangjiantou-",staticStyle:{display:"block"},on:{click:function(e){return t.setSortFun(1)}}}),t._v(" "),a("i",{staticClass:"iconfont iconshixiangxiajiantou-",staticStyle:{display:"block","margin-top":"-9px"},on:{click:function(e){return t.setSortFun(2)}}})]):t._e()],2)])},i=[],r=(a("ecb4"),a("e18c"),a("e35a"),a("1c2e"),a("5e9f"),a("e793")),s=a("a05f"),o=a("9f3a"),l=Object(s["b"])(s["a"],{name:"doneinput",data:{sort_show:!1,Rreadonly:!1},watch:{pluginData:function(t){this.updateData(t)}},props:["forminfo"],computed:{nowText:function(){var t=this.pluginData.data.toString();return t?(t=t.replace(/\n/gm,"<br />"),this.pluginData.attr.data.isReadSpace&&(t=t.replace(/\s/gm,"&ensp;")),t):"&nbsp;"}},methods:Object(r["a"])(Object(r["a"])({},Object(o["c"])("form",["SET_SORT"])),{},{updateData:function(t){this.updateClassData(t)},setSortFun:function(t){this.SET_SORT({fid:this.forminfo.formId,key:this.pluginData.pkey,data:{type:t,plugin_key:this.pluginData.key}})}}),mounted:function(){if(-1!=this.pluginData.pkey.indexOf("RepeatTable")){this.Rreadonly=this.allplugin.plugins[this.pluginData.pkey].status.readonly;var t=this.allplugin.plugins[this.pluginData.pkey].attr.setInfo.sortBind;for(var e in t)this.pluginData.key==e&&1==t[e]&&(this.sort_show=!0)}this.updateData(this.pluginData)}}),u=l,d=a("9ca4"),c=Object(d["a"])(u,n,i,!1,null,null,null),p=c.exports,h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox  dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-vie dinput-focus",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?[a("el-popover",{attrs:{"popper-class":"focusalert","z-index":"1",placement:"bottom",width:"150",trigger:"manual",content:t.getFocusContent()},on:{"after-enter":t.afterEnter},model:{value:t.focusalert,callback:function(e){t.focusalert=e},expression:"focusalert"}},[a("div",{attrs:{slot:"reference"},on:{mouseenter:function(e){return t.getFocus()},mouseleave:function(e){return t.getBlur()}},slot:"reference"},[a("span",{class:{lineinputread:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.text||t.pluginData.data))])])])]:[a("el-popover",{attrs:{"popper-class":"focusalert","z-index":"1",placement:"bottom",width:"150",trigger:"manual",content:t.getFocusContent()},on:{"after-enter":t.afterEnter},model:{value:t.focusalert,callback:function(e){t.focusalert=e},expression:"focusalert"}},[a("div",{attrs:{slot:"reference"},slot:"reference"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{lineinput:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"number",maxlength:t.pluginData.attr.data.wordlimit,placeholder:t.pluginData.attr.data.placeholder},domProps:{value:t.pluginData.data},on:{focus:t.getFocus,blur:t.getBlur,paste:function(e){return t.totopvalue(e)},input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},function(e){return t.totopvalue(e)}],mousewheel:function(t){t.preventDefault()}}})])])]],2):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dinput dinput-vie dplugin-mobile-dinput-focusalert",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.text||t.pluginData.data))]):[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],staticClass:"dplugin-mobile-newInput",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"number",maxlength:t.pluginData.attr.data.wordlimit,placeholder:t.pluginData.attr.data.placeholder},domProps:{value:t.pluginData.data},on:{focus:t.getFocus,blur:t.getBlur,input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.totopvalue]}})]],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(" ")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass}}):t._e()],1)},g=[],f=(a("b130"),a("90aa"),a("3412")),m=a("43f5"),v=Object(s["b"])(s["a"],{name:"dIntegerInput",data:Object(r["a"])(Object(r["a"])({},m["a"].data),{},{text:"",userAgentFIrefox:window.navigator.userAgent.includes("Firefox"),disabledFocus:!0}),props:["plugin"],watch:{pluginData:function(t){this.text=this.pluginData.data,this.updateData(t),this.setParamet()}},methods:Object(r["a"])(Object(r["a"])({},m["a"].methods),{},{updateData:function(t){this.updateClassData(t)},totopvalue:function(t){"-"==this.pluginData.data[0]?this.pluginData.data="-"+this.pluginData.data.substr(1).replace(/\D/g,""):this.pluginData.data=this.pluginData.data.replace(/\D/g,""),this.judgeNum(),this.$emit("sendmessage",this.pluginData)},judgeNum:function(){var t=this;setTimeout((function(){t.pluginData.data.length&&t.pluginData.attr.data.minNum.length&&+t.pluginData.data<+t.pluginData.attr.data.minNum&&(t.pluginData.data=t.pluginData.attr.data.minNum),t.pluginData.data.length&&t.pluginData.attr.data.maxNum.length&&+t.pluginData.data>+t.pluginData.attr.data.maxNum&&(t.pluginData.data=t.pluginData.attr.data.maxNum),t.$emit("sendmessage",t.pluginData)}),1e3)},setParamet:function(){if(!isNaN(+this.pluginData.data)&&this.pluginData.attr.data.bind&&void 0!=this.allplugin.plugins[this.pluginData.attr.data.bind]){var t=Object(r["a"])({},this.allplugin.plugins[this.pluginData.attr.data.bind]);this.pluginData.data?t.data=Object(f["a"])(+this.pluginData.data):t.data="",this.$emit("sendmessage",t)}}}),computed:{type:function(){var t="";return t=this.userAgentFIrefox&&"number"==this.pluginData.attr.data.type[this.pluginData.attr.data.value].type?"text":this.pluginData.attr.data.type[this.pluginData.attr.data.value].type,t}},mounted:function(){this.updateData(this.pluginData),this.setParamet()}}),b=v,y=Object(d["a"])(b,h,g,!1,null,null,null),_=y.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-vie dinput-focus",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?[a("el-popover",{attrs:{"popper-class":"focusalert","z-index":"1",placement:"bottom",width:"150",trigger:"manual",content:t.getFocusContent()},on:{"after-enter":t.afterEnter},model:{value:t.focusalert,callback:function(e){t.focusalert=e},expression:"focusalert"}},[a("div",{attrs:{slot:"reference"},on:{mouseenter:function(e){return t.getFocus()},mouseleave:function(e){return t.getBlur()}},slot:"reference"},[a("span",{class:{lineinputread:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.text||t.pluginData.data))])])])]:[a("el-popover",{attrs:{"popper-class":"focusalert","z-index":"1",placement:"bottom",width:"150",trigger:"manual",content:t.getFocusContent()},on:{"after-enter":t.afterEnter},model:{value:t.focusalert,callback:function(e){t.focusalert=e},expression:"focusalert"}},[a("div",{attrs:{slot:"reference"},slot:"reference"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{lineinput:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"number",placeholder:t.pluginData.attr.data.placeholder},domProps:{value:t.pluginData.data},on:{focus:t.getFocus,blur:t.getBlur,paste:function(e){return t.totopvalue(e)},input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},function(e){return t.totopvalue(e)}],mousewheel:function(t){t.preventDefault()}}})])])]],2):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dinput dinput-vie dplugin-mobile-dinput-focusalert",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.text||t.pluginData.data))]):[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],staticClass:"dplugin-mobile-newInput",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"number",placeholder:t.pluginData.attr.data.placeholder},domProps:{value:t.pluginData.data},on:{focus:t.getFocus,blur:t.getBlur,input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.totopvalue]}})]],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(" ")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass}}):t._e()],1)},C=[],w=Object(s["b"])(s["a"],{name:"dNumericInput",data:Object(r["a"])(Object(r["a"])({},m["a"].data),{},{text:"",userAgentFIrefox:window.navigator.userAgent.includes("Firefox"),disabledFocus:!0}),props:["plugin"],watch:{pluginData:function(t){this.text=this.pluginData.data,this.updateData(t),this.setParamet()}},methods:Object(r["a"])(Object(r["a"])({},m["a"].methods),{},{updateData:function(t){this.updateClassData(t)},totopvalue:function(t){-1!=this.pluginData.data.indexOf(".")&&this.pluginData.data.length-this.pluginData.data.indexOf(".")-1>this.pluginData.attr.data.wordlimit&&(this.pluginData.data=this.pluginData.data.substr(0,this.pluginData.data.length-1)),this.judgeNum(),this.$emit("sendmessage",this.pluginData)},judgeNum:function(){var t=this;setTimeout((function(){t.pluginData.data.length&&t.pluginData.attr.data.minNum.length&&+t.pluginData.data<+t.pluginData.attr.data.minNum&&(t.pluginData.data=t.pluginData.attr.data.minNum),t.pluginData.data.length&&t.pluginData.attr.data.maxNum.length&&+t.pluginData.data>+t.pluginData.attr.data.maxNum&&(t.pluginData.data=t.pluginData.attr.data.maxNum),t.$emit("sendmessage",t.pluginData)}),1e3)},setParamet:function(){if(!isNaN(+this.pluginData.data)&&this.pluginData.attr.data.bind&&void 0!=this.allplugin.plugins[this.pluginData.attr.data.bind]){var t=Object(r["a"])({},this.allplugin.plugins[this.pluginData.attr.data.bind]);this.pluginData.data?t.data=Object(f["a"])(+this.pluginData.data):t.data="",this.$emit("sendmessage",t)}}}),computed:{type:function(){var t="";return t=this.userAgentFIrefox&&"number"==this.pluginData.attr.data.type[this.pluginData.attr.data.value].type?"text":this.pluginData.attr.data.type[this.pluginData.attr.data.value].type,t}},mounted:function(){this.updateData(this.pluginData),this.setParamet()}}),x=w,k=Object(d["a"])(x,D,C,!1,null,null,null),S=k.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,staticStyle:{position:"relative",overflow:"hidden"},style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.formmodeedit?a("div",{staticClass:"out"}):t._e(),t._v(" "),t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dselectview"},[t.pluginData.status.readonly?a("div",{staticStyle:{display:"flex"}},[t.getNameByimg(t.pluginData.data.value)?a("img",{staticClass:"showimg",attrs:{src:t.getNameByimg(t.pluginData.data.value),alt:""}}):t._e(),t._v(" "),a("span",{staticClass:"doneplugin-value",class:{fSelct_span_linespan:"1"==t.pluginData.attr.data.borderStyle},staticStyle:{"white-space":"normal"},style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.getNameByValue(t.pluginData.data.value)))])]):a("el-select",{staticClass:"fSelct_input",class:{dplugin_readonly_input:t.pluginData.status.readonly,fSelct_input_lineinput:"1"==t.pluginData.attr.data.borderStyle,fSelct_input_noboder:"2"==t.pluginData.attr.data.borderStyle,fSelct_input_textAlign_c:"center"==t.pluginData.attr.style.textAlign,fSelct_input_textAlign_r:"right"==t.pluginData.attr.style.textAlign},staticStyle:{width:"100%"},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{clearable:"",size:"mini",filterable:"",remote:t.pluginSet.isRemote,placeholder:t.getPlaceHolder,"remote-method":t.searchMethod},on:{"visible-change":t.visibleChange,change:t.totopvalue},model:{value:t.selectData,callback:function(e){t.selectData=e},expression:"selectData"}},t._l(t.optionList,(function(e){return a("el-option",{key:e.value,staticStyle:{"line-height":"34px !important"},attrs:{value:e.value,label:e.name}},[e.imgdata?a("el-popover",{staticClass:"popoverimg",attrs:{placement:"top-start",width:"220",trigger:"hover"}},[a("img",{staticClass:"optionimgshow",attrs:{src:e.imgdata,alt:""}}),t._v(" "),a("img",{staticClass:"optionimg",attrs:{slot:"reference",src:e.imgdata,alt:""},slot:"reference"})]):t._e(),t._v(" "),a("span",{style:{"font-size":t.pluginData.attr.data.fontSize+"px"}},[t._v(t._s(t.getOptionStr(e)))])],1)})),1)],1):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dSelect dselectview"},[t.pluginData.status.readonly?a("div",[t.getNameByimg(t.pluginData.data.value)?a("img",{staticClass:"showimg",attrs:{src:t.getNameByimg(t.pluginData.data.value),alt:""}}):t._e(),t._v(" "),a("span",{staticClass:"doneplugin-value",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.getNameByValue(t.pluginData.data.value)))])]):a("el-select",{class:{dplugin_readonly_input:t.pluginData.status.readonly,fSelct_input_textAlign_c:"center"==t.pluginData.attr.style.textAlign,fSelct_input_textAlign_r:"right"==t.pluginData.attr.style.textAlign},staticStyle:{width:"100%"},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{clearable:"",filterable:"",remote:t.pluginSet.isRemote,placeholder:t.getPlaceHolder,"remote-method":t.searchMethod,"popper-class":t.setAndroidPopHeight()},on:{change:t.totopvalue},model:{value:t.selectData,callback:function(e){t.selectData=e},expression:"selectData"}},t._l(t.optionList,(function(e){return a("el-option",{key:e.value,style:Object.assign({},t.appCommonH.getStyle(t.getTextStyle()),{lineHeight:"34px !important"}),attrs:{label:e.name,value:e.value}},[e.imgdata?a("img",{staticClass:"optionimg",attrs:{src:e.imgdata,alt:""}}):t._e(),t._v(" "),a("span",{style:{"font-size":t.pluginData.attr.data.fontSize+"px"}},[t._v(t._s(t.getOptionStr(e).length>23?t.getOptionStr(e).slice(0,23)+"...":t.getOptionStr(e).slice(0,23)))])])})),1)],1)]:[a("div",{staticClass:"dplugin-doneplugin dplugin-hidden dselectview",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n         \n      ")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},E=[],T=(a("4194"),a("fe59"),a("98e0"),a("053b"),a("1458"),a("96db"),a("f4e3"),a("08ba"),Object(s["b"])(s["a"],{name:"dSelect",props:["plugin"],data:{time:null,selectData:"",searchList:[]},watch:{pluginData:function(t){this.updateData(t)},"pluginData.data":function(){this.getSelectData()}},computed:{getPlaceHolder:function(){return this.pluginSet.placeholder?this.pluginSet.placeholder:"请选择"},pluginSet:function(){return this.pluginData.attr.data},optionList:function(){var t=this,e=[];return e=this.pluginSet.isRemote?this.searchList:this.pluginData.attr.data.options,e=e||[],this.selectData&&!e.find((function(e){return e.value==t.selectData}))&&e.push({value:this.pluginData.data.value,name:this.pluginData.data.name}),e}},methods:{updateData:function(t){this.updateClassData(t),this.getSelectData()},totopvalue:function(){0==this.pluginData.status.formmodeedit&&(this.setSelectData(),this.$emit("sendmessage",this.pluginData),this.setPluginShowHide(this.pluginData.data))},setPluginShowHide:function(t){var e=this.appCommonH.copyObj(this.pluginData.attr.data.allPlugin);if(void 0===t.value)return!1;for(var a in this.pluginData.attr.data.linkage.forEach((function(a){a.value==t.value&&(e[a.pluginkey]=!1)})),this.plugin.plugins)if(void 0!==e[a]){var n=this.appCommonH.copyObj(this.plugin.plugins[a]);n.status.isshow=e[a],this.$emit("sendmessage",n)}},getNameByimg:function(t){var e;return this.optionList.forEach((function(a){a.value==t&&(e=a.imgdata)})),e||""},getNameByValue:function(t){var e=this.pluginData.data.name;return this.optionList.forEach((function(a){a.value==t&&(e=a.name)})),e||""},getSelectData:function(){if(!this.pluginData.status.readonly&&this.pluginData.data instanceof Array){var t=this.optionList.find((function(t){return t.default}));t&&(this.pluginData.data={name:t.name,value:t.value})}this.selectData=this.pluginData.data.value},setSelectData:function(){var t={value:this.selectData,name:""};this.optionList.forEach((function(e){e.value==t.value&&(t.name=e.name)})),this.pluginData.data=t},visibleChange:function(t){t&&this.$nextTick((function(){$(".el-select-dropdown").css({zIndex:19})}))},getOptionStr:function(t){if(this.pluginSet.optionStr){var e=this.pluginSet.optionStr,a=e.match(/\{(.+?)\}/g);for(var n in t)e=e.replace("{"+n+"}",t[n]);return a.forEach((function(t){a.includes(t)&&(e=e.replace(t,""))})),e.endsWith("+")&&(e=e.substring(0,e.length-1)),e}return t.name},searchMethod:function(t){var e=this;t?this.appFetch({url:this.appConfig.apiBaseUrl+this.pluginSet.remoteApi,data:{keyword:t},method:"get"},(function(t){0==t.e&&(e.searchList=t.d)})):this.searchList=[]},setAndroidPopHeight:function(){var t="";return this.appCommonH.isWeixin().isAndroid&&(t=$(window).height()>700?"dSelect_android_pop_height_150":"dSelect_android_pop_height_100"),t}},mounted:function(){this.updateData(this.pluginData);var t=this;this.pluginData.status.formmodeedit||setTimeout((function(){t.setPluginShowHide(t.pluginData.data)}),200),Array.from(document.getElementsByClassName("el-select")).forEach((function(t){t.children[0].children[0].removeAttribute("readOnly"),t.children[0].children[0].onblur=function(){var t=this;setTimeout((function(){t.removeAttribute("readOnly")}),200)}}))}})),I=T,P=(a("3c8c"),Object(d["a"])(I,A,E,!1,null,null,null)),N=P.exports,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,staticStyle:{position:"relative",overflow:"hidden"},style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.formmodeedit?a("div",{staticClass:"out"}):t._e(),t._v(" "),t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dselectview"},[t.pluginData.status.readonly?a("div",[t._l(t.pluginData.data,(function(e){return[t.getNameByimg(e.value)?a("img",{staticClass:"showimg",attrs:{src:t.getNameByimg(e.value),alt:""}}):t._e(),t._v(" "),a("span",{class:{fSelct_span_linespan:"1"==t.pluginData.attr.data.borderStyle},staticStyle:{"white-space":"normal"},style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.getNameByValue(e.value)))])]}))],2):a("el-select",{key:t.pluginData.key,ref:"select",staticClass:"fSelct_input",class:{dplugin_readonly_input:t.pluginData.status.readonly,fSelct_input_lineinput:"1"==t.pluginData.attr.data.borderStyle,fSelct_input_noboder:"2"==t.pluginData.attr.data.borderStyle,fSelct_input_textAlign_c:"center"==t.pluginData.attr.style.textAlign,fSelct_input_textAlign_r:"right"==t.pluginData.attr.style.textAlign},staticStyle:{width:"100%"},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{clearable:"",size:"mini",filterable:"",multiple:"","multiple-limit":t.mLimit,"collapse-tags":!!t.pluginSet.multipleType,remote:t.pluginSet.isRemote,placeholder:t.getPlaceHolder,"remote-method":t.searchMethod},on:{"visible-change":t.visibleChange,change:t.totopvalue},model:{value:t.selectData,callback:function(e){t.selectData=e},expression:"selectData"}},t._l(t.optionList,(function(e){return a("el-option",{key:e.value,staticStyle:{"line-height":"34px !important"},attrs:{value:e.value,label:e.name}},[e.imgdata?a("el-popover",{staticClass:"popoverimg",attrs:{placement:"top-start",width:"220",trigger:"hover"}},[a("img",{staticClass:"optionimgshow",attrs:{src:e.imgdata,alt:""}}),t._v(" "),a("img",{staticClass:"optionimg",attrs:{slot:"reference",src:e.imgdata,alt:""},slot:"reference"})]):t._e(),t._v(" "),a("span",{style:{"font-size":t.pluginData.attr.data.fontSize+"px"}},[t._v(t._s(t.getOptionStr(e)))])],1)})),1)],1):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dSelect dselectview"},[t.pluginData.status.readonly?a("div",[t._l(t.pluginData.data,(function(e){return[t.getNameByimg(e.value)?a("img",{staticClass:"showimg",attrs:{src:t.getNameByimg(e.value),alt:""}}):t._e(),t._v(" "),a("span",{staticClass:"doneplugin-value",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.getNameByValue(e.value)))])]}))],2):a("el-select",{key:t.pluginData.key,ref:"select",class:{dplugin_readonly_input:t.pluginData.status.readonly,fSelct_input_textAlign_c:"center"==t.pluginData.attr.style.textAlign,fSelct_input_textAlign_r:"right"==t.pluginData.attr.style.textAlign},staticStyle:{width:"100%"},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{clearable:"",filterable:"",multiple:"","multiple-limit":t.mLimit,"collapse-tags":!!t.pluginSet.multipleType,remote:t.pluginSet.isRemote,placeholder:t.getPlaceHolder,"remote-method":t.searchMethod,"popper-class":t.setAndroidPopHeight()},on:{change:t.totopvalue},model:{value:t.selectData,callback:function(e){t.selectData=e},expression:"selectData"}},t._l(t.optionList,(function(e){return a("el-option",{key:e.value,style:Object.assign({},t.appCommonH.getStyle(t.getTextStyle()),{lineHeight:"34px !important"}),attrs:{label:e.name,value:e.value}},[e.imgdata?a("img",{staticClass:"optionimg",attrs:{src:e.imgdata,alt:""}}):t._e(),t._v(" "),a("span",{style:{"font-size":t.pluginData.attr.data.fontSize+"px"}},[t._v(t._s(t.getOptionStr(e).length>23?t.getOptionStr(e).slice(0,23)+"...":t.getOptionStr(e).slice(0,23)))])])})),1)],1)]:[a("div",{staticClass:"dplugin-doneplugin dplugin-hidden dselectview",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n         \n      ")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},B=[],O=Object(s["b"])(s["a"],{name:"dSelectV2",props:["plugin"],data:{time:null,selectData:[],searchList:[]},watch:{pluginData:function(t){this.updateData(t)},"pluginData.data":function(){this.getSelectData()}},computed:{mLimit:function(){return this.pluginSet.isMultiple?+this.pluginSet.multipleLimit:0},getPlaceHolder:function(){return this.pluginSet.placeholder?this.pluginSet.placeholder:"请选择"},pluginSet:function(){return this.pluginData.attr.data},optionList:function(){var t=[];return t=this.pluginSet.isRemote?this.searchList:this.pluginData.attr.data.options,t=t||[],this.pluginData.data.forEach((function(e){e&&!t.find((function(t){return t.value==e.value}))&&t.push(e)})),t},inputSelector:function(){return'[data-key="'+this.pluginData.key+'"] .el-select__input'}},methods:{updateData:function(t){this.updateClassData(t),this.getSelectData()},totopvalue:function(){var t=this;0==this.pluginData.status.formmodeedit&&(this.setSelectData(),this.$emit("sendmessage",this.pluginData)),this.$nextTick((function(){t.hideOptions()}))},getNameByimg:function(t){var e;return this.optionList.forEach((function(a){a.value==t&&(e=a.imgdata)})),e||""},getNameByValue:function(t){var e="";return this.optionList.forEach((function(a){a.value==t&&(e=a.name)})),e||""},getSelectData:function(){var t=[];this.pluginData.data.forEach((function(e){t.push(e.value)})),this.selectData=t},setSelectData:function(){var t=this,e=[];this.pluginSet.isMultiple||(this.selectData=[this.selectData[this.selectData.length-1]]),this.optionList.forEach((function(a){t.selectData.includes(a.value)&&e.push(a)})),this.pluginData.data=e},visibleChange:function(t){t&&this.$nextTick((function(){$(".el-select-dropdown").css({zIndex:19})}))},getOptionStr:function(t){if(this.pluginSet.optionStr){var e=this.pluginSet.optionStr,a=e.match(/\{(.+?)\}/g);for(var n in t)e=e.replace("{"+n+"}",t[n]);return a.forEach((function(t){a.includes(t)&&(e=e.replace(t,""))})),e.endsWith("+")&&(e=e.substring(0,e.length-1)),e}return t.name},searchMethod:function(t){var e=this;t?this.appFetch({url:this.appConfig.apiBaseUrl+this.pluginSet.remoteApi,data:{keyword:t},method:"get"},(function(t){0==t.e&&(e.searchList=t.d)})):this.searchList=[]},setAndroidPopHeight:function(){var t="";return this.appCommonH.isWeixin().isAndroid&&(t=$(window).height()>700?"dSelect_android_pop_height_150":"dSelect_android_pop_height_100"),t},hideOptions:function(){+this.pluginData.attr.data.multipleLimit&&this.selectData.length==this.pluginData.attr.data.multipleLimit&&this.$refs.select.blur()},selectBlur:function(){var t=this;setTimeout((function(){$(t.inputSelector).is(":focus")||t.$refs.select.blur()}),200)}},beforeDestroy:function(){$(document).off("blur",this.inputSelector,this.selectBlur)},mounted:function(){this.updateData(this.pluginData);Array.from(document.getElementsByClassName("el-select")).forEach((function(t){t.children[0].children[0].removeAttribute("readOnly"),t.children[0].children[0].onblur=function(){var t=this;setTimeout((function(){t.removeAttribute("readOnly")}),200)}})),$(document).on("blur",this.inputSelector,this.selectBlur)}}),M=O,L=(a("6c9f"),Object(d["a"])(M,R,B,!1,null,null,null)),U=L.exports,F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dplugin-radio",style:{whiteSpace:t.pluginData.attr.data.layoutdirection},attrs:{id:"dradioview"+t.pluginData.key}},[t._l(t.pluginData.attr.data.options,(function(e,n){return a("label",{staticClass:"dradiostyle",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{for:t.forminfo.formId+"_"+t.pluginData.key+"_"+n},on:{click:t.totopvalue}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectData,expression:"selectData"}],class:{dplugin_readonly_input:t.pluginData.status.readonly},attrs:{type:"radio",id:t.forminfo.formId+"_"+t.pluginData.key+"_"+n,name:t.pluginData.key+t.forminfo.formId,disabled:t.pluginData.status.readonly||t.pluginData.status.formmodeedit},domProps:{value:e.value,checked:t._q(t.selectData,e.value)},on:{change:function(a){t.selectData=e.value}}}),t._v(" "),a("span",{style:t.appCommonH.getStyle(t.getTextStyle()),domProps:{textContent:t._s(e.name)}})])})),t._v(" "),0==t.pluginData.attr.data.options.length?a("span",[t._v(" ")]):t._e()],2):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dRadio dplugin-radio",style:{whiteSpace:t.pluginData.attr.data.layoutdirection},attrs:{id:"dradioview"+t.pluginData.key}},[t._l(t.pluginData.attr.data.options,(function(e,n){return a("label",{staticClass:"dradiostyle",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{for:t.forminfo.formId+"_"+t.pluginData.key+"_"+n},on:{click:t.totopvalue}},[t.selectData==e.value?a("i",{staticClass:"icon iconfont iconfontcolor icondanxuanxuanzhongcopy-"}):a("i",{staticClass:"icon iconfont iconfontcolor icondanxuanxuanzhong-copy"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectData,expression:"selectData"}],class:{"dplugin-mobile-newRadio":!0,dplugin_readonly_input:t.pluginData.status.readonly},attrs:{type:"radio",id:t.forminfo.formId+"_"+t.pluginData.key+"_"+n,name:t.pluginData.key+t.forminfo.formId,disabled:t.pluginData.status.readonly||t.pluginData.status.formmodeedit},domProps:{value:e.value,checked:t._q(t.selectData,e.value)},on:{change:function(a){t.selectData=e.value}}}),t._v(" "),a("span",{style:t.appCommonH.getStyle(t.getTextStyle()),domProps:{textContent:t._s(e.name)}})])})),t._v(" "),0==t.pluginData.attr.data.options.length?a("span",[t._v(" ")]):t._e()],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t \n  \t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},H=[],j=Object(s["b"])(s["a"],{name:"dRadio",props:["plugin"],data:{selectData:""},watch:{pluginData:function(t){this.updateData(t),this.$nextTick((function(){this.changeRadioStyle()}))},"pluginData.data":function(){this.getSelectData()}},computed:{optionMargin:function(){return+this.pluginData.attr.data.Optionmargin?+this.pluginData.attr.data.Optionmargin:10}},methods:{updateData:function(t){this.updateClassData(t),this.getSelectData()},changeRadioStyle:function(){"initial"==this.pluginData.attr.data.layoutdirection?$("#dradioview"+this.pluginData.key).children("label").css({display:"block",marginRight:this.optionMargin+"px"}):$("#dradioview"+this.pluginData.key).children("label").css({display:"inline",marginRight:this.optionMargin+"px"}),$("#dradioview"+this.pluginData.key).find("label:last").css({marginRight:"0px"})},totopvalue:function(){var t=this;0==this.pluginData.status.modeedit&&window.setTimeout((function(){t.setSelectData(),t.$emit("sendmessage",t.pluginData),t.setPluginShowHide(t.pluginData.data)}),200)},setPluginShowHide:function(t){if(!this.pluginData.status.formmodeedit){var e=this.appCommonH.copyObj(this.pluginData.attr.data.allPlugin);if(void 0===t.value)return!1;for(var a in this.pluginData.attr.data.linkage.forEach((function(a){a.value==t.value&&(e[a.pluginkey]=!1)})),this.plugin.plugins)if(void 0!==e[a]){var n=this.appCommonH.copyObj(this.plugin.plugins[a]);n.status.isshow=e[a],this.$emit("sendmessage",n)}}},getSelectData:function(){this.selectData=this.pluginData.data.value},setSelectData:function(){var t={value:this.selectData,name:""};this.pluginData.attr.data.options.forEach((function(e){e.value==t.value&&(t.name=e.name)})),this.pluginData.data=t}},mounted:function(){this.updateData(this.pluginData);var t=this;setTimeout((function(){t.changeRadioStyle()})),this.pluginData.status.formmodeedit||setTimeout((function(){t.setPluginShowHide(t.pluginData.data)}),200)}}),W=j,z=Object(d["a"])(W,F,H,!1,null,null,null),V=z.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin",attrs:{id:"dCheckbox"+t.pluginData.key}},t._l(t.optionList,(function(e,n){return a("label",{class:{"dplugin-block":1==t.pluginData.attr.data.block},style:t.appCommonH.getStyle(t.getTextStyle())},[!t.pluginData.status.readonly||t.pluginData.attr.data.readonlyShow?a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectData,expression:"selectData"}],class:{dplugin_readonly_checkbox:t.pluginData.status.readonly&&!t.pluginData.attr.data.readonlyShow,dplugin_required_checkbox:t.pluginData.status.required},attrs:{type:"checkbox",disabled:t.pluginData.status.formmodeedit||t.pluginData.status.readonly},domProps:{value:e.value,checked:Array.isArray(t.selectData)?t._i(t.selectData,e.value)>-1:t.selectData},on:{change:[function(a){var n=t.selectData,i=a.target,r=!!i.checked;if(Array.isArray(n)){var s=e.value,o=t._i(n,s);i.checked?o<0&&(t.selectData=n.concat([s])):o>-1&&(t.selectData=n.slice(0,o).concat(n.slice(o+1)))}else t.selectData=r},function(e){return t.changeCheck(n,e)}]}}):t._e(),t._v(" "),t.pluginData.status.readonly&&t.Arrincludes(e.value)||!t.pluginData.status.readonly?a("span",{style:t.appCommonH.getStyle(t.getTextStyle()),on:{click:function(e){return t.labelClick(n,e)}}},[t._v("\n  \t\t\t\t\t\t"+t._s(e.name)+"\n  \t\t\t\t\t")]):t._e()])})),0):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dCheckbox",attrs:{id:"dCheckbox"+t.pluginData.key}},t._l(t.optionList,(function(e,n){return a("label",{class:{"dplugin-block":t.pluginData.attr.data.block},style:t.appCommonH.getStyle(t.getTextStyle())},[t.selectData.includes(e.value)?a("i",{staticClass:"icon iconfont iconfontcolor iconduoxuan-yixuan1"}):a("i",{staticClass:"icon iconfont iconfontcolor iconduoxuan-weixuan"}),t._v(" "),!t.pluginData.status.readonly||t.pluginData.attr.data.readonlyShow?a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectData,expression:"selectData"}],class:{"dplugin-mobile-newRadio":!0,dplugin_readonly_checkbox:t.pluginData.status.readonly&&!t.pluginData.attr.data.readonlyShow,dplugin_required_checkbox:t.pluginData.status.required},attrs:{type:"checkbox",disabled:t.pluginData.status.formmodeedit||t.pluginData.status.readonly},domProps:{value:e.value,checked:Array.isArray(t.selectData)?t._i(t.selectData,e.value)>-1:t.selectData},on:{change:[function(a){var n=t.selectData,i=a.target,r=!!i.checked;if(Array.isArray(n)){var s=e.value,o=t._i(n,s);i.checked?o<0&&(t.selectData=n.concat([s])):o>-1&&(t.selectData=n.slice(0,o).concat(n.slice(o+1)))}else t.selectData=r},function(e){return t.changeCheck(n,e)}]}}):t._e(),t._v(" "),a("span",{style:t.appCommonH.getStyle(t.getTextStyle()),domProps:{textContent:t._s(e.name)}})])})),0)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t \n  \t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},G=[],K=(a("dbb3"),a("ea69"),a("513c"),Object(s["b"])(s["a"],{name:"dCheckbox",data:{selectData:[]},watch:{pluginData:function(t){this.updateData(t),this.$nextTick((function(){this.changeCheckboxStyle()}))},"pluginData.data":function(){this.getSelectData()}},computed:{chooseNum:function(){return this.selectData.length},optionMargin:function(){return+this.pluginData.attr.data.Optionmargin?+this.pluginData.attr.data.Optionmargin:10},optionList:function(){var t=this,e=this.pluginData.attr.data.options;return e=e||[],this.selectData.forEach((function(a){e.find((function(t){return t.value==a}))||e.push(t.pluginData.data.filter((function(t){return t.value==a}))[0])})),e}},methods:{updateData:function(t){this.updateClassData(t),this.getSelectData()},changeCheckboxStyle:function(){0==this.pluginData.attr.data.block?$("#dCheckbox"+this.pluginData.key).children("label").css({display:"inline",marginRight:this.optionMargin+"px"}):1==this.pluginData.attr.data.block&&$("#dCheckbox"+this.pluginData.key).children("label").css({display:"block",marginRight:this.optionMargin+"px"}),$("#dCheckbox"+this.pluginData.key).find("label:last").css({marginRight:"0px"})},labelClick:function(t,e){$(this).siblings("input").trigger("change")},changeCheck:function(t,e){var a=e.target;this.$nextTick((function(){$(a).prop("checked")?""!=this.pluginData.attr.data.max&&this.chooseNum>Number(this.pluginData.attr.data.max)&&this.selectData.splice(this.chooseNum-1,1):""!=this.pluginData.attr.data.min&&this.chooseNum<Number(this.pluginData.attr.data.min)&&this.selectData.push(this.optionList[t].value),this.setSelectData(),this.postMessage(this.pluginData)}))},getSelectData:function(){var t=[];this.pluginData.data instanceof Array&&this.pluginData.data.forEach((function(e){e.value&&t.push(e.value)})),this.selectData=t},setSelectData:function(){var t=[],e={};this.optionList.forEach((function(t){e[t.value]=t})),this.selectData.forEach((function(a){t.push({value:a,name:e[a]?e[a].name:""})})),this.pluginData.data=t},Arrincludes:function(t){if(this.pluginData.attr.data.readonlyShow)return!0;for(var e in this.selectData)if(this.selectData[e]==t)return!0;return!1}},mounted:function(){var t=this;this.updateData(this.pluginData),window.setTimeout((function(){t.changeCheckboxStyle()}),200)}})),X=K,Y=Object(d["a"])(X,q,G,!1,null,null,null),J=Y.exports,Z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[a("div",{staticClass:"dplugin-multiText whitespace",style:t.appCommonH.getStyle(t.getTextStyle()),domProps:{innerHTML:t._s(t.nowText)}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-doneinput dplugin-doneplugin"},[a("div",{staticClass:"dplugin-multiText whitespace",style:t.appCommonH.getStyle(t.getTextStyle()),domProps:{innerHTML:t._s(t.nowText)}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n       \n    ")])]],2)},Q=[],tt=Object(s["b"])(s["a"],{name:"dmultiText",data:{},watch:{pluginData:function(t){this.updateData(t)}},computed:{nowText:function(){var t=this.pluginData.data;return t?(t=t.replace(/\n/gm,"<br/>"),this.pluginData.attr.data.isReadSpace&&(t=t.replace(/\s/gm,"&ensp;")),t):"&nbsp;"}},methods:{updateData:function(t){this.updateClassData(t)}},mounted:function(){this.updateData(this.pluginData)}}),et=tt,at=Object(d["a"])(et,Z,Q,!1,null,null,null),nt=at.exports,it=function(){var t,e,a=this,n=a.$createElement,i=a._self._c||n;return i("div",{staticClass:"plugin-allbox dplugin-mobile-rinput"},[i("div",{class:a.nowBoxClass,style:a.appCommonH.getStyle(a.getLayoutStyle()),attrs:{"data-key":a.pluginData.key}},[a.pluginData.status.isshow?[a.pluginData.status.ispc?i("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[a.pluginData.status.readonly?[i("el-popover",{attrs:{"popper-class":"focusalert","z-index":"1",placement:"bottom",width:"150",trigger:"manual",content:a.getFocusContent()},on:{"after-enter":a.afterEnter},model:{value:a.focusalert,callback:function(t){a.focusalert=t},expression:"focusalert"}},[i("div",{attrs:{slot:"reference"},on:{mouseenter:function(t){return a.getFocus()},mouseleave:function(t){return a.getBlur()}},slot:"reference"},[i("div",{class:{"dplugin-content-wrap":!0,lineinputread:a.pluginData.attr.data.styleType},style:Object.assign({},a.appCommonH.getStyle(a.getTextStyle()),{display:"inline-block"}),domProps:{innerHTML:a._s(a.replacedata(a.pluginData.data))}})])])]:[i("el-popover",{attrs:{"popper-class":"focusalert","z-index":"1",placement:"bottom",width:"150",trigger:"manual",content:a.getFocusContent()},on:{"after-enter":a.afterEnter},model:{value:a.focusalert,callback:function(t){a.focusalert=t},expression:"focusalert"}},[i("div",{attrs:{slot:"reference"},slot:"reference"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:a.pluginData.data,expression:"pluginData.data"}],class:(t={"dplugin-boxBorder":!0,dplugin_multiInput:!0},t[a.selfClass]=!0,t.lineinput=a.pluginData.attr.data.styleType,t),style:a.appCommonH.getStyle(a.getTextStyle()),attrs:{disabled:a.pluginData.status.readonly,placeholder:a.pluginData.attr.data.placeholder?a.pluginData.attr.data.placeholder:" "},domProps:{value:a.pluginData.data},on:{focus:a.getFocus,blur:a.getBlur,input:[function(t){t.target.composing||a.$set(a.pluginData,"data",t.target.value)},a.change]}}),a._v(" "),a.isWordLinmit?i("p",{staticClass:"plugin_word_linmit"},[i("i",[a._v(a._s(a.wordNumber))]),a._v("\n                  / "+a._s(a.wordLinmitText)+" 字\n                ")]):a._e()])])]],2):i("div",{staticClass:"dplugin-mobile dplugin-mobile-dmultiInputs"},[a.pluginData.status.readonly?i("div",{staticClass:"dplugin-content-wrap",style:a.appCommonH.getStyle(a.getTextStyle()),domProps:{innerHTML:a._s(a.replacedata(a.pluginData.data))}}):[i("textarea",{directives:[{name:"model",rawName:"v-model",value:a.pluginData.data,expression:"pluginData.data"}],class:(e={"dplugin-boxBorder":!0,dplugin_multiInput:!0},e[a.selfClass]=!0,e),style:a.appCommonH.getStyle(a.getTextStyle()),attrs:{disabled:a.pluginData.status.readonly,placeholder:a.pluginData.attr.data.placeholder?a.pluginData.attr.data.placeholder:" "},domProps:{value:a.pluginData.data},on:{input:[function(t){t.target.composing||a.$set(a.pluginData,"data",t.target.value)},a.change],focus:a.getFocus,blur:a.getBlur}}),a._v(" "),a.isWordLinmit?i("p",{staticClass:"plugin_word_linmit"},[i("i",[a._v(a._s(a.wordNumber))]),a._v("\n              / "+a._s(a.wordLinmitText)+" 字\n            ")]):a._e()]],2)]:[i("div",{class:a.hiddenClass,style:a.appCommonH.getStyle(a.getTextStyle())},[a._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),a._v(" "),a.pluginData.status.ispc?i("pluginIcon",{attrs:{disabledRequired:a.disabledNewRequired,status:a.boxClass}}):a._e()],1)},rt=[],st=(a("b4fb"),a("897d")),ot=a.n(st),lt=Object(s["b"])(s["a"],{name:"dmultiInputs",data:Object(r["a"])(Object(r["a"])({},m["a"].data),{},{disabledFocus:!0,wordNumber:0}),watch:{pluginData:function(t){this.updateData(t),this.setWordNumber()},plugin:function(){this.updateData(this.pluginData)},"pluginData.data":function(t){var e=this;setTimeout((function(){e.refreshHeight()}),200)}},computed:{selfClass:function(){return ot()(this.forminfo.formId+"_"+this.pluginData.key+"_multiInput")},disabledNewRequired:function(){return 1==this.mixRequiredType||!!this.pluginData.attr.data.limitHeightType},wordLinmitText:function(){return this.pluginData.attr.data.minWord&&this.pluginData.attr.data.maxWord?"".concat(this.pluginData.attr.data.minWord,"~").concat(this.pluginData.attr.data.maxWord):this.pluginData.attr.data.minWord&&!this.pluginData.attr.data.maxWord?"最少".concat(" "+this.pluginData.attr.data.minWord):!this.pluginData.attr.data.minWord&&this.pluginData.attr.data.maxWord?"".concat(this.pluginData.attr.data.maxWord):""},isWordLinmit:function(){return this.pluginData.attr.data.isWordLinmit&&(this.pluginData.attr.data.minWord||this.pluginData.attr.data.maxWord)},nowBoxClass:function(){return Object(r["a"])(Object(r["a"])({},this.boxClass),{},{m_plugin_word_linmit:this.isWordLinmit&&!this.pluginData.status.ispc})}},methods:Object(r["a"])(Object(r["a"])({},m["a"].methods),{},{replacedata:function(t){return t=t.toString(),t=t.replace(/\&amp;/gm,"&"),t=t.replace(/\&amp;/gm,"&"),t=t.replace(/\&amp;/gm,"&"),t=t.replace(/>/gm,"&gt;"),t=t.replace(/</gm,"&lt;"),t=t.replace(/\n/gm,"<br/>"),t=t.replace(/\s/gm,"&nbsp;"),t},update:function(){this.pluginData.status.modeedit||this.$emit("sendmessage",this.pluginData)},updateData:function(t){this.updateClassData(t)},change:function(t){this.setWordNumber(),this.refreshHeight(),this.update()},refreshHeight:function(){$("."+this.selfClass).css({minHeight:0});var t=5;this.pluginData.status.ispc&&(t=0);var e=$("."+this.selfClass).prop("scrollHeight")>this.pluginData.attr.style.minHeight?$("."+this.selfClass).prop("scrollHeight")-t:this.pluginData.attr.style.minHeight;$("."+this.selfClass).css({minHeight:e+2}),this.pluginData.attr.data.limitHeightType&&(e>this.pluginData.attr.style.minHeight?this.pluginData.attr.data.isLimited||(this.pluginData.attr.data.isLimited=!0,this.pluginData.status.warning=!0,this.updateClassData(this.pluginData),this.$message.error({message:this.pluginData.attr.data.limitHeightErrorMsg,showClose:!0})):this.pluginData.attr.data.isLimited&&(this.pluginData.status.warning=!1,this.pluginData.attr.data.isLimited=!1,this.updateClassData(this.pluginData),this.$message.success({message:this.pluginData.attr.data.limitHeightRightMsg,showClose:!0})))},setWordNumber:function(){this.wordNumber=this.appCommonH.getWordLength(this.pluginData.data)}}),mounted:function(){this.updateData(this.pluginData),this.refreshHeight(),this.setWordNumber()},created:function(){this.pluginData.status.ispc&&void 0===this.pluginData.attr.style.minHeight&&(this.pluginData.attr.style.minHeight=46),this.pluginData.attr.style.minHeight=+this.pluginData.attr.style.minHeight}}),ut=lt,dt=Object(d["a"])(ut,it,rt,!1,null,null,null),ct=dt.exports,pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox dplugin-mobile-rinput"},[a("div",{class:t.nowBoxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-vie dinput-focus",staticStyle:{"word-break":"break-all"},style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?[a("el-popover",{attrs:{"popper-class":"focusalert","z-index":"1",placement:"bottom",width:"150",trigger:"manual",content:t.getFocusContent()},on:{"after-enter":t.afterEnter},model:{value:t.focusalert,callback:function(e){t.focusalert=e},expression:"focusalert"}},[a("div",{attrs:{slot:"reference"},on:{mouseenter:function(e){return t.getFocus()},mouseleave:function(e){return t.getBlur()}},slot:"reference"},[6!=t.pluginData.attr.data.value?a("span",{class:{lineinputread:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n                "+t._s(t.text||t.pluginData.data)+"\n              ")]):[t.pluginData.data.startsWith("http")?[t.mixDInputLinkText?a("a",{staticStyle:{"text-decoration":"underline"},attrs:{href:t.pluginData.data||"javascript:;",target:"_blank"}},[t._v(t._s(t.pluginData.attr.data.placeholder||t.pluginData.data))]):a("a",{staticStyle:{"text-decoration":"underline"},attrs:{href:t.pluginData.data||"javascript:;",target:"_blank"}},[t._v(t._s(t.pluginData.attr.data.linkText||t.pluginData.data))])]:a("span",{class:{lineinputread:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.data))])]],2)])]:[a("el-popover",{attrs:{"popper-class":"focusalert","z-index":"1",placement:"bottom",width:"150",trigger:"manual",content:t.getFocusContent()},on:{"after-enter":t.afterEnter},model:{value:t.focusalert,callback:function(e){t.focusalert=e},expression:"focusalert"}},[a("el-popover",{attrs:{slot:"reference",placement:"bottom-start",width:t.width,trigger:"manual","popper-class":"set_padding",transition:"0s"},slot:"reference",model:{value:t.shouList,callback:function(e){t.shouList=e},expression:"shouList"}},[a("div",{attrs:{slot:"reference"},slot:"reference"},["checkbox"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{lineinput:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{maxlength:t.pluginData.attr.data.wordlimit,placeholder:t.pluginData.attr.data.placeholder,type:"checkbox"},domProps:{checked:Array.isArray(t.pluginData.data)?t._i(t.pluginData.data,null)>-1:t.pluginData.data},on:{focus:t.getFocus,blur:t.getBlur,paste:function(e){return t.totopvalue(e)},input:function(e){return t.totopvalue(e)},change:function(e){var a=t.pluginData.data,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=null,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginData,"data",a.concat([r])):s>-1&&t.$set(t.pluginData,"data",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginData,"data",i)}}}):"radio"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{lineinput:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{maxlength:t.pluginData.attr.data.wordlimit,placeholder:t.pluginData.attr.data.placeholder,type:"radio"},domProps:{checked:t._q(t.pluginData.data,null)},on:{focus:t.getFocus,blur:t.getBlur,paste:function(e){return t.totopvalue(e)},input:function(e){return t.totopvalue(e)},change:function(e){return t.$set(t.pluginData,"data",null)}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{lineinput:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{maxlength:t.pluginData.attr.data.wordlimit,placeholder:t.pluginData.attr.data.placeholder,type:t.type},domProps:{value:t.pluginData.data},on:{focus:t.getFocus,blur:t.getBlur,paste:function(e){return t.totopvalue(e)},input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},function(e){return t.totopvalue(e)}]}}),t._v(" "),t.isWordLinmit?a("p",{staticClass:"plugin_word_linmit"},[a("i",[t._v(t._s(t.wordNumber))]),t._v("\n                  / "+t._s(t.wordLinmitText)+" 字\n                ")]):t._e()]),t._v(" "),t.shouList?a("ul",{staticClass:"ul-style scroll-ul"},t._l(t.associateList,(function(e,n){return a("li",{key:n,staticClass:"li-style",staticStyle:{display:"flex !important"},on:{click:function(a){return t.setData(e)}}},[t._v(t._s(e))])})),0):t._e()])],1)]],2):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dinput dinput-vie dplugin-mobile-dinput-focusalert",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?[6!=t.pluginData.attr.data.value?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.text||t.pluginData.data))]):[t.pluginData.data.startsWith("http")?[t.mixDInputLinkText?a("a",{staticStyle:{"text-decoration":"underline"},attrs:{href:t.pluginData.data||"javascript:;",target:"_blank"}},[t._v(t._s(t.pluginData.attr.data.placeholder||t.pluginData.data))]):a("a",{staticStyle:{"text-decoration":"underline"},attrs:{href:t.pluginData.data||"javascript:;",target:"_blank"}},[t._v(t._s(t.pluginData.data))])]:a("span",{class:{lineinputread:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.data))])]]:[a("el-popover",{attrs:{placement:"bottom-start",width:t.width,trigger:"manual","popper-class":"set_padding",transition:"0s"},model:{value:t.shouList,callback:function(e){t.shouList=e},expression:"shouList"}},[a("div",{attrs:{slot:"reference"},slot:"reference"},["checkbox"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],staticClass:"dplugin-mobile-newInput",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{maxlength:t.pluginData.attr.data.wordlimit,placeholder:t.pluginData.attr.data.placeholder,type:"checkbox"},domProps:{checked:Array.isArray(t.pluginData.data)?t._i(t.pluginData.data,null)>-1:t.pluginData.data},on:{focus:t.getFocus,blur:t.getBlur,input:t.totopvalue,change:function(e){var a=t.pluginData.data,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=null,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginData,"data",a.concat([r])):s>-1&&t.$set(t.pluginData,"data",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginData,"data",i)}}}):"radio"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],staticClass:"dplugin-mobile-newInput",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{maxlength:t.pluginData.attr.data.wordlimit,placeholder:t.pluginData.attr.data.placeholder,type:"radio"},domProps:{checked:t._q(t.pluginData.data,null)},on:{focus:t.getFocus,blur:t.getBlur,input:t.totopvalue,change:function(e){return t.$set(t.pluginData,"data",null)}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],staticClass:"dplugin-mobile-newInput",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{maxlength:t.pluginData.attr.data.wordlimit,placeholder:t.pluginData.attr.data.placeholder,type:t.type},domProps:{value:t.pluginData.data},on:{focus:t.getFocus,blur:t.getBlur,input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.totopvalue]}}),t._v(" "),t.isWordLinmit?a("p",{staticClass:"plugin_word_linmit"},[a("i",[t._v(t._s(t.wordNumber))]),t._v("\n                / "+t._s(t.wordLinmitText)+" 字\n              ")]):t._e()]),t._v(" "),t.shouList?a("ul",{staticClass:"ul-style scroll-ul"},t._l(t.associateList,(function(e,n){return a("li",{key:n,staticClass:"li-style",staticStyle:{display:"flex !important"},on:{click:function(a){return t.setData(e)}}},[t._v(t._s(e))])})),0):t._e()])]],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(" ")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass}}):t._e()],1)},ht=[],gt=(a("2eeb"),a("fe8a"),Object(s["b"])(s["a"],{name:"dinput",data:Object(r["a"])(Object(r["a"])({},m["a"].data),{},{text:"",userAgentFIrefox:window.navigator.userAgent.includes("Firefox"),attrType:{},disabledFocus:!0,wordNumber:0,shouList:!1,associateList:[],width:"130"}),watch:{pluginData:function(t){this.text=this.pluginData.data,this.updateData(t),this.setWordNumber()},nowData:function(t){this.$emit("sendmessage",this.pluginData)}},methods:Object(r["a"])(Object(r["a"])({},m["a"].methods),{},{updateData:function(t){this.updateClassData(t)},totopvalue:function(t){this.attrType[this.pluginData.attr.data.value]&&"number"==this.attrType[this.pluginData.attr.data.value].type&&(this.pluginData.data=t.target.value.replace(/[^\d]/g,"")),this.setWordNumber(),0==this.pluginData.status.modeedit&&this.$emit("sendmessage",this.pluginData),1==this.pluginData.attr.data.isSearch&&this.pluginData.attr.data.api&&this.searchList()},searchList:function(){var t=this;if(this.pluginData.data.length){if(this.pluginData.attr.data.api.includes("http"))var e=this.pluginData.attr.data.api;else e=this.appConfig.apiBaseUrl+this.pluginData.attr.data.api;this.appFetch({url:e,method:"GET",data:{keyword:this.pluginData.data}},(function(e){e.e||(e.d.length?e.d instanceof Array?(e.d[0].name?t.associateList=e.d.map((function(t){return t.name})):t.associateList=e.d,t.shouList=!0):console.error("模糊查询数据类型错误"):t.shouList=!1)}),(function(e){t.$message.error({message:"系统异常"})}))}else this.shouList=!1},setData:function(t){this.pluginData.data=t,this.shouList=!1},setAttrType:function(){var t={};this.pluginData.attr.data.type.forEach((function(e){t[e.value]=e})),this.attrType=t},setWordNumber:function(){this.wordNumber=this.appCommonH.getWordLength(this.pluginData.data)},getBlur:function(t){var e=this;this.getFocusContent()&&(this.focusalert=!1),this.shouList&&setTimeout((function(){e.shouList=!1}),300)}}),computed:{type:function(){if(Object.keys(this.attrType).length){var t="";return t=this.userAgentFIrefox&&this.attrType[this.pluginData.attr.data.value]&&"number"==this.attrType[this.pluginData.attr.data.value].type?"text":this.attrType[this.pluginData.attr.data.value].type,t}},nowData:function(){return this.pluginData.data},wordLinmitText:function(){return this.pluginData.attr.data.minWord&&this.pluginData.attr.data.maxWord?"".concat(this.pluginData.attr.data.minWord,"~").concat(this.pluginData.attr.data.maxWord):this.pluginData.attr.data.minWord&&!this.pluginData.attr.data.maxWord?"最少".concat(" "+this.pluginData.attr.data.minWord):!this.pluginData.attr.data.minWord&&this.pluginData.attr.data.maxWord?"".concat(this.pluginData.attr.data.maxWord):""},isWordLinmit:function(){return this.pluginData.attr.data.isWordLinmit&&(this.pluginData.attr.data.minWord||this.pluginData.attr.data.maxWord)},nowBoxClass:function(){return Object(r["a"])(Object(r["a"])({},this.boxClass),{},{m_plugin_word_linmit:this.isWordLinmit&&!this.pluginData.status.ispc})}},mounted:function(){this.updateData(this.pluginData),this.setAttrType(),this.setWordNumber(),this.width=$('[data-key="'+this.pluginData.key+'"]').width()<140?130:$('[data-key="'+this.pluginData.key+'"]').width()-10}})),ft=gt,mt=Object(d["a"])(ft,pt,ht,!1,null,null,null),vt=mt.exports,bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dImageview",style:t.appCommonH.getStyle(t.getTextStyle())},[a("img",{style:{width:t.pluginData.attr.data.width,height:t.pluginData.attr.data.height},attrs:{src:""==t.pluginData.data?"/v2/static/img/image-default.png":t.pluginData.data},on:{click:function(e){return e.target!==e.currentTarget?null:t.showImglayer(e)}}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dImage dImageview"},[a("img",{style:{width:t.pluginData.attr.data.width,height:t.pluginData.attr.data.height},attrs:{src:""==t.pluginData.data?"/v2/static/img/image-default.png":t.pluginData.data},on:{click:function(e){return e.target!==e.currentTarget?null:t.showImglayer(e)}}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(" ")])],t._v(" "),t.pluginData.status.ispc&&t.showImg?a("div",{staticClass:"dAvatar_showImg",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}},[a("i",{staticClass:"el-icon-close close",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}}),t._v(" "),a("img",{staticClass:"img",attrs:{src:t.pluginData.data,alt:""}})]):t._e(),t._v(" "),!t.pluginData.status.ispc&&t.showImg?a("div",{staticClass:"dAvatar_m_showImg"},[a("i",{staticClass:"dAvatar_m_showImg_close",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}}),t._v(" "),a("div",{on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}},[a("img",{staticClass:"img",attrs:{src:t.pluginData.data,alt:""}})])]):t._e()],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},yt=[],_t=Object(s["b"])(s["a"],{name:"dImage",data:{showImg:!1},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},showImglayer:function(){if(this.pluginData.status.formmodeedit||!this.pluginData.attr.data.enlargeImage||!this.pluginData.data.length)return!1;this.showImg=!0}},mounted:function(){this.updateData(this.pluginData)}}),Dt=_t,Ct=Object(d["a"])(Dt,bt,yt,!1,null,null,null),wt=Ct.exports,xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-focus"},[t.pluginData.status.readonly?a("span",{class:{"doneplugin-value":!0,"doneplugin-value-userview":!0,lineinputread:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle(),{minHeight:t.getTextStyle()["lineHeight"]})},[t._v("\n\t\t\t\t\t\t"+t._s(t.pluginData.data)+"\n\t\t\t\t\t")]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{"doneplugin-value":!0,"dplugin-inputView":!0,lineinput:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"text",readonly:"否"==t.pluginData.attr.data.ischange,placeholder:t.pluginData.status.formmodeedit?t.pluginData.attr.data.name:""},domProps:{value:t.pluginData.data},on:{input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.dataChange]}})]):a("div",{staticClass:"dplugin-mobile dplugin-doneplugin dplugin-mobile-dinput"},[t.pluginData.status.readonly?a("span",{class:{"doneplugin-value":!0,"doneplugin-value-userview":!0,lineinputread:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t\t"+t._s(t.pluginData.data)+"\n\t\t\t\t\t")]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{"doneplugin-value":!0,"dplugin-inputView":!0,lineinput:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"text",readonly:"否"==t.pluginData.attr.data.ischange,placeholder:t.pluginData.status.formmodeedit?t.pluginData.attr.data.name:""},domProps:{value:t.pluginData.data},on:{input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.dataChange]}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},kt=[],St=a("f7f9"),At=Object(s["b"])(s["a"],{name:"doneinput",data:{},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},dataChange:function(){this.postMessage(this.pluginData)}},mounted:function(){"object"==Object(St["a"])(this.pluginData.data)&&(this.pluginData.data=""),this.updateData(this.pluginData)}}),Et=At,Tt=Object(d["a"])(Et,xt,kt,!1,null,null,null),It=Tt.exports,Pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[t.pluginData.status.readonly?a("div",{staticClass:"doneplugin-value",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t    "+t._s(t.pluginData.data.name?t.pluginData.data.name:t.pluginData.attr.data.value.name)+"\n  \t\t\t\t")]):a("el-popover",{attrs:{placement:"bottom-start",width:t.width,trigger:"manual","popper-class":"set_padding",transition:"0s"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticStyle:{position:"relative"},attrs:{slot:"reference"},slot:"reference"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data.name,expression:"pluginData.data.name"}],ref:"parent",staticClass:"doneplugin-value dplugin-inputView",class:t.pluginData.key+"clear",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"text",index:t.pluginData.data.id,placeholder:"点击搜索国家/地区"},domProps:{value:t.pluginData.data.name},on:{click:t.clearBlur,focus:t.focus,input:function(e){e.target.composing||t.$set(t.pluginData.data,"name",e.target.value)}}}),t._v(" "),t.pluginData.data.name?a("i",{staticClass:"el-icon-close dplugin_close",on:{click:t.close}}):t._e(),t._v(" "),a("i",{staticClass:"el-icon-search dplugin_jiantou",class:t.pluginData.key+"clear",on:{click:t.clearBlur}})]),t._v(" "),a("div",{staticClass:"userSerch_alert pc",class:t.pluginData.key+"clear"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"pcInput",attrs:{type:"text",id:t.getSearchId,placeholder:"点击搜索国家/地区"},domProps:{value:t.value},on:{input:[function(e){e.target.composing||(t.value=e.target.value)},function(e){return t.findCountry(e)}]}}),t._v(" "),a("ul",{staticClass:"ul-style scroll-ul"},t._l(t.countryList,(function(e,n){return a("li",{staticClass:"li-style",staticStyle:{display:"flex !important"},attrs:{title:e.name},on:{click:function(a){return t.liClick(e)}}},[t._v("\n                  "+t._s(e.name)+"\n                ")])})),0)])])],1):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dinput dplugin-mobile-dCountry"},[t.pluginData.status.readonly?a("div",{staticClass:"doneplugin-value dplugin-inputView",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t    "+t._s(t.pluginData.data.name?t.pluginData.data.name:t.pluginData.attr.data.value.name)+"\n  \t\t\t\t")]):a("el-popover",{attrs:{placement:"bottom-start",width:t.width,trigger:"manual","popper-class":"set_padding",transition:"0s"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticStyle:{position:"relative"},attrs:{slot:"reference"},slot:"reference"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data.name,expression:"pluginData.data.name"}],ref:"parent",staticClass:"doneplugin-value dplugin-inputView mobile_input",class:t.pluginData.key+"clear",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"text",index:t.pluginData.data.id,placeholder:"点击搜索国家/地区"},domProps:{value:t.pluginData.data.name},on:{click:t.clearBlur,focus:t.focus,input:function(e){e.target.composing||t.$set(t.pluginData.data,"name",e.target.value)}}}),t._v(" "),t.pluginData.data.name?a("i",{staticClass:"el-icon-close dplugin_close",on:{click:t.close}}):t._e(),t._v(" "),a("i",{staticClass:"el-icon-search dplugin_jiantou",class:t.pluginData.key+"clear",on:{click:t.clearBlur}})]),t._v(" "),a("div",{staticClass:"userSerch_alert mobile",class:t.pluginData.key+"clear"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"dplugin-inputView",attrs:{type:"text",id:t.getSearchId,placeholder:"请输入国家/地区"},domProps:{value:t.value},on:{input:[function(e){e.target.composing||(t.value=e.target.value)},function(e){return t.findCountry(e)}]}}),t._v(" "),a("ul",{staticClass:"ul-style scroll-ul"},t._l(t.countryList,(function(e,n){return a("li",{staticClass:"li-style",staticStyle:{display:"flex !important"},attrs:{title:e.name},on:{click:function(a){return t.liClick(e)}}},[t._v("\n                  "+t._s(e.name)+"\n                ")])})),0)])])],1)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t \n  \t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Nt=[],Rt=(a("77ad"),Object(s["b"])(s["a"],{name:"dCountry",data:{show:!1,countryList:[],width:150,value:"",timeoutTime:null},watch:{pluginData:function(t){this.updateData(t)}},computed:{getSearchId:function(){return"0."==this.pluginData.key.toString().slice(0,2)?this.pluginData.key.toString().slice(2):this.pluginData.key}},methods:{updateData:function(t){this.updateClassData(t)},updata:function(){this.pluginData.status.formmodeedit||this.postMessage(this.pluginData)},focus:function(t){$(t.target).blur()},close:function(){this.pluginData.data={id:"",name:""},this.updata()},clearBlur:function(t){this.pluginData.status.formmodeedit||(this.show=!this.show),this.$nextTick((function(){this.show&&$("#"+this.getSearchId).length&&($("#"+this.getSearchId)[0].focus(),this.throttle())}))},findCountry:function(t){if("Enter"==t.code)return this.show=!1,this.value="",void(this.peopleList=[]);this.pluginData.status.formmodeedit||this.throttle()},throttle:function(){var t=this;clearTimeout(this.timeoutTime),this.timeoutTime=setTimeout((function(){t.getCountry(t.value)}),500)},getCountry:function(t){this.appFetch({url:"searchCountry",method:"get",data:{keyword:t}},this.success,this.error)},success:function(t){this.countryList=t.d},error:function(t){console.log("findCountry_error",t)},liClick:function(t){this.pluginData.data={id:t.id,name:t.name},this.show=!1,this.value="",this.countryList=[],this.updata()}},mounted:function(){this.updateData(this.pluginData);var t=this;$(document).on("click",(function(e){$(e.target).hasClass(t.pluginData.key+"clear")||(t.show=!1,t.value="",t.countryList=[])})),this.width=$('[data-key="'+this.pluginData.key+'"]').width()<140?130:$('[data-key="'+this.pluginData.key+'"]').width()-10}})),Bt=Rt,Ot=(a("f55f"),Object(d["a"])(Bt,Pt,Nt,!1,null,"0c5419f4",null)),Mt=Ot.exports,Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.formmodeedit?a("div",{staticClass:"out"}):t._e(),t._v(" "),t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dselectview dplugin-dCountryV2"},[t.pluginData.status.readonly?a("div",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n            "+t._s(t.showCountryName())+"\n          ")]):a("el-select",{staticClass:"fSelct_input",class:{fSelct_input_textAlign_c:"center"==t.pluginData.attr.style.textAlign,fSelct_input_textAlign_r:"right"==t.pluginData.attr.style.textAlign},staticStyle:{width:"100%"},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{size:"mini",filterable:"",multiple:t.pluginData.attr.data.multiple,placeholder:"选择国家/地区"},on:{change:t.totopvalue},model:{value:t.selectData,callback:function(e){t.selectData=e},expression:"selectData"}},t._l(t.countryList,(function(t,e){return a("el-option",{key:e,staticStyle:{"line-height":"34px !important"},attrs:{value:t.id,label:t.name}})})),1)],1):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dSelect dselectview"},[t.pluginData.status.readonly?a("div",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n            "+t._s(t.showCountryName())+"\n          ")]):a("el-select",{class:{fSelct_input_textAlign_c:"center"==t.pluginData.attr.style.textAlign,fSelct_input_textAlign_r:"right"==t.pluginData.attr.style.textAlign},staticStyle:{width:"100%"},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{filterable:"",multiple:t.pluginData.attr.data.multiple,placeholder:"选择国家/地区"},on:{change:t.totopvalue},model:{value:t.selectData,callback:function(e){t.selectData=e},expression:"selectData"}},t._l(t.countryList,(function(t,e){return a("el-option",{key:e,staticStyle:{"line-height":"34px !important"},attrs:{value:t.id,label:t.name}})})),1)],1)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t \n  \t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Ut=[],Ft=(a("9302"),Object(s["b"])(s["a"],{name:"dCountry",data:{countryList:[],selectData:[]},watch:{pluginData:function(t){this.updateData(t)},"pluginData.data":function(){this.getSelectData()}},methods:{updateData:function(t){this.updateClassData(t),this.getSelectData()},getCountry:function(){var t=this;this.appFetch({url:"searchCountry",method:"get",data:{}},(function(e){0==e.e?t.countryList=e.d:t.$message({type:"error",message:e.m,showClose:!0})}),(function(e){t.$message({type:"error",message:"系统错误",showClose:!0})}))},getSelectData:function(){this.pluginData.attr.data.multiple?this.selectData=this.pluginData.data.map((function(t){return t.id})):this.pluginData.data.length?this.selectData=this.pluginData.data[0].id:this.selectData=""},setSelectData:function(){var t=[],e=this.selectData;this.pluginData.attr.data.multiple||(e=[e]),t=this.countryList.filter((function(t){return e.includes(t.id)})),this.pluginData.data=t},totopvalue:function(){this.pluginData.status.formmodeedit||(this.setSelectData(),this.postMessage(this.pluginData))},showCountryName:function(){return this.pluginData.data.map((function(t){return t.name})).join("、")}},mounted:function(){this.updateData(this.pluginData),this.pluginData.status.formmodeedit||this.getCountry(),this.pluginData.status.ispc&&!this.pluginData.status.readonly&&$("[data-id="+this.pluginData.tdid+"]").css({overflow:"visible"})}})),$t=Ft,Ht=(a("7b3d"),Object(d["a"])($t,Lt,Ut,!1,null,null,null)),jt=Ht.exports,Wt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-focus"},[t.pluginData.status.readonly?a("span",{staticClass:"doneplugin-value",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.getReadData()))]):a("el-popover",{attrs:{placement:"bottom-start",width:t.width,trigger:"manual","popper-class":"set_padding",transition:"0s"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticStyle:{position:"relative"},attrs:{slot:"reference"},slot:"reference"},[a("input",{ref:"parent",staticClass:"doneplugin-value dplugin-inputView",class:t.pluginData.key+"clear",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"text",index:t.pluginData.data.uid,placeholder:"点击搜索用户"},domProps:{value:t.getReadData()},on:{click:t.clearBlur,focus:t.focus}}),t._v(" "),t.pluginData.data.name?a("i",{staticClass:"el-icon-close dplugin_close",on:{click:t.close}}):t._e(),t._v(" "),a("i",{staticClass:"el-icon-search dplugin_jiantou",class:t.pluginData.key+"clear",on:{click:t.clearBlur}})]),t._v(" "),a("div",{staticClass:"userSerch_alert pc",class:t.pluginData.key+"clear"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.value,expression:"value",modifiers:{trim:!0}}],staticClass:"pcInput",attrs:{type:"text",id:t.getSearchId,placeholder:"请输入姓名或工号"},domProps:{value:t.value},on:{input:[function(e){e.target.composing||(t.value=e.target.value.trim())},function(e){return t.findPeople(e)}],blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("ul",{staticClass:"ul-style scroll-ul"},[t._l(t.peopleList,(function(e,n){return a("li",{staticClass:"li-style",staticStyle:{display:"flex !important"},attrs:{title:t.titleText(e)},on:{click:function(a){return t.liClick(e)}}},[1==t.pluginData.attr.data.selectShow?[a("span",{staticClass:"span-style"},[t._v(t._s(e.name))]),t._v(" "),e.college?a("span",{staticClass:"span-college"},[t._v(t._s(e.college))]):t._e()]:t._e(),t._v(" "),2==t.pluginData.attr.data.selectShow?[a("span",{staticClass:"span-style"},[t._v(t._s(e.name))]),t._v(" "),e.number?a("span",{staticClass:"span-college"},[t._v(t._s(e.number))]):t._e()]:t._e(),t._v(" "),3==t.pluginData.attr.data.selectShow?[a("span",{staticClass:"span-style"},[t._v(t._s(e.name))]),t._v(" "),e.number?a("span",{staticClass:"span-college1"},[t._v(t._s(e.number))]):t._e(),t._v(" "),e.college?a("span",{staticClass:"span-college1"},[t._v(t._s(e.college))]):t._e()]:t._e(),t._v(" "),4==t.pluginData.attr.data.selectShow?[a("span",{staticClass:"span-style"},[t._v(t._s(e.name))]),t._v(" "),e.college?a("span",{staticClass:"span-college1"},[t._v(t._s(e.college))]):t._e(),t._v(" "),e.email?a("span",{staticClass:"span-college1"},[t._v(t._s(e.email))]):t._e()]:t._e()],2)})),t._v(" "),t.pluginData.attr.data.setStaff&&t.value?a("li",{staticClass:"li-style",staticStyle:{display:"flex !important"},attrs:{title:t.value+"-校外人员"},on:{click:function(e){return t.liClick({name:t.value,id:-1})}}},[a("span",{staticClass:"span-style"},[t._v(t._s(t.value))]),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v("外")])]):t._e()],2)])])],1):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dinput dplugin-mobile-rinput"},[t.pluginData.status.readonly?a("span",{class:{"doneplugin-value":!0,"doneplugin-value-userview":!0},style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t\t"+t._s(t.getReadData())+"\n  \t\t\t\t")]):a("el-popover",{attrs:{placement:"top",width:t.width,trigger:"manual","popper-class":"mobile_set_padding",transition:"0s"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticStyle:{position:"relative"},attrs:{slot:"reference"},slot:"reference"},[a("input",{staticClass:"doneplugin-value dplugin-inputView mobile_input",class:t.pluginData.key+"clear",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"text",index:t.pluginData.data.uid,placeholder:"请输入姓名或工号"},domProps:{value:t.getReadData()},on:{focus:t.focus,click:t.clearBlur}}),t._v(" "),t.pluginData.data.name?a("i",{staticClass:"el-icon-close dplugin_close",on:{click:t.close}}):t._e(),t._v(" "),a("i",{staticClass:"el-icon-search dplugin_jiantou",class:t.pluginData.key+"clear",on:{click:t.clearBlur}})]),t._v(" "),a("div",{staticClass:"userSerch_alert mobile",class:t.pluginData.key+"clear"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.value,expression:"value",modifiers:{trim:!0}}],staticClass:"dplugin-inputView",attrs:{type:"text",id:t.getSearchId,autofocus:"autofocus",placeholder:"请输入姓名"},domProps:{value:t.value},on:{input:[function(e){e.target.composing||(t.value=e.target.value.trim())},function(e){return t.findPeople(e)}],blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("ul",{staticClass:"ul-style scroll-ul"},[t._l(t.peopleList,(function(e,n){return a("li",{staticClass:"li-style",staticStyle:{display:"flex !important"},on:{click:function(a){return t.liClick(e)}}},[1==t.pluginData.attr.data.selectShow?[a("span",{staticClass:"span-style"},[t._v(t._s(e.name))]),t._v(" "),e.college?a("span",{staticClass:"span-college"},[t._v(t._s(e.college))]):t._e()]:t._e(),t._v(" "),2==t.pluginData.attr.data.selectShow?[a("span",{staticClass:"span-style"},[t._v(t._s(e.name))]),t._v(" "),e.number?a("span",{staticClass:"span-college"},[t._v(t._s(e.number))]):t._e()]:t._e(),t._v(" "),3==t.pluginData.attr.data.selectShow?[a("span",{staticClass:"span-style"},[t._v(t._s(e.name))]),t._v(" "),e.number?a("span",{staticClass:"span-college1"},[t._v(t._s(e.number))]):t._e(),t._v(" "),e.college?a("span",{staticClass:"span-college1"},[t._v(t._s(e.college))]):t._e()]:t._e(),t._v(" "),4==t.pluginData.attr.data.selectShow?[a("span",{staticClass:"span-style"},[t._v(t._s(e.name))]),t._v(" "),e.college?a("span",{staticClass:"span-college1"},[t._v(t._s(e.college))]):t._e(),t._v(" "),e.email?a("span",{staticClass:"span-college1"},[t._v(t._s(e.email))]):t._e()]:t._e()],2)})),t._v(" "),t.pluginData.attr.data.setStaff&&t.value?a("li",{staticClass:"li-style",staticStyle:{display:"flex !important"},attrs:{title:t.value+"-校外人员"},on:{click:function(e){return t.liClick({name:t.value,id:-1})}}},[a("span",{staticClass:"span-style"},[t._v(t._s(t.value))]),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v("外")])]):t._e()],2)])])],1)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(" ")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},zt=[],Vt=Object(s["b"])(s["a"],{name:"dUserSearch",data:{show:!1,peopleList:[],lastData:{},value:"",width:150,timeoutTime:null},watch:{pluginData:function(t){this.updateData(t)}},computed:{getSearchId:function(){return"0."==this.pluginData.key.toString().slice(0,2)?this.pluginData.key.toString().slice(2):this.pluginData.key},getReadShow:function(){return this.pluginData.attr.data.readShow&&this.pluginData.attr.data.readShow.length?this.pluginData.attr.data.readShow:["name"]}},methods:{updateData:function(t){this.updateClassData(t)},updata:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},focus:function(t){$(t.target).blur()},getReadData:function(){var t=this,e="";return-1==this.pluginData.data.uid?this.pluginData.data.name:(this.getReadShow.forEach((function(a){t.pluginData.data[a]&&(e+=t.pluginData.data[a]+" ")})),e.slice(0,-1))},liClick:function(t){var e={name:t.name};-1!=t.id&&this.getReadShow.forEach((function(a){e[a]=t[a]})),this.pluginData.data=Object(r["a"])({uid:t.id},e),this.show=!1,this.value="",this.peopleList=[],this.updata()},clearBlur:function(t){this.pluginData.status.formmodeedit||(this.show=!this.show),this.$nextTick((function(){if(this.show&&$("#"+this.getSearchId).length){var t=this;window.setTimeout((function(){$("#"+t.getSearchId).focus()}),10)}}))},close:function(){this.pluginData.data={uid:"",name:""},this.updata()},findPeople:function(t){if("Enter"==t.code)return this.show=!1,this.value="",void(this.peopleList=[]);this.pluginData.status.formmodeedit||this.throttle()},throttle:function(){var t=this;clearTimeout(this.timeoutTime),this.timeoutTime=setTimeout((function(){t.getUsers(t.value)}),500)},getPostData:function(){var t={},e=this.pluginData.attr.data;return["depart_ids","job_id","tag_id","uids","relation"].forEach((function(a){var n=a;"depart_ids"==a&&(n="depart_id"),t[n]=[],e[a].forEach((function(e){"relation"==a?e&&t[n].push(e):t[n].push(e.id)}))})),t},getUsers:function(t){""!=t?this.appFetch({url:"searchUserPlugin",method:"post",data:{param:JSON.stringify(Object(r["a"])(Object(r["a"])({},{keyword:t,inst_id:this.$route.query.inst_id}),this.getPostData()))}},this.success,this.error):this.peopleList=[]},success:function(t){this.peopleList=t.d.data},error:function(t){console.log("findCountry_error",t)},repairBug:function(){this.pluginData.data.name||(this.pluginData.data={uid:"",name:""})},titleText:function(t){var e="";return 1==this.pluginData.attr.data.selectShow?e="".concat(t.name,"-").concat(t.college):2==this.pluginData.attr.data.selectShow?e="".concat(t.name,"-").concat(t.number):3==this.pluginData.attr.data.selectShow?e="".concat(t.name,"-").concat(t.number,"-").concat(t.college):4==this.pluginData.attr.data.selectShow&&(e="".concat(t.name,"-").concat(t.college,"-").concat(t.email)),e}},mounted:function(){var t=this;this.updateData(this.pluginData),this.repairBug(),$(document).on("click",(function(e){$(e.target).hasClass(t.pluginData.key+"clear")||(t.show=!1,t.value="",t.peopleList=[])})),this.width=$('[data-key="'+this.pluginData.key+'"]').width()<140?130:$('[data-key="'+this.pluginData.key+'"]').width()-10}}),qt=Vt,Gt=Object(d["a"])(qt,Wt,zt,!1,null,null,null),Kt=Gt.exports,Xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin doptionview",style:{whiteSpace:t.pluginData.attr.data.layouttype},attrs:{id:t.pluginData.key}},[t._l(t.pluginData.attr.data.options,(function(e,n){return a("label",{staticClass:"dradiostyle",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{for:t.forminfo.formId+"_"+t.pluginData.key+n},on:{click:function(a){return t.changeopinion(e.value)}}},[a("input",{attrs:{type:"radio",id:t.forminfo.formId+"_"+t.pluginData.key+n,name:t.pluginData.key,disabled:t.pluginData.status.readonly||t.pluginData.status.formmodeedit},domProps:{value:e.value,checked:e.value==t.pluginData.data.option},on:{change:t.totopvalue}}),t._v("\n\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t")])})),t._v(" "),t.pluginData.attr.data.showdate?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.data.date?t.pluginData.data.date.slice(0,16):t.pluginData.data.date))]):t._e()],2):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dOpinion doptionview",style:{whiteSpace:t.pluginData.attr.data.layouttype},attrs:{id:t.pluginData.key}},[t._l(t.pluginData.attr.data.options,(function(e,n){return a("label",{staticClass:"dradiostyle",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{for:t.forminfo.formId+"_"+t.pluginData.key+n},on:{click:function(a){return t.changeopinion(e.value)}}},[e.value==t.pluginData.data.option?a("i",{staticClass:"icon iconfont iconfontcolor icondanxuanxuanzhongcopy-"}):a("i",{staticClass:"icon iconfont iconfontcolor icondanxuanxuanzhong-copy"}),t._v(" "),a("input",{attrs:{type:"radio",id:t.forminfo.formId+"_"+t.pluginData.key+n,name:t.pluginData.key,disabled:t.pluginData.status.readonly||t.pluginData.status.formmodeedit},domProps:{value:e.value,checked:e.value==t.pluginData.data.option},on:{change:t.totopvalue}}),t._v("\n\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t")])})),t._v(" "),t.pluginData.attr.data.showdate?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.data.date?t.pluginData.data.date.slice(0,16):t.pluginData.data.date))]):t._e()],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Yt=[],Jt=Object(s["b"])(s["a"],{name:"dOpinion",data:{cufe:window.location.hostname.indexOf("cufe")>-1},watch:{pluginData:function(t){this.updateData(t),this.changeOpinionStyle()}},methods:{updateData:function(t){this.updateClassData(t)},changeOpinionStyle:function(){"initial"==this.pluginData.attr.data.layouttype?$("#"+this.pluginData.key).children("label").css({display:"block"}):$("#"+this.pluginData.key).children("label").css({display:"inline"})},changeopinion:function(t){if(!this.pluginData.status.readonly&&!this.pluginData.status.formmodeedit){var e=new Date;this.pluginData.data.date=e.toLocaleDateString().replace(/\//g,"-")+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes()),this.pluginData.data.option=t}},totopvalue:function(){0==this.pluginData.status.modeedit&&this.$emit("sendmessage",this.pluginData)}},mounted:function(){this.updateData(this.pluginData),this.changeOpinionStyle()},created:function(){(this.pluginData.status.modeedit||this.pluginData.status.formmodeedit)&&(this.pluginData.data={data:"",option:""})}}),Zt=Jt,Qt=Object(d["a"])(Zt,Xt,Yt,!1,null,null,null),te=Qt.exports,ee=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dCalendar-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.returnweekdata(t.pluginData.data)))]):["time"==t.pluginData.attr.data.datetype?a("el-time-picker",{attrs:{editable:!1,format:t.pluginData.attr.data.dateformat,size:"small",readonly:!t.pluginData.attr.data.editappro||t.pluginData.status.formmodeedit,placeholder:t.pluginData.attr.data.placeholder,"picker-options":t.pickerOptionstime},on:{keyup:function(e){return t.totopvalue(!1)},change:function(e){return t.totopvalue(!1)},focus:t.focus,blur:t.blurFn},model:{value:t.pluginData.data,callback:function(e){t.$set(t.pluginData,"data",e)},expression:"pluginData.data"}}):"year"==t.pluginData.attr.data.datetype||"month"==t.pluginData.attr.data.datetype||"date"==t.pluginData.attr.data.datetype||"datetime"==t.pluginData.attr.data.datetype?a("el-date-picker",{attrs:{editable:!1,type:t.pluginData.attr.data.datetype,format:t.pluginData.attr.data.dateformat,readonly:!t.pluginData.attr.data.editappro||t.pluginData.status.formmodeedit,size:"small",placeholder:t.pluginData.attr.data.placeholder,"picker-options":t.pickerOptionstime},on:{keyup:function(e){return t.totopvalue(!1)},change:function(e){return t.totopvalue(!1)},focus:t.focus,blur:t.blurFn},model:{value:t.pluginData.data,callback:function(e){t.$set(t.pluginData,"data",e)},expression:"pluginData.data"}}):"week"==t.pluginData.attr.data.datetype?a("el-date-picker",{attrs:{editable:!1,type:t.pluginData.attr.data.datetype,format:t.pluginData.attr.data.dateformat,readonly:!t.pluginData.attr.data.editappro||t.pluginData.status.formmodeedit,size:"small",placeholder:t.pluginData.attr.data.placeholder,"picker-options":t.pickerOptionstime},on:{keyup:function(e){return t.totopvalue(!1)},change:function(e){return t.totopvalue(!1)},blur:t.blurFn,focus:t.focus},model:{value:t.pluginData.data,callback:function(e){t.$set(t.pluginData,"data",e)},expression:"pluginData.data"}}):t._e()]],2):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dCalendar dCalendar-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.returnweekdata(t.pluginData.data)))]):["time"==t.pluginData.attr.data.datetype?a("el-time-picker",{attrs:{editable:!1,format:t.pluginData.attr.data.dateformat,size:"small",readonly:!t.pluginData.attr.data.editappro||t.pluginData.status.formmodeedit,placeholder:t.pluginData.attr.data.placeholder,align:"center","picker-options":t.pickerOptionstime},on:{keyup:function(e){return t.totopvalue(!1)},change:function(e){return t.totopvalue(!1)},blur:t.blurFn,focus:t.focus},model:{value:t.pluginData.data,callback:function(e){t.$set(t.pluginData,"data",e)},expression:"pluginData.data"}}):"year"==t.pluginData.attr.data.datetype||"month"==t.pluginData.attr.data.datetype||"date"==t.pluginData.attr.data.datetype||"datetime"==t.pluginData.attr.data.datetype||"week"==t.pluginData.attr.data.datetype?a("el-date-picker",{attrs:{editable:!1,type:t.pluginData.attr.data.datetype,format:t.pluginData.attr.data.dateformat,readonly:!t.pluginData.attr.data.editappro||t.pluginData.status.formmodeedit,size:"small",placeholder:t.pluginData.attr.data.placeholder,"picker-options":t.pickerOptionstime},on:{keyup:function(e){return t.totopvalue(!1)},change:function(e){return t.totopvalue(!1)},blur:t.blurFn,focus:t.focus},model:{value:t.pluginData.data,callback:function(e){t.$set(t.pluginData,"data",e)},expression:"pluginData.data"}}):t._e()]],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(" ")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},ae=[],ne=a("11ae"),ie=ne["a"],re=Object(d["a"])(ie,ee,ae,!1,null,null,null),se=re.exports,oe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[t.pluginData.status.readonly?a("div",{staticClass:"doneplugin-value",style:t.appCommonH.getStyle(t.getTextStyle())},[a("div",t._l(t.pluginData.data,(function(e,n){return a("span",[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e?e.name:"")+"\n\t\t\t\t\t\t")])})),0)]):a("div",{staticClass:"doneplugin-value relative",class:t.Newclass+"div",style:[t.appCommonH.getStyle(t.getTextStyle()),t.height],on:{click:t.findPeople}},[a("div",[t._l(t.pluginData.data,(function(e,n){return a("span",[t._v("\n\t\t\t\t\t\t\t"+t._s(e?e.name:"")+"\n\t\t\t\t\t\t")])})),t._v(" "),0==t.pluginData.data.length?a("span",[t._v("请选择")]):t._e()],2),t._v(" "),t._m(0)]),t._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"position-absolute ul-style",class:t.Newclass+"clear"},[a("div",{staticStyle:{"max-height":"150px",overflow:"scroll"}},t._l(t.peopleList,(function(e,n){return a("li",{staticClass:"li-style",on:{click:function(e){t.checked[n].checked=!t.checked[n].checked}}},[a("input",{attrs:{type:"checkbox",name:e.name},domProps:{value:e.id,checked:t.checked[n].checked}}),t._v("\n\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t")])})),0),t._v(" "),a("li",{staticClass:"li-back li-spe-flex",staticStyle:{width:"100%"}},[a("span",{staticClass:"span-color-width",on:{click:t.checkAll}},[t._v("全选")]),t._v(" "),a("span",{staticClass:"span-color-width",on:{click:t.clearAll}},[t._v("取消")]),t._v(" "),a("span",{staticClass:"span-color-width",on:{click:t.makeSure}},[t._v("确定")])])])]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dUserSearch"},[t.pluginData.status.readonly?a("div",{staticClass:"doneplugin-value",style:t.appCommonH.getStyle(t.getTextStyle())},[a("div",t._l(t.pluginData.data,(function(e,n){return a("span",{staticClass:"select-item"},[t._v("\n\t\t\t\t\t\t\t"+t._s(e?e.name:"")+"\n\t\t\t\t\t\t")])})),0)]):a("div",{staticClass:"doneplugin-value relative",class:t.Newclass+"div",style:t.appCommonH.getStyle(t.getTextStyle()),on:{click:t.findPeople}},[a("div",[t._l(t.pluginData.data,(function(e,n){return a("span",{staticClass:"select-item",on:{click:function(e){return e.stopPropagation(),t.removeItem(n)}}},[t._v("\n\t\t\t\t\t\t\t"+t._s(e?e.name:"")+"\n\t\t\t\t\t\t\t"),a("i",{staticClass:"icon iconfont iconshanchu1"})])})),t._v(" "),0==t.pluginData.data.length?a("span",[t._v("请选择")]):t._e()],2),t._v(" "),t._m(1)]),t._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"position-absolute ul-style",class:t.Newclass+"clear"},[a("div",{staticStyle:{"max-height":"100px",overflow:"scroll"}},t._l(t.peopleList,(function(e,n){return a("li",{staticClass:"li-style",staticStyle:{"padding-left":"10px"}},[a("input",{attrs:{type:"checkbox",name:e.name},domProps:{value:e.id,checked:t.checked[n].checked},on:{click:function(e){t.checked[n].checked=!t.checked[n].checked}}}),t._v("\n\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t")])})),0),t._v(" "),a("li",{staticClass:"li-back li-spe-flex"},[a("span",{staticClass:"span-color-width",on:{click:t.checkAll}},[t._v("全选")]),t._v(" "),a("span",{staticClass:"span-color-width",on:{click:t.clearAll}},[t._v("取消")]),t._v(" "),a("span",{staticClass:"span-color-width",on:{click:t.makeSure}},[t._v("确定")])])])])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t \n\t\t\t")])]],2),t._v(" "),a("span",{staticStyle:{float:"right",position:"relative",margin:"-12px 0 0 0"}},[t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)])},le=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticStyle:{position:"absolute",top:"50%",right:"4px",transform:"translateY(-50%)"}},[a("i",{staticClass:"el-icon-caret-bottom",staticStyle:{"vertical-align":"text-top"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticStyle:{position:"absolute",top:"50%",right:"4px",transform:"translateY(-50%)"}},[a("i",{staticClass:"el-icon-caret-bottom"})])}],ue=Object(s["b"])(s["a"],{name:"dUserSearch",data:{show:0,peopleList:[],checked:[],Newclass:""},props:["plugin"],watch:{pluginData:function(t){this.updateData(t)}},computed:{height:function(){return{border:"1px solid rgba(0,0,0,0.2)"}}},methods:{updateData:function(t){this.updateClassData(t)},updata:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},findPeople:function(){if(this.$nextTick((function(){$("."+this.Newclass+"clear").width($("."+this.Newclass+"div").width()+30)})),!this.pluginData.status.formmodeedit){if(this.show)return void(this.show=!1);this.getCountry(this.pluginData.attr.data.value.name)}},getCountry:function(t){this.appFetch({url:this.pluginData.attr.data.api,method:"get",data:{}},this.success,this.error)},success:function(t){var e=[],a=[];this.pluginData.data&&0!=this.pluginData.data&&(a=this.pluginData.data.map((function(t){return t.name})));for(var n=0;n<t.d.length;n++)a.includes(t.d[n].name)?e.push({checked:1}):e.push({checked:0});this.checked=e,this.peopleList=t.d,this.show=!this.show},error:function(t){console.log("findCountry_error",t)},checkAll:function(){for(var t=0;t<this.checked.length;t++)this.checked[t].checked=1},clearAll:function(){for(var t=0;t<this.checked.length;t++)this.checked[t].checked=0},makeSure:function(){this.pluginData.attr.data.value=[];for(var t=[],e=0;e<this.checked.length;e++)1==this.checked[e].checked&&t.push(this.peopleList[e]);this.pluginData.data=t,this.show=0,this.updata()},removeItem:function(t){this.pluginData.data.splice(t,1),this.$set(this.pluginData,"data",this.pluginData.data),this.updata()},isInRepeat:function(){var t=this,e=this.plugin.plugins;for(var a in e)e.hasOwnProperty(a)&&a.includes("RepeatTable")&&e[a].attr.data.tableData.trs[1].tds.forEach((function(e){if(!e.dataid)return!1;t.plugin.rtplugins[e.dataid].key==t.pluginData.model?t.Newclass=t.pluginData.model:t.Newclass=t.pluginData.key}))}},created:function(){this.isInRepeat()},mounted:function(){var t=this;this.updateData(this.pluginData),$(document).on("click",(function(e){var a=$("."+t.Newclass+"clear");a.is(e.target)||0!==a.has(e.target).length||$("."+t.Newclass+"div").is(e.target)||0!==$("."+t.Newclass+"div").has(e.target).length||(t.peopleList=[],t.checked=[],t.show=!1)}))}}),de=ue,ce=(a("4f9a"),Object(d["a"])(de,oe,le,!1,null,"5d43187c",null)),pe=ce.exports,he=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[a("a",{staticClass:"doneplugin-value doneplugin-underline wrap-word",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{href:!t.pluginData.status.formmodeedit&&t.nowData.href,target:"_blank"},on:{click:t.addTextColor}},[t._v("\n\t\t\t\t\t\t"+t._s(t.nowData.text?t.nowData.text:" ")+"\n\t\t\t\t\t")])]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dLink"},[a("a",{staticClass:"doneplugin-value wrap-word",style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{href:!t.pluginData.status.formmodeedit&&t.nowData.href,target:"_blank"}},[t._v("\n\t\t\t\t\t\t"+t._s(t.nowData.text?t.nowData.text:" ")+"\n\t\t\t\t\t")])])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},ge=[],fe=Object(s["b"])(s["a"],{name:"dLink",data:{},watch:{pluginData:function(t){this.updateData(t)}},computed:{nowData:function(){return this.pluginData.attr.data.dataSource?{text:this.pluginData.data.text,href:this.pluginData.data.href}:{text:this.pluginData.attr.data.text,href:this.pluginData.attr.data.href}}},methods:{updateData:function(t){this.updateClassData(t)},addTextColor:function(t){$(t.target).css({color:"#4285f4"})}},mounted:function(){this.updateData(this.pluginData)}}),me=fe,ve=Object(d["a"])(me,he,ge,!1,null,null,null),be=ve.exports,ye=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dplugin-pc-dAvatar"},[a("input",{staticClass:"doneplugin-opacityInput",attrs:{type:"file",id:"upImg",disabled:t.pluginData.status.readonly,value:"编辑"},on:{change:t.fileImg}}),t._v(" "),a("img",{attrs:{width:t.pluginData.attr.data.width?t.pluginData.attr.data.width+"px":"100%",height:t.pluginData.attr.data.height?t.pluginData.attr.data.height+"px":"auto",src:t.pluginData.data.length>0?t.pluginData.data:"/v2/static/img/avatar2.jpeg"},on:{click:function(e){return e.target!==e.currentTarget?null:t.showImglayer(e)}}}),t._v(" "),a("br"),t._v(" "),void 0!=t.pluginData.attr.data.Haslimit&&t.pluginData.attr.data.showexpress&&0==t.pluginData.data.length?a("span",{attrs:{width:t.pluginData.attr.data.width?t.pluginData.attr.data.width+"px":"100%"},on:{click:t.findPeople}},[t._v("\n\t\t\t\t\t\t上传文件的大小请在"+t._s(t.pluginData.attr.data.smallsize)+"MB-"+t._s(t.pluginData.attr.data.size)+"MB之间\n\t\t\t\t\t\t"),t.pluginData.attr.data.islimit?[t._v("\n\t\t\t\t\t\t\t,格式为\n\t\t\t\t\t\t\t"),t._l(t.pluginData.attr.data.Haslimit,(function(e,n){return a("span",{key:n},[t._v(t._s(e)+"\n\t\t\t\t\t\t\t\t"),n<t.pluginData.attr.data.Haslimit.length-1?a("span",[t._v(",")]):t._e()])}))]:t._e()],2):t._e(),t._v(" "),a("br"),t._v(" "),t.pluginData.status.readonly?t._e():a("input",{staticClass:"dAvatar_btn",attrs:{type:"button",value:"编辑"},on:{click:t.findPeople}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dAvatar"},[t.pluginData.data?a("div",{staticClass:"dplugin-mobile-addfileed-box",style:{height:t.pluginData.attr.data.mobileHeight?t.pluginData.attr.data.mobileHeight+"rem":"0.76rem",width:t.pluginData.attr.data.mobileWidth?t.pluginData.attr.data.mobileWidth+"rem":"0.76rem"}},[t.pluginData.status.readonly?t._e():a("i",{staticClass:"icon iconfont iconshanchu1",on:{click:t.removeImg}}),t._v(" "),a("div",{staticClass:"dplugin-mobile-addfileed"},[a("img",{attrs:{width:"100%",height:"100%",src:t.pluginData.data},on:{click:function(e){return e.target!==e.currentTarget?null:t.showImglayer(e)}}})])]):t._e(),t._v(" "),t.pluginData.status.readonly||t.pluginData.data?t._e():a("div",{staticClass:"dplugin-mobile-addfileed-box dplugin-mobile-addfile"},[a("i",{staticClass:"icon iconfont iconaddTodo-nav"}),t._v(" "),a("input",{staticClass:"doneplugin-opacityInput",attrs:{type:"file",id:"upImg",disabled:t.pluginData.status.readonly},on:{change:t.fileImg}})]),t._v(" "),a("div",{staticClass:"clear"})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])],t._v(" "),t.pluginData.status.ispc&&t.showImg?a("div",{staticClass:"dAvatar_showImg",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}},[a("i",{staticClass:"el-icon-close close",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}}),t._v(" "),a("img",{staticClass:"img",attrs:{src:t.pluginData.data,alt:""}})]):t._e(),t._v(" "),!t.pluginData.status.ispc&&t.showImg?a("div",{staticClass:"dAvatar_m_showImg"},[a("i",{staticClass:"dAvatar_m_showImg_close",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}}),t._v(" "),a("div",{on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}},[a("img",{staticClass:"img",attrs:{src:t.pluginData.data,alt:""}})])]):t._e()],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},_e=[];a("6ae3"),a("6a61");function De(t,e,a,n,i,r,s){try{var o=t[r](s),l=o.value}catch(u){return void a(u)}o.done?e(l):Promise.resolve(l).then(n,i)}function Ce(t){return function(){var e=this,a=arguments;return new Promise((function(n,i){var r=t.apply(e,a);function s(t){De(r,n,i,s,o,"next",t)}function o(t){De(r,n,i,s,o,"throw",t)}s(void 0)}))}}var we=a("1d8b"),xe=(a("3e54"),a("0d7a"),a("8256"),a("ab6e"),a("927c"),a("3c51"),a("db0a"),a("1cc1"),a("ab0f"),a("fc6e"),a("f30b"),a("cfd1"),a("d104"),a("f74a"),a("3598"),a("b497"),a("2909"),a("a7ef"),a("b523"),a("e671"),a("4140"),a("83db"),a("829d"),a("939f"),a("1bb1"),a("c3ba"),a("5501")),ke=a.n(xe),Se={getImageTag:function(t,e){var a=this;return t?new Promise((function(n,i){ke.a.getData(t,(function(){var t=a.getIosVersion()?ke.a.getTag(this,e):1;n(t)}))})):0},handleImg:function(t,e){var a=new FileReader,n=this;return a.readAsDataURL(t),new Promise((function(i,r){a.onloadend=function(){var a=this.result,r=new Image;r.src=a,r.onload=function(){var a=n.getRotateImg(r,e,t.type),s=n.dataURLtoFile(a,t.name);i(s)}}}))},getRotateImg:function(t,e,a){var n=document.createElement("canvas"),i=n.getContext("2d"),r=t.width,s=t.height;switch(n.width=r,n.height=s,i.drawImage(t,0,0,r,s),e){case 6:this.rotateImg(t,"right",n);break;case 8:this.rotateImg(t,"left",n);break;case 3:this.rotateImg(t,"right",n,2);break}return n.toDataURL(a)},rotateImg:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right",a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=0,r=3,s=a.width||t.width,o=a.height||t.height,l=0;"right"===e?(l+=n,l>r&&(l=i)):(l-=n,l<i&&(l=r));var u=90*l*Math.PI/180,d=a.getContext("2d");switch(l){case 1:a.width=o,a.height=s,d.rotate(u),d.drawImage(t,0,-o,s,o);break;case 2:a.width=s,a.height=o,d.rotate(u),d.drawImage(t,-s,-o,s,o);break;case 3:a.width=o,a.height=s,d.rotate(u),d.drawImage(t,-s,0,s,o);break;default:a.width=s,a.height=o,d.drawImage(t,0,0,s,o);break}},dataURLtoFile:function(t,e){var a=t.split(","),n=a[0].match(/:(.*?);/)[1],i=atob(a[1]),r=i.length,s=new Uint8Array(r);while(r--)s[r]=i.charCodeAt(r);return new File([s],e,{type:n})},getIosVersion:function(){var t=navigator.userAgent.toLowerCase(),e=t.match(/cpu iphone os (.*?) like mac os/);return!e||e[1].replace(/_/g,".")<13.4}},Ae=Object(s["b"])(s["a"],{name:"dAvatar",data:{showImg:!1},watch:{pluginData:function(t){this.updateData(t)},getAllFocusContent:function(){this.initAlertInfo()}},methods:{updateData:function(t){this.updateClassData(t)},updata:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},initAlertInfo:function(){if(this.pluginData.status.ispc)return!1;var t="";if(this.pluginData.attr.data.showexpress){t="上传文件的大小请在"+this.pluginData.attr.data.smallsize+"MB-"+this.pluginData.attr.data.size+"MB之间";this.pluginData.attr.data.Haslimit.length&&(t+="格式为："+this.pluginData.attr.data.Haslimit.join("，"))}this.pluginData.alertFoucsMsg=this.getAllFocusContent?this.getAllFocusContent:t,this.updata()},findPeople:function(t){if(!this.pluginData.status.formmodeedit&&!this.pluginData.status.readonly)t.target.parentNode.firstChild.click()},fileImg:function(t){var e=this;return Ce(regeneratorRuntime.mark((function a(){var n,i,r,s,o,l,u,d;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e,i=new FormData,r=t.currentTarget.files[0],!r.type.includes("image")){a.next=9;break}return a.next=4,Se.getImageTag(r,"Orientation");case 4:if(s=a.sent,!(s>1)){a.next=9;break}return a.next=8,Se.handleImg(r,s);case 8:r=a.sent;case 9:if(i.append("upfile",r),void 0==n.pluginData.attr.data.islimit||!n.pluginData.attr.data.islimit){a.next=16;break}if(o=r.name.lastIndexOf("."),l=r.name.substring(o).toLowerCase(),n.pluginData.attr.data.Haslimit.includes(l.replace(".",""))){a.next=16;break}return n.$message.error({message:"暂不支持"+l+"格式的文件"}),a.abrupt("return");case 16:if(void 0==n.pluginData.attr.data.smallsize){a.next=23;break}if(!(r.size>1024*n.pluginData.attr.data.size*1024||r.size<1024*n.pluginData.attr.data.smallsize*1024)){a.next=21;break}return n.$message.error({message:"您上传的文件不在"+n.pluginData.attr.data.smallsize+"MB-"+n.pluginData.attr.data.size+"MB之间！"}),$(t.currentTarget).val(""),a.abrupt("return");case 21:a.next=27;break;case 23:if(!(r.size>1024*n.pluginData.attr.data.size*1024)){a.next=27;break}return n.$message.error({message:"您上传的文件超过了"+n.pluginData.attr.data.size+"MB！"}),$(t.currentTarget).val(""),a.abrupt("return");case 27:u=we["a"].getApi("uploadindex")+"?category=image",d=new XMLHttpRequest,d.open("post",u),d.onload=function(t){var e,a=JSON.parse(t.currentTarget.response),i="http://test.officeflowimg.rlstech.cn";("http://dev-officeflow.rlstech.cn"==self.appConfig.apiBaseUrl&&(i="https://dev-officeflowimg.rlstech.cn"),"test.office.rlstech.cn"!=window.location.hostname&&(i=JSON.parse(window.sessionStorage.officeDb_getSiteConfig).imghost),"SUCCESS"==a.state)&&(e=i+"/"+a.url,n.pluginData.data=e,n.postMessage(n.pluginData))},d.send(i);case 32:case"end":return a.stop()}}),a)})))()},getCountry:function(t){var e=window.location.origin;"test.office.rlstech.cn"==window.location.hostname&&(e="dev-officeflow.rlstech.cn"),this.appFetch({url:e+"/api/upload/index?category=image",method:"post",data:t},this.success,this.error)},success:function(t){console.log("findCountry_success",t)},error:function(t){console.log("findCountry_error",t)},liClick:function(t,e){this.updata()},showImglayer:function(){if(0==this.pluginData.data.length)return!1;this.showImg=!0},removeImg:function(){this.pluginData.data="",this.postMessage(this.pluginData)}},mounted:function(){this.updateData(this.pluginData),this.initAlertInfo()},created:function(){"object"==Object(St["a"])(this.pluginData.data)&&(this.pluginData.data="")}}),Ee=Ae,Te=Object(d["a"])(Ee,ye,_e,!1,null,null,null),Ie=Te.exports,Pe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin",style:t.appCommonH.getStyle(t.getTextStyle())},[a("div",{staticClass:"dFile-Vie"},[a("div",{staticStyle:{display:"none"}},[a("input",{attrs:{id:t.pluginData.key,type:"file",disabled:t.pluginData.status.readonly},on:{change:t.updatefile}})]),t._v(" "),!t.pluginData.status.readonly&&t.isCanUpload()?a("button",{style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{disabled:t.pluginData.status.readonly},on:{click:function(e){return e.stopPropagation(),t.clickfile(e)}}},[t._v("\n            "+t._s(t.pluginData.attr.data.buttontext)+"\n          ")]):t._e(),t._v(" "),t._l(t.pluginData.data,(function(e,n){return a("a",{staticClass:"filenames",attrs:{href:"javascript:;"}},[t._v("\n\t\t\t\t\t\t"+t._s(e.name)+"\n            "),a("span",{staticClass:"preview",on:{click:function(a){return t.downloadFile(e,a)}}},[t._v("下载")]),t._v(" "),t.supportPreview(e)?a("span",{staticClass:"preview",on:{click:function(a){return a.stopPropagation(),t.previewFile(e,a,n)}}},[t._v("预览")]):t._e(),t._v(" "),t.pluginData.status.readonly?t._e():a("i",{staticClass:"el-icon-delete",on:{click:function(e){return e.stopPropagation(),t.delfile(n,e)}}}),t._v(" "),a("br")])}))],2)]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dFile",style:t.appCommonH.getStyle(t.getTextStyle())},[a("div",{staticClass:"dFile-Vie"},[a("div",{staticStyle:{display:"none"}},[a("input",{attrs:{id:t.pluginData.key,type:"file",disabled:t.pluginData.status.readonly},on:{change:t.updatefile}})]),t._v(" "),t._l(t.pluginData.data,(function(e,n){return a("a",{staticClass:"filenames ofl",attrs:{href:"javascript:;"}},[a("i",{staticClass:"el-icon-document"}),t._v(" "),a("span",{staticClass:"dplugin-mobile-dFile_span"},[t._v("\n              "+t._s(e.name)+"\n            ")]),t._v(" "),a("div",{staticClass:"dplugin-mobile-dFile_btn"},[a("span",{staticClass:"preview",on:{click:function(a){return t.downloadFile(e,a)}}},[t._v("下载")]),t._v(" "),t.supportPreview(e)?a("span",{staticClass:"preview",on:{click:function(a){return a.stopPropagation(),t.previewFile(e,a,n)}}},[t._v("预览")]):t._e(),t._v(" "),t.pluginData.status.readonly?t._e():a("i",{staticClass:"el-icon-remove",on:{click:function(e){return e.stopPropagation(),t.delfile(n,e)}}})])])})),t._v(" "),!t.pluginData.status.readonly&&t.isCanUpload()?a("a",{attrs:{href:"javascript:void(0)"},on:{click:function(e){return e.stopPropagation(),t.clickfile(e)}}},[t._m(0),t._v("\n            点击上传附件(小于"+t._s(t.pluginData.attr.data.MBlimit)+"M)\n\t\t\t\t  ")]):t._e()],2)])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t \n\t\t\t")])],t._v(" "),t.pluginData.status.ispc&&t.showImg?a("div",{staticClass:"dFile_showImg",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}},[a("i",{staticClass:"el-icon-close close",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}}),t._v(" "),a("img",{staticClass:"img",attrs:{src:t.picURL,alt:""}})]):t._e(),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.pluginData.status.ispc&&t.showImg,expression:"!pluginData.status.ispc && showImg"}],ref:"dAvatar_moveImg",staticClass:"dAvatar_moveImg"},[a("i",{staticClass:"el-icon-close close",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}}),t._v(" "),a("ul",{ref:"wbox",staticClass:"box"},t._l(t.picArr,(function(t,e){return a("li",{key:e},[a("div",{staticClass:"box1 box2"},[a("img",{attrs:{src:t,alt:"",srcset:""}})])])})),0),t._v(" "),a("div",{staticClass:"moveimg_bot"},[a("div",{staticClass:"moveimg_num"},[t._v(t._s(t.imgd)+"/"+t._s(t.imgz))]),t._v(" "),a("div",{staticClass:"moveimg_xz"},[t._v("\n        长按保存\n      ")])])])],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Ne=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("i",[n("img",{staticClass:"imgs",attrs:{src:a("001f")}})])}],Re=Object(s["b"])(s["a"],{name:"dFile",data:{showImg:!1,picURL:"",imgd:"",imgz:"1",picArr:[],indexNow:0},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},supportPreview:function(t){var e=t.name.split(".").pop();return!(!this.pluginData.attr.data.isHasPreview||!["pdf","txt","doc","docx","xls","xlsx","ppt","pptx"].includes(e))||!(!this.pluginData.attr.data.isPhotoPreview&&void 0!=this.pluginData.attr.data.isPhotoPreview||!["jpg","png","jpeg","gif","bmp","tif","tiff"].includes(e))},slideimgfun:function(){var t=this,e=document.querySelectorAll(".box li"),a=this.$refs.wbox,n=this.$refs.dAvatar_moveImg,i=document.body.clientWidth;this.imgd=this.indexNow+1,a.style.left=-this.indexNow*document.body.clientWidth+"px",a.style.width=100*e.length+"%";for(var r=0;r<e.length;r++)e[r].style.width=1/e.length*100+"%";var s=0,o=0;n.addEventListener("touchstart",(function(e){s=e.changedTouches[0].pageX,o=a.offsetLeft,n.addEventListener("touchmove",(function(e){e.preventDefault();var n=e.changedTouches[0].pageX,i=n-s,r=o+i;a.style.left=r+"px",t.num=i>0?-.3:.3}))})),n.addEventListener("touchend",(function(e){var r=a.offsetLeft,s=Math.round(-r/i+t.num);s=s>=t.picArr.length-1?t.picArr.length-1:s,s=s<=0?0:s;var o=s+1;t.imgd=o,a.style.left=-s*n.offsetWidth+"px"}))},downloadFile:function(t,e){window.open(this.getDownUrl(t))},previewFile:function(t,e,a){var n=this;e.stopPropagation(),e.preventDefault();var i=t.name.split(".").pop();if(["jpg","png","jpeg","gif","bmp","tif","tiff"].includes(i)){for(var r in this.imgz=this.pluginData.data.length,this.picArr=[],this.picURL=this.forminfo.instId?we["a"].getApi("downloadAuth")+"?file_id="+t.id+"&inst_id="+this.forminfo.instId:we["a"].getApi("downloadAuth")+"?file_id="+t.id,this.pluginData.data){var s=this.forminfo.instId?we["a"].getApi("downloadAuth")+"?file_id="+this.pluginData.data[r].id+"&inst_id="+this.forminfo.instId:we["a"].getApi("downloadAuth")+"?file_id="+this.pluginData.data[r].id;this.picArr.push(s)}this.indexNow=a,this.showImg=!0,setTimeout((function(){n.slideimgfun()}),0)}else window.open(this.getDownUrl(t)+"&type=preview")},clickfile:function(t){t.stopPropagation(),this.pluginData.status.readonly||$(t.currentTarget).parent(".dFile-Vie").find('[type="file"]').click()},isCanUpload:function(){return!this.pluginData.attr.data.maxNum||0==this.pluginData.attr.data.maxNum||this.pluginData.data.length<this.pluginData.attr.data.maxNum},getDownUrl:function(t){return t.id?this.appConfig.apiBaseUrl+"/site/download/water-mark-img?file_id="+t.id+"&inst_id="+this.getInstId()+"&form_id="+this.forminfo.formId+"&form_key="+this.pluginData.key:this.appConfig.upFileUrl+t.url.split("all/")[1]},getInstId:function(){return this.forminfo.instId?this.forminfo.instId:0},updatefile:function(t){t.stopPropagation();var e=t.currentTarget,a=this;if(void 0!=e.files[0]){if(void 0!=a.pluginData.attr.data.islimit&&a.pluginData.attr.data.islimit){var n=e.files[0].name.lastIndexOf("."),i=e.files[0].name.substring(n).toLowerCase();if(!a.pluginData.attr.data.Haslimit.includes(i.replace(".","")))return void a.$message.error({message:"只能上传 "+a.pluginData.attr.data.Haslimit+" 类型文件"})}if(e.files[0].size>1024*a.pluginData.attr.data.MBlimit*1024)return a.$message.error({message:"您上传的文件超过了"+a.pluginData.attr.data.MBlimit+"MB！"}),void $(e).val("");var r=new FormData;r.append("upfile",e.files[0]);var s=we["a"].getApi("uploadAuth")+"?category=all&inst_id="+this.getInstId(),o=new XMLHttpRequest;o.open("POST",s),o.onload=function(t){var n=JSON.parse(t.currentTarget.response);if("SUCCESS"==n.state){var i=JSON.parse(window.sessionStorage.officeDb_getSiteConfig).imghost,r={name:e.files[0].name,url:i+"/"+n.url,id:n.id};a.pluginData.data.push(r);var s=we["a"].getApi("downloadAuth")+"?file_id="+n.id;a.picArr.push(s),0==a.pluginData.status.modeedit&&a.$emit("sendmessage",a.pluginData),$(e).val("")}else a.$message.error({message:n.state}),$(e).val("")},o.onerror=function(t){a.$message.error({message:"上传失败，请稍后重试！"})},o.send(r)}else $(e).val("")},delfile:function(t,e){e.stopPropagation(),e.preventDefault();var a=e.currentTarget;$(a).parent().siblings("input").val(""),this.pluginData.data.splice(t,1),0==this.pluginData.status.modeedit&&this.$emit("sendmessage",this.pluginData)}},mounted:function(){this.updateData(this.pluginData)}}),Be=Re,Oe=(a("5cda"),Object(d["a"])(Be,Pe,Ne,!1,null,null,null)),Me=Oe.exports,Le=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin",style:t.appCommonH.getStyle(t.getTextStyle())},[a("div",{class:{dform_inputdemo:t.showstyle},on:{click:t.showpop}},[t.pluginData.status.readonly||0!=t.pluginData.data.length?t._e():a("span",[t._v("\n            "+t._s(t.pluginData.attr.data.promptTest?t.pluginData.attr.data.promptTest:t.pluginData.attr.data.typeoptions[t.pluginData.attr.data.type])+"\n          ")]),t._v(" "),t._l(t.pluginData.data,(function(e){return a("span",[t._v(t._s(e.name)+" ")])}))],2)]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dDepart dplugin-mobile-dFile"},[a("div",{staticClass:"dFile-Vie"},[t.pluginData.data.length?a("div",{staticClass:"files-box"},t._l(t.pluginData.data,(function(e,n){return a("a",{staticClass:"filenames ofl",attrs:{href:"javascript:;"}},[a("span",[t._v(t._s(e.name))]),t._v(" "),t.pluginData.status.readonly?t._e():a("i",{staticClass:"icon iconfont iconshanchu1",on:{click:function(e){return e.stopPropagation(),t.delchoosedata(t.pluginData.data,n)}}})])})),0):t._e(),t._v(" "),t.pluginData.status.readonly?t._e():a("div",{staticClass:"dplugin-mobile-fFile-bottom",attrs:{href:"javascript:void(0)"},on:{click:function(e){return e.stopPropagation(),t.showmobilepop(e)}}},[a("span",[t._v(t._s(t.pluginData.attr.data.promptTest?t.pluginData.attr.data.promptTest:t.pluginData.attr.data.typeoptions[t.pluginData.attr.data.type]))]),t._v(" "),a("i",{staticClass:"icon iconfont iconjiantou3"})])])])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n         \n      ")])],t._v(" "),"oneUser"==t.pluginData.attr.data.type||"multiUser"==t.pluginData.attr.data.type||"oneJob"==t.pluginData.attr.data.type||"multiJob"==t.pluginData.attr.data.type?a("el-dialog",{staticClass:"dDepartdialog dDepartcompop",attrs:{title:t.pluginData.attr.data.typeoptions[t.pluginData.attr.data.type],visible:t.dialogVisible,"lock-scroll":!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"dDepartdiTop"},[a("div",[a("el-input",{attrs:{placeholder:"搜索部门","suffix-icon":"el-icon-search"},model:{value:t.filterText,callback:function(e){t.filterText="string"===typeof e?e.trim():e},expression:"filterText"}}),t._v(" "),"oneUser"==t.pluginData.attr.data.type||"multiUser"==t.pluginData.attr.data.type?a("ul",[a("li",{class:{active:"department"==t.userType},on:{click:function(e){return t.changeUserType("department")}}},[t._v("部门")]),t._v(" "),a("li",{class:{active:"job"==t.userType},on:{click:function(e){return t.changeUserType("job")}}},[t._v("岗位")]),t._v(" "),a("li",{class:{active:"team"==t.userType},on:{click:function(e){return t.changeUserType("team")}}},[t._v("标签")])]):t._e()],1),t._v(" "),a("div",["oneUser"==t.pluginData.attr.data.type||"multiUser"==t.pluginData.attr.data.type?a("article",{staticClass:"dDepart_user_search"},[a("el-input",{attrs:{placeholder:"搜索人员","suffix-icon":"el-icon-search"},model:{value:t.searchValue,callback:function(e){t.searchValue="string"===typeof e?e.trim():e},expression:"searchValue"}}),t._v(" "),t.searchList.length?a("i",{staticClass:"el-icon-close",on:{click:function(e){t.searchValue=""}}}):t._e(),t._v(" "),"no"==t.searchList?a("ul",{staticClass:"searchListno"},[t._v("未搜索到该用户")]):t._e(),t._v(" "),"no"!=t.searchList&&t.searchList.length?a("ul",{staticClass:"searchLists"},t._l(t.searchList,(function(e){return a("li",{on:{click:function(a){return a.stopPropagation(),t.chooseoptions(e)}}},[a("span",{domProps:{textContent:t._s(e.name)}}),t._v(" "),a("span",{domProps:{textContent:t._s(e.number)}}),t._v(" "),a("input",{attrs:{type:"checkbox"},domProps:{checked:t.returnchecked(t.pophasoptions,e)}})])})),0):t._e()],1):a("span",[t._v("所有岗位")])]),t._v(" "),a("div",[t._v("已选"+t._s(t.pluginData.attr.data.typeoptions[t.pluginData.attr.data.type].substr(-2))+"\n          "),a("el-button",{attrs:{type:"text"},on:{click:t.clearhasoption}},[t._v("清空")])],1)]),t._v(" "),a("el-tree",{ref:"tree1",class:{eltreepersonal:"oneUser"==t.pluginData.attr.data.type||"multiUser"==t.pluginData.attr.data.type},attrs:{data:t.depart,"highlight-current":!0,props:t.defaultProps,"node-key":"id","expand-on-click-node":!1,"default-expand-all":!1,"default-expanded-keys":t.defaultKeys,"filter-node-method":t.filterNode},on:{"node-click":t.handleNodeClick}}),t._v(" "),a("div",{staticClass:"allpersonal",on:{scroll:t.getmoreoptions}},[a("ul",t._l(t.popalloptions,(function(e,n){return a("li",{on:{click:function(a){return a.stopPropagation(),t.chooseoptions(e)}}},[a("span",{domProps:{textContent:t._s(e.name)}}),t._v(" "),a("span",{domProps:{textContent:t._s(e.number)}}),t._v(" "),a("input",{attrs:{type:"checkbox"},domProps:{checked:t.returnchecked(t.pophasoptions,e)}})])})),0)]),t._v(" "),a("div",{staticClass:"haspersonal"},[a("ul",t._l(t.pophasoptions,(function(e,n){return a("li",[a("span",{domProps:{textContent:t._s(e.name)}}),t._v(" "),a("span",{domProps:{textContent:t._s(e.number)}}),t._v(" "),a("i",{staticClass:"el-icon-circle-close-outline",on:{click:function(e){return t.deloptions(n)}}})])})),0)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.chooseDepart}},[t._v("完 成")])],1)],1):t._e(),t._v(" "),"oneDepart"==t.pluginData.attr.data.type||"multiDepart"==t.pluginData.attr.data.type?a("el-dialog",{staticClass:"dDepartdialogDepart dDepartcompop",attrs:{"lock-scroll":!1,title:t.pluginData.attr.data.typeoptions[t.pluginData.attr.data.type],visible:t.dialogVisibleDepart},on:{"update:visible":function(e){t.dialogVisibleDepart=e}}},[a("div",{staticClass:"dDepartdiTop"},[a("div",[a("el-input",{attrs:{placeholder:"搜索部门","suffix-icon":"el-icon-search"},model:{value:t.filterText,callback:function(e){t.filterText="string"===typeof e?e.trim():e},expression:"filterText"}})],1),t._v(" "),a("div",[t._v("已选部门\n          "),a("el-button",{attrs:{type:"text"},on:{click:t.clearhasoption}},[t._v("清空")])],1)]),t._v(" "),a("el-tree",{ref:"tree2",attrs:{"show-checkbox":"","highlight-current":!0,"default-checked-keys":t.defaultchecked,"check-strictly":!0,data:t.depart,"default-expand-all":!1,props:t.defaultProps,"node-key":"id","default-expanded-keys":t.defaultKeys,"filter-node-method":t.filterNode},on:{"check-change":t.handleNodeClickDepart}}),t._v(" "),a("div",{staticClass:"haspersonal"},[a("ul",t._l(t.departhasoptions,(function(e,n){return a("li",[a("span",{domProps:{textContent:t._s("oneJob"==t.pluginData.attr.data.type||"multiJob"==t.pluginData.attr.data.type?"":e.name)}}),t._v(" "),a("i",{staticClass:"el-icon-circle-close-outline",on:{click:function(e){return t.deloptions(n)}}})])})),0)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(e){t.dialogVisibleDepart=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.chooseDepart}},[t._v("完 成")])],1)],1):t._e(),t._v(" "),!t.pluginData.status.ispc&&t.showmobilepops?a("dDepartMPop",{attrs:{haschoose:t.pluginData.data,showDepart:t.depart,queryType:t.pluginData.attr.data.type,teamLimit:t.pluginData.attr.data.teamLimit},on:{getData:t.getData}}):t._e()],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Ue=[],Fe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"dDepart_m_pop"}},["oneDepart"==t.queryType||"multiDepart"==t.queryType?n("div",{staticClass:"setop"},[n("img",{attrs:{src:a("5264"),alt:""},on:{click:t.inputfocus}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{id:"shinput",type:"text",placeholder:"搜索部门"},domProps:{value:t.keyword},on:{keyup:[t.inputchange,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.inputsure(e)}],input:function(e){e.target.composing||(t.keyword=e.target.value)}}})]):"oneJob"==t.queryType||"multiJob"==t.queryType?n("div",{staticClass:"setop"},[n("img",{attrs:{src:a("5264"),alt:""},on:{click:t.inputfocus}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{id:"shinput",type:"text",placeholder:"搜索岗位"},domProps:{value:t.keyword},on:{keyup:[t.inputchange,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.inputsure(e)}],input:function(e){e.target.composing||(t.keyword=e.target.value)}}})]):n("div",{staticClass:"setop"},[n("img",{attrs:{src:a("5264"),alt:""},on:{click:t.inputfocus}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{id:"shinput",type:"text",placeholder:"姓名/学工号"},domProps:{value:t.keyword},on:{keyup:[t.inputchange,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.inputsure(e)}],input:function(e){e.target.composing||(t.keyword=e.target.value)}}})]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"0"==t.choosedeparts,expression:"choosedeparts == '0'"}]},[n("div",{staticClass:"choosemode"},[n("a",{class:{active:"department"==t.mode},attrs:{href:"javascript:;"},on:{click:function(e){return t.changemode("department")}}},[t._v("部门")]),t._v(" "),n("a",{class:{active:"job"==t.mode},attrs:{href:"javascript:;"},on:{click:function(e){return t.changemode("job")}}},[t._v("岗位")]),t._v(" "),n("a",{class:{active:"team"==t.mode},attrs:{href:"javascript:;"},on:{click:function(e){return t.changemode("team")}}},[t._v("标签")])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"person"==t.way,expression:"way == 'person'"}],staticClass:"choosePerson"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"department"==t.mode,expression:"mode == 'department'"}],staticClass:"pdepart"},[n("ul",[0!=t.departs.id?n("li",{staticClass:"pfanhui",on:{click:t.pfanhui}},[t._v("返回上一级")]):t._e(),t._v(" "),t._l(t.departs.children,(function(e,a){return[e.hiddenauth?t._e():n("li",{key:a,staticClass:"pdepartname ofl"},[n("i",{staticClass:"el-icon-goods",on:{click:function(a){return t.showdpersons(a,e.id,e)}}}),t._v(" "),n("span",{staticClass:"ofl",domProps:{textContent:t._s(e.name)}}),t._v(" "),void 0!=e.children?n("i",{staticClass:"el-icon-arrow-right",on:{click:function(a){return t.changedepart(e)}}}):t._e(),t._v(" "),void 0!=e.departPerson?n("ul",{staticClass:"dpersons",attrs:{"data-p":"1"},on:{scroll:function(a){return t.getepartPerson(a,e.id,e)}}},t._l(e.departPerson,(function(e,a){return n("li",{key:a,staticClass:"ofl"},[n("el-checkbox",{attrs:{label:e.id,name:JSON.stringify(e)},on:{change:t.changelabel},model:{value:t.chooseResultID,callback:function(e){t.chooseResultID=e},expression:"chooseResultID"}}),t._v(" "),n("div",{staticClass:"srright"},[n("p",[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"ofl"},[t._v(t._s(e.number+" "+e.college))])])],1)})),0):t._e()])]}))],2)]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"job"==t.mode,expression:"mode == 'job'"}],staticClass:"pdepart"},[t.job?n("ul",{staticClass:"isnodepart"},t._l(t.job,(function(e,a){return n("li",[n("i",{staticClass:"el-icon-goods",on:{click:function(a){return t.showdpersons(a,e.id,e)}}}),t._v(" "),n("span",{staticClass:"ofl",domProps:{textContent:t._s(""==e.name||void 0==e.name?"暂未命名":e.name)}}),t._v(" "),void 0!=e.departPerson?n("ul",{staticClass:"dpersons",attrs:{"data-p":"1"},on:{scroll:function(a){return t.getepartPerson(a,e.id,e)}}},t._l(e.departPerson,(function(e,a){return n("li",{key:a,staticClass:"ofl"},[n("el-checkbox",{attrs:{label:e.id,name:JSON.stringify(e)},on:{change:t.changelabel},model:{value:t.chooseResultID,callback:function(e){t.chooseResultID=e},expression:"chooseResultID"}}),t._v(" "),n("div",{staticClass:"srright"},[n("p",[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"ofl"},[t._v(t._s(e.number+" "+e.college))])])],1)})),0):t._e()])})),0):t._e()]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"team"==t.mode,expression:"mode == 'team'"}],staticClass:"pdepart"},[t.team?n("ul",{staticClass:"isnodepart"},t._l(t.team,(function(e,a){return e.hiddenauth?t._e():n("li",{key:a},[n("i",{staticClass:"el-icon-goods",on:{click:t.showjobul}}),t._v(" "),n("span",{staticClass:"ofl",domProps:{textContent:t._s(""==e.name||void 0==e.name?"暂未命名":e.name)}}),t._v(" "),void 0!=e.teams?n("ul",{staticClass:"dpersons dpersonteams",attrs:{"data-p":"1"},on:{scroll:function(a){return t.getepartPerson(a,e.id,e)}}},t._l(e.teams,(function(e,a){return e.hiddenauth?t._e():n("li",{key:a,staticClass:"ofl"},[n("i",{staticClass:"el-icon-goods",on:{click:function(a){return t.showdpersons(a,e.id,e)}}}),t._v(" "),n("span",{staticClass:"ofl",domProps:{textContent:t._s(""==e.name||void 0==e.name?"暂未命名":e.name)}}),t._v(" "),void 0!=e.departPerson?n("ul",{staticClass:"dpersons",attrs:{"data-p":"1"},on:{scroll:function(a){return t.getepartPerson(a,e.id,e)}}},t._l(e.departPerson,(function(e,a){return n("li",{key:a,staticClass:"ofl"},[n("el-checkbox",{attrs:{label:e.id,name:JSON.stringify(e)},on:{change:t.changelabel},model:{value:t.chooseResultID,callback:function(e){t.chooseResultID=e},expression:"chooseResultID"}}),t._v(" "),n("div",{staticClass:"srright"},[n("p",[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"ofl"},[t._v(t._s(e.number+" "+e.college))])])],1)})),0):t._e()])})),0):t._e()])})),0):t._e()])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"depart"==t.way,expression:"way == 'depart'"}],staticClass:"chooseDepart"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"department"==t.mode,expression:"mode == 'department'"}],staticClass:"pdepart"},[n("ul",[0!=t.departs.id&&void 0!=t.departs.id?n("li",{staticClass:"pfanhui",on:{click:t.pfanhui}},[t._v("返回上一级")]):t._e(),t._v(" "),t._l(t.departs.children,(function(e,a){return[!e.hiddenauth||t.isChildrenShow(e)?n("li",{key:a,staticClass:"pdepartname ofl"},[n("el-checkbox",{attrs:{disabled:e.hiddenauth,label:e.id,name:JSON.stringify(e)},on:{change:t.changelabel},model:{value:t.chooseResultID,callback:function(e){t.chooseResultID=e},expression:"chooseResultID"}}),t._v(" "),n("span",{staticClass:"ofl",domProps:{textContent:t._s(e.name)}}),t._v(" "),void 0!=e.children?n("i",{staticClass:"el-icon-arrow-right",on:{click:function(a){return t.changedepart(e)}}}):t._e()],1):t._e()]}))],2)]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"job"==t.mode,expression:"mode == 'job'"}],staticClass:"pdepart"},[n("ul",[0!=t.departs.id&&void 0!=t.departs.id?n("li",{staticClass:"pfanhui",on:{click:t.pfanhui}},[t._v("返回上一级")]):t._e(),t._v(" "),t._l(t.departs.children,(function(e,a){return[e.hiddenauth?t._e():n("li",{key:a,staticClass:"pdepartname ofl"},[n("i",{staticClass:"el-icon-goods",on:{click:function(a){return t.showJob(a,e.id,e)}}}),t._v(" "),n("span",{staticClass:"ofl",domProps:{textContent:t._s(e.name)}}),t._v(" "),void 0!=e.children?n("i",{staticClass:"el-icon-arrow-right",on:{click:function(a){return t.changedepart(e)}}}):t._e(),t._v(" "),void 0!=e.departJob?n("ul",{staticClass:"dpersons",attrs:{"data-p":"1"}},t._l(e.departJob,(function(e,a){return n("li",{key:a,staticClass:"ofl"},[n("el-checkbox",{attrs:{label:e.id,name:JSON.stringify(e)},on:{change:t.changelabel},model:{value:t.chooseResultID,callback:function(e){t.chooseResultID=e},expression:"chooseResultID"}}),t._v(" "),n("div",{staticClass:"srright",staticStyle:{"line-height":"0.4rem"}},[n("p",[t._v(t._s(e.name))])])],1)})),0):t._e()])]}))],2)]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"team"==t.mode,expression:"mode == 'team'"}],staticClass:"pdepart"},[t.team?n("ul",{staticClass:"isnodepart"},t._l(t.team,(function(e,a){return n("li",[n("i",{staticClass:"el-icon-goods",on:{click:t.showjobul}}),t._v(" "),n("span",{staticClass:"ofl",domProps:{textContent:t._s(""==e.name||void 0==e.name?"暂未命名":e.name)}}),t._v(" "),void 0!=e.teams?n("ul",{staticClass:"dpersons",attrs:{"data-p":"1"},on:{scroll:function(a){return t.getepartPerson(a,e.id,e)}}},t._l(e.teams,(function(e,a){return n("li",{key:a,staticClass:"ofl"},[n("el-checkbox",{attrs:{label:e.id,name:JSON.stringify(e)},on:{change:t.changelabel},model:{value:t.chooseResultID,callback:function(e){t.chooseResultID=e},expression:"chooseResultID"}}),t._v(" "),n("div",{staticClass:"srright"},[n("p",[t._v(t._s(e.name))])])],1)})),0):t._e()])})),0):t._e()])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"1"==t.choosedeparts,expression:"choosedeparts == '1'"}]},[n("div",{staticClass:"dDepart_m_pop_chooseResult"},[n("ul",{staticClass:"chooseList"},[n("li",{on:{click:function(e){t.choosedeparts="0"}}},[t._v("返回上一级")]),t._v(" "),t._l(t.chooseResult,(function(e,a){return n("li",{key:a},[n("el-checkbox",{attrs:{label:e.id,name:JSON.stringify(e)},on:{change:t.changelabel},model:{value:t.chooseResultID,callback:function(e){t.chooseResultID=e},expression:"chooseResultID"}}),t._v(" "),void 0==e.uid?n("span",{staticClass:"ofl"},[t._v(t._s(e.name))]):n("div",{staticClass:"srright ofl"},[n("p",[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"ofl"},[t._v(t._s(t.getSubInfo(e)))])])],1)}))],2)])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"2"==t.choosedeparts,expression:"choosedeparts == '2'"}]},[n("div",{staticClass:"dDepart_m_pop_person"},[n("ul",{directives:[{name:"show",rawName:"v-show",value:!t.showchooseResult,expression:"!showchooseResult"}],staticClass:"chooseList"},[t._l(t.searchResult,(function(e,a){return n("li",{key:a},[n("el-checkbox",{attrs:{label:e.id,name:JSON.stringify(e)},on:{change:t.changelabel},model:{value:t.chooseResultID,callback:function(e){t.chooseResultID=e},expression:"chooseResultID"}}),t._v(" "),n("div",{staticClass:"srright ofl"},[n("p",[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"ofl"},[t._v(t._s(t.getSubInfo(e)))])])],1)})),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.searchResult.length<1,expression:"searchResult.length < 1"}],staticClass:"nodata"},[t._v("未找到相关信息")])],2),t._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.showchooseResult,expression:"showchooseResult"}],staticClass:"chooseList"},[t._l(t.chooseResult,(function(e,a){return n("li",{key:a},[n("el-checkbox",{attrs:{label:e.id,name:JSON.stringify(e)},on:{change:t.changelabel},model:{value:t.chooseResultID,callback:function(e){t.chooseResultID=e},expression:"chooseResultID"}}),t._v(" "),void 0==e.uid?n("span",{staticClass:"ofl"},[t._v(t._s(e.name))]):n("div",{staticClass:"srright ofl"},[n("p",[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"ofl"},[t._v(t._s(t.getSubInfo(e)))])])],1)})),t._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:0==t.chooseResult.length,expression:"chooseResult.length == 0"}],staticClass:"searchHistory"},[t._l(t.wxsearchHistory,(function(e,i){return i<10?n("div",{key:i,on:{click:function(a){t.keyword=e.keyword}}},[n("img",{attrs:{src:a("5264"),alt:""}}),t._v(" "),n("span",[t._v(t._s(e.keyword))])]):t._e()})),t._v(" "),t.wxsearchHistory.length>0?n("div",{staticClass:"cleardata",on:{click:t.clearsearchHistory}},[t._v("清空搜索记录")]):t._e()],2)],2)])]),t._v(" "),n("div",{staticClass:"choosebtn"},[n("button",{staticClass:"addmyapp",on:{click:t.toyixuan}},[t._v("已选\n      "),t.chooseResult.length>0?[t._v("（"+t._s(t.chooseResult.length)+"）")]:t._e()],2),t._v(" "),n("button",{on:{click:t.backdepartview}},[t._v("完成")])])])},$e=[],He=a("5748"),je={data:function(){return{keyword:"",choosedeparts:"0",depart:[],departs:[],job:[],team:[],way:"person",mode:"department",chooseResult:[],chooseResultID:[],block:!0,searchResult:[],showchooseResult:!1,wxsearchHistory:[],changeDeparts:{},departJob:{}}},props:["haschoose","queryType","showDepart","teamLimit"],created:function(){this.wxsearchHistory=null==JSON.parse(localStorage.getItem("wxsearchHistory"))?[]:JSON.parse(localStorage.getItem("wxsearchHistory")),this.getDepart(),this.getjob(),this.getteam()},mounted:function(){for(var t in $(".nodata").css({lineHeight:$(window).height()-$(".setop").outerHeight()+"px"}),this.chooseResult=this.haschoose,this.chooseResult)this.chooseResultID.push(this.chooseResult[t].id);"oneDepart"==this.queryType||"multiDepart"==this.queryType?(this.way="depart",this.mode="department",$("#dDepart_m_pop").find(".choosemode").hide()):"oneJob"==this.queryType||"multiJob"==this.queryType?(this.way="depart",this.mode="job",$("#dDepart_m_pop").find(".choosemode").hide()):"oneUser"!=this.queryType&&"multiUser"!=this.queryType||(this.way="person")},methods:{getDepart:function(){var t=this;this.appFetch({method:"get",url:"allDepartment"},(function(e){0==e.e?(t.depart=e.d[0],t.showDepart?0==t.showDepart[0].id?t.departs=JSON.parse(JSON.stringify({children:t.showDepart[0].children})):t.departs=JSON.parse(JSON.stringify({children:t.showDepart})):(t.departs=JSON.parse(JSON.stringify(e.d[0])),t.initShowChangeDepart([t.departs],!1))):t.$message.error({message:res.m})}))},getjob:function(){var t=this;t.appFetch({method:"get",url:"allJob",data:{}},(function(e){0==e.e?t.job=e.d:t.$message.error({message:e.e})}))},getteam:function(){var t=this,e=this;this.appFetch({method:"GET",url:"allTeam"},(function(a){0==a.e?t.teamLimit&&t.teamLimit.length?(a.d.forEach((function(e){e.hiddenauth=!0,e.teams&&e.teams.forEach((function(a){a.hiddenauth=!0,t.teamLimit.map((function(t){return t.id})).includes(a.id)&&(e.hiddenauth=!1,a.hiddenauth=!1)}))})),e.team=a.d):e.team=a.d:e.$message.error({message:a.e})}))},getSubInfo:function(t){return t.number?t.number+" "+t.college:"暂无附属信息"},clearsearchHistory:function(){localStorage.removeItem("wxsearchHistory"),this.wxsearchHistory=[]},changelabel:function(t,e){var a=JSON.parse(e.target.name);if(t)this.chooseResult.push(a);else for(var n in this.chooseResult)this.chooseResult[n].id==a.id&&this.chooseResult.splice(n,1)},toyixuan:function(){this.choosedeparts="1"},inputfocus:function(t){$(t.currentTarget).siblings("input").focus()},inputchange:function(t){if(""==$(t.currentTarget).val())$(t.currentTarget).siblings("img").show(),this.choosedeparts="0";else{$(t.currentTarget).siblings("img").hide(),this.choosedeparts="2",$(".chooseList").css({height:$(window).height()+"px"});var e=!1;for(var a in this.wxsearchHistory)this.wxsearchHistory[a].keyword==this.keyword&&(e=!0,this.wxsearchHistory[a].num=this.wxsearchHistory[a].num+1);e||this.wxsearchHistory.push({keyword:this.keyword,num:1}),this.sortsearchHistory(),this.block=!0,this.showchooseResult=!1,"oneDepart"==this.queryType||"multiDepart"==this.queryType?(this.searchResult=[],this.showDepart?this.departfilter(this.departs.children,this.keyword,this.searchResult):this.departfilter([this.depart],this.keyword,this.searchResult)):"oneJob"==this.queryType||"multiJob"==this.queryType?this.jobfilter(this.keyword):"oneUser"!=this.queryType&&"multiUser"!=this.queryType&&""!=this.queryType||this.userFilter(1)}},inputsure:function(t){if(""==$(t.currentTarget).val())this.choosedeparts="0";else{this.choosedeparts="2",$(".chooseList").css({height:$(window).height()+"px"});var e=!1;for(var a in this.wxsearchHistory)this.wxsearchHistory[a].keyword==this.keyword&&(e=!0,this.wxsearchHistory[a].num=this.wxsearchHistory[a].num+1);e||this.wxsearchHistory.push({keyword:this.keyword,num:1}),this.sortsearchHistory(),this.block=!0,this.showchooseResult=!1,"oneDepart"==this.queryType||"multiDepart"==this.queryType?(this.searchResult=[],this.showDepart?this.departfilter(this.departs.children,this.keyword,this.searchResult):this.departfilter([this.depart],this.keyword,this.searchResult)):"oneJob"==this.queryType||"multiJob"==this.queryType?this.jobfilter(this.keyword):"oneUser"!=this.queryType&&"multiUser"!=this.queryType&&""!=this.queryType||this.userFilter(1)}},departfilter:function(t,e,a){for(var n in t)-1!=t[n].name.indexOf(e)&&a.push(t[n]),void 0!=t[n].children&&this.departfilter(t[n].children,e,a)},jobfilter:function(t){var e=[];for(var a in this.job)-1!=this.job[a].name.indexOf(t)&&e.push(this.job[a]);this.searchResult=e},userFilter:function(t){var e=this;0!=this.block&&(this.block=!1,e.appFetch({method:"get",url:"sitesearchuser",data:{type:"name",keyword:e.keyword,p:t}},(function(a){0==a.e?(e.searchResult=[],e.$set(e,"searchResult",a.d.data.concat(e.searchResult)),e.p=t+1,a.d.total<a.d.page*a.d.perpage?e.block=!1:e.block=!0,0==e.searchResult.length&&$(".nodata").css({lineHeight:$(window).height()-$(".setop").outerHeight()+"px"})):(e.$message.error({message:a.m}),e.block=!0)})))},sortsearchHistory:function(){var t=function(t,e){var a=t.num,n=e.num;return a<n?1:a>n?-1:0};this.wxsearchHistory=this.wxsearchHistory.sort(t),localStorage.setItem("wxsearchHistory",JSON.stringify(this.wxsearchHistory))},backdepartview:function(){this.$emit("getData",this.chooseResult)},changemode:function(t){this.mode=t},changedepart:function(t){void 0!=t.children?this.departs=JSON.parse(JSON.stringify(t)):this.$message.success({message:"已是最后一级子部门了！"})},pfanhui:function(){var t=this,e={};this.showDepart?this.getobj2({children:this.showDepart},this.departs.id,(function(e){t.departs=JSON.parse(JSON.stringify(e))})):(e=this.getobj(this.departs.pid,[this.depart],e),this.departs=JSON.parse(JSON.stringify(e[0]))),0!=this.departs.id||"oneUser"!=this.queryType&&"multiUser"!=this.queryType&&""!=this.queryType||$(".choosemode").show(),this.showDepart||this.initShowChangeDepart([this.departs],!1)},getobj:function(t,e,a){for(var n in e){if(e[n].pid==t)return a=e,a;void 0!=e[n].children&&this.getobj(t,e[n].children,a)}},getobj2:function(t,e,a){var n=this;t.children&&t.children.length&&(t.children.filter((function(t){return t.id==e})).length?a(t):t.children.forEach((function(t){n.getobj2(t,e,a)})))},showdpersons:function(t,e,a){var n=t.currentTarget;if(this.block=!0,$(n).siblings("ul").slideToggle(),void 0==a.departPerson){var i=this;i.appFetch({method:"GET",url:"getUserbefore",data:{type:i.mode,keyword:e,p:1}},(function(t){0==t.e?(i.$set(a,"departPerson",t.d.data),i.$nextTick((function(){$(n).siblings("ul").slideDown(),$(n).siblings("ul").attr("data-p",2)})),0==t.d.data.length&&(i.$message.success({message:"该部门下暂无人员！"}),$(n).siblings("ul").attr("data-p",1))):i.$message.error({message:res.m})}))}},getepartPerson:function(t,e,a){var n=t.currentTarget,i=$(t.currentTarget).attr("data-p");if(void 0!=i){var r=0;for(var s in $(n).children("li"))r+=$(n).children("li").eq(s).outerHeight();if(!(r-50>$(n).scrollTop()+$(n).height())&&0!=this.block){this.block=!1;var o=this;o.appFetch({method:"GET",url:"getUserbefore",data:{type:o.mode,keyword:e,p:i}},(function(t){var e;(o.block=!0,0==t.e)?(t.d.data.length<20&&(o.block=!1),(e=a.departPerson).push.apply(e,Object(He["a"])(t.d.data)),$(n).attr("data-p",Number(i)+1)):o.$message.error({message:res.m})}))}}},showjobul:function(t){"none"==$(t.currentTarget).siblings("ul").children(".djobperson").css("display")?$(t.currentTarget).siblings("ul").children(".djobperson").slideDown():$(t.currentTarget).siblings("ul").slideToggle()},initShowChangeDepart:function(t,e){for(var a in t)0==t[a].id||(t[a].hiddenauth=!e),void 0!=t[a].children&&this.initShowChangeDepart(t[a].children,!t[a].hiddenauth)},isChildrenShow:function(t){if(!t.children||!t.children.length)return!1;var e=!1;return this.handleChidrenDepart(t.children,(function(){e=!0})),e},handleChidrenDepart:function(t,e){var a=this;t.forEach((function(t){t.hiddenauth?t.children&&t.children.length&&a.handleChidrenDepart(t.children,e):e()}))},showJob:function(t,e,a){var n=t.currentTarget;if(this.block=!0,$(n).siblings("ul").slideToggle(),void 0==a.departJob){var i=this;i.appFetch({method:"GET",url:"getJob",data:{depart_id:e}},(function(t){0==t.e?(i.$set(a,"departJob",t.d),i.$nextTick((function(){$(n).siblings("ul").slideDown()})),0==Object.keys(t.d).length&&i.$message.success({message:"该部门下暂无岗位！"})):i.$message.error({message:res.m})}))}}},watch:{chooseResult:function(t){("oneDepart"==this.queryType||"oneJob"==this.queryType||"oneUser"==this.queryType)&&this.chooseResult.length>1&&(this.chooseResult=[this.chooseResult[this.chooseResult.length-1]],this.chooseResultID=[this.chooseResultID[this.chooseResultID.length-1]])}}},We=(a("0003"),Object(r["a"])({},je)),ze=We,Ve=Object(d["a"])(ze,Fe,$e,!1,null,null,null),qe=Ve.exports,Ge=Object(s["b"])(s["a"],{name:"dDepart",data:{depart:[],defaultProps:{children:"children",label:"name",disabled:"hiddenauth"},defaultchecked:[],dialogVisible:!1,popalloptions:[],pophasoptions:[],url:"",datas:{},p:1,block:!0,userType:"department",dialogVisibleDepart:!1,departhasoptions:[],showmobilepops:!1,filterText:"",searchList:[],searchValue:"",timeHandler:null,changeDeparts:{},defaultKeys:[],hierarchyNum:0,authApps:[],isShowAllDepart:!1,fatherId:-1,nowPdata:{},showstyle:!1},components:{dDepartMPop:qe},watch:{pluginData:function(t){this.updateData(t)},filterText:function(t){this.$refs.tree2?this.$refs.tree2.filter(t):this.$refs.tree1&&this.$refs.tree1.filter(t)},searchValue:function(t){var e=this;if(""==t)return e.searchList=[],void clearTimeout(e.timeHandler);e.timeHandler&&clearTimeout(e.timeHandler),e.timeHandler=setTimeout((function(){e.appFetch({method:"get",url:"getUserbefore",data:{type:"name",keyword:t}},(function(t){0==t.e?(e.searchList=t.d.data,0==t.d.data.length&&(e.searchList="no")):e.$message.error({message:t.m})}))}),500)}},methods:{updateData:function(t){this.updateClassData(t)},changeUserType:function(t){this.userType=t,"department"==t?this.getDepart():"job"==t?this.getjob():"team"==t&&this.getteam()},delchoosedata:function(t,e){t.splice(e,1)},showmobilepop:function(){this.showmobilepops=!0},getData:function(t){var e=[];t.forEach((function(t){e.push({id:t.id,name:t.name})})),this.pluginData.data=e,this.showmobilepops=!1,0==this.pluginData.status.modeedit&&this.$emit("sendmessage",this.pluginData)},returnchecked:function(t,e){var a=!1;for(var n in t)"oneUser"==this.pluginData.attr.data.type||"multiUser"==this.pluginData.attr.data.type?t[n].uid==e.uid&&(a=!0):t[n].id==e.id&&(a=!0);return a},chooseoptions:function(t){var e,a=0;for(var n in this.pophasoptions)"oneUser"==this.pluginData.attr.data.type||"multiUser"==this.pluginData.attr.data.type?this.pophasoptions[n].uid==t.uid&&(a++,e=n):this.pophasoptions[n].id==t.id&&(a++,e=n);0==a?("oneUser"==this.pluginData.attr.data.type||"oneJob"==this.pluginData.attr.data.type)&&this.pophasoptions.length>0?(this.pophasoptions=[],this.pophasoptions.push(t)):this.pophasoptions.push(t):this.pophasoptions.splice(e,1)},deloptions:function(t){"oneDepart"==this.pluginData.attr.data.type||"multiDepart"==this.pluginData.attr.data.type?(this.departhasoptions.splice(t,1),this.setchecked()):this.pophasoptions.splice(t,1)},clearhasoption:function(){"oneDepart"==this.pluginData.attr.data.type||"multiDepart"==this.pluginData.attr.data.type?(this.departhasoptions=[],this.setchecked()):this.pophasoptions=[]},setchecked:function(){for(var t in this.defaultchecked=[],this.departhasoptions)this.defaultchecked.push(this.departhasoptions[t].id);this.$nextTick((function(){this.$refs.tree2.setCheckedKeys(this.defaultchecked,!0)}))},searchoption:function(t){var e=this;this.p=1,e.appFetch({method:"GET",url:"getUserbefore",data:{type:"name",keyword:this.searchValue}},(function(t){0==t.e&&e.$set(e,"popalloptions",t.d.data)}),(function(t){e.$message.error({message:t.e})}))},handleNodeClick:function(t){var e=this;if($(".allpersonal ul").animate({scrollTop:"0px"},0),this.url="getJob",this.datas={},this.p=1,"oneUser"==this.pluginData.attr.data.type||"multiUser"==this.pluginData.attr.data.type)this.url="getUserbefore",this.datas={type:this.userType,keyword:t.id,p:this.p};else if(("oneJob"==this.pluginData.attr.data.type||"multiJob"==this.pluginData.attr.data.type)&&(this.url="getJob",this.datas={depart_id:t.id},0==t.id))return;e.appFetch({method:"GET",url:e.url,data:e.datas},(function(t){0==t.e&&("getUserbefore"==e.url?(e.$set(e,"popalloptions",t.d.data),e.p=2,e.datas.p=2,e.block=!0):"getJob"==e.url&&(e.$set(e,"popalloptions",t.d),e.p=2,e.datas.p=2,e.block=!0),e.changeCss())}),(function(t){e.$message.error({message:t.e})}))},changeCss:function(){this.$nextTick((function(){$(".allpersonal li").css({displfy:"block",textAlign:"left",display:"flex"}),$(".allpersonal li>span").css({flex:"5"}),$(".allpersonal li>input").css({flex:"2"})}))},getmoreoptions:function(t){var e=t.currentTarget,a=this;$(e).children().height()<$(e).scrollTop()+$(e).height()+20&&"getUserbefore"==a.url&&1==a.block&&(a.block=!1,a.appFetch({method:"GET",url:a.url,data:a.datas},(function(t){0==t.e&&(a.popalloptions=a.popalloptions.concat(t.d.data),a.datas.p=a.datas.p+1,a.block=!0,a.datas.p*t.d.perpage>t.d.total&&(a.block=!1),a.changeCss())}),(function(t){a.$message.error({message:t.e})})))},chooseDepart:function(){if("oneUser"==this.pluginData.attr.data.type||"multiUser"==this.pluginData.attr.data.type||"oneJob"==this.pluginData.attr.data.type||"multiJob"==this.pluginData.attr.data.type){var t=[];this.pophasoptions.forEach((function(e){t.push({id:e.id,name:e.name})})),this.pluginData.data=JSON.parse(JSON.stringify(t)),this.searchValue="",this.dialogVisible=!1}else if("oneDepart"==this.pluginData.attr.data.type||"multiDepart"==this.pluginData.attr.data.type){this.dialogVisibleDepart=!1;t=[];this.departhasoptions.forEach((function(e){t.push({id:e.id,name:e.name})})),this.pluginData.data=JSON.parse(JSON.stringify(t))}0==this.pluginData.status.modeedit&&this.$emit("sendmessage",this.pluginData)},showpop:function(){this.pluginData.status.readonly||this.pluginData.status.formmodeedit||(this.depart[0]&&void 0!=this.depart[0].name&&"根部门"!=this.depart[0].name&&(this.getDepart(),this.userType="department"),0==this.pluginData.attr.data.departlimit.length&&this.pluginData.attr.data.teamLimit&&this.pluginData.attr.data.teamLimit.length&&("oneUser"==this.pluginData.attr.data.type||"multiUser"==this.pluginData.attr.data.type)&&(this.userType="team",this.getteam()),"oneUser"==this.pluginData.attr.data.type||"multiUser"==this.pluginData.attr.data.type||"oneJob"==this.pluginData.attr.data.type||"multiJob"==this.pluginData.attr.data.type?(this.popalloptions=[],this.pophasoptions=JSON.parse(JSON.stringify(this.pluginData.data)),this.dialogVisible=!0,this.$nextTick((function(){this.$refs.tree1.filter()}))):"oneDepart"!=this.pluginData.attr.data.type&&"multiDepart"!=this.pluginData.attr.data.type||(this.dialogVisibleDepart=!0,this.departhasoptions=JSON.parse(JSON.stringify(this.pluginData.data)),this.setchecked(),this.$nextTick((function(){this.$refs.tree2.filter()}))))},handleNodeClickDepart:function(t,e,a){var n,i=0;for(var r in this.departhasoptions)this.departhasoptions[r].id==t.id&&(i++,n=r);1==e?"oneDepart"==this.pluginData.attr.data.type?this.departhasoptions.length>0?(this.departhasoptions=[],this.departhasoptions.push(t),this.setchecked()):this.departhasoptions.push(t):0==i&&this.departhasoptions.push(t):0!=i&&this.departhasoptions.splice(n,1)},filterNode:function(t,e){if("team"==this.userType){var a=!0;return this.pluginData.attr.data.teamLimit&&this.pluginData.attr.data.teamLimit.length&&(a=this.pluginData.attr.data.teamLimit.map((function(t){return t.id})).includes(e.id)),(!t||-1!=e.name.indexOf(t))&&!e.hiddenauth&&a}return t?-1!=e.name.indexOf(t)&&!e.hiddenauth:!e.hiddenauth},changedepartdata:function(t){for(var e in this.pluginData.attr.data.departlimit)for(var a in t)t[a].id==this.pluginData.attr.data.departlimit[e].id&&(t[a].hiddenauth=!1,this.recursiveobj(t[a].children)),void 0!=t[a].children&&this.changedepartdata(t[a].children)},recursiveobj:function(t){for(var e in t)t[e].hiddenauth=!1,void 0!=t[e].children&&this.recursiveobj(t[e].children)},setAuthList:function(t){for(var e in t)this.authApps.includes(t[e].id)&&(this.depart.length&&this.authApps.includes(t[e].pid)?(this.findData(this.depart,t[e].pid),void 0!=this.nowPdata.children?this.nowPdata.children.push({id:t[e].id,name:t[e].name}):void 0==this.nowPdata.children&&(this.nowPdata.children=[{id:t[e].id,name:t[e].name}])):this.depart.push({id:t[e].id,name:t[e].name})),void 0!=t[e].children&&this.setAuthList(t[e].children)},findData:function(t,e){for(var a=0;a<t.length;a++)t[a].id==e&&(this.nowPdata=t[a]),void 0!=t[a].children&&this.findData(t[a].children,e)},initHiddenAuth:function(t){var e=this;for(var a in t)!+a&&this.hierarchyNum++<this.pluginData.attr.data.hierarchy&&t.map((function(t){return e.defaultKeys.push(t.id)})),t[a].hiddenauth=!0,void 0!=t[a].children&&this.initHiddenAuth(t[a].children)},initShowChangeDepart:function(t,e){if(this.appCommonH.isEmptyObj(this.changeDeparts))for(var a in this.pluginData.attr.data.departlimit)this.changeDeparts[this.pluginData.attr.data.departlimit[a].id]=this.pluginData.attr.data.departlimit[a];for(var n in t)0==t[n].id?(t[n].hiddenauth=!this.changeDeparts[t[n].id],void 0!=t[n].children&&this.initShowChangeDepart(t[n].children,!t[n].hiddenauth)):((this.changeDeparts[t[n].id]||e)&&(t[n].hiddenauth=!1),void 0!=t[n].children&&this.initShowChangeDepart(t[n].children,!t[n].hiddenauth))},clearhiddenauth:function(t,e){for(var a in t)t[a].hiddenauth=!0,void 0!=t[a].children&&this.clearhiddenauth(t[a].children);e&&e(t)},sethiddenauth:function(t,e){for(var a in t)t[a].hiddenauth=!1,void 0!=t[a][e]&&this.sethiddenauth(t[a][e],e)},getDepart:function(){var t=this;t.isShowAllDepart=!this.pluginData.status.formmodeedit&&this.pluginData.attr.data.showHierarchy,t.authApps=t.pluginData.attr.data.departlimit.map((function(t){return t.id})),t.appFetch({method:"post",url:"allDepartment",data:{}},(function(e){if(0==e.e){t.depart=[],t.defaultProps.children="children",t.depart=t.isShowAllDepart?[]:e.d,t.isShowAllDepart&&e.d&&t.setAuthList(e.d),t.initHiddenAuth(t.depart),t.initShowChangeDepart(t.depart,!1);var a=setInterval((function(){t.$refs.tree1&&(t.$refs.tree1.filter(),window.clearInterval(a))}),100)}else t.$message.error({message:e.e})}))},getjob:function(){var t=this;t.appFetch({method:"get",url:"allJob",data:{}},(function(e){0==e.e?(t.depart=[],t.defaultProps.children="jobs",t.depart=e.d,t.sethiddenauth(t.depart,"jobs")):t.$message.error({message:e.e})}))},getteam:function(){var t=this,e=this;this.appFetch({method:"GET",url:"allTeam"},(function(a){0==a.e?(e.depart=[],e.defaultProps.children="teams",e.depart=a.d,e.sethiddenauth(e.depart,"chlidren"),t.pluginData.attr.data.teamLimit&&t.pluginData.attr.data.teamLimit.length&&window.setTimeout((function(){e.$refs.tree1.filter()}),10)):t.$message({type:"error",message:a.m,showClose:!0})}),(function(e){t.$message({type:"error",message:"系统错误，请联系管理员",showClose:!0})}))},handleClose:function(t){this.searchValue="",t()}},mounted:function(){this.pluginData.status.readonly||(this.showstyle=!0),this.updateData(this.pluginData)},created:function(){this.getDepart()}}),Ke=Ge,Xe=Object(d["a"])(Ke,Le,Ue,!1,null,null,null),Ye=Xe.exports,Je=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dJoinSign-Vie",style:{width:t.pluginData.attr.data.width,height:t.pluginData.attr.data.height}},[a("div",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("ul",[t._l(t.pluginData.data,(function(e){return a("li",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("div",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(e.name+"："+e.content)),a("span",{style:t.appCommonH.getStyle(t.getTextStyle()),domProps:{textContent:t._s(e.created)}})])])})),t._v(" "),0==t.pluginData.data.length?a("li",[t._v("\n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t")]):t._e()],2)])]):a("div",{staticClass:"dplugin-mobile dplugin-doneplugin dJoinSign-Vie dJoinSign-mobile-Vie",style:{width:t.pluginData.attr.data.width,height:t.pluginData.attr.data.height}},[a("div",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("ul",[t._l(t.pluginData.data,(function(e){return a("li",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("p",{staticClass:"baseinfo",style:t.appCommonH.getStyle(t.getTextStyle())},[a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("i",{staticClass:"icon iconfont iconrenyuan1"}),t._v(" \n\t\t\t\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t\t\t")]),t._v("\n\t\t\t\t\t\t\t\t\t      \n\t\t\t\t\t\t\t\t\t"),a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("i",{staticClass:"icon iconfont iconshijian"}),t._v(" \n\t\t\t\t\t\t\t\t\t\t"+t._s(e.created)+"\n\t\t\t\t\t\t\t\t\t")])]),t._v(" "),a("p",{staticClass:"useropinion"},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.content)+"\n\t\t\t\t\t\t\t\t")])])})),t._v(" "),0==t.pluginData.data.length?a("li",[t._v("\n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t")]):t._e()],2)])])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Ze=[],Qe=Object(s["b"])(s["a"],{name:"dJoinSign",data:{aa:"asdasdsa"},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)}},mounted:function(){this.updateData(this.pluginData)}}),ta=Qe,ea=Object(d["a"])(ta,Je,Ze,!1,null,null,null),aa=ea.exports,na=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",[t._v(t._s(""==t.pluginData.data?" ":t.pluginData.attr.data.front+t.pluginData.data))]):a("input",{class:{dplugin_readonly_input:t.pluginData.status.readonly},attrs:{type:"text",readonly:""},domProps:{value:t.pluginData.status.modeedit?t.pluginData.attr.data.front:t.pluginData.attr.data.front+t.pluginData.data},on:{input:t.totopvalue}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dinput dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",[t._v(t._s(""==t.pluginData.data?" ":t.pluginData.attr.data.front+t.pluginData.data))]):a("input",{class:{dplugin_readonly_input:t.pluginData.status.readonly},attrs:{type:"text",readonly:""},domProps:{value:t.pluginData.status.modeedit?t.pluginData.attr.data.front:t.pluginData.attr.data.front+t.pluginData.data},on:{input:t.totopvalue}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},ia=[],ra=Object(s["b"])(s["a"],{name:"dProjectNumber",watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},totopvalue:function(){0==this.pluginData.status.modeedit&&this.$emit("sendmessage",this.pluginData)},getNumber:function(){if(this.pluginData.data)return!1;var t=this;this.appFetch({method:"get",url:"getProjectnumber",data:{id:this.forminfo.formId,numberLength:this.pluginData.attr.data.numberLength,year:this.pluginData.attr.data.year,month:this.pluginData.attr.data.month,day:this.pluginData.attr.data.day}},(function(e){0==e.e?t.pluginData.data=e.d:console.error("获取表单编号失败")}),(function(){console.error("获取表单编号失败")}))}},mounted:function(){if(this.updateData(this.pluginData),this.forminfo.formId&&0==this.pluginData.status.formmodeedit){var t=this;setTimeout((function(){t.getNumber()}),200)}}}),sa=ra,oa=Object(d["a"])(sa,na,ia,!1,null,null,null),la=oa.exports,ua=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-focus dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",[t._v(t._s(t.pluginData.data))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{dplugin_readonly_input:t.pluginData.status.readonly},attrs:{type:"text",maxlength:t.pluginData.attr.data.passwdLength},domProps:{value:t.pluginData.data},on:{input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.totopvalue]}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dinput dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",[t._v(t._s(t.pluginData.data))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{dplugin_readonly_input:t.pluginData.status.readonly},attrs:{type:"text",maxlength:t.pluginData.attr.data.passwdLength},domProps:{value:t.pluginData.data},on:{input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.totopvalue]}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t \n  \t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},da=[],ca=Object(s["b"])(s["a"],{name:"dinput",data:{1:["0","1","2","3","4","5","6","7","8","9"],4:["@","#","!","$","%","&","*"],3:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],2:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},totopvalue:function(){0==this.pluginData.status.modeedit&&this.$emit("sendmessage",this.pluginData)},init:function(){var t=this;if(!this.pluginData.data&&!this.pluginData.status.formmodeedit&&this.pluginData.status.isshow&&"1"==this.pluginData.attr.data.isRandom){var e=[];0==this.pluginData.attr.data.passwdFormat.length?e=[].concat(Object(He["a"])(this["1"]),Object(He["a"])(this["2"]),Object(He["a"])(this["3"]),Object(He["a"])(this["4"])):this.pluginData.attr.data.passwdFormat.forEach((function(a){var n;(n=e).push.apply(n,Object(He["a"])(t[a]))})),this.pluginData.data=this.passwords(e)}},passwords:function(t){for(var e="",a=t.length,n=0;n<Number(this.pluginData.attr.data.passwdLength);n++){var i=Math.floor(Math.random()*a);e+=t[i]}return e}},mounted:function(){var t=this;this.updateData(this.pluginData),window.setTimeout((function(){t.init()}),300)}}),pa=ca,ha=Object(d["a"])(pa,ua,da,!1,null,null,null),ga=ha.exports,fa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-rtplugin"},[t.isShowSetRow()&&!t.pluginData.status.formmodeedit?[t.pluginData.status.readonly?t.pluginData.status.issave?a("div",{staticClass:"setbutton"},[this.pluginData.attr.setInfo.buttons.import?a("el-button",{attrs:{id:"import"+t.pluginData.key,size:"mini",type:"primary",plain:""}},[t._v("\n\t\t\t\t\t\t导入\n\t\t\t\t\t")]):t._e(),t._v(" "),this.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t导出\n\t\t\t\t\t")]):t._e()],1):t.authH.queryControl("AppManage.archive")?a("div",{staticClass:"setbutton"},[this.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t导出\n\t\t\t\t\t")]):t._e()],1):t._e():a("div",{staticClass:"setbutton"},[this.pluginData.attr.setInfo.buttons.import?a("el-button",{attrs:{id:"import"+t.pluginData.key,size:"mini",type:"primary",plain:""}},[t._v("\n\t\t\t\t\t\t导入\n\t\t\t\t\t")]):t._e(),t._v(" "),this.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t导出\n\t\t\t\t\t")]):t._e(),t._v(" "),this.pluginData.attr.setInfo.buttons.refresh?a("el-button",{attrs:{title:"重新同步该表数据",size:"mini",type:"primary"},on:{click:t.refreshData}},[t._v("\n\t\t\t\t\t\t同步\n\t\t\t\t\t")]):t._e()],1)]:t._e(),t._v(" "),a("div",{staticClass:"clear"}),t._v(" "),t.table.trs?a("table",{staticClass:"formtable",style:t.appCommonH.getStyle(t.table.style,{width:t.table.width+"px"})},[a("tr",{staticClass:"toptr"},[t._l(t.table.tdModels,(function(e,n){return[n<t.table.tdModels.length-1?a("td",{style:t.appCommonH.getStyle(e)}):[!t.getOperateWidth()||t.pluginData.status.formmodeedit||!t.pluginData.status.issave&&t.pluginData.status.readonly?t._e():a("td",{style:t.appCommonH.getStyle(e,{width:t.getOperateWidth()+"px"})})]]}))],2),t._v(" "),t.pluginData.status.formmodeedit?t._l(t.table.trs,(function(e,n){return a("tr",{style:t.appCommonH.getStyle(e.style)},t._l(e.tds,(function(n,i){return i<e.tds.length-1?a("td",{class:t.isSelect(n.id),style:t.appCommonH.getStyle(n.style),attrs:{"data-id":n.id},on:{mousedown:function(e){e.stopPropagation(),t.tdMouserdown(n.id,e),t.tdChangeMousedown(e)},mouseup:function(e){return e.stopPropagation(),t.tdChangeMouseup(e)},mousemove:function(e){return e.stopPropagation(),t.tdChangeMousemove(e)}}},[n.dataid?a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.plugins[n.dataid]},on:{sendmessage:t.setPluginValue}}):t._e()],1):t._e()})),0)})):[t.getPrintRowInfo(0,"prev")?a("tr",{style:t.appCommonH.getStyle(t.getPrintRowInfo(0,"prev").style),attrs:{"data-trindex":"0_prev"}},[a("td",{style:t.appCommonH.getStyle({},{position:"relative",padding:"0px"}),attrs:{colspan:t.getPrintColNum()},on:{mouseup:function(e){return e.stopPropagation(),t.tdPrintMouseUp(e)}}},[t.isPrintMake?a("div",{staticClass:"printLine",on:{mousedown:function(e){return t.tdPrintMouseDown(e,"0_prev")}}}):t._e()])]):t._e(),t._v(" "),a("tr",{style:t.appCommonH.getStyle(t.table.trs[0].style),attrs:{"data-trindex":0}},[t._l(t.table.trs[0].tds,(function(e,n){return[n<t.table.trs[0].tds.length-1?a("td",{style:t.appCommonH.getStyle(e.style)},[e.dataid?a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.plugins[e.dataid]},on:{sendmessage:t.setPluginValue}}):t._e()],1):!t.getOperateWidth()||t.pluginData.status.formmodeedit||!t.pluginData.status.issave&&t.pluginData.status.readonly?t._e():a("td",{style:t.appCommonH.getStyle(e.style,{width:t.getOperateWidth()+"px",textAlign:"center"})},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t操作\n\t\t\t\t\t\t\t\t")])])]}))],2),t._v(" "),t.getPrintRowInfo(0,"next")?a("tr",{style:t.appCommonH.getStyle(t.getPrintRowInfo(0,"next").style),attrs:{"data-trindex":"0_next"}},[a("td",{style:t.appCommonH.getStyle({},{position:"relative",padding:"0px"}),attrs:{colspan:t.getPrintColNum()},on:{mouseup:function(e){return e.stopPropagation(),t.tdPrintMouseUp(e)}}},[t.isPrintMake?a("div",{staticClass:"printLine",on:{mousedown:function(e){return t.tdPrintMouseDown(e,"0_next")}}}):t._e()])]):t._e(),t._v(" "),t._l(t.showAllData,(function(e,n){return[t.getPrintRowInfo(n+1,"prev")?a("tr",{style:t.appCommonH.getStyle(t.getPrintRowInfo(n+1,"prev").style),attrs:{"data-trindex":n+1+"_prev"}},[a("td",{style:t.appCommonH.getStyle({},{position:"relative",padding:"0px"}),attrs:{colspan:t.getPrintColNum()},on:{mouseup:function(e){return e.stopPropagation(),t.tdPrintMouseUp(e)}}},[t.isPrintMake?a("div",{staticClass:"printLine",on:{mousedown:function(e){t.tdPrintMouseDown(e,n+1+"_prev")}}}):t._e()])]):t._e(),t._v(" "),n<t.maxline?a("tr",{style:t.appCommonH.getStyle(t.table.trs[1].style),attrs:{"data-trindex":n+1}},[t._l(t.table.trs[1].tds,(function(e,i){return i<t.table.trs[1].tds.length-1?a("td",{style:t.appCommonH.getStyle(t.table.trs[1].tds[t.getColNum(i)].style)},[t.rtplugins[n]&&t.rtplugins[n][e.dataid]?a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.rtplugins[n][e.dataid]},on:{sendmessage:t.setPluginValue}}):t._e()],1):t._e()})),t._v(" "),!t.pluginData.status.readonly&&t.getOperateWidth()?a("td",{style:t.appCommonH.getStyle(t.table.trs[1].tds[0].style,{width:t.getOperateWidth()+"px",textAlign:"center"})},[t.pluginData.attr.setInfo.buttons.del?a("span",{staticClass:"rtps minus",on:{click:function(e){return t.removeRow(n)}}},[a("i",{staticClass:"fa fa-minus-square",attrs:{title:"删除","aria-hidden":"true"}})]):t._e(),t._v(" "),t.isShowAddButton(n)?a("span",{staticClass:"rtps plus",on:{click:function(e){return t.addRow(n)}}},[a("i",{staticClass:"fa fa-plus-square",attrs:{title:"添加","aria-hidden":"true"}})]):t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.sort?[a("span",{staticClass:"rtps plus",on:{click:function(e){return t.toSort(n,!0)}}},[a("i",{staticClass:"fa fa-arrow-up",attrs:{title:"上升"}})]),t._v(" "),a("span",{staticClass:"rtps plus",on:{click:function(e){return t.toSort(n,!1)}}},[a("i",{staticClass:"fa fa-arrow-down",attrs:{title:"下降"}})])]:t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.copy?[a("span",{staticClass:"rtps plus",on:{click:function(e){return t.copy(++n)}}},[a("i",{staticClass:"fa fa-files-o",attrs:{title:"复制","aria-hidden":"true"}})])]:t._e()],2):!t.pluginData.status.formmodeedit&&t.pluginData.status.readonly&&t.pluginData.status.issave&&t.getOperateWidth()?a("td",{style:t.appCommonH.getStyle(t.table.trs[1].tds[0].style,{width:t.getOperateWidth()+"px",textAlign:"center"})},[t.pluginData.attr.setInfo.buttons.sort?[a("span",{staticClass:"rtps plus",on:{click:function(e){return t.toSort(n,!0)}}},[a("i",{staticClass:"fa fa-arrow-up",attrs:{title:"上升"}})]),t._v(" "),a("span",{staticClass:"rtps plus",on:{click:function(e){return t.toSort(n,!1)}}},[a("i",{staticClass:"fa fa-arrow-down",attrs:{title:"下降"}})])]:t._e()],2):t._e()],2):t._e(),t._v(" "),t.getPrintRowInfo(n+1,"next")?a("tr",{style:t.appCommonH.getStyle(t.getPrintRowInfo(n+1,"next").style),attrs:{"data-trindex":n+1+"_next"}},[a("td",{style:t.appCommonH.getStyle({},{position:"relative",padding:"0px"}),attrs:{colspan:t.getPrintColNum()},on:{mouseup:function(e){return e.stopPropagation(),t.tdPrintMouseUp(e)}}},[t.isPrintMake?a("div",{staticClass:"printLine",on:{mousedown:function(e){t.tdPrintMouseDown(e,n+1+"_next")}}}):t._e()])]):t._e()]})),t._v(" "),t.isShowPage?a("tr",[a("td",{style:t.appCommonH.getStyle(t.table.trs[0].tds[0].style,{textAlign:"right"}),attrs:{colspan:t.getShowSetRowNum}},[a("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper","page-size":t.nowPageSize,"page-count":t.allPageNum,"pager-count":7,"current-page":t.currentPage,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.pageChange}})],1)]):t._e()]],2):t._e(),t._v(" "),a("div",{staticClass:"rtoperationalert"},[a("ul",[t.pluginData.status.formmodeedit?[a("li",{class:" "+(t.operationAlert.removeCol?"":"disbale"),on:{click:function(e){t.operationAlert.removeCol?t.removeCol():t.no}}},[t._v("\n\t\t\t\t\t\t\t删除当前列\n\t\t\t\t\t\t")]),t._v(" "),a("li",{class:" "+(t.operationAlert.addCol?"":"disbale"),on:{click:function(e){t.operationAlert.addCol?t.addCol("left"):t.no}}},[t._v("\n\t\t\t\t\t\t\t左侧插入列\n\t\t\t\t\t\t")]),t._v(" "),a("li",{class:" "+(t.operationAlert.addCol?"":"disbale"),on:{click:function(e){t.operationAlert.addCol?t.addCol("right"):t.no}}},[t._v("\n\t\t\t\t\t\t\t右侧插入列\n\t\t\t\t\t\t")]),t._v(" "),a("li",{class:" "+(t.operationAlert.removeTable?"":"disbale"),on:{click:function(e){t.operationAlert.removeTable?t.removeTable():t.no}}},[t._v("\n\t\t\t\t\t\t\t删除当前表\n\t\t\t\t\t\t")]),t._v(" "),a("li",{on:{click:function(e){return t.selectTable()}}},[t._v("\n\t\t\t\t\t\t\t选中当前表组件\n\t\t\t\t\t\t")])]:t._e(),t._v(" "),!t.pluginData.status.formmodeedit&&t.isPrintMake?[a("li",{class:" "+(t.operationAlert.removeRow?"":"disbale"),on:{click:function(e){t.operationAlert.removeRow?t.removePrintRow():t.no}}},[t._v("\n\t\t\t\t\t\t\t删除当前行\n\t\t\t\t\t\t")]),t._v(" "),a("li",{class:" "+(t.operationAlert.prevPrint?"":"disbale"),on:{click:function(e){t.operationAlert.prevPrint?t.addPrintRow("prev"):t.no}}},[t._v("\n\t\t\t\t\t\t\t上方插入排版行\n\t\t\t\t\t\t")]),t._v(" "),a("li",{class:" "+(t.operationAlert.nextPrint?"":"disbale"),on:{click:function(e){t.operationAlert.nextPrint?t.addPrintRow("next"):t.no}}},[t._v("\n\t\t\t\t\t\t\t下方插入排版行\n\t\t\t\t\t\t")])]:t._e()],2)])],2):a("div",{staticClass:"dplugin-mobile dplugin-rtplugin dplugin-mobile-repeattable"},[t._l(t.pluginData.data,(function(e,n){return t.table.trs?a("div",{staticClass:"tablerow"},[t._l(t.table.trs[1].tds,(function(e,i){return t.rtplugins[n]&&t.rtplugins[n][e.dataid]?a("div",{staticClass:"tableclo"},[a("span",{staticClass:"rpluginname",class:{nacta_color:t.mixNewRetableColor}},[t._v(t._s(t.mobileGetNameByKey(e.dataid)))]),t._v(" "),a("div",{staticClass:"rpluginbox"},[a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.rtplugins[n][e.dataid]},on:{sendmessage:t.setPluginValue}})],1)]):t._e()})),t._v(" "),!t.pluginData.status.readonly&&t.pluginData.attr.setInfo.buttons.del?a("div",{staticClass:"close",on:{click:function(e){return t.removeRow(n)}}}):t._e()],2):t._e()})),t._v(" "),!t.pluginData.status.readonly&&t.pluginData.attr.setInfo.buttons.add?a("span",{staticClass:"addrow",on:{click:function(e){return t.addRow(t.pluginData.data.length-1)}}},[t._v("+ "+t._s(this.pluginData.attr.setInfo.m_addContent?this.pluginData.attr.setInfo.m_addContent:"添加重复表"))]):t._e(),t._v(" "),t.isShowSetRow()&&!t.pluginData.status.formmodeedit?[t.pluginData.status.readonly?t.pluginData.status.issave?a("div",{staticClass:"setbutton"},[this.pluginData.attr.setInfo.buttons.import?a("el-button",{attrs:{id:"import"+t.pluginData.key,size:"mini",type:"primary",plain:""}},[t._v("\n\t\t\t\t\t\t导入\n\t\t\t\t\t")]):t._e(),t._v(" "),this.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t导出\n\t\t\t\t\t")]):t._e()],1):t.authH.queryControl("AppManage.archive")?a("div",{staticClass:"setbutton"},[this.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t导出\n\t\t\t\t\t")]):t._e()],1):t._e():a("div",{staticClass:"setbutton"},[this.pluginData.attr.setInfo.buttons.import?a("el-button",{attrs:{id:"import"+t.pluginData.key,size:"mini",type:"primary",plain:""}},[t._v("\n\t\t\t\t\t\t导入\n\t\t\t\t\t")]):t._e(),t._v(" "),this.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t导出\n\t\t\t\t\t")]):t._e(),t._v(" "),this.pluginData.attr.setInfo.buttons.refresh?a("el-button",{attrs:{title:"重新同步该表数据",size:"mini",type:"primary"},on:{click:t.refreshData}},[t._v("\n\t\t\t\t\t\t同步\n\t\t\t\t\t")]):t._e()],1)]:t._e()],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t \n\t\t")])]],2)},ma=[],va=(a("b722"),a("af86"),a("f1a9"),a("ce3c")),ba=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.sendData&&"dOneInput"==t.sendData.type?a("dOneInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dIntegerInput"==t.sendData.type?a("dIntegerInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dNumericInput"==t.sendData.type?a("dNumericInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dmultiText"==t.sendData.type?a("dmultiText",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dmultiInputs"==t.sendData.type?a("dmultiInputs",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dSelect"==t.sendData.type?a("dSelect",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSelectV2"==t.sendData.type?a("dSelectV2",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRadio"==t.sendData.type?a("dRadio",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dCheckbox"==t.sendData.type?a("dCheckbox",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dInput"==t.sendData.type?a("dInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dImage"==t.sendData.type?a("dImage",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dUser"==t.sendData.type?a("dUser",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCountry"==t.sendData.type?a("dCountry",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCountryV2"==t.sendData.type?a("dCountryV2",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dUserSearch"==t.sendData.type?a("dUserSearch",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dMultiple"==t.sendData.type?a("dMultiple",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dOpinion"==t.sendData.type?a("dOpinion",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCalendar"==t.sendData.type?a("dCalendar",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{ptablesendmessage:t.posttablesendmessage,sendmessage:t.postMessage}}):t.sendData&&"dLink"==t.sendData.type?a("dLink",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dAvatar"==t.sendData.type?a("dAvatar",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dFile"==t.sendData.type?a("dFile",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dDepart"==t.sendData.type?a("dDepart",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dBinding"==t.sendData.type?a("dBinding",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSeal"==t.sendData.type?a("dSeal",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dJoinSign"==t.sendData.type?a("dJoinSign",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dProjectNumber"==t.sendData.type?a("dProjectNumber",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dPasswd"==t.sendData.type?a("dPasswd",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dRepeatTable"==t.sendData.type?a("dRepeatTable",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCount"==t.sendData.type?a("dCount",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSync"==t.sendData.type?a("dSync",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dChildTable"==t.sendData.type?a("dChildTable",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dArticle"==t.sendData.type?a("dArticle",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dHandSignature"==t.sendData.type?a("dHandSignature",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dQuote"==t.sendData.type?a("dQuote",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dRegion"==t.sendData.type?a("dRegion",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dPayment"==t.sendData.type?a("dPayment",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,pluginData:t.sendData,plugin:t.plugin,forminfo:t.forminfo},on:{ptablesendmessage:t.posttablesendmessage,sendmessage:t.postMessage}}):t.sendData&&"dQrcode"==t.sendData.type?a("dQrcode",{attrs:{forminfo:t.forminfo,pluginData:t.sendData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dShow"==t.sendData.type?a("dShow",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSerial"==t.sendData.type?a("dSerial",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dXImage"==t.sendData.type?a("dXImage",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRichText"==t.sendData.type?a("dRichText",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSubmit"==t.sendData.type?a("dSubmit",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRoom"==t.sendData.type?a("dRoom",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dOcr"==t.sendData.type?a("dOcr",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{ptablesendmessage:t.posttablesendmessage,sendmessage:t.postMessage}}):t._e()},ya=[],_a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin seal-img-box seal-pcimg-box",style:{left:t.pluginData.attr.style.left+"px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.pluginData.data.sealImage,expression:"!pluginData.data.sealImage"}],staticClass:"getSeal_div"},[1==t.pluginData.attr.data.sealType?a("div",{staticClass:"name_seal-img seal_nameOrCommon",on:{click:t.getSeal}},[a("img",{attrs:{src:t.appConfig.staticUrl+"img/nameseal.png",alt:""}}),t._v(" "),a("div",{staticClass:"seal_name_text"},[a("p",{domProps:{innerHTML:t._s(this.pluginData.attr.data.defaultText)}})])]):a("div",{staticClass:"common_seal-img seal_nameOrCommon",on:{click:t.getSeal}},[a("img",{attrs:{src:t.appConfig.staticUrl+"img/commonseal.png",alt:""}}),t._v(" "),a("div",{staticClass:"seal_common_text"},[a("p",{domProps:{innerHTML:t._s(this.pluginData.attr.data.defaultText)}}),t._v(" "),a("span",[t._v("("+t._s(t.pluginData.attr.data.sealName?t.pluginData.attr.data.sealName:"公章")+")")])])])]),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.pluginData.data.sealImage,expression:"pluginData.data.sealImage"}],class:[1==t.pluginData.attr.data.sealType?"name_seal-img":"common_seal-img"],attrs:{src:t.pluginData.data.sealImage}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dSeal"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.pluginData.data.sealImage,expression:"!pluginData.data.sealImage"}],staticClass:"getSeal_div"},[a("span",{staticClass:"dplugin-spanBlock",on:{click:t.getSeal}},[a("i",{staticClass:"icon iconfont iconzhang"}),t._v(" "),a("br"),t._v(" "),a("p",{domProps:{innerHTML:t._s(this.pluginData.attr.data.defaultText)}}),t._v(" "),a("br"),t._v(" "),1!=t.pluginData.attr.data.sealType?a("span",[t._v("("+t._s(t.pluginData.attr.data.sealName?t.pluginData.attr.data.sealName:"公章")+")")]):t._e()])]),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.pluginData.data.sealImage,expression:"pluginData.data.sealImage"}],staticClass:"dplugin-image seal-img",attrs:{src:t.pluginData.data.sealImage}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t \n  \t\t\t")])],t._v(" "),a("el-dialog",{staticClass:"sealName_layer seal_layer",attrs:{visible:t.show&&1==t.pluginData.attr.data.sealType,width:"300px","lock-scroll":!1},on:{"update:visible":function(e){return t.$set(t.show&&t.pluginData.attr.data,"sealType == 1",e)}}},[a("div",[a("span",[t._v("请先设置个人签章")]),t._v(" "),a("div",{staticClass:"btn"},[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.show=!1}}},[t._v("取消")]),t._v(" "),t.pluginData.status.ispc?a("router-link",{attrs:{to:{path:"/site/ucenter",query:{showroute:"sealInfo",sealType:"personSeal"}},tag:"a",target:"_blank"}},[t._v("设置")]):a("a",{attrs:{href:t.appConfig.apiBaseUrl+"/v2/site/ucenter?showroute=sealInfo&sealType=personSeal"}},[t._v("设置")])],1)])]),t._v(" "),a("el-dialog",{staticClass:"sealCommon_layer seal_layer",class:[t.pluginData.status.ispc?"sealCommon_layer_pc":"sealCommon_layer_mobile"],attrs:{visible:t.show&&2==t.pluginData.attr.data.sealType,title:"选择公章",width:t.pluginData.status.ispc?"437px":"80%","lock-scroll":!1,center:""},on:{"update:visible":function(e){return t.$set(t.show&&t.pluginData.attr.data,"sealType == 2",e)}}},[a("div",[a("div",{staticClass:"main"},[a("ul",{staticClass:"clearfix"},t._l(t.selectList,(function(e,n){return a("li",{class:{active:t.sealActive==e.seal_id},on:{click:function(a){return t.selectSealFn(e)}}},[a("img",{staticClass:"seal",attrs:{src:e.image,alt:""}}),t._v(" "),a("span",{attrs:{title:e.name}},[t._v(t._s(e.name))])])})),0)]),t._v(" "),a("div",{staticClass:"btn",staticStyle:{"margin-top":"30px"}},[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.show=!1,t.sealActive=0}}},[t._v("取消")]),t._v(" "),a("a",{attrs:{href:"javascript:;"},on:{click:t.selectSealH}},[t._v("确认")])])])]),t._v(" "),a("el-dialog",{staticClass:"sealName_layer seal_layer",attrs:{visible:t.commonSealAuth,width:"300px","lock-scroll":!1},on:{"update:visible":function(e){t.commonSealAuth=e}}},[a("div",[a("span",[t._v("未有公章使用权限，请联系管理员")]),t._v(" "),a("div",{staticClass:"btn"},[a("a",{staticStyle:{"margin-left":"0"},attrs:{href:"javascript:;"},on:{click:function(e){t.commonSealAuth=!1}}},[t._v("确定")])])])]),t._v(" "),t.sealcheckShow?a("sealCheck",{attrs:{ispc:t.pluginData.status.ispc,sealType:t.pluginData.attr.data.sealType,sealConfig:t.sealConfig,sealData:t.sealData},on:{sealCheckF:t.sealCheckF}}):t._e()],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Da=[],Ca=a("97d6"),wa=commonHelper.copyObjFor(s["a"]);wa.data.boxClass["seal_box"]=!0;var xa=Object(s["b"])(wa,{name:"dSeal",components:{sealCheck:Ca["D"]},data:{show:!1,src:"",selectList:[],sealShow:0,sealChoose:{},sealActive:0,commonSealAuth:!1,sealcheckShow:!1,sealData:{},sealConfig:{}},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},updata:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},getSeal:function(t){this.pluginData.status.formmodeedit||this.pluginData.status.readonly||!this.pluginData.status.isshow||(2==this.pluginData.attr.data.sealType&&0==this.pluginData.attr.data.sealId?this.getSealCommon():this.getSealH())},getSealH:function(){var t=this,e=this;this.appFetch({url:"getPdfSeal",method:"POST",data:{seal_type:e.pluginData.attr.data.sealType,seal_id:e.pluginData.attr.data.sealId}},(function(e){0==e.e?(t.sealData={option:1,sealId:e.d.id,sealName:e.d.name,sealImage:e.d.image,sealTime:e.d.created,sealCodeId:e.d.code},t.getSealConfig()):"没有名章，请创建"==e.m?t.show=!0:"没有这个章的权限"==e.m?t.commonSealAuth=!0:(t.$message(e.m),t.pluginData.attr.data.sealId=0)}),(function(e){t.$message("系统错误")}))},getSealCommon:function(){var t=this;console.log("获取公章列表"),this.appFetch({url:"mySeal",method:"GET",data:{}},(function(e){0==e.e?0!=e.d.length?(t.selectList=e.d,t.show=!0):t.commonSealAuth=!0:t.$message(e.m)}),(function(e){t.$message("系统错误")}))},selectSealFn:function(t){this.sealActive!=t.seal_id?this.sealActive=t.seal_id:this.sealActive=0},selectSealH:function(){this.pluginData.attr.data.sealId=this.sealActive,0!=this.pluginData.attr.data.sealId&&this.getSealH(),this.updata(),this.show=!1},sealShowSure:function(){this.pluginData.attr.data.sealId=this.sealChoose.id,this.pluginData.data={option:1,sealId:this.sealChoose.id,sealName:this.sealChoose.name,sealImage:this.sealChoose.image,sealTime:this.sealChoose.created,sealCodeId:this.sealChoose.user_code},this.sealShow=0},sealCheckF:function(t){t&&(this.pluginData.data=this.sealData,this.updata()),this.sealcheckShow=!1},getSealConfig:function(){var t=this;this.appFetch({url:"sealConfig",method:"get"},(function(e){0==e.e?0==e.d.not_validate?(t.sealcheckShow=!0,t.sealConfig=e.d):(t.pluginData.data=t.sealData,t.updata()):t.$message.error(e.m)}),(function(e){t.$message.error("系统错误")}))}},mounted:function(){this.pluginData.status.ispc||(this.boxClass.seal_box=!1),this.updateData(this.pluginData)}}),ka=xa,Sa=Object(d["a"])(ka,_a,Da,!1,null,null,null),Aa=Sa.exports,Ea=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dhandsign"},[t.isShow(t.pluginData.data)?a("div",[t.pluginData.status.readonly?a("span",{staticClass:"dplugin-spanBlock"},[t._v(" ")]):a("span",{staticClass:"dplugin-spanBlock",on:{click:t.getSealConfig}},[t._v("点击签名")])]):t._e(),t._v(" "),t.isShow(t.pluginData.data)?t._e():a("img",{staticClass:"dplugin-image",attrs:{src:t.pluginData.data.signImage?t.pluginData.data.signImage:t.pluginData.data}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dHandSignature dhandsign"},[t.isShow(t.pluginData.data)?a("div",[t.pluginData.status.readonly?a("span",{staticClass:"dplugin-spanBlock"},[t._v(" ")]):a("span",{staticClass:"dplugin-spanBlock",on:{click:t.getSealConfig}},[t._v("\n  \t\t\t\t\t  点击显示签名\n  \t\t\t\t\t")])]):t._e(),t._v(" "),t.isShow(t.pluginData.data)?t._e():a("img",{staticClass:"dplugin-image",attrs:{src:t.pluginData.data.signImage?t.pluginData.data.signImage:t.pluginData.data}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t \n  \t\t\t")])],t._v(" "),t.sealcheckShow?a("sealCheck",{attrs:{ispc:t.pluginData.status.ispc,sealType:0,sealConfig:t.sealConfig,sealData:t.sealData},on:{sealCheckF:t.sealCheckF}}):t._e()],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Ta=[],Ia=a("599e"),Pa=a("0227"),Na=Object(s["b"])(s["a"],{name:"dHandSignature",mixins:[Ia["a"],Pa["a"]],components:{sealCheck:Ca["D"]},data:{sealcheckShow:!1,sealData:{},sealConfig:{}},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},updata:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},getSealConfig:function(){var t=this;this.pluginData.status.readonly||this.pluginData.status.formmodeedit||this.appFetch({url:"sealConfig",method:"get"},(function(e){0==e.e?0==e.d.not_validate?(t.sealConfig=e.d,t.sealcheckShow=!0):t.getSeal():t.$message.error(e.m)}),(function(e){t.$message.error("系统错误")}))},getSeal:function(){var t=this,e=this;this.appFetch({url:this.mixGetSealUrl,method:"get",data:this.mixGetSealPostData()},(function(a){if(0!=a.e||a.d.id||(a.e=-1,a.m="签名不存在！"),0==a.e&&a.d.id){var n={option:1,signId:a.d.id,signName:a.d.name,signImage:a.d.image,signTime:a.d.created};t.pluginData.data=n,t.updata()}else e.$message.error({message:a.m})}),(function(e){t.$message.error("系统错误")}))},sealCheckF:function(t){t&&this.getSeal(),this.sealcheckShow=!1},isShow:function(t){return!t||$.isEmptyObject(t)}},mounted:function(){this.updateData(this.pluginData)}}),Ra=Na,Ba=Object(d["a"])(Ra,Ea,Ta,!1,null,null,null),Oa=Ba.exports,Ma=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox",staticStyle:{position:"static"}},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-focus dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",[t._v(t._s(t.pluginData.data))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],attrs:{type:"text"},domProps:{value:t.pluginData.data},on:{focus:function(e){return t.valueChange(e,"")},blur:t.hideLikes,input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.valueChange]}}),t._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:t.showLikes,expression:"showLikes"}],staticClass:"position-absolute ul-style scroll-ul"},t._l(t.likes,(function(e){return a("li",{staticClass:"li-style",on:{click:function(a){return t.valueChange(a,e.name)}}},[t._v(t._s(e.name))])})),0)]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dBanding dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",[t._v(t._s(t.pluginData.data?t.pluginData.data:" "))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],attrs:{type:"text",placeholder:"暂无绑定信息"},domProps:{value:t.pluginData.data},on:{focus:function(e){return t.valueChange(e,"")},blur:t.hideLikes,input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.valueChange]}}),t._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:t.showLikes,expression:"showLikes"}],staticClass:"position-absolute ul-style scroll-ul"},t._l(t.likes,(function(e){return a("li",{staticClass:"li-style",on:{click:function(a){return t.valueChange(a,e.name)}}},[t._v(t._s(e.name))])})),0)])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},La=[],Ua=Object(s["b"])(s["a"],{name:"dBanding",props:["plugin"],data:{likes:{},showLikes:!1},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},hideLikes:function(){var t=this;setTimeout((function(){t.showLikes=!1}),400)},valueChange:function(t,e){if(!this.pluginData.attr.data.bindList.length||this.pluginData.status.formmodeedit)return!1;e&&(this.showLikes=!1,this.pluginData.data=e),this.postMessage(this.pluginData);var a={keyword:this.pluginData.data,type:this.pluginData.attr.data.api,mode:this.pluginData.attr.data.mode},n=this;this.likes={},this.appFetch({url:"searchBindInfo",data:a,method:"GET"},(function(t){0==t.e?("like"!=n.pluginData.attr.data.mode||$.isEmptyObject(t.d.likeList)||(n.likes=t.d.likeList,n.showLikes=!e),n["setInfo"+n.pluginData.attr.data.type](t.d.result)):n.$message.error("绑定控件获取数据失败")}),(function(){n.$message.error("绑定控件获取数据失败")}))},setInfo1:function(t){var e=this;for(var a in this.plugin.plugins){var n=this.plugin.plugins[a];this.pluginData.attr.data.bindList.forEach((function(a){if(a.pluginkey&&a.columnKey&&n.key==a.pluginkey){var i=t[a.columnKey]?t[a.columnKey]:"";n.data!=i&&(n.data=i,e.postMessage(n))}}))}},setInfo2:function(t){var e=this.pluginData.status.ispc?$('[data-key="'+this.pluginData.key+'"]').parents("tr").index()-2:$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow").index(),a=this.plugin.plugins[this.pluginData.pkey].data[e],n=this;this.pluginData.attr.data.bindList.forEach((function(e){if(e.pluginkey&&e.columnKey&&void 0!==a[e.pluginkey]){var i=n.getKey(e.pluginkey),r=t[e.columnKey]?t[e.columnKey]:"";i&&a[e.pluginkey]!=r&&n.postMessage({key:i,data:r})}}))},getKey:function(t){var e=null,a=this.plugin.plugins[this.pluginData.pkey],n=a.attr.data.tableData?a.attr.data.tableData:a.attr.data;n.trs[1].tds.forEach((function(a,n){t==a.dataid&&(e=n)}));var i="";return e&&(i=this.pluginData.status.ispc?$('[data-key="'+this.pluginData.key+'"]').parents("tr:eq(0)").find("td:eq("+e+")").find(".dplugin-box").attr("data-key"):$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow:eq(0)").find(".tableclo:eq("+e+")").find(".dplugin-box").attr("data-key")),i}},mounted:function(){this.updateData(this.pluginData)}}),Fa=Ua,$a=Object(d["a"])(Fa,Ma,La,!1,null,null,null),Ha=$a.exports,ja=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-focus dinput-vie",class:{lineinput:t.pluginData.attr.data.styleType&&t.pluginData.status.readonly},staticStyle:{"word-break":"break-all"},style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.data))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{dplugin_readonly_input:t.pluginData.status.readonly,lineinput:t.pluginData.attr.data.styleType},style:t.appCommonH.getStyle(t.getTextStyle()),domProps:{value:t.pluginData.data},on:{input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.totopvalue]}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dBanding dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.data?t.pluginData.data:" "))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],class:{dplugin_readonly_input:t.pluginData.status.readonly},style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{placeholder:"暂无引用信息"},domProps:{value:t.pluginData.data},on:{input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.totopvalue]}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Wa=[],za=Object(s["b"])(s["a"],{name:"dinput",data:{},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},totopvalue:function(){0==this.pluginData.status.modeedit&&this.$emit("sendmessage",this.pluginData)}},mounted:function(){this.updateData(this.pluginData)}}),Va=za,qa=Object(d["a"])(Va,ja,Wa,!1,null,null,null),Ga=qa.exports,Ka=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-focus dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",{style:{fontFamily:t.appCommonH.getStyle(t.getTextStyle())["fontFamily"]}},[t._v(t._s(t.pluginData.data.value))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data.value,expression:"pluginData.data.value"}],style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{type:"text"},domProps:{value:t.pluginData.data.value},on:{input:[function(e){e.target.composing||t.$set(t.pluginData.data,"value",e.target.value)},t.userToChange]}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dinput dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",[t._v(t._s(t.pluginData.data.value?t.pluginData.data.value:" "))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data.value,expression:"pluginData.data.value"}],style:t.appCommonH.getStyle(t.getTextStyle()),attrs:{placeholder:"暂无动态计算信息",type:"text"},domProps:{value:t.pluginData.data.value},on:{input:[function(e){e.target.composing||t.$set(t.pluginData.data,"value",e.target.value)},t.userToChange]}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Xa=[],Ya=(a("84c2"),a("f69e")),Ja=a("25f0"),Za=a.n(Ja);Za.a.config({number:"BigNumber",precision:20});var Qa=Object(s["b"])(s["a"],{name:"dCount",props:["plugin"],data:{lastData:"",lastAllData:""},watch:{pluginData:function(t){this.updateData(t),this.setParamet()},allplugin:function(){this.updateData(this.pluginData)}},methods:{updateData:function(t){var e=this;this.updateClassData(t),this.appCommonH.debounce(this.forminfo.formId+"_"+this.pluginData.key,(function(){e.countResult()}),500)},userToChange:function(){this.pluginData.data.value!=this.lastData&&(this.pluginData.data.type=1),this.postMessage(this.pluginData)},countResult:function(){if(this.pluginData.status.formmodeedit||this.pluginData.data.type)return!1;var t=this.getKeyVal(),e=JSON.stringify(t);if(this.lastAllData==e)return!1;this.lastAllData=e;var a=Ya["a"].getResult(this.pluginData.attr.data.rule,t);if(isNaN(a))return!1;isNaN(a)||isNaN(this.lastData)||this.lastData===a||0!=this.pluginData.status.formmodeedit||(this.lastData=a,this.$set(this.pluginData.data,"value",a),this.$emit("sendmessage",this.pluginData))},getKeyVal:function(){var t={};switch(this.pluginData.attr.data.type){case"nrtablecount":for(var e in this.pluginData.attr.data.keyval){var a=this.pluginData.attr.data.keyval[e];if("plugin"==a.type){if(!this.allplugin.plugins[a.key])continue;t[e]=a.evalVar,t[a.key+"Data"]=this.allplugin.plugins[a.key]?this.allplugin.plugins[a.key].data:""}else t[e]=a.evalMethod}break;case"rtablerowcount":if(this.pluginData.status.ispc)var n=$('[data-key="'+this.pluginData.key+'"]').parents("tr").index()-2;else n=$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow").index();for(var e in this.pluginData.rowCol&&(n=this.pluginData.rowCol.rownum),this.pluginData.attr.data.keyval){a=this.pluginData.attr.data.keyval[e];if("plugin"==a.type){if(!this.allplugin.rtplugins[a.key])continue;t[e]=a.evalVar,t[a.key+"Data"]=this.getColByPkey(a.pkey,a.key,n)}else t[e]=a.evalMethod}break;case"rtablesum":for(var e in this.pluginData.attr.data.keyval){a=this.pluginData.attr.data.keyval[e];if("plugin"==a.type){if(!this.allplugin.rtplugins[a.key])continue;t[e]=a.evalVar,t[a.key+"Data"]=this.getColAndByPkey(a.pkey,a.key)}else t[e]=a.evalMethod}break}return t},getColByPkey:function(t,e,a){for(var n in this.allplugin.plugins)if(n==t){var i=this.allplugin.plugins[n];if(i.data[a])return i.data[a][e]}return""},getColAndByPkey:function(t,e){var a=this,n=0;for(var i in this.allplugin.plugins)if(i==t){var r=this.allplugin.plugins[i];n="";r.data.forEach((function(t){var i=a.pluginData.attr.data.handleRule,r=t[e]?a.getDataByPlugin(t[e],e):0;if(i&&-1!==i.indexOf("{p_data}")){var s=i.replace(new RegExp("{p_data}","g"),r);n=+Za.a.eval(n+" + "+Number(Ya["a"].getResult(s,{})))}else n=+Za.a.eval(n+" + "+Number(r))}))}return-1!==e.indexOf("Count")?{value:n}:n},getDataByPlugin:function(t,e){return-1!==e.indexOf("Count")&&void 0!==t.value?t.value:t},setParamet:function(){if(!isNaN(+this.pluginData.data.value)&&!this.pluginData.status.formmodeedit&&this.pluginData.attr.data.bind&&void 0!=this.allplugin.plugins[this.pluginData.attr.data.bind]){var t=Object(r["a"])({},this.allplugin.plugins[this.pluginData.attr.data.bind]);this.pluginData.data.value?t.data=Object(f["a"])(+this.pluginData.data.value):t.data="",this.$emit("sendmessage",t)}}},created:function(){void 0==this.pluginData.attr.data.bind&&(this.pluginData.attr.data.bind=""),"string"!=typeof this.pluginData.data&&"number"!=typeof this.pluginData.data||(this.pluginData.data={value:this.pluginData.data,type:0})},mounted:function(){this.setParamet()}}),tn=Qa,en=Object(d["a"])(tn,Ka,Xa,!1,null,null,null),an=en.exports,nn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-pc-dregion",style:t.appCommonH.getStyle(t.getTextStyle())},[a("span",{style:1==t.pluginData.attr.data.type?"color:#4285f4":"",on:{click:t.showdregionbtn}},[t._v("\n            "+t._s(""==t.pluginData.data.address?t.getBtnText():t.pluginData.data.address)+"\n          ")])]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dregion",style:t.appCommonH.getStyle(t.getTextStyle())},[a("span",{style:1==t.pluginData.attr.data.type?"color:#4285f4":"",on:{click:t.showdregionbtn}},[t._v("\n            "+t._s(""==t.pluginData.data.address?t.getBtnText():t.pluginData.data.address)+"\n          ")])])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n           \n        ")])],t._v(" "),t.showdregion?a("div",{staticClass:"showdregions"},[t.pluginData.status.ispc?a("button",{staticClass:"el-dialog__headerbtn",attrs:{type:"button","aria-label":"Close"},on:{click:function(e){t.showdregion=!1}}},[a("i",{staticClass:"el-dialog__close el-icon el-icon-close"})]):t._e(),t._v(" "),a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("ul",{staticClass:"tip"},[Number(t.pluginData.attr.data.limitval)>0?a("li",{class:{actived:1==t.regionstep},on:{click:function(e){t.regionstep=1}}},[t._v("\n              省份\n              "),t.pluginData.status.ispc?t._e():a("i")]):t._e(),t._v(" "),Number(t.pluginData.attr.data.limitval)>1?a("li",{class:{actived:2==t.regionstep},on:{click:function(e){t.regionstep=2}}},[t._v("\n              城市\n              "),t.pluginData.status.ispc?t._e():a("i")]):t._e(),t._v(" "),Number(t.pluginData.attr.data.limitval)>2?a("li",{class:{actived:3==t.regionstep},on:{click:function(e){t.regionstep=3}}},[t._v("\n              区县\n              "),t.pluginData.status.ispc?t._e():a("i")]):t._e(),t._v(" "),Number(t.pluginData.attr.data.limitval)>3?a("li",{class:{actived:4==t.regionstep},on:{click:function(e){t.regionstep=4}}},[t._v("\n              详细地址\n            ")]):t._e()]),t._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:1==t.regionstep,expression:"regionstep==1"}],staticClass:"provinces"},[a("li",[a("span",[t._v("A-G")]),t._v(" "),a("div",[t._l(t.returnregion(),(function(e,n,i){return t.ag.includes(e.letter)?t._l(e.data,(function(e,n,i){return a("span",{class:{actived:t.pluginData.data.province.label==e},on:{click:function(a){return t.getvalue(e,t.regioninfo)}}},[t._v(t._s(e))])})):t._e()}))],2)]),t._v(" "),a("li",[a("span",[t._v("H-K")]),t._v(" "),a("div",[t._l(t.returnregion(),(function(e,n,i){return t.hk.includes(e.letter)?t._l(e.data,(function(e,n,i){return a("span",{class:{actived:t.pluginData.data.province.label==e},on:{click:function(a){return t.getvalue(e,t.regioninfo)}}},[t._v(t._s(e))])})):t._e()}))],2)]),t._v(" "),a("li",[a("span",[t._v("L-S")]),t._v(" "),a("div",[t._l(t.returnregion(),(function(e,n,i){return t.ls.includes(e.letter)?t._l(e.data,(function(e,n,i){return a("span",{class:{actived:t.pluginData.data.province.label==e},on:{click:function(a){return t.getvalue(e,t.regioninfo)}}},[t._v(t._s(e))])})):t._e()}))],2)]),t._v(" "),a("li",[a("span",[t._v("T-Z")]),t._v(" "),a("div",[t._l(t.returnregion(),(function(e,n,i){return t.tz.includes(e.letter)?t._l(e.data,(function(e,n,i){return a("span",{class:{actived:t.pluginData.data.province.label==e},on:{click:function(a){return t.getvalue(e,t.regioninfo)}}},[t._v(t._s(e))])})):t._e()}))],2)])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2==t.regionstep,expression:"regionstep==2"}],staticClass:"city"},t._l(t.citylist,(function(e,n,i){return a("span",{class:{actived:t.pluginData.data.city.label==e.label},on:{click:function(a){return t.getarea(e.label,t.citylist)}}},[t._v(t._s(e.label))])})),0),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:3==t.regionstep,expression:"regionstep==3"}],staticClass:"county"},t._l(t.arealist,(function(e,n,i){return a("span",{class:{actived:t.pluginData.data.area.label==e.label},on:{click:function(a){return t.getaddress(e.label,t.arealist)}}},[t._v(t._s(e.label))])})),0),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:4==t.regionstep,expression:"regionstep==4"}],staticClass:"address"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data.details,expression:"pluginData.data.details"}],attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"详细地址：如道路、门牌号、小区、楼栋号、单元室等"},domProps:{value:t.pluginData.data.details},on:{input:function(e){e.target.composing||t.$set(t.pluginData.data,"details",e.target.value)}}})])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("button",{on:{click:t.resetregion}},[t._v("重 置")]),t._v(" "),a("button",{staticClass:"sure",on:{click:t.suredata}},[t._v("确 定")])])]):t._e()],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},rn=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"tip title"},[a("li",{staticStyle:{"line-height":"64px"}},[t._v("\n              选择地址\n            ")])])}],sn=(a("6d09"),a("2984"),a("ee61")),on=a.n(sn),ln=a("ee62"),un=a.n(ln),dn=Object(s["b"])(s["a"],{name:"dregion",data:{showdregion:!1,regionstep:1,regioninfo:[],ag:["a","b","c","d","e","f","g"],hk:["h","i","j","k"],ls:["l","m","n","o","p","q","r","s"],tz:["t","u","v","w","x","y","z"],citylist:[],arealist:[]},watch:{pluginData:function(t){this.updateData(t)}},methods:{getBtnText:function(){return this.pluginData.attr.data.type?"获取地理位置":"选择"+this.pluginData.attr.data.limit[this.pluginData.attr.data.limitval]},updateData:function(t){this.updateClassData(t)},returnregion:function(){var t=[];for(var e in this.regioninfo)t.push(this.regioninfo[e].label);function a(t){if(!String.prototype.localeCompare)return null;var e,a="abcdefghjklmnopqrstwxyz".split(""),n=[];return a.forEach((function(a,i){e={letter:a,data:[]},t.forEach((function(t){"重"==t[0]?"c"==a&&e.data.push(t):un.a.utils.makePy(t[0],!0).toLowerCase()==a&&e.data.push(t)})),e.data.length&&(n.push(e),e.data.sort((function(t,e){return t.localeCompare(e)})))})),n}return t.sort((function(t,e){return t.localeCompare(e)})),t=a(t),t},getvalue:function(t,e){for(var a in e)e[a].label==t&&(this.pluginData.data.province={label:e[a].label,value:e[a].value},this.citylist=e[a].children?e[a].children:[],this.arealist=[],this.pluginData.data.area={label:"",value:""},this.pluginData.data.city={label:"",value:""},Number(this.pluginData.attr.data.limitval)>1&&(this.regionstep=2))},getarea:function(t,e){for(var a in e)e[a].label==t&&(this.pluginData.data.city={label:e[a].label,value:e[a].value},this.arealist=e[a].children?e[a].children:[],Number(this.pluginData.attr.data.limitval)>2&&(this.regionstep=3))},getaddress:function(t,e){for(var a in e)e[a].label==t&&(this.pluginData.data.area={label:e[a].label,value:e[a].value},Number(this.pluginData.attr.data.limitval)>3&&(this.regionstep=4))},totopvalue:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},showdregionbtn:function(){this.pluginData.status.readonly||this.pluginData.status.formmodeedit||(this.pluginData.attr.data.type&&!this.pluginData.status.ispc?this.getmiddle():(this.regionstep=1,this.showdregion=!0))},getLocal:function(t){var e=this;function a(){var a=on.a.service({text:"定位中...",background:"rgba(0, 0, 0, 0.8)"}),n=new AMap.Map("iCenter");n.plugin("AMap.Geolocation",(function(){var i=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,maximumAge:0});n.addControl(i),i.getCurrentPosition(),AMap.event.addListener(i,"complete",(function(e){setTimeout((function(){t(!0,e.addressComponent,e.formattedAddress),a.close()}),2e3)})),AMap.event.addListener(i,"error",(function(n){setTimeout((function(){t(!1,n),a.close(),e.$message.error({message:"获取地理位置失败，请点击重试",duration:3e3,showClose:!0})}),2e3)}))}))}if("undefined"!=typeof AMap)a();else{var n=document.createElement("script");n.src="https://webapi.amap.com/maps?v=1.4.4&key=729923f88542d91590470f613adb27b5&plugin=AMap.Driving",n.type="text/javascript",n.onload=function(){a()},document.getElementsByTagName("body")[0].appendChild(n)}},resetregion:function(){this.pluginData.data={address:"",details:"",province:{label:"",value:""},city:{label:"",value:""},area:{label:"",value:""}},this.regionstep=1},suredata:function(){this.pluginData.data.address=(""==this.pluginData.data.province.label?"":this.pluginData.data.province.label+"/")+(""==this.pluginData.data.city.label?"":this.pluginData.data.city.label+"/")+(""==this.pluginData.data.area.label?"":this.pluginData.data.area.label+"/")+(""==this.pluginData.data.details?"":this.pluginData.data.details),"/"==this.pluginData.data.address.substr(this.pluginData.data.address.length-1,1)&&(this.pluginData.data.address=this.pluginData.data.address.substr(0,this.pluginData.data.address.length-1)),this.totopvalue(),this.showdregion=!1},getmiddle:function(){var t=this;this.getLocal((function(e,a,n){if(e){var i;switch(t.pluginData.attr.data.limitval){case"1":i="".concat(a.province);break;case"2":i="".concat(a.province).concat(""!=a.city?"/"+a.city:"");break;case"3":i="".concat(a.province).concat(""!=a.city?"/"+a.city:"").concat(""!=a.district?"/"+a.district:"");break;case"4":i="".concat(a.province).concat(""!=a.city?"/"+a.city:"").concat(""!=a.district?"/"+a.district:"").concat(""!=n.replace(a.province+a.city+a.district,"")?"/"+n.replace(a.province+a.city+a.district,""):"");break}t.pluginData.data={address:i,details:n.replace(a.province+a.city+a.district,""),province:{label:a.province,value:""},city:{label:a.city,value:""},area:{label:a.district,value:""}},t.totopvalue()}}))}},mounted:function(){this.pluginData.status.readonly||this.pluginData.status.formmodeedit||this.pluginData.status.ispc||this.pluginData.attr.data.type&&1==this.pluginData.attr.data.place&&this.getmiddle(),this.updateData(this.pluginData)},created:function(){var t=this;this.appFetch({method:"GET",url:"region"}).then((function(e){if(0==e.e){var a=e.d;t.pluginData.attr.data.hideProvinces&&(a=a.filter((function(e){return!t.pluginData.attr.data.hideProvinces.includes(e.value)}))),t.regioninfo=a}else t.$message.error({message:e.e})})).catch((function(e){t.$message.error({message:"系统错误"})}))}}),cn=dn,pn=Object(d["a"])(cn,nn,rn,!1,null,null,null),hn=pn.exports,gn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[t.pluginData.status.readonly?a("div",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("span",[t._v(t._s(t.pluginData.attr.data.goods_name))]),t._v(" "),void 0==t.pluginData.data.status?a("span",[t._v("未支付")]):1==t.pluginData.data.status?[a("span",[t._v("已支付")]),t._v(" "),2!=this.pluginData.attr.data.pay_type?a("span",[t._v(t._s(t._f("setMoney")(t.pluginData.data.pay_money))+"元")]):t._e()]:1!=t.pluginData.data.status?[a("span",[t._v("支付失败")])]:t._e()],2):a("div",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("span",[t._v(t._s(t.pluginData.attr.data.goods_name))]),t._v(" "),t.pluginData.data.status?1==t.pluginData.data.status?[a("span",[t._v("已支付")]),t._v(" "),2!=this.pluginData.attr.data.pay_type?a("span",[t._v(t._s(t._f("setMoney")(t.pluginData.data.pay_money))+"元")]):t._e()]:1!=t.pluginData.data.status?[a("span",[t._v("支付失败")]),t._v(" "),a("input",{attrs:{type:"button",value:"支付"},on:{click:t.getGoodDetail}})]:t._e():a("input",{attrs:{type:"button",value:"支付"},on:{click:t.getGoodDetail}})],2)]):a("div",{staticClass:"dplugin-mobile dplugin-modile-dpay"},[t.pluginData.status.readonly?a("div",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("span",[t._v(t._s(t.pluginData.attr.data.goods_name))]),t._v(" "),void 0==t.pluginData.data.status?a("span",[t._v("未支付")]):1==t.pluginData.data.status?[a("span",[t._v("已支付")]),t._v(" "),2!=this.pluginData.attr.data.pay_type?a("span",[t._v(t._s(t._f("setMoney")(t.pluginData.data.pay_money))+"元")]):t._e()]:1!=t.pluginData.data.status?[a("span",[t._v("支付失败")])]:t._e()],2):a("div",{style:t.appCommonH.getStyle(t.getTextStyle())},[a("span",[t._v(t._s(t.pluginData.attr.data.goods_name))]),t._v(" "),t.pluginData.data.status?1==t.pluginData.data.status?[a("span",[t._v("已支付")]),t._v(" "),2!=this.pluginData.attr.data.pay_type?a("span",[t._v(t._s(t._f("setMoney")(t.pluginData.data.pay_money))+"元")]):t._e()]:1!=t.pluginData.data.status?[a("span",[t._v("支付失败")]),t._v(" "),a("input",{attrs:{type:"button",value:"支付"},on:{click:t.getGoodDetail}})]:t._e():a("input",{attrs:{type:"button",value:"支付"},on:{click:t.getGoodDetail}})],2)])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n  \t\t\t\t \n  \t\t\t")])],t._v(" "),t.pluginData.status.ispc&&t.payment_layer?a("div",{staticClass:"pc_payment_layer",on:{click:function(e){return e.target!==e.currentTarget?null:t.clearPayment(e)}}},[a("div",{staticClass:"layer_container"},[a("img",{staticClass:"layer_close",attrs:{src:t.appConfig.staticUrl+"img/guanbi.png"},on:{click:t.clearPayment}}),t._v(" "),a("p",{staticClass:"layer_tit"},[t._v("选择支付金额")]),t._v(" "),a("ul",[t._l(t.paymentData.fees,(function(e,n){return a("li",{key:n,on:{click:function(e){return t.hFee(e)}}},[t._v(t._s(e)+"元")])})),t._v(" "),a("li",{on:{click:function(e){return t.hFee(e)}}},[t._v("自定义金额")])],2),t._v(" "),t.feeShow?a("input",{directives:[{name:"model",rawName:"v-model",value:t.textFee,expression:"textFee"}],attrs:{type:"text",placeholder:t.placeholder},domProps:{value:t.textFee},on:{input:function(e){e.target.composing||(t.textFee=e.target.value)}}}):a("input",{staticStyle:{"border-color":"transparent",background:"#fff"},attrs:{type:"text",disabled:""}}),t._v(" "),a("div",{staticClass:"btn"},[a("input",{staticClass:"payment_layer_pay",attrs:{type:"button",value:"生成二维码",disabled:""},on:{click:t.getQrcode}})])])]):t._e(),t._v(" "),t.pluginData.status.ispc&&t.payment_qrcode?a("div",{staticClass:"pc_payment_qrcode",on:{click:function(e){return e.target!==e.currentTarget?null:t.clearPayment(e)}}},[a("div",{staticClass:"qrcode_comtainer"},[a("img",{staticClass:"layer_close",attrs:{src:t.appConfig.staticUrl+"img/guanbi.png"},on:{click:t.clearPayment}}),t._v(" "),a("p",{staticClass:"layer_tit"},[t._v("请用手机扫码支付")]),t._v(" "),a("img",{staticClass:"qrcode",attrs:{src:t.qrcodeInfo.code_url,alt:""}}),t._v(" "),a("p",{staticClass:"layer_fee"},[t._v(t._s(t.fee)+"元")]),t._v(" "),1==t.paymentData.pay_type?a("input",{attrs:{type:"button",value:"更改金额"},on:{click:t.changeFee}}):t._e()])]):t._e(),t._v(" "),t.pluginData.status.ispc&&t.payment_success?a("div",{staticClass:"pc_payment_success",on:{click:function(e){return e.target!==e.currentTarget?null:t.clearPayment(e)}}},[a("div",{staticClass:"layer_container"},[a("img",{staticClass:"layer_close",attrs:{src:t.appConfig.staticUrl+"img/guanbi.png"},on:{click:function(e){return e.target!==e.currentTarget?null:t.clearPayment(e)}}}),t._v(" "),1==t.pluginData.data.status?a("p",{staticClass:"layer_status",staticStyle:{color:"#33A954"}},[a("img",{attrs:{src:t.appConfig.staticUrl+"img/success.png",alt:""}}),t._v("\n            支付成功\n          ")]):a("p",{staticClass:"layer_status",staticStyle:{color:"#E84335"}},[a("img",{attrs:{src:t.appConfig.staticUrl+"img/fail.png",alt:""}}),t._v("\n            支付失败\n          ")]),t._v(" "),a("p",{staticClass:"fee"},[t._v("订单金额："+t._s(t._f("setMoney")(t.pluginData.data.pay_money))+"元")]),t._v(" "),a("ul",[t._m(0),t._v(" "),a("li",[a("span",[t._v("外部订单号")]),t._v(" "),a("span",[t._v(t._s(t.pluginData.data.trade_no))])]),t._v(" "),a("li",[a("span",[t._v("交易时间")]),t._v(" "),a("span",[t._v(t._s(t.appCommonH.timestampToTime(t.pluginData.data.trade_time)))])]),t._v(" "),a("li",[a("span",[t._v("支付渠道")]),t._v(" "),a("span",[t._v(t._s(t.pluginData.data.platform))])])]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[1!=t.pluginData.data.status?a("input",{attrs:{type:"button",value:"重新支付"},on:{click:t.getQrcode}}):t._e()])])]):t._e(),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.pluginData.status.ispc&&t.payment_layer,expression:"!pluginData.status.ispc && payment_layer"}],staticClass:"m_payment_layer m_height",on:{click:function(e){return e.target!==e.currentTarget?null:t.clearPayment(e)}}},[a("div",{staticClass:"payment_container"},[a("p",{staticClass:"tit"},[t._v("\n            选择支付金额\n          ")]),t._v(" "),a("ul",[t._l(t.paymentData.fees,(function(e,n){return a("li",{key:n,on:{click:function(e){return t.hFee(e)}}},[t._v(t._s(e)+"元")])})),t._v(" "),a("li",{staticClass:"fee",on:{click:function(e){return t.hFee(e)}}},[t._v("自定义金额")])],2),t._v(" "),t.feeShow?a("input",{directives:[{name:"model",rawName:"v-model",value:t.textFee,expression:"textFee"}],attrs:{type:"text",placeholder:t.placeholder},domProps:{value:t.textFee},on:{input:function(e){e.target.composing||(t.textFee=e.target.value)}}}):t._e(),t._v(" "),a("div",{staticClass:"sub"},[a("input",{attrs:{type:"button",value:"关闭"},on:{click:t.clearPayment}}),t._v(" "),a("input",{staticClass:"payment_layer_pay",attrs:{type:"button",value:"去支付",disabled:""},on:{click:t.getQrcode}})])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.pluginData.status.ispc&&t.payment_success,expression:"!pluginData.status.ispc && payment_success"}],staticClass:"m_payment_success m_height"},[a("div",{staticClass:"payment_container"},[a("div",{staticClass:"status"},[1==t.pluginData.data.status?[a("img",{attrs:{src:t.appConfig.staticUrl+"img/success.png",alt:""}}),t._v(" "),a("span",{staticStyle:{color:"#33A954"}},[t._v("支付成功")])]:[a("img",{attrs:{src:t.appConfig.staticUrl+"img/fail.png",alt:""}}),t._v(" "),a("span",{staticStyle:{color:"#E84335"}},[t._v("支付失败")])]],2),t._v(" "),a("p",{staticClass:"fee"},[t._v("订单金额："+t._s(t._f("setMoney")(t.pluginData.data.pay_money))+"元")]),t._v(" "),a("ul",[a("li",[a("span",[t._v("订单id")]),t._v(" "),a("span",[t._v(t._s(t.pluginData.data.order_id))])]),t._v(" "),a("li",[a("span",[t._v("外部订单号")]),t._v(" "),a("span",[t._v(t._s(t.pluginData.data.trade_no))])]),t._v(" "),a("li",[a("span",[t._v("交易时间")]),t._v(" "),a("span",[t._v(t._s(t.pluginData.data.trade_time?t.appCommonH.timestampToTime(t.pluginData.data.trade_time):""))])]),t._v(" "),a("li",[a("span",[t._v("支付渠道")]),t._v(" "),a("span",[t._v(t._s(t.pluginData.data.platform))])])]),t._v(" "),a("div",{staticClass:"btn"},[a("input",{attrs:{type:"button",value:"关闭"},on:{click:t.clearPayment}}),t._v(" "),1!=t.pluginData.data.status?a("input",{attrs:{type:"button",value:"重新支付"},on:{click:function(e){return t.getGoodDetail(!0)}}}):t._e()])])])],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},fn=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",[a("span",[t._v("订单id")]),t._v(" "),a("span",[t._v("791018060680860")])])}],mn=(a("9cf3"),a("9ee2")),vn=Object(s["b"])(s["a"],{name:"dPayment",props:["forminfo","ptablesendmessage","plugin"],data:{paymentData:{},payment_layer:!1,payment_qrcode:!1,payment_success:!1,qrcodeInfo:{},feeShow:!1,fee:"",textFee:"",placeholder:"最多输入两位小数",source:null},watch:{pluginData:function(t){this.updateData(t)},textFee:function(t){var e=/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/;e.test(Number(t))?(console.log(100*Number(t)),0!=this.paymentData.min_pay_fee&&0!=this.paymentData.max_pay_fee?100*Number(t)>=this.paymentData.min_pay_fee&&100*Number(t)<=this.paymentData.max_pay_fee&&($(".payment_layer_pay").removeAttr("disabled"),this.fee=this.textFee):0!=this.paymentData.min_pay_fee&&0==this.paymentData.max_pay_fee?100*Number(t)>=this.paymentData.min_pay_fee&&($(".payment_layer_pay").removeAttr("disabled"),this.fee=this.textFee):0==this.paymentData.min_pay_fee&&0!=this.paymentData.max_pay_fee&&100*Number(t)<=this.paymentData.max_pay_fee&&($(".payment_layer_pay").removeAttr("disabled"),this.fee=this.textFee)):$(".payment_layer_pay").attr("disabled",!0)}},filters:{setMoney:function(t){return.01*Number(t)}},methods:{updateData:function(t){this.updateClassData(t)},updata:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},getGoodDetail:function(t){var e=this;if(!this.forminfo.formId||!this.forminfo.instId)return!1;t&&(this.payment_success=!1),this.appFetch({method:"get",url:"goodDetail",data:{id:this.pluginData.attr.data.goods_id}},(function(t){if(0==t.e)if(e.paymentData=t.d,1==t.d.pay_type)e.setPlaceholder(t.d.min_pay_fee,t.d.max_pay_fee),e.payment_layer=!0;else if(0==t.d.pay_type)e.fee=.01*t.d.pay_fee,e.getQrcode();else{if(!e.plugin.plugins[e.pluginData.attr.data.component_key])return void e.$message({showClose:!0,message:"暂无输入金额控件",type:"warning"});e.fee=e.plugin.plugins[e.pluginData.attr.data.component_key].data;var a=/^(([1-9][0-9]*)|(([0]\.\d{1,2}|[1-9][0-9]*\.\d{1,2})))$/;a.test(Number(e.fee))?e.getQrcode():e.$message({showClose:!0,message:"请输入金额",type:"warning"})}}))},hFee:function(t){$(t.target).addClass("active").siblings().removeClass("active"),"自定义金额"==$(t.target).text()?(this.fee="",this.feeShow=!0,$(".payment_layer_pay").attr("disabled",!0)):(this.feeShow=!1,this.fee=Number($(t.target).text().substr(0,$(t.target).text().length-1)),$(".payment_layer_pay").removeAttr("disabled"))},setPlaceholder:function(t,e){this.placeholder="最多输入两位小数",0!=t&&0!=e?this.placeholder=.01*t+"元以上，"+.01*e+"元以下，"+this.placeholder:0!=t&&0==e?this.placeholder=.01*t+"元以上，"+this.placeholder:0!=e&&0==t&&(this.placeholder=.01*e+"元以下，"+this.placeholder)},getQrcode:function(){var t=this;this.appFetch({url:"formFee",method:"post",data:{component_key:this.pluginData.key,form_id:this.forminfo.formId,pay_fee:this.fee,inst_id:this.forminfo.instId,path:this.pluginData.status.ispc?null:this.setUrl()}},(function(e){0==e.e?t.pluginData.status.ispc?(t.payment_layer=!1,t.payment_success=!1,t.payment_qrcode=!0,t.qrcodeInfo=e.d,t.eventSource(e.d.event_source_key)):(t.qrcodeInfo=e.d,t.saveAppInfo(e.d.order_id)):t.$message({message:e.m,type:"warning"})}))},eventSource:function(t){var e=this,a=mn["NativeEventSource"]||mn["EventSourcePolyfill"];"undefined"!==typeof a?(this.source=new a(this.appConfig.apiBaseUrl+"/api/event-source/index?key="+t,{withCredentials:!0}),this.source.addEventListener("message",(function(t){var a=JSON.parse(t.data);0==a.e?1==a.d.status&&(e.pluginData.data=a.d,e.payment_qrcode=!1,e.payment_success=!0,e.updata(),e.source.close()):(e.pluginData.data=a.d,e.payment_qrcode=!1,e.payment_success=!0,e.updata(),e.source.close())})),this.source.addEventListener("error",(function(t){t.readyState==a.CLOSED?console.log("Connection was closed."):console.log(t)}),!1)):alert("抱歉，您的浏览器不支持 server-sent 事件 ...")},changeFee:function(){this.textFee="",this.fee="",this.payment_qrcode=!1,this.feeShow=!1,this.payment_layer=!0,this.source.close()},clearPayment:function(){this.payment_layer=!1,this.payment_qrcode=!1,this.payment_success=!1,this.feeShow=!1,this.textFee="",this.fee="",this.source&&this.source.close()},getOrder:function(t){var e=this;this.appFetch({method:"get",url:"getOrder",data:{order_id:t}},(function(t){0==t.e&&(e.pluginData.data=t.d,e.payment_success=!0,e.updateData(e.pluginData))}))},getinstIdOrder:function(){var t=this;this.appFetch({url:"getinstIdOrder",method:"get",data:{inst_id:this.forminfo.instId,form_id:this.forminfo.formId,component_key:this.pluginData.key}},(function(e){0==e.e&&(t.pluginData.data=e.d)}))},setUrl:function(){var t="",e=window.location.search,a=[];if(-1!=e.indexOf("?")){var n=e.substr(1),i=n.split("&");i.forEach((function(t,e){t.includes("pluginOrderId")||a.push(t+"&")}))}return 0!=a.length?(a.forEach((function(e){t+=e})),window.location.origin+window.location.pathname+"?"+t.substr(0,t.length-1)):window.location.href},saveAppInfo:function(t){this.$emit("ptablesendmessage",{type:"doAppEvent",data:{method:"saveAppInfoToKey",formId:this.forminfo.formId,key:this.pluginData.key,id:this.forminfo.formId+"-"+this.pluginData.key+"-"+t}})},pluginOtherMessage:function(t){switch(t.type){case"saveInfo":"success"==t.status?window.location.href=this.qrcodeInfo.mobile_url:console.log("临时保存失败");break}}},mounted:function(){var t=this;if(this.updateData(this.pluginData),!this.pluginData.status.ispc&&this.$route.query.pluginOrderId){var e=this.$route.query.pluginOrderId.split("-");this.forminfo.formId==e[0]&&this.pluginData.key==e[1]&&window.setTimeout((function(){t.getOrder(e[2])}),200)}else this.pluginData.status.ispc&&this.forminfo.instId&&window.setTimeout((function(){void 0==t.pluginData.data.status&&t.getinstIdOrder()}),200)}}),bn=vn,yn=Object(d["a"])(bn,gn,fn,!1,null,null,null),_n=yn.exports,Dn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:Object.assign({},t.appCommonH.getStyle(t.getLayoutStyle()),{width:"100%",height:"100%",overflowX:"auto"}),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin",staticStyle:{display:"inline-block"}},[a("div",[t.pluginData.status.formmodeedit?a("div",{staticClass:"qrcode-text",style:t.nowStyle},[t._v("\n\t\t\t\t\t\t\t"+t._s("Qr"==t.pluginData.attr.data.code_type?"二维码":"条形码")+"\n\t\t\t\t\t\t")]):["Br"==t.pluginData.attr.data.code_type?[t.nowUrl?a("img",{attrs:{id:t.pluginData.key+"_brcode"}}):a("div",{staticClass:"qrcode-text",style:t.nowStyle})]:[t.nowUrl?a("canvas",{attrs:{id:this.pluginData.key+"_qrcodecanvas"}}):a("div",{staticClass:"qrcode-text",style:t.nowStyle})]]],2)]):a("div",{staticClass:"dplugin-mobile"},["Br"==t.pluginData.attr.data.code_type?[t.nowUrl?a("img",{attrs:{id:t.pluginData.key+"_brcode"}}):a("div",{staticClass:"qrcode-text",style:t.nowStyle})]:[t.nowUrl?a("canvas",{attrs:{id:this.pluginData.key+"_qrcodecanvas"}}):a("div",{staticClass:"qrcode-text",style:t.nowStyle})]],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Cn=[],wn=a("5618"),xn=a.n(wn),kn=a("8b08"),Sn=a.n(kn),An=Object(s["b"])(s["a"],{name:"dQrcode",data:{nowStyle:{},nowUrl:"",color:"",oldcontent:""},watch:{pluginData:function(t){this.updateData(t)}},methods:Object(r["a"])(Object(r["a"])({},Object(o["c"])("form",["ADD_STARTLOADING","REDUCE_STARTLOADING"])),{},{updateData:function(t){this.updateClassData(t),this.setStyle(),this.dataOrigintype()},init:function(){var t=this.pluginData.attr.data,e=t.url,a=t.appoint;"Br"==this.pluginData.attr.data.code_type?(this.nowUrl=a,this.oldcontent=this.nowUrl):"currForm"==this.pluginData.attr.data.type?this.nowUrl=this.pluginData.data.content?this.appConfig.baseUrl+this.pluginData.data.content+"&appid="+this.forminfo.appId+"&sess_id="+this.forminfo.sessId+"&matterType="+this.forminfo.matterType:"":"custom"==this.pluginData.attr.data.type&&(this.nowUrl=e),this.dataOrigintype()},dataOrigintype:function(){var t=this.pluginData.attr.data,e=t.size,a=t.Br_height,n=t.Br_data,i=t.Br_if;t.appoint;this.stylecolorFun(),this.nowUrl&&!this.pluginData.status.formmodeedit&&this.$nextTick((function(){"Br"==this.pluginData.attr.data.code_type?this.useBrcode(a,this.nowUrl,n,i):this.useQrcode(e,this.nowUrl)}))},stylecolorFun:function(){this.color=this.pluginData.attr.style.color,this.pluginData.data.color&&!this.pluginData.status.formmodeedit&&(this.nowUrl=this.pluginData.data.content,this.color=this.pluginData.data.color)},useQrcode:function(t,e){var a=document.querySelector("#"+this.pluginData.key+"_qrcodecanvas");this.pluginData.status.ispc&&$(a).parent().css({width:t,height:t}),xn.a.toCanvas(a,e,{width:t,height:t,margin:1,color:{dark:this.color}},(function(t){t&&console.error(t)}))},useBrcode:function(t,e,a,n){Sn()("#".concat(this.pluginData.key,"_brcode"),e,{width:1,format:a,height:t,displayValue:n,lineColor:"".concat(this.color)}),this.pluginData.data.content!=this.oldcontent&&this.typebrUplogin()},setStyle:function(t){this.$set(this.pluginData.attr.style,"width",this.pluginData.attr.data.size),this.nowStyle={textAlign:"center",width:this.pluginData.attr.data.size+"px",height:this.pluginData.attr.data.size+"px",lineHeight:this.pluginData.attr.data.size+"px"}},typebrUplogin:function(){var t=this;this.ADD_STARTLOADING();var e=document.querySelector("#".concat(this.pluginData.key,"_brcode")).src;this.appFetch({url:"baseupload",method:"post",data:{base_code:e}},(function(e){t.REDUCE_STARTLOADING(),0==e.e?t.pluginData.data.content=e.d:t.$message.error(e.m)}),(function(e){t.$message.error({message:"系统异常"})}))}}),mounted:function(){this.updateData(this.pluginData),this.setStyle();var t=this;t.init()}}),En=An,Tn=Object(d["a"])(En,Dn,Cn,!1,null,null,null),In=Tn.exports,Pn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[0===t.pluginData.attr.data.type?a("el-button",{attrs:{disabled:t.pluginData.status.readonly,type:"primary",size:"mini",plain:""},on:{click:t.syncData}},[t._v("\n\t\t\t\t\t\t"+t._s(t.pluginData.attr.data.buttonName)+"\n\t\t\t\t\t")]):a("span",[t._v("\n\t\t\t\t\t\t"+t._s(t.getDataName())+"\n\t\t\t\t\t")])],1):a("div",{staticClass:"dplugin-mobile dplugin-doneplugin dplugin-mobile-dinput"},[0===t.pluginData.attr.data.type?a("el-button",{attrs:{disabled:t.pluginData.status.readonly,type:"primary",size:"mini",plain:""},on:{click:t.syncData}},[t._v("\n\t\t\t\t\t\t"+t._s(t.pluginData.attr.data.buttonName)+"\n\t\t\t\t\t")]):a("span",[t._v("\n\t\t\t\t\t\t"+t._s(t.getDataName())+"\n\t\t\t\t\t")])],1)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Nn=[],Rn=Object(s["b"])(s["a"],{name:"dSync",data:{},props:["plugin"],watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},dataChange:function(t){this.postMessage(t||this.pluginData)},getDataName:function(){return 1===this.pluginData.attr.data.type&&this.pluginData.data&&this.pluginData.data[this.pluginData.attr.data.nameColumn]?this.pluginData.data[this.pluginData.attr.data.nameColumn]:"暂无"},syncData:function(){var t=this.pluginData.attr.data.targetPlugin;t&&this.plugin.plugins[t]&&(this.plugin.plugins[t].data=this.pluginData.data,this.dataChange(this.plugin.plugins[t]))}},mounted:function(){this.updateData(this.pluginData)}}),Bn=Rn,On=Object(d["a"])(Bn,Pn,Nn,!1,null,null,null),Mn=On.exports,Ln=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox  dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dplugin-show"},[a("span",{staticClass:"doneplugin-value doneplugin-value-userview",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t\t"+t._s(t.pluginData.data[t.pluginData.attr.data.showColumn])+"\n\t\t\t\t\t")]),t._v(" "),t.pluginData.data.id?a("i",{staticClass:"el-icon-close del",attrs:{title:"删除"},on:{click:t.removeData}}):t._e()]):a("div",{staticClass:"dplugin-mobile dplugin-doneplugin dplugin-mobile-dinput dplugin-show"},[a("span",{staticClass:"doneplugin-value doneplugin-value-userview",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t\t"+t._s(t.pluginData.data[t.pluginData.attr.data.showColumn]?t.pluginData.data[t.pluginData.attr.data.showColumn]:" ")+"\n\t\t\t\t\t")]),t._v(" "),t.pluginData.data.id?a("i",{staticClass:"el-icon-close del",attrs:{title:"删除"},on:{click:t.removeData}}):t._e()])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Un=[],Fn=Object(s["b"])(s["a"],{name:"dShow",data:{},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},dataChange:function(t){this.postMessage(this.pluginData)},removeData:function(){this.pluginData.data={id:0,name:""},this.dataChange()}},mounted:function(){this.updateData(this.pluginData)}}),$n=Fn,Hn=Object(d["a"])($n,Ln,Un,!1,null,null,null),jn=Hn.exports,Wn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox  dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.data))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],attrs:{type:"text"},domProps:{value:t.pluginData.data},on:{focus:function(e){return t.handleFocus(e)},input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.upData]}})]):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dinput dinput-vie",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.status.readonly?a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.data))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginData.data,expression:"pluginData.data"}],attrs:{type:"text"},domProps:{value:t.pluginData.data},on:{focus:function(e){return t.handleFocus(e)},input:[function(e){e.target.composing||t.$set(t.pluginData,"data",e.target.value)},t.upData]}})])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},zn=[],Vn=Object(s["b"])(s["a"],{name:"dSerial",watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},handleFocus:function(t){(this.pluginData.status.readonly||this.pluginData.status.formmodeedit)&&$(t.target).blur()},upData:function(){this.pluginData.status.modeedit||this.$emit("sendmessage",this.pluginData)}},mounted:function(){this.updateData(this.pluginData)}}),qn=Vn,Gn=Object(d["a"])(qn,Wn,zn,!1,null,null,null),Kn=Gn.exports,Xn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[a("el-button",{attrs:{disabled:!t.pluginData.data.form_id,type:"primary",size:"mini",plain:""},on:{click:t.openTable}},[t._v("\n\t\t\t\t\t\t"+t._s(t.pluginData.status.readonly?t.pluginData.attr.data.readButtonName:t.pluginData.attr.data.writeButtonName)+"\n\t\t\t\t\t")])],1):a("div",{staticClass:"dplugin-mobile dplugin-doneplugin dplugin-mobile-dinput"},[a("el-button",{attrs:{disabled:!t.pluginData.data.form_id,type:"primary",size:"mini",plain:""},on:{click:t.openTable}},[t._v("\n\t\t\t\t\t\t"+t._s(t.pluginData.status.readonly?t.pluginData.attr.data.readButtonName:t.pluginData.attr.data.writeButtonName)+"\n\t\t\t\t\t")])],1)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t\t \n\t\t\t\t")])]],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},Yn=[],Jn=Object(s["b"])(s["a"],{name:"dChildTable",data:{isOk:!1},props:["plugin"],computed:Object(r["a"])({},Object(o["d"])("form",["childTable"])),watch:{pluginData:function(t){this.updateData(t),this.updataStatus()},allplugin:function(){this.updateData(this.pluginData),this.updataStatus()},childTable:function(t){if(this.forminfo.formId!=t.formInfo.formId||this.pluginData.key!=t.plugin.key)return!1;"save"==t.type&&t.data&&(this.pluginData.data.data=t.data,this.dataChange())}},methods:Object(r["a"])(Object(r["a"])({},Object(o["c"])("form",["SET_CHILDTABLE","CHILDDATASOURCE","CHILDNOCANSOURCE","CHILDNOCANSOURCEKEYS"])),{},{updateData:function(t){this.updateClassData(t)},dataChange:function(t){this.postMessage(t||this.pluginData)},getFormId:function(){var t=0;if(0===this.pluginData.attr.data.idFormType){var e=this.allplugin.plugins[this.pluginData.attr.data.pluginKey],a={};if(-1===this.pluginData.attr.data.pluginKey.indexOf("RepeatTable"))a=e?e.data:{};else{if(this.pluginData.status.ispc)var n=$('[data-key="'+this.pluginData.key+'"]').parents("tr").index()-2;else n=$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow").index();var i=e&&e.data?e.data:[];a=i[n]?i[n]:{},a=a[this.pluginData.attr.data.childKey],a=a||{}}t=a.value||a.id||"string"===typeof a&&a||0}else t=this.pluginData.attr.data.formId;return this.pluginData.status.readonly?this.pluginData.data.form_id:t},updataStatus:function(){var t=this.getFormId();this.pluginData.data.form_id!=t&&(this.pluginData.data.form_id=t,this.pluginData.data.data={},this.dataChange())},getParamByKey:function(t){var e=this.allplugin.plugins[this.pluginData.pkey];if(this.pluginData.status.ispc)var a=$('[data-key="'+this.pluginData.key+'"]').parents("tr").index()-2;else a=$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow").index();var n=e&&e.data?e.data:[],i=n[a]?n[a]:{};return void 0!==i[t]?i[t]:""},getRowData:function(t){var e=this.allplugin.plugins[this.pluginData.pkey];if(this.pluginData.status.ispc)var a=$('[data-key="'+this.pluginData.key+'"]').parents("tr").index()-2;else a=$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow").index();var n=e&&e.data?e.data:[],i=n[a]?n[a]:{};return i[t]&&delete i[t],i},openTable:function(){if(this.pluginData.status.formmodeedit)return!1;var t=[];if(372==this.forminfo.appId&&-1!==this.pluginData.pkey.indexOf("RepeatTable")&&(this.CHILDDATASOURCE({fid:this.pluginData.data.form_id,params:{projectName:this.getParamByKey("Select_48"),isOldProject:this.getParamByKey("Select_24")}}),t=[14]),-1!==this.pluginData.pkey.indexOf("RepeatTable")){var e=this.getRowData(this.pluginData.model);this.appCommonH.isEmptyObj(e)||this.evnHelper.add(e,"childrow")}this.appCommonH.isEmptyObj(this.pluginData.data.data)?(this.CHILDNOCANSOURCE({fid:this.pluginData.data.form_id,ids:[]}),this.CHILDNOCANSOURCEKEYS({fid:this.pluginData.data.form_id,keys:""})):(this.CHILDNOCANSOURCE({fid:this.pluginData.data.form_id,ids:t}),this.pluginData.attr.data.disableDSourceKeys&&this.CHILDNOCANSOURCEKEYS({fid:this.pluginData.data.form_id,keys:this.pluginData.attr.data.disableDSourceKeys})),this.SET_CHILDTABLE({type:"open",plugin:this.appCommonH.copyObj(this.pluginData),formInfo:this.forminfo})}}),mounted:function(){this.updateData(this.pluginData),this.updataStatus(),window.childTableForm={attr:this.pluginData.attr}}}),Zn=Jn,Qn=Object(d["a"])(Zn,Xn,Yn,!1,null,null,null),ti=Qn.exports,ei=function(){var t,e,a=this,n=a.$createElement,i=a._self._c||n;return i("div",{class:a.boxClass,style:a.appCommonH.getStyle(a.getLayoutStyle()),attrs:{"data-key":a.pluginData.key}},[a.pluginData.status.isshow?[a.pluginData.status.ispc?i("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[a.pluginData.status.readonly?i("div",{style:Object.assign({},a.appCommonH.getStyle(a.getTextStyle()),{overflow:"hidden"})},[i("table",{staticClass:"formtable clearfloat",style:{margin:"-20px auto 0px",width:a.tableWidth+"px"}},[i("thead",[i("tr",[i("th",{style:a.appCommonH.getStyle({height:"20px",lineHeight:"20px",boxSizing:"border-box"})})])]),a._v(" "),i("tbody",a._l(a.trData,(function(t){return i("tr",[t?i("td",{style:a.tdStyle,domProps:{innerHTML:a._s(a.replacedata(t))}}):a._e()])})),0)])]):[i("textarea",{directives:[{name:"model",rawName:"v-model",value:a.pluginData.data,expression:"pluginData.data"}],class:(t={"dplugin-boxBorder":!0,dplugin_multiInput:!0},t[a.selfClass]=!0,t),style:Object.assign({},a.appCommonH.getStyle(a.getTextStyle()),{padding:"5px"}),attrs:{placeholder:a.pluginData.attr.data.placeholder?a.pluginData.attr.data.placeholder:" "},domProps:{value:a.pluginData.data},on:{input:[function(t){t.target.composing||a.$set(a.pluginData,"data",t.target.value)},a.change]}})]],2):i("div",{staticClass:"dplugin-mobile dplugin-mobile-dmultiInputs"},[a.pluginData.status.readonly?i("div",{staticClass:"dplugin-content-wrap",style:a.appCommonH.getStyle(a.getTextStyle()),domProps:{innerHTML:a._s(a.replacedata(a.pluginData.data))}}):[i("textarea",{directives:[{name:"model",rawName:"v-model",value:a.pluginData.data,expression:"pluginData.data"}],class:(e={"dplugin-boxBorder":!0,dplugin_multiInput:!0},e[a.selfClass]=!0,e),style:a.appCommonH.getStyle(a.getTextStyle()),attrs:{placeholder:a.pluginData.attr.data.placeholder?a.pluginData.attr.data.placeholder:" "},domProps:{value:a.pluginData.data},on:{input:[function(t){t.target.composing||a.$set(a.pluginData,"data",t.target.value)},a.change]}})]],2)]:[i("div",{class:a.hiddenClass,style:a.appCommonH.getStyle(a.getTextStyle())},[a._v("\n\t\t\t\t \n\t\t\t")])]],2)},ai=[],ni=Object(s["b"])(s["a"],{name:"dArticle",data:{tableWidth:"100%"},watch:{pluginData:function(t){this.updateData(t)},"pluginData.data":function(){this.change()}},computed:{selfClass:function(){return ot()(this.forminfo.formId+"_"+this.pluginData.key+"_darticle")},trData:function(){var t=[];if(this.pluginData.data){var e=this.pluginData.data;t=e.split(/\n/)}return t},tdStyle:function(){return{borderWidth:this.pluginData.attr.data.borderType?"1px":"0px",borderColor:this.pluginData.attr.borderColor,borderStyle:"solid"}}},methods:{replacedata:function(t){return t=t.toString(),t=t.replace(/\n/gm,"<br/>"),t=t.replace(/\s/gm,"&nbsp;"),t},update:function(){this.pluginData.status.modeedit||this.$emit("sendmessage",this.pluginData)},updateData:function(t){this.updateClassData(t)},change:function(){this.update(),this.refreshHeight()},setTableWidth:function(){var t=$('[data-key="'+this.pluginData.key+'"]').parents(".dplugin-layout").attr("data-key");"dOneColumn"==this.allplugin.plugins[t].type&&(this.tableWidth=this.allplugin.plugins[t].attr.data.width-1)},refreshHeight:function(){$("."+this.selfClass).css({minHeight:0});var t=5;this.pluginData.status.ispc&&(t=0);var e=$("."+this.selfClass).prop("scrollHeight")>this.pluginData.attr.style.minHeight?$("."+this.selfClass).prop("scrollHeight")-t:this.pluginData.attr.style.minHeight;$("."+this.selfClass).css({minHeight:e+2})}},mounted:function(){this.updateData(this.pluginData),this.refreshHeight(),this.pluginData.status.readonly&&this.setTableWidth()},created:function(){this.pluginData.status.ispc&&void 0===this.pluginData.attr.style.minHeight&&(this.pluginData.attr.style.minHeight=46),this.pluginData.attr.style.minHeight=+this.pluginData.attr.style.minHeight}}),ii=ni,ri=Object(d["a"])(ii,ei,ai,!1,null,null,null),si=ri.exports,oi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dplugin-pc-dAvatar"},[a("input",{ref:"uploadClassify",staticClass:"doneplugin-opacityInput",attrs:{type:"file",id:"upImg",disabled:t.pluginData.status.readonly,multiple:"multiple",value:"编辑"},on:{change:t.fileImg}}),t._v(" "),t.pluginData.status.readonly?t._e():a("input",{staticClass:"dAvatar_btn",attrs:{type:"button",value:t.pluginData.attr.data.buttest},on:{click:t.findPeople}}),t._v(" "),void 0!=t.pluginData.attr.data.Haslimit&&t.pluginData.attr.data.showexpress?a("span",{attrs:{width:t.pluginData.attr.data.width?t.pluginData.attr.data.width+"px":"100%"},on:{click:t.findPeople}},[t._v("\n          上传文件的大小请在"+t._s(t.pluginData.attr.data.smallsize)+"MB-"+t._s(t.pluginData.attr.data.size)+"MB之间\n          "),t.pluginData.attr.data.islimit?[t._v("\n            ,格式为\n            "),t._l(t.pluginData.attr.data.Haslimit,(function(e,n){return a("span",[t._v("\n              "+t._s(e)+"\n              "),n<t.pluginData.attr.data.Haslimit.length-1?a("span",[t._v(",")]):t._e()])}))]:t._e()],2):t._e(),t._v(" "),t.pluginData.status.readonly&&1==t.pluginData.attr.data.readonlyStyle?a("el-carousel",{attrs:{height:"150px"}},t._l(t.pluginData.data,(function(e,n){return a("el-carousel-item",{key:n},[a("img",{staticClass:"img",staticStyle:{height:"100%",margin:"0 auto",display:"block"},attrs:{src:t.pluginData.data.length>0?e:""}})])})),1):a("ul",{staticClass:"pc_img"},t._l(t.pluginData.data,(function(e,n){return a("li",{key:n},[a("img",{staticClass:"img",attrs:{src:t.pluginData.data.length>0?e:""},on:{click:function(e){return e.target!==e.currentTarget?null:t.showImglayer(n)}}}),t._v(" "),t.pluginData.status.readonly?t._e():a("img",{staticClass:"img_top",attrs:{src:t.appConfig.staticUrl+"img/wxdels.png",alt:""},on:{click:function(e){return t.delImglayer(n)}}})])})),0)],1):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dAvatar dplugin-mobile-dXimage"},[t.pluginData.data.length?[t.pluginData.status.readonly&&1==t.pluginData.attr.data.readonlyStyle?a("el-carousel",{attrs:{height:"150px"}},t._l(t.pluginData.data,(function(e,n){return a("el-carousel-item",{key:n},[a("img",{staticClass:"img",staticStyle:{height:"100%",margin:"0 auto",display:"block"},attrs:{src:t.pluginData.data.length>0?e:""}})])})),1):t._l(t.pluginData.data,(function(e,n){return a("div",{key:n,staticClass:"dplugin-mobile-addfileed-box"},[t.pluginData.status.readonly?t._e():a("i",{staticClass:"icon iconfont iconshanchu1",on:{click:function(e){return e.target!==e.currentTarget?null:t.delImglayer(n)}}}),t._v(" "),a("div",{staticClass:"dplugin-mobile-addfileed"},[a("img",{attrs:{src:e},on:{click:function(e){return e.target!==e.currentTarget?null:t.showImglayer(n)}}})])])}))]:t._e(),t._v(" "),t.pluginData.status.readonly?t._e():a("div",{staticClass:"dplugin-mobile-addfileed-box dplugin-mobile-addfile"},[a("i",{staticClass:"icon iconfont iconaddTodo-nav"}),t._v(" "),a("input",{ref:"uploadClassify",staticClass:"doneplugin-opacityInput",attrs:{type:"file",multiple:"multiple",id:"upImg",disabled:t.pluginData.status.readonly},on:{change:t.fileImg}})]),t._v(" "),a("div",{staticClass:"clear"})],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(" ")])],t._v(" "),t.showImg&&t.pluginData.status.ispc?a("div",{staticClass:"dAvatar_showImg",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}},[a("i",{staticClass:"el-icon-close close",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}}),t._v(" "),a("img",{staticClass:"img",attrs:{src:t.artworkimg,alt:""}})]):t._e(),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.pluginData.status.ispc&&t.showImg,expression:"!pluginData.status.ispc && showImg"}],ref:"dAvatar_moveImg",staticClass:"dAvatar_moveImg"},[a("i",{staticClass:"el-icon-close close",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showImg=!1}}}),t._v(" "),a("ul",{ref:"wbox",staticClass:"box"},t._l(t.pluginData.data,(function(t,e){return a("li",{key:e},[a("div",{staticClass:"box1 box2"},[a("img",{attrs:{src:t,alt:"",srcset:""}})])])})),0),t._v(" "),a("div",{staticClass:"moveimg_bot"},[a("div",{staticClass:"moveimg_num"},[t._v(t._s(t.imgd)+"/"+t._s(t.imgz))]),t._v(" "),a("div",{staticClass:"moveimg_xz"},[t._v("长按保存")])])])],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},li=[],ui=Object(s["b"])(s["a"],{name:"dAvatar",data:{showImg:!1,uploadLength:"",artworkimg:"",imgd:"",imgz:"1",indexs:"",downloadimg:"",num:0},watch:{pluginData:function(t){this.updateData(t)},getAllFocusContent:function(){this.initAlertInfo()}},methods:{delImglayer:function(t){this.pluginData.data.splice(t,1),this.postMessage(this.pluginData)},updateData:function(t){this.updateClassData(t)},updata:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},findPeople:function(t){if(!this.pluginData.status.formmodeedit&&!this.pluginData.status.readonly)t.target.parentNode.firstChild.click()},fileImg:function(t){var e=this;if(this.uploadLength=this.$refs.uploadClassify.files.length,void 0!=e.pluginData.attr.data.islimit&&e.pluginData.attr.data.islimit)for(var a=0;a<this.uploadLength;a++){var n=this.$refs.uploadClassify.files[a].name.lastIndexOf("."),i=this.$refs.uploadClassify.files[a].name.substring(n).toLowerCase();if(!e.pluginData.attr.data.Haslimit.includes(i.replace(".","")))return void e.$message.error({message:"暂不支持"+i+"格式的文件"})}if(void 0!=e.pluginData.attr.data.smallsize){for(var r=0;r<this.uploadLength;r++)if(this.$refs.uploadClassify.files[r].size>1024*e.pluginData.attr.data.size*1024||this.$refs.uploadClassify.files[r].size<1024*e.pluginData.attr.data.smallsize*1024)return e.$message.error({message:"您上传的文件不在"+e.pluginData.attr.data.smallsize+"MB-"+e.pluginData.attr.data.size+"MB之间！"}),void $(t.currentTarget).val("")}else for(var s=0;s<this.uploadLength;s++)if(this.$refs.uploadClassify.files[s].size>1024*e.pluginData.attr.data.size*1024)return e.$message.error({message:"您上传的文件超过了"+e.pluginData.attr.data.size+"MB！"}),void $(t.currentTarget).val("");function o(){return l.apply(this,arguments)}function l(){return l=Ce(regeneratorRuntime.mark((function t(){var a,n,i,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0==e.uploadLength){t.next=19;break}if(a=new FormData,n=e.$refs.uploadClassify.files[e.uploadLength-1],!n.type.includes("image")){t.next=11;break}return t.next=6,Se.getImageTag(n,"Orientation");case 6:if(i=t.sent,!(i>1)){t.next=11;break}return t.next=10,Se.handleImg(n,i);case 10:n=t.sent;case 11:a.append("upfile",n),r=we["a"].getApi("uploadindex")+"?category=image",s=new XMLHttpRequest,s.open("post",r),s.onload=function(t){var a,n=JSON.parse(t.currentTarget.response),i=self.appConfig.apiBaseUrl;("https://dev-workflow.campusapp.com.cn"==self.appConfig.apiBaseUrl&&(i="dev-workflowimg.campusapp.com.cn"),"test.office.rlstech.cn"!=window.location.hostname&&(i=JSON.parse(window.sessionStorage.officeDb_getSiteConfig).imghost),"SUCCESS"==n.state)&&(a=i+"/"+n.url,-1==a.indexOf("http")&&(a="http://"+a),e.pluginData.data.push(a),e.postMessage(e.pluginData),e.uploadLength--,o())},s.send(a),t.next=20;break;case 19:$(".doneplugin-opacityInput").val("");case 20:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}o()},getCountry:function(t){var e=window.location.origin;"test.office.rlstech.cn"==window.location.hostname&&(e="dev-officeflow.rlstech.cn"),this.appFetch({url:e+"/api/upload/index?category=image",method:"post",data:t},this.success,this.error)},success:function(t){console.log("findCountry_success",t)},error:function(t){console.log("findCountry_error",t)},liClick:function(t,e){this.updata()},showImglayer:function(t){if(this.indexs=t,0==this.pluginData.data.length)return!1;var e=this.pluginData.data;this.artworkimg=e[t],this.imgz=this.pluginData.data.length,this.showImg=!0,this.index=t,this.slideimgfun()},slideimgfun:function(){var t=this,e=document.querySelectorAll(".box li"),a=this.$refs.wbox,n=this.$refs.dAvatar_moveImg,i=document.body.clientWidth;this.imgd=this.index+1,a.style.left=-this.index*document.body.clientWidth+"px",a.style.width=100*e.length+"%";for(var r=0;r<e.length;r++)e[r].style.width=1/e.length*100+"%";var s=0,o=0;n.addEventListener("touchstart",(function(e){s=e.changedTouches[0].pageX,o=a.offsetLeft,n.addEventListener("touchmove",(function(e){e.preventDefault();var n=e.changedTouches[0].pageX,i=n-s,r=o+i;a.style.left=r+"px",t.num=i>0?-.3:.3}))})),n.addEventListener("touchend",(function(e){var r=a.offsetLeft,s=Math.round(-r/i+t.num);s=s>=t.pluginData.data.length-1?t.pluginData.data.length-1:s,s=s<=0?0:s;var o=s+1;t.imgd=o,a.style.left=-s*n.offsetWidth+"px"}))},initAlertInfo:function(){if(this.pluginData.status.ispc)return!1;var t="";if(this.pluginData.attr.data.showexpress){t="上传文件的大小请在"+this.pluginData.attr.data.smallsize+"MB-"+this.pluginData.attr.data.size+"MB之间";this.pluginData.attr.data.Haslimit.length&&(t+="格式为："+this.pluginData.attr.data.Haslimit.join("，"))}this.pluginData.alertFoucsMsg=this.getAllFocusContent?this.getAllFocusContent:t,this.updata()}},mounted:function(){this.updateData(this.pluginData),this.initAlertInfo()},created:function(){""==this.pluginData.data&&(this.pluginData.data=[])}}),di=ui,ci=(a("a3ef"),Object(d["a"])(di,oi,li,!1,null,null,null)),pi=ci.exports,hi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[t.pluginData.status.readonly?a("div",{staticClass:"read_rich",domProps:{innerHTML:t._s(t.pluginData.data)}}):[a("script",{style:t.boxstyle,attrs:{id:t.pluginData.key,type:"text/plain"}})]],2):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dmultiInputs"},[t.pluginData.status.readonly?[a("div",{staticClass:"read_rich",domProps:{innerHTML:t._s(t.pluginData.data)}})]:t._e()],2)]:void 0],2),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],1)},gi=[];a("9112");a("20c5"),a("9be0"),a("4275");var fi,mi=Object(s["b"])(s["a"],{name:"dmultiInputs",data:Object(r["a"])(Object(r["a"])({},m["a"].data),{},{ue:{},boxstyle:{width:"99%",minHeight:"500px"}}),watch:{pluginData:function(t){t.attr.style.minHeight&&(this.ue.setHeight(t.attr.style.minHeight),this.ue.autoHeightEnabled=!0),t.data?this.ue.setContent(t.data):this.ue.setContent(t.attr.data.placeholder),this.updateData(t)}},computed:{selfClass:function(){return ot()(this.forminfo.formId+"_"+this.pluginData.key+"_multiInput")},disabledNewRequired:function(){return!!this.pluginData.attr.data.limitHeightType}},methods:Object(r["a"])(Object(r["a"])({},m["a"].methods),{},{update:function(){this.pluginData.status.modeedit||this.$emit("sendmessage",this.pluginData)},updateData:function(t){this.updateClassData(t)},change:function(t){this.update()},initUe:function(){var t=this;UE.delEditor(this.pluginData.key),this.ue=UE.getEditor(this.pluginData.key,{toolbars:[["fontfamily","fontsize","forecolor","underline","bold","italic","justifyleft","justifyright","justifycenter","justifyjustify","simpleupload","attachment","link","source"]]}),this.ue.ready((function(){""==t.pluginData.data?t.ue.setContent(t.pluginData.attr.data.placeholder):t.ue.setContent(t.pluginData.data)})),$(".edui-editor-toolbarbox").show(),$(".edui-editor-bottomContainer").hide(),this.pluginData.status.formmodeedit?this.ue.ready((function(){t.ue.setDisabled()})):this.ue.ready((function(){t.ue.setHeight(t.pluginData.attr.style.minHeight),t.ue.addListener("blur",(function(e){t.pluginData.data=t.ue.getContent()})),t.pluginData.attr.data.limitHeightType?t.ue.autoHeightEnabled=!1:t.ue.autoHeightEnabled=!0}))}}),mounted:function(){this.pluginData.status.readonly||this.initUe(),this.updateData(this.pluginData)},created:function(){this.pluginData.status.ispc&&void 0===this.pluginData.attr.style.minHeight&&(this.pluginData.attr.style.minHeight=46),this.pluginData.attr.style.minHeight=+this.pluginData.attr.style.minHeight,this.boxstyle.minHeight=this.pluginData.attr.style.minHeight+"px"}}),vi=mi,bi=(a("cecc"),Object(d["a"])(vi,hi,gi,!1,null,null,null)),yi=bi.exports,_i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin"},[a("el-button",{attrs:{size:"mini",disabled:t.pluginData.status.formmodeedit||t.pluginData.status.readonly||!!t.pluginData.data.disabled},on:{click:t.submit}},[a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.attr.data.btnName))])])],1):a("div",{staticClass:"dplugin-mobile dplugin-doneplugin submit-mbox"},[a("button",{class:t.mixSubmitGroup,attrs:{disabled:t.pluginData.status.formmodeedit||t.pluginData.status.readonly||!!t.pluginData.data.disabled},on:{click:t.submit}},[a("span",{style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(t._s(t.pluginData.attr.data.btnName))])])])]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t \n\t\t")])]],2)},Di=[],Ci=(a("f3dd"),a("0a51"),Object(s["b"])(s["a"],{name:"doneinput",data:{formMessage:{},selectKeys:{},inRepeatKey:""},props:["plugin","forminfo"],watch:{pluginData:function(t){this.updateData(t)}},methods:Object(r["a"])(Object(r["a"])({},Object(o["c"])("form",["REFRESH_DATASOURCE"])),{},{postMessage:function(t,e){this.$set(this.formMessage,t,e)},updateData:function(t){this.updateClassData(t)},submitinRepeat:function(){var t=this,e=this.plugin.plugins,a=function(a){e.hasOwnProperty(a)&&a.includes("RepeatTable")&&(i=!1,r={},e[a].attr.data.tableData.trs[1].tds.forEach((function(e){if(!e.dataid)return!1;r[e.dataid]=window.retable.plugins[e.dataid].description,window.retable.plugins[e.dataid].key==t.pluginData.model&&(t.inRepeatKey=a,i=!0)})),i&&(t.selectKeys=r))};for(var n in e){var i,r;a(n)}},customData:function(t){var e=this;if(void 0==this.pluginData.attr.data.custom)return!1;var a={};return this.pluginData.attr.data.custom.filter((function(e){return e.type==t||!e.type&&1==t})).forEach((function(t){t.param_name&&t.value&&(a[t.param_name]=e.evnHelper.get(t.value))})),a},childFormParam:function(){var t=this;if(void 0==this.pluginData.attr.data.childParam)return!1;var e={};return this.pluginData.attr.data.childParam.forEach((function(a){var n=t.evnHelper.get(a.component);a.param_name&&a.component&&(e[a.param_name]=n)})),e},dataLayoutSet:function(t){var e=this,a={},n=[],i=[],r=this.plugin.plugins;if(this.pluginData.attr.data.params.filter((function(e){return e.type==t||!e.type&&1==t})).forEach((function(t){n.push(t.component),i.push(t.param_name)})),e.inRepeatKey){var s=[],o={};if(this.pluginData.status.ispc)var l=r[e.inRepeatKey].data[$('[data-key="'+this.pluginData.key+'"]').parents("tr").index()-2];else l=r[e.inRepeatKey].data[$('[data-key="'+this.pluginData.key+'"]').parents(".tablerow").index()];for(var u in l)l.hasOwnProperty(u)&&n.includes(u)&&(o[i[n.indexOf(u)]]=l[u]);return 2==t?o:(s.push(o),n.includes(e.inRepeatKey)?a[i[n.indexOf(e.inRepeatKey)]]=s:a[e.inRepeatKey]=s,a)}return this.pluginData.attr.data.params.filter((function(e){return e.type==t||!e.type&&1==t})).forEach((function(t){var e=r[t.component];if(e)if(["RepeatTable"].includes(e.columnType)){var s=[];e.data.forEach((function(t){var e={};for(var a in t)n.includes(a)&&(e[i[n.indexOf(a)]]=t[a]);s.push(e)})),e.data.length&&(a[t.param_name]=s)}else e.data&&(a[t.param_name]=e.data)})),a},submit:function(){var t=this;t.pluginData.attr.data.is_hintMessage&&t.pluginData.attr.data.hintMessage?t.$MessageBox.confirm(t.pluginData.attr.data.hintMessage,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",showClose:!1,type:"warning"}).then((function(){t.submitFn()})).catch((function(){})):t.submitFn()},submitFn:function(){var t=this,e=this;if(!+e.pluginData.attr.data.is_validate||window.tablevm.checkPluginValidate())if(this.pluginData.attr.data.request_url.length){var a=Object(r["a"])(Object(r["a"])({},e.customData(1)),e.dataLayoutSet(1));this.appFetch({method:"post",url:"processSubmit",data:{form_id:window.childTableForm?window.childTableForm.id:this.forminfo.formId,bpmn_id:this.forminfo.bpmnId,component_key:"number"==typeof this.pluginData.key?this.pluginData.model:this.pluginData.key,params:JSON.stringify(a)}},(function(t){if(0==t.e)e.$message.success({message:t.m}),setTimeout((function(){e.responseFn()}),500);else if(10049==t.e){var a=!1;for(var n in t.d)e.postMessage(n,{method:"apiValidate",errordata:t.d[n],isAlert:!a}),a||(a=!0,window.tablevm.apiValidate(e.formMessage[n]))}else t.m?e.$message.error({message:t.m}):e.$message.error({message:"系统错误"})}),(function(e){t.$message.error("系统错误")}))}else this.responseFn()},responseFn:function(){switch("jump"!=this.pluginData.attr.data.response_action||this.pluginData.attr.data.jump_url.length||window.location.reload(),this.pluginData.attr.data.response_action){case"jump":var t=Object(r["a"])(Object(r["a"])({},this.customData(2)),this.dataLayoutSet(2)),e=this.pluginData.attr.data.jump_url.includes("?")?"&":"?";for(var a in t)e+="".concat(a,"=").concat(t[a],"&");window.location.href=this.pluginData.attr.data.jump_url+e.slice(0,e.length-1);break;case"refresh":window.location.reload();break;case"close":if(window.parent.postMessage({iframStatus:1},"*"),window.childTableForm){window.childTableForm.closeChild();break}window.close();break;case"hint":break;case"rdatasource":this.REFRESH_DATASOURCE({fid:this.forminfo.formId,params:{pKey:this.pluginData.attr.data.rsdatasuorce}});break}}}),created:function(){this.pluginData.data||(this.pluginData.data={})},mounted:function(){this.updateData(this.pluginData),this.submitinRepeat()},mixins:[Ia["a"],Pa["a"]]})),wi=Ci,xi=Object(d["a"])(wi,_i,Di,!1,null,null,null),ki=xi.exports,Si=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin-allbox dplugin-mobile-rinput"},[a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{class:{"dplugin-pc":1,"dplugin-doneplugin":1,"room-box":1,"bg-white":t.pluginData.status.readonly}},[t.pluginData.status.readonly?[t._l(t.rightShowList,(function(e,n){return[e.allDay?[a("span",{staticClass:"readonly-style"},[a("span",[t._v(t._s(n))]),t._v(" "),a("span",[t._v("全天")])])]:t._l(e,(function(e,i){return a("span",{key:i,staticClass:"readonly-style"},[a("span",[t._v(t._s(n))]),t._v(" "),1==e?a("span",[t._v("上午")]):2==e?a("span",[t._v("下午")]):3==e?a("span",[t._v("晚上")]):t._e()])}))]}))]:[a("span",{staticClass:"room-box-tlt"},[t._v("选择预定日期")]),t._v(" "),a("div",{staticClass:"room-box-cont"},[a("div",{staticClass:"room-box-cont-l"},[a("div",{staticClass:"room-box-cont-l-top"},[1==t.pluginData.attr.data.getIdType?a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini"},on:{change:t.getRoom},model:{value:t.roomId,callback:function(e){t.roomId=e},expression:"roomId"}},t._l(t.allRoomList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1):t._e(),t._v(" "),a("el-select",{staticStyle:{width:"90px"},attrs:{size:"mini",placeholder:"年"},on:{change:function(e){return t.setMonth()}},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}},t._l(t.yearList,(function(t){return a("el-option",{key:t,attrs:{label:t+"年",value:t}})})),1),t._v(" "),a("el-select",{staticStyle:{width:"90px"},attrs:{size:"mini",placeholder:"月"},on:{change:t.getRoom},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}},t._l(t.monthList,(function(t){return a("el-option",{key:t,attrs:{label:t+"月",value:t}})})),1),t._v(" "),t._m(0)],1),t._v(" "),a("div",{staticClass:"room-box-cont-l-bottom"},[t._m(1),t._v(" "),t._l(t.roomShowList,(function(e){return[a("div",{staticClass:"room-box-cont-l-bottom-day room-box-cont-l-bottom-line",staticStyle:{"margin-bottom":"4px"}},[a("div"),t._v(" "),t._l(e,(function(e,n){return a("div",{key:n},[0!=e&&e==t.nowDay?a("span",{staticClass:"room-jin"},[t._v("今")]):0!=e?[t._v(t._s(e.split("-")[2]))]:t._e()],2)}))],2),t._v(" "),a("div",{staticClass:"room-box-cont-l-bottom-stat room-box-cont-l-bottom-line",staticStyle:{"margin-top":"4px"}},[t._m(2,!0),t._v(" "),t._l(e,(function(e,n){return a("div",{key:n},[e?t._l(t.roomObj[e],(function(e,n){return a("div",{key:n,staticStyle:{position:"relative"}},[0==e.status?a("span",{staticClass:"room-status"},[t._v("过期")]):9==e.status?a("span",{staticClass:"room-status"},[t._v("禁用")]):1==e.status?a("span",{staticClass:"room-status room-kongxian",class:{"room-active":t.pluginData.data.includes(e.id)},on:{click:function(a){return t.setRoom(e.id)}}},[t._v("空闲")]):[2,3].includes(e.status)?a("span",{staticClass:"room-status room-yuding"},[t._v("已预定")]):t._e(),t._v(" "),e.order_id.length&&1==e.status?a("div",{staticClass:"room-pai room-status-pai"},[t._v("排")]):t._e()])})):t._e()],2)}))],2)]}))],2)]),t._v(" "),a("div",{staticClass:"room-box-cont-r"},[a("div",{staticClass:"room-box-cont-r-tit"},[t._v("\n\t\t\t\t\t\t\t\t已选日期\n\t\t\t\t\t\t\t")]),t._v(" "),a("table",[t._m(3),t._v(" "),a("tbody",[0==t.pluginData.data.length?a("tr",[a("td",[t._v("无")]),t._v(" "),a("td",[t._v("无")]),t._v(" "),a("td")]):t._e(),t._v(" "),t._l(t.rightShowList,(function(e,n){return[e.allDay?[a("tr",[a("td",[t._v(t._s(n))]),t._v(" "),a("td",[t._v("全天")]),t._v(" "),a("td",[a("i",{staticClass:"el-icon-delete xiaoshou",on:{click:function(a){t.delData(Object.keys(e))}}})])])]:t._l(e,(function(e,i){return a("tr",{key:i},[a("td",[t._v(t._s(n))]),t._v(" "),1==e?a("td",[t._v("上午")]):2==e?a("td",[t._v("下午")]):3==e?a("td",[t._v("晚上")]):t._e(),t._v(" "),a("td",[a("i",{staticClass:"el-icon-delete xiaoshou",on:{click:function(e){return t.setRoom(+i)}}})])])}))]}))],2)])])])]],2):a("div",{staticClass:"dplugin-mobile dplugin-mobile-dDepart room-mobile"},[t._l(t.rightShowList,(function(e,n){return[e.allDay?a("div",{key:n,staticClass:"mobile-show"},[a("span",{staticStyle:{"margin-right":"0.4rem"}},[t._v(t._s(n))]),t._v(" "),a("span",[t._v("全天")]),t._v(" "),t.pluginData.status.readonly?t._e():a("i",{staticClass:"el-icon-error mainColor",on:{click:function(a){t.delData(Object.keys(e))}}})]):t._l(e,(function(e,i){return a("div",{key:i,staticClass:"mobile-show"},[a("span",{staticStyle:{"margin-right":"0.4rem"}},[t._v(t._s(n))]),t._v(" "),1==e?a("span",[t._v("上午")]):2==e?a("span",[t._v("下午")]):3==e?a("span",[t._v("晚上")]):t._e(),t._v(" "),t.pluginData.status.readonly?t._e():a("i",{staticClass:"el-icon-error mainColor",on:{click:function(e){return t.setRoom(+i)}}})])}))]})),t._v(" "),t.pluginData.status.readonly?t._e():a("span",{staticClass:"addbtn-room",on:{click:function(e){t.mobilepop=!0}}},[t._m(4),t._v(" "),a("i",{staticClass:"el-icon-arrow-right"})])],2)]:[a("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t\t \n\t\t\t")])],t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.mobilepop,expression:"mobilepop"}],staticClass:"wxsearchpop room-mobile",attrs:{id:"wxsearchs"}},[a("div",{staticClass:"room-mobile-cont"},[a("div",{staticClass:"room-mobile-top"},[a("i",{staticClass:"el-icon-arrow-left",class:{"room-disabled":t.yearList[0]==t.year&&t.monthList[0]==t.month},on:{click:t.before}}),t._v("\n\t\t\t\t\t"+t._s(t.year)+"年"+t._s(t.month)+"月\n\t\t\t\t\t"),a("i",{staticClass:"el-icon-arrow-right",class:{"room-disabled":t.yearList[t.yearList.length-1]==t.year&&t.monthList[t.monthList.length-1]==t.month},on:{click:t.next}})]),t._v(" "),t._m(5),t._v(" "),t._l(t.roomShowList,(function(e,n){return a("div",{key:n,staticClass:"room-mobile-day"},t._l(e,(function(e,n){return a("div",{key:n,on:{click:function(a){return t.activeNow(e)}}},[e?[t.activeDay==e?a("div",{staticClass:"room-mactive"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.split("-")[2])+"\n\t\t\t\t\t\t\t")]):[0!=e&&e==t.nowDay?a("span",{staticClass:"mainColor"},[t._v("今")]):a("span",[t._v(t._s(e.split("-")[2]))]),t._v(" "),a("div",[t._l(t.roomObj[e],(function(e,n){return[[2,3].includes(e.status)||t.pluginData.data.includes(e.id)?a("span",{key:n,staticClass:"active"}):[0,9].includes(e.status)?a("span",{key:n,staticClass:"grey"}):e.order_id.length&&1==e.status?a("span",{key:n,staticClass:"pai"}):1==e.status?a("span",{key:n,staticClass:"green"}):t._e()]}))],2)]]:t._e()],2)})),0)})),t._v(" "),t._m(6),t._v(" "),a("div",{staticClass:"room-mobile-activeList"},[a("div",{staticClass:"room-mobile-activeList-tlt"},[t._v("已选日期")]),t._v(" "),a("div",{staticClass:"room-mobile-activeList-cnt"},[t._l(t.rightShowList,(function(e,n){return[e.allDay?a("div",{key:n},[a("span",[t._v(t._s(n))]),t._v(" "),a("span",[t._v("全天")]),t._v(" "),a("i",{staticClass:"el-icon-error",on:{click:function(a){t.delData(Object.keys(e))}}})]):t._l(e,(function(e,i){return a("div",{key:i},[a("span",[t._v(t._s(n))]),t._v(" "),1==e?a("span",[t._v("上午")]):2==e?a("span",[t._v("下午")]):3==e?a("span",[t._v("晚上")]):t._e(),t._v(" "),a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.setRoom(+i)}}})])}))]}))],2)]),t._v(" "),a("div",{staticClass:"room-mobile-btn"},[a("span",{on:{click:function(e){return t.sureFn(!1)}}},[t._v("取消")]),t._v(" "),a("span",{staticClass:"active",on:{click:function(e){return t.sureFn(!0)}}},[t._v("完成")])])],2),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.addShow,expression:"addShow"}],staticClass:"room-mobile-zhezhao"}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.addShow,expression:"addShow"}],staticClass:"room-mobile-select"},[a("div",{staticClass:"room-mobile-select-top"},[a("span",{staticClass:"quxiao",on:{click:function(e){return t.addFn()}}},[t._v("取消")]),t._v(" "),a("span",{staticClass:"active",on:{click:function(e){return t.addFn(!0)}}},[t._v("添加")])]),t._v(" "),a("div",{staticClass:"room-mobile-select-bot"},t._l(t.roomObj[t.activeDay],(function(e,n){return a("div",{key:n},[a("div",[t._v(t._s(e.pact_date))]),t._v(" "),a("div",[1==e.pact_time?a("span",[t._v("上午")]):2==e.pact_time?a("span",[t._v("下午")]):3==e.pact_time?a("span",[t._v("晚上")]):t._e(),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.order_id.length&&1==e.status,expression:"data.order_id.length && data.status == 1"}]},[t._v("有排队")])]),t._v(" "),a("div",[a("el-checkbox",{attrs:{disabled:1!=e.status,label:e.id},model:{value:t.holdData2,callback:function(e){t.holdData2=e},expression:"holdData2"}})],1)])})),0)])]),t._v(" "),t.pluginData.status.ispc?a("pluginIcon",{attrs:{disabledRequired:t.disabledNewRequired,status:t.boxClass,focusContent:t.getAllFocusContent}}):t._e()],2)])},Ai=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"room-box-cont-l-hint"},[a("div",{staticClass:"room-pai"},[t._v("排")]),t._v("\n\t\t\t\t\t\t\t\t\t有排队\n\t\t\t\t\t\t\t\t")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"room-box-cont-l-bottom-week room-box-cont-l-bottom-line"},[a("div"),t._v(" "),a("div",[t._v("周日")]),t._v(" "),a("div",[t._v("周一")]),t._v(" "),a("div",[t._v("周二")]),t._v(" "),a("div",[t._v("周三")]),t._v(" "),a("div",[t._v("周四")]),t._v(" "),a("div",[t._v("周五")]),t._v(" "),a("div",[t._v("周六")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"room-status"},[t._v("上午")]),t._v(" "),a("div",{staticClass:"room-status"},[t._v("下午")]),t._v(" "),a("div",{},[t._v("晚上")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("td",{staticStyle:{width:"80px"}},[t._v("日期")]),t._v(" "),a("td",{staticStyle:{width:"48px"}},[t._v("时段")]),t._v(" "),a("td",{staticStyle:{width:"24px"}})])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("i",{staticClass:"el-icon-date"}),t._v("\n\t\t\t\t\t\t选择时间\n\t\t\t\t\t")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"room-mobile-week"},[a("div",[t._v("日")]),t._v(" "),a("div",[t._v("一")]),t._v(" "),a("div",[t._v("二")]),t._v(" "),a("div",[t._v("三")]),t._v(" "),a("div",[t._v("四")]),t._v(" "),a("div",[t._v("五")]),t._v(" "),a("div",[t._v("六")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"room-mobile-explain"},[a("div",[a("span",{staticClass:"grey"}),t._v("不可选")]),t._v(" "),a("div",[a("span",{staticClass:"active"}),t._v("已预定")]),t._v(" "),a("div",[a("span",{staticClass:"green"}),t._v("空闲")]),t._v(" "),a("div",[a("span",{staticClass:"pai"}),t._v("有排队")])])}],Ei=(a("d575"),Object(s["b"])(s["a"],{name:"doneinput",data:{year:"",month:"",nowDay:"",yearList:[],monthList:[],roomObj:{},roomIdList:[],roomShowList:[],rightShowList:{},startWeek:0,holdData:[],holdData2:[],roomId:"",allRoomList:[],addShow:!1,activeDay:"",list:[1,2,3,4,5,6,7,8,9,10,11,12],mobilepop:!1},props:["plugin","forminfo"],watch:{month:function(){this.getRoom()},pluginData:function(t){this.updateData(t)},dataWatch:function(t){var e=this;this.updateData(this.pluginData),t.forEach((function(t){e.roomIdList[t]||e.getDetail()})),this.setRightList(t)},mobilepop:function(t){t&&(this.holdData=Object(He["a"])(this.pluginData.data),setTimeout((function(){var t=$(".room-mobile-btn").offset().top-$(".room-mobile-activeList-cnt").offset().top;$(".room-mobile-activeList-cnt")[0].style.maxHeight=t+"px"}),100))}},computed:{dataWatch:function(){return this.pluginData.data}},created:function(){var t=this;if(this.setYear(),this.getNowDay(),1==this.pluginData.attr.data.getIdType)this.getAllRoom();else var e=0,a=setInterval((function(){(t.evnHelper.get(t.pluginData.attr.data.roomId)||e>20)&&(t.roomId=t.evnHelper.get(t.pluginData.attr.data.roomId),t.getRoom(),clearInterval(a)),e++}),500);this.pluginData.data.forEach((function(e){t.roomIdList[e]||t.getDetail()}))},mounted:function(){this.updateData(this.pluginData)},methods:{updateData:function(t){this.updateClassData(t)},setMonth:function(){var t=new Date,e=t.getMonth()+1,a=3;this.year==t.getFullYear()?this.monthList=this.list.slice(this.list.indexOf(e),e+a):this.monthList=this.list.slice(0,5-(12-this.list.indexOf(e))),this.month=this.monthList[0]},setYear:function(){var t=new Date,e=this.month=t.getMonth()+1;this.year=t.getFullYear(),this.yearList.push(t.getFullYear()),e>8&&this.yearList.push(this.year+1),this.setMonth()},setRoom:function(t){if(!this.pluginData.status.readonly)if(this.pluginData.data.includes(t))this.pluginData.data.splice(this.pluginData.data.indexOf(t),1);else{if(this.pluginData.attr.data.maxRoom&&this.pluginData.attr.data.maxRoom==this.pluginData.data.length)return void this.$message.warning("最多可预约".concat(this.pluginData.attr.data.maxRoom,"场会议室"));this.pluginData.data.push(t)}},getNowDay:function(){var t=new Date,e=t.getFullYear()+"-",a=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",n=t.getDate()<10?"0"+t.getDate():t.getDate();this.nowDay=e+a+n},setRoomData:function(t){var e=this,a={};t.forEach((function(t){a[t.pact_date]||(a[t.pact_date]={}),a[t.pact_date][t.pact_time]=t,e.roomIdList[t.id]=t}));var n=new Date(Object.keys(a)[0]).getDay(),i=[],r=Object.keys(a);r.forEach((function(t){if(0==r.indexOf(t)){if(i[0]=[],7!=n){var e=1;while(e<=n)i[0].push(0),e++}i[0].push(t)}else 7==i[i.length-1].length&&(i[i.length]=[]),i[i.length-1].push(t)})),this.roomObj=a,this.roomShowList=i,this.setRightList(this.pluginData.data)},setRightList:function(t){var e=this,a=t,n={};a.forEach((function(t){var a=e.roomIdList[t];a&&(n[a.pact_date]||(n[a.pact_date]={}),n[a.pact_date][a.id]=a.pact_time,3==Object.keys(n[a.pact_date]).length&&(n[a.pact_date].allDay=1))})),this.rightShowList=n},delData:function(t){var e=this;this.pluginData.status.readonly||t.forEach((function(t){"allDay"!=t&&e.setRoom(+t)}))},before:function(){this.yearList[0]==this.year&&this.monthList[0]==this.month||(this.month!=this.monthList[0]?this.month=this.monthList[this.monthList.indexOf(this.month)-1]:this.year!=this.yearList[0]&&(this.year=this.yearList[0],this.setMonth(),this.month=this.monthList[this.monthList.length-1]))},next:function(){this.month!=this.monthList[this.monthList.length-1]?this.month=this.monthList[this.monthList.indexOf(this.month)+1]:this.year!=this.yearList[this.yearList.length-1]&&(this.year=this.yearList[this.yearList.length-1],this.setMonth(),this.month=this.monthList[0])},activeNow:function(t){var e=0;Object.values(this.roomObj[t]).forEach((function(t){[0,9].includes(t.status)&&e++})),e<3&&(this.activeDay=t,this.addShow=!0,this.holdData2=Object(He["a"])(this.pluginData.data),$(".room-mobile-zhezhao").fadeIn(300),$(".room-mobile-select").slideDown(300))},sureFn:function(t){t||(this.pluginData.data=Object(He["a"])(this.holdData)),this.mobilepop=!1},addFn:function(t){var e=this;if(t){if(!this.holdData2.length)return;this.pluginData.data=Object(He["a"])(this.holdData2),this.pluginData.attr.data.maxRoom&&this.pluginData.attr.data.maxRoom<=this.pluginData.data.length&&(this.pluginData.data=this.pluginData.data.slice(0,this.pluginData.attr.data.maxRoom),this.$message.warning("最多可预约".concat(this.pluginData.attr.data.maxRoom,"场会议室")))}$(".room-mobile-zhezhao").fadeOut(300),$(".room-mobile-select").slideToggle(300,(function(){e.addShow=!1}))},getAllRoom:function(){var t=this;this.appFetch({url:"roomAllList",method:"GET"},(function(e){e.e?t.$message.error(e.m):e.d.length&&(t.roomId=e.d[0].id,t.allRoomList=e.d,t.getRoom())}),(function(e){t.$message("系统错误")}))},getRoom:function(){var t=this;if(this.roomId){var e=String(this.year)+"-"+(this.month<10?"0"+this.month:String(this.month));this.appFetch({url:"getRoom",method:"GET",data:{room_id:this.roomId,month:e}},(function(e){e.e?t.$message.error(e.m):e.d.length&&t.setRoomData(e.d)}),(function(e){t.$message.error({message:e})}))}},getDetail:function(){var t=this;this.appFetch({url:"getDetailRoom",method:"GET",data:{room_list_ids:this.pluginData.data}},(function(e){e.e?t.$message.error(e.m):e.d.length&&e.d.forEach((function(e){t.roomIdList[e.id]=e}))}),(function(e){t.$message.error({message:e})}))}}})),Ti=Ei,Ii=Object(d["a"])(Ti,Si,Ai,!1,null,null,null),Pi=Ii.exports,Ni=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.isshow?[t.pluginData.status.ispc?n("div",{staticClass:"dplugin-pc dplugin-pc-docr"},[n("div",{staticClass:"image",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.data?n("img",{attrs:{src:t.siteConfig.imghost+"/"+t.pluginData.data,alt:""},on:{click:function(e){t.showImg=!0}}}):n("div",{staticClass:"desc",domProps:{innerHTML:t._s(t.pluginData.attr.data.desc)}})]),t._v(" "),t.pluginData.status.readonly?t._e():n("div",{staticClass:"btn"},[t.pluginData.data?[n("a",{staticClass:"red",attrs:{href:"javascript:;"},on:{click:t.uploadEvent}},[t._v("重新上传")]),t._v(" "),n("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.showImg=!0}}},[t._v("查看大图")])]:n("a",{attrs:{href:"javascript:;"},on:{click:t.uploadEvent}},[t._v("上传图片")]),t._v(" "),n("input",{ref:"upload",attrs:{type:"file"},on:{change:t.upload}})],2)]):n("div",{staticClass:"dplugin-mobile dplugin-mobile-docr"},[n("div",{staticClass:"image",style:t.appCommonH.getStyle(t.getTextStyle())},[t.pluginData.data?n("img",{attrs:{src:t.siteConfig.imghost+"/"+t.pluginData.data,alt:""},on:{click:function(e){t.showImg=!0}}}):n("div",{staticClass:"desc",domProps:{innerHTML:t._s(t.pluginData.attr.data.desc)}})]),t._v(" "),t.pluginData.status.readonly?t._e():n("div",{staticClass:"btn"},[t.pluginData.data?[n("a",{staticClass:"red",attrs:{href:"javascript:;"},on:{click:t.uploadEvent}},[t._v("重新上传")]),t._v(" "),n("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.showImg=!0}}},[t._v("查看大图")])]:n("a",{attrs:{href:"javascript:;"},on:{click:t.uploadEvent}},[t._v("上传图片")]),t._v(" "),n("input",{ref:"upload",attrs:{type:"file"},on:{change:t.upload}})],2)]),t._v(" "),t.showImg?n("div",{class:t.pluginData.status.ispc?"dOcr_show_img":"dOcr_show_mimg"},[n("img",{attrs:{src:a("8e80"),alt:""},on:{click:function(e){t.showImg=!1}}}),t._v(" "),n("div",[n("img",{attrs:{src:t.siteConfig.imghost+"/"+t.pluginData.data,alt:""}})])]):t._e()]:[n("div",{class:t.hiddenClass,style:t.appCommonH.getStyle(t.getTextStyle())},[t._v(" ")])]],2)},Ri=[],Bi=a("c12c"),Oi=Bi["a"],Mi=Object(d["a"])(Oi,Ni,Ri,!1,null,null,null),Li=Mi.exports,Ui={dOneInput:p,dIntegerInput:_,dNumericInput:S,dSelect:N,dSelectV2:U,dRadio:V,dCheckbox:J,dmultiText:nt,dmultiInputs:ct,dInput:vt,dImage:wt,dUser:It,dCountry:Mt,dCountryV2:jt,dUserSearch:Kt,dOpinion:te,dCalendar:se,dMultiple:pe,dLink:be,dAvatar:Ie,dFile:Me,dDepart:Ye,dJoinSign:aa,dProjectNumber:la,dPasswd:ga,dSeal:Aa,dHandSignature:Oa,dBinding:Ha,dQuote:Ga,dCount:an,dRegion:hn,dPayment:_n,dQrcode:In,dSync:Mn,dShow:jn,dSerial:Kn,dChildTable:ti,dArticle:si,dXImage:pi,dRichText:yi,dSubmit:ki,dRoom:Pi,dOcr:Li},Fi={name:"allPlugin",components:Object(r["a"])({},Ui),props:["ptablesendmessage","sendmessage","watchmessage","plugin","forminfo","pluginUpdateInfo","rtupdateInfo"],data:function(){return{sendData:null}},watch:{watchmessage:function(t){this.sendData=t}},methods:{postMessage:function(t){this.$emit("sendmessage",t)},posttablesendmessage:function(t){this.$emit("ptablesendmessage",t)}},mounted:function(){this.sendData=this.watchmessage},created:function(){}},$i=Fi,Hi=Object(d["a"])($i,ba,ya,!1,null,null,null),ji=Hi.exports,Wi=a("152b"),zi=a.n(Wi),Vi=a("dc64"),qi=a("eead"),Gi=(a("6367"),a("7afe")),Ki=a.n(Gi),Xi={name:"dRepeatTable",mixins:[Ia["a"],Pa["a"]],data:{initTr:{id:"",style:{height:0},tds:[]},initTd:{id:"",rowspan:1,colspan:1,style:(fi={borderColor:""},Object(va["a"])(fi,"borderColor","#000"),Object(va["a"])(fi,"borderStyle","solid"),fi),table:{},dataid:""},tableStyle:{borderWidth:1,borderColor:"#BBBBBB",borderStyle:"solid",defaultWidth:50,defaultHeight:35},table:{},operationAlert:{removeCol:!0,addCol:!0,removeTable:!0,removeRow:!0,prevPrint:!0,nextPrint:!0},selectData:{selectIds:[]},tdChangeInfo:{nowTarget:null,oldEventX:0},plugins:{},rtplugins:[],importUpload:!1,printDefaultHeight:20,selectTrIndex:-1,tdPrint:{trData:"",oldEventY:0},maxline:9999,total:0,allPageNum:0,currentPage:0,currentData:[]},props:["rtsendmessage","rtupdateInfo","plugin","forminfo"],components:{rtallPlugin:ji},computed:Object(r["a"])(Object(r["a"])({},Object(o["d"])("form",{isPrintMake:function(){return this.$store.state.form.isPrintMake},printInfo:function(){var t=this.forminfo&&void 0!==this.forminfo.formId?this.forminfo.formId:"0",e=this.$store.state.form.repeatPrintInfo[t],a=(e=e||{},e[this.pluginData.key]);return a||{}}})),{},{getShowSetRowNum:function(){var t=!this.pluginData.status.formmodeedit&&!this.pluginData.status.readonly&&this.getOperateWidth();return this.table.trs[0].tds.length-(t?0:1)},nowPageSize:function(){return this.pluginData.attr.setInfo.pageSize?+this.pluginData.attr.setInfo.pageSize:0},isShowPage:function(){return!this.forminfo.isPrintMode&&this.nowPageSize&&this.pluginData.status.ispc&&this.pluginData.data.length/this.nowPageSize>1},showAllData:function(){return this.isShowPage?this.currentData:this.pluginData.data}}),watch:{pluginData:function(t){var e=this;this.updateData(t),setTimeout((function(){e.shouInsexList()}),500)},plugin:function(){this.updateData()},"selectData.selectIds":function(t){this.rtPostMessage({method:"updateRtSelectData",data:t})},"selectData.selectIds.length":function(){this.rtPostMessage({method:"updateRtSelectData",data:this.selectData.selectIds})},rtupdateInfo:function(t){t.method&&this[t.method]&&this[t.method](t),this.changeBorderCollapse()},showAllData:function(t){if(this.nowPageSize&&t[0]&&t[0].id){var e=[];t.forEach((function(t){e.push(t.id)})),this.RETABLE_IDS({fid:this.forminfo.formId,key:this.pluginData.key,params:e})}}},methods:Object(r["a"])(Object(r["a"])({},Object(o["c"])("form",["SET_PRINTMAKE","DEL_PRINTMAKE","REPEAT_OPERATIONALERT","REFRESH_RTABLE","RETABLE_IDS"])),{},{update:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},initPage:function(t,e){if(!this.isShowPage||!this.pluginData.status.ispc)return!1;t=t||1,this.total=this.getNowSearchData().length,this.allPageNum=Math.ceil(this.total/this.nowPageSize),t=t>this.allPageNum?this.allPageNum:t,e&&(t=this.allPageNum),this.setCurrentPage(t)},setCurrentPage:function(t){var e=this;this.currentPage=t;var a=(this.currentPage-1)*this.nowPageSize+0,n=a+this.nowPageSize,i=[],r=this;this.currentData=this.appCommonH.copyObj(this.getNowSearchData().slice(a,n)),this.currentData.forEach((function(t,e){var n={},s=0;for(var o in t)if(r.plugins[o]){t["oldIndex"]?s=t["oldIndex"]:(s=a+e,t["oldIndex"]=s);var l=Math.random(),u=r.addPlugin(o,l);u.data=t[o],u.rowCol={rownum:s,colnum:o},n[o]=u}i.push(n)})),this.rtplugins=[],this.$nextTick((function(){e.rtplugins=i,e.shouInsexList()}))},getNowSearchData:function(){return this.pluginData.data},pageChange:function(){this.setCurrentPage(this.currentPage)},getRealRow:function(t){if(this.isShowPage){var e=(this.currentPage-1)*this.nowPageSize+t;return e}return t},isShowAddButton:function(t){if(!this.pluginData.attr.setInfo.buttons.add||this.pluginData.status.readonly)return!1;if(this.isShowPage){var e=(this.currentPage-1)*this.nowPageSize+t;return e==this.pluginData.data.length-1}return t==this.pluginData.data.length-1},init:function(){if(!this.pluginData||this.pluginData.status.formmodeedit)return!1;if(this.pluginData.data.length){var t=this;this.pluginData.data.forEach((function(e,a){t.addRowPlugin(a,e)})),t.changeBorderCollapse()}else this.addRow(-1);this.initImportUpload(),this.initPage(),this.shouInsexList()},initImportUpload:function(){if(this.pluginData.status.readonly||!this.pluginData.attr.setInfo.buttons.import||this.hasInitUpload)return!1;var t=this;this.hasInitUpload=!0,this.importUpload=new zi.a({upload_url:we["a"].getApi("uploadindex"),file_post_name:"upfile",post_params:{category:"all"},file_types:["xls","xlsx"],file_size_limit:"100M",auto_upload:!0,button_placeholder_id:"import"+this.pluginData.key,msg:{"-110":"文件大小不能超过100","-130":"文件类型错误，请上传execl文档","-140":"文件上传失败，请重试！","-150":"没有选择可上传文件"},file_queue_error_handler:function(e){t.$message({type:"error",message:e})},upload_error_handler:function(){t.$message({type:"error",message:"文件上传失败，请重试！"})},upload_success_handler:function(e,a){"SUCCESS"==a.state?t.getDataByExeclPath(a.url):t.$message({type:"error",message:a.state})}})},getDataByExeclPath:function(t){var e=this;this.appFetch({url:"getDataByExeclPath",method:"GET",data:{path:t}},(function(t){0==t.e?e.dataToRepeatTable(t.d):e.$message({type:"error",message:"解析上传数据失败"})}),(function(){e.$message({type:"error",message:"解析上传数据失败"})}))},dataToRepeatTable:function(t){this.pluginData.attr.setInfo.importType&&(this.rtplugins=[],this.pluginData.data=[]);var e=[],a=this.pluginData.attr.setInfo.importBind,n=this;if(t.forEach((function(t){var i=n.getDataModel();for(var r in i)a[r]&&t[a[r]]&&(i[r]=t[a[r]]);e.push(i)})),!e.length)return!1;1!=this.pluginData.data.length||this.checkRowData(0)||this.removeRowPlugin(0,!0);var i=this.pluginData.data.length;e.forEach((function(t,e){n.addRowPlugin(i+e,t),n.changeBorderCollapse()})),this.initPage(),this.shouInsexList()},checkRowData:function(t){var e=this.pluginData.data[t];for(var a in e)if(qi["a"].checkValue(this.rtplugins[t][a]))return!0;return!1},getDataModel:function(){var t={},e=this;return this.table.trs[1].tds.forEach((function(a,n){a.dataid&&(t[a.dataid]=e.plugins[a.dataid].data)})),t},isShowSetRow:function(){if(!this.pluginData.attr.setInfo)return!1;var t=this.pluginData.attr.setInfo.buttons;return t.import||t.refresh||t.export},resetInit:function(t){t&&t.key&&t.key!=this.pluginData.key||(this.$delete(this.rtplugins,0),this.init())},setCPlugin:function(t){if(!t||!t.key||t.key==this.pluginData.key){var e=this.getRowNumByRowId(t.data.rownum);if(!1===e)return!1;var a=this.rtplugins[e][t.data.ckey];1==t.data.targetColumn?(a.data=this.appCommonH.copyObj(t.data.data),a=Vi["a"].setComPluginData(a)):(a.attr.data.options=this.appCommonH.copyObj(t.data.data),a.data=this.appCommonH.copyObj(a.initdata)),this.setPluginValue(a,!0)}},getRowNumByRowId:function(t){var e=!1;return isNaN(t)?this.showAllData.forEach((function(a,n){a.id==t&&(e=n)})):e=t,e},setAlertPlugin:function(t){if(!t||!t.key||t.key==this.pluginData.key){var e=this.rtplugins[t.data.rownum][t.data.ckey];e.alertFoucsMsg=t.data.msg}},toRemovePrintRow:function(t){t&&t.key&&t.key!=this.pluginData.key||(this.removePrintRow(),this.REPEAT_OPERATIONALERT({}))},toAddPrintRow:function(t){t&&t.key&&t.key!=this.pluginData.key||(this.addPrintRow(t.data.type),this.REPEAT_OPERATIONALERT({}))},showRequired:function(t){if(!t&&t.data[this.pluginData.key]){var e=t.data[this.pluginData.key],a=this;e.forEach((function(t){var e=a.rtplugins[t.row][t.key];e=this.appCommonH.copyObj(e),e.status.warning=!0,a.$set(a.rtplugins[t.row],t.key,e)}))}},addKeyToRow:function(t){return this.nowPageSize&&!t.id&&(t.id=ot()(Math.random().toString())),t},addRowPlugin:function(t,e){e=void 0!==e?e:{};var a={},n=this;if(this.isShowPage){var i={};this.table.trs[1].tds.forEach((function(t,a){if(t.dataid)if(Vi["a"].isSpecialPlugin(t.dataid)){var r=Math.random(),s=n.addPlugin(t.dataid,r);s.data=void 0!==e[t.dataid]?e[t.dataid]:s.data,s=Vi["a"].setComPluginData(s),i[t.dataid]=n.appCommonH.copyObj(s.data)}else{s=n.plugins[t.dataid]?n.plugins[t.dataid]:{data:""};var o=void 0!==e[t.dataid]?e[t.dataid]:s.data;i[t.dataid]=n.appCommonH.copyObj(o)}})),i=this.addKeyToRow(i),this.$set(this.pluginData.data,t,i)}else this.table.trs[1].tds.forEach((function(i,r){if(i.dataid){var s=Math.random(),o=n.addPlugin(i.dataid,s);o.data=null!==e&&void 0!==e[i.dataid]?e[i.dataid]:o.data,o=Vi["a"].setComPluginData(o),n.plugins[s]=o,a[i.dataid]=o,n.addData(o.data,t,r)}})),this.rtplugins[t]=a;this.update()},addPlugin:function(t,e){var a=this.appCommonH.copyObj(this.plugins[t]);return a.model=t,a.key=e,a},addData:function(t,e,a){var n=this.appCommonH.copyObj(this.pluginData.data);n[e]=n[e]?n[e]:{},n[e][this.getColName(a)]=t,n[e]=this.addKeyToRow(n[e]),this.pluginData.data=n},getColName:function(t){var e="";return this.table.trs[1].tds.forEach((function(a,n){t==n&&(e=a.dataid)})),e},getColNum:function(t){var e=0;return this.table.trs[1].tds.forEach((function(a,n){t==a.dataid&&(e=n)})),e},removeRowPlugin:function(t,e){this.isShowPage?this.$delete(this.pluginData.data,this.getRealRow(t)):(this.$delete(this.pluginData.data,t),this.$delete(this.rtplugins,t)),e||this.update()},updateSelectData:function(t){var e=[],a=this;t.data.forEach((function(t){t.key==a.pluginData.key&&e.push(t.id)})),this.selectData.selectIds=e},updateData:function(t){t&&(this.updateClassData(t),this.table=t.attr.data),this.plugins=this.plugin.rtplugins,this.changeBorderCollapse()},rtPostMessage:function(t){t.key=this.pluginData.key,this.$emit("rtsendmessage",t)},isSelect:function(t){return this.selectData.selectIds.includes(t)?"selected":""},checkTdCanSelect:function(t){var e=!0,a=this.table;return a.trs.forEach((function(a,n){a.tds.forEach((function(a,n){a.dataid&&t==a.id&&(e=!1)}))})),e},tdMouserdown:function(t,e){if(!this.checkTdCanSelect(t))return!1;this.selectData.selectIds=[t];var a=this;setTimeout((function(){a.rtPostMessage({method:"removeOtherSelect"})}),100)},tdChangeMousemove:function(t,e){var a=t.target;if("TD"==a.tagName&&(t.offsetX>=a.offsetWidth-10&&!e?this.changeCursor("col-resize"):this.changeCursor("default")),this.tdChangeInfo.nowTarget){var n=t.x-this.tdChangeInfo.oldEventX,i=$(this.tdChangeInfo.nowTarget).index(),r=this.table,s=r.tdModels[i].width+n;s=s<10?10:s,r.tdModels[i].width=s,r.width=r.width+n,this.changeTableWidth(r.width),this.tdChangeInfo.oldEventX=t.x}return!1},tdChangeMousedown:function(t){t.offsetX>=t.target.offsetWidth-10&&"TD"==t.target.tagName&&(this.selectData.selectIds=[],this.tdChangeInfo.nowTarget=t.target,this.tdChangeInfo.oldEventX=t.x)},tdChangeMouseup:function(t){this.tdChangeInfo.nowTarget=null,this.tdChangeInfo.oldEventX=0,this.changeCursor("default")},changeBorderCollapse:function(){$(this.$el).find("table").css({borderSpacing:"1px"});var t=this;setTimeout((function(){$(t.$el).find("table").css({borderSpacing:"0px"})}),50)},changeTableWidth:function(t){$(this.$el).find("table").css({width:t+"px"})},changeCursor:function(t){$("body").css({cursor:t})},checkAlertStatus:function(){if(1!==this.selectData.selectIds.length&&-1==this.selectTrIndex)return!1;var t=-1!==this.selectTrIndex&&this.selectTrIndex;return this.operationAlert={removeCol:this.table.tdModels.length>2,addCol:!0,removeTable:!0,removeRow:t&&this.printInfo[this.selectTrIndex],prevPrint:t&&-1===this.selectTrIndex.indexOf("_")&&!this.printInfo[this.selectTrIndex+"_prev"],nextPrint:t&&-1===this.selectTrIndex.indexOf("_")&&!this.printInfo[this.selectTrIndex+"_next"]},!0},getTdIndexByTdid:function(t){return $('[data-id="'+t+'"]').index()},_rtgetTdData:function(){var t=this.appCommonH.copyObj(this.initTd);return t.style.borderColor=this.tableStyle.borderColor,t.style.borderStyle=this.tableStyle.borderStyle,t.style.borderWidth=this.tableStyle.borderWidth,t.id=this.rtgetTableId(),t},_rtgetTrData:function(t,e){var a=this.appCommonH.copyObj(this.initTr);a.style.height=this.tableStyle.defaultHeight;for(var n=0;n<e;n++)a.tds.push(this._rtgetTdData(t));return a},rtgetTableId:function(){var t=+Math.random().toString().substring(2),e=(new Date).getTime(),a="td_"+(e+t);return a},removeSelect:function(t){this.selectData.selectIds=[]},removeRow:function(t){var e=this;if(this.pluginData.attr.setInfo.minline&&this.pluginData.attr.setInfo.minline>=this.rtplugins.length)return this.$message.warning({message:"不可少于"+this.pluginData.attr.setInfo.minline+"行",showClose:!0}),!1;this.$MessageBox.confirm("确定删除此条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,modal:!1,center:!0,customClass:"backMessageBoxClass"}).then((function(){e.pluginData.data.length>1?(e.removeRowPlugin(t),e.removeSelect(),e.changeBorderCollapse()):(e.removeRowPlugin(t),e.$nextTick((function(){this.addRow(-1)}))),e.initPage(e.currentPage),e.isShowPage||e.pluginData.data.length===e.rtplugins.length||e.init(),e.$message.success({message:"已删除"}),window.setTimeout((function(){e.resetInit({key:e.pluginData.key})}),600)})).catch((function(){e.$message.info({message:"已取消"})}))},addRow:function(t){this.rtplugins.length!=this.maxline&&(this.addRowPlugin(this.getRealRow(t)+1),this.removeSelect(),this.initPage(this.currentPage,!0),this.changeBorderCollapse())},removeCol:function(){var t=this.selectData.selectIds[0],e=this.getTdIndexByTdid(t),a=this.table,n=e;a.colnum=a.colnum-1;var i=a.tdModels.splice(n,1)[0];a.width=a.width-i.width,this.changeTableWidth(a.width),a.trs.forEach((function(t,e){t.tds.splice(n,1)})),a=this.appCommonH.copyObj(a),this.removeSelect(),this.changeBorderCollapse(),this.rtPostMessage({method:"repeatHistory",type:"removeCol"})},addCol:function(t){var e=this,a=this.selectData.selectIds[0],n=this.getTdIndexByTdid(a),i=this.table,r=n+1+("right"==t?0:-1);i.colnum=i.colnum+1,i.width=i.width+this.tableStyle.defaultWidth,i.tdModels.splice(r,0,{width:this.tableStyle.defaultWidth}),this.changeTableWidth(i.width);var s=this.appCommonH.copyObj(i.trs[0].tds[0]);s.table={},s.dataid="",i.trs.forEach((function(t,a){t.tds.splice(r,0,e._rtgetTdData())})),i=this.appCommonH.copyObj(i),this.removeSelect(),this.changeBorderCollapse(),this.rtPostMessage({method:"repeatHistory",type:"addCol"})},removeTable:function(){for(var t in this.plugins)this.plugins[t].pkey===this.pluginData.key&&this.rtPostMessage({method:"delRtPlugin",pluginkey:t});this.rtPostMessage({method:"delRtPlugin",pluginkey:this.pluginData.key}),this.rtPostMessage({method:"repeatHistory",type:"removeTable"})},addPrintRow:function(t){this.SET_PRINTMAKE({fid:this.forminfo.formId,tid:this.pluginData.key,trid:this.selectTrIndex+"_"+t,data:{type:"print",style:{height:this.printDefaultHeight}}}),this.changeBorderCollapse()},removePrintRow:function(){this.DEL_PRINTMAKE({fid:this.forminfo.formId,tid:this.pluginData.key,trid:this.selectTrIndex}),this.changeBorderCollapse()},getPrintRowInfo:function(t,e){return!!this.printInfo[t+"_"+e]&&this.printInfo[t+"_"+e]},getPrintColNum:function(){return this.table.trs[0].tds.length-1},tdPrintMouseDown:function(t,e){this.tdPrint.trData=this.printInfo[e],this.tdPrint.oldEventY=t.y},tdPrintMouseMove:function(t){if(!this.tdPrint.trData)return!1;var e=t.originalEvent.y-this.tdPrint.oldEventY,a=this.tdPrint.trData.style.height,n=a+e>this.printDefaultHeight?a+e:this.printDefaultHeight;this.tdPrint.trData.style.height=n,this.tdPrint.oldEventY=t.originalEvent.y,this.changeBorderCollapse()},tdPrintMouseUp:function(){this.tdPrint.oldEventY="",this.tdPrint.trData=null},selectTable:function(){this.rtPostMessage({method:"selectRTable"})},getRowColNum:function(t){var e={};return this.isShowPage&&t.rowCol?t.rowCol:(this.rtplugins.forEach((function(a,n){for(var i in a)a[i].key==t.key&&(e={rownum:n,colnum:i})})),e)},mobileGetNameByKey:function(t){var e=this,a="",n=-1;return this.table.trs?(this.table.trs[1].tds.forEach((function(e,a){e.dataid==t&&(n=a)})),this.table.trs[0].tds.forEach((function(t,i){i==n&&e.plugins[t.dataid]&&(a=e.plugins[t.dataid].data)})),a):""},setPluginValue:function(t,e){if(this.pluginData.status.formmodeedit)return!1;var a=this.getRowColNum(t);if(void 0===a.colnum)return!1;this.$set(this.pluginData.data[a.rownum],a.colnum,t.data),e||this.setCPlugin({data:{data:t.data,rownum:this.pluginData.data[a.rownum].id?this.pluginData.data[a.rownum].id:a.rownum,ckey:a.colnum,key:this.pluginData.key,targetColumn:1},key:this.pluginData.key}),this.postMessage(this.pluginData)},loadEvent:function(){var t=this,e='[data-key="'+t.pluginData.key+'"]',a=e+" .rtoperationalert";if($(document).on("mousemove",".pageBox",(function(e){t.tdPrint.trData&&t.tdPrintMouseMove(e)})),$(document).on("mouseup",".pageBox",(function(e){return t.tdPrint.trData&&t.tdPrintMouseUp(e),!1})),$(document).on("mouseleave",".pageBox",(function(e){return t.tdPrint.trData&&t.tdPrintMouseUp(e),!1})),$(e).contextmenu((function(){var e=null,n="TD"==event.target.tagName?$(event.target):$(event.target).parents("td").length?$(event.target).parents("td")[0]:$(event.target).parents("td");if(n=$(n),t.pluginData.status.formmodeedit){if(n.length&&n.find(".dplugin-box").length){var i=n.find(".dplugin-box").attr("data-key"),r=t.plugins[i];e=r&&r.pkey?r.tdid:e,e&&(t.selectData.selectIds=[e],setTimeout((function(){t.rtPostMessage({method:"removeOtherSelect"})}),100))}}else t.selectTrIndex=n.parent("tr").attr("data-trindex").toString();if(!t.checkAlertStatus(e))return!1;var s=!t.pluginData.status.formmodeedit&&t.isPrintMake?"body":".table_content",o=$(".pageBox").offset(),l=(o.left,o.top+$(s).scrollTop()),u=o.left+$(".pageBox").width(),d=l-20+($(s).outerHeight()>$(".pageBox").height()?$(".pageBox").height():$(s).outerHeight()),c={width:$(a).width(),height:$(a).height()},p=event.clientY,h=event.clientX;return u-event.clientX<c.width&&(h=event.clientX-c.width-2),d-event.clientY<c.height&&(p=event.clientY-c.height-2),t.isPrintMake&&!t.pluginData.status.formmodeedit?t.REPEAT_OPERATIONALERT({key:t.pluginData.key,top:p+"px",left:h+"px",display:"block",removeRow:t.operationAlert.removeRow,prevPrint:t.operationAlert.prevPrint,nextPrint:t.operationAlert.nextPrint}):$(a).css({top:p+"px",left:h+"px"}).show(),!1})),$("body").click((function(){$(a).is(":visible")&&($(a).hide(),t.REPEAT_OPERATIONALERT({}))})),$(e).on("mouseover",a+" li",(function(){return $(this).hasClass("active")||($(this).siblings("li").removeClass("active"),$(this).addClass("active")),!1})),$(e).on("mouseleave",a,(function(){return $(this).find(".active").removeClass("active"),!1})),!this.pluginData.status.formmodeedit)return!1;$(e).mouseleave((function(){return t.tdChangeMouseup(event),!1}))},offEvent:function(){var t='[data-key="'+this.pluginData.key+'"]',e=t+" .rtoperationalert";$(t).off("mouseover",e+" li"),$(t).off("mouseleave",e)},getOperateWidth:function(){if(!this.pluginData.status.formmodeedit&&this.pluginData.status.readonly&&this.pluginData.status.issave)return t=this.pluginData.attr.setInfo.buttons.sort?t=40:t,t;if(this.pluginData.attr.setInfo){var t=0;return t=this.pluginData.attr.setInfo.buttons.sort?t+40:t,t=this.pluginData.attr.setInfo.buttons.add?t+20:t,t=this.pluginData.attr.setInfo.buttons.del?t+20:t,t=this.pluginData.attr.setInfo.buttons.copy?t+20:t,t?t+10:t}return 30},toSort:function(t,e){this.rtplugins.length;var a=e?t-1:t+1;if(!this.rtplugins[a])return!1;this.rtplugins=this.appCommonH.swapArray(this.rtplugins,t,a),this.pluginData.data=this.appCommonH.swapArray(this.pluginData.data,this.getRealRow(t),this.getRealRow(a)),this.initPage(this.currentPage),this.$nextTick((function(){this.postMessage(this.pluginData)}))},setNewAttr:function(){this.pluginData.attr.setInfo||(this.pluginData.attr.setInfo={buttons:{import:!1,refresh:!1,sort:!1,add:!0,del:!0},importBind:{}}),void 0===this.pluginData.attr.setInfo.refreshV&&(this.pluginData.attr.setInfo.refreshV=0)},refreshData:function(){this.REFRESH_RTABLE({fid:this.forminfo.formId,params:{key:this.pluginData.key,type:"refresh"}})},exportss:function(){for(var t=this,e=[],a=[],n=[],i=[],r=0;r<this.table.trs[1].tds.length;r++)this.table.trs[1].tds[r].dataid&&i.push(this.table.trs[1].tds[r].dataid),this.table.trs[0].tds[r].dataid&&a.push(this.plugin.rtplugins[this.table.trs[0].tds[r].dataid].data);e.push(a),this.pluginData.data.forEach((function(a){for(var r=[],s=0;s<i.length;s++)if(["Input","Numeric","Numeric","MultiInput","User","Calendar","Link","Avatar","Binding","Passwd"].includes(t.rtplugins[0][i[s]].columnType))r.push(a[i[s]]);else if(["Select","Radio","Country","UserSearch"].includes(t.rtplugins[0][i[s]].columnType))r.push(a[i[s]].name);else if(["Checkbox","Multiple","Depart"].includes(t.rtplugins[0][i[s]].columnType)){for(var o="",l=0;l<a[i[s]].length;l++)o+=0==l?a[i[s]][l].name:","+a[i[s]][l].name;r.push(o)}else["Opinion"].includes(t.rtplugins[0][i[s]].columnType)?r.push(a[i[s]].option):["Ximage"].includes(t.rtplugins[0][i[s]].columnType)?(a[i[s]].map((function(t){return n.push(t)})),r.push(a[i[s]])):["File"].includes(t.rtplugins[0][i[s]].columnType)?(a[i[s]].map((function(t){return n.push(t.url)})),r.push(a[i[s]])):["Image"].includes(t.rtplugins[0][i[s]].columnType)?(n.push(a[i[s]]),r.push(a[i[s]])):r.push(a[i[s]]);e.push(r)})),this.appFetch({url:"repeatFile",method:"post",data:{files:n}},(function(t){t.e||(window.location.href=JSON.parse(window.sessionStorage.officeDb_getSiteConfig).imghost+"/"+t.d)}),(function(){}));var s=Ki.a.utils.aoa_to_sheet(e);this.openDownloadDialog(this.sheet2blob(s),window.tablevm.formName+".xlsx")},shouInsexList:function(){var t=this;this.pluginData.attr.setInfo.showIndex&&""!=this.pluginData.attr.setInfo&&setTimeout((function(){for(var e=t.isShowPage?t.currentData:t.pluginData.data,a=0;a<e.length;a++){var n=t.isShowPage?e[a].oldIndex+1:a+1;t.$set(e[a],t.pluginData.attr.setInfo.indexAssembly,n),t.rtplugins[a][t.pluginData.attr.setInfo.indexAssembly]&&t.$set(t.rtplugins[a][t.pluginData.attr.setInfo.indexAssembly],"data",n)}}),0)},sheet2blob:function(t,e){e=e||"sheet1";var a={SheetNames:[e],Sheets:{}};a.Sheets[e]=t;var n={bookType:"xlsx",bookSST:!1,type:"binary"},i=Ki.a.write(a,n),r=new Blob([s(i)],{type:"application/octet-stream"});function s(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!=t.length;++n)a[n]=255&t.charCodeAt(n);return e}return r},openDownloadDialog:function(t,e){"object"==Object(St["a"])(t)&&t instanceof Blob&&(t=URL.createObjectURL(t));var a,n=document.createElement("a");n.href=t,n.download=e||"",window.MouseEvent?a=new MouseEvent("click"):(a=document.createEvent("MouseEvents"),a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),n.dispatchEvent(a)},copy:function(t){if(this.rtplugins.length!=this.maxline){var e=this.pluginData.data[t-1],a={},n=this,i={};this.table.trs[1].tds.forEach((function(t,r){if(t.dataid){var s=Math.random(),o=n.addPlugin(t.dataid,s);o.data=void 0!==e[t.dataid]?e[t.dataid]:o.data,o=Vi["a"].setComPluginData(o),n.plugins[s]=o,a[t.dataid]=o,i[n.getColName(r)]=o.data}})),this.pluginData.data.splice(t,0,i),this.rtplugins.splice(t,0,a),this.update()}}}),created:function(){this.setNewAttr()},mounted:function(){var t=this;this.shouInsexList(),this.updateData(this.pluginData),this.init(),this.offEvent(),this.isPrintMake&&this.loadEvent(),window.retable=this;var e=0,a=setInterval((function(){if(++e,t.pluginData.attr.setInfo.minline&&t.pluginData.data.length<t.pluginData.attr.setInfo.minline)for(var n=t.pluginData.data.length-1,i=0;i<t.pluginData.attr.setInfo.minline-t.pluginData.data.length+2;i++)t.addRow(n+i);10==e&&clearInterval(a)}),1e3);this.pluginData.attr.setInfo.maxline?this.maxline=this.pluginData.attr.setInfo.maxline:this.maxline=9999},beforeDestroy:function(){this.offEvent()}},Yi=Object(s["b"])(s["a"],Xi),Ji=Yi,Zi=Ji,Qi=Object(d["a"])(Zi,fa,ma,!1,null,null,null),tr=Qi.exports,er=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-showhide",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t"+t._s(t.pluginData.description)+"\n\t")]):t._e()])},ar=[],nr=Object(s["b"])(s["a"],{name:"dshowhide",data:{lastData:{},lastAllData:{},defaultIsSet:!1},props:["ptablesendmessage"],watch:{pluginData:function(t){this.updateData(t)},allplugin:function(){this.updateData(this.pluginData)}},computed:{formLoaded:function(){var t=this.forminfo&&void 0!==this.forminfo.formId?this.forminfo.formId:"0",e=this.$store.state.form.formLoaded;return void 0===e[t]||e[t]}},methods:{updateData:function(t){this.updateClassData(t),this.countResult()},countResult:function(){if(this.pluginData.status.formmodeedit||!this.pluginData.status.isshow||this.pluginData.status.readonly||!this.formLoaded)return!1;for(var t in this.pluginData.attr.data.controls)this.setStatus(this.pluginData.attr.data.controls[t],t)},setStatus:function(t,e){var a=this.pluginData.attr.data.conditions[t.conkey]?this.pluginData.attr.data.conditions[t.conkey].expression:"";if(!a)return!1;var n=this.getKeyVal(),i=JSON.stringify(n);if(this.lastAllData[e]==i)return!1;this.lastAllData[e]=i;var r=Ya["a"].getResult(a,n,this.appCommonH.copyObj(this.allplugin));r=!!r;if(this.lastData[e]!==r&&r){for(var s in t.setInfo.plugins)this.setPluginInfo(t.setInfo.plugins[s],t.setInfo.isShow,t.setInfo.isRequired,t.setInfo.isEmpty);for(var s in t.setInfo.plugins)this.setPluginInfos(t.setInfo.plugins[s],t.setInfo.isShow,t.setInfo.isRequired)}this.lastData[e]=r},setPluginInfo:function(t,e,a,n){for(var i in this.allplugin.plugins)if(i==t){2!=e&&(this.allplugin.plugins[i].status.isshow=!!e),2!=a&&(this.allplugin.plugins[i].showHideSet=!0,this.allplugin.plugins[i].status.required=!!a);var r=!1;1==n&&(["MultiText","Text"].includes(i.split("_")[0])||(r=!0,this.allplugin.plugins[i].data=this.appCommonH.copyObj(this.allplugin.plugins[i].initdata))),(2!=e||2!=a||r)&&this.postMessage(this.allplugin.plugins[i])}},setPluginInfos:function(t,e,a){for(var n in this.allplugin.plugins)n==t&&2!=e&&this.$emit("ptablesendmessage",{type:"updateTrStatus",key:n})},getKeyVal:function(){var t={};for(var e in this.pluginData.attr.data.keyval){var a=this.pluginData.attr.data.keyval[e];"plugin"==a.type?(t[e]=a.evalVar,t[a.key+"Data"]=this.allplugin.plugins[a.key]?this.allplugin.plugins[a.key].data:""):t[e]=a.evalMethod}return t}},mounted:function(){this.updateData(this.pluginData)}}),ir=nr,rr=Object(d["a"])(ir,er,ar,!1,null,null,null),sr=rr.exports,or=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-showhide",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t"+t._s(t.pluginData.description)+"\n\t\t"),a("el-dialog",{attrs:{title:"同步数据",visible:t.dialogRetableRefresh,"append-to-body":!0,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,center:!0,"custom-class":"rTbaleDialog"},on:{"update:visible":function(e){t.dialogRetableRefresh=e}}},[a("div",[a("span",{staticStyle:{display:"inline-block",width:"150px"}},[a("el-select",{attrs:{placeholder:"请选择列",size:"small"},model:{value:t.rRSearchInfo.column,callback:function(e){t.$set(t.rRSearchInfo,"column",e)},expression:"rRSearchInfo.column"}},t._l(t.retableRefreshModel,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1),t._v(" "),a("span",{staticStyle:{display:"inline-block",width:"150px"}},[a("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:t.rRSearchInfo.keyword,callback:function(e){t.$set(t.rRSearchInfo,"keyword","string"===typeof e?e.trim():e)},expression:"rRSearchInfo.keyword"}})],1)]),t._v(" "),a("div",{staticClass:"tableBox"},[a("table",[a("thead",[a("tr",[a("th",[t._v("\n\t\t\t  \t\t\t\t\t选择\n\t\t\t  \t\t\t\t")]),t._v(" "),t._l(t.retableRefreshModel,(function(e,n){return a("th",[t._v(t._s(e))])}))],2)]),t._v(" "),t.searchRtableData.length?a("tbody",t._l(t.searchRtableData,(function(e){return a("tr",[a("td",[a("el-checkbox",{attrs:{label:e},model:{value:t.rTbaleSelected,callback:function(e){t.rTbaleSelected=e},expression:"rTbaleSelected"}},[t._v(" ")])],1),t._v(" "),t._l(t.retableRefreshModel,(function(n,i){return a("td",[t._v("\n\t\t\t  \t\t\t\t\t"+t._s(e[i])+"\n\t\t\t  \t\t\t\t")])}))],2)})),0):a("tbody",[a("tr",[a("td",{attrs:{colspan:t.rTbaleModelLength}},[t._v("暂无数据")])])])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogRetableRefresh=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.rTbaleOk}},[t._v("确 定")])],1)])],1):a("div",[a("el-dialog",{attrs:{title:"同步数据",width:"90%",visible:t.dialogRetableRefresh,"append-to-body":!0,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,center:!0,"custom-class":"rTbaleDialog"},on:{"update:visible":function(e){t.dialogRetableRefresh=e}}},[a("div",[a("span",{staticStyle:{display:"inline-block",width:"150px"}},[a("el-select",{attrs:{placeholder:"请选择列",size:"small"},model:{value:t.rRSearchInfo.column,callback:function(e){t.$set(t.rRSearchInfo,"column",e)},expression:"rRSearchInfo.column"}},t._l(t.retableRefreshModel,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1),t._v(" "),a("span",{staticStyle:{display:"inline-block",width:"150px"}},[a("el-input",{attrs:{placeholder:"请输入内容",size:"small"},model:{value:t.rRSearchInfo.keyword,callback:function(e){t.$set(t.rRSearchInfo,"keyword","string"===typeof e?e.trim():e)},expression:"rRSearchInfo.keyword"}})],1)]),t._v(" "),a("div",{staticClass:"tableBox"},[a("table",[a("thead",[a("tr",[a("th",[t._v("\n\t\t\t  \t\t\t\t\t选择\n\t\t\t  \t\t\t\t")]),t._v(" "),t._l(t.retableRefreshModel,(function(e,n){return a("th",[t._v(t._s(e))])}))],2)]),t._v(" "),t.searchRtableData.length?a("tbody",t._l(t.searchRtableData,(function(e){return a("tr",[a("td",[a("el-checkbox",{attrs:{label:e},model:{value:t.rTbaleSelected,callback:function(e){t.rTbaleSelected=e},expression:"rTbaleSelected"}},[t._v(" ")])],1),t._v(" "),t._l(t.retableRefreshModel,(function(n,i){return a("td",[t._v("\n\t\t\t  \t\t\t\t\t"+t._s(e[i])+"\n\t\t\t  \t\t\t\t")])}))],2)})),0):a("tbody",[a("tr",[a("td",{attrs:{colspan:t.rTbaleModelLength}},[t._v("暂无数据")])])])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogRetableRefresh=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.rTbaleOk}},[t._v("确 定")])],1)])],1)])},lr=[],ur=Object(s["b"])(s["a"],{name:"ddatasource",data:{lastData:null,lastDataV:0,nowSetKey:"",dialogRetableRefresh:!1,retableRefreshData:[],retableRefreshModel:{},rTbaleModelLength:0,rTablekey:"",rTbaleSelected:[],rRSearchInfo:{column:"",keyword:""}},props:["ptablesendmessage"],watch:{pluginData:function(t){this.updateData(t)},allplugin:function(){var t=this;this.updateData(this.pluginData),this.appCommonH.debounce(this.forminfo.formId+"_"+this.pluginData.key,(function(){t.dataChange()}),500)},repeatTableV:function(t){this.refreshRepeatTable(t)},refreshDS:function(t){t.pKey===this.pluginData.key&&this.getInfo()},nowRetableIds:function(t){this.retablePageDataChange()}},computed:Object(r["a"])(Object(r["a"])({},Object(o["d"])("form",["childDataSource","childNoCanSource","childNoCanSourceKeys","refreshRTable","refreshDataSource","retableIds"])),{},{searchRtableData:function(){var t=this;return this.rRSearchInfo.column&&this.rRSearchInfo.keyword?t.retableRefreshData.filter((function(e){return-1!==e[t.rRSearchInfo.column].indexOf(t.rRSearchInfo.keyword)})):this.retableRefreshData},repeatTableV:function(){return this.refreshRTable[this.forminfo.formId]},refreshDS:function(){return this.refreshDataSource[this.forminfo.formId]},nowRetableIds:function(){var t=this.pluginData.attr.data.selectRetable;return this.retableIds[this.forminfo.formId]&&this.retableIds[this.forminfo.formId][t]?this.retableIds[this.forminfo.formId][t]:[]}}),methods:{updateData:function(t){this.updateClassData(t)},getInfo:function(t){if(!this.isRightStatus())return!1;var e=this,a={id:this.pluginData.attr.data.sourceid,configure:{},inst_id:void 0===this.forminfo.instId?0:this.forminfo.instId,app_id:this.forminfo.appId};for(var n in this.pluginData.attr.data.sourceConfig)a.configure[n]=this.pluginData.attr.data.sourceConfig[n].value;a.params=t||this.getParams(),this.primaryUid&&(a.primary_uid=this.primaryUid),this.starterDepartId&&(a.starter_depart_id=this.starterDepartId),this.childDataSource[this.forminfo.formId]&&(a.params=Object(r["a"])(Object(r["a"])({},a.params),this.childDataSource[this.forminfo.formId])),window.localStorage.setItem("detailParams",JSON.stringify(a)),this.ADD_STARTLOADING(),this.appFetch({url:"getDataSourceData",data:a,method:"POST"},(function(a){0==a.e?(e.setPluginData(a.d.list,t),setTimeout((function(){e.formSourceRun({fid:e.forminfo.formId,sourceKey:e.pluginData.key})}),1500)):-1==a.e?console.log("不设置数据源信息"):console.error("获取数据源信息失败"),e.toReduceStartLoading()}),(function(t){e.toReduceStartLoading(),console.error("获取数据源信息失败",t)}))},setPluginData:function(t,e){if(void 0!==t&&this.pluginData.attr.data.resultKey){switch(this.pluginData.attr.data.resultKey){case"autoplugin":for(var a in t)this.setPluginOneData(a,t[a]);break;case"setplugin":if(!$.isEmptyObject(this.pluginData.attr.data.mapConfig))for(var a in this.pluginData.attr.data.mapConfig){var n=this.pluginData.attr.data.mapConfig,i=void 0!==t[n[a]["key"]]?t[n[a]["key"]]:"";this.nowSetKey?a==this.nowSetKey&&this.retableRefresh(a,i):(this.setPluginOneData(a,i),n[a].twoKey&&(i=void 0!==t[n[a]["twoKey"]]?t[n[a]["twoKey"]]:"",this.setPluginOneData(a,i,{key:n[a]["twoKey"],targetColumn:n[a]["twoTargetColumn"]})))}break;case"setrplugin":this.setRpluginData(t,e.rRetableRowNum);break;default:this.nowSetKey?this.retableRefresh(this.pluginData.attr.data.resultKey,t):this.setPluginOneData(this.pluginData.attr.data.resultKey,t)}this.nowSetKey=""}},rTbaleOk:function(){var t=this.allplugin.plugins[this.rTablekey];t&&(t.formtype="datasource",this.postMessage(t),"dRepeatTable"==t.type&&this.$emit("ptablesendmessage",{type:"resetRtable",method:"addRowData",key:t.key,data:this.rTbaleSelected})),this.dialogRetableRefresh=!1},retableRefresh:function(t,e){if(this.repeatTableV.modelType&&this.allplugin.plugins[t]){var a=this.allplugin.plugins[t],n=[],i={},r=[],s=0,o=this.getConfigMap(t),l=this;e=this.repeatTableChangeData(e,t),a.attr.data.tableData.trs[1].tds.forEach((function(t){t.dataid&&l.allplugin.rtplugins[t.dataid]&&o[t.dataid]&&(s++,i[t.dataid]=l.allplugin.rtplugins[t.dataid].description)})),a.data.forEach((function(e){n.push(JSON.stringify(l.getSourceSetRowData(e,t)))})),e.forEach((function(e){n.includes(JSON.stringify(l.getSourceSetRowData(e,t)))||r.push(e)})),this.rTablekey=t,this.rTbaleSelected=[],this.rRSearchInfo={column:"",keyword:""},this.rTbaleModelLength=s+1,this.retableRefreshData=r,this.retableRefreshModel=i,this.dialogRetableRefresh=!0}else this.setPluginOneData(t,e)},getConfigMap:function(t){var e="setplugin"===this.pluginData.attr.data.resultKey&&t?this.pluginData.attr.data.mapConfig[t].childrens:this.pluginData.attr.data.mapConfig;return e},getSourceSetRowData:function(t,e){var a={},n=this.getConfigMap(e);for(var i in t)n[i]&&(a[i]=void 0==t[i]?"":t[i]);return a},setRpluginData:function(t,e){var a=this.allplugin.plugins[this.pluginData.attr.data.selectRetable];if(a&&!$.isEmptyObject(this.pluginData.attr.data.mapConfig))for(var n in this.pluginData.attr.data.mapConfig){var i=this.pluginData.attr.data.mapConfig[n],r=i.targetColumn?i.targetColumn:this.pluginData.attr.data.targetColumn;this.$emit("ptablesendmessage",{type:"resetRtable",method:"setCPlugin",key:this.pluginData.attr.data.selectRetable,targetColumn:r,rownum:e,ckey:n,data:t[i.key]?t[i.key]:""}),i.twoKey&&this.$emit("ptablesendmessage",{type:"resetRtable",method:"setCPlugin",key:this.pluginData.attr.data.selectRetable,targetColumn:i.twoTargetColumn,rownum:e,ckey:n,data:t[i.twoKey]?t[i.twoKey]:""})}},setPluginOneData:function(t,e,a){var n=this.allplugin.plugins[t];n&&("dRepeatTable"==n.type&&(e=this.repeatTableChangeData(e,t)),this.setDataByColumn(n,e,a),"dRepeatTable"==n.type&&(n.formtype="datasource"),this.postMessage(n),"dRepeatTable"==n.type&&this.$emit("ptablesendmessage",{type:"resetRtable",method:"resetInit",key:n.key}))},setDataByColumn:function(t,e,a){var n=this.pluginData.attr.data.targetColumn;switch(a?n=a.targetColumn?a.targetColumn:n:this.pluginData.attr.data.mapConfig[t.key]&&(n=this.pluginData.attr.data.mapConfig[t.key].targetColumn?this.pluginData.attr.data.mapConfig[t.key].targetColumn:n),n){case 1:t.data=e,t=Vi["a"].setComPluginData(t);break;case 2:t.attr.data.options=e;break}},repeatTableChangeData:function(t,e){var a=[],n={},i=this;return n="setplugin"===this.pluginData.attr.data.resultKey?this.pluginData.attr.data.mapConfig[e].childrens:this.pluginData.attr.data.mapConfig,t.length&&t.forEach((function(t){var r=i.getInitDataByPkey(e);for(var s in r){var o=n[s]?n[s].key?n[s].key:n[s]:"";o&&(r[s]=t[o])}a.push(r)})),a},getInitDataByPkey:function(t){var e=this.allplugin.plugins[t],a={},n=this;if(e){var i="v3"==this.forminfo.version?e.attr.data.tableData:e.attr.data;i.trs[1].tds.forEach((function(t){t.dataid&&(a[t.dataid]=n.allplugin.rtplugins[t.dataid].data)}))}return a},isNotCanDo:function(){var t=this.childNoCanSource[this.forminfo.formId],e=this.childNoCanSourceKeys[this.forminfo.formId];return t=t||[],e=e||"",t.includes(this.pluginData.attr.data.sourceid)||-1!==e.indexOf(this.pluginData.key)},isRightStatus:function(){var t=this.pluginData.attr.data;return!t.runStatus.length||t.runStatus.includes(this.$store.state.form.formStatus[this.forminfo.formId].status)},dataChange:function(){if(this.pluginData.status.formmodeedit||!this.pluginData.attr.data.conditions||this.isNotCanDo())return!1;if(1==this.pluginData.attr.data.activeType){var t=this.pluginData.attr.data.selectRetable,e=this.allplugin.plugins[t];if(!e)return!1;+e.attr.setInfo.pageSize?this.retablePageDataChange(e):this.commonDataChange()}else this.commonDataChange()},commonDataChange:function(){var t={},e=0;this.allplugin.plugins[this.pluginData.attr.data.resultKey];if(e==this.lastDataV){if(!this.pluginData.status.isshow)return!1;if(this.pluginData.status.readonly&&2!=this.pluginData.attr.data["targetColumn"])return!1}var a=!1;if(2==this.pluginData.attr.data.type?(t=this.getParams(),JSON.stringify(t)!=JSON.stringify(this.lastData)&&(a=!0)):1==this.pluginData.attr.data.type&&null===this.lastData&&(a=!0),a||e!==this.lastDataV){if(1==this.pluginData.attr.data.activeType){var n=this.lastData&&this.lastData["paramsData"]?this.lastData["paramsData"]:[],i=t["paramsData"]||[],s=this;i.length>=n.length&&i.forEach((function(e,a){if(JSON.stringify(e)!==JSON.stringify(n[a])){var i=s.appCommonH.copyObj(t);delete i["paramsData"],s.getInfo(Object(r["a"])(Object(r["a"])({},i),e))}}))}else this.getInfo();this.lastDataV=e,this.lastData=this.appCommonH.copyObj(t)}},retablePageDataChange:function(t){var e=this.getParams2(this.nowRetableIds),a=e.paramsData;for(var n in delete e.paramsData,this.lastData=this.lastData?this.lastData:{},a){var i=Object(r["a"])(Object(r["a"])({},a[n]),e);this.lastData[n]?JSON.stringify(this.lastData[n])!==JSON.stringify(i)&&(this.lastData[n]=i,this.getInfo(i)):(this.lastData[n]=i,this.getInfo(i))}},refreshRepeatTable:function(t){var e=t.key;this.nowSetKey=e,("setplugin"==this.pluginData.attr.data.resultKey&&this.pluginData.attr.data.mapConfig[e]||this.pluginData.attr.data.resultKey==e)&&this.getInfo()},getParams:function(){var t=this.pluginData.attr.data.conditions,e=this,a={};if(1==this.pluginData.attr.data.activeType){var n=this.pluginData.attr.data.selectRetable,i={},r=[],s=this.allplugin.plugins[n];if(n&&s&&!+s.attr.setInfo.pageSize){t.forEach((function(t){if(1==t.type){var r=e.allplugin.rtplugins[t.value];r&&t.key&&(i[t.key]=r.key,n=r.pkey)}else a[t.key]=e.evnHelper.get(t.value)}));var o=s.data;o.forEach((function(t,e){var a={};for(var n in i)a[n]=void 0!==t[i[n]]?t[i[n]]:"";a["rRetableRowNum"]=e,r.push(a)})),a["paramsData"]=r}}else t.forEach((function(t){1==t.type?a[t.key]=e.allplugin.plugins[t.value]?e.allplugin.plugins[t.value].data:"":0===t.type&&(a[t.key]=e.evnHelper.get(t.value))}));return a},getParams2:function(t){var e=this.pluginData.attr.data.conditions,a=this,n={},i=this.pluginData.attr.data.selectRetable,r={},s={},o=this.allplugin.plugins[i];if(i&&o){e.forEach((function(t){if(1==t.type){var e=a.allplugin.rtplugins[t.value];e&&t.key&&(r[t.key]=e.key,i=e.pkey)}else n[t.key]=a.evnHelper.get(t.value)}));var l=o.data;l.forEach((function(e,a){if(t.includes(e.id)){var n={};for(var i in r)n[i]=void 0!==e[r[i]]?e[r[i]]:"";n.rRetableRowNum=e.id,s[e.id]=n}})),n["paramsData"]=s}return n}},mounted:function(){this.updateData(this.pluginData),this.dataChange()}}),dr=ur,cr=(a("ca199"),Object(d["a"])(dr,or,lr,!1,null,null,null)),pr=cr.exports,hr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-showhide",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t"+t._s(t.pluginData.description)+"\n\t")]):t._e()])},gr=[],fr=Object(s["b"])(s["a"],{name:"dValidate",props:["plugin","ptablesendmessage"],watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)}},mounted:function(){this.updateData(this.pluginData)}}),mr=fr,vr=Object(d["a"])(mr,hr,gr,!1,null,null,null),br=vr.exports,yr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-alert",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t\t"+t._s(t.pluginData.description)+"\n\t\t")]):t._e(),t._v(" "),a("el-dialog",{attrs:{title:t.pluginData.attr.data.alertTitle,visible:t.showAlert,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:t.alertWidth,"append-to-body":!0,"lock-scroll":!1,"custom-class":"sele_leave"},on:{"update:visible":function(e){t.showAlert=e}}},[a("div",{staticClass:"leave_con"},[a("div",{staticClass:"leave_real_con",domProps:{innerHTML:t._s(t.errorInfo)}}),t._v(" "),"2"!=t.pluginData.attr.data.defaultOrApi&&"alert"!=t.type||1!=t.pluginData.attr.data.affirmValue?t._e():a("div",{staticClass:"leave_checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.affirmType,expression:"affirmType"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.affirmType)?t._i(t.affirmType,null)>-1:t.affirmType},on:{change:function(e){var a=t.affirmType,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=null,s=t._i(a,r);n.checked?s<0&&(t.affirmType=a.concat([r])):s>-1&&(t.affirmType=a.slice(0,s).concat(a.slice(s+1)))}else t.affirmType=i}}}),t._v(" "+t._s(t.pluginData.attr.data.affirmContent)+"\n            ")]),t._v(" "),a("div",{staticClass:"help_btn"},[["warning","error"].includes(t.errroType)?a("a",{attrs:{href:"javascript:;"},on:{click:t.toServiceList}},[t._v("关闭页面")]):t._e(),t._v(" "),["warning","alert"].includes(t.errroType)?a("a",{attrs:{href:"javascript:;",id:t.disabledFun()},on:{click:function(e){return t.showAlertFun()}}},[t._v(t._s(t.Text))]):t._e()])])])],1)},_r=[],Dr=Object(s["b"])(s["a"],{name:"dalert",data:{showAlert:!1,errroType:"",errorInfo:"",lastShowKey:"",alertWidth:"600px",repeatTableKey:"",lastData:null,affirmType:!1,type:""},computed:{Text:function(){return this.pluginData.attr.data.btn?this.pluginData.attr.data.btn.match(/^[ ]+$/)?"继续填写":this.pluginData.attr.data.btn:"继续填写"}},props:["ptablesendmessage"],watch:{pluginData:function(t){this.updateData(t)},allplugin:function(){this.updateData(this.pluginData),this.dataChange()},primaryUid:function(){this.dataChange()}},methods:{updateData:function(t){this.updateClassData(t)},showAlertFun:function(){return"2"==this.pluginData.attr.data.defaultOrApi?1!=this.pluginData.attr.data.affirmValue||this.affirmType?this.showAlert=!1:void 0:"alert"!=this.type||1!=this.pluginData.attr.data.affirmValue||this.affirmType?this.showAlert=!1:void 0},disabledFun:function(){if("2"==this.pluginData.attr.data.defaultOrApi){if(1!=this.pluginData.attr.data.affirmValue)return"";if(!this.affirmType)return"forbid"}else{if("alert"!=this.type||1!=this.pluginData.attr.data.affirmValue)return"";if(!this.affirmType)return"forbid"}},toServiceList:function(){if(this.pluginData.attr.data.skipValue){var t=this.pluginData.attr.data.urlSite;window.open(t,"_self")}else{if(!this.appCommonH.isWeixin.isPhone){var e=navigator.appName;"Netscape"==e&&(window.open("","_self",""),window.close()),"Microsoft Internet Explorer"==e&&(window.parent.opener="whocares",window.parent.close())}this.$router.push(this.appCommonH.getClientType(this.$route.path)?"/site/m_index":"/site/index")}},getInfo:function(t){var e=this,a={id:this.pluginData.attr.data.apiId,inst_id:this.forminfo.instId,form_id:this.forminfo.formId};$.isEmptyObject(this.pluginData.attr.data.apiParams)||(a.arguments=this.repeatTableKey?t:this.getParams()),this.primaryUid&&(a.primary_uid=this.primaryUid),this.starterDepartId&&(a.starter_depart_id=this.starterDepartId),this.appFetch({url:"getnoticeDetail",data:a,method:"POST"},(function(a){0==a.e?"none"!=a.d.type&&(e.type=a.d.type,e.setAlert(a.d.type,a.d.data,t?t.rRetableRowNum:void 0)):console.log("获取提示信息失败")}),(function(){console.log("获取提示信息失败")}))},dataChange:function(){if(this.pluginData.status.formmodeedit||this.pluginData.status.readonly)return!1;1==this.pluginData.attr.data.defaultOrApi?this.handleApi():this.handleEdit()},handleApi:function(){var t="";switch(this.pluginData.attr.data.type){case 1:t=!0;break;case 3:if($.isEmptyObject(this.pluginData.attr.data.apiParams))t=!0;else if(this.repeatTableKey)this.handleRepeatApi();else t=JSON.stringify(this.getParams());break;case 2:if(!$.isEmptyObject(this.pluginData.attr.data.apiParams)){var e=0,a=0;for(var n in this.pluginData.attr.data.apiParams){e++;var i=this.pluginData.attr.data.apiParams[n].type,r=this.pluginData.attr.data.apiParams[n].value;if(1===i)t+=JSON.stringify(this.evnHelper.get(r)),a++;else{var s=!(!r||!this.allplugin.plugins[r])&&this.allplugin.plugins[r];s&&s.data&&(a++,t+=JSON.stringify(s.data))}}if(e!=a)return t="",!1}break}t!==this.lastShowKey&&this.pluginData.attr.data.apiId&&(this.lastShowKey=t,this.getInfo())},handleRepeatApi:function(){var t=this.getParams();if(JSON.stringify(t)!=JSON.stringify(this.lastData)){var e=this.lastData&&this.lastData["paramsData"]?this.lastData["paramsData"]:[],a=t["paramsData"],n=this;a.length>=e.length&&a.forEach((function(a,i){if(JSON.stringify(a)!==JSON.stringify(e[i])){var s=n.appCommonH.copyObj(t);delete s["paramsData"],n.getInfo(Object(r["a"])(Object(r["a"])({},s),a))}})),this.lastData=t}},handleEdit:function(){var t="";switch(this.pluginData.attr.data.type){case 1:case 3:t=!0,t!==this.lastShowKey&&(this.lastShowKey=t,this.setAlert(this.pluginData.attr.data.errorType));break;case 4:t=Ya["a"].getResult(this.pluginData.attr.data.condition,this.getKeyVal()),t=!isNaN(t)&&(!!t&&!!t),t&&t!==this.lastShowKey&&this.setAlert(this.pluginData.attr.data.errorType),this.lastShowKey=t;break}},getParams:function(){var t=this.pluginData.attr.data.apiParams,e=this,a={};if(this.repeatTableKey){var n=this.repeatTableKey,i={},r=[];for(var s in t){var o=t[s].value,l=t[s].type;if(1===l)o&&(i[s]={value:o,type:l});else{var u=e.allplugin.rtplugins[o];u&&s&&(i[s]={value:u.key,type:l})}}if(n&&this.allplugin.plugins[n]){var d=this.allplugin.plugins[n].data;d.forEach((function(t,e){var a={};for(var n in i){var s=i[n].value;1===i[n].type?a[n]={key:s,value:this.evnHelper.get(s)}:a[n]={key:s,value:void 0!==t[s]?t[s]:""}}a["rRetableRowNum"]=e,r.push(a)}))}a["paramsData"]=r}else for(var c in t){var p=t[c].value;l=t[c].type;1===l?a[c]={key:p,value:this.evnHelper.get(p)}:p&&this.allplugin.plugins[p]&&(a[c]={key:p,value:this.allplugin.plugins[p].data})}return a},setAlert:function(t,e,a){switch(t=t||"warning",e=e||{},this.pluginData.attr.data.type){case 1:case 2:case 4:if(1==this.pluginData.attr.data.defaultOrApi&&this.appCommonH.isEmptyObj(e))return!1;this.errorInfo=this.getAlertMsg(this.pluginData.attr.data.alertContent,e),this.errroType=t,this.showAlert=!0;break;case 3:var n=this;this.pluginData.attr.data.pluginAlerts.forEach((function(t){var i=n.getAlertMsg(t.msg,e),r="";1==n.pluginData.attr.data.defaultOrApi&&n.appCommonH.isEmptyObj(e)&&(i=""),n.repeatTableKey?n.$emit("ptablesendmessage",{type:"resetRtable",method:"setAlertPlugin",key:n.repeatTableKey,rownum:a,ckey:t.key,msg:i}):(n.allplugin.plugins[t.key]?r="plugins":n.allplugin.rtplugins[t.key]&&(r="rtplugins"),r&&(n.allplugin[r][t.key].alertFoucsMsg=i,n.postMessage(n.allplugin[r][t.key])))}))}},getAlertMsg:function(t,e){if(!$.isEmptyObject(e))for(var a in e)t=t.replace("$"+a,e[a]);return t},getKeyVal:function(){var t={};for(var e in this.pluginData.attr.data.keyval){var a=this.pluginData.attr.data.keyval[e];"plugin"==a.type?(t[e]=a.evalVar,t[a.key+"Data"]=this.allplugin.plugins[a.key]?this.allplugin.plugins[a.key].data:""):t[e]=a.evalMethod}return t},checkIsRepeatTable:function(){var t=this.pluginData.attr.data.apiParams;for(var e in t)this.allplugin.rtplugins[t[e].value]&&(this.repeatTableKey=this.allplugin.rtplugins[t[e].value].pkey)}},mounted:function(){this.updateData(this.pluginData),this.checkIsRepeatTable(),this.dataChange(),this.alertWidth=this.pluginData.status.ispc?this.alertWidth:"310px"}}),Cr=Dr,wr=Object(d["a"])(Cr,yr,_r,!1,null,null,null),xr=wr.exports,kr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-showhide",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t"+t._s(t.pluginData.description)+"\n\t")]):t._e()])},Sr=[],Ar=Object(s["b"])(s["a"],{name:"dConversion",props:["plugin"],data:{},watch:{pluginData:function(t){this.updateData(t)},allplugin:function(){this.updateData(this.pluginData)}},methods:{updateData:function(t){this.updateClassData(t)}},mounted:function(){this.updateData(this.pluginData)}}),Er=Ar,Tr=Object(d["a"])(Er,kr,Sr,!1,null,null,null),Ir=Tr.exports,Pr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:t.tableIsHide(),expression:"tableIsHide()"}],class:{"dplugin-layout":!0},style:t.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.formmodeedit?a("i",{staticClass:"moveelement"}):t._e(),t._v(" "),t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dplugin-table"},[a("table",{staticClass:"formtable clearfloat",style:t.getStyle(t.tableData.style,Object.assign({},{width:t.tableData.width+"px"},{marginLeft:t.pluginData.status.formmodeedit?"20px":"auto"})),attrs:{"data-id":t.tableData.id,"data-key":t.pluginData.key}},[a("thead",[a("tr",t._l(t.tableData.tdModels,(function(e,n){return a("th",{staticClass:"table_th_border_width",style:t.getStyle(Object.assign({},e,{height:"20px",lineHeight:"20px",boxSizing:"border-box"},t.getThStyle(n)))})})),0)]),t._v(" "),a("tbody",t._l(t.tableData.trs,(function(e,n){return a("tr",{directives:[{name:"show",rawName:"v-show",value:!e.isHide,expression:"!tr.isHide"}],style:t.getStyle(e.style,{},"table"),attrs:{"data-id":e.id}},t._l(e.tds,(function(e,n){return a("td",{directives:[{name:"show",rawName:"v-show",value:e.rowspan>0&&e.colspan>0,expression:"td.rowspan > 0 && td.colspan > 0"}],class:{selected:t.selectData.includes(e.id)},style:t.getStyle(e.style,t.getTdStyleByTdInfo(e),"table"),attrs:{rowspan:e.rowspan,colspan:e.colspan,"data-id":e.id},on:{mouseover:function(a){return a.stopPropagation(),t.postMethod("tdMouseover",{eleid:e.id,e:a})},mousedown:function(a){a.stopPropagation(),t.postMethod("tdMouserdown",{eleid:e.id,e:a}),t.postMethod("tdChangeMousedown",a)},mouseup:function(a){t.postMethod("tdMouseup",{eleid:e.id,e:a}),t.postMethod("tdChangeMouseup",a)},mousemove:function(e){return t.postMethod("tdChangeMousemove",e)}}},[e.dataid?a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.plugin.plugins[e.dataid]},on:{sendmessage:t.setPluginValue,ptablesendmessage:t.toTablesendmessage}}):t._e()],1)})),0)})),0)]),t._v(" "),a("div",{staticClass:"clear"})]):t._e()]:t._e()],2)},Nr=[],Rr=Object(s["b"])(s["a"],{name:"dTable",props:["rtsendmessage","rtupdateInfo","plugin","forminfo"],components:{rtallPlugin:ji},computed:{tableData:function(){return this.pluginData.attr.data.tableData},selectData:function(){return this.$store.state.form.selectData.tableid==this.tableData.id?this.$store.state.form.selectData.selectIds:[]}},methods:{getThStyle:function(t){var e=this.appCommonH.copyObj(this.tableData.trs[0].tds[0].style);for(var a in e)["borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth"].includes(a)&&delete e[a];return this.tableData.trs[0].isHide&&(e["borderColor"]="transparent"),e},setPluginValue:function(t){this.postMessage(t)},getStyle:function(t,e,a){return e=void 0===e?{}:e,"table"!=a||this.pluginData.status.formmodeedit||("dashed"==t.borderStyle&&(t.borderColor="transparent",!t.borderTopStyle&&t.borderTopColor&&(t.borderTopColor="transparent"),!t.borderBottomStyle&&t.borderBottomColor&&(t.borderBottomColor="transparent")),"dashed"==t.borderTopStyle&&(t.borderTopColor="transparent"),"dashed"==t.borderBottomStyle&&(t.borderBottomColor="transparent"),"dashed"==t.borderLeftStyle&&(t.borderLeftColor="transparent"),"dashed"==t.borderRightStyle&&(t.borderRightColor="transparent")),this.appCommonH.getStyle(t,e)},getTdStyleByTdInfo:function(t){return t.dataid?this.plugin.plugins[t.dataid].attr.style.tdStyle:{}},tableIsHide:function(){var t=!1;return this.tableData.trs.forEach((function(e){e.isHide||(t=!0)})),t},toTablesendmessage:function(t){this.$emit("ptablesendmessage",t)}},mounted:function(){}}),Br=Rr,Or=Object(d["a"])(Br,Pr,Nr,!1,null,null,null),Mr=Or.exports,Lr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"dplugin-layout":!0},style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.formmodeedit?a("i",{staticClass:"moveelement"}):t._e(),t._v(" "),t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-doneplugin dplugin-onecolumn",attrs:{"data-key":t.pluginData.key,"data-id":t.pluginData.tableId}},[a("div",{class:{selected:t.selectData.includes(t.pluginData.id)},style:Object.assign({},t.nowStyle,t.getTdStyleByTdInfo()),attrs:{"data-key":t.pluginData.key,"data-id":t.pluginData.id},on:{mousedown:function(e){e.stopPropagation(),t.postMethod("noTdMouserdown",{eleid:t.pluginData.id,e:e}),t.postMethod("tdChangeMousedown",e)},mouseup:function(e){return t.postMethod("tdChangeMouseup",e)},mousemove:function(e){return t.postMethod("tdChangeMousemove",e)}}},[t.pluginData.dataid?a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.plugin.plugins[t.pluginData.dataid]},on:{sendmessage:t.setPluginValue}}):[t._v("\n            一行一列布局\n          ")]],2)]):t._e()]:t._e()],2)},Ur=[],Fr=Object(s["b"])(s["a"],{name:"dOneColumn",props:["rtsendmessage","rtupdateInfo","plugin","forminfo"],components:{rtallPlugin:ji},computed:{nowStyle:function(){return{width:this.pluginData.attr.data.width+"px",borderWidth:"1px",borderStyle:"dashed",borderColor:this.pluginData.status.formmodeedit?"#BBBBBB":"transparent",boxSizing:"border-box",margin:"0 auto",marginLeft:this.pluginData.status.formmodeedit?"20px":"auto"}},selectData:function(){return this.$store.state.form.selectData.tableid==this.pluginData.tableId?this.$store.state.form.selectData.selectIds:[]}},methods:{setPluginValue:function(t){this.postMessage(t)},getTdStyleByTdInfo:function(t){return this.pluginData.dataid?this.plugin.plugins[this.pluginData.dataid].attr.style.tdStyle:{}}},mounted:function(){}}),$r=Fr,Hr=Object(d["a"])($r,Lr,Ur,!1,null,null,null),jr=Hr.exports,Wr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"dplugin-layout":!0},style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.formmodeedit?a("i",{staticClass:"moveelement"}):t._e(),t._v(" "),t.pluginData.status.isshow?[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-rtplugin"},[t.tableData.trs?a("table",{staticClass:"formtable clearfloat",style:t.appCommonH.getStyle(t.tableData.style,Object.assign({},{width:t.tableData.width+"px"},{marginLeft:t.pluginData.status.formmodeedit?"20px":"auto"})),attrs:{"data-id":t.tableData.id,"data-key":t.pluginData.key}},[a("thead",[a("tr",[t._l(t.tableData.tdModels,(function(e,n){return[n<t.tableData.tdModels.length-1?a("th",{staticClass:"table_th_border_width",style:t.appCommonH.getStyle(Object.assign({},e,{height:"20px",lineHeight:"20px",boxSizing:"border-box"},t.getThStyle))}):[t.pluginData.status.formmodeedit||t.pluginData.status.readonly||!t.getOperateWidth()?t._e():a("th",{staticClass:"table_th_border_width",style:t.appCommonH.getStyle(Object.assign({},e,{width:t.getOperateWidth(),height:"20px",lineHeight:"20px",boxSizing:"border-box"},t.getThStyle))})]]}))],2)]),t._v(" "),a("tbody",[t.pluginData.status.formmodeedit?t._l(t.tableData.trs,(function(e,n){return a("tr",{style:t.appCommonH.getStyle(e.style),attrs:{"data-id":e.id}},t._l(e.tds,(function(n,i){return i<e.tds.length-1?a("td",{class:t.isSelect(n.id),style:t.appCommonH.getStyle(n.style),attrs:{"data-id":n.id},on:{mousedown:function(e){e.stopPropagation(),t.postMethod("tdMouserdown",{eleid:n.id,e:e}),t.postMethod("tdChangeMousedown",e)},mouseup:function(e){return t.postMethod("tdChangeMouseup",e)},mousemove:function(e){return t.postMethod("tdChangeMousemove",e)}}},[n.dataid?a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.plugins[n.dataid]},on:{sendmessage:t.setPluginValue,ptablesendmessage:t.toTablesendmessage}}):t._e()],1):t._e()})),0)})):[t.isShowSetRow()?a("tr",[a("td",{style:t.appCommonH.getStyle(t.tableData.trs[0].tds[0].style,{textAlign:"right"}),attrs:{colspan:t.getShowSetRowNum}},[t.isShowPage?a("div",{staticStyle:{display:"inline-block",float:"left",height:"30px",overflow:"hidden"}},[a("span",[t._v("搜索列:")]),t._v(" "),a("div",{staticStyle:{display:"inline-block",width:"150px"}},[a("el-select",{attrs:{size:"mini",placeholder:"请选择搜索列"},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}},t._l(t.tableData.trs[1].tds,(function(e,n){return e.dataid&&t.plugins[e.dataid]?a("el-option",{key:t.plugins[e.dataid].key,attrs:{label:t.plugins[e.dataid].description,value:t.plugins[e.dataid].key}}):t._e()})),1)],1),t._v("\n\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t"),a("span",[t._v("关键词:")]),t._v(" "),a("div",{staticStyle:{display:"inline-block",width:"150px"}},[a("el-input",{attrs:{size:"mini",placeholder:"请输入搜索关键词",clearable:!0,disabled:!t.searchKey},on:{input:t.searchWordChange,clear:t.resetSearch},model:{value:t.keyword,callback:function(e){t.keyword="string"===typeof e?e.trim():e},expression:"keyword"}})],1)]):t._e(),t._v(" "),t.pluginData.status.readonly?t.pluginData.status.readonly&&t.pluginData.status.issave?[t.pluginData.attr.setInfo.buttons.import?a("el-button",{attrs:{id:"import"+t.pluginData.key,size:"mini",type:"primary",plain:""}},[t._v("\n\t\t\t\t\t\t\t\t\t\t导入\n\t\t\t\t\t\t\t\t\t")]):t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t导出\n\t\t\t\t\t\t\t\t\t")]):t._e()]:t.pluginData.status.readonly&&t.authH.queryControl("AppManage.archive")?[t.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t导出\n\t\t\t\t\t\t\t\t\t")]):t._e()]:t._e():[t.pluginData.attr.setInfo.buttons.import?a("el-button",{attrs:{id:"import"+t.pluginData.key,size:"mini",type:"primary",plain:""}},[t._v("\n\t\t\t\t\t\t\t\t\t\t导入\n\t\t\t\t\t\t\t\t\t")]):t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t导出\n\t\t\t\t\t\t\t\t\t")]):t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.refresh?a("el-button",{attrs:{title:"重新同步该表数据",size:"mini",type:"primary"},on:{click:t.refreshData}},[t._v("\n\t\t\t\t\t\t\t\t\t\t同步\n\t\t\t\t\t\t\t\t\t")]):t._e(),t._v(" "),t.isShowAddButton(t.showAllData.length-1)?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.addRow(t.showAllData.length-1)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t添加行\n\t\t\t\t\t\t\t\t\t")]):t._e()]],2)]):a("tr"),t._v(" "),a("tr",{style:t.appCommonH.getStyle(t.tableData.trs[0].style),attrs:{"data-trindex":0,"data-id":t.tableData.trs[0].id}},[t._l(t.tableData.trs[0].tds,(function(e,n){return[n<t.tableData.trs[0].tds.length-1?a("td",{style:t.appCommonH.getStyle(e.style),attrs:{"data-id":e.id}},[e.dataid?a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.plugins[e.dataid]},on:{sendmessage:t.setPluginValue,ptablesendmessage:t.toTablesendmessage}}):t._e()],1):!t.pluginData.status.readonly&&t.getOperateWidth()?a("td",{style:t.appCommonH.getStyle(e.style,{textAlign:"center"}),attrs:{"data-id":e.id}},[a("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t操作\n\t\t\t\t\t\t\t\t\t")])]):t._e()]}))],2),t._v(" "),t._l(t.showAllData,(function(e,n){return t.showAllData.length?[a("tr",{style:t.appCommonH.getStyle(t.tableData.trs[1].style),attrs:{"data-trindex":n+1}},[t._l(t.tableData.trs[1].tds,(function(e,i){return i<t.tableData.trs[1].tds.length-1?a("td",{style:t.appCommonH.getStyle(t.tableData.trs[1].tds[t.getColNum(i)].style),attrs:{"data-id":e.id}},[t.rtplugins[n]&&t.rtplugins[n][e.dataid]?a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.rtplugins[n][e.dataid]},on:{sendmessage:t.setPluginValue,ptablesendmessage:t.toTablesendmessage}}):t._e()],1):t._e()})),t._v(" "),!t.pluginData.status.readonly&&t.getOperateWidth()?a("td",{style:t.appCommonH.getStyle(t.tableData.trs[1].tds[0].style,{textAlign:"center"})},[t.pluginData.attr.setInfo.buttons.del?a("span",{staticClass:"rtps minus",on:{click:function(e){return t.removeRow(n)}}},[a("i",{staticClass:"iconfont iconshanchu",attrs:{title:"删除","aria-hidden":"true"}})]):t._e(),t._v(" "),t.isShowAddButton(n)?a("span",{staticClass:"rtps plus",on:{click:function(e){return t.addRow(n)}}},[a("i",{staticClass:"iconfont icon-tianjia",attrs:{title:"添加","aria-hidden":"true"}})]):t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.sort&&!t.pageSearch?[a("span",{staticClass:"rtps plus",on:{click:function(e){return t.toSort(n,!0)}}},[a("i",{staticClass:"iconfont icon-shangyimian",attrs:{title:"上升"}})]),t._v(" "),a("span",{staticClass:"rtps plus",on:{click:function(e){return t.toSort(n,!1)}}},[a("i",{staticClass:"iconfont icon-xiayimian",attrs:{title:"下降"}})])]:t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.copy&&!t.pageSearch?[a("span",{staticClass:"rtps plus",on:{click:function(e){return t.copy(++n)}}},[a("i",{staticClass:"fa fa-files-o",attrs:{title:"复制","aria-hidden":"true"}})])]:t._e()],2):t._e()],2)]:t._e()})),t._v(" "),t.showAllData.length?t._e():[a("tr",{style:t.appCommonH.getStyle(t.tableData.trs[1].style)},[a("td",{style:t.appCommonH.getStyle(t.tableData.trs[0].tds[0].style,{textAlign:"center"}),attrs:{colspan:t.getShowSetRowNum}},[t._v("\n\t\t\t\t\t\t\t\t\t\t暂无"+t._s(t.pluginData.description)+"数据\n\t\t\t\t\t\t\t\t\t")])])],t._v(" "),t.isShowPage?a("tr",[a("td",{style:t.appCommonH.getStyle(t.tableData.trs[0].tds[0].style,{textAlign:"right"}),attrs:{colspan:t.getShowSetRowNum}},[a("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper","page-size":t.nowPageSize,"page-count":t.allPageNum,"pager-count":7,"current-page":t.currentPage,total:t.total},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.pageChange}})],1)]):t._e()]],2)]):t._e()]):a("div",{staticClass:"dplugin-mobile dplugin-rtplugin dplugin-mobile-repeattable"},[t._l(t.pluginData.data,(function(e,n){return t.tableData.trs?a("div",{staticClass:"tablerow"},[t._l(t.tableData.trs[1].tds,(function(e,i){return t.rtplugins[n]&&t.rtplugins[n][e.dataid]?a("div",{staticClass:"tableclo"},[a("span",{staticClass:"rpluginname",class:{nacta_color:t.mixNewRetableColor}},[t._v(t._s(t.mobileGetNameByKey(e.dataid)))]),t._v(" "),!t.rtplugins[n][e.dataid].status.readonly&&t.allplugin.rtplugins[e.dataid].alertFoucsMsg?a("div",{staticClass:"dplugin-mobile-zhuyi dplugin-mobile-zhuyi-r"},[a("i",{staticClass:"icon iconfont iconzhuyi1"}),t._v(" "),a("span",{domProps:{innerHTML:t._s(t.allplugin.rtplugins[e.dataid].alertFoucsMsg)}})]):t._e(),t._v(" "),a("div",{staticClass:"rpluginbox"},[a("rtallPlugin",{attrs:{plugin:t.plugin,forminfo:t.forminfo,watchmessage:t.rtplugins[n][e.dataid]},on:{sendmessage:t.setPluginValue,ptablesendmessage:t.toTablesendmessage}})],1)]):t._e()})),t._v(" "),!t.pluginData.status.readonly&&t.pluginData.attr.setInfo.buttons.del?a("div",{staticClass:"close",on:{click:function(e){return t.removeRow(n)}}}):t._e()],2):t._e()})),t._v(" "),!t.pluginData.status.readonly&&t.pluginData.attr.setInfo.buttons.add?a("span",{staticClass:"addrow",on:{click:function(e){return t.addRow(t.pluginData.data.length-1)}}},[a("i",{staticClass:"icon iconfont iconaddTodo-nav"}),t._v(" \n\t\t\t\t\t"+t._s(this.pluginData.attr.setInfo.m_addContent?this.pluginData.attr.setInfo.m_addContent:"添加重复表")+"\n\t\t\t\t")]):t._e(),t._v(" "),t.isShowSetRow()&&!t.pluginData.status.formmodeedit?a("div",{staticClass:"setbutton"},[t.pluginData.status.readonly?t.pluginData.status.readonly&&t.pluginData.status.issave?[t.pluginData.attr.setInfo.buttons.import?a("el-button",{attrs:{id:"import"+t.pluginData.key,size:"mini",type:"primary",plain:""}},[t._v("\n\t\t\t\t\t\t\t导入\n\t\t\t\t\t\t")]):t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t\t导出\n\t\t\t\t\t\t")]):t._e()]:t.pluginData.status.readonly&&t.authH.queryControl("AppManage.archive")?[t.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t\t导出\n\t\t\t\t\t\t")]):t._e()]:t._e():[t.pluginData.attr.setInfo.buttons.import?a("el-button",{attrs:{id:"import"+t.pluginData.key,size:"mini",type:"primary",plain:""}},[t._v("\n\t\t\t\t\t\t\t导入\n\t\t\t\t\t\t")]):t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.export?a("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.exportss()}}},[t._v("\n\t\t\t\t\t\t\t导出\n\t\t\t\t\t\t")]):t._e(),t._v(" "),t.pluginData.attr.setInfo.buttons.refresh?a("el-button",{attrs:{title:"重新同步该表数据",size:"mini",type:"warning"},on:{click:t.refreshData}},[t._v("\n\t\t\t\t\t\t\t同步\n\t\t\t\t\t\t")]):t._e()]],2):t._e()],2)]:t._e()],2)},zr=[],Vr={initPage:function(t,e){if(!this.isShowPage||!this.pluginData.status.ispc)return!1;t=t||1,this.total=this.getNowSearchData().length,this.allPageNum=Math.ceil(this.total/this.nowPageSize),t=t>this.allPageNum?this.allPageNum:t,e&&(t=this.allPageNum),this.setCurrentPage(t)},setCurrentPage:function(t){var e=this;this.currentPage=t;var a=(this.currentPage-1)*this.nowPageSize+0,n=a+this.nowPageSize,i=[],r=this;this.currentData=this.appCommonH.copyObj(this.getNowSearchData().slice(a,n)),this.currentData.forEach((function(t,e){var n={},s=0;for(var o in t)if(r.plugins[o]){t["oldIndex"]?s=t["oldIndex"]:(s=a+e,t["oldIndex"]=s);var l=Math.random(),u=r.addPlugin(o,l);u.data=t[o],u.rowCol={rownum:s,colnum:o},n[o]=u}i.push(n)})),this.rtplugins=[],this.$nextTick((function(){e.rtplugins=i,e.shouInsexList()}))},getNowSearchData:function(){return this.pageSearch?this.searchData:this.pluginData.data},pageChange:function(){this.setCurrentPage(this.currentPage)},getRealRow:function(t){if(this.isShowPage){var e=(this.currentPage-1)*this.nowPageSize+t;return this.pageSearch?this.searchData[e]?this.searchData[e].oldIndex:0:e}return t},resetSearch:function(){this.keyword="",this.searchData=[],this.pageSearch=!1,this.initPage()},searchChange:function(t){var e=this;if(t=t||0,this.searchKey)if(this.keyword){var a=[];this.pluginData.data.forEach((function(t,n){var i=t[e.searchKey];i&&e.searchDataDo(i,e.keyword)&&(t=e.appCommonH.copyObj(t),t.oldIndex=n,a.push(t))})),this.searchData=a,this.pageSearch=!0,this.initPage(t)}else this.resetSearch();else this.resetSearch()},searchDataDo:function(t,e){if(t instanceof Object){var a=!1;for(var n in t)t[n]&&-1!==t[n].toString().indexOf(e)&&(a=!0);return a}return-1!==t.indexOf(e)},searchWordChange:function(){this.searchChange()}},qr=a("35f4e"),Gr=a.n(qr),Kr={name:"dRepeatTable",mixins:[Ia["a"],Pa["a"]],data:{plugins:{},rtplugins:[],importUpload:!1,total:0,allPageNum:0,currentPage:0,currentData:[],searchKey:"",keyword:"",pageSearch:!1,searchData:[]},props:["rtsendmessage","rtupdateInfo","plugin","forminfo","ptablesendmessage"],components:{rtallPlugin:ji},computed:{tableData:function(){return this.pluginData.attr.data.tableData},selectData:function(){return this.$store.state.form.selectData.tableid==this.tableData.id?this.$store.state.form.selectData.selectIds:[]},getThStyle:function(){var t=this.appCommonH.copyObj(this.tableData.trs[0].tds[0].style);for(var e in t)["borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth"].includes(e)&&delete t[e];return t},maxline:function(){return!isNaN(this.pluginData.attr.setInfo.maxline)&&Math.ceil(this.pluginData.attr.setInfo.maxline)>0?Math.ceil(this.pluginData.attr.setInfo.maxline):999999},minline:function(){return!isNaN(this.pluginData.attr.setInfo.minline)&&Math.ceil(this.pluginData.attr.setInfo.minline)>0?this.pluginData.attr.setInfo.minline:0},getShowSetRowNum:function(){var t=!this.pluginData.status.formmodeedit&&!this.pluginData.status.readonly&&this.getOperateWidth();return this.tableData.trs[0].tds.length-(t?0:1)},nowPageSize:function(){return this.pluginData.attr.setInfo.pageSize?+this.pluginData.attr.setInfo.pageSize:0},isShowPage:function(){return!this.forminfo.isPrintMode&&this.nowPageSize&&this.pluginData.status.ispc&&this.pluginData.data.length/this.nowPageSize>1},showAllData:function(){return this.isShowPage?this.currentData:this.pluginData.data},pluginShow:function(){return this.pluginData.status.isshow},sortInfo:function(){return this.$store.state.form.setSortInfo[this.forminfo.formId]?this.$store.state.form.setSortInfo[this.forminfo.formId]:{}}},watch:{pluginData:function(t){var e=this;this.updateData(t),setTimeout((function(){e.shouInsexList()}),500)},plugin:function(){this.updateData()},rtupdateInfo:function(t){t.method&&this[t.method]&&this[t.method](t),this.changeBorderCollapse()},showAllData:function(t){if(this.nowPageSize&&t[0]&&t[0].id){var e=[];t.forEach((function(t){e.push(t.id)})),this.RETABLE_IDS({fid:this.forminfo.formId,key:this.pluginData.key,params:e})}},pluginShow:function(t){var e=this;t&&(this.hasInitUpload=!1,setTimeout((function(){e.initImportUpload()}),0))},"pluginData.key":function(){this.resetInit()},sortInfo:function(t){t[this.pluginData.key]&&this.tallSortData(t[this.pluginData.key])}},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(o["c"])("form",["REFRESH_RTABLE","RETABLE_IDS"])),Vr),{},{tallSortData:function(t){var e=0,a="",n=JSON.parse(JSON.stringify(this.pluginData.data));this.pluginData.data=[],this.tableData.trs[0].tds.forEach((function(a,n){a.dataid==t.plugin_key&&(e=n)})),this.tableData.trs[1].tds.forEach((function(t,n){n==e&&(a=t.dataid)})),1==t.type?n.sort((function(t,e){return Number(e[a])-Number(t[a])})):n.sort((function(t,e){return Number(t[a])-Number(e[a])})),this.pluginData.data=n,this.updateData(this.pluginData),this.init()},update:function(){this.pluginData.status.modeedit||this.postMessage(this.pluginData)},toTablesendmessage:function(t){this.$emit("ptablesendmessage",t)},init:function(){if(!this.pluginData||this.pluginData.status.formmodeedit)return!1;if(this.pluginData.data.length){var t=this;this.pluginData.data.forEach((function(e,a){t.addRowPlugin(a,e)})),t.changeBorderCollapse()}else this.pluginData.attr.setInfo.initAddOne&&this.addRow(-1);this.initMinLine(),this.initImportUpload(),this.initPage(),this.shouInsexList()},initMinLine:function(){if(!this.minline||this.pluginData.data.length>=this.minline)return!1;for(var t=this.pluginData.data.length;t<this.minline;t++)this.addRow(t-1)},initImportUpload:function(){if(this.pluginData.status.readonly||!this.pluginData.attr.setInfo.buttons.import||this.hasInitUpload)return!1;var t=this;this.hasInitUpload=!0,this.importUpload=new zi.a({upload_url:we["a"].getApi("uploadindex"),file_post_name:"upfile",post_params:{category:"all"},file_types:["xls","xlsx"],file_size_limit:"100M",auto_upload:!0,button_placeholder_id:"import"+this.pluginData.key,msg:{"-110":"文件大小不能超过100","-130":"文件类型错误，请上传execl文档","-140":"文件上传失败，请重试！","-150":"没有选择可上传文件"},file_queue_error_handler:function(e){t.$message({type:"error",message:e})},upload_error_handler:function(){t.$message({type:"error",message:"文件上传失败，请重试！"})},upload_success_handler:function(e,a){"SUCCESS"==a.state?t.getDataByExeclPath(a.url):t.$message({type:"error",message:a.state})}})},getDataByExeclPath:function(t){var e=this;this.appFetch({url:"getDataByExeclPath",method:"GET",data:{path:t}},(function(t){0==t.e?e.dataToRepeatTable(t.d):e.$message({type:"error",message:"解析上传数据失败"})}),(function(){e.$message({type:"error",message:"解析上传数据失败"})}))},doImportDateTime:function(t){return isNaN(t)&&(t=t.replace(/\$/g,"")),t},dataToRepeatTable:function(t){var e=[],a=this.pluginData.attr.setInfo.importBind,n=this;if(t.forEach((function(t){var i=n.getDataModel();for(var r in i)a[r]&&t[a[r]]&&(-1!==r.indexOf("Calendar")&&(t[a[r]]=n.doImportDateTime(t[a[r]])),i[r]=t[a[r]]);e.push(i)})),!e.length)return!1;if(1!=this.pluginData.data.length||this.checkRowData(0)||this.removeRowPlugin(0,!0),1==this.pluginData.attr.setInfo.importType&&(this.pluginData.data=[]),2==this.pluginData.attr.setInfo.importType){var i=JSON.parse(JSON.stringify(t)),r=this.pluginData.attr.setInfo.lock,s="",o=JSON.parse(JSON.stringify(this.pluginData.data));this.pluginData.data=[];var l=[];for(var u in a)a[u]==r&&(s=u);i.forEach((function(t){var e={};for(var n in t)for(var i in a)a[i]==n&&(e[i]=t[n]);l.push(e)})),l.forEach((function(t,e){o.forEach((function(e,a){t[s]==e[s]&&(e=Object.assign(e,t))}))})),e=o}var d=this.pluginData.data.length;e.forEach((function(t,e){n.addRowPlugin(d+e,t)})),this.changeBorderCollapse(),this.initPage(),this.shouInsexList()},checkRowData:function(t){var e=this.pluginData.data[t];for(var a in e)if(qi["a"].checkValue(this.rtplugins[t][a]))return!0;return!1},getDataModel:function(){var t={},e=this;return this.tableData.trs[1].tds.forEach((function(a,n){a.dataid&&(t[a.dataid]=e.plugins[a.dataid].data)})),t},isShowSetRow:function(){if(!this.pluginData.attr.setInfo)return!1;var t=this.pluginData.attr.setInfo.buttons,e=!this.pluginData.status.readonly,a=this.pluginData.status.readonly&&this.pluginData.status.issave,n=this.pluginData.status.readonly&&this.authH.queryControl("AppManage.archive")&&"archive"==this.$route.query.source;return e&&(t.import||t.refresh||t.export||t.add)||a&&(t.import||t.export)||n&&t.export||e&&this.nowPageSize},resetInit:function(t){t&&t.key&&t.key!=this.pluginData.key||(this.rtplugins=[],this.init())},addRowData:function(t){if(!t||!t.key||t.key==this.pluginData.key){1!=this.pluginData.data.length||this.checkRowData(0)||this.removeRowPlugin(0,!0);var e=this.pluginData.data.length,a=this;t.data.data.forEach((function(t,n){a.addRowPlugin(e+n,t)})),this.initPage(this.currentPage,!0),this.changeBorderCollapse()}},setCPlugin:function(t){if(!t||!t.key||t.key==this.pluginData.key){var e=this.getRowNumByRowId(t.data.rownum);if(!1===e)return!1;var a=this.rtplugins[e][t.data.ckey];if(1==t.data.targetColumn)a.data=this.appCommonH.copyObj(t.data.data),a=Vi["a"].setComPluginData(a),this.setPluginValue(a);else{a.attr.data.options=this.appCommonH.copyObj(t.data.data);var n=[];if("dCheckbox"==a.type){var i=a.attr.data.options.map((function(t){return t.value}));n=a.data.filter((function(t){return i.includes(t.value)}))}else n=a.attr.data.options.filter((function(t){return t.value==a.data.value&&t.name==a.data.name}));n.length||(a.data=this.appCommonH.copyObj(a.initdata),this.setPluginValue(a))}}},getRowNumByRowId:function(t){var e=!1;return isNaN(t)?this.showAllData.forEach((function(a,n){a.id==t&&(e=n)})):e=t,e},setAlertPlugin:function(t){if(!t||!t.key||t.key==this.pluginData.key){var e=this.rtplugins[t.data.rownum][t.data.ckey];e.alertFoucsMsg=t.data.msg}},showRequired:function(t){if(!t&&t.data[this.pluginData.key]){var e=t.data[this.pluginData.key],a=this;e.forEach((function(t){var e=a.rtplugins[t.row][t.key];e=this.appCommonH.copyObj(e),e.status.warning=!0,a.$set(a.rtplugins[t.row],t.key,e)}))}},addKeyToRow:function(t){return this.nowPageSize&&(t.id=ot()(Math.random().toString())),t},addRowPlugin:function(t,e,a){if(this.maxline&&this.rtplugins.length>=this.maxline)return this.$message.warning({message:"不可超过"+this.maxline+"行",showClose:!0}),!1;e=void 0!==e?e:{};var n=this;if(this.isShowPage){var i={};this.tableData.trs[1].tds.forEach((function(t,a){if(t.dataid)if(Vi["a"].isSpecialPlugin("d"+t.dataid)){var r=Math.random(),s=n.addPlugin(t.dataid,r);s.data=void 0!==e[t.dataid]?e[t.dataid]:s.data,s=Vi["a"].setComPluginData(s),i[t.dataid]=n.appCommonH.copyObj(s.data)}else{s=n.plugins[t.dataid]?n.plugins[t.dataid]:{data:""};var o=void 0!==e[t.dataid]?e[t.dataid]:s.data;i[t.dataid]=n.appCommonH.copyObj(o)}})),i=this.addKeyToRow(i),a&&this.pluginData.data.splice(t,0,i),this.$set(this.pluginData.data,t,i)}else{var r={};i={};this.tableData.trs[1].tds.forEach((function(t,a){if(t.dataid){var s=Math.random(),o=n.addPlugin(t.dataid,s);o.data=void 0!==e[t.dataid]?e[t.dataid]:o.data,o=Vi["a"].setComPluginData(o),r[t.dataid]=o,i[t.dataid]=o.data}})),a&&(this.rtplugins.splice(t,0,r),this.pluginData.data.splice(t,0,i)),i=this.addKeyToRow(i),this.$set(this.rtplugins,t,r),this.$set(this.pluginData.data,t,i)}this.update()},addPlugin:function(t,e){var a=this.appCommonH.copyObj(this.plugins[t]);return a.model=t,a.key=e,a},addData:function(t,e,a){var n=this.appCommonH.copyObj(this.pluginData.data);n[e]=n[e]?n[e]:{},n[e][this.getColName(a)]=t,this.pluginData.data=n},getColName:function(t){var e="";return this.tableData.trs[1].tds.forEach((function(a,n){t==n&&(e=a.dataid)})),e},getColNum:function(t){var e=0;return this.tableData.trs[1].tds.forEach((function(a,n){t==a.dataid&&(e=n)})),e},removeRowPlugin:function(t,e){this.isShowPage?this.$delete(this.pluginData.data,this.getRealRow(t)):(this.$delete(this.pluginData.data,t),this.$delete(this.rtplugins,t)),e||this.update()},removeRow:function(t){var e=this;if(this.minline&&this.pluginData.data.length<=this.minline)return this.$message.warning({message:"不可少于"+this.minline+"行",showClose:!0}),!1;this.$MessageBox.confirm("确定删除此条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,modal:!1,center:!0,customClass:"backMessageBoxClass"}).then((function(){e.pluginData.data.length>1?(e.removeRowPlugin(t),e.changeBorderCollapse()):(e.removeRowPlugin(t),e.$nextTick((function(){this.pluginData.attr.setInfo.initAddOne&&this.addRow(-1)}))),e.pageSearch?e.searchChange(e.currentPage):e.initPage(e.currentPage),e.isShowPage||e.pluginData.data.length===e.rtplugins.length||e.init(),e.$message.success({message:"已删除",showClose:!0})})).catch((function(){e.$message.info({message:"已取消",showClose:!0})}))},addRow:function(t){this.addRowPlugin(this.getRealRow(t)+1),this.initPage(this.currentPage,!0),this.changeBorderCollapse()},updateSelectData:function(t){var e=[],a=this;t.data.forEach((function(t){t.key==a.pluginData.key&&e.push(t.id)})),this.selectData.selectIds=e},updateData:function(t){t&&this.updateClassData(t),this.plugins=this.plugin.rtplugins,this.changeBorderCollapse()},rtPostMessage:function(t){t.key=this.pluginData.key,this.$emit("rtsendmessage",t)},isSelect:function(t){return this.selectData.includes(t)?"selected":""},changeBorderCollapse:function(t){$('[data-id="'+t+'"]').css({borderSpacing:"1px"}),setTimeout((function(){$('[data-id="'+t+'"]').css({borderSpacing:"0px"})}),50)},getRowColNum:function(t){var e={};return this.isShowPage&&t.rowCol?t.rowCol:(this.rtplugins.forEach((function(a,n){for(var i in a)a[i].key==t.key&&(e={rownum:n,colnum:i})})),e)},mobileGetNameByKey:function(t){var e=this,a="",n=-1;return this.tableData.trs?(this.tableData.trs[1].tds.forEach((function(e,a){e.dataid==t&&(n=a)})),this.tableData.trs[0].tds.forEach((function(t,i){i==n&&e.plugins[t.dataid]&&(a=e.plugins[t.dataid].data)})),a):""},setPluginValue:function(t){if(this.pluginData.status.formmodeedit)return!1;var e=this.getRowColNum(t);if(void 0===e.colnum)return!1;this.pluginData.data[e.rownum][e.colnum]=t.data,this.postMessage(this.pluginData)},getOperateWidth:function(){return this.pluginData.attr.setInfo.depriveObj?this.getOperateWidthNew():this.getOperateWidthOld()},getOperateWidthOld:function(){if(!this.pluginData.status.formmodeedit&&this.pluginData.status.readonly&&this.pluginData.status.issave){var t=0;return t=this.pluginData.attr.setInfo.buttons.sort?t=40:t,t}if(this.pluginData.attr.setInfo){t=0;return t=this.pluginData.attr.setInfo.buttons.sort?t+25:t,t=this.pluginData.attr.setInfo.buttons.add?t+5:t,t=this.pluginData.attr.setInfo.buttons.del?t+15:t,t=this.pluginData.attr.setInfo.buttons.copy?t+15:t,t?t+10:t}return 30},getOperateWidthNew:function(){var t=0;return this.pluginData.status.formmodeedit||(this.pluginData.status.readonly?this.pluginData.status.issave&&this.pluginData.attr.setInfo.buttons.sort&&(t=18):(t+=this.pluginData.attr.setInfo.buttons.sort?36:0,t+=this.pluginData.attr.setInfo.buttons.add?18:0,t+=this.pluginData.attr.setInfo.buttons.del?18:0,t+=this.pluginData.attr.setInfo.buttons.copy?18:0),t+=t?10:0),t},toSort:function(t,e){this.rtplugins.length;var a=e?t-1:t+1;if(!this.rtplugins[a])return!1;this.rtplugins=this.appCommonH.swapArray(this.rtplugins,t,a),this.pluginData.data=this.appCommonH.swapArray(this.pluginData.data,this.getRealRow(t),this.getRealRow(a)),this.initPage(this.currentPage),this.$nextTick((function(){this.postMessage(this.pluginData)}))},depriveWidth:function(){var t=this.getOperateWidth();if(!t||!this.pluginData.attr.setInfo.depriveObj)return!1;var e=this.pluginData.attr.setInfo.depriveObj.length?this.pluginData.attr.setInfo.depriveObj:this.tableData.tdModels.slice(0,-1),a=t%e.length,n=(t-a)/e.length,i={},r=this;e.forEach((function(t,e){t.width||(e=r.getColNum(t)),a>0?(i[e]=n+1,a-=1):i[e]=n})),this.tableData.tdModels.forEach((function(t,e){t.width=t.width-(i[e]?i[e]:0)}))},refreshData:function(){this.REFRESH_RTABLE({fid:this.forminfo.formId,params:{key:this.pluginData.key,modelType:!!this.pluginData.attr.setInfo.refreshType,type:"refresh"}})},exportss:function(){for(var t=this,e=[],a=[],n=[],i=[],r=0;r<this.tableData.trs[1].tds.length;r++)this.tableData.trs[1].tds[r].dataid&&i.push(this.tableData.trs[1].tds[r].dataid),this.tableData.trs[0].tds[r].dataid&&a.push(this.plugin.rtplugins[this.tableData.trs[0].tds[r].dataid].data);e.push(a),this.pluginData.data.forEach((function(a){for(var r=[],s=0;s<i.length;s++)if(["Calendar"].includes(t.rtplugins[0][i[s]].columnType)){var o=Gr()(a[i[s]]).format("YYYY/MM/DD");r.push(o)}else if(["Input","Numeric","Numeric","MultiInput","User","Link","Avatar","Binding","Passwd"].includes(t.rtplugins[0][i[s]].columnType))r.push(a[i[s]]);else if(["Select","Radio","Country","UserSearch"].includes(t.rtplugins[0][i[s]].columnType))r.push(a[i[s]].name);else if(["Checkbox","Multiple","Depart"].includes(t.rtplugins[0][i[s]].columnType)){for(var l="",u=0;u<a[i[s]].length;u++)l+=0==u?a[i[s]][u].name:","+a[i[s]][u].name;r.push(l)}else["Opinion"].includes(t.rtplugins[0][i[s]].columnType)?r.push(a[i[s]].option):["Ximage"].includes(t.rtplugins[0][i[s]].columnType)?(a[i[s]].map((function(t){return n.push(t)})),r.push(a[i[s]])):["File"].includes(t.rtplugins[0][i[s]].columnType)?(a[i[s]].map((function(t){return n.push(t.url)})),r.push(a[i[s]])):["Image"].includes(t.rtplugins[0][i[s]].columnType)?(n.push(a[i[s]]),r.push(a[i[s]])):r.push(a[i[s]]);e.push(r)})),this.appFetch({url:"repeatFile",method:"post",data:{files:n}},(function(t){t.e||(window.location.href=JSON.parse(window.sessionStorage.officeDb_getSiteConfig).imghost+"/"+t.d)}),(function(){}));var s=Ki.a.utils.aoa_to_sheet(e);this.openDownloadDialog(this.sheet2blob(s),window.tablevm.formName+".xlsx")},shouInsexList:function(){var t=this;this.pluginData.attr.setInfo.showIndex&&""!=this.pluginData.attr.setInfo&&setTimeout((function(){for(var e=t.isShowPage?t.currentData:t.pluginData.data,a=0;a<e.length;a++){var n=t.isShowPage?e[a].oldIndex+1:a+1;t.$set(e[a],t.pluginData.attr.setInfo.indexAssembly,n),t.rtplugins[a][t.pluginData.attr.setInfo.indexAssembly]&&t.$set(t.rtplugins[a][t.pluginData.attr.setInfo.indexAssembly],"data",n)}}),0)},sheet2blob:function(t,e){e=e||"sheet1";var a={SheetNames:[e],Sheets:{}};a.Sheets[e]=t;var n={bookType:"xlsx",bookSST:!1,type:"binary"},i=Ki.a.write(a,n),r=new Blob([s(i)],{type:"application/octet-stream"});function s(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!=t.length;++n)a[n]=255&t.charCodeAt(n);return e}return r},openDownloadDialog:function(t,e){"object"==Object(St["a"])(t)&&t instanceof Blob&&(t=URL.createObjectURL(t));var a,n=document.createElement("a");n.href=t,n.download=e||"",window.MouseEvent?a=new MouseEvent("click"):(a=document.createEvent("MouseEvents"),a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null)),n.dispatchEvent(a)},copy:function(t){var e=this.getRealRow(t-1),a=!!this.pluginData.data[e]&&this.pluginData.data[e];a&&(a=this.appCommonH.copyObj(a),this.addRowPlugin(e+1,a,!0),this.initPage(this.currentPage))},isShowAddButton:function(t){if(!this.pluginData.attr.setInfo.buttons.add||this.pluginData.status.readonly)return!1;if(this.isShowPage){var e=(this.currentPage-1)*this.nowPageSize+t;return!this.pageSearch&&e==this.pluginData.data.length-1}return t==this.pluginData.data.length-1}}),created:function(){this.depriveWidth()},mounted:function(){var t=this;this.updateData(this.pluginData),this.init(),this.pluginData.attr.setInfo.depriveObj.filter((function(e){if(!Object.keys(t.pluginData.attr.setInfo.importBind).includes(e)){var a=t.pluginData.attr.setInfo.depriveObj.indexOf(e);t.pluginData.attr.setInfo.depriveObj.splice(a,1)}})),window.retable=this}},Xr=Object(s["b"])(s["a"],Kr),Yr=Xr,Jr=Yr,Zr=(a("ec74"),Object(d["a"])(Jr,Wr,zr,!1,null,null,null)),Qr=Zr.exports,ts=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"dplugin-layout":!0},style:t.appCommonH.getStyle(Object.assign({},t.getLayoutStyle(),t.borderStyle)),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.formmodeedit?[a("i",{staticClass:"moveelement",style:t.leftIcon}),t._v(" "),a("i",{staticClass:"fa fa-scissors",style:t.iconStyle,on:{click:t.deletePlugin}})]:t._e(),t._v(" "),[a("div",{staticClass:"page-break-after-box"}),t._v(" "),a("div",{style:t.pageBreak}),t._v(" "),a("div",{staticClass:"page-break-after-box"}),t._v(" "),t._m(0)]],2)},es=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-break-after-box",staticStyle:{height:"20px"}},[a("table",[a("thead",[a("tr",[a("th",{staticStyle:{width:"2px",height:"10px","border-color":"0px"}})])]),t._v(" "),a("tbody")])])}],as=Object(s["b"])(s["a"],{name:"dPageSplit",data:{iconStyle:{position:"absolute",zIndex:100,top:"-10px",fontSize:"16px",color:"#0188fb",right:"0px",cursor:"pointer"},leftIcon:{left:"0px",marginLeft:"0px"},pageBreak:{pageBreakAfter:"always"}},props:["rtsendmessage"],computed:{borderStyle:function(){return{borderTop:"1px dashed "+(this.pluginData.status.formmodeedit?"#0188fb":"transparent")}}},methods:{deletePlugin:function(){this.$emit("rtsendmessage",{method:"delPageSplit",data:{key:this.pluginData.key}})}}}),ns=as,is=Object(d["a"])(ns,ts,es,!1,null,null,null),rs=is.exports,ss=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.boxClass,style:t.appCommonH.getStyle(t.getLayoutStyle()),attrs:{"data-key":t.pluginData.key}},[t.pluginData.status.ispc?a("div",{staticClass:"dplugin-pc dplugin-showhide",style:t.appCommonH.getStyle(t.getTextStyle())},[t._v("\n\t\t"+t._s(t.pluginData.description)+"\n\t")]):t._e()])},os=[];Za.a.config({number:"BigNumber",precision:20});var ls=Object(s["b"])(s["a"],{name:"dConversion",props:["plugin"],data:{lastData:"",lastAllData:""},watch:{pluginData:function(t){this.updateData(t)},allplugin:function(){this.updateData(this.pluginData)}},methods:{updateData:function(t){this.updateClassData(t),this.countResult()},countResult:function(){if(this.pluginData.status.formmodeedit||!this.pluginData.status.isshow||this.pluginData.status.readonly)return!1;var t=this.getKeyVal(),e=JSON.stringify(t);if(this.lastAllData==e)return!1;if(this.lastAllData=e,-1!==this.pluginData.attr.data.rule.indexOf("$selfFunction")&&this.pluginData.attr.data.functionStr)var a=Ya["a"].getFuncResult(this.pluginData.attr.data.rule,this.pluginData.attr.data.functionStr,t,this.plugin,this.forminfo.formId);else a=Ya["a"].getResult(this.pluginData.attr.data.rule,t,this.plugin);if(void 0===a)return!1;a=JSON.stringify(a),this.lastData!==a&&this.plugin.plugins[this.pluginData.attr.data.targetPlugin]&&(this.lastData=a,this.$set(this.plugin.plugins[this.pluginData.attr.data.targetPlugin],"data",JSON.parse(a)),this.$emit("sendmessage",this.plugin.plugins[this.pluginData.attr.data.targetPlugin]))},getKeyVal:function(){var t={};for(var e in this.pluginData.attr.data.keyval){var a=this.pluginData.attr.data.keyval[e];"plugin"==a.type?(t[e]=a.evalVar,t[a.key+"Data"]=this.allplugin.plugins[a.key]?this.allplugin.plugins[a.key].data:""):t[e]=a.evalMethod}return t}},mounted:function(){this.updateData(this.pluginData)}}),us=ls,ds=Object(d["a"])(us,ss,os,!1,null,null,null),cs=ds.exports;e["a"]={dOneInput:p,dIntegerInput:_,dNumericInput:S,dSelect:N,dSelectV2:U,dRadio:V,dCheckbox:J,dmultiText:nt,dmultiInputs:ct,dInput:vt,dImage:wt,dUser:It,dCountry:Mt,dCountryV2:jt,dUserSearch:Kt,dOpinion:te,dCalendar:se,dMultiple:pe,dLink:be,dAvatar:Ie,dFile:Me,dDepart:Ye,dJoinSign:aa,dProjectNumber:la,dPasswd:ga,dRepeatTable:tr,dSeal:Aa,dHandSignature:Oa,dBinding:Ha,dQuote:Ga,dCount:an,dRegion:hn,dShowHide:sr,dPayment:_n,dQrcode:In,dDataSource:pr,dSync:Mn,dShow:jn,dValidate:br,dAlert:xr,dVariate:Ir,dSerial:Kn,dChildTable:ti,dTable:Mr,dOneColumn:jr,dRepeatTableV3:Qr,dArticle:si,dPageSplit:rs,dXImage:pi,dConversion:cs,dRichText:yi,dSubmit:ki,dRoom:Pi,dOcr:Li}},2749:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=function t(e,a,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,a);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,a,n)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(n):void 0},r=a("25cd"),s=a("6181"),o=l(s);function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function c(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var p=function(t){var e=t.substr(0,12).split("").map((function(t){return+t})).reduce((function(t,e,a){return a%2?t+3*e:t+e}),0);return(10-e%10)%10},h=function(t){function e(t,a){u(this,e),-1!==t.search(/^[0-9]{12}$/)&&(t+=p(t));var n=d(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a));return n.lastChar=a.lastChar,n}return c(e,t),n(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{13}$/)&&+this.data[12]===p(this.data)}},{key:"leftText",value:function(){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var t=this.data.substr(1,6),a=r.EAN13_STRUCTURE[this.data[0]];return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,a)}},{key:"rightText",value:function(){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var t=this.data.substr(7,6);return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRRRR")}},{key:"encodeGuarded",value:function(){var t=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(t.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(t.push({data:"00"}),t.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),t}}]),e}(o.default);e.default=h},"277e":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.show?a("div",{staticClass:"child_table"},[t.ismobile?a("div",{staticClass:"child_table_mobile"},[a("div",{staticClass:"child_table_mobile_box"},[t.show?a("mformtable",{attrs:{watchmessage:t.formMessage},on:{sendmessage:t.watchFormmessage}}):t._e()],1),t._v(" "),!t.nowInfo.plugin||t.appCommonH.isEmptyObj(t.formMessage)||Boolean(+t.hideBtn)?t._e():a("div",{staticClass:"btns"},[a("el-button",{attrs:{size:"small",plain:""},on:{click:function(e){t.show=!1}}},[t._v(t._s(t.nowInfo.plugin.status.readonly?"关闭":"取消"))]),t._v(" "),t.nowInfo.plugin.status.readonly?t._e():a("el-button",{attrs:{size:"small",plain:"",type:"primary"},on:{click:t.okCallBack}},[t._v("确定")])],1)]):a("el-dialog",{attrs:{visible:t.show,width:"80%","lock-scroll":!0,"custom-class":"childtable_box","append-to-body":!0,"show-close":!1,center:""},on:{"update:visible":function(e){t.show=e}}},[t.show?a("formTable",{attrs:{watchmessage:t.formMessage},on:{sendmessage:t.watchFormmessage}}):t._e(),t._v(" "),!t.nowInfo.plugin||t.appCommonH.isEmptyObj(t.formMessage)||Boolean(+t.hideBtn)?t._e():a("div",{staticClass:"btns"},[a("el-button",{attrs:{plain:""},on:{click:t.closeChild}},[t._v(t._s(t.nowInfo.plugin.status.readonly?"关闭":"取消"))]),t._v(" "),t.nowInfo.plugin.status.readonly?t._e():a("el-button",{attrs:{plain:"",type:"primary"},on:{click:t.okCallBack}},[t._v("确定")])],1)],1)],1):t._e()},i=[],r=a("e793"),s=a("c763"),o=a("dc64"),l=a("9aec"),u=a("9f3a"),d={data:function(){return{test_id:0,task_id:0,show:!1,formMessage:{},nowInfo:{},formAuth:{},formData:{},version:"v2",ismobile:!0,hideBtn:1}},components:{formTable:s["a"],mformtable:l["a"]},computed:Object(r["a"])({},Object(u["d"])("form",["childTable"])),watch:{childTable:function(t){"open"==t.type&&(this.nowInfo=t,this.initTable(),window.childTableForm.id=this.nowInfo.plugin.data.form_id,window.childTableForm.closeChild=this.closeChild,this.childTableForm=window.childTableForm,this.hideBtn=window.childTableForm.attr.data.hideBtn)}},methods:Object(r["a"])(Object(r["a"])({},Object(u["c"])("form",["SET_CHILDTABLE","CHILDDATASOURCE"])),{},{watchFormmessage:function(t){t.method&&"function"==typeof this[t.method]&&this[t.method](t)},postMessage:function(){this.show=!0;var t=this;setTimeout((function(){t.formMessage={method:"initFormData",ispc:!t.ismobile,fid:t.nowInfo.plugin.data.form_id,appId:t.nowInfo.formInfo.appId,matter_type:t.nowInfo.formInfo.matterType,nodeId:t.nowInfo.formInfo.nodeId,bpmnId:t.nowInfo.formInfo.bpmnId,formData:t.getFormData(),formAuth:t.getAuth(),version:t.version}}),100)},getAuth:function(){return Object(r["a"])({defaultAuth:this.nowInfo.plugin.status.readonly?"readable":"writable",outDefaultAuth:"writable"},this.formAuth)},getFormData:function(){return this.formData},initTable:function(){var t=this;this.appFetch({url:"getChildTableData",method:"GET",data:{form_id:this.nowInfo.plugin.data.form_id,test_uid:this.test_id?this.test_id:void 0,bpmn_id:this.nowInfo.formInfo.bpmnId?this.nowInfo.formInfo.bpmnId:void 0,task_id:this.task_id?this.task_id:void 0,inst_id:this.nowInfo.formInfo.instId?this.nowInfo.formInfo.instId:void 0,sess_id:this.nowInfo.formInfo.sessId?this.nowInfo.formInfo.sessId:void 0,scene:o["a"].getScene(this.$route.query.type,this.$route.query.source)}},(function(e){0==e.e?(t.formAuth=e.d.auth,t.formData=e.d.data,t.version=e.d.version,t.appCommonH.isEmptyObj(t.nowInfo.plugin.data.data)||(t.formData=t.nowInfo.plugin.data.data),t.postMessage()):Vue.prototype.$message.error(e.m)}),(function(t){console.error("获取子表数据失败",t.message)}))},okCallBack:function(){this.formMessage={method:"getSaveFormData",callback:"getDataCallback",isCheck:!0}},getDataCallback:function(t){var e=this;switch(t.status){case"success":this.appFetch({url:"checkChild",method:"POST",data:{app_id:this.nowInfo.formInfo.appId,form_id:this.nowInfo.plugin.data.form_id,test_uid:this.test_id?this.test_id:void 0,bpmn_id:this.nowInfo.formInfo.bpmnId?this.nowInfo.formInfo.bpmnId:void 0,task_id:this.task_id?this.task_id:void 0,inst_id:this.nowInfo.formInfo.instId?this.nowInfo.formInfo.instId:void 0,sess_id:this.nowInfo.formInfo.sessId?this.nowInfo.formInfo.sessId:void 0,data:JSON.stringify(t.data)}},(function(a){0==a.e?(e.show=!1,e.clearData(),e.SET_CHILDTABLE({type:"save",formInfo:e.nowInfo.formInfo,plugin:e.nowInfo.plugin,data:e.appCommonH.copyObj(t.data)})):10049==a.e?e.formMessage={method:"apiValidate",errordata:a.d.errors[e.nowInfo.plugin.data.form_id],isAlert:!0}:Vue.prototype.$message.error({message:a.m,showClose:!0})}),(function(){Vue.prototype.$message.error({message:res.m,showClose:!0})}));break}},closeChild:function(){this.show=!1,this.clearData()},clearData:function(){this.CHILDDATASOURCE({fid:this.nowInfo.plugin.data.form_id,params:void 0})}}),created:function(){this.test_id=this.$route.query.test_id?this.$route.query.test_id:0,this.task_id=this.$route.query.task_id?this.$route.query.task_id:0,this.ismobile=this.appCommonH.isWeixin().isPhone}},c=d,p=(a("e4f2"),a("9ca4")),h=Object(p["a"])(c,n,i,!1,null,null,null);e["a"]=h.exports},2842:function(t,e,a){},2909:function(t,e,a){"use strict";var n=a("5a9e"),i=a("58d8").left,r=n.aTypedArray,s=n.exportTypedArrayMethod;s("reduce",(function(t){return i(r(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},2986:function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function t(e,a){n(this,t),this.data=e,this.text=a.text||e,this.options=a};e.default=i},"2a79":function(t,e,a){},"2baf":function(t,e,a){},"2bbe":function(t,e,a){var n=a("1c8b"),i=a("c7e6");n({target:"String",proto:!0},{repeat:i})},"2c23":function(t,e,a){(function(e){var a=e.CustomEvent;function n(){try{var t=new a("cat",{detail:{foo:"bar"}});return"cat"===t.type&&"bar"===t.detail.foo}catch(e){}return!1}t.exports=n()?a:"function"===typeof document.createEvent?function(t,e){var a=document.createEvent("CustomEvent");return e?a.initCustomEvent(t,e.bubbles,e.cancelable,e.detail):a.initCustomEvent(t,!1,!1,void 0),a}:function(t,e){var a=document.createEventObject();return a.type=t,e?(a.bubbles=Boolean(e.bubbles),a.cancelable=Boolean(e.cancelable),a.detail=e.detail):(a.bubbles=!1,a.cancelable=!1,a.detail=void 0),a}}).call(this,a("532c"))},"2d01":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("2986"),r=s(i);function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(t,a){return o(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a))}return u(e,t),n(e,[{key:"encode",value:function(){for(var t="110",e=0;e<this.data.length;e++){var a=parseInt(this.data[e]),n=a.toString(2);n=c(n,4-n.length);for(var i=0;i<n.length;i++)t+="0"==n[i]?"100":"110"}return t+="1001",{data:t,text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]+$/)}}]),e}(r.default);function c(t,e){for(var a=0;a<e;a++)t="0"+t;return t}e.default=d},"2e6f":function(t,e,a){},3e3:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("9b97"),i=function(t){return t.match(new RegExp("^"+n.A_CHARS+"*"))[0].length},r=function(t){return t.match(new RegExp("^"+n.B_CHARS+"*"))[0].length},s=function(t){return t.match(new RegExp("^"+n.C_CHARS+"*"))[0]};function o(t,e){var a=e?n.A_CHARS:n.B_CHARS,i=t.match(new RegExp("^("+a+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(i)return i[1]+String.fromCharCode(204)+l(t.substring(i[1].length));var r=t.match(new RegExp("^"+a+"+"))[0];return r.length===t.length?t:r+String.fromCharCode(e?205:206)+o(t.substring(r.length),!e)}function l(t){var e=s(t),a=e.length;if(a===t.length)return t;t=t.substring(a);var n=i(t)>=r(t);return e+String.fromCharCode(n?206:205)+o(t,n)}e.default=function(t){var e=void 0,a=s(t).length;if(a>=2)e=n.C_START_CHAR+l(t);else{var u=i(t)>r(t);e=(u?n.A_START_CHAR:n.B_START_CHAR)+o(t,u)}return e.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,(function(t,e){return String.fromCharCode(203)+e}))}},"316c":function(t,e,a){"use strict";var n=a("e8d2");e["a"]={setSubmitText:function(t){var e=t.matterAllData?t.matterAllData:t.appInfo;return e.submit_text?e.submit_text:t.$t("system.taskSubmitBtn")},startSuccessTips:function(t){var e=t.matterAllData?t.matterAllData:t.appInfo;t.$message({type:"success",message:e.success_text?e.success_text:"发起成功",showClose:!0})},startSuccessTo:function(t){setTimeout((function(){t.mixStartExamineSuccessClose||t.onlyStart?n["a"].closePage():1==t.appInfo.success_jump_type&&(window.history.length>1||document.referrer)?window.history.length>1?window.history.go(-1):location.href=document.referrer:2==t.appInfo.success_jump_type&&t.appInfo.success_jump_url?location.href=t.appInfo.success_jump_url:t.mixStartSuccessTo(1)}),1e3)},mStartSuccessTo:function(t){1==t.matterAllData.success_jump_type&&(window.history.length>1||document.referrer)?window.history.length>1?window.history.go(-1):location.href=document.referrer:2==t.matterAllData.success_jump_type&&t.matterAllData.success_jump_url?location.href=t.matterAllData.success_jump_url:window.setTimeout((function(){t.mixStartSuccessTo()}),1e3)}}},"31a0":function(t,e,a){"use strict";var n=a("1c8b"),i=a("5197"),r=a("0496");n({target:"String",proto:!0,forced:r("link")},{link:function(t){return i(this,"a","href",t)}})},"31d2":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("bdd1"),r=u(i),s=a("2986"),o=u(s),l=a("1c0a");function u(t){return t&&t.__esModule?t:{default:t}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function p(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],g=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],f=function(t){function e(t,a){d(this,e);var n=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a));if(n.isValid=!1,-1!==t.search(/^[0-9]{6}$/))n.middleDigits=t,n.upcA=m(t,"0"),n.text=a.text||""+n.upcA[0]+t+n.upcA[n.upcA.length-1],n.isValid=!0;else{if(-1===t.search(/^[01][0-9]{7}$/))return c(n);if(n.middleDigits=t.substring(1,t.length-1),n.upcA=m(n.middleDigits,t[0]),n.upcA[n.upcA.length-1]!==t[t.length-1])return c(n);n.isValid=!0}return n.displayValue=a.displayValue,a.fontSize>10*a.width?n.fontSize=10*a.width:n.fontSize=a.fontSize,n.guardHeight=a.height+n.fontSize/2+a.textMargin,n}return p(e,t),n(e,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var t="";return t+="101",t+=this.encodeMiddleDigits(),t+="010101",{data:t,text:this.text}}},{key:"guardedEncoding",value:function(){var t=[];return this.displayValue&&t.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),t.push({data:"101",options:{height:this.guardHeight}}),t.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),t.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&t.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),t}},{key:"encodeMiddleDigits",value:function(){var t=this.upcA[0],e=this.upcA[this.upcA.length-1],a=g[parseInt(e)][parseInt(t)];return(0,r.default)(this.middleDigits,a)}}]),e}(o.default);function m(t,e){for(var a=parseInt(t[t.length-1]),n=h[a],i="",r=0,s=0;s<n.length;s++){var o=n[s];i+="X"===o?t[r++]:o}return i=""+e+i,""+i+(0,l.checksum)(i)}e.default=f},"340f":function(t,e,a){var n=a("1e2c"),i=a("d910"),r=a("99ad"),s=a("22ef").UNSUPPORTED_Y;n&&("g"!=/./g.flags||s)&&i.f(RegExp.prototype,"flags",{configurable:!0,get:r})},3412:function(t,e,a){"use strict";a("ecb4"),a("513c"),a("e18c"),a("e35a"),a("1c2e"),a("5e9f");function n(t){var e="",a=t+"";a.indexOf("-")>-1&&(t=a.replace("-",""),e="负");for(var n=new Number(t),o=Math.round(100*n).toString(10),l=o.length,u="",d=0;d<l;d++)u=u+i(o.charAt(d))+r(l-d-1);return e+s(u)}function i(t){switch(t){case"0":return"零";case"1":return"壹";case"2":return"贰";case"3":return"叁";case"4":return"肆";case"5":return"伍";case"6":return"陆";case"7":return"柒";case"8":return"捌";case"9":return"玖";default:return""}}function r(t){if(t>10)return t-=8,r(t);switch(t){case 0:return"分";case 1:return"角";case 2:return"元";case 3:return"拾";case 4:return"佰";case 5:return"仟";case 6:return"万";case 7:return"拾";case 8:return"佰";case 9:return"仟";case 10:return"亿"}}function s(t){var e,a;t=t.replace("零分",""),t=t.replace("零角","零"),a=t,e=0;while(1){var n=a.length;if(a=a.replace("零元","元"),a=a.replace("零万","万"),a=a.replace("零亿","亿"),a=a.replace("零仟","零"),a=a.replace("零佰","零"),a=a.replace("零零","零"),a=a.replace("零拾","零"),a=a.replace("亿万","亿零"),a=a.replace("万仟","万零"),a=a.replace("仟佰","仟零"),e=a.length,e==n)break}return e=a.length,"零"==a.charAt(e-1)&&(a=a.substring(0,e-1)),e=a.length,"元"==a.charAt(e-1)&&(a=a),a}e["a"]=n},3598:function(t,e,a){"use strict";var n=a("5a9e"),i=a("8d7b"),r=n.aTypedArray,s=n.exportTypedArrayMethod;s("lastIndexOf",(function(t){return i.apply(r(this),arguments)}))},"35a3":function(t,e,a){"use strict";var n=a("16e4"),i=a.n(n);i.a},"35e7":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("2986"),r=o(i),s=a("9b97");function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function d(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=function(t){function e(t,a){l(this,e);var n=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.substring(1),a));return n.bytes=t.split("").map((function(t){return t.charCodeAt(0)})),n}return d(e,t),n(e,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var t=this.bytes,a=t.shift()-105,n=s.SET_BY_CODE[a];if(void 0===n)throw new RangeError("The encoding does not start with a start character.");!0===this.shouldEncodeAsEan128()&&t.unshift(s.FNC1);var i=e.next(t,1,n);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:e.getBar(a)+i.result+e.getBar((i.checksum+a)%s.MODULO)+e.getBar(s.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var t=this.options.ean128||!1;return"string"===typeof t&&(t="true"===t.toLowerCase()),t}}],[{key:"getBar",value:function(t){return s.BARS[t]?s.BARS[t].toString():""}},{key:"correctIndex",value:function(t,e){if(e===s.SET_A){var a=t.shift();return a<32?a+64:a-32}return e===s.SET_B?t.shift()-32:10*(t.shift()-48)+t.shift()-48}},{key:"next",value:function(t,a,n){if(!t.length)return{result:"",checksum:0};var i=void 0,r=void 0;if(t[0]>=200){r=t.shift()-105;var o=s.SWAP[r];void 0!==o?i=e.next(t,a+1,o):(n!==s.SET_A&&n!==s.SET_B||r!==s.SHIFT||(t[0]=n===s.SET_A?t[0]>95?t[0]-96:t[0]:t[0]<32?t[0]+96:t[0]),i=e.next(t,a+1,n))}else r=e.correctIndex(t,n),i=e.next(t,a+1,n);var l=e.getBar(r),u=r*a;return{result:l+i.result,checksum:u+i.checksum}}}]),e}(r.default);e.default=c},"3a93":function(t,e,a){"use strict";var n=a("1c8b"),i=a("5197"),r=a("0496");n({target:"String",proto:!0,forced:r("fontsize")},{fontsize:function(t){return i(this,"font","size",t)}})},"3aef":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UPCE=e.UPC=e.EAN2=e.EAN5=e.EAN8=e.EAN13=void 0;var n=a("2749"),i=f(n),r=a("5c03"),s=f(r),o=a("2452e"),l=f(o),u=a("6656"),d=f(u),c=a("1c0a"),p=f(c),h=a("31d2"),g=f(h);function f(t){return t&&t.__esModule?t:{default:t}}e.EAN13=i.default,e.EAN8=s.default,e.EAN5=l.default,e.EAN2=d.default,e.UPC=p.default,e.UPCE=g.default},"3b1c":function(t,e,a){"use strict";var n={},i="(?:^|\\s)",r="(?:\\s|$)";function s(t){var e=n[t];return e?e.lastIndex=0:n[t]=e=new RegExp(i+t+r,"g"),e}function o(t,e){var a=t.className;a.length?s(e).test(a)||(t.className+=" "+e):t.className=e}function l(t,e){t.className=t.className.replace(s(e)," ").trim()}t.exports={add:o,rm:l}},"3c51":function(t,e,a){"use strict";var n=a("5a9e"),i=a("fa41"),r=n.aTypedArray,s=n.exportTypedArrayMethod;s("fill",(function(t){return i.apply(r(this),arguments)}))},"3c8c":function(t,e,a){"use strict";var n=a("a028"),i=a.n(n);i.a},"3ccd":function(t,e,a){var n=a("3da3"),i=a("d88d");t.exports=function(t){if(void 0===t)return 0;var e=n(t),a=i(e);if(e!==a)throw RangeError("Wrong length or index");return a}},"3e54":function(t,e,a){"use strict";var n=a("1c8b"),i=a("efe2"),r=a("1c2e9"),s=a("857c"),o=a("e1d6"),l=a("d88d"),u=a("ef4c"),d=r.ArrayBuffer,c=r.DataView,p=d.prototype.slice,h=i((function(){return!new d(2).slice(1,void 0).byteLength}));n({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:h},{slice:function(t,e){if(void 0!==p&&void 0===e)return p.call(s(this),t);var a=s(this).byteLength,n=o(t,a),i=o(void 0===e?a:e,a),r=new(u(this,d))(l(i-n)),h=new c(this),g=new c(r),f=0;while(n<i)g.setUint8(f++,h.getUint8(n++));return r}})},"3f17":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("2d01"),i=s(n),r=a("858b");function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(t,a){return o(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,r.mod10)(t),a))}return u(e,t),e}(i.default);e.default=d},"3fd3":function(t,e,a){"use strict";var n=a("433b"),i=a.n(n);i.a},4140:function(t,e,a){"use strict";var n=a("5a9e"),i=a("ef4c"),r=a("efe2"),s=n.aTypedArray,o=n.aTypedArrayConstructor,l=n.exportTypedArrayMethod,u=[].slice,d=r((function(){new Int8Array(1).slice()}));l("slice",(function(t,e){var a=u.call(s(this),t,e),n=i(this,this.constructor),r=0,l=a.length,d=new(o(n))(l);while(l>r)d[r]=a[r++];return d}),d)},"41ff":function(t,e,a){var n=a("26a2");n("Int32",(function(t){return function(e,a,n){return t(this,e,a,n)}}))},4226:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("b1d4"),i=a("7f96"),r=a("3aef"),s=a("e195"),o=a("f7f2"),l=a("8a20"),u=a("52d1"),d=a("8106");e.default={CODE39:n.CODE39,CODE128:i.CODE128,CODE128A:i.CODE128A,CODE128B:i.CODE128B,CODE128C:i.CODE128C,EAN13:r.EAN13,EAN8:r.EAN8,EAN5:r.EAN5,EAN2:r.EAN2,UPC:r.UPC,UPCE:r.UPCE,ITF14:s.ITF14,ITF:s.ITF,MSI:o.MSI,MSI10:o.MSI10,MSI11:o.MSI11,MSI1010:o.MSI1010,MSI1110:o.MSI1110,pharmacode:l.pharmacode,codabar:u.codabar,GenericBarcode:d.GenericBarcode}},4275:function(t,e){UE.I18N["zh-cn"]={labelMap:{anchor:"锚点",undo:"撤销",redo:"重做",bold:"加粗",indent:"首行缩进",snapscreen:"截图",italic:"斜体",underline:"下划线",strikethrough:"删除线",subscript:"下标",fontborder:"字符边框",superscript:"上标",formatmatch:"格式刷",source:"源代码",blockquote:"引用",pasteplain:"纯文本粘贴模式",selectall:"全选",print:"打印",preview:"预览",horizontal:"分隔线",removeformat:"清除格式",time:"时间",date:"日期",unlink:"取消链接",insertrow:"前插入行",insertcol:"前插入列",mergeright:"右合并单元格",mergedown:"下合并单元格",deleterow:"删除行",deletecol:"删除列",splittorows:"拆分成行",splittocols:"拆分成列",splittocells:"完全拆分单元格",deletecaption:"删除表格标题",inserttitle:"插入标题",mergecells:"合并多个单元格",deletetable:"删除表格",cleardoc:"清空文档",insertparagraphbeforetable:"表格前插入行",insertcode:"代码语言",fontfamily:"字体",fontsize:"字号",paragraph:"段落格式",simpleupload:"单图上传",insertimage:"多图上传",edittable:"表格属性",edittd:"单元格属性",link:"超链接",emotion:"表情",spechars:"特殊字符",searchreplace:"查询替换",map:"Baidu地图",gmap:"Google地图",insertvideo:"视频",help:"帮助",justifyleft:"居左对齐",justifyright:"居右对齐",justifycenter:"居中对齐",justifyjustify:"两端对齐",forecolor:"字体颜色",backcolor:"背景色",insertorderedlist:"有序列表",insertunorderedlist:"无序列表",fullscreen:"全屏",directionalityltr:"从左向右输入",directionalityrtl:"从右向左输入",rowspacingtop:"段前距",rowspacingbottom:"段后距",pagebreak:"分页",insertframe:"插入Iframe",imagenone:"默认",imageleft:"左浮动",imageright:"右浮动",attachment:"附件",imagecenter:"居中",wordimage:"图片转存",lineheight:"行间距",edittip:"编辑提示",customstyle:"自定义标题",autotypeset:"自动排版",webapp:"百度应用",touppercase:"字母大写",tolowercase:"字母小写",background:"背景",template:"模板",scrawl:"涂鸦",music:"音乐",inserttable:"插入表格",drafts:"从草稿箱加载",charts:"图表"},insertorderedlist:{num:"1,2,3...",num1:"1),2),3)...",num2:"(1),(2),(3)...",cn:"一,二,三....",cn1:"一),二),三)....",cn2:"(一),(二),(三)....",decimal:"1,2,3...","lower-alpha":"a,b,c...","lower-roman":"i,ii,iii...","upper-alpha":"A,B,C...","upper-roman":"I,II,III..."},insertunorderedlist:{circle:"○ 大圆圈",disc:"● 小黑点",square:"■ 小方块 ",dash:"— 破折号",dot:" 。 小圆圈"},paragraph:{p:"段落",h1:"标题 1",h2:"标题 2",h3:"标题 3",h4:"标题 4",h5:"标题 5",h6:"标题 6"},fontfamily:{songti:"宋体",kaiti:"楷体",heiti:"黑体",lishu:"隶书",yahei:"微软雅黑",andaleMono:"andale mono",arial:"arial",arialBlack:"arial black",comicSansMs:"comic sans ms",impact:"impact",timesNewRoman:"times new roman",FangSong:"仿宋",STZhongsong:"华文中宋","FZXiaoBiaoSong-B05S":"方正小宋简体",FangSong_GB2312:"仿宋gb2312",kaiti_GB2312:"楷体gb2312"},customstyle:{tc:"标题居中",tl:"标题居左",im:"强调",hi:"明显强调"},autoupload:{exceedSizeError:"文件大小超出限制",exceedTypeError:"文件格式不允许",jsonEncodeError:"服务器返回格式错误",loading:"正在上传...",loadError:"上传错误",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！"},simpleupload:{exceedSizeError:"文件大小超出限制",exceedTypeError:"文件格式不允许",jsonEncodeError:"服务器返回格式错误",loading:"正在上传...",loadError:"上传错误",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！"},elementPathTip:"元素路径",wordCountTip:"字数统计",wordCountMsg:"当前已输入{#count}个字符, 您还可以输入{#leave}个字符。 ",wordOverFlowMsg:'<span style="color:red;">字数超出最大允许值，服务器可能拒绝保存！</span>',ok:"确认",cancel:"取消",closeDialog:"关闭对话框",tableDrag:"表格拖动必须引入uiUtils.js文件！",autofloatMsg:"工具栏浮动依赖编辑器UI，您首先需要引入UI文件!",loadconfigError:"获取后台配置项请求出错，上传功能将不能正常使用！",loadconfigFormatError:"后台配置项返回格式出错，上传功能将不能正常使用！",loadconfigHttpError:"请求后台配置项http错误，上传功能将不能正常使用！",snapScreen_plugin:{browserMsg:"仅支持IE浏览器！",callBackErrorMsg:"服务器返回数据有误，请检查配置项之后重试。",uploadErrorMsg:"截图上传失败，请检查服务器端环境! "},insertcode:{as3:"ActionScript 3",bash:"Bash/Shell",cpp:"C/C++",css:"CSS",cf:"ColdFusion","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"HTML",java:"Java",jfx:"JavaFX",js:"JavaScript",pl:"Perl",php:"PHP",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"SQL",vb:"Visual Basic",xml:"XML"},confirmClear:"确定清空当前文档么？",contextMenu:{delete:"删除",selectall:"全选",deletecode:"删除代码",cleardoc:"清空文档",confirmclear:"确定清空当前文档么？",unlink:"删除超链接",paragraph:"段落格式",edittable:"表格属性",aligntd:"单元格对齐方式",aligntable:"表格对齐方式",tableleft:"左浮动",tablecenter:"居中显示",tableright:"右浮动",edittd:"单元格属性",setbordervisible:"设置表格边线可见",justifyleft:"左对齐",justifyright:"右对齐",justifycenter:"居中对齐",justifyjustify:"两端对齐",table:"表格",inserttable:"插入表格",deletetable:"删除表格",insertparagraphbefore:"前插入段落",insertparagraphafter:"后插入段落",deleterow:"删除当前行",deletecol:"删除当前列",insertrow:"前插入行",insertcol:"左插入列",insertrownext:"后插入行",insertcolnext:"右插入列",insertcaption:"插入表格名称",deletecaption:"删除表格名称",inserttitle:"插入表格标题行",deletetitle:"删除表格标题行",inserttitlecol:"插入表格标题列",deletetitlecol:"删除表格标题列",averageDiseRow:"平均分布各行",averageDisCol:"平均分布各列",mergeright:"向右合并",mergeleft:"向左合并",mergedown:"向下合并",mergecells:"合并单元格",splittocells:"完全拆分单元格",splittocols:"拆分成列",splittorows:"拆分成行",tablesort:"表格排序",enablesort:"设置表格可排序",disablesort:"取消表格可排序",reversecurrent:"逆序当前",orderbyasc:"按ASCII字符升序",reversebyasc:"按ASCII字符降序",orderbynum:"按数值大小升序",reversebynum:"按数值大小降序",borderbk:"边框底纹",setcolor:"表格隔行变色",unsetcolor:"取消表格隔行变色",setbackground:"选区背景隔行",unsetbackground:"取消选区背景",redandblue:"红蓝相间",threecolorgradient:"三色渐变",copy:"复制(Ctrl + c)",copymsg:"浏览器不支持,请使用 'Ctrl + c'",paste:"粘贴(Ctrl + v)",pastemsg:"浏览器不支持,请使用 'Ctrl + v'"},copymsg:"浏览器不支持,请使用 'Ctrl + c'",pastemsg:"浏览器不支持,请使用 'Ctrl + v'",anthorMsg:"链接",clearColor:"清空颜色",standardColor:"标准颜色",themeColor:"主题颜色",property:"属性",default:"默认",modify:"修改",justifyleft:"左对齐",justifyright:"右对齐",justifycenter:"居中",justify:"默认",clear:"清除",anchorMsg:"锚点",delete:"删除",clickToUpload:"点击上传",unset:"尚未设置语言文件",t_row:"行",t_col:"列",more:"更多",pasteOpt:"粘贴选项",pasteSourceFormat:"保留源格式",tagFormat:"只保留标签",pasteTextFormat:"只保留文本",autoTypeSet:{mergeLine:"合并空行",delLine:"清除空行",removeFormat:"清除格式",indent:"首行缩进",alignment:"对齐方式",imageFloat:"图片浮动",removeFontsize:"清除字号",removeFontFamily:"清除字体",removeHtml:"清除冗余HTML代码",pasteFilter:"粘贴过滤",run:"执行",symbol:"符号转换",bdc2sb:"全角转半角",tobdc:"半角转全角"},background:{static:{lang_background_normal:"背景设置",lang_background_local:"在线图片",lang_background_set:"选项",lang_background_none:"无背景色",lang_background_colored:"有背景色",lang_background_color:"颜色设置",lang_background_netimg:"网络图片",lang_background_align:"对齐方式",lang_background_position:"精确定位",repeatType:{options:["居中","横向重复","纵向重复","平铺","自定义"]}},noUploadImage:"当前未上传过任何图片！",toggleSelect:"单击可切换选中状态\n原图尺寸: "},insertimage:{static:{lang_tab_remote:"插入图片",lang_tab_upload:"本地上传",lang_tab_online:"在线管理",lang_tab_search:"图片搜索",lang_input_url:"地 址：",lang_input_size:"大 小：",lang_input_width:"宽度",lang_input_height:"高度",lang_input_border:"边 框：",lang_input_vhspace:"边 距：",lang_input_title:"描 述：",lang_input_align:"图片浮动方式：",lang_imgLoading:"　图片加载中……",lang_start_upload:"开始上传",lock:{title:"锁定宽高比例"},searchType:{title:"图片类型",options:["新闻","壁纸","表情","头像"]},searchTxt:{value:"请输入搜索关键词"},searchBtn:{value:"百度一下"},searchReset:{value:"清空搜索"},noneAlign:{title:"无浮动"},leftAlign:{title:"左浮动"},rightAlign:{title:"右浮动"},centerAlign:{title:"居中独占一行"}},uploadSelectFile:"点击选择图片",uploadAddFile:"继续添加",uploadStart:"开始上传",uploadPause:"暂停上传",uploadContinue:"继续上传",uploadRetry:"重试上传",uploadDelete:"删除",uploadTurnLeft:"向左旋转",uploadTurnRight:"向右旋转",uploadPreview:"预览中",uploadNoPreview:"不能预览",updateStatusReady:"选中_张图片，共_KB。",updateStatusConfirm:"已成功上传_张照片，_张照片上传失败",updateStatusFinish:"共_张（_KB），_张上传成功",updateStatusError:"，_张上传失败。",errorNotSupport:"WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！",errorExceedSize:"文件大小超出",errorFileType:"文件格式不允许",errorInterrupt:"文件传输中断",errorUploadRetry:"上传失败，请重试",errorHttp:"http请求错误",errorServerUpload:"服务器返回出错",remoteLockError:"宽高不正确,不能所定比例",numError:"请输入正确的长度或者宽度值！例如：123，400",imageUrlError:"不允许的图片格式或者图片域！",imageLoadError:"图片加载失败！请检查链接地址或网络状态！",searchRemind:"请输入搜索关键词",searchLoading:"图片加载中，请稍后……",searchRetry:" :( ，抱歉，没有找到图片！请重试一次！"},attachment:{static:{lang_tab_upload:"上传附件",lang_tab_online:"在线附件",lang_start_upload:"开始上传",lang_drop_remind:"可以将文件拖到这里，单次最多可选100个文件"},uploadSelectFile:"点击选择文件",uploadAddFile:"继续添加",uploadStart:"开始上传",uploadPause:"暂停上传",uploadContinue:"继续上传",uploadRetry:"重试上传",uploadDelete:"删除",uploadTurnLeft:"向左旋转",uploadTurnRight:"向右旋转",uploadPreview:"预览中",updateStatusReady:"选中_个文件，共_KB。",updateStatusConfirm:"已成功上传_个文件，_个文件上传失败",updateStatusFinish:"共_个（_KB），_个上传成功",updateStatusError:"，_张上传失败。",errorNotSupport:"WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！",errorExceedSize:"文件大小超出",errorFileType:"文件格式不允许",errorInterrupt:"文件传输中断",errorUploadRetry:"上传失败，请重试",errorHttp:"http请求错误",errorServerUpload:"服务器返回出错"},insertvideo:{static:{lang_tab_insertV:"插入视频",lang_tab_searchV:"搜索视频",lang_tab_uploadV:"上传视频",lang_video_url:"视频网址",lang_video_size:"视频尺寸",lang_videoW:"宽度",lang_videoH:"高度",lang_alignment:"对齐方式",videoSearchTxt:{value:"请输入搜索关键字！"},videoType:{options:["全部","热门","娱乐","搞笑","体育","科技","综艺"]},videoSearchBtn:{value:"百度一下"},videoSearchReset:{value:"清空结果"},lang_input_fileStatus:" 当前未上传文件",startUpload:{style:"background:url(upload.png) no-repeat;"},lang_upload_size:"视频尺寸",lang_upload_width:"宽度",lang_upload_height:"高度",lang_upload_alignment:"对齐方式",lang_format_advice:"建议使用mp4格式."},numError:"请输入正确的数值，如123,400",floatLeft:"左浮动",floatRight:"右浮动",'"default"':"默认",block:"独占一行",urlError:"输入的视频地址有误，请检查后再试！",loading:" &nbsp;视频加载中，请等待……",clickToSelect:"点击选中",goToSource:"访问源视频",noVideo:" &nbsp; &nbsp;抱歉，找不到对应的视频，请重试！",browseFiles:"浏览文件",uploadSuccess:"上传成功!",delSuccessFile:"从成功队列中移除",delFailSaveFile:"移除保存失败文件",statusPrompt:" 个文件已上传！ ",flashVersionError:"当前Flash版本过低，请更新FlashPlayer后重试！",flashLoadingError:"Flash加载失败!请检查路径或网络状态",fileUploadReady:"等待上传……",delUploadQueue:"从上传队列中移除",limitPrompt1:"单次不能选择超过",limitPrompt2:"个文件！请重新选择！",delFailFile:"移除失败文件",fileSizeLimit:"文件大小超出限制！",emptyFile:"空文件无法上传！",fileTypeError:"文件类型不允许！",unknownError:"未知错误！",fileUploading:"上传中，请等待……",cancelUpload:"取消上传",netError:"网络错误",failUpload:"上传失败!",serverIOError:"服务器IO错误！",noAuthority:"无权限！",fileNumLimit:"上传个数限制",failCheck:"验证失败，本次上传被跳过！",fileCanceling:"取消中，请等待……",stopUploading:"上传已停止……",uploadSelectFile:"点击选择文件",uploadAddFile:"继续添加",uploadStart:"开始上传",uploadPause:"暂停上传",uploadContinue:"继续上传",uploadRetry:"重试上传",uploadDelete:"删除",uploadTurnLeft:"向左旋转",uploadTurnRight:"向右旋转",uploadPreview:"预览中",updateStatusReady:"选中_个文件，共_KB。",updateStatusConfirm:"成功上传_个，_个失败",updateStatusFinish:"共_个(_KB)，_个成功上传",updateStatusError:"，_张上传失败。",errorNotSupport:"WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。",errorLoadConfig:"后端配置项没有正常加载，上传插件不能正常使用！",errorExceedSize:"文件大小超出",errorFileType:"文件格式不允许",errorInterrupt:"文件传输中断",errorUploadRetry:"上传失败，请重试",errorHttp:"http请求错误",errorServerUpload:"服务器返回出错"},webapp:{tip1:"本功能由百度APP提供，如看到此页面，请各位站长首先申请百度APPKey!",tip2:"申请完成之后请至ueditor.config.js中配置获得的appkey! ",applyFor:"点此申请",anthorApi:"百度API"},template:{static:{lang_template_bkcolor:"背景颜色",lang_template_clear:"保留原有内容",lang_template_select:"选择模板"},blank:"空白文档",blog:"博客文章",resume:"个人简历",richText:"图文混排",sciPapers:"科技论文"},scrawl:{static:{lang_input_previousStep:"上一步",lang_input_nextsStep:"下一步",lang_input_clear:"清空",lang_input_addPic:"添加背景",lang_input_ScalePic:"缩放背景",lang_input_removePic:"删除背景",J_imgTxt:{title:"添加背景图片"}},noScarwl:"尚未作画，白纸一张~",scrawlUpLoading:"涂鸦上传中,别急哦~",continueBtn:"继续",imageError:"糟糕，图片读取失败了！",backgroundUploading:"背景图片上传中,别急哦~"},music:{static:{lang_input_tips:"输入歌手/歌曲/专辑，搜索您感兴趣的音乐！",J_searchBtn:{value:"搜索歌曲"}},emptyTxt:"未搜索到相关音乐结果，请换一个关键词试试。",chapter:"歌曲",singer:"歌手",special:"专辑",listenTest:"试听"},anchor:{static:{lang_input_anchorName:"锚点名字："}},charts:{static:{lang_data_source:"数据源：",lang_chart_format:"图表格式：",lang_data_align:"数据对齐方式",lang_chart_align_same:"数据源与图表X轴Y轴一致",lang_chart_align_reverse:"数据源与图表X轴Y轴相反",lang_chart_title:"图表标题",lang_chart_main_title:"主标题：",lang_chart_sub_title:"子标题：",lang_chart_x_title:"X轴标题：",lang_chart_y_title:"Y轴标题：",lang_chart_tip:"提示文字",lang_cahrt_tip_prefix:"提示文字前缀：",lang_cahrt_tip_description:"仅饼图有效， 当鼠标移动到饼图中相应的块上时，提示框内的文字的前缀",lang_chart_data_unit:"数据单位",lang_chart_data_unit_title:"单位：",lang_chart_data_unit_description:"显示在每个数据点上的数据的单位， 比如： 温度的单位 ℃",lang_chart_type:"图表类型：",lang_prev_btn:"上一个",lang_next_btn:"下一个"}},emotion:{static:{lang_input_choice:"精选",lang_input_Tuzki:"兔斯基",lang_input_BOBO:"BOBO",lang_input_lvdouwa:"绿豆蛙",lang_input_babyCat:"baby猫",lang_input_bubble:"泡泡",lang_input_youa:"有啊"}},gmap:{static:{lang_input_address:"地址",lang_input_search:"搜索",address:{value:"北京"}},searchError:"无法定位到该地址!"},help:{static:{lang_input_about:"关于UEditor",lang_input_shortcuts:"快捷键",lang_input_introduction:"UEditor是由百度web前端研发部开发的所见即所得富文本web编辑器，具有轻量，可定制，注重用户体验等特点。开源基于BSD协议，允许自由使用和修改代码。",lang_Txt_shortcuts:"快捷键",lang_Txt_func:"功能",lang_Txt_bold:"给选中字设置为加粗",lang_Txt_copy:"复制选中内容",lang_Txt_cut:"剪切选中内容",lang_Txt_Paste:"粘贴",lang_Txt_undo:"重新执行上次操作",lang_Txt_redo:"撤销上一次操作",lang_Txt_italic:"给选中字设置为斜体",lang_Txt_underline:"给选中字加下划线",lang_Txt_selectAll:"全部选中",lang_Txt_visualEnter:"软回车",lang_Txt_fullscreen:"全屏"}},insertframe:{static:{lang_input_address:"地址：",lang_input_width:"宽度：",lang_input_height:"高度：",lang_input_isScroll:"允许滚动条：",lang_input_frameborder:"显示框架边框：",lang_input_alignMode:"对齐方式：",align:{title:"对齐方式",options:["默认","左对齐","右对齐","居中"]}},enterAddress:"请输入地址!"},link:{static:{lang_input_text:"文本内容：",lang_input_url:"链接地址：",lang_input_title:"标题：",lang_input_target:"是否在新窗口打开："},validLink:"只支持选中一个链接时生效",httpPrompt:"您输入的超链接中不包含http等协议名称，默认将为您添加http://前缀"},map:{static:{lang_city:"城市",lang_address:"地址",city:{value:"北京"},lang_search:"搜索",lang_dynamicmap:"插入动态地图"},cityMsg:"请选择城市",errorMsg:"抱歉，找不到该位置！"},searchreplace:{static:{lang_tab_search:"查找",lang_tab_replace:"替换",lang_search1:"查找",lang_search2:"查找",lang_replace:"替换",lang_searchReg:"支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”",lang_searchReg1:"支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”",lang_case_sensitive1:"区分大小写",lang_case_sensitive2:"区分大小写",nextFindBtn:{value:"下一个"},preFindBtn:{value:"上一个"},nextReplaceBtn:{value:"下一个"},preReplaceBtn:{value:"上一个"},repalceBtn:{value:"替换"},repalceAllBtn:{value:"全部替换"}},getEnd:"已经搜索到文章末尾！",getStart:"已经搜索到文章头部",countMsg:"总共替换了{#count}处！"},snapscreen:{static:{lang_showMsg:"截图功能需要首先安装UEditor截图插件！ ",lang_download:"点此下载",lang_step1:"第一步，下载UEditor截图插件并运行安装。",lang_step2:"第二步，插件安装完成后即可使用，如不生效，请重启浏览器后再试！"}},spechars:{static:{},tsfh:"特殊字符",lmsz:"罗马字符",szfh:"数学字符",rwfh:"日文字符",xlzm:"希腊字母",ewzm:"俄文字符",pyzm:"拼音字母",yyyb:"英语音标",zyzf:"其他"},edittable:{static:{lang_tableStyle:"表格样式",lang_insertCaption:"添加表格名称行",lang_insertTitle:"添加表格标题行",lang_insertTitleCol:"添加表格标题列",lang_orderbycontent:"使表格内容可排序",lang_tableSize:"自动调整表格尺寸",lang_autoSizeContent:"按表格文字自适应",lang_autoSizePage:"按页面宽度自适应",lang_example:"示例",lang_borderStyle:"表格边框",lang_color:"颜色:"},captionName:"表格名称",titleName:"标题",cellsName:"内容",errorMsg:"有合并单元格，不可排序"},edittip:{static:{lang_delRow:"删除整行",lang_delCol:"删除整列"}},edittd:{static:{lang_tdBkColor:"背景颜色:"}},formula:{static:{}},wordimage:{static:{lang_resave:"转存步骤",uploadBtn:{src:"upload.png",alt:"上传"},clipboard:{style:"background: url(copy.png) -153px -1px no-repeat;"},lang_step:"1、点击顶部复制按钮，将地址复制到剪贴板；2、点击添加照片按钮，在弹出的对话框中使用Ctrl+V粘贴地址；3、点击打开后选择图片上传流程。"},fileType:"图片",flashError:"FLASH初始化失败，请检查FLASH插件是否正确安装！",netError:"网络连接错误，请重试！",copySuccess:"图片地址已经复制！",flashI18n:{}},autosave:{saving:"保存中...",success:"本地保存成功"}}},"433b":function(t,e,a){},"43f5":function(t,e,a){"use strict";e["a"]={data:{focusalert:!1},methods:{getFocus:function(){this.getFocusContent()&&(this.focusalert=!0)},getBlur:function(){this.focusalert=!1},afterEnter:function(){$(".focusalert").css({zIndex:1})},getFocusContent:function(){var t="";if(this.pluginData.pkey&&this.pluginData.model){var e=this.allplugin.rtplugins[this.pluginData.model];t=this.pluginData.alertFoucsMsg?this.pluginData.alertFoucsMsg:e?e.alertFoucsMsg:""}else t=this.pluginData.alertFoucsMsg;return t}}}},"460b":function(t,e){t.exports=function(t,e){return Array.prototype.slice.call(t,e)}},"46c1":function(t,e,a){},"4e33":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("35e7"),i=o(n),r=a("3000"),s=o(r);function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function d(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=function(t){function e(t,a){if(l(this,e),/^[\x00-\x7F\xC8-\xD3]+$/.test(t))var n=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,(0,s.default)(t),a));else n=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a));return u(n)}return d(e,t),e}(i.default);e.default=c},"4f9a":function(t,e,a){"use strict";var n=a("2a79"),i=a.n(n);i.a},5186:function(t,e,a){"use strict";var n=a("460b"),i=a("d6bb");t.exports=function(t,e){var a=e||{},r={};return void 0===t&&(t={}),t.on=function(e,a){return r[e]?r[e].push(a):r[e]=[a],t},t.once=function(e,a){return a._once=!0,t.on(e,a),t},t.off=function(e,a){var n=arguments.length;if(1===n)delete r[e];else if(0===n)r={};else{var i=r[e];if(!i)return t;i.splice(i.indexOf(a),1)}return t},t.emit=function(){var e=n(arguments);return t.emitterSnapshot(e.shift()).apply(this,e)},t.emitterSnapshot=function(e){var s=(r[e]||[]).slice(0);return function(){var r=n(arguments),o=this||t;if("error"===e&&!1!==a.throws&&!s.length)throw 1===r.length?r[0]:r;return s.forEach((function(n){a.async?i(n,r,o):n.apply(o,r),n._once&&t.off(e,n)})),t}},t}},5197:function(t,e,a){var n=a("2732"),i=/"/g;t.exports=function(t,e,a,r){var s=String(n(t)),o="<"+e;return""!==a&&(o+=" "+a+'="'+String(r).replace(i,"&quot;")+'"'),o+">"+s+"</"+e+">"}},5264:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAABIJJREFUWAm9lm1IVFkYxx3HGUlFDbe0onKZghhayJJlt8WgzF7AWpZwvxR9cD/UbsR+2MpVUaRVQRCEpG8VvdGLFkElyYZiSxIY1sTuflBjW4i02FVRxnJGHff3XO5x77zc6x3BDjz3nPO8/s9znnvOcSTYbLW1tatnZ2c9TqfzE/pE2jj938Fg8K+ampqgTTdRao4ojoGB43S3233A4XAcgr0FyjCIEwAwiawP3p3p6enLVVVVr4xyO2NTAKz4G1ZZSwBvhKMZ5iHIZeQDZhjdpsHBwcbm5uaAUWY1jgJQUlLizMvLO42zcgyV/EUoFLoLoMdTU1ND8EOMl6KTBxVD2+FpgADSDpVWVlaK3rxNBdAUSXmiy+U6i/OjwsDRK5xXsapbVqsiW1upjV8w2aHbPcO22A4IpxioVlRUdILgsnIJ/ohV78fJ456eHkm7aevs7HxdUFBwAxCpAP4SWoHyRngtXV1dlrZzAOrq6jYS/CqGbug51b2vurr6rWnUCIEE6ujo+LWwsHAFAPKhdUlJSW/hPY1QDZsmqhkGpxinsnI/Ky9lO/5Vsnj6kZGRn/Dh021O4ifTyl4DwB6uRelrXfEiaVcOrGxjyhobGydYwGldmMtvvC+mos7UAJD6nWQgHeRB/ucLVgZ2ZMPDw/In9IsuftXCYppqAFDaqktfgv7PmJpxMJuamj7g8zcxAcgmtiHFzFwDgDBXFDAaQHnBx6r4UI2F/KGPl1GMWYof2WsAQJkqAnp/pMJC52yrKmI3fufNgFq1BmShQY12ZGCJzMmqnAPKv1FFG6steKNL1rAFihelHA+DwOt1/VG/3z9iZqu24JmusIHTzGOmbJcviwDANtEn/X0NDQ3jZrZqtQ9RmMIohYL51kzZLh8fn6Mr17e0dmhWG8X4aAB8Pt/vyLp1+Q8cy3KWL7Q5yGIFxi5WPz4zM3PbypEGoLW1VQqlARKkK6ngZrmWrQzNZPX19ceRaacfGT0/3yNlLgiXxksuktUYbcaBNycnJ8vj8Tzs7e2Vx4etRuYOA/4MyklQHxkoxe97K+Ow90BZWVkGrQ0QX+lGD/idTnE3qEMlpi9WvQzBz9j9SO8ksPx2uyoqKh7FNDAwwwAInwpeyQVyA2cFMpd9pJN9vMUV7RsbGxsFpGyZvBflVyuGDqIvF5pqspVXAoHAEfxNKmasPgqAKGGUnpycXEPwYziW94Fqo/D+YTINZSFbTm/00YbcDb9IDBhfB7Rc7aYgjMZiE9a4pr+gor/H0W6cZocJ/59MMHwCnSsvL28hWCrgW5jvFZX5QFgCEAfSKK5sAGyBPsPhKsgF+x3UT408pdIHRE81ySDbcxP9PcKzAmELgHIcT68XtIDYrYO4NjQ0VBr5uJ37DeNxbke3u7s7kJ+ff4/tkKf7OsleWlqax+v13jc+chcNgIA0gNgMAI8CwWu5jUesFHLCogJQIAh4n2KeAyEXngKxaDUgwY2NwszUC3OXzr/KOfHdRwMgQSNATPB3fLroW2DMAvs+KdvBde0g+CWO6if/AfHx3R5ZRZJmAAAAAElFTkSuQmCC"},"52d1":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.codabar=void 0;var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("2986"),r=s(i);function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(t,a){o(this,e),0===t.search(/^[0-9\-\$\:\.\+\/]+$/)&&(t="A"+t+"A");var n=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.toUpperCase(),a));return n.text=n.options.text||n.text.replace(/[A-D]/g,""),n}return u(e,t),n(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)}},{key:"encode",value:function(){for(var t=[],e=this.getEncodings(),a=0;a<this.data.length;a++)t.push(e[this.data.charAt(a)]),a!==this.data.length-1&&t.push("0");return{text:this.text,data:t.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"101100110011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),e}(r.default);e.codabar=d},5501:function(t,e,a){var i,r;(function(){var a=!1,s=function(t){return t instanceof s?t:this instanceof s?void(this.EXIFwrapped=t):new s(t)};t.exports&&(e=t.exports=s),e.EXIF=s;var o=s.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},l=s.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},u=s.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},d=s.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},c=s.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function p(t){return!!t.exifdata}function h(t,e){e=e||t.match(/^data\:([^\;]+)\;base64,/im)[1]||"",t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var a=atob(t),n=a.length,i=new ArrayBuffer(n),r=new Uint8Array(i),s=0;s<n;s++)r[s]=a.charCodeAt(s);return i}function g(t,e){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="blob",a.onload=function(t){200!=this.status&&0!==this.status||e(this.response)},a.send()}function f(t,e){function n(a){var n=m(a);t.exifdata=n||{};var i=v(a);if(t.iptcdata=i||{},s.isXmpEnabled){var r=S(a);t.xmpdata=r||{}}e&&e.call(t)}if(t.src)if(/^data\:/i.test(t.src)){var i=h(t.src);n(i)}else if(/^blob\:/i.test(t.src)){var r=new FileReader;r.onload=function(t){n(t.target.result)},g(t.src,(function(t){r.readAsArrayBuffer(t)}))}else{var o=new XMLHttpRequest;o.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";n(o.response),o=null},o.open("GET",t.src,!0),o.responseType="arraybuffer",o.send(null)}else if(self.FileReader&&(t instanceof self.Blob||t instanceof self.File)){r=new FileReader;r.onload=function(t){a&&console.log("Got file of length "+t.target.result.byteLength),n(t.target.result)},r.readAsArrayBuffer(t)}}function m(t){var e=new DataView(t);if(a&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return a&&console.log("Not a valid JPEG"),!1;var n,i=2,r=t.byteLength;while(i<r){if(255!=e.getUint8(i))return a&&console.log("Not a valid marker at offset "+i+", found: "+e.getUint8(i)),!1;if(n=e.getUint8(i+1),a&&console.log(n),225==n)return a&&console.log("Found 0xFFE1 marker"),k(e,i+4,e.getUint16(i+2)-2);i+=2+e.getUint16(i+2)}}function v(t){var e=new DataView(t);if(a&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return a&&console.log("Not a valid JPEG"),!1;var n=2,i=t.byteLength,r=function(t,e){return 56===t.getUint8(e)&&66===t.getUint8(e+1)&&73===t.getUint8(e+2)&&77===t.getUint8(e+3)&&4===t.getUint8(e+4)&&4===t.getUint8(e+5)};while(n<i){if(r(e,n)){var s=e.getUint8(n+7);s%2!==0&&(s+=1),0===s&&(s=4);var o=n+8+s,l=e.getUint16(n+6+s);return y(t,o,l)}n++}}var b={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function y(t,e,a){var n,i,r,s,o=new DataView(t),l={},u=e;while(u<e+a)28===o.getUint8(u)&&2===o.getUint8(u+1)&&(s=o.getUint8(u+2),s in b&&(r=o.getInt16(u+3),r+5,i=b[s],n=x(o,u+5,r),l.hasOwnProperty(i)?l[i]instanceof Array?l[i].push(n):l[i]=[l[i],n]:l[i]=n)),u++;return l}function _(t,e,n,i,r){var s,o,l,u=t.getUint16(n,!r),d={};for(l=0;l<u;l++)s=n+12*l+2,o=i[t.getUint16(s,!r)],!o&&a&&console.log("Unknown tag: "+t.getUint16(s,!r)),d[o]=D(t,s,e,n,r);return d}function D(t,e,a,n,i){var r,s,o,l,u,d,c=t.getUint16(e+2,!i),p=t.getUint32(e+4,!i),h=t.getUint32(e+8,!i)+a;switch(c){case 1:case 7:if(1==p)return t.getUint8(e+8,!i);for(r=p>4?h:e+8,s=[],l=0;l<p;l++)s[l]=t.getUint8(r+l);return s;case 2:return r=p>4?h:e+8,x(t,r,p-1);case 3:if(1==p)return t.getUint16(e+8,!i);for(r=p>2?h:e+8,s=[],l=0;l<p;l++)s[l]=t.getUint16(r+2*l,!i);return s;case 4:if(1==p)return t.getUint32(e+8,!i);for(s=[],l=0;l<p;l++)s[l]=t.getUint32(h+4*l,!i);return s;case 5:if(1==p)return u=t.getUint32(h,!i),d=t.getUint32(h+4,!i),o=new Number(u/d),o.numerator=u,o.denominator=d,o;for(s=[],l=0;l<p;l++)u=t.getUint32(h+8*l,!i),d=t.getUint32(h+4+8*l,!i),s[l]=new Number(u/d),s[l].numerator=u,s[l].denominator=d;return s;case 9:if(1==p)return t.getInt32(e+8,!i);for(s=[],l=0;l<p;l++)s[l]=t.getInt32(h+4*l,!i);return s;case 10:if(1==p)return t.getInt32(h,!i)/t.getInt32(h+4,!i);for(s=[],l=0;l<p;l++)s[l]=t.getInt32(h+8*l,!i)/t.getInt32(h+4+8*l,!i);return s}}function C(t,e,a){var n=t.getUint16(e,!a);return t.getUint32(e+2+12*n,!a)}function w(t,e,a,n){var i=C(t,e+a,n);if(!i)return{};if(i>t.byteLength)return{};var r=_(t,e,e+i,d,n);if(r["Compression"])switch(r["Compression"]){case 6:if(r.JpegIFOffset&&r.JpegIFByteCount){var s=e+r.JpegIFOffset,o=r.JpegIFByteCount;r["blob"]=new Blob([new Uint8Array(t.buffer,s,o)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",r["Compression"])}else 2==r["PhotometricInterpretation"]&&console.log("Thumbnail image format is RGB, which is not implemented.");return r}function x(t,e,a){var i="";for(n=e;n<e+a;n++)i+=String.fromCharCode(t.getUint8(n));return i}function k(t,e){if("Exif"!=x(t,e,4))return a&&console.log("Not valid EXIF data! "+x(t,e,4)),!1;var n,i,r,s,d,p=e+6;if(18761==t.getUint16(p))n=!1;else{if(19789!=t.getUint16(p))return a&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;n=!0}if(42!=t.getUint16(p+2,!n))return a&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var h=t.getUint32(p+4,!n);if(h<8)return a&&console.log("Not valid TIFF data! (First offset less than 8)",t.getUint32(p+4,!n)),!1;if(i=_(t,p,p+h,l,n),i.ExifIFDPointer)for(r in s=_(t,p,p+i.ExifIFDPointer,o,n),s){switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":s[r]=c[r][s[r]];break;case"ExifVersion":case"FlashpixVersion":s[r]=String.fromCharCode(s[r][0],s[r][1],s[r][2],s[r][3]);break;case"ComponentsConfiguration":s[r]=c.Components[s[r][0]]+c.Components[s[r][1]]+c.Components[s[r][2]]+c.Components[s[r][3]];break}i[r]=s[r]}if(i.GPSInfoIFDPointer)for(r in d=_(t,p,p+i.GPSInfoIFDPointer,u,n),d){switch(r){case"GPSVersionID":d[r]=d[r][0]+"."+d[r][1]+"."+d[r][2]+"."+d[r][3];break}i[r]=d[r]}return i["thumbnail"]=w(t,p,h,n),i}function S(t){if("DOMParser"in self){var e=new DataView(t);if(a&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return a&&console.log("Not a valid JPEG"),!1;var n=2,i=t.byteLength,r=new DOMParser;while(n<i-4){if("http"==x(e,n,4)){var s=n-1,o=e.getUint16(n-2)-1,l=x(e,s,o),u=l.indexOf("xmpmeta>")+8;l=l.substring(l.indexOf("<x:xmpmeta"),u);var d=l.indexOf("x:xmpmeta")+10;l=l.slice(0,d)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+l.slice(d);var c=r.parseFromString(l,"text/xml");return E(c)}n++}}}function A(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var a=0;a<t.attributes.length;a++){var n=t.attributes.item(a);e["@attributes"][n.nodeName]=n.nodeValue}}}else if(3==t.nodeType)return t.nodeValue;if(t.hasChildNodes())for(var i=0;i<t.childNodes.length;i++){var r=t.childNodes.item(i),s=r.nodeName;if(null==e[s])e[s]=A(r);else{if(null==e[s].push){var o=e[s];e[s]=[],e[s].push(o)}e[s].push(A(r))}}return e}function E(t){try{var e={};if(t.children.length>0)for(var a=0;a<t.children.length;a++){var n=t.children.item(a),i=n.attributes;for(var r in i){var s=i[r],o=s.nodeName,l=s.nodeValue;void 0!==o&&(e[o]=l)}var u=n.nodeName;if("undefined"==typeof e[u])e[u]=A(n);else{if("undefined"==typeof e[u].push){var d=e[u];e[u]=[],e[u].push(d)}e[u].push(A(n))}}else e=t.textContent;return e}catch(c){console.log(c.message)}}s.enableXmp=function(){s.isXmpEnabled=!0},s.disableXmp=function(){s.isXmpEnabled=!1},s.getData=function(t,e){return!((self.Image&&t instanceof self.Image||self.HTMLImageElement&&t instanceof self.HTMLImageElement)&&!t.complete)&&(p(t)?e&&e.call(t):f(t,e),!0)},s.getTag=function(t,e){if(p(t))return t.exifdata[e]},s.getIptcTag=function(t,e){if(p(t))return t.iptcdata[e]},s.getAllTags=function(t){if(!p(t))return{};var e,a=t.exifdata,n={};for(e in a)a.hasOwnProperty(e)&&(n[e]=a[e]);return n},s.getAllIptcTags=function(t){if(!p(t))return{};var e,a=t.iptcdata,n={};for(e in a)a.hasOwnProperty(e)&&(n[e]=a[e]);return n},s.pretty=function(t){if(!p(t))return"";var e,a=t.exifdata,n="";for(e in a)a.hasOwnProperty(e)&&("object"==typeof a[e]?a[e]instanceof Number?n+=e+" : "+a[e]+" ["+a[e].numerator+"/"+a[e].denominator+"]\r\n":n+=e+" : ["+a[e].length+" values]\r\n":n+=e+" : "+a[e]+"\r\n");return n},s.readFromBinaryFile=function(t){return m(t)},i=[],r=function(){return s}.apply(e,i),void 0===r||(t.exports=r)}).call(this)},"57eb":function(t,e,a){},"58d8":function(t,e,a){var n=a("0c3c"),i=a("3553"),r=a("692f"),s=a("d88d"),o=function(t){return function(e,a,o,l){n(a);var u=i(e),d=r(u),c=s(u.length),p=t?c-1:0,h=t?-1:1;if(o<2)while(1){if(p in d){l=d[p],p+=h;break}if(p+=h,t?p<0:c<=p)throw TypeError("Reduce of empty array with no initial value")}for(;t?p>=0:c>p;p+=h)p in d&&(l=a(l,d[p],p,u));return l}};t.exports={left:o(!1),right:o(!0)}},"599e":function(t,e,a){"use strict";e["a"]={data:function(){return{mixStyleColor:"#606266",mixSubmitGroup:"submit-btn",mixRequiredType:0,mixGetSealUrl:"signInfo",mixDInputLinkText:!1,mixNewRetableColor:!1}},methods:{mixGetSealPostData:function(t){return t}}}},"5a9e":function(t,e,a){"use strict";var n,i=a("d77f"),r=a("1e2c"),s=a("d890"),o=a("a719"),l=a("faa8"),u=a("2a91"),d=a("0fc1"),c=a("1944"),p=a("d910").f,h=a("908e"),g=a("50fb"),f=a("90fb"),m=a("7e8b"),v=s.Int8Array,b=v&&v.prototype,y=s.Uint8ClampedArray,_=y&&y.prototype,D=v&&h(v),C=b&&h(b),w=Object.prototype,x=w.isPrototypeOf,k=f("toStringTag"),S=m("TYPED_ARRAY_TAG"),A=i&&!!g&&"Opera"!==u(s.opera),E=!1,T={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},I=function(t){var e=u(t);return"DataView"===e||l(T,e)},P=function(t){return o(t)&&l(T,u(t))},N=function(t){if(P(t))return t;throw TypeError("Target is not a typed array")},R=function(t){if(g){if(x.call(D,t))return t}else for(var e in T)if(l(T,n)){var a=s[e];if(a&&(t===a||x.call(a,t)))return t}throw TypeError("Target is not a typed array constructor")},B=function(t,e,a){if(r){if(a)for(var n in T){var i=s[n];i&&l(i.prototype,t)&&delete i.prototype[t]}C[t]&&!a||c(C,t,a?e:A&&b[t]||e)}},O=function(t,e,a){var n,i;if(r){if(g){if(a)for(n in T)i=s[n],i&&l(i,t)&&delete i[t];if(D[t]&&!a)return;try{return c(D,t,a?e:A&&v[t]||e)}catch(o){}}for(n in T)i=s[n],!i||i[t]&&!a||c(i,t,e)}};for(n in T)s[n]||(A=!1);if((!A||"function"!=typeof D||D===Function.prototype)&&(D=function(){throw TypeError("Incorrect invocation")},A))for(n in T)s[n]&&g(s[n],D);if((!A||!C||C===w)&&(C=D.prototype,A))for(n in T)s[n]&&g(s[n].prototype,C);if(A&&h(_)!==C&&g(_,C),r&&!l(C,k))for(n in E=!0,p(C,k,{get:function(){return o(this)?this[S]:void 0}}),T)s[n]&&d(s[n],S,n);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:A,TYPED_ARRAY_TAG:E&&S,aTypedArray:N,aTypedArrayConstructor:R,exportTypedArrayMethod:B,exportTypedArrayStaticMethod:O,isView:I,isTypedArray:P,TypedArray:D,TypedArrayPrototype:C}},"5c03":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=function t(e,a,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,a);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,a,n)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(n):void 0},r=a("6181"),s=o(r);function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function d(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=function(t){var e=t.substr(0,7).split("").map((function(t){return+t})).reduce((function(t,e,a){return a%2?t+e:t+3*e}),0);return(10-e%10)%10},p=function(t){function e(t,a){return l(this,e),-1!==t.search(/^[0-9]{7}$/)&&(t+=c(t)),u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a))}return d(e,t),n(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{8}$/)&&+this.data[7]===c(this.data)}},{key:"leftText",value:function(){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var t=this.data.substr(0,4);return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,"LLLL")}},{key:"rightText",value:function(){return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var t=this.data.substr(4,4);return i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRR")}}]),e}(s.default);e.default=p},"5cda":function(t,e,a){"use strict";var n=a("6125"),i=a.n(n);i.a},6125:function(t,e,a){},6153:function(t,e,a){"use strict";var n=a("d432"),i=a.n(n);i.a},6176:function(t,e,a){var n=a("3da3");t.exports=function(t){var e=n(t);if(e<0)throw RangeError("The argument can't be less than 0");return e}},6181:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("25cd"),r=a("bdd1"),s=u(r),o=a("2986"),l=u(o);function u(t){return t&&t.__esModule?t:{default:t}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function p(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=function(t){function e(t,a){d(this,e);var n=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a));return n.fontSize=!a.flat&&a.fontSize>10*a.width?10*a.width:a.fontSize,n.guardHeight=a.height+n.fontSize/2+a.textMargin,n}return p(e,t),n(e,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(t,e){return this.text.substr(t,e)}},{key:"leftEncode",value:function(t,e){return(0,s.default)(t,e)}},{key:"rightText",value:function(t,e){return this.text.substr(t,e)}},{key:"rightEncode",value:function(t,e){return(0,s.default)(t,e)}},{key:"encodeGuarded",value:function(){var t={fontSize:this.fontSize},e={height:this.guardHeight};return[{data:i.SIDE_BIN,options:e},{data:this.leftEncode(),text:this.leftText(),options:t},{data:i.MIDDLE_BIN,options:e},{data:this.rightEncode(),text:this.rightText(),options:t},{data:i.SIDE_BIN,options:e}]}},{key:"encodeFlat",value:function(){var t=[i.SIDE_BIN,this.leftEncode(),i.MIDDLE_BIN,this.rightEncode(),i.SIDE_BIN];return{data:t.join(""),text:this.text}}}]),e}(l.default);e.default=h},"61b1":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("a92b"),i=o(n),r=a("7fef"),s=o(r);function o(t){return t&&t.__esModule?t:{default:t}}function l(t){var e={};for(var a in s.default)s.default.hasOwnProperty(a)&&(t.hasAttribute("jsbarcode-"+a.toLowerCase())&&(e[a]=t.getAttribute("jsbarcode-"+a.toLowerCase())),t.hasAttribute("data-"+a.toLowerCase())&&(e[a]=t.getAttribute("data-"+a.toLowerCase())));return e["value"]=t.getAttribute("jsbarcode-value")||t.getAttribute("data-value"),e=(0,i.default)(e),e}e.default=l},"62da":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.sendData&&"dOneInput"==t.sendData.type?a("dOneInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dIntegerInput"==t.sendData.type?a("dIntegerInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dNumericInput"==t.sendData.type?a("dNumericInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dmultiText"==t.sendData.type?a("dmultiText",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dmultiInputs"==t.sendData.type?a("dmultiInputs",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dSelect"==t.sendData.type?a("dSelect",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSelectV2"==t.sendData.type?a("dSelectV2",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRadio"==t.sendData.type?a("dRadio",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dCheckbox"==t.sendData.type?a("dCheckbox",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dInput"==t.sendData.type?a("dInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dImage"==t.sendData.type?a("dImage",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dXImage"==t.sendData.type?a("dXImage",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dUser"==t.sendData.type?a("dUser",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCountry"==t.sendData.type?a("dCountry",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCountryV2"==t.sendData.type?a("dCountryV2",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dUserSearch"==t.sendData.type?a("dUserSearch",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dMultiple"==t.sendData.type?a("dMultiple",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dOpinion"==t.sendData.type?a("dOpinion",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCalendar"==t.sendData.type?a("dCalendar",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dLink"==t.sendData.type?a("dLink",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dAvatar"==t.sendData.type?a("dAvatar",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dFile"==t.sendData.type?a("dFile",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dDepart"==t.sendData.type?a("dDepart",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dJoinSign"==t.sendData.type?a("dJoinSign",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dProjectNumber"==t.sendData.type?a("dProjectNumber",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dPasswd"==t.sendData.type?a("dPasswd",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dRepeatTable"==t.sendData.type?a("dRepeatTable",{attrs:{rtupdateInfo:t.rtupdateInfo,plugin:t.plugin,pluginData:t.sendData,forminfo:t.forminfo},on:{rtsendmessage:t.rtpostMessage,sendmessage:t.postMessage}}):t.sendData&&"dSeal"==t.sendData.type?a("dSeal",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dHandSignature"==t.sendData.type?a("dHandSignature",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dBinding"==t.sendData.type?a("dBinding",{attrs:{pluginData:t.sendData,plugin:t.plugin,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dQuote"==t.sendData.type?a("dQuote",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCount"==t.sendData.type?a("dCount",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRegion"==t.sendData.type?a("dRegion",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dQrcode"==t.sendData.type?a("dQrcode",{attrs:{forminfo:t.forminfo,pluginData:t.sendData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dShowHide"==t.sendData.type?a("dShowHide",{attrs:{forminfo:t.forminfo,pluginData:t.sendData,plugin:t.plugin},on:{ptablesendmessage:t.ptablesendmessage,sendmessage:t.postMessage}}):t.sendData&&"dPayment"==t.sendData.type?a("dPayment",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,pluginData:t.sendData,plugin:t.plugin,forminfo:t.forminfo},on:{ptablesendmessage:t.ptablesendmessage,sendmessage:t.postMessage}}):t.sendData&&"dDataSource"==t.sendData.type?a("dDataSource",{attrs:{forminfo:t.forminfo,pluginData:t.sendData,plugin:t.plugin},on:{ptablesendmessage:t.ptablesendmessage,sendmessage:t.postMessage}}):t.sendData&&"dSync"==t.sendData.type?a("dSync",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dShow"==t.sendData.type?a("dShow",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dValidate"==t.sendData.type?a("dValidate",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dAlert"==t.sendData.type?a("dAlert",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage,ptablesendmessage:t.ptablesendmessage}}):t.sendData&&"dSerial"==t.sendData.type?a("dSerial",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dChildTable"==t.sendData.type?a("dChildTable",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dConversion"==t.sendData.type?a("dConversion",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRichText"==t.sendData.type?a("dRichText",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSubmit"==t.sendData.type?a("dSubmit",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRoom"==t.sendData.type?a("dRoom",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dVariate"==t.sendData.type?a("dVariate",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e()},i=[],r=a("e793"),s=a("2744"),o={name:"allPlugin",components:Object(r["a"])({},s["a"]),props:["sendmessage","watchmessage","sendrtmessage","rtupdateInfo","plugin","tablesendmessage","forminfo","pluginUpdateInfo"],data:function(){return{sendData:null}},watch:{watchmessage:function(t){this.sendData=t}},methods:{postMessage:function(t){this.$emit("sendmessage",t)},rtpostMessage:function(t){this.$emit("sendrtmessage",t)},ptablesendmessage:function(t){this.$emit("tablesendmessage",t)}},mounted:function(){this.sendData=this.watchmessage}},l=o,u=a("9ca4"),d=Object(u["a"])(l,n,i,!1,null,null,null);e["a"]=d.exports},6656:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("25cd"),r=a("bdd1"),s=u(r),o=a("2986"),l=u(o);function u(t){return t&&t.__esModule?t:{default:t}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function p(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=function(t){function e(t,a){return d(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a))}return p(e,t),n(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{2}$/)}},{key:"encode",value:function(){var t=i.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,s.default)(this.data,t,"01"),text:this.text}}}]),e}(l.default);e.default=h},"69c6":function(t,e,a){"use strict";a("fe59"),a("b130"),a("90aa"),a("08ba");e["a"]={addBorder:function(){this.setBorderStyle("solid"),this.setHistory("addBorder")},removeBorder:function(){this.setBorderStyle("dashed"),this.setHistory("removeBorder")},removeCenterBorder:function(){if(!this.selectData.selectIds.length)return!1;var t=this.getTableData(this.selectData.tableid),e=[],a=this;t.trs.forEach((function(t,n){var i=[];t.tds.forEach((function(t,e){a.selectData.selectIds.includes(t.id)&&0!==t.clospan&&0!==t.rowspan&&i.push(t)})),i.length&&e.push(i)})),e.forEach((function(t,a){t.forEach((function(n,i){n.style.borderStyle=void 0,n.style.borderTopStyle=0==a?"solid":"dashed",a==e.length-1?n.style.borderBottomStyle="solid":n.style.borderBottomStyle="dashed",n.style.borderLeftStyle=0==i?"solid":"dashed",i==t.length-1?n.style.borderRightStyle="solid":n.style.borderRightStyle="dashed"}))})),this.changeBorderCollapse(t.id),this.removeSelect()},setBorderStyle:function(t){if(!this.selectData.selectIds.length)return!1;var e=this.getTableData(this.selectData.tableid),a=this;e.trs.forEach((function(e,n){e.tds.forEach((function(e,n){a.selectData.selectIds.includes(e.id)&&(e.style.borderStyle=t,e.style.borderTopStyle=void 0,e.style.borderBottomStyle=void 0,e.style.borderLeftStyle=void 0,e.style.borderRightStyle=void 0)}))})),this.changeBorderCollapse(e.id),this.removeSelect()}}},"6a58":function(t,e,a){"use strict";(function(e){var n=a("5186"),i=a("0720"),r=a("3b1c"),s=document,o=s.documentElement;function l(t,e){var a,l,p,_,C,x,k,S,A,E,T,I=arguments.length;1===I&&!1===Array.isArray(t)&&(e=t,t=[]);var P,N=null,R=e||{};void 0===R.moves&&(R.moves=f),void 0===R.accepts&&(R.accepts=f),void 0===R.invalid&&(R.invalid=G),void 0===R.containers&&(R.containers=t||[]),void 0===R.isContainer&&(R.isContainer=g),void 0===R.copy&&(R.copy=!1),void 0===R.copySortSource&&(R.copySortSource=!1),void 0===R.revertOnSpill&&(R.revertOnSpill=!1),void 0===R.removeOnSpill&&(R.removeOnSpill=!1),void 0===R.direction&&(R.direction="vertical"),void 0===R.ignoreInputTextSelection&&(R.ignoreInputTextSelection=!0),void 0===R.mirrorContainer&&(R.mirrorContainer=s.body);var B=n({containers:R.containers,start:V,end:K,cancel:Q,remove:Z,destroy:F,canMove:z,dragging:!1});return!0===R.removeOnSpill&&B.on("over",it).on("out",rt),M(),B;function O(t){return-1!==B.containers.indexOf(t)||R.isContainer(t)}function M(t){var e=t?"remove":"add";u(o,e,"mousedown",H),u(o,e,"mouseup",Y)}function L(t){var e=t?"remove":"add";u(o,e,"mousemove",j)}function U(t){var e=t?"remove":"add";i[e](o,"selectstart",$),i[e](o,"click",$)}function F(){M(!0),Y({})}function $(t){P&&t.preventDefault()}function H(t){x=t.clientX,k=t.clientY;var e=1!==d(t)||t.metaKey||t.ctrlKey;if(!e){var a=t.target,n=W(a);n&&(P=n,L(),"mousedown"===t.type&&(y(a)?a.focus():t.preventDefault()))}}function j(t){if(P)if(0!==d(t)){if(void 0===t.clientX||t.clientX!==x||void 0===t.clientY||t.clientY!==k){if(R.ignoreInputTextSelection){var e=w("clientX",t),a=w("clientY",t),n=s.elementFromPoint(e,a);if(y(n))return}var i=P;L(!0),U(),K(),q(i);var o=c(p);_=w("pageX",t)-o.left,C=w("pageY",t)-o.top,r.add(E||p,"gu-transit"),st(),nt(t)}}else Y({})}function W(t){if((!B.dragging||!a)&&!O(t)){var e=t;while(b(t)&&!1===O(b(t))){if(R.invalid(t,e))return;if(t=b(t),!t)return}var n=b(t);if(n&&!R.invalid(t,e)){var i=R.moves(t,n,e,D(t));if(i)return{item:t,source:n}}}}function z(t){return!!W(t)}function V(t){var e=W(t);e&&q(e)}function q(t){dt(t.item,t.source)&&(E=t.item.cloneNode(!0),B.emit("cloned",E,t.item,"copy")),l=t.source,p=t.item,S=A=D(t.item),B.dragging=!0,B.emit("drag",p,l)}function G(){return!1}function K(){if(B.dragging){var t=E||p;J(t,b(t))}}function X(){P=!1,L(!0),U(!0)}function Y(t){if(X(),B.dragging){var e=E||p,n=w("clientX",t),i=w("clientY",t),r=h(a,n,i),s=at(r,n,i);s&&(E&&R.copySortSource||!E||s!==l)?J(e,s):R.removeOnSpill?Z():Q()}}function J(t,e){var a=b(t);E&&R.copySortSource&&e===l&&a.removeChild(p),et(e)?B.emit("cancel",t,l,l):B.emit("drop",t,e,l,A),tt()}function Z(){if(B.dragging){var t=E||p,e=b(t);e&&e.removeChild(t),B.emit(E?"cancel":"remove",t,e,l),tt()}}function Q(t){if(B.dragging){var e=arguments.length>0?t:R.revertOnSpill,a=E||p,n=b(a),i=et(n);!1===i&&e&&(E?n&&n.removeChild(E):l.insertBefore(a,S)),i||e?B.emit("cancel",a,l,l):B.emit("drop",a,n,l,A),tt()}}function tt(){var t=E||p;X(),ot(),t&&r.rm(t,"gu-transit"),T&&clearTimeout(T),B.dragging=!1,N&&B.emit("out",t,N,l),B.emit("dragend",t),l=p=E=S=A=T=N=null}function et(t,e){var n;return n=void 0!==e?e:a?A:D(E||p),t===l&&n===S}function at(t,e,a){var n=t;while(n&&!i())n=b(n);return n;function i(){var i=O(n);if(!1===i)return!1;var r=lt(n,t),s=ut(n,r,e,a),o=et(n,s);return!!o||R.accepts(p,n,l,s)}}function nt(t){if(a){t.preventDefault();var e=w("clientX",t),n=w("clientY",t),i=e-_,r=n-C;a.style.left=i+"px",a.style.top=r+"px";var s=E||p,o=h(a,e,n),u=at(o,e,n),d=null!==u&&u!==N;(d||null===u)&&(y(),N=u,v());var c=b(s);if(u!==l||!E||R.copySortSource){var g,f=lt(u,o);if(null!==f)g=ut(u,f,e,n);else{if(!0!==R.revertOnSpill||E)return void(E&&c&&c.removeChild(s));g=S,u=l}(null===g&&d||g!==s&&g!==D(s))&&(A=g,u.insertBefore(s,g),B.emit("shadow",s,u,l))}else c&&c.removeChild(s)}function m(t){B.emit(t,s,N,l)}function v(){d&&m("over")}function y(){N&&m("out")}}function it(t){r.rm(t,"gu-hide")}function rt(t){B.dragging&&r.add(t,"gu-hide")}function st(){if(!a){var t=p.getBoundingClientRect();a=p.cloneNode(!0),a.style.width=m(t)+"px",a.style.height=v(t)+"px",r.rm(a,"gu-transit"),r.add(a,"gu-mirror"),R.mirrorContainer.appendChild(a),u(o,"add","mousemove",nt),r.add(R.mirrorContainer,"gu-unselectable"),B.emit("cloned",a,p,"mirror")}}function ot(){a&&(r.rm(R.mirrorContainer,"gu-unselectable"),u(o,"remove","mousemove",nt),b(a).removeChild(a),a=null)}function lt(t,e){var a=e;while(a!==t&&b(a)!==t)a=b(a);return a===o?null:a}function ut(t,e,a,n){var i="horizontal"===R.direction,r=e!==t?o():s();return r;function s(){var e,r,s,o=t.children.length;for(e=0;e<o;e++){if(r=t.children[e],s=r.getBoundingClientRect(),i&&s.left+s.width/2>a)return r;if(!i&&s.top+s.height/2>n)return r}return null}function o(){var t=e.getBoundingClientRect();return l(i?a>t.left+m(t)/2:n>t.top+v(t)/2)}function l(t){return t?D(e):e}}function dt(t,e){return"boolean"===typeof R.copy?R.copy:R.copy(t,e)}}function u(t,a,n,r){var s={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},o={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},l={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};e.navigator.pointerEnabled?i[a](t,o[n],r):e.navigator.msPointerEnabled?i[a](t,l[n],r):(i[a](t,s[n],r),i[a](t,n,r))}function d(t){if(void 0!==t.touches)return t.touches.length;if(void 0!==t.which&&0!==t.which)return t.which;if(void 0!==t.buttons)return t.buttons;var e=t.button;return void 0!==e?1&e?1:2&e?3:4&e?2:0:void 0}function c(t){var e=t.getBoundingClientRect();return{left:e.left+p("scrollLeft","pageXOffset"),top:e.top+p("scrollTop","pageYOffset")}}function p(t,a){return"undefined"!==typeof e[a]?e[a]:o.clientHeight?o[t]:s.body[t]}function h(t,e,a){var n,i=t||{},r=i.className;return i.className+=" gu-hide",n=s.elementFromPoint(e,a),i.className=r,n}function g(){return!1}function f(){return!0}function m(t){return t.width||t.right-t.left}function v(t){return t.height||t.bottom-t.top}function b(t){return t.parentNode===s?null:t.parentNode}function y(t){return"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||_(t)}function _(t){return!!t&&("false"!==t.contentEditable&&("true"===t.contentEditable||_(b(t))))}function D(t){return t.nextElementSibling||e();function e(){var e=t;do{e=e.nextSibling}while(e&&1!==e.nodeType);return e}}function C(t){return t.targetTouches&&t.targetTouches.length?t.targetTouches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t}function w(t,e){var a=C(e),n={pageX:"clientX",pageY:"clientY"};return t in n&&!(t in a)&&n[t]in a&&(t=n[t]),a[t]}t.exports=l}).call(this,a("532c"))},"6a61":function(t,e,a){var n=function(t){"use strict";var e,a=Object.prototype,n=a.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function l(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(N){l=function(t,e,a){return t[e]=a}}function u(t,e,a,n){var i=e&&e.prototype instanceof m?e:m,r=Object.create(i.prototype),s=new T(n||[]);return r._invoke=k(t,a,s),r}function d(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(N){return{type:"throw",arg:N}}}t.wrap=u;var c="suspendedStart",p="suspendedYield",h="executing",g="completed",f={};function m(){}function v(){}function b(){}var y={};y[r]=function(){return this};var _=Object.getPrototypeOf,D=_&&_(_(I([])));D&&D!==a&&n.call(D,r)&&(y=D);var C=b.prototype=m.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function a(i,r,s,o){var l=d(t[i],t,r);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"===typeof c&&n.call(c,"__await")?e.resolve(c.__await).then((function(t){a("next",t,s,o)}),(function(t){a("throw",t,s,o)})):e.resolve(c).then((function(t){u.value=t,s(u)}),(function(t){return a("throw",t,s,o)}))}o(l.arg)}var i;function r(t,n){function r(){return new e((function(e,i){a(t,n,e,i)}))}return i=i?i.then(r,r):r()}this._invoke=r}function k(t,e,a){var n=c;return function(i,r){if(n===h)throw new Error("Generator is already running");if(n===g){if("throw"===i)throw r;return P()}a.method=i,a.arg=r;while(1){var s=a.delegate;if(s){var o=S(s,a);if(o){if(o===f)continue;return o}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===c)throw n=g,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=h;var l=d(t,e,a);if("normal"===l.type){if(n=a.done?g:p,l.arg===f)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(n=g,a.method="throw",a.arg=l.arg)}}}function S(t,a){var n=t.iterator[a.method];if(n===e){if(a.delegate=null,"throw"===a.method){if(t.iterator["return"]&&(a.method="return",a.arg=e,S(t,a),"throw"===a.method))return f;a.method="throw",a.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var i=d(n,t.iterator,a.arg);if("throw"===i.type)return a.method="throw",a.arg=i.arg,a.delegate=null,f;var r=i.arg;return r?r.done?(a[t.resultName]=r.value,a.next=t.nextLoc,"return"!==a.method&&(a.method="next",a.arg=e),a.delegate=null,f):r:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,f)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function I(t){if(t){var a=t[r];if(a)return a.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function a(){while(++i<t.length)if(n.call(t,i))return a.value=t[i],a.done=!1,a;return a.value=e,a.done=!0,a};return s.next=s}}return{next:P}}function P(){return{value:e,done:!0}}return v.prototype=C.constructor=b,b.constructor=v,v.displayName=l(b,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,o,"GeneratorFunction")),t.prototype=Object.create(C),t},t.awrap=function(t){return{__await:t}},w(x.prototype),x.prototype[s]=function(){return this},t.AsyncIterator=x,t.async=function(e,a,n,i,r){void 0===r&&(r=Promise);var s=new x(u(e,a,n,i),r);return t.isGeneratorFunction(a)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},w(C),l(C,o,"Generator"),C[r]=function(){return this},C.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var a in t)e.push(a);return e.reverse(),function a(){while(e.length){var n=e.pop();if(n in t)return a.value=n,a.done=!1,a}return a.done=!0,a}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var a in this)"t"===a.charAt(0)&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var a=this;function i(n,i){return o.type="throw",o.arg=t,a.next=n,i&&(a.method="next",a.arg=e),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),E(a),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var n=a.completion;if("throw"===n.type){var i=n.arg;E(a)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,a,n){return this.delegate={iterator:I(t),resultName:a,nextLoc:n},"next"===this.method&&(this.arg=e),f}},t}(t.exports);try{regeneratorRuntime=n}catch(i){Function("r","regeneratorRuntime = r")(n)}},"6c22":function(t,e,a){"use strict";var n=a("087f"),i=a.n(n);i.a},"6c9f":function(t,e,a){"use strict";var n=a("7b6a"),i=a.n(n);i.a},"6f82":function(t,e,a){var n=a("3553"),i=a("d88d"),r=a("b60f"),s=a("98a9"),o=a("e349"),l=a("5a9e").aTypedArrayConstructor;t.exports=function(t){var e,a,u,d,c,p,h=n(t),g=arguments.length,f=g>1?arguments[1]:void 0,m=void 0!==f,v=r(h);if(void 0!=v&&!s(v)){c=v.call(h),p=c.next,h=[];while(!(d=p.call(c)).done)h.push(d.value)}for(m&&g>2&&(f=o(f,arguments[2],2)),a=i(h.length),u=new(l(this))(a),e=0;a>e;e++)u[e]=m?f(h[e],e):h[e];return u}},"702e":function(t,e,a){"use strict";e["a"]={data:function(){return{mixServiceLink:"/site/service",mixIndexShowRoute:"launch",mixLaunchChangeStatus:1,mixShowAddMyAppsBtn:!0,mixShowHandleNum:!0,mixStartHideBreadcrumb:!0,mixshowIndexNav:!0,mixshowIndexPercent:!0,mixStartExamineSuccessClose:!1,mixShowLookForm:!1,mixBListShowEntrust:!1,mixBNewMatterShowPrinter:!1,mixBNewMatterApplyAuth:!1,mixDetailSetHeight:!0,mixStartHideBtn:[],mixStartPCHideSubmit:[],mixStartHideBpmnTab:[],mixLeaveCountryId:[],mixAwayFixed:[],mixHideBtns:[],mixHideMDetailBtn:[],mixDaiChuLiText:[],mixShowHead:!0,mixSubjectshow:!1,mixStartWidth:1098,mixApproveStype:{marginTop:"0",paddingTop:"80px"},mixIndexLaunchStyle:{},mixRepeatSubmitText:{default:"不可重复申请"},mixMStartPreviewText:{default:"预览表单"},mixCountersigntext:{default:{btnText:"加签",already:"已加签",people:"加签人员",successAlert:"成功加签",tagText:"的加签",examineAlert:"加签完成",receiptText:"加签回执",finishText:"已加签"}},mixArchivedataCustomExport:{},mixMIndexHeigth:{},mixMExamineTabSort:[1,2,3],mixAppNow:{default:"立即申请"}}},components:{mixSupportDepartCom:{template:'\n      <span>\n        <template v-if="identity.length">\n          <span style="font-weight: 700;">服务对象:</span>\n          <span v-for="(item, index) in identity" :key="index">{{item}}\n            <span v-if="index< identity.length-1">、</span>\n          </span>\n        </template>\n      </span>\n      ',props:["identity"]},mixServiceObjectCom:{template:"<em></em>"},mixMoveTipsCom:{template:"<em></em>"},mixAgentDealCom:{template:'\n      <el-button id="toEntrust" @click ="toEntrust" plain>委托设置</el-button>\n      ',methods:{toEntrust:function(){this.$router.push({path:"/site/ucenter",query:{showroute:"committalCharge"}})}}},mixMatterLaunchTabCom:{template:'\n      <div class="list-run">\n        <ul>\n          <li @click="handleStatus(0)" :class="{backBlueB: changeStatus==\'0\'}">全部</li>\n          <li @click="handleStatus(1)" :class="{backBlueB: changeStatus==\'1\'}">\n            进行中\n            <span v-if="processNum != 0">{{processNum.length > 2 ? \'...\' : processNum}}</span>\n          </li>\n          <li @click="handleStatus(2)" :class="{backBlueB: changeStatus==\'2\'}">已完成</li>\n          <li @click="handleStatus(3)" :class="{backBlueB: changeStatus==\'3\'}">已撤销</li>\n          <li @click="handleStatus(4)" :class="{backBlueB: changeStatus==\'4\'}">草稿</li>\n        </ul>\n      </div>\n      ',props:["changeStatus","processNum"],methods:{handleStatus:function(t){this.$emit("handleStatus",t)}}},mixthirdMatterLogoCom:{template:"\n      <img :src=\"appConfig.staticUrl + 'img/third.jpg'\" alt />\n      "},mixMatterLogoCom:{template:'\n      <img :src="data.logo" alt />\n      ',props:["data"]},mixMatterTodoTabCom:{template:'\n      <div class="list-run">\n        <ul>\n          <li @click="handleStatus(0)" :class="{backBlueB:changeStatus==\'0\'}">\n            全部\n          </li>\n          <li @click="handleStatus(1)" :class="{backBlueB:changeStatus==\'1\'}">\n            待处理\n            <span v-if="pendingTotal != 0">{{pendingTotal.length > 2 ? \'...\' : pendingTotal}}</span>\n          </li>\n          <li @click="handleStatus(3)" :class="{backBlueB:changeStatus==\'3\'}">\n            已处理\n          </li>\n          <li v-if="batchApps.length" @click="handleStatus(4)" :class="{backBlueB:changeStatus==\'4\'}">\n            批量处理\n          </li>\t\t\t\t\n        </ul>\n      </div>\n      ',props:["changeStatus","pendingTotal","batchApps"],methods:{handleStatus:function(t){this.$emit("handleStatus",t)}}},mixTodoThirdToCom:{template:"\n      <a\n        :href=\"data.thirdparty_form_url_view\"\n        target=\"_blank\"\n      >{{data.task_status == 0 || data.task_status == 1 ? '处理事项' : '查看表单'}}</a>\n      ",props:["data"]},mixMatterMDetailCom:{template:'\n      <ul v-else>\n        <li class="appname">{{detail.name}}</li>\n        <li>\n          <span>已办理{{detail.times}}人</span>&nbsp;&nbsp;&nbsp;\n          <span>累计访问{{detail.views}}人</span>\n        </li>\n        <li v-if="detail.depart && detail.depart.length">\n          <span>服务部门：</span>\n          &nbsp;\n          <span class="appdepart">{{detail.depart.join(\'；\')}}</span>\n        </li>\n        <li>\n          <span>起始时间：</span>\n          &nbsp;\n          <span\n            class="apptime"\n          >{{detail.during_lower == null?\'无限制\':detail.during_lower}}</span>\n        </li>\n      </ul>\n      ',props:["detail"]},mixMLaunchNavCom:{template:'\n      <ul class="launchList_nav">\n        <li @click="changeStatus(0)" :class="{active:status==0}">\n          全部\n        </li>\n        <li @click="changeStatus(1)" :class="{active:status==1}">\n          进行中\n          <span v-if="processNum!=0">{{processNum}}</span>\n        </li>\n        <li @click="changeStatus(2)" :class="{active:status==2}">\n          已完成\n        </li>\n        <li @click="changeStatus(3)" :class="{active:status==3}">\n          已撤销\n        </li>\n        <li @click="changeStatus(4)" :class="{active:status==4}">\n          草稿\n        </li>\n      </ul>\n      ',props:["processNum","status"],methods:{changeStatus:function(t){this.$emit("changeStatus",t)}}},mixMIndexLaunchNavCom:{template:'\n      <div v-else class="myNotify_classify">\n        <ul style="padding: 0 0.3rem;">\n          <li @click="changeStatus(0)" :class="{active:status==0}">\n            全部\n          </li>\n          <li @click="changeStatus(1)" :class="{active:status==1}">\n            进行中\n          </li>\n          <li @click="changeStatus(2)" :class="{active:status==2}">\n            已完成\n          </li>\n          <li @click="changeStatus(3)" :class="{active:status==3}">\n            已撤销\n          </li>\n          <li @click="changeStatus(4)" :class="{active:status==4}">\n            草稿\n          </li>\n        </ul>\n      </div>\n      ',props:["processNum","status"],methods:{changeStatus:function(t){this.$emit("changeStatus",t)}}},mixMTodoToExamineBtnCom:{template:"\n      <button :class=\"item.task_status == 0 || item.task_status == 1 ? 'examine' : 'see'\" @click=\"toexamine\">\n        {{item.task_status == 0 || item.task_status == 1 ? '处理事项' : '查看表单'}}\n      </button>\n      ",props:["item"],methods:{toexamine:function(){this.$emit("toexamine")}}}},methods:{mixGetConfig:function(t,e){return this[t]&&this[t][e]?this[t][e]:this[t].default},mixSetTime:function(t){return t},mixShowRepealTo:function(){this.$router.push({path:"/matter/index"})},mixShowTakeTo:function(){window.close()},mixExamineSuccessTo:function(){this.$router.push({path:"/matter/index",query:{page:"launch"==this.$route.query.type||"reject"==this.$route.query.type?"launch":this.$route.query.type,changeStatus:void 0==this.$route.query.changeStatus?"0":this.$route.query.changeStatus}})},mixRejectStepSuccessTo:function(){this.$router.push({path:"/matter/index",query:{page:"launch"==this.$route.query.type||"reject"==this.$route.query.type?"launch":this.$route.query.type,changeStatus:void 0==this.$route.query.changeStatus?"0":this.$route.query.changeStatus}})},mixStartSuccessTo:function(t){t?this.$router.push("/matter/index"):this.$router.push({path:"/matter/m_launch",query:{type:1}})},mixMExamineSuccessTo:function(t){"launch"==t?this.$router.push({path:"/matter/m_launch",query:{type:this.$route.query.changeStatus}}):this.$router.push({path:"/matter/m_index",query:{page:t,changeStatus:void 0==this.$route.query.changeStatus?"1":this.$route.query.changeStatus}})},mixViewminBottom:function(){$(".serviceApplu-main .main-middle").css("min-height",document.body.clientHeight-198+"px")}}}},"71a9":function(t,e,a){},"781b":function(t,e,a){"use strict";function n(t){var e=[];function a(t){if(Array.isArray(t))for(var n=0;n<t.length;n++)a(t[n]);else t.text=t.text||"",t.data=t.data||"",e.push(t)}return a(t),e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"78b1":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.loading,expression:"loading",modifiers:{fullscreen:!0}}],attrs:{id:"wxform"}},[n("div",{class:{top:!0,topT:!t.showclass}},[n("div",{staticClass:"W_onetop"},[t._v("\n        "+t._s(t.$t("system.m_startForm"))+"\n        "),n("p",{directives:[{name:"show",rawName:"v-show",value:t.options.length>1,expression:"options.length > 1"}]},[t._v(t._s(t.options.length))])]),t._v(" "),t.mixStartHideBpmnTab.includes(t.nowdata.id+"")||t.matterAllData.bpmn_hide_start?t._e():[1==t.matterAllData.type?n("a",{attrs:{href:"javascript:;"}},[t._v("办事流程")]):t._e()],t._v(" "),n("span",{staticClass:"line"})],2),t._v(" "),n("div",{staticClass:"forms",on:{"~click":function(e){t.oneshow=!0}}},[n("div",{style:{height:t.showclass?"0px":t.options.length>1?"150px":"100px"}}),t._v(" "),n("div",{class:t.showclass||t.options.length<=1?"toptabla":"toptabla toptablaT",on:{click:t.formfun}},[n("div",{staticClass:"toptabla_con"},[n("div",{staticClass:"formsTop_left"},[n("img",{attrs:{src:a("8530"),alt:""}}),t._v(" "),t.options[t.tableindex]?n("p",{class:t.options.length>1?"W_p":""},[t._v(t._s(t.options[t.tableindex].name))]):t._e()]),t._v(" "),t.options.length>1?n("img",{staticClass:"toptabla_img",attrs:{src:a("ae04"),alt:""}}):t._e()])]),t._v(" "),t._l(t.options,(function(e){return""!=t.value&&null!=t.sendDatas?[n("mformtable",{directives:[{name:"show",rawName:"v-show",value:e.form_id==t.value,expression:"item.form_id == value"}],attrs:{watchmessage:t.sendDatas[e.form_id]},on:{sendmessage:t.watchFormmessage}})]:t._e()})),t._v(" "),1!=t.matterAllData.type&&2!=t.matterAllData.type||t.mixHideMDetailBtn.includes(+t.nowdata.id)?t._e():n("div",{staticClass:"wxformbtn m_start_btn"},[t.mixStartHideBtn.includes(+t.nowdata.id)?t._e():[t.isMore()?n("button",{staticClass:"draftdiv active",on:{click:function(e){t.more=!0}}},[t._v("更多")]):t._e(),t._v(" "),n("div",{staticClass:"wxformbtn_center"},[t.matterAllData.hide_submit?t._e():n("button",{on:{click:function(e){return t.submitData(!0)}}},[t._v(t._s(t.submitText))])]),t._v(" "),t.matterAllData.save_draft?n("button",{staticClass:"savedraft active",on:{click:function(e){t.draftbox=!0}}},[t._v("草稿")]):t._e()]],2)],2),t._v(" "),n("div",{staticClass:"processimg",on:{mouseover:function(e){return t.getTag(e)}}},[n("img",{staticClass:"imgbtn",attrs:{src:a("0fd3"),alt:""},on:{click:t.changeimg}}),t._v(" "),n("div",{staticClass:"svg"},[n("img",{attrs:{src:t.appConfig.staticUrl+"img/svg.png",alt:""}})])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showBpmn,expression:"showBpmn"}],staticClass:"showBpmn_class",on:{mouseout:function(e){t.showBpmn=0}}},t._l(t.assignee,(function(e,i){return n("p",[1==e.sex?n("img",{staticClass:"small-head",attrs:{src:a("b06a")}}):2==e.sex?n("img",{staticClass:"small-head",attrs:{src:a("c0a0")}}):e.avatar?n("img",{staticClass:"small-head",attrs:{src:e.avatar}}):n("img",{staticClass:"small-head",attrs:{src:a("a423")}}),t._v(" "),n("span",[t._v(t._s(e.name))]),t._v(" "),n("span",[t._v(t._s(e.department))])])})),0),t._v(" "),t.draftbox?n("div",{staticClass:"draftbox"},[n("div",{staticClass:"bg"}),t._v(" "),n("ul",[n("li",{on:{click:function(e){return t.draftfun("load")}}},[t._v("载入草稿")]),t._v(" "),n("li",{on:{click:function(e){return t.draftfun("save")}}},[t._v("保存到草稿箱")]),t._v(" "),n("li",{on:{click:function(e){t.draftbox=!1}}},[t._v("取消")])])]):t._e(),t._v(" "),t.matterAllData.agent_info&&t.matterAllData.agent_info.length||t.matterAllData.self_launch?n("el-dialog",{attrs:{visible:t.showAgent,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"355px","lock-scroll":!1,center:"","custom-class":"sele_help"}},[n("div",{staticClass:"help_con"},[t.matterAllData.self_launch?[n("el-radio",{attrs:{name:"agentType",label:2},on:{change:t.agentTypeChange},model:{value:t.agentType,callback:function(e){t.agentType=e},expression:"agentType"}},[t._v("本人办理")]),t._v(" "),2==t.agentType?n("ul",{staticStyle:{"padding-left":"20px"}},t._l(t.starterDepartList,(function(e,a){return n("li",{key:a},[n("el-radio",{attrs:{label:e.depart_id,name:"starterDepartId"},model:{value:t.starterDepartId,callback:function(e){t.starterDepartId=e},expression:"starterDepartId"}},[t._v(t._s(e.depart_name))])],1)})),0):t._e(),t._v(" "),n("br")]:t._e(),t._v(" "),t.matterAllData.agent_info.length?[n("el-radio",{attrs:{name:"agentType",label:1},on:{change:t.agentTypeChange},model:{value:t.agentType,callback:function(e){t.agentType=e},expression:"agentType"}},[t._v("代理办理")]),t._v(" "),1==t.agentType?n("el-select",{attrs:{placeholder:"选择人员"},on:{change:t.getUserMyDepar},model:{value:t.agentUid,callback:function(e){t.agentUid=e},expression:"agentUid"}},t._l(t.matterAllData.agent_info,(function(t){return n("el-option",{key:t.uid,attrs:{label:t.name,value:t.uid}})})),1):t._e(),t._v(" "),1==t.agentType?n("ul",{staticStyle:{"padding-left":"20px"}},t._l(t.starterDepartList,(function(e,a){return n("li",{key:a},[n("el-radio",{attrs:{label:e.depart_id,name:"starterDepartId"},model:{value:t.starterDepartId,callback:function(e){t.starterDepartId=e},expression:"starterDepartId"}},[t._v(t._s(e.depart_name))])],1)})),0):t._e()]:t._e(),t._v(" "),n("div",{staticClass:"help_btn"},[n("a",{attrs:{href:"javascript:;"},on:{click:t.setAgent}},[t._v("确定")])])],2)]):t._e(),t._v(" "),t.showPcforms?n("showPcform",{attrs:{instid:0,forms:t.options,appid:t.nowdata.id,matterType:t.matterAllData.type,status:"start"},on:{setinfo:t.setPcform}}):t._e(),t._v(" "),t.showSelectEx?n("nextNode",{on:{setinfo:t.submitExUser}}):t._e(),t._v(" "),n("childTable"),t._v(" "),t.yforms.length&&t.mixShowLookForm?[n("img",{staticClass:"yanshiicon",attrs:{src:t.appConfig.staticUrl+"images/icon.png"},on:{click:function(e){return t.showYforms(!0)}}}),t._v(" "),n("router-link",{attrs:{to:"/site/m_index"}},[n("img",{staticClass:"tohome",attrs:{src:t.appConfig.staticUrl+"images/tohome.jpg"}})]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isshowYforms,expression:"isshowYforms"}],staticClass:"preview_forms"},[n("div",{staticClass:"yforms"},[n("i",{staticClass:"el-icon-circle-close",on:{click:function(e){t.isshowYforms=!1}}}),t._v(" "),t._l(t.yforms,(function(e,a){return n("div",{directives:[{name:"show",rawName:"v-show",value:a==t.activeFormIndex,expression:"index == activeFormIndex"}],staticClass:"oneform"},[n("iframe",{attrs:{src:t.appCommonH.getUrlStr(t.appConfig.baseUrl+"matter/qrcode",{appid:t.nowdata.id,formid:e.form_id,matterType:t.matterAllData.type}),frameborder:"0"}})])}))],2),t._v(" "),n("div",{staticClass:"pagebox"},[t.yforms[t.activeFormIndex-1]?n("i",{staticClass:"el-icon-d-arrow-left",on:{click:function(e){t.activeFormIndex--}}}):t._e(),t._v(" "),n("span",[t._v(t._s(t.activeFormIndex+1)+"/"+t._s(t.yforms.length))]),t._v(" "),t.yforms[t.activeFormIndex+1]?n("i",{staticClass:"el-icon-d-arrow-right",on:{click:function(e){t.activeFormIndex++}}}):t._e()])])]:t._e(),t._v(" "),!t.matterAllData.details_page||1!=t.matterAllData.times_limit&&2!=t.matterAllData.times_limit?t._e():n("el-dialog",{attrs:{visible:t.showNoUse,width:"300px",center:"","close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(e){t.showNoUse=e}}},[1==t.matterAllData.times_limit?n("div",{staticStyle:{"text-align":"center"}},[t._v("有事项正在审批，不能重复申请")]):t._e(),t._v(" "),2==t.matterAllData.times_limit?n("div",{staticStyle:{"text-align":"center"}},[t._v("不可重复申请")]):t._e(),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){return t.closefun()}}},[t._v("关闭页面")])],1)]),t._v(" "),t.formshow?n("div",{staticClass:"forms_dialog"},[n("div",{staticClass:"forms_dialog_bg"}),t._v(" "),n("ul",{staticClass:"forms_dialog_con"},[t._l(t.options,(function(e,a){return n("li",{key:a,on:{click:function(n){return t.optionsfun(e,a)}}},[t._v(t._s(e.name))])})),t._v(" "),n("li",{on:{click:function(e){t.formshow=!1}}},[t._v("取消")])],2)]):t._e(),t._v(" "),n("el-dialog",{attrs:{"custom-class":"dialog_search_user",title:"添加人员",visible:t.dialogSearchUser,width:"300px","close-on-click-modal":!1,"lock-scroll":!1,center:""},on:{"update:visible":function(e){t.dialogSearchUser=e}}},[n("el-autocomplete",{staticClass:"agent_s_u",staticStyle:{width:"100%"},attrs:{"popper-class":"agent_s_u_pop","fetch-suggestions":t.querySearchUser,placeholder:"搜索姓名",clearable:""},on:{select:t.selectAgent},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.item;return[n("div",{staticClass:"agent_s_u_pop_div",attrs:{title:a.name+"-"+a.number+"-"+a.college}},[n("span",[t._v(t._s(a.name))]),t._v(" "),n("span",{staticClass:"agent_i"},[t._v(t._s(a.number))]),t._v(" "),n("span",{staticClass:"agent_i"},[t._v(t._s(a.college))])])]}}]),model:{value:t.agentUserInit.value,callback:function(e){t.$set(t.agentUserInit,"value",e)},expression:"agentUserInit.value"}},[n("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogSearchUser=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.agentAuth}},[t._v("确 定")])],1)],1),t._v(" "),n("el-dialog",{attrs:{"custom-class":"dialog_agent_depart",visible:t.dialogAgentDepart,width:"300px","close-on-click-modal":!1,"lock-scroll":!1,center:""},on:{"update:visible":function(e){t.dialogAgentDepart=e}}},[n("p",{staticClass:"title"},[t._v("\n        请选择\n        "),n("span",[t._v(t._s(t.agentUserInit.name))]),t._v(" 申请部门\n      ")]),t._v(" "),n("ul",t._l(t.agentDepart,(function(e,a,i){return n("li",{key:i},[n("el-radio",{attrs:{label:a},model:{value:t.agentUserInit.depart_id,callback:function(e){t.$set(t.agentUserInit,"depart_id",e)},expression:"agentUserInit.depart_id"}},[t._v(t._s(e.depart_name))])],1)})),0),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogAgentDepart=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.saveAgent}},[t._v("确 定")])],1)]),t._v(" "),t.more?n("div",{staticClass:"draftbox"},[n("div",{staticClass:"bg"}),t._v(" "),n("ul",[t.matterAllData.agent_launch?n("li",{on:{click:t.showSearchUser}},[t._v("代发起 "+t._s(t.agent_info.name?"("+t.agent_info.name+")":""))]):t._e(),t._v(" "),t.matterAllData.mobile_preview?n("li",{staticClass:"draftdiv active",on:{click:function(e){t.more=!1,t.showPcforms=!0}}},[t._v(t._s(t.mixGetConfig("mixMStartPreviewText",t.nowdata.id)))]):t._e(),t._v(" "),t.customHelper.toPdfType(t.nowdata.id)>=2&&2==t.matterAllData.print_rule?n("li",{on:{click:t.toPdfType2}},[t._v("下载PDF")]):t._e(),t._v(" "),n("li",{on:{click:function(e){t.more=!1}}},[t._v("取消")])])]):t._e(),t._v(" "),n("el-dialog",{attrs:{visible:t.loadingshow,width:"80%","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.loadingshow=e}}},[n("p",{staticStyle:{"text-align":"center","margin-bottom":"30px"}},[t._v(t._s(t.downUrl?"生成成功，请下载！":"正在生成pdf，请稍候......"))]),t._v(" "),t.downUrl?n("p",{staticStyle:{"text-align":"center"}},[n("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-download"},on:{click:t.toDown}},[t._v("下载")])],1):t._e()]),t._v(" "),n("sAlert",{ref:"submite",on:{confirm:t.goonFn}})],2)},i=[],r=a("e793"),s=a("97d6"),o=a("9aec"),l=a("277e"),u=a("7ed2"),d=(a("dbb3"),a("4194"),a("fe59"),a("b130"),a("ecb4"),a("2eeb"),a("053b"),a("513c"),a("fe8a"),a("e35a"),a("90aa"),a("5e9f"),a("08ba"),a("f7f9")),c=a("9f3a"),p=a("35f4e"),h=a.n(p),g=a("e644"),f=a("1d8b"),m=(a("dc64"),a("316c")),v=a("702e"),b=a("e673"),y={data:function(){return{matterAllData:{},sendDatas:{},options:[],value:"",formIds:[],formData:{},formAuth:{},nowdata:{id:0,node_id:0,bpmn_id:0},str:0,saveFormIds:[],saveFormDatas:{},submitText:this.$t("system.taskSubmitBtn"),showBpmn:0,assignee:[],appSaveId:"",appSaveFormId:0,appSavePluginKey:"",pluginOrderId:"",submitLock:!1,agentType:1,agentUid:"",showAgent:!1,showSelectEx:!1,isSetOk:!0,starterDepartList:[],starterDepartId:"",agentLock:!1,isshowYforms:!1,yforms:[],activeFormIndex:0,saveOrDraft:!1,showPcforms:!1,showNoUse:!0,formshow:!1,showclass:!0,tableindex:0,draftbox:!1,calculate:!1,prompt:!1,saveshow:!1,oneshow:!1,checkout:!1,timeshow:!0,initialdata:{},dialogSearchUser:!1,dialogAgentDepart:!1,agentUserInit:{value:""},agentDepart:{},more:!1,downUrl:"",loadingshow:!1,clearBar:null,actionAlertData:{}}},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(c["d"])("form",{allplugin:function(){var t=this.$store.state.form.allplugin[this.value];return t}})),Object(c["d"])("matter",["nodeDatas","selectNodeUid","sms_send","agent_info"])),{loading:function(){return 0!==this.$store.state.form.matterLoading}}),{},{pageInfo:function(){return this.$store.state.form.tablePageInfo[this.value]}}),beforeRouteEnter:function(t,e,a){var n={};n.pluginOrderId=t.query.pluginOrderId?t.query.pluginOrderId:"",a((function(t){t.appCommonH.setVueData(t,n)}))},created:function(){var t=this;this.nowdata=this.$route.query;var e={};e.app_id=this.nowdata.id,this.nowdata.bpmn_id&&this.nowdata.test_id&&(e.bpmn_id=this.nowdata.bpmn_id,e.test_uid=this.nowdata.test_id),this.appFetch({url:"getProcessInfoNew",method:"GET",data:e},(function(e){if(0==e.e){if(t.matterAllData=e.d,t.options=e.d.form,t.value=t.options[0].form_id,$(".processimg>div").html(e.d.svg),$(document).attr("title",e.d.name),t.submitText=m["a"].setSubmitText(t),t.$nextTick((function(){$(".djs-element").each((function(t,e){$(e).data("element-id").indexOf("StartEvent")>=0&&$(e).addClass("ele_runing")})),t.initTabTaggle()})),!t.options||!t.options.length)return!1;t.options.forEach((function(e){t.formIds.push(e.form_id)})),t.matterAllData.nodes||t.getFormTip(),t.agentInit()}else t.$message.error({message:e.m})}))},mounted:function(){window.addEventListener("scroll",this.scrollPage)},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(c["c"])("form",["SET_PRIMARYUID","SET_STARTERDEPARID","REDUCE_STARTLOADING","ADD_STARTLOADING"])),Object(c["b"])("form",["toReduceStartLoading"])),Object(c["c"])("matter",["SET_NODEDATAS","SET_SELECTUIDS","SET_SMSSEND","SET_AGENT_INFO","CLEAR_AGENT_INFO"])),Object(c["b"])("matter",["clearUserSelectInfo"])),{},{showYforms:function(t){this.yforms=this.options,this.activeFormIndex=0,t&&(this.isshowYforms=!0)},postDraftdata:function(){var t=this;this.options.forEach((function(e){t.postMessage(e.form_id,{method:"heavyLoad",formData:t.formData[e.form_id]?t.formData[e.form_id]:{}})}))},changeimg:function(){this.str<360?this.str=this.str+90:this.str=90,$(".svg").css({top:0,left:0}),$(".svg").css({transform:"rotate("+this.str+"deg )"}),90==this.str?$(".svg").css({top:0,left:$(".svg").height()}):180==this.str?$(".svg").css({top:$(".svg").height(),left:$(".svg").width()}):270==this.str?$(".svg").css({top:$(".svg").width(),left:0}):$(".svg").css({top:0,left:0})},submitData:function(t,e){if(this.submitLock)return!1;var a=this.matterAllData.nodes?this.matterAllData.nodes.filter((function(t){return"StartEvent"==t.node_type}))[0].config.deal_tip:this.actionAlertData;if(e||!0!==t||!a.content){t&&(this.saveFormIds=this.appCommonH.copyObj(this.formIds),this.saveFormDatas={});var n="";if(n=!this.checkout,this.saveOrDraft=!!e,!this.saveFormIds.length)return!1;this.postMessage(this.saveFormIds.shift(),{method:"getSaveFormData",callback:"getDataCallback",isCheck:n})}else this.$refs.submite.show(a)},getDataCallback:function(t){switch(t.status){case"success":this.saveFormDatas[t.did]=t.data,this.saveFormIds.length?this.submitData(!1,this.saveOrDraft):this.saveOrDraft?this.saveDraft():this.postFormFirstData();break;case"warning":if(this.nowSelectFormId=t.did,!t.warningmsg)return!1;this.$message({dangerouslyUseHTMLString:!0,message:t.warningmsg,type:"error",showClose:!0});break}},postFormFirstData:function(){var t=this,e={app_id:this.nowdata.id,node_id:this.nowdata.node_id,form_data:this.saveFormDatas};if(this.nowdata.bpmn_id&&this.nowdata.test_id&&(e.bpmn_id=this.nowdata.bpmn_id,e.test_uid=this.nowdata.test_id),!this.appCommonH.isEmptyObj(this.selectNodeUid)||!this.appCommonH.isEmptyObj(this.sms_send)){if(!this.isSetOk)return this.showSelectEx=!0,!1;for(var a in e.special_approver=[],this.nodeDatas){var n=this.nodeDatas[a],i={node_key:n.node_key};this.selectNodeUid[n.node_key]&&(i.uids=this.selectNodeUid[n.node_key]),this.sms_send[n.node_key]&&(i.sms_send=this.sms_send[n.node_key]),e.special_approver.push(i)}}if(this.agentUid&&(e.primary_uid=this.agentUid),this.starterDepartId&&(e.starter_depart_id=this.starterDepartId),this.submitLock)return!1;this.submitLock=!0,this.submitText="提交中...",t.appFetch({url:"postFormFirstData",method:"POST",data:{data:JSON.stringify(e)}},(function(e){if(0==e.e)t.submitText="已提交",m["a"].startSuccessTips(t),t.SET_PRIMARYUID({uid:0}),t.SET_STARTERDEPARID({starterDepartId:""}),m["a"].mStartSuccessTo(t);else if(10100==e.e)t.submitLock=!1,t.submitText=m["a"].setSubmitText(t),t.selecExUser(e.d);else if(10049==e.e){t.submitLock=!1,t.submitText=m["a"].setSubmitText(t);var a=!1;for(var n in e.d)t.postMessage(n,{method:"apiValidate",errordata:e.d[n],isAlert:!a}),a||(a=!0,t.value=+n)}else t.submitLock=!1,t.submitText=m["a"].setSubmitText(t),t.$message(e.m)}),(function(e){t.submitLock=!1,t.submitText=m["a"].setSubmitText(t),t.$message("保存失败")}))},selecExUser:function(t){var e={},a={};this.isSetOk=!1,this.SET_NODEDATAS(t.nodes),this.nodeDatas.forEach((function(t){t.users&&t.users.length&&(e[t.node_key]=t.users.map((function(t){return t.uid}))),2==t.sms_permit&&(a[t.node_key]=0)})),this.SET_SELECTUIDS(e),this.SET_SMSSEND(a),this.showSelectEx=!0},checkExUser:function(){var t={};for(var e in this.nodeDatas.forEach((function(e){t[e.node_key]=e.node_name})),this.selectNodeUid)if(!this.selectNodeUid[e].length)return this.$message({type:"error",message:"请先选择"+t[e]+"节点审批人",showClose:!0}),!1;return!0},submitExUser:function(t){return t?!!this.checkExUser()&&(this.isSetOk=!0,this.showSelectEx=!1,void this.submitData(!0)):(this.showSelectEx=!1,!1)},setPcform:function(t){this.showPcforms=t},formInit:function(){var t=this;this.ADD_STARTLOADING();var e={app_id:t.nowdata.id,node_id:t.nowdata.node_id};this.nowdata.bpmn_id&&this.nowdata.test_id&&(e.bpmn_id=this.nowdata.bpmn_id,e.test_uid=this.nowdata.test_id),this.agentUid&&(e.primary_uid=this.agentUid),this.starterDepartId&&(e.starter_depart_id=this.starterDepartId),1==this.nowdata.is_draft&&(e.draft=1,e.scene="draft"),this.$route.query.draft_id&&(e.draft_id=this.$route.query.draft_id),this.appFetch({url:1==this.matterAllData.type?"gitstartInfo":"getDataByAppId",method:"GET",data:e},(function(e){if(0==e.e){if(e.d.currform=e.d.currform?e.d.currform:t.formIds,t.formData=e.d.data?e.d.data:{},t.formAuth=e.d.auth?e.d.auth:{},t.initialdata=e.d.data,t.formIds=[],t.matterAllData.form||t.matterAllData.form.length){var a=[];e.d.currform.forEach((function(e,n){var i=t.matterAllData.form.find((function(t){return+t.form_id==+e}));i&&(a.push(i),t.formIds.push(i.form_id))})),t.matterAllData.form=a,t.options=a,t.value=t.formIds[0]}t.pluginOrderId?t.getAppInfoByKey():t.postDataToForm(),setTimeout((function(){t.showYforms()}),1e3)}else t.$message("获取表单数据和权限失败");window.setTimeout((function(){t.toReduceStartLoading()}),300)}),(function(e){t.$message("获取表单数据和权限失败"),t.toReduceStartLoading()}))},loadDraft:function(){var t=this,e={app_id:t.nowdata.id,node_id:t.nowdata.node_id};this.nowdata.bpmn_id&&this.nowdata.test_id&&(e.bpmn_id=this.nowdata.bpmn_id,e.test_uid=this.nowdata.test_id),this.agentUid&&(e.primary_uid=this.agentUid),this.starterDepartId&&(e.starter_depart_id=this.starterDepartId),e.draft=1,this.appFetch({url:1==this.matterAllData.type?"gitstartInfo":"getDataByAppId",method:"GET",data:e},(function(e){0==e.e?(t.formData=e.d.data?e.d.data:{},t.postDraftdata()):t.$message("获取表单数据和权限失败")}),(function(e){t.$message("获取表单数据和权限失败")}))},postDataToForm:function(){var t=this,e=this;this.sendDatas={},setTimeout((function(){t.options.forEach((function(t){e.postMessage(t.form_id,{method:"initFormData",fid:t.form_id,appId:e.nowdata.id,matter_type:e.matterAllData.type,nodeId:e.nowdata.node_id,bpmnId:e.nowdata.bpmn_id?e.nowdata.bpmn_id:0,ispc:!1,formData:e.formData[t.form_id]?e.formData[t.form_id]:{},formAuth:e.formAuth[t.form_id]?e.formAuth[t.form_id]:{},version:t.version})}))}),300)},postMessage:function(t,e){this.$set(this.sendDatas,t,e)},watchFormmessage:function(t){t.method&&"function"==typeof this[t.method]&&this[t.method](t)},getnodedata:function(t){for(var e in this.matterAllData.nodes)if(this.matterAllData.nodes[e].node_id==t)return this.matterAllData.nodes[e].act_node_id},getTag:function(t){var e;if(this.showBpmn=0,"rect"==t.target.localName||"text"==t.target.localName||"tspan"==t.target.localName){if("rect"==t.target.localName||"text"==t.target.localName?e=t.target.parentNode.parentNode:"tspan"==t.target.localName&&(e=t.target.parentNode.parentNode.parentNode),e.getAttribute("data-element-id")&&e.getAttribute("data-element-id").indexOf(!1)){var a=this.matterAllData.nodes;for(var n in"rect"==t.target.localName&&$(t.target).hover((function(){$(t.target).css("stroke","red")}),(function(){$(t.target).css("stroke","black")})),a)if(a[n].act_node_id==e.getAttribute("data-element-id")){if(!a[n].config.is_show_deal_log||1!=a[n].config.is_show_deal_log)return;return this.showBpmn=1,void(this.assignee=a[n].assignee)}}}else this.showBpmn=0},saveAppInfoToKey:function(t){this.appSaveId=t.id,this.appSaveFormId=t.formId,this.appSavePluginKey=t.key,this.submitDataV2(!0)},submitDataV2:function(t){if(t&&(this.saveFormIds=this.appCommonH.copyObj(this.formIds),this.saveFormDatas={}),!this.saveFormIds.length)return!1;this.postMessage(this.saveFormIds.shift(),{method:"getSaveFormData",callback:"getDataCallbackV2",isCheck:!1})},getDataCallbackV2:function(t){this.saveFormDatas[t.did]=t.data,this.saveFormIds.length?this.submitDataV2(!1):this.SaveFormDatasByKey()},SaveFormDatasByKey:function(){var t=this;this.appFetch({url:"saveAppInfoByKey",method:"POST",data:{key:this.appSaveId,value:JSON.stringify(this.saveFormDatas)}},(function(e){t.toCallPlugin(0==e.e?"success":"fail")}),(function(e){t.toCallPlugin("fail")}))},getAppInfoByKey:function(){var t=this;t.appFetch({url:"getAppInfoByKey",method:"GET",data:{key:t.pluginOrderId}},(function(e){t.formData=JSON.parse(e.d),t.postDataToForm()}),(function(e){t.$message("获取表单信息失败，请刷新重试！")}))},toCallPlugin:function(t){this.postMessage(this.appSaveFormId,{method:"pluginToDoInfo",type:"saveInfo",key:this.appSavePluginKey,status:t})},agentInit:function(){this.matterAllData.agent_info=this.matterAllData.agent_info?this.matterAllData.agent_info:[],this.matterAllData.self_launch=!!this.matterAllData.self_launch&&this.matterAllData.self_launch,this.matterAllData.agent_info.length?(this.agentType=this.matterAllData.self_launch?2:1,this.showAgent=!0,2==this.agentType&&this.getUserMyDepar()):this.matterAllData.self_launch?(this.agentType=2,this.getUserMyDepar(void 0,!0)):this.setAgentUid()},setAgentUid:function(){this.$route.query.agent_uid&&+this.$route.query.agent_uid?(this.agentUserInit.id=+this.$route.query.agent_uid,this.agentUserInit.depart_id=+this.$route.query.agent_department_id,this.agentUserInit.name=this.$route.query.agent_name,this.saveAgent()):this.formInit()},getUserMyDepar:function(t,e){var a=this;this.agentLock=!1,this.appFetch({url:"getUserMyDepar",method:"get",data:{uid:t}},(function(t){0==t.e?(a.starterDepartList=t.d,Object.keys(a.starterDepartList).length&&(a.starterDepartId=a.starterDepartList[Object.keys(a.starterDepartList)[0]].depart_id),e&&(1==Object.keys(a.starterDepartList).length?(a.SET_STARTERDEPARID({starterDepartId:a.starterDepartId}),a.formInit()):Object.keys(a.starterDepartList).length>1?a.showAgent=!0:a.formInit())):a.$message.error(t.m),a.agentLock=!0}),(function(t){a.$message.error("系统错误")}))},agentTypeChange:function(t){this.agentLock=!1,this.starterDepartList=[],this.starterDepartId="",2==t?this.getUserMyDepar():1==t&&this.agentUid&&this.getUserMyDepar(this.agentUid)},setAgent:function(){if(this.agentLock){if(1==this.agentType){if(!this.agentUid)return this.$message({type:"error",message:"请先选择代理人",showClose:!0}),!1;this.SET_PRIMARYUID({uid:this.agentUid})}else 2==this.agentType&&(this.agentUid="");this.SET_STARTERDEPARID({starterDepartId:this.starterDepartId}),this.formInit(),this.showAgent=!1}},initTabTaggle:function(){$(".top>a,.top>.W_onetop").css({width:"50%"}),$(".top>.line").width("45%"),$(".top .el-input__suffix-inner").children("i").addClass("el-icon-caret-top"),$(".top .line").css({left:Number($("html").css("fontSize").replace("px",""))*(20/375)+"px"}),$(".top a,.top .W_onetop").click((function(t){$(t.currentTarget).addClass("active").siblings("a,.W_onetop").removeClass("active");var e=$(t.currentTarget).offset().left;$(t.currentTarget).siblings(".line").animate({left:e+Number($("html").css("fontSize").replace("px",""))*(20/375)+"px"},200),"办事流程"==$(".top .active").text()?$(".processimg").show().siblings("div").hide():"处理记录"==$(".top .active").text()?$(".processrecord").show().siblings("div").hide():$(".forms").show().siblings("div").hide(),$(".top").show()}))},saveDraft:function(){var t=this,e={};e=g["a"].Screening(this.saveFormDatas,this.initialdata);var a={app_id:this.nowdata.id,form_data:JSON.stringify(e)};this.nowdata.bpmn_id&&this.nowdata.test_id&&(a.bpmn_id=this.nowdata.bpmn_id,a.test_uid=this.nowdata.test_id),this.appFetch({url:this.mixLeaveCountryId.includes(+this.nowdata.id)?"leaveCountrySave":"startSaveDraft",method:"post",data:a},(function(e){if(0==e.e)if(t.prompt){var a=h()().locale("zh-cn").format("YYYY-MM-DD HH:mm:ss");t.$message.success({message:"您的数据在 ".concat(a," 已经保存"),showClose:!0})}else t.$message.success({message:"已成功保存到草稿箱",showClose:!0});else t.prompt?t.$message.error({message:"自动保存失败，请检查网络连接",showClose:!0}):t.$message.error(e.m);t.checkout=!1,t.prompt=!1}),(function(e){t.saveshow||t.prompt?t.$message.error("自动保存失败，请检查网络连接"):t.$message.error("系统错误"),t.prompt=!1,t.saveshow=!1}))},draftfun:function(t){"save"==t?(this.saveshow=!0,this.checkout=!0,this.submitData(!0,"draft")):this.loadDraft(),this.draftbox=!1},closefun:function(){this.showNoUse=!1,1==window.history.length?("undefined"===typeof WeixinJSBridge?"undefined":Object(d["a"])(WeixinJSBridge))+""!="undefined"?WeixinJSBridge.call("closeWindow"):window.close():window.history.back(-1)},formfun:function(){this.options.length<=1||(this.formshow=!0)},scrollPage:function(t){var e=$(t.target).scrollTop();this.showclass=e<50},optionsfun:function(t,e,a){this.tableindex=e,this.value=t.form_id,this.formshow=!1,document.documentElement.scrollTop=0},isMore:function(){return this.matterAllData.agent_launch||this.matterAllData.mobile_preview||this.customHelper.toPdfType(this.nowdata.id)>=2&&2==this.matterAllData.print_rule},showSearchUser:function(){this.more=!1,this.dialogSearchUser=!0,this.agentUserInit={value:""}},querySearchUser:function(t,e){this.agentUserInit={value:t},t?this.appFetch({url:"searchAgentUser",method:"get",data:{keyword:t,app_id:this.$route.query.id}},(function(t){0==t.e?(t.d.data.forEach((function(t){t.value=t.name})),e(t.d.data)):e([])}),(function(t){e([])})):e([])},selectAgent:function(t){this.agentUserInit=t},agentAuth:function(){var t=this;this.agentUserInit.id?this.appFetch({url:"agentAuth",method:"post",data:{check:1,app_id:this.nowdata.id,uid:this.agentUserInit.id}},(function(e){0==e.e?t.getAgentMyDepar():t.$message.error(e.m)}),(function(e){t.$message.error("系统错误")})):this.$message.warning("请选择人员")},getAgentMyDepar:function(){var t=this;this.appFetch({url:"getUserMyDepar",method:"get",data:{uid:this.agentUserInit.id,app_id:this.$route.query.id}},(function(e){0==e.e?(t.agentUserInit.depart_id=Object.keys(e.d)[0],Object.keys(e.d).length>1?(t.agentDepart=e.d,t.dialogAgentDepart=!0):t.saveAgent()):t.$message.error(e.m)}),(function(e){t.$message.error("系统错误")}))},saveAgent:function(){var t=this,e={agent:1,app_id:this.nowdata.id,node_id:this.nodeId};this.nowdata.bpmn_id&&this.nowdata.test_id&&(e.bpmn_id=this.nowdata.bpmn_id,e.test_uid=this.nowdata.test_id),this.evnHelper.deleteOtherUrl(),this.appFetch({url:"agentAuth",method:"post",data:{check:0,app_id:this.nowdata.id,uid:this.agentUserInit.id,department_id:this.agentUserInit.depart_id}},(function(a){t.SET_AGENT_INFO(t.appCommonH.copyObj(t.agentUserInit)),0==a.e?t.appFetch({url:"getProcessInfoNew",method:"get",data:e},(function(e){0==e.e?(t.dialogAgentDepart=!1,t.dialogSearchUser=!1,t.formInit()):t.$message.error(e.m)}),(function(e){t.$message.error("系统错误")})):t.$message.error(a.m)}),(function(e){t.$message.error("系统错误")}))},toPdfType2:function(){var t=this;this.saveDraft();var e=this.appConfig.baseUrl.replace("test.office.rlstech.cn:8883","dev-officeflow.rlstech.cn");this.downUrl="",e=e.replace("https://",this.customHelper.getConfig("toPdfHttp"));var a=this.appCommonH.getUrlStr(this.appConfig.apiBaseUrl+"/site/download/pdf",{formid:this.value,app_id:this.nowdata.id,draft:1}),n="";this.options.forEach((function(e){e.form_id==t.value&&(n=e.name)}));var i={env:this.appCommonH.getWebId(),style:{landscape:this.getPageInfo("landscape"),paper:this.getPageInfo("paper"),displayHeaderFooter:"display",preferCSSPageSize:1,headerTemplate:"<div></div>",footerTemplate:'\n\t\t\t\t\t<div style="font-family: STFangsong; margin-bottom: 0px;font-size: 16px; color: #333;text-align: center;width: 1090%; position: relative;">\n\t\t\t\t\t\t<div style="width: 100%;position: absolute; bottom: -14px;">\n\t\t\t\t\t\t\t<span class=pageNumber></span>/<span class=totalPages></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<div>',name:n},url:this.appCommonH.getUrlStr(e+"matter/qrcode",{formid:this.value,appid:this.nowdata.id,isPrintMode:1,isToPdfMode:1,matterType:this.matterAllData.type,status:"start"})},r=this;this.appFetch({url:"".concat(a),method:"POST",data:{data:JSON.stringify(i)}},(function(t){r.loadingshow=!0,r.more=!1,"object"==Object(d["a"])(t.d)?r.downUrl=r.appConfig.apiBaseUrl+"/site/download/file-download?pdfName="+t.d.pdfName+"&fileName="+t.d.fileName:r.clearBar=setInterval((function(){r.getDownUrl(t.d)}),1e3)}),(function(){r.$message.error({message:"下载失败",showClose:!1})}))},getDownUrl:function(t){var e={id:t},a=this;this.appFetch({url:"getToPdfStatus",method:"POST",data:e},(function(e){0==e.e?(a.downUrl=f["a"].getApi("downPdf")+"?id="+t,clearInterval(a.clearBar)):1==e.e||(a.loadingshow=!1,clearInterval(a.clearBar),a.$message.error({message:e.m,showClose:!1}))}),(function(){a.loadingshow=!1,clearInterval(a.clearBar),a.$message.error({message:"下载失败",showClose:!1})}))},getPageInfo:function(t,e){var a=this.pageInfo.printForm&&this.pageInfo.printForm.printPage?this.pageInfo.printForm.printPage:this.pageInfo.type;switch(t){case"landscape":return this.customHelper.getConfigId("formLandscape",this.value)?this.customHelper.getConfig("formLandscape",this.value):e?-1!==a.indexOf("横版")?"landscape":"portrait":-1!==a.indexOf("横版")?"horizontal":"vertical";case"paper":return a.replace("横版","")}return""},toDown:function(){this.loadingshow=!1,window.open(this.downUrl,"_blank")},goonFn:function(t){t&&this.submitData(1)},getFormTip:function(){var t=this;this.appFetch({method:"get",url:"getFormTip",data:{app_id:this.$route.query.id}},(function(e){0==e.e?e.d instanceof Object&&Object.keys(e.d).length&&(t.actionAlertData=e.d.form_tip):t.$message.error({message:e.m})}))}}),watch:{allplugin:function(t){var e=this;if(!this.oneshow||!this.matterAllData.save_draft)return!1;window.onbeforeunload=function(t){return t=t||window.event,t&&(t.returnValue="关闭提示"),"关闭提示"},this.calculate&&clearTimeout(this.calculate),this.calculate=setTimeout((function(){e.prompt=!0,e.checkout=!0,e.timeshow=!1,window.onbeforeunload=null,e.submitData(!0,"draft")}),2e4)}},destroyed:function(){window.removeEventListener("scroll",this.scrollPage)},beforeDestroy:function(){this.clearUserSelectInfo(),this.CLEAR_AGENT_INFO(),$(".message_box_load_data")[0]&&$(".el-message-box__wrapper")[0].click()},mixins:[v["a"],b["a"]]},_=(a("a5ee"),Object(r["a"])({name:"m_start",components:{mformtable:o["a"],nextNode:s["z"],childTable:l["a"],showPcform:u["a"],sAlert:s["C"]}},y)),D=_,C=a("9ca4"),w=Object(C["a"])(D,n,i,!1,null,null,null);e["default"]=w.exports},"7aeb":function(t,e,a){var n=a("6176");t.exports=function(t,e){var a=n(t);if(a%e)throw RangeError("Wrong offset");return a}},"7afe":function(t,e,a){(function(i,r,s){var o,l,u,d;a("b4fb"),a("dbb3"),a("4194"),a("fe59"),a("ecb4"),a("9302"),a("6ae3"),a("2eeb"),a("77ad"),a("ea69"),a("b722"),a("3e54"),a("053b"),a("1b84"),a("513c"),a("20a5"),a("fe8a"),a("e18c"),a("84c2"),a("e35a"),a("340f"),a("1c2e"),a("96db"),a("f4e3"),a("5e9f"),a("0d7a"),a("6db4"),a("fd11"),a("18af"),a("41ff"),a("8256"),a("9119"),a("d838"),a("ab6e"),a("927c"),a("3c51"),a("db0a"),a("1cc1"),a("ab0f"),a("fc6e"),a("f30b"),a("cfd1"),a("d104"),a("f74a"),a("3598"),a("b497"),a("2909"),a("a7ef"),a("b523"),a("e671"),a("4140"),a("83db"),a("829d"),a("939f"),a("1bb1"),a("c3ba"),a("08ba"),a("af86"),a("f1a9");var c=a("a1fa"),p=!0;
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */(function(a){if("object"==c(e)&&"undefined"!=typeof t&&"undefined"==typeof p)t.exports=a();else if("undefined"==typeof p)JSZipSync=a(),l=[],o=a,u="function"===typeof o?o.apply(e,l):o,void 0===u||(t.exports=u);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof r?n=r:"undefined"!=typeof $&&$.global?n=$.global:"undefined"!=typeof self&&(n=self),n.JSZipSync=a()}})((function(){return function t(e,a,n){function i(s,o){if(!a[s]){if(!e[s]){var l="function"==typeof d&&d;if(!o&&l)return d(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=a[s]={exports:{}};e[s][0].call(u.exports,(function(t){var a=e[s][1][t];return i(a||t)}),u,u.exports,t,e,a,n)}return a[s].exports}for(var r="function"==typeof d&&d,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,a){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(t,e){var a,i,r,s,o,l,u,d="",c=0;while(c<t.length)a=t.charCodeAt(c++),i=t.charCodeAt(c++),r=t.charCodeAt(c++),s=a>>2,o=(3&a)<<4|i>>4,l=(15&i)<<2|r>>6,u=63&r,isNaN(i)?l=u=64:isNaN(r)&&(u=64),d=d+n.charAt(s)+n.charAt(o)+n.charAt(l)+n.charAt(u);return d},a.decode=function(t,e){var a,i,r,s,o,l,u,d="",c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<t.length)s=n.indexOf(t.charAt(c++)),o=n.indexOf(t.charAt(c++)),l=n.indexOf(t.charAt(c++)),u=n.indexOf(t.charAt(c++)),a=s<<2|o>>4,i=(15&o)<<4|l>>2,r=(3&l)<<6|u,d+=String.fromCharCode(a),64!=l&&(d+=String.fromCharCode(i)),64!=u&&(d+=String.fromCharCode(r));return d}},{}],2:[function(t,e,a){"use strict";function n(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}n.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},e.exports=n},{}],3:[function(t,e,a){"use strict";a.STORE={magic:"\0\0",compress:function(t){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},a.DEFLATE=t("./flate")},{"./flate":8}],4:[function(t,e,a){"use strict";var n=t("./utils"),i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];e.exports=function(t,e){if("undefined"===typeof t||!t.length)return 0;var a="string"!==n.getTypeOf(t);"undefined"==typeof e&&(e=0);var r=0,s=0,o=0;e^=-1;for(var l=0,u=t.length;l<u;l++)o=a?t[l]:t.charCodeAt(l),s=255&(e^o),r=i[s],e=e>>>8^r;return-1^e}},{"./utils":21}],5:[function(t,e,a){"use strict";var n=t("./utils");function i(t){this.data=null,this.length=0,this.index=0}i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,a=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)a=(a<<8)+this.byteAt(e);return this.index+=t,a},readString:function(t){return n.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}},e.exports=i},{"./utils":21}],6:[function(t,e,a){"use strict";a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!1,a.date=null,a.compression=null,a.comment=null},{}],7:[function(t,e,a){"use strict";var n=t("./utils");a.string2binary=function(t){return n.string2binary(t)},a.string2Uint8Array=function(t){return n.transformTo("uint8array",t)},a.uint8Array2String=function(t){return n.transformTo("string",t)},a.string2Blob=function(t){var e=n.transformTo("arraybuffer",t);return n.arrayBuffer2Blob(e)},a.arrayBuffer2Blob=function(t){return n.arrayBuffer2Blob(t)},a.transformTo=function(t,e){return n.transformTo(t,e)},a.getTypeOf=function(t){return n.getTypeOf(t)},a.checkSupport=function(t){return n.checkSupport(t)},a.MAX_VALUE_16BITS=n.MAX_VALUE_16BITS,a.MAX_VALUE_32BITS=n.MAX_VALUE_32BITS,a.pretty=function(t){return n.pretty(t)},a.findCompression=function(t){return n.findCompression(t)},a.isRegExp=function(t){return n.isRegExp(t)}},{"./utils":21}],8:[function(t,e,a){"use strict";var n="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array,i=t("pako");a.uncompressInputType=n?"uint8array":"array",a.compressInputType=n?"uint8array":"array",a.magic="\b\0",a.compress=function(t){return i.deflateRaw(t)},a.uncompress=function(t){return i.inflateRaw(t)}},{pako:24}],9:[function(t,e,a){"use strict";var n=t("./base64");function i(t,e){if(!(this instanceof i))return new i(t,e);this.files={},this.comment=null,this.root="",t&&this.load(t,e),this.clone=function(){var t=new i;for(var e in this)"function"!==typeof this[e]&&(t[e]=this[e]);return t}}i.prototype=t("./object"),i.prototype.load=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.utils=t("./deprecatedPublicUtils"),i.base64={encode:function(t){return n.encode(t)},decode:function(t){return n.decode(t)}},i.compressions=t("./compressions"),e.exports=i},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(t,e,a){"use strict";var n=t("./base64"),i=t("./zipEntries");e.exports=function(t,e){var a,r,s,o;for(e=e||{},e.base64&&(t=n.decode(t)),r=new i(t,e),a=r.files,s=0;s<a.length;s++)o=a[s],this.file(o.fileName,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileComment.length?o.fileComment:null,createFolders:e.createFolders});return r.zipComment.length&&(this.comment=r.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(t,e,a){(function(t){"use strict";var a=function(){};if("undefined"!==typeof t){var i=!t.from;if(!i)try{t.from("foo","utf8")}catch(n){i=!0}a=i?function(e,a){return a?new t(e,a):new t(e)}:t.from.bind(t),t.alloc||(t.alloc=function(e){return new t(e)})}e.exports=function(e,n){return"number"==typeof e?t.alloc(e):a(e,n)},e.exports.test=function(e){return t.isBuffer(e)}}).call(this,"undefined"!==typeof i?i:void 0)},{}],12:[function(t,e,a){"use strict";var n=t("./uint8ArrayReader");function i(t){this.data=t,this.length=this.data.length,this.index=0}i.prototype=new n,i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./uint8ArrayReader":18}],13:[function(t,e,a){"use strict";var n=t("./support"),i=t("./utils"),r=t("./crc32"),s=t("./signature"),o=t("./defaults"),l=t("./base64"),u=t("./compressions"),d=t("./compressedObject"),c=t("./nodeBuffer"),p=t("./utf8"),h=t("./stringWriter"),g=t("./uint8ArrayWriter"),f=function(t){if(t._data instanceof d&&(t._data=t._data.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===i.getTypeOf(t._data))){var e=t._data;t._data=new Uint8Array(e.length),0!==e.length&&t._data.set(e,0)}return t._data},m=function(t){var e=f(t),a=i.getTypeOf(e);return"string"===a?!t.options.binary&&n.nodebuffer?c(e,"utf-8"):t.asBinary():e},v=function(t){var e=f(this);return null===e||"undefined"===typeof e?"":(this.options.base64&&(e=l.decode(e)),e=t&&this.options.binary?A.utf8decode(e):i.transformTo("string",e),t||this.options.binary||(e=i.transformTo("string",A.utf8encode(e))),e)},b=function(t,e,a){this.name=t,this.dir=a.dir,this.date=a.date,this.comment=a.comment,this._data=e,this.options=a,this._initialMetadata={dir:a.dir,date:a.date}};b.prototype={asText:function(){return v.call(this,!0)},asBinary:function(){return v.call(this,!1)},asNodeBuffer:function(){var t=m(this);return i.transformTo("nodebuffer",t)},asUint8Array:function(){var t=m(this);return i.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var y=function(t,e){var a,n="";for(a=0;a<e;a++)n+=String.fromCharCode(255&t),t>>>=8;return n},_=function(){var t,e,a={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&"undefined"===typeof a[e]&&(a[e]=arguments[t][e]);return a},D=function(t){return t=t||{},!0!==t.base64||null!==t.binary&&void 0!==t.binary||(t.binary=!0),t=_(t,o),t.date=t.date||new Date,null!==t.compression&&(t.compression=t.compression.toUpperCase()),t},C=function(t,e,a){var n,r=i.getTypeOf(e);if(a=D(a),a.createFolders&&(n=w(t))&&x.call(this,n,!0),a.dir||null===e||"undefined"===typeof e)a.base64=!1,a.binary=!1,e=null;else if("string"===r)a.binary&&!a.base64&&!0!==a.optimizedBinaryString&&(e=i.string2binary(e));else{if(a.base64=!1,a.binary=!0,!r&&!(e instanceof d))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===r&&(e=i.transformTo("uint8array",e))}var s=new b(t,e,a);return this.files[t]=s,s},w=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},x=function(t,e){return"/"!=t.slice(-1)&&(t+="/"),e="undefined"!==typeof e&&e,this.files[t]||C.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]},k=function(t,e){var a,n=new d;return t._data instanceof d?(n.uncompressedSize=t._data.uncompressedSize,n.crc32=t._data.crc32,0===n.uncompressedSize||t.dir?(e=u["STORE"],n.compressedContent="",n.crc32=0):t._data.compressionMethod===e.magic?n.compressedContent=t._data.getCompressedContent():(a=t._data.getContent(),n.compressedContent=e.compress(i.transformTo(e.compressInputType,a)))):(a=m(t),a&&0!==a.length&&!t.dir||(e=u["STORE"],a=""),n.uncompressedSize=a.length,n.crc32=r(a),n.compressedContent=e.compress(i.transformTo(e.compressInputType,a))),n.compressedSize=n.compressedContent.length,n.compressionMethod=e.magic,n},S=function(t,e,a,n){a.compressedContent;var o,l,u,d,c=i.transformTo("string",p.utf8encode(e.name)),h=e.comment||"",g=i.transformTo("string",p.utf8encode(h)),f=c.length!==e.name.length,m=g.length!==h.length,v=e.options,b="",_="",D="";u=e._initialMetadata.dir!==e.dir?e.dir:v.dir,d=e._initialMetadata.date!==e.date?e.date:v.date,o=d.getHours(),o<<=6,o|=d.getMinutes(),o<<=5,o|=d.getSeconds()/2,l=d.getFullYear()-1980,l<<=4,l|=d.getMonth()+1,l<<=5,l|=d.getDate(),f&&(_=y(1,1)+y(r(c),4)+c,b+="up"+y(_.length,2)+_),m&&(D=y(1,1)+y(this.crc32(g),4)+g,b+="uc"+y(D.length,2)+D);var C="";C+="\n\0",C+=f||m?"\0\b":"\0\0",C+=a.compressionMethod,C+=y(o,2),C+=y(l,2),C+=y(a.crc32,4),C+=y(a.compressedSize,4),C+=y(a.uncompressedSize,4),C+=y(c.length,2),C+=y(b.length,2);var w=s.LOCAL_FILE_HEADER+C+c+b,x=s.CENTRAL_FILE_HEADER+"\0"+C+y(g.length,2)+"\0\0\0\0"+(!0===u?"\0\0\0":"\0\0\0\0")+y(n,4)+c+b+g;return{fileRecord:w,dirRecord:x,compressedObject:a}},A={load:function(t,e){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(t){var e,a,n,i,r=[];for(e in this.files)this.files.hasOwnProperty(e)&&(n=this.files[e],i=new b(n.name,n._data,_(n.options)),a=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(a,i)&&r.push(i));return r},file:function(t,e,a){if(1===arguments.length){if(i.isRegExp(t)){var n=t;return this.filter((function(t,e){return!e.dir&&n.test(t)}))}return this.filter((function(e,a){return!a.dir&&e===t}))[0]||null}return t=this.root+t,C.call(this,t,e,a),this},folder:function(t){if(!t)return this;if(i.isRegExp(t))return this.filter((function(e,a){return a.dir&&t.test(e)}));var e=this.root+t,a=x.call(this,e),n=this.clone();return n.root=a.name,n},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!=t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var a=this.filter((function(e,a){return a.name.slice(0,t.length)===t})),n=0;n<a.length;n++)delete this.files[a[n].name];return this},generate:function(t){t=_(t||{},{base64:!0,compression:"STORE",type:"base64",comment:null}),i.checkSupport(t.type);var e,a,n=[],r=0,o=0,d=i.transformTo("string",this.utf8encode(t.comment||this.comment||""));for(var c in this.files)if(this.files.hasOwnProperty(c)){var p=this.files[c],f=p.options.compression||t.compression.toUpperCase(),m=u[f];if(!m)throw new Error(f+" is not a valid compression method !");var v=k.call(this,p,m),b=S.call(this,c,p,v,r);r+=b.fileRecord.length+v.compressedSize,o+=b.dirRecord.length,n.push(b)}var D="";D=s.CENTRAL_DIRECTORY_END+"\0\0\0\0"+y(n.length,2)+y(n.length,2)+y(o,4)+y(r,4)+y(d.length,2)+d;var C=t.type.toLowerCase();for(e="uint8array"===C||"arraybuffer"===C||"blob"===C||"nodebuffer"===C?new g(r+o+D.length):new h(r+o+D.length),a=0;a<n.length;a++)e.append(n[a].fileRecord),e.append(n[a].compressedObject.compressedContent);for(a=0;a<n.length;a++)e.append(n[a].dirRecord);e.append(D);var w=e.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return i.transformTo(t.type.toLowerCase(),w);case"blob":return i.arrayBuffer2Blob(i.transformTo("arraybuffer",w));case"base64":return t.base64?l.encode(w):w;default:return w}},crc32:function(t,e){return r(t,e)},utf8encode:function(t){return i.transformTo("string",p.utf8encode(t))},utf8decode:function(t){return p.utf8decode(t)}};e.exports=A},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(t,e,a){"use strict";a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\b"},{}],15:[function(t,e,a){"use strict";var n=t("./dataReader"),i=t("./utils");function r(t,e){this.data=t,e||(this.data=i.string2binary(this.data)),this.length=this.data.length,this.index=0}r.prototype=new n,r.prototype.byteAt=function(t){return this.data.charCodeAt(t)},r.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)},r.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.index,this.index+t);return this.index+=t,e},e.exports=r},{"./dataReader":5,"./utils":21}],16:[function(t,e,a){"use strict";var n=t("./utils"),i=function(){this.data=[]};i.prototype={append:function(t){t=n.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}},e.exports=i},{"./utils":21}],17:[function(t,e,a){(function(t){"use strict";if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8Array,a.nodebuffer="undefined"!==typeof t,a.uint8array="undefined"!==typeof Uint8Array,"undefined"===typeof ArrayBuffer)a.blob=!1;else{var e=new ArrayBuffer(0);try{a.blob=0===new Blob([e],{type:"application/zip"}).size}catch(r){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,i=new n;i.append(e),a.blob=0===i.getBlob("application/zip").size}catch(r){a.blob=!1}}}}).call(this,"undefined"!==typeof i?i:void 0)},{}],18:[function(t,e,a){"use strict";var n=t("./dataReader");function i(t){t&&(this.data=t,this.length=this.data.length,this.index=0)}i.prototype=new n,i.prototype.byteAt=function(t){return this.data[t]},i.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),a=t.charCodeAt(1),n=t.charCodeAt(2),i=t.charCodeAt(3),r=this.length-4;r>=0;--r)if(this.data[r]===e&&this.data[r+1]===a&&this.data[r+2]===n&&this.data[r+3]===i)return r;return-1},i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.index,this.index+t);return this.index+=t,e},e.exports=i},{"./dataReader":5}],19:[function(t,e,a){"use strict";var n=t("./utils"),i=function(t){this.data=new Uint8Array(t),this.index=0};i.prototype={append:function(t){0!==t.length&&(t=n.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}},e.exports=i},{"./utils":21}],20:[function(t,e,a){"use strict";for(var n=t("./utils"),i=t("./support"),r=t("./nodeBuffer"),s=new Array(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;s[254]=s[254]=1;var l=function(t){var e,a,n,r,s,o=t.length,l=0;for(r=0;r<o;r++)a=t.charCodeAt(r),55296===(64512&a)&&r+1<o&&(n=t.charCodeAt(r+1),56320===(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),r++)),l+=a<128?1:a<2048?2:a<65536?3:4;for(e=i.uint8array?new Uint8Array(l):new Array(l),s=0,r=0;s<l;r++)a=t.charCodeAt(r),55296===(64512&a)&&r+1<o&&(n=t.charCodeAt(r+1),56320===(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),r++)),a<128?e[s++]=a:a<2048?(e[s++]=192|a>>>6,e[s++]=128|63&a):a<65536?(e[s++]=224|a>>>12,e[s++]=128|a>>>6&63,e[s++]=128|63&a):(e[s++]=240|a>>>18,e[s++]=128|a>>>12&63,e[s++]=128|a>>>6&63,e[s++]=128|63&a);return e},u=function(t,e){var a;e=e||t.length,e>t.length&&(e=t.length),a=e-1;while(a>=0&&128===(192&t[a]))a--;return a<0||0===a?e:a+s[t[a]]>e?a:e},d=function(t){var e,a,i,r,o=t.length,l=new Array(2*o);for(a=0,e=0;e<o;)if(i=t[e++],i<128)l[a++]=i;else if(r=s[i],r>4)l[a++]=65533,e+=r-1;else{i&=2===r?31:3===r?15:7;while(r>1&&e<o)i=i<<6|63&t[e++],r--;r>1?l[a++]=65533:i<65536?l[a++]=i:(i-=65536,l[a++]=55296|i>>10&1023,l[a++]=56320|1023&i)}return l.length!==a&&(l.subarray?l=l.subarray(0,a):l.length=a),n.applyFromCharCode(l)};a.utf8encode=function(t){return i.nodebuffer?r(t,"utf-8"):l(t)},a.utf8decode=function(t){if(i.nodebuffer)return n.transformTo("nodebuffer",t).toString("utf-8");t=n.transformTo(i.uint8array?"uint8array":"array",t);var e=[],a=0,r=t.length,s=65536;while(a<r){var o=u(t,Math.min(a+s,r));i.uint8array?e.push(d(t.subarray(a,o))):e.push(d(t.slice(a,o))),a=o}return e.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(t,e,a){"use strict";var n=t("./support"),i=t("./compressions"),r=t("./nodeBuffer");function s(t){return t}function o(t,e){for(var a=0;a<t.length;++a)e[a]=255&t.charCodeAt(a);return e}function l(t){var e=65536,n=[],i=t.length,s=a.getTypeOf(t),o=0,l=!0;try{switch(s){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,r(0));break}}catch(u){l=!1}if(!l){for(var d="",c=0;c<t.length;c++)d+=String.fromCharCode(t[c]);return d}while(o<i&&e>1)try{"array"===s||"nodebuffer"===s?n.push(String.fromCharCode.apply(null,t.slice(o,Math.min(o+e,i)))):n.push(String.fromCharCode.apply(null,t.subarray(o,Math.min(o+e,i)))),o+=e}catch(u){e=Math.floor(e/2)}return n.join("")}function u(t,e){for(var a=0;a<t.length;a++)e[a]=t[a];return e}a.string2binary=function(t){for(var e="",a=0;a<t.length;a++)e+=String.fromCharCode(255&t.charCodeAt(a));return e},a.arrayBuffer2Blob=function(t){a.checkSupport("blob");try{return new Blob([t],{type:"application/zip"})}catch(e){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,i=new n;return i.append(t),i.getBlob("application/zip")}catch(e){throw new Error("Bug : can't construct the Blob.")}}},a.applyFromCharCode=l;var d={};d["string"]={string:s,array:function(t){return o(t,new Array(t.length))},arraybuffer:function(t){return d["string"]["uint8array"](t).buffer},uint8array:function(t){return o(t,new Uint8Array(t.length))},nodebuffer:function(t){return o(t,r(t.length))}},d["array"]={string:l,array:s,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return r(t)}},d["arraybuffer"]={string:function(t){return l(new Uint8Array(t))},array:function(t){return u(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:s,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return r(new Uint8Array(t))}},d["uint8array"]={string:l,array:function(t){return u(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:s,nodebuffer:function(t){return r(t)}},d["nodebuffer"]={string:l,array:function(t){return u(t,new Array(t.length))},arraybuffer:function(t){return d["nodebuffer"]["uint8array"](t).buffer},uint8array:function(t){return u(t,new Uint8Array(t.length))},nodebuffer:s},a.transformTo=function(t,e){if(e||(e=""),!t)return e;a.checkSupport(t);var n=a.getTypeOf(e),i=d[n][t](e);return i},a.getTypeOf=function(t){return"string"===typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":n.nodebuffer&&r.test(t)?"nodebuffer":n.uint8array&&t instanceof Uint8Array?"uint8array":n.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(t){var e=n[t.toLowerCase()];if(!e)throw new Error(t+" is not supported by this browser")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(t){var e,a,n="";for(a=0;a<(t||"").length;a++)e=t.charCodeAt(a),n+="\\x"+(e<16?"0":"")+e.toString(16).toUpperCase();return n},a.findCompression=function(t){for(var e in i)if(i.hasOwnProperty(e)&&i[e].magic===t)return i[e];return null},a.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(t,e,a){"use strict";var n=t("./stringReader"),i=t("./nodeBufferReader"),r=t("./uint8ArrayReader"),s=t("./utils"),o=t("./signature"),l=t("./zipEntry"),u=t("./support"),d=t("./object");function c(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}c.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+s.pretty(e)+", expected "+s.pretty(t)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=d.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};var t,e,a,n=this.zip64EndOfCentralSize-44,i=0;while(i<n)t=this.reader.readInt(2),e=this.reader.readInt(4),a=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:a}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8()},readCentralDir:function(){var t;this.reader.setIndex(this.centralDirOffset);while(this.reader.readString(4)===o.CENTRAL_FILE_HEADER)t=new l({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(-1===t)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(t),this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),-1===t)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(t),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(t){var e=s.getTypeOf(t);"string"!==e||u.uint8array?this.reader="nodebuffer"===e?new i(t):new r(s.transformTo("uint8array",t)):this.reader=new n(t,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=c},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(t,e,a){"use strict";var n=t("./stringReader"),i=t("./utils"),r=t("./compressedObject"),s=t("./object");function o(t,e){this.options=t,this.loadOptions=e}o.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},prepareCompressedContent:function(t,e,a){return function(){var n=t.index;t.setIndex(e);var i=t.readData(a);return t.setIndex(n),i}},prepareContent:function(t,e,a,n,r){return function(){var t=i.transformTo(n.uncompressInputType,this.getCompressedContent()),e=n.uncompress(t);if(e.length!==r)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(t){var e,a;if(t.skip(22),this.fileNameLength=t.readInt(2),a=t.readInt(2),this.fileName=t.readString(this.fileNameLength),t.skip(a),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(e=i.findCompression(this.compressionMethod),null===e)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new r,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,e),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,e,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=i.transformTo("string",this.decompressed.getContent()),s.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readString(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readString(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=new n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,a,n,i=t.index;this.extraFields=this.extraFields||{};while(t.index<i+this.extraFieldsLength)e=t.readInt(2),a=t.readInt(2),n=t.readString(a),this.extraFields[e]={id:e,length:a,value:n}},handleUTF8:function(){if(this.useUTF8())this.fileName=s.utf8decode(this.fileName),this.fileComment=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();null!==t&&(this.fileName=t);var e=this.findExtraFieldUnicodeComment();null!==e&&(this.fileComment=e)}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=new n(t.value);return 1!==e.readInt(1)||s.crc32(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=new n(t.value);return 1!==e.readInt(1)||s.crc32(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readString(t.length-5))}return null}},e.exports=o},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(t,e,a){"use strict";var n=t("./lib/utils/common").assign,i=t("./lib/deflate"),r=t("./lib/inflate"),s=t("./lib/zlib/constants"),o={};n(o,i,r,s),e.exports=o},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(t,e,a){"use strict";var n=t("./zlib/deflate.js"),i=t("./utils/common"),r=t("./utils/strings"),s=t("./zlib/messages"),o=t("./zlib/zstream"),l=0,u=4,d=0,c=1,p=-1,h=0,g=8,f=function(t){this.options=i.assign({level:p,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var a=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(a!==d)throw new Error(s[a]);e.header&&n.deflateSetHeader(this.strm,e.header)};function m(t,e){var a=new f(e);if(a.push(t,!0),a.err)throw a.msg;return a.result}function v(t,e){return e=e||{},e.raw=!0,m(t,e)}function b(t,e){return e=e||{},e.gzip=!0,m(t,e)}f.prototype.push=function(t,e){var a,s,o=this.strm,p=this.options.chunkSize;if(this.ended)return!1;s=e===~~e?e:!0===e?u:l,o.input="string"===typeof t?r.string2buf(t):t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new i.Buf8(p),o.next_out=0,o.avail_out=p),a=n.deflate(o,s),a!==c&&a!==d)return this.onEnd(a),this.ended=!0,!1;(0===o.avail_out||0===o.avail_in&&s===u)&&("string"===this.options.to?this.onData(r.buf2binstring(i.shrinkBuf(o.output,o.next_out))):this.onData(i.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&a!==c);return s!==u||(a=n.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===d)},f.prototype.onData=function(t){this.chunks.push(t)},f.prototype.onEnd=function(t){t===d&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},a.Deflate=f,a.deflate=m,a.deflateRaw=v,a.gzip=b},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(t,e,a){"use strict";var n=t("./zlib/inflate.js"),i=t("./utils/common"),r=t("./utils/strings"),s=t("./zlib/constants"),o=t("./zlib/messages"),l=t("./zlib/zstream"),u=t("./zlib/gzheader"),d=function(t){this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var a=n.inflateInit2(this.strm,e.windowBits);if(a!==s.Z_OK)throw new Error(o[a]);this.header=new u,n.inflateGetHeader(this.strm,this.header)};function c(t,e){var a=new d(e);if(a.push(t,!0),a.err)throw a.msg;return a.result}function p(t,e){return e=e||{},e.raw=!0,c(t,e)}d.prototype.push=function(t,e){var a,o,l,u,d,c=this.strm,p=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,c.input="string"===typeof t?r.binstring2buf(t):t,c.next_in=0,c.avail_in=c.input.length;do{if(0===c.avail_out&&(c.output=new i.Buf8(p),c.next_out=0,c.avail_out=p),a=n.inflate(c,s.Z_NO_FLUSH),a!==s.Z_STREAM_END&&a!==s.Z_OK)return this.onEnd(a),this.ended=!0,!1;c.next_out&&(0===c.avail_out||a===s.Z_STREAM_END||0===c.avail_in&&o===s.Z_FINISH)&&("string"===this.options.to?(l=r.utf8border(c.output,c.next_out),u=c.next_out-l,d=r.buf2string(c.output,l),c.next_out=u,c.avail_out=p-u,u&&i.arraySet(c.output,c.output,l,u,0),this.onData(d)):this.onData(i.shrinkBuf(c.output,c.next_out)))}while(c.avail_in>0&&a!==s.Z_STREAM_END);return a===s.Z_STREAM_END&&(o=s.Z_FINISH),o!==s.Z_FINISH||(a=n.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===s.Z_OK)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},a.Inflate=d,a.inflate=c,a.inflateRaw=p,a.ungzip=c},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(t,e,a){"use strict";var n="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;a.assign=function(t){var e=Array.prototype.slice.call(arguments,1);while(e.length){var a=e.shift();if(a){if("object"!==c(a))throw new TypeError(a+"must be non-object");for(var n in a)a.hasOwnProperty(n)&&(t[n]=a[n])}}return t},a.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,a,n,i){if(e.subarray&&t.subarray)t.set(e.subarray(a,a+n),i);else for(var r=0;r<n;r++)t[i+r]=e[a+r]},flattenChunks:function(t){var e,a,n,i,r,s;for(n=0,e=0,a=t.length;e<a;e++)n+=t[e].length;for(s=new Uint8Array(n),i=0,e=0,a=t.length;e<a;e++)r=t[e],s.set(r,i),i+=r.length;return s}},r={arraySet:function(t,e,a,n,i){for(var r=0;r<n;r++)t[i+r]=e[a+r]},flattenChunks:function(t){return[].concat.apply([],t)}};a.setTyped=function(t){t?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,i)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,r))},a.setTyped(n)},{}],28:[function(t,e,a){"use strict";var n=t("./common"),i=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(u){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(u){r=!1}for(var s=new n.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(t,e){if(e<65537&&(t.subarray&&r||!t.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var a="",s=0;s<e;s++)a+=String.fromCharCode(t[s]);return a}s[254]=s[254]=1,a.string2buf=function(t){var e,a,i,r,s,o=t.length,l=0;for(r=0;r<o;r++)a=t.charCodeAt(r),55296===(64512&a)&&r+1<o&&(i=t.charCodeAt(r+1),56320===(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),r++)),l+=a<128?1:a<2048?2:a<65536?3:4;for(e=new n.Buf8(l),s=0,r=0;s<l;r++)a=t.charCodeAt(r),55296===(64512&a)&&r+1<o&&(i=t.charCodeAt(r+1),56320===(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),r++)),a<128?e[s++]=a:a<2048?(e[s++]=192|a>>>6,e[s++]=128|63&a):a<65536?(e[s++]=224|a>>>12,e[s++]=128|a>>>6&63,e[s++]=128|63&a):(e[s++]=240|a>>>18,e[s++]=128|a>>>12&63,e[s++]=128|a>>>6&63,e[s++]=128|63&a);return e},a.buf2binstring=function(t){return l(t,t.length)},a.binstring2buf=function(t){for(var e=new n.Buf8(t.length),a=0,i=e.length;a<i;a++)e[a]=t.charCodeAt(a);return e},a.buf2string=function(t,e){var a,n,i,r,o=e||t.length,u=new Array(2*o);for(n=0,a=0;a<o;)if(i=t[a++],i<128)u[n++]=i;else if(r=s[i],r>4)u[n++]=65533,a+=r-1;else{i&=2===r?31:3===r?15:7;while(r>1&&a<o)i=i<<6|63&t[a++],r--;r>1?u[n++]=65533:i<65536?u[n++]=i:(i-=65536,u[n++]=55296|i>>10&1023,u[n++]=56320|1023&i)}return l(u,n)},a.utf8border=function(t,e){var a;e=e||t.length,e>t.length&&(e=t.length),a=e-1;while(a>=0&&128===(192&t[a]))a--;return a<0||0===a?e:a+s[t[a]]>e?a:e}},{"./common":27}],29:[function(t,e,a){"use strict";function n(t,e,a,n){var i=65535&t|0,r=t>>>16&65535|0,s=0;while(0!==a){s=a>2e3?2e3:a,a-=s;do{i=i+e[n++]|0,r=r+i|0}while(--s);i%=65521,r%=65521}return i|r<<16|0}e.exports=n},{}],30:[function(t,e,a){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(t,e,a){"use strict";function n(){for(var t,e=[],a=0;a<256;a++){t=a;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e}var i=n();function r(t,e,a,n){var r=i,s=n+a;t^=-1;for(var o=n;o<s;o++)t=t>>>8^r[255&(t^e[o])];return-1^t}e.exports=r},{}],32:[function(t,e,a){"use strict";var n=t("../utils/common"),i=t("./trees"),r=t("./adler32"),s=t("./crc32"),o=t("./messages"),l=0,u=1,d=3,c=4,p=5,h=0,g=1,f=-2,m=-3,v=-5,b=-1,y=1,_=2,D=3,C=4,w=0,x=2,k=8,S=9,A=15,E=8,T=29,I=256,P=I+1+T,N=30,R=19,B=2*P+1,O=15,M=3,L=258,U=L+M+1,F=32,$=42,H=69,j=73,W=91,z=103,V=113,q=666,G=1,K=2,X=3,Y=4,J=3;function Z(t,e){return t.msg=o[e],e}function Q(t){return(t<<1)-(t>4?9:0)}function tt(t){var e=t.length;while(--e>=0)t[e]=0}function et(t){var e=t.state,a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(n.arraySet(t.output,e.pending_buf,e.pending_out,a,t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))}function at(t,e){i._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,et(t.strm)}function nt(t,e){t.pending_buf[t.pending++]=e}function it(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function rt(t,e,a,i){var o=t.avail_in;return o>i&&(o=i),0===o?0:(t.avail_in-=o,n.arraySet(e,t.input,t.next_in,o,a),1===t.state.wrap?t.adler=r(t.adler,e,o,a):2===t.state.wrap&&(t.adler=s(t.adler,e,o,a)),t.next_in+=o,t.total_in+=o,o)}function st(t,e){var a,n,i=t.max_chain_length,r=t.strstart,s=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-U?t.strstart-(t.w_size-U):0,u=t.window,d=t.w_mask,c=t.prev,p=t.strstart+L,h=u[r+s-1],g=u[r+s];t.prev_length>=t.good_match&&(i>>=2),o>t.lookahead&&(o=t.lookahead);do{if(a=e,u[a+s]===g&&u[a+s-1]===h&&u[a]===u[r]&&u[++a]===u[r+1]){r+=2,a++;do{}while(u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&u[++r]===u[++a]&&r<p);if(n=L-(p-r),r=p-L,n>s){if(t.match_start=e,s=n,n>=o)break;h=u[r+s-1],g=u[r+s]}}}while((e=c[e&d])>l&&0!==--i);return s<=t.lookahead?s:t.lookahead}function ot(t){var e,a,i,r,s,o=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=o+(o-U)){n.arraySet(t.window,t.window,o,o,0),t.match_start-=o,t.strstart-=o,t.block_start-=o,a=t.hash_size,e=a;do{i=t.head[--e],t.head[e]=i>=o?i-o:0}while(--a);a=o,e=a;do{i=t.prev[--e],t.prev[e]=i>=o?i-o:0}while(--a);r+=o}if(0===t.strm.avail_in)break;if(a=rt(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=a,t.lookahead+t.insert>=M){s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+1])&t.hash_mask;while(t.insert)if(t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+M-1])&t.hash_mask,t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,t.lookahead+t.insert<M)break}}while(t.lookahead<U&&0!==t.strm.avail_in)}function lt(t,e){var a=65535;for(a>t.pending_buf_size-5&&(a=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ot(t),0===t.lookahead&&e===l)return G;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+a;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,at(t,!1),0===t.strm.avail_out))return G;if(t.strstart-t.block_start>=t.w_size-U&&(at(t,!1),0===t.strm.avail_out))return G}return t.insert=0,e===c?(at(t,!0),0===t.strm.avail_out?X:Y):(t.strstart>t.block_start&&(at(t,!1),t.strm.avail_out),G)}function ut(t,e){for(var a,n;;){if(t.lookahead<U){if(ot(t),t.lookahead<U&&e===l)return G;if(0===t.lookahead)break}if(a=0,t.lookahead>=M&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+M-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-U&&(t.match_length=st(t,a)),t.match_length>=M)if(n=i._tr_tally(t,t.strstart-t.match_start,t.match_length-M),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=M){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+M-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=i._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(at(t,!1),0===t.strm.avail_out))return G}return t.insert=t.strstart<M-1?t.strstart:M-1,e===c?(at(t,!0),0===t.strm.avail_out?X:Y):t.last_lit&&(at(t,!1),0===t.strm.avail_out)?G:K}function dt(t,e){for(var a,n,r;;){if(t.lookahead<U){if(ot(t),t.lookahead<U&&e===l)return G;if(0===t.lookahead)break}if(a=0,t.lookahead>=M&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+M-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=M-1,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-U&&(t.match_length=st(t,a),t.match_length<=5&&(t.strategy===y||t.match_length===M&&t.strstart-t.match_start>4096)&&(t.match_length=M-1)),t.prev_length>=M&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-M,n=i._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-M),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+M-1])&t.hash_mask,a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=M-1,t.strstart++,n&&(at(t,!1),0===t.strm.avail_out))return G}else if(t.match_available){if(n=i._tr_tally(t,0,t.window[t.strstart-1]),n&&at(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return G}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=i._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<M-1?t.strstart:M-1,e===c?(at(t,!0),0===t.strm.avail_out?X:Y):t.last_lit&&(at(t,!1),0===t.strm.avail_out)?G:K}function ct(t,e){for(var a,n,r,s,o=t.window;;){if(t.lookahead<=L){if(ot(t),t.lookahead<=L&&e===l)return G;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=M&&t.strstart>0&&(r=t.strstart-1,n=o[r],n===o[++r]&&n===o[++r]&&n===o[++r])){s=t.strstart+L;do{}while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<s);t.match_length=L-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=M?(a=i._tr_tally(t,1,t.match_length-M),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=i._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(at(t,!1),0===t.strm.avail_out))return G}return t.insert=0,e===c?(at(t,!0),0===t.strm.avail_out?X:Y):t.last_lit&&(at(t,!1),0===t.strm.avail_out)?G:K}function pt(t,e){for(var a;;){if(0===t.lookahead&&(ot(t),0===t.lookahead)){if(e===l)return G;break}if(t.match_length=0,a=i._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(at(t,!1),0===t.strm.avail_out))return G}return t.insert=0,e===c?(at(t,!0),0===t.strm.avail_out?X:Y):t.last_lit&&(at(t,!1),0===t.strm.avail_out)?G:K}var ht,gt=function(t,e,a,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=n,this.func=i};function ft(t){t.window_size=2*t.w_size,tt(t.head),t.max_lazy_match=ht[t.level].max_lazy,t.good_match=ht[t.level].good_length,t.nice_match=ht[t.level].nice_length,t.max_chain_length=ht[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=M-1,t.match_available=0,t.ins_h=0}function mt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*B),this.dyn_dtree=new n.Buf16(2*(2*N+1)),this.bl_tree=new n.Buf16(2*(2*R+1)),tt(this.dyn_ltree),tt(this.dyn_dtree),tt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(O+1),this.heap=new n.Buf16(2*P+1),tt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*P+1),tt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function vt(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=x,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?$:V,t.adler=2===e.wrap?0:1,e.last_flush=l,i._tr_init(e),h):Z(t,f)}function bt(t){var e=vt(t);return e===h&&ft(t.state),e}function yt(t,e){return t&&t.state?2!==t.state.wrap?f:(t.state.gzhead=e,h):f}function _t(t,e,a,i,r,s){if(!t)return f;var o=1;if(e===b&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>S||a!==k||i<8||i>15||e<0||e>9||s<0||s>C)return Z(t,f);8===i&&(i=9);var l=new mt;return t.state=l,l.strm=t,l.wrap=o,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+M-1)/M),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=l.lit_bufsize>>1,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=s,l.method=a,bt(t)}function Dt(t,e){return _t(t,e,k,A,E,w)}function Ct(t,e){var a,n,r,o;if(!t||!t.state||e>p||e<0)return t?Z(t,f):f;if(n=t.state,!t.output||!t.input&&0!==t.avail_in||n.status===q&&e!==c)return Z(t,0===t.avail_out?v:f);if(n.strm=t,a=n.last_flush,n.last_flush=e,n.status===$)if(2===n.wrap)t.adler=0,nt(n,31),nt(n,139),nt(n,8),n.gzhead?(nt(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),nt(n,255&n.gzhead.time),nt(n,n.gzhead.time>>8&255),nt(n,n.gzhead.time>>16&255),nt(n,n.gzhead.time>>24&255),nt(n,9===n.level?2:n.strategy>=_||n.level<2?4:0),nt(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(nt(n,255&n.gzhead.extra.length),nt(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=s(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=H):(nt(n,0),nt(n,0),nt(n,0),nt(n,0),nt(n,0),nt(n,9===n.level?2:n.strategy>=_||n.level<2?4:0),nt(n,J),n.status=V);else{var m=k+(n.w_bits-8<<4)<<8,b=-1;b=n.strategy>=_||n.level<2?0:n.level<6?1:6===n.level?2:3,m|=b<<6,0!==n.strstart&&(m|=F),m+=31-m%31,n.status=V,it(n,m),0!==n.strstart&&(it(n,t.adler>>>16),it(n,65535&t.adler)),t.adler=1}if(n.status===H)if(n.gzhead.extra){r=n.pending;while(n.gzindex<(65535&n.gzhead.extra.length)){if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>r&&(t.adler=s(t.adler,n.pending_buf,n.pending-r,r)),et(t),r=n.pending,n.pending===n.pending_buf_size))break;nt(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++}n.gzhead.hcrc&&n.pending>r&&(t.adler=s(t.adler,n.pending_buf,n.pending-r,r)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=j)}else n.status=j;if(n.status===j)if(n.gzhead.name){r=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>r&&(t.adler=s(t.adler,n.pending_buf,n.pending-r,r)),et(t),r=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,nt(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>r&&(t.adler=s(t.adler,n.pending_buf,n.pending-r,r)),0===o&&(n.gzindex=0,n.status=W)}else n.status=W;if(n.status===W)if(n.gzhead.comment){r=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>r&&(t.adler=s(t.adler,n.pending_buf,n.pending-r,r)),et(t),r=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,nt(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>r&&(t.adler=s(t.adler,n.pending_buf,n.pending-r,r)),0===o&&(n.status=z)}else n.status=z;if(n.status===z&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&et(t),n.pending+2<=n.pending_buf_size&&(nt(n,255&t.adler),nt(n,t.adler>>8&255),t.adler=0,n.status=V)):n.status=V),0!==n.pending){if(et(t),0===t.avail_out)return n.last_flush=-1,h}else if(0===t.avail_in&&Q(e)<=Q(a)&&e!==c)return Z(t,v);if(n.status===q&&0!==t.avail_in)return Z(t,v);if(0!==t.avail_in||0!==n.lookahead||e!==l&&n.status!==q){var y=n.strategy===_?pt(n,e):n.strategy===D?ct(n,e):ht[n.level].func(n,e);if(y!==X&&y!==Y||(n.status=q),y===G||y===X)return 0===t.avail_out&&(n.last_flush=-1),h;if(y===K&&(e===u?i._tr_align(n):e!==p&&(i._tr_stored_block(n,0,0,!1),e===d&&(tt(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),et(t),0===t.avail_out))return n.last_flush=-1,h}return e!==c?h:n.wrap<=0?g:(2===n.wrap?(nt(n,255&t.adler),nt(n,t.adler>>8&255),nt(n,t.adler>>16&255),nt(n,t.adler>>24&255),nt(n,255&t.total_in),nt(n,t.total_in>>8&255),nt(n,t.total_in>>16&255),nt(n,t.total_in>>24&255)):(it(n,t.adler>>>16),it(n,65535&t.adler)),et(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?h:g)}function wt(t){var e;return t&&t.state?(e=t.state.status,e!==$&&e!==H&&e!==j&&e!==W&&e!==z&&e!==V&&e!==q?Z(t,f):(t.state=null,e===V?Z(t,m):h)):f}ht=[new gt(0,0,0,0,lt),new gt(4,4,8,4,ut),new gt(4,5,16,8,ut),new gt(4,6,32,32,ut),new gt(4,4,16,16,dt),new gt(8,16,32,32,dt),new gt(8,16,128,128,dt),new gt(8,32,128,256,dt),new gt(32,128,258,1024,dt),new gt(32,258,258,4096,dt)],a.deflateInit=Dt,a.deflateInit2=_t,a.deflateReset=bt,a.deflateResetKeep=vt,a.deflateSetHeader=yt,a.deflate=Ct,a.deflateEnd=wt,a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(t,e,a){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=n},{}],34:[function(t,e,a){"use strict";var n=30,i=12;e.exports=function(t,e){var a,r,s,o,l,u,d,c,p,h,g,f,m,v,b,y,_,D,C,w,x,k,S,A,E;a=t.state,r=t.next_in,A=t.input,s=r+(t.avail_in-5),o=t.next_out,E=t.output,l=o-(e-t.avail_out),u=o+(t.avail_out-257),d=a.dmax,c=a.wsize,p=a.whave,h=a.wnext,g=a.window,f=a.hold,m=a.bits,v=a.lencode,b=a.distcode,y=(1<<a.lenbits)-1,_=(1<<a.distbits)-1;t:do{m<15&&(f+=A[r++]<<m,m+=8,f+=A[r++]<<m,m+=8),D=v[f&y];e:for(;;){if(C=D>>>24,f>>>=C,m-=C,C=D>>>16&255,0===C)E[o++]=65535&D;else{if(!(16&C)){if(0===(64&C)){D=v[(65535&D)+(f&(1<<C)-1)];continue e}if(32&C){a.mode=i;break t}t.msg="invalid literal/length code",a.mode=n;break t}w=65535&D,C&=15,C&&(m<C&&(f+=A[r++]<<m,m+=8),w+=f&(1<<C)-1,f>>>=C,m-=C),m<15&&(f+=A[r++]<<m,m+=8,f+=A[r++]<<m,m+=8),D=b[f&_];a:for(;;){if(C=D>>>24,f>>>=C,m-=C,C=D>>>16&255,!(16&C)){if(0===(64&C)){D=b[(65535&D)+(f&(1<<C)-1)];continue a}t.msg="invalid distance code",a.mode=n;break t}if(x=65535&D,C&=15,m<C&&(f+=A[r++]<<m,m+=8,m<C&&(f+=A[r++]<<m,m+=8)),x+=f&(1<<C)-1,x>d){t.msg="invalid distance too far back",a.mode=n;break t}if(f>>>=C,m-=C,C=o-l,x>C){if(C=x-C,C>p&&a.sane){t.msg="invalid distance too far back",a.mode=n;break t}if(k=0,S=g,0===h){if(k+=c-C,C<w){w-=C;do{E[o++]=g[k++]}while(--C);k=o-x,S=E}}else if(h<C){if(k+=c+h-C,C-=h,C<w){w-=C;do{E[o++]=g[k++]}while(--C);if(k=0,h<w){C=h,w-=C;do{E[o++]=g[k++]}while(--C);k=o-x,S=E}}}else if(k+=h-C,C<w){w-=C;do{E[o++]=g[k++]}while(--C);k=o-x,S=E}while(w>2)E[o++]=S[k++],E[o++]=S[k++],E[o++]=S[k++],w-=3;w&&(E[o++]=S[k++],w>1&&(E[o++]=S[k++]))}else{k=o-x;do{E[o++]=E[k++],E[o++]=E[k++],E[o++]=E[k++],w-=3}while(w>2);w&&(E[o++]=E[k++],w>1&&(E[o++]=E[k++]))}break}}break}}while(r<s&&o<u);w=m>>3,r-=w,m-=w<<3,f&=(1<<m)-1,t.next_in=r,t.next_out=o,t.avail_in=r<s?s-r+5:5-(r-s),t.avail_out=o<u?u-o+257:257-(o-u),a.hold=f,a.bits=m}},{}],35:[function(t,e,a){"use strict";var n=t("../utils/common"),i=t("./adler32"),r=t("./crc32"),s=t("./inffast"),o=t("./inftrees"),l=0,u=1,d=2,c=4,p=5,h=6,g=0,f=1,m=2,v=-2,b=-3,y=-4,_=-5,D=8,C=1,w=2,x=3,k=4,S=5,A=6,E=7,T=8,I=9,P=10,N=11,R=12,B=13,O=14,M=15,L=16,U=17,F=18,$=19,H=20,j=21,W=22,z=23,V=24,q=25,G=26,K=27,X=28,Y=29,J=30,Z=31,Q=32,tt=852,et=592,at=15,nt=at;function it(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function rt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function st(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=C,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(tt),e.distcode=e.distdyn=new n.Buf32(et),e.sane=1,e.back=-1,g):v}function ot(t){var e;return t&&t.state?(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,st(t)):v}function lt(t,e){var a,n;return t&&t.state?(n=t.state,e<0?(a=0,e=-e):(a=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?v:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=a,n.wbits=e,ot(t))):v}function ut(t,e){var a,n;return t?(n=new rt,t.state=n,n.window=null,a=lt(t,e),a!==g&&(t.state=null),a):v}function dt(t){return ut(t,nt)}var ct,pt,ht=!0;function gt(t){if(ht){var e;ct=new n.Buf32(512),pt=new n.Buf32(32),e=0;while(e<144)t.lens[e++]=8;while(e<256)t.lens[e++]=9;while(e<280)t.lens[e++]=7;while(e<288)t.lens[e++]=8;o(u,t.lens,0,288,ct,0,t.work,{bits:9}),e=0;while(e<32)t.lens[e++]=5;o(d,t.lens,0,32,pt,0,t.work,{bits:5}),ht=!1}t.lencode=ct,t.lenbits=9,t.distcode=pt,t.distbits=5}function ft(t,e,a,i){var r,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new n.Buf8(s.wsize)),i>=s.wsize?(n.arraySet(s.window,e,a-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),n.arraySet(s.window,e,a-i,r,s.wnext),i-=r,i?(n.arraySet(s.window,e,a-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0}function mt(t,e){var a,tt,et,at,nt,rt,st,ot,lt,ut,dt,ct,pt,ht,mt,vt,bt,yt,_t,Dt,Ct,wt,xt,kt,St=0,At=new n.Buf8(4),Et=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return v;a=t.state,a.mode===R&&(a.mode=B),nt=t.next_out,et=t.output,st=t.avail_out,at=t.next_in,tt=t.input,rt=t.avail_in,ot=a.hold,lt=a.bits,ut=rt,dt=st,wt=g;t:for(;;)switch(a.mode){case C:if(0===a.wrap){a.mode=B;break}while(lt<16){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if(2&a.wrap&&35615===ot){a.check=0,At[0]=255&ot,At[1]=ot>>>8&255,a.check=r(a.check,At,2,0),ot=0,lt=0,a.mode=w;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&ot)<<8)+(ot>>8))%31){t.msg="incorrect header check",a.mode=J;break}if((15&ot)!==D){t.msg="unknown compression method",a.mode=J;break}if(ot>>>=4,lt-=4,Ct=8+(15&ot),0===a.wbits)a.wbits=Ct;else if(Ct>a.wbits){t.msg="invalid window size",a.mode=J;break}a.dmax=1<<Ct,t.adler=a.check=1,a.mode=512&ot?P:R,ot=0,lt=0;break;case w:while(lt<16){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if(a.flags=ot,(255&a.flags)!==D){t.msg="unknown compression method",a.mode=J;break}if(57344&a.flags){t.msg="unknown header flags set",a.mode=J;break}a.head&&(a.head.text=ot>>8&1),512&a.flags&&(At[0]=255&ot,At[1]=ot>>>8&255,a.check=r(a.check,At,2,0)),ot=0,lt=0,a.mode=x;case x:while(lt<32){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}a.head&&(a.head.time=ot),512&a.flags&&(At[0]=255&ot,At[1]=ot>>>8&255,At[2]=ot>>>16&255,At[3]=ot>>>24&255,a.check=r(a.check,At,4,0)),ot=0,lt=0,a.mode=k;case k:while(lt<16){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}a.head&&(a.head.xflags=255&ot,a.head.os=ot>>8),512&a.flags&&(At[0]=255&ot,At[1]=ot>>>8&255,a.check=r(a.check,At,2,0)),ot=0,lt=0,a.mode=S;case S:if(1024&a.flags){while(lt<16){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}a.length=ot,a.head&&(a.head.extra_len=ot),512&a.flags&&(At[0]=255&ot,At[1]=ot>>>8&255,a.check=r(a.check,At,2,0)),ot=0,lt=0}else a.head&&(a.head.extra=null);a.mode=A;case A:if(1024&a.flags&&(ct=a.length,ct>rt&&(ct=rt),ct&&(a.head&&(Ct=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),n.arraySet(a.head.extra,tt,at,ct,Ct)),512&a.flags&&(a.check=r(a.check,tt,ct,at)),rt-=ct,at+=ct,a.length-=ct),a.length))break t;a.length=0,a.mode=E;case E:if(2048&a.flags){if(0===rt)break t;ct=0;do{Ct=tt[at+ct++],a.head&&Ct&&a.length<65536&&(a.head.name+=String.fromCharCode(Ct))}while(Ct&&ct<rt);if(512&a.flags&&(a.check=r(a.check,tt,ct,at)),rt-=ct,at+=ct,Ct)break t}else a.head&&(a.head.name=null);a.length=0,a.mode=T;case T:if(4096&a.flags){if(0===rt)break t;ct=0;do{Ct=tt[at+ct++],a.head&&Ct&&a.length<65536&&(a.head.comment+=String.fromCharCode(Ct))}while(Ct&&ct<rt);if(512&a.flags&&(a.check=r(a.check,tt,ct,at)),rt-=ct,at+=ct,Ct)break t}else a.head&&(a.head.comment=null);a.mode=I;case I:if(512&a.flags){while(lt<16){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if(ot!==(65535&a.check)){t.msg="header crc mismatch",a.mode=J;break}ot=0,lt=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),t.adler=a.check=0,a.mode=R;break;case P:while(lt<32){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}t.adler=a.check=it(ot),ot=0,lt=0,a.mode=N;case N:if(0===a.havedict)return t.next_out=nt,t.avail_out=st,t.next_in=at,t.avail_in=rt,a.hold=ot,a.bits=lt,m;t.adler=a.check=1,a.mode=R;case R:if(e===p||e===h)break t;case B:if(a.last){ot>>>=7&lt,lt-=7&lt,a.mode=K;break}while(lt<3){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}switch(a.last=1&ot,ot>>>=1,lt-=1,3&ot){case 0:a.mode=O;break;case 1:if(gt(a),a.mode=H,e===h){ot>>>=2,lt-=2;break t}break;case 2:a.mode=U;break;case 3:t.msg="invalid block type",a.mode=J}ot>>>=2,lt-=2;break;case O:ot>>>=7&lt,lt-=7&lt;while(lt<32){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if((65535&ot)!==(ot>>>16^65535)){t.msg="invalid stored block lengths",a.mode=J;break}if(a.length=65535&ot,ot=0,lt=0,a.mode=M,e===h)break t;case M:a.mode=L;case L:if(ct=a.length,ct){if(ct>rt&&(ct=rt),ct>st&&(ct=st),0===ct)break t;n.arraySet(et,tt,at,ct,nt),rt-=ct,at+=ct,st-=ct,nt+=ct,a.length-=ct;break}a.mode=R;break;case U:while(lt<14){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if(a.nlen=257+(31&ot),ot>>>=5,lt-=5,a.ndist=1+(31&ot),ot>>>=5,lt-=5,a.ncode=4+(15&ot),ot>>>=4,lt-=4,a.nlen>286||a.ndist>30){t.msg="too many length or distance symbols",a.mode=J;break}a.have=0,a.mode=F;case F:while(a.have<a.ncode){while(lt<3){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}a.lens[Et[a.have++]]=7&ot,ot>>>=3,lt-=3}while(a.have<19)a.lens[Et[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,xt={bits:a.lenbits},wt=o(l,a.lens,0,19,a.lencode,0,a.work,xt),a.lenbits=xt.bits,wt){t.msg="invalid code lengths set",a.mode=J;break}a.have=0,a.mode=$;case $:while(a.have<a.nlen+a.ndist){for(;;){if(St=a.lencode[ot&(1<<a.lenbits)-1],mt=St>>>24,vt=St>>>16&255,bt=65535&St,mt<=lt)break;if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if(bt<16)ot>>>=mt,lt-=mt,a.lens[a.have++]=bt;else{if(16===bt){kt=mt+2;while(lt<kt){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if(ot>>>=mt,lt-=mt,0===a.have){t.msg="invalid bit length repeat",a.mode=J;break}Ct=a.lens[a.have-1],ct=3+(3&ot),ot>>>=2,lt-=2}else if(17===bt){kt=mt+3;while(lt<kt){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}ot>>>=mt,lt-=mt,Ct=0,ct=3+(7&ot),ot>>>=3,lt-=3}else{kt=mt+7;while(lt<kt){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}ot>>>=mt,lt-=mt,Ct=0,ct=11+(127&ot),ot>>>=7,lt-=7}if(a.have+ct>a.nlen+a.ndist){t.msg="invalid bit length repeat",a.mode=J;break}while(ct--)a.lens[a.have++]=Ct}}if(a.mode===J)break;if(0===a.lens[256]){t.msg="invalid code -- missing end-of-block",a.mode=J;break}if(a.lenbits=9,xt={bits:a.lenbits},wt=o(u,a.lens,0,a.nlen,a.lencode,0,a.work,xt),a.lenbits=xt.bits,wt){t.msg="invalid literal/lengths set",a.mode=J;break}if(a.distbits=6,a.distcode=a.distdyn,xt={bits:a.distbits},wt=o(d,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,xt),a.distbits=xt.bits,wt){t.msg="invalid distances set",a.mode=J;break}if(a.mode=H,e===h)break t;case H:a.mode=j;case j:if(rt>=6&&st>=258){t.next_out=nt,t.avail_out=st,t.next_in=at,t.avail_in=rt,a.hold=ot,a.bits=lt,s(t,dt),nt=t.next_out,et=t.output,st=t.avail_out,at=t.next_in,tt=t.input,rt=t.avail_in,ot=a.hold,lt=a.bits,a.mode===R&&(a.back=-1);break}for(a.back=0;;){if(St=a.lencode[ot&(1<<a.lenbits)-1],mt=St>>>24,vt=St>>>16&255,bt=65535&St,mt<=lt)break;if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if(vt&&0===(240&vt)){for(yt=mt,_t=vt,Dt=bt;;){if(St=a.lencode[Dt+((ot&(1<<yt+_t)-1)>>yt)],mt=St>>>24,vt=St>>>16&255,bt=65535&St,yt+mt<=lt)break;if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}ot>>>=yt,lt-=yt,a.back+=yt}if(ot>>>=mt,lt-=mt,a.back+=mt,a.length=bt,0===vt){a.mode=G;break}if(32&vt){a.back=-1,a.mode=R;break}if(64&vt){t.msg="invalid literal/length code",a.mode=J;break}a.extra=15&vt,a.mode=W;case W:if(a.extra){kt=a.extra;while(lt<kt){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}a.length+=ot&(1<<a.extra)-1,ot>>>=a.extra,lt-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=z;case z:for(;;){if(St=a.distcode[ot&(1<<a.distbits)-1],mt=St>>>24,vt=St>>>16&255,bt=65535&St,mt<=lt)break;if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if(0===(240&vt)){for(yt=mt,_t=vt,Dt=bt;;){if(St=a.distcode[Dt+((ot&(1<<yt+_t)-1)>>yt)],mt=St>>>24,vt=St>>>16&255,bt=65535&St,yt+mt<=lt)break;if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}ot>>>=yt,lt-=yt,a.back+=yt}if(ot>>>=mt,lt-=mt,a.back+=mt,64&vt){t.msg="invalid distance code",a.mode=J;break}a.offset=bt,a.extra=15&vt,a.mode=V;case V:if(a.extra){kt=a.extra;while(lt<kt){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}a.offset+=ot&(1<<a.extra)-1,ot>>>=a.extra,lt-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){t.msg="invalid distance too far back",a.mode=J;break}a.mode=q;case q:if(0===st)break t;if(ct=dt-st,a.offset>ct){if(ct=a.offset-ct,ct>a.whave&&a.sane){t.msg="invalid distance too far back",a.mode=J;break}ct>a.wnext?(ct-=a.wnext,pt=a.wsize-ct):pt=a.wnext-ct,ct>a.length&&(ct=a.length),ht=a.window}else ht=et,pt=nt-a.offset,ct=a.length;ct>st&&(ct=st),st-=ct,a.length-=ct;do{et[nt++]=ht[pt++]}while(--ct);0===a.length&&(a.mode=j);break;case G:if(0===st)break t;et[nt++]=a.length,st--,a.mode=j;break;case K:if(a.wrap){while(lt<32){if(0===rt)break t;rt--,ot|=tt[at++]<<lt,lt+=8}if(dt-=st,t.total_out+=dt,a.total+=dt,dt&&(t.adler=a.check=a.flags?r(a.check,et,dt,nt-dt):i(a.check,et,dt,nt-dt)),dt=st,(a.flags?ot:it(ot))!==a.check){t.msg="incorrect data check",a.mode=J;break}ot=0,lt=0}a.mode=X;case X:if(a.wrap&&a.flags){while(lt<32){if(0===rt)break t;rt--,ot+=tt[at++]<<lt,lt+=8}if(ot!==(4294967295&a.total)){t.msg="incorrect length check",a.mode=J;break}ot=0,lt=0}a.mode=Y;case Y:wt=f;break t;case J:wt=b;break t;case Z:return y;case Q:default:return v}return t.next_out=nt,t.avail_out=st,t.next_in=at,t.avail_in=rt,a.hold=ot,a.bits=lt,(a.wsize||dt!==t.avail_out&&a.mode<J&&(a.mode<K||e!==c))&&ft(t,t.output,t.next_out,dt-t.avail_out)?(a.mode=Z,y):(ut-=t.avail_in,dt-=t.avail_out,t.total_in+=ut,t.total_out+=dt,a.total+=dt,a.wrap&&dt&&(t.adler=a.check=a.flags?r(a.check,et,dt,t.next_out-dt):i(a.check,et,dt,t.next_out-dt)),t.data_type=a.bits+(a.last?64:0)+(a.mode===R?128:0)+(a.mode===H||a.mode===M?256:0),(0===ut&&0===dt||e===c)&&wt===g&&(wt=_),wt)}function vt(t){if(!t||!t.state)return v;var e=t.state;return e.window&&(e.window=null),t.state=null,g}function bt(t,e){var a;return t&&t.state?(a=t.state,0===(2&a.wrap)?v:(a.head=e,e.done=!1,g)):v}a.inflateReset=ot,a.inflateReset2=lt,a.inflateResetKeep=st,a.inflateInit=dt,a.inflateInit2=ut,a.inflate=mt,a.inflateEnd=vt,a.inflateGetHeader=bt,a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(t,e,a){"use strict";var n=t("../utils/common"),i=15,r=852,s=592,o=0,l=1,u=2,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,a,g,f,m,v,b){var y,_,D,C,w,x,k,S,A,E=b.bits,T=0,I=0,P=0,N=0,R=0,B=0,O=0,M=0,L=0,U=0,F=null,$=0,H=new n.Buf16(i+1),j=new n.Buf16(i+1),W=null,z=0;for(T=0;T<=i;T++)H[T]=0;for(I=0;I<g;I++)H[e[a+I]]++;for(R=E,N=i;N>=1;N--)if(0!==H[N])break;if(R>N&&(R=N),0===N)return f[m++]=20971520,f[m++]=20971520,b.bits=1,0;for(P=1;P<N;P++)if(0!==H[P])break;for(R<P&&(R=P),M=1,T=1;T<=i;T++)if(M<<=1,M-=H[T],M<0)return-1;if(M>0&&(t===o||1!==N))return-1;for(j[1]=0,T=1;T<i;T++)j[T+1]=j[T]+H[T];for(I=0;I<g;I++)0!==e[a+I]&&(v[j[e[a+I]]++]=I);if(t===o?(F=W=v,x=19):t===l?(F=d,$-=257,W=c,z-=257,x=256):(F=p,W=h,x=-1),U=0,I=0,T=P,w=m,B=R,O=0,D=-1,L=1<<R,C=L-1,t===l&&L>r||t===u&&L>s)return 1;for(;;){k=T-O,v[I]<x?(S=0,A=v[I]):v[I]>x?(S=W[z+v[I]],A=F[$+v[I]]):(S=96,A=0),y=1<<T-O,_=1<<B,P=_;do{_-=y,f[w+(U>>O)+_]=k<<24|S<<16|A|0}while(0!==_);y=1<<T-1;while(U&y)y>>=1;if(0!==y?(U&=y-1,U+=y):U=0,I++,0===--H[T]){if(T===N)break;T=e[a+v[I]]}if(T>R&&(U&C)!==D){0===O&&(O=R),w+=P,B=T-O,M=1<<B;while(B+O<N){if(M-=H[B+O],M<=0)break;B++,M<<=1}if(L+=1<<B,t===l&&L>r||t===u&&L>s)return 1;D=U&C,f[D]=R<<24|B<<16|w-m|0}}return 0!==U&&(f[w+U]=T-O<<24|64<<16|0),b.bits=R,0}},{"../utils/common":27}],37:[function(t,e,a){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(t,e,a){"use strict";var n=t("../utils/common"),i=4,r=0,s=1,o=2;function l(t){var e=t.length;while(--e>=0)t[e]=0}var u=0,d=1,c=2,p=3,h=258,g=29,f=256,m=f+1+g,v=30,b=19,y=2*m+1,_=15,D=16,C=7,w=256,x=16,k=17,S=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,N=new Array(2*(m+2));l(N);var R=new Array(2*v);l(R);var B=new Array(P);l(B);var O=new Array(h-p+1);l(O);var M=new Array(g);l(M);var L=new Array(v);l(L);var U,F,$,H=function(t,e,a,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=n,this.max_length=i,this.has_stree=t&&t.length},j=function(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e};function W(t){return t<256?B[t]:B[256+(t>>>7)]}function z(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function V(t,e,a){t.bi_valid>D-a?(t.bi_buf|=e<<t.bi_valid&65535,z(t,t.bi_buf),t.bi_buf=e>>D-t.bi_valid,t.bi_valid+=a-D):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)}function q(t,e,a){V(t,a[2*e],a[2*e+1])}function G(t,e){var a=0;do{a|=1&t,t>>>=1,a<<=1}while(--e>0);return a>>>1}function K(t){16===t.bi_valid?(z(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function X(t,e){var a,n,i,r,s,o,l=e.dyn_tree,u=e.max_code,d=e.stat_desc.static_tree,c=e.stat_desc.has_stree,p=e.stat_desc.extra_bits,h=e.stat_desc.extra_base,g=e.stat_desc.max_length,f=0;for(r=0;r<=_;r++)t.bl_count[r]=0;for(l[2*t.heap[t.heap_max]+1]=0,a=t.heap_max+1;a<y;a++)n=t.heap[a],r=l[2*l[2*n+1]+1]+1,r>g&&(r=g,f++),l[2*n+1]=r,n>u||(t.bl_count[r]++,s=0,n>=h&&(s=p[n-h]),o=l[2*n],t.opt_len+=o*(r+s),c&&(t.static_len+=o*(d[2*n+1]+s)));if(0!==f){do{r=g-1;while(0===t.bl_count[r])r--;t.bl_count[r]--,t.bl_count[r+1]+=2,t.bl_count[g]--,f-=2}while(f>0);for(r=g;0!==r;r--){n=t.bl_count[r];while(0!==n)i=t.heap[--a],i>u||(l[2*i+1]!==r&&(t.opt_len+=(r-l[2*i+1])*l[2*i],l[2*i+1]=r),n--)}}}function Y(t,e,a){var n,i,r=new Array(_+1),s=0;for(n=1;n<=_;n++)r[n]=s=s+a[n-1]<<1;for(i=0;i<=e;i++){var o=t[2*i+1];0!==o&&(t[2*i]=G(r[o]++,o))}}function J(){var t,e,a,n,i,r=new Array(_+1);for(a=0,n=0;n<g-1;n++)for(M[n]=a,t=0;t<1<<A[n];t++)O[a++]=n;for(O[a-1]=n,i=0,n=0;n<16;n++)for(L[n]=i,t=0;t<1<<E[n];t++)B[i++]=n;for(i>>=7;n<v;n++)for(L[n]=i<<7,t=0;t<1<<E[n]-7;t++)B[256+i++]=n;for(e=0;e<=_;e++)r[e]=0;t=0;while(t<=143)N[2*t+1]=8,t++,r[8]++;while(t<=255)N[2*t+1]=9,t++,r[9]++;while(t<=279)N[2*t+1]=7,t++,r[7]++;while(t<=287)N[2*t+1]=8,t++,r[8]++;for(Y(N,m+1,r),t=0;t<v;t++)R[2*t+1]=5,R[2*t]=G(t,5);U=new H(N,A,f+1,m,_),F=new H(R,E,0,v,_),$=new H(new Array(0),T,0,b,C)}function Z(t){var e;for(e=0;e<m;e++)t.dyn_ltree[2*e]=0;for(e=0;e<v;e++)t.dyn_dtree[2*e]=0;for(e=0;e<b;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*w]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function Q(t){t.bi_valid>8?z(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function tt(t,e,a,i){Q(t),i&&(z(t,a),z(t,~a)),n.arraySet(t.pending_buf,t.window,e,a,t.pending),t.pending+=a}function et(t,e,a,n){var i=2*e,r=2*a;return t[i]<t[r]||t[i]===t[r]&&n[e]<=n[a]}function at(t,e,a){var n=t.heap[a],i=a<<1;while(i<=t.heap_len){if(i<t.heap_len&&et(e,t.heap[i+1],t.heap[i],t.depth)&&i++,et(e,n,t.heap[i],t.depth))break;t.heap[a]=t.heap[i],a=i,i<<=1}t.heap[a]=n}function nt(t,e,a){var n,i,r,s,o=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*o]<<8|t.pending_buf[t.d_buf+2*o+1],i=t.pending_buf[t.l_buf+o],o++,0===n?q(t,i,e):(r=O[i],q(t,r+f+1,e),s=A[r],0!==s&&(i-=M[r],V(t,i,s)),n--,r=W(n),q(t,r,a),s=E[r],0!==s&&(n-=L[r],V(t,n,s)))}while(o<t.last_lit);q(t,w,e)}function it(t,e){var a,n,i,r=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,l=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=y,a=0;a<l;a++)0!==r[2*a]?(t.heap[++t.heap_len]=u=a,t.depth[a]=0):r[2*a+1]=0;while(t.heap_len<2)i=t.heap[++t.heap_len]=u<2?++u:0,r[2*i]=1,t.depth[i]=0,t.opt_len--,o&&(t.static_len-=s[2*i+1]);for(e.max_code=u,a=t.heap_len>>1;a>=1;a--)at(t,r,a);i=l;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],at(t,r,1),n=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=n,r[2*i]=r[2*a]+r[2*n],t.depth[i]=(t.depth[a]>=t.depth[n]?t.depth[a]:t.depth[n])+1,r[2*a+1]=r[2*n+1]=i,t.heap[1]=i++,at(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],X(t,e),Y(r,u,t.bl_count)}function rt(t,e,a){var n,i,r=-1,s=e[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),e[2*(a+1)+1]=65535,n=0;n<=a;n++)i=s,s=e[2*(n+1)+1],++o<l&&i===s||(o<u?t.bl_tree[2*i]+=o:0!==i?(i!==r&&t.bl_tree[2*i]++,t.bl_tree[2*x]++):o<=10?t.bl_tree[2*k]++:t.bl_tree[2*S]++,o=0,r=i,0===s?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4))}function st(t,e,a){var n,i,r=-1,s=e[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),n=0;n<=a;n++)if(i=s,s=e[2*(n+1)+1],!(++o<l&&i===s)){if(o<u)do{q(t,i,t.bl_tree)}while(0!==--o);else 0!==i?(i!==r&&(q(t,i,t.bl_tree),o--),q(t,x,t.bl_tree),V(t,o-3,2)):o<=10?(q(t,k,t.bl_tree),V(t,o-3,3)):(q(t,S,t.bl_tree),V(t,o-11,7));o=0,r=i,0===s?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4)}}function ot(t){var e;for(rt(t,t.dyn_ltree,t.l_desc.max_code),rt(t,t.dyn_dtree,t.d_desc.max_code),it(t,t.bl_desc),e=b-1;e>=3;e--)if(0!==t.bl_tree[2*I[e]+1])break;return t.opt_len+=3*(e+1)+5+5+4,e}function lt(t,e,a,n){var i;for(V(t,e-257,5),V(t,a-1,5),V(t,n-4,4),i=0;i<n;i++)V(t,t.bl_tree[2*I[i]+1],3);st(t,t.dyn_ltree,e-1),st(t,t.dyn_dtree,a-1)}function ut(t){var e,a=4093624447;for(e=0;e<=31;e++,a>>>=1)if(1&a&&0!==t.dyn_ltree[2*e])return r;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return s;for(e=32;e<f;e++)if(0!==t.dyn_ltree[2*e])return s;return r}var dt=!1;function ct(t){dt||(J(),dt=!0),t.l_desc=new j(t.dyn_ltree,U),t.d_desc=new j(t.dyn_dtree,F),t.bl_desc=new j(t.bl_tree,$),t.bi_buf=0,t.bi_valid=0,Z(t)}function pt(t,e,a,n){V(t,(u<<1)+(n?1:0),3),tt(t,e,a,!0)}function ht(t){V(t,d<<1,3),q(t,w,N),K(t)}function gt(t,e,a,n){var r,s,l=0;t.level>0?(t.strm.data_type===o&&(t.strm.data_type=ut(t)),it(t,t.l_desc),it(t,t.d_desc),l=ot(t),r=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=r&&(r=s)):r=s=a+5,a+4<=r&&-1!==e?pt(t,e,a,n):t.strategy===i||s===r?(V(t,(d<<1)+(n?1:0),3),nt(t,N,R)):(V(t,(c<<1)+(n?1:0),3),lt(t,t.l_desc.max_code+1,t.d_desc.max_code+1,l+1),nt(t,t.dyn_ltree,t.dyn_dtree)),Z(t),n&&Q(t)}function ft(t,e,a){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&a,t.last_lit++,0===e?t.dyn_ltree[2*a]++:(t.matches++,e--,t.dyn_ltree[2*(O[a]+f+1)]++,t.dyn_dtree[2*W(e)]++),t.last_lit===t.lit_bufsize-1}a._tr_init=ct,a._tr_stored_block=pt,a._tr_flush_block=gt,a._tr_tally=ft,a._tr_align=ht},{"../utils/common":27}],39:[function(t,e,a){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=n},{}]},{},[9])(9)}));function h(e){e.version="0.15.1";var n=1200,o=1252;"undefined"===typeof cptable&&("undefined"!==typeof r?r.cptable=void 0:"undefined"!==typeof window&&(window.cptable=void 0));for(var l=[874,932,936,949,950],u=0;u<=8;++u)l.push(1250+u);var d={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},p=function(t){-1!=l.indexOf(t)&&(o=d[0]=t)};function h(){p(1252)}var g=function(t){n=t,p(t)};function f(){g(1200),h()}function m(t){for(var e=[],a=0,n=t.length;a<n;++a)e[a]=t.charCodeAt(a);return e}function v(t){for(var e=[],a=0;a<t.length>>1;++a)e[a]=String.fromCharCode(t.charCodeAt(2*a)+(t.charCodeAt(2*a+1)<<8));return e.join("")}function b(t){for(var e=[],a=0;a<t.length>>1;++a)e[a]=String.fromCharCode(t.charCodeAt(2*a+1)+(t.charCodeAt(2*a)<<8));return e.join("")}var y=function(t){var e=t.charCodeAt(0),a=t.charCodeAt(1);return 255==e&&254==a?v(t.slice(2)):254==e&&255==a?b(t.slice(2)):65279==e?t.slice(1):t},_=function(t){return String.fromCharCode(t)},D=function(t){return String.fromCharCode(t)};"undefined"!==typeof cptable&&(g=function(t){n=t,p(t)},y=function(t){return 255===t.charCodeAt(0)&&254===t.charCodeAt(1)?cptable.utils.decode(1200,m(t.slice(2))):t},_=function(t){return 1200===n?String.fromCharCode(t):cptable.utils.decode(n,[255&t,t>>8])[0]},D=function(t){return cptable.utils.decode(o,[t])[0]});var C=null,w=!0,x=function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(e){for(var a="",n=0,i=0,r=0,s=0,o=0,l=0,u=0,d=0;d<e.length;)n=e.charCodeAt(d++),s=n>>2,i=e.charCodeAt(d++),o=(3&n)<<4|i>>4,r=e.charCodeAt(d++),l=(15&i)<<2|r>>6,u=63&r,isNaN(i)?l=u=64:isNaN(r)&&(u=64),a+=t.charAt(s)+t.charAt(o)+t.charAt(l)+t.charAt(u);return a},decode:function(e){var a="",n=0,i=0,r=0,s=0,o=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)s=t.indexOf(e.charAt(d++)),o=t.indexOf(e.charAt(d++)),n=s<<2|o>>4,a+=String.fromCharCode(n),l=t.indexOf(e.charAt(d++)),i=(15&o)<<4|l>>2,64!==l&&(a+=String.fromCharCode(i)),u=t.indexOf(e.charAt(d++)),r=(3&l)<<6|u,64!==u&&(a+=String.fromCharCode(r));return a}}}(),k="undefined"!==typeof i&&"undefined"!==typeof s&&"undefined"!==typeof s.versions&&!!s.versions.node,S=function(){};if("undefined"!==typeof i){var A=!i.from;if(!A)try{i.from("foo","utf8")}catch(zm){A=!0}S=A?function(t,e){return e?new i(t,e):new i(t)}:i.from.bind(i),i.alloc||(i.alloc=function(t){return new i(t)}),i.allocUnsafe||(i.allocUnsafe=function(t){return new i(t)})}function E(t){return k?i.alloc(t):new Array(t)}function T(t){return k?i.allocUnsafe(t):new Array(t)}var I=function(t){return k?S(t,"binary"):t.split("").map((function(t){return 255&t.charCodeAt(0)}))};function P(t){if("undefined"===typeof ArrayBuffer)return I(t);for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!=t.length;++n)a[n]=255&t.charCodeAt(n);return e}function N(t){if(Array.isArray(t))return t.map((function(t){return String.fromCharCode(t)})).join("");for(var e=[],a=0;a<t.length;++a)e[a]=String.fromCharCode(t[a]);return e.join("")}function R(t){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(t)}function B(t){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(t instanceof ArrayBuffer)return B(new Uint8Array(t));for(var e=new Array(t.length),a=0;a<t.length;++a)e[a]=t[a];return e}var O=function(t){return[].concat.apply([],t)},M=/\u0000/g,L=/[\u0001-\u0006]/g,U={},F=function(t){function e(t){var e="",a=t.length-1;while(a>=0)e+=t.charAt(a--);return e}function a(t,e){var a="";while(a.length<e)a+=t;return a}function n(t,e){var n=""+t;return n.length>=e?n:a("0",e-n.length)+n}function i(t,e){var n=""+t;return n.length>=e?n:a(" ",e-n.length)+n}function r(t,e){var n=""+t;return n.length>=e?n:n+a(" ",e-n.length)}function s(t,e){var n=""+Math.round(t);return n.length>=e?n:a("0",e-n.length)+n}function o(t,e){var n=""+t;return n.length>=e?n:a("0",e-n.length)+n}t.version="0.10.2";var l=Math.pow(2,32);function u(t,e){if(t>l||t<-l)return s(t,e);var a=Math.round(t);return o(a,e)}function d(t,e){return e=e||0,t.length>=7+e&&103===(32|t.charCodeAt(e))&&101===(32|t.charCodeAt(e+1))&&110===(32|t.charCodeAt(e+2))&&101===(32|t.charCodeAt(e+3))&&114===(32|t.charCodeAt(e+4))&&97===(32|t.charCodeAt(e+5))&&108===(32|t.charCodeAt(e+6))}var p=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],h=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function g(t){t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t[65535]="General"}var f={};function m(t,e,a){var n=t<0?-1:1,i=t*n,r=0,s=1,o=0,l=1,u=0,d=0,c=Math.floor(i);while(u<e){if(c=Math.floor(i),o=c*s+r,d=c*u+l,i-c<5e-8)break;i=1/(i-c),r=s,s=o,l=u,u=d}if(d>e&&(u>e?(d=l,o=r):(d=u,o=s)),!a)return[0,n*o,d];var p=Math.floor(n*o/d);return[p,n*o-p*d,d]}function v(t,e,a){if(t>2958465||t<0)return null;var n=0|t,i=Math.floor(86400*(t-n)),r=0,s=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,86400==++i&&(o.T=i=0,++n,++o.D)),60===n)s=a?[1317,10,29]:[1900,2,29],r=3;else if(0===n)s=a?[1317,8,29]:[1900,1,0],r=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],r=l.getDay(),n<60&&(r=(r+6)%7),a&&(r=k(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=r,o}g(f),t.parse_date_code=v;var b=new Date(1899,11,31,0,0,0),y=b.getTime(),_=new Date(1900,2,1,0,0,0);function D(t,e){var a=t.getTime();return e?a-=1262304e5:t>=_&&(a+=864e5),(a-(y+6e4*(t.getTimezoneOffset()-b.getTimezoneOffset())))/864e5}function C(t){return t.toString(10)}t._general_int=C;var w=function(){var t=/\.(\d*[1-9])0+$/,e=/\.0*$/,a=/\.(\d*[1-9])0+/,n=/\.0*[Ee]/,i=/(E[+-])(\d)$/;function r(t){var e=t<0?12:11,a=l(t.toFixed(12));return a.length<=e?a:(a=t.toPrecision(10),a.length<=e?a:t.toExponential(5))}function s(e){var a=e.toFixed(11).replace(t,".$1");return a.length>(e<0?12:11)&&(a=e.toPrecision(6)),a}function o(t){for(var e=0;e!=t.length;++e)if(101===(32|t.charCodeAt(e)))return t.replace(a,".$1").replace(n,"E").replace("e","E").replace(i,"$10$2");return t}function l(a){return a.indexOf(".")>-1?a.replace(e,"").replace(t,".$1"):a}return function(t){var e,a=Math.floor(Math.log(Math.abs(t))*Math.LOG10E);return e=a>=-4&&a<=-1?t.toPrecision(10+a):Math.abs(a)<=9?r(t):10===a?t.toFixed(10).substr(0,12):s(t),l(o(e))}}();function x(t,e){switch(c(t)){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(0|t)===t?C(t):w(t);case"undefined":return"";case"object":if(null==t)return"";if(t instanceof Date)return L(14,D(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function k(){return 0}function S(t,e,a,i){var r,s="",o=0,l=0,u=a.y,d=0;switch(t){case 98:u=a.y+543;case 121:switch(e.length){case 1:case 2:r=u%100,d=2;break;default:r=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:r=a.m,d=e.length;break;case 3:return h[a.m-1][1];case 5:return h[a.m-1][0];default:return h[a.m-1][2]}break;case 100:switch(e.length){case 1:case 2:r=a.d,d=e.length;break;case 3:return p[a.q][0];default:return p[a.q][1]}break;case 104:switch(e.length){case 1:case 2:r=1+(a.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:r=a.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:r=a.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if("s"!=e&&"ss"!=e&&".0"!=e&&".00"!=e&&".000"!=e)throw"bad second format: "+e;return 0!==a.u||"s"!=e&&"ss"!=e?(l=i>=2?3===i?1e3:100:1===i?10:1,o=Math.round(l*(a.S+a.u)),o>=60*l&&(o=0),"s"===e?0===o?"0":""+o/l:(s=n(o,2+i),"ss"===e?s.substr(0,2):"."+s.substr(2,e.length-1))):n(a.S,e.length);case 90:switch(e){case"[h]":case"[hh]":r=24*a.D+a.H;break;case"[m]":case"[mm]":r=60*(24*a.D+a.H)+a.M;break;case"[s]":case"[ss]":r=60*(60*(24*a.D+a.H)+a.M)+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+e}d=3===e.length?1:2;break;case 101:r=u,d=1}return d>0?n(r,d):""}function A(t){var e=3;if(t.length<=e)return t;for(var a=t.length%e,n=t.substr(0,a);a!=t.length;a+=e)n+=(n.length>0?",":"")+t.substr(a,e);return n}t._general_num=w,t._general=x;var E=function(){var t=/%/g;function s(e,n,i){var r=n.replace(t,""),s=n.length-r.length;return E(e,r,i*Math.pow(10,2*s))+a("%",s)}function o(t,e,a){var n=e.length-1;while(44===e.charCodeAt(n-1))--n;return E(t,e.substr(0,n),a/Math.pow(10,3*(e.length-n)))}function l(t,e){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==e)return"0.0E+0";if(e<0)return"-"+l(t,-e);var i=t.indexOf(".");-1===i&&(i=t.indexOf("E"));var r=Math.floor(Math.log(e)*Math.LOG10E)%i;if(r<0&&(r+=i),a=(e/Math.pow(10,r)).toPrecision(n+1+(i+r)%i),-1===a.indexOf("e")){var s=Math.floor(Math.log(e)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(s-a.length+r):a+="E+"+(s-r);while("0."===a.substr(0,2))a=a.charAt(0)+a.substr(2,i)+"."+a.substr(2+i),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,a,n){return e+a+n.substr(0,(i+r)%i)+"."+n.substr(r)+"E"}))}else a=e.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var d=/# (\?+)( ?)\/( ?)(\d+)/;function c(t,e,r){var s=parseInt(t[4],10),o=Math.round(e*s),l=Math.floor(o/s),u=o-l*s,d=s;return r+(0===l?"":""+l)+" "+(0===u?a(" ",t[1].length+1+t[4].length):i(u,t[1].length)+t[2]+"/"+t[3]+n(d,t[4].length))}function p(t,e,n){return n+(0===e?"":""+e)+a(" ",t[1].length+2+t[4].length)}var h=/^#*0*\.([0#]+)/,g=/\).*[0#]/,f=/\(###\) ###\\?-####/;function v(t){for(var e,a="",n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(e)}return a}function b(t,e){var a=Math.pow(10,e);return""+Math.round(t*a)/a}function y(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?0:Math.round((t-Math.floor(t))*Math.pow(10,e))}function _(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function D(t){return t<2147483647&&t>-2147483648?""+(t>=0?0|t:t-1|0):""+Math.floor(t)}function C(t,p,w){if(40===t.charCodeAt(0)&&!p.match(g)){var x=p.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return w>=0?C("n",x,w):"("+C("n",x,-w)+")"}if(44===p.charCodeAt(p.length-1))return o(t,p,w);if(-1!==p.indexOf("%"))return s(t,p,w);if(-1!==p.indexOf("E"))return l(p,w);if(36===p.charCodeAt(0))return"$"+C(t,p.substr(" "==p.charAt(1)?2:1),w);var k,S,T,I,P=Math.abs(w),N=w<0?"-":"";if(p.match(/^00+$/))return N+u(P,p.length);if(p.match(/^[#?]+$/))return k=u(w,0),"0"===k&&(k=""),k.length>p.length?k:v(p.substr(0,p.length-k.length))+k;if(S=p.match(d))return c(S,P,N);if(p.match(/^#+0+$/))return N+u(P,p.length-p.indexOf("0"));if(S=p.match(h))return k=b(w,S[1].length).replace(/^([^\.]+)$/,"$1."+v(S[1])).replace(/\.$/,"."+v(S[1])).replace(/\.(\d*)$/,(function(t,e){return"."+e+a("0",v(S[1]).length-e.length)})),-1!==p.indexOf("0.")?k:k.replace(/^0\./,".");if(p=p.replace(/^#+([0.])/,"$1"),S=p.match(/^(0*)\.(#*)$/))return N+b(P,S[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,S[1].length?"0.":".");if(S=p.match(/^#{1,3},##0(\.?)$/))return N+A(u(P,0));if(S=p.match(/^#,##0\.([#0]*0)$/))return w<0?"-"+C(t,p,-w):A(""+(Math.floor(w)+_(w,S[1].length)))+"."+n(y(w,S[1].length),S[1].length);if(S=p.match(/^#,#*,#0/))return C(t,p.replace(/^#,#*,/,""),w);if(S=p.match(/^([0#]+)(\\?-([0#]+))+$/))return k=e(C(t,p.replace(/[\\-]/g,""),w)),T=0,e(e(p.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return T<k.length?k.charAt(T++):"0"===t?"0":""})));if(p.match(f))return k=C(t,"##########",w),"("+k.substr(0,3)+") "+k.substr(3,3)+"-"+k.substr(6);var R="";if(S=p.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return T=Math.min(S[4].length,7),I=m(P,Math.pow(10,T)-1,!1),k=""+N,R=E("n",S[1],I[1])," "==R.charAt(R.length-1)&&(R=R.substr(0,R.length-1)+"0"),k+=R+S[2]+"/"+S[3],R=r(I[2],T),R.length<S[4].length&&(R=v(S[4].substr(S[4].length-R.length))+R),k+=R,k;if(S=p.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return T=Math.min(Math.max(S[1].length,S[4].length),7),I=m(P,Math.pow(10,T)-1,!0),N+(I[0]||(I[1]?"":"0"))+" "+(I[1]?i(I[1],T)+S[2]+"/"+S[3]+r(I[2],T):a(" ",2*T+1+S[2].length+S[3].length));if(S=p.match(/^[#0?]+$/))return k=u(w,0),p.length<=k.length?k:v(p.substr(0,p.length-k.length))+k;if(S=p.match(/^([#0?]+)\.([#0]+)$/)){k=""+w.toFixed(Math.min(S[2].length,10)).replace(/([^0])0+$/,"$1"),T=k.indexOf(".");var B=p.indexOf(".")-T,O=p.length-k.length-B;return v(p.substr(0,B)+k+p.substr(p.length-O))}if(S=p.match(/^00,000\.([#0]*0)$/))return T=y(w,S[1].length),w<0?"-"+C(t,p,-w):A(D(w)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?n(0,3-t.length):"")+t}))+"."+n(T,S[1].length);switch(p){case"###,##0.00":return C(t,"#,##0.00",w);case"###,###":case"##,###":case"#,###":var M=A(u(P,0));return"0"!==M?N+M:"";case"###,###.00":return C(t,"###,##0.00",w).replace(/^0\./,".");case"#,###.00":return C(t,"#,##0.00",w).replace(/^0\./,".");default:}throw new Error("unsupported format |"+p+"|")}function w(t,e,a){var n=e.length-1;while(44===e.charCodeAt(n-1))--n;return E(t,e.substr(0,n),a/Math.pow(10,3*(e.length-n)))}function x(e,n,i){var r=n.replace(t,""),s=n.length-r.length;return E(e,r,i*Math.pow(10,2*s))+a("%",s)}function k(t,e){var a,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(0==e)return"0.0E+0";if(e<0)return"-"+k(t,-e);var i=t.indexOf(".");-1===i&&(i=t.indexOf("E"));var r=Math.floor(Math.log(e)*Math.LOG10E)%i;if(r<0&&(r+=i),a=(e/Math.pow(10,r)).toPrecision(n+1+(i+r)%i),!a.match(/[Ee]/)){var s=Math.floor(Math.log(e)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(s-a.length+r):a+="E+"+(s-r),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,a,n){return e+a+n.substr(0,(i+r)%i)+"."+n.substr(r)+"E"}))}else a=e.toExponential(n);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function S(t,s,o){if(40===t.charCodeAt(0)&&!s.match(g)){var l=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return o>=0?S("n",l,o):"("+S("n",l,-o)+")"}if(44===s.charCodeAt(s.length-1))return w(t,s,o);if(-1!==s.indexOf("%"))return x(t,s,o);if(-1!==s.indexOf("E"))return k(s,o);if(36===s.charCodeAt(0))return"$"+S(t,s.substr(" "==s.charAt(1)?2:1),o);var u,c,b,y,_=Math.abs(o),D=o<0?"-":"";if(s.match(/^00+$/))return D+n(_,s.length);if(s.match(/^[#?]+$/))return u=""+o,0===o&&(u=""),u.length>s.length?u:v(s.substr(0,s.length-u.length))+u;if(c=s.match(d))return p(c,_,D);if(s.match(/^#+0+$/))return D+n(_,s.length-s.indexOf("0"));if(c=s.match(h))return u=(""+o).replace(/^([^\.]+)$/,"$1."+v(c[1])).replace(/\.$/,"."+v(c[1])),u=u.replace(/\.(\d*)$/,(function(t,e){return"."+e+a("0",v(c[1]).length-e.length)})),-1!==s.indexOf("0.")?u:u.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),c=s.match(/^(0*)\.(#*)$/))return D+(""+_).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=s.match(/^#{1,3},##0(\.?)$/))return D+A(""+_);if(c=s.match(/^#,##0\.([#0]*0)$/))return o<0?"-"+S(t,s,-o):A(""+o)+"."+a("0",c[1].length);if(c=s.match(/^#,#*,#0/))return S(t,s.replace(/^#,#*,/,""),o);if(c=s.match(/^([0#]+)(\\?-([0#]+))+$/))return u=e(S(t,s.replace(/[\\-]/g,""),o)),b=0,e(e(s.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return b<u.length?u.charAt(b++):"0"===t?"0":""})));if(s.match(f))return u=S(t,"##########",o),"("+u.substr(0,3)+") "+u.substr(3,3)+"-"+u.substr(6);var C="";if(c=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(c[4].length,7),y=m(_,Math.pow(10,b)-1,!1),u=""+D,C=E("n",c[1],y[1])," "==C.charAt(C.length-1)&&(C=C.substr(0,C.length-1)+"0"),u+=C+c[2]+"/"+c[3],C=r(y[2],b),C.length<c[4].length&&(C=v(c[4].substr(c[4].length-C.length))+C),u+=C,u;if(c=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(Math.max(c[1].length,c[4].length),7),y=m(_,Math.pow(10,b)-1,!0),D+(y[0]||(y[1]?"":"0"))+" "+(y[1]?i(y[1],b)+c[2]+"/"+c[3]+r(y[2],b):a(" ",2*b+1+c[2].length+c[3].length));if(c=s.match(/^[#0?]+$/))return u=""+o,s.length<=u.length?u:v(s.substr(0,s.length-u.length))+u;if(c=s.match(/^([#0]+)\.([#0]+)$/)){u=""+o.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),b=u.indexOf(".");var T=s.indexOf(".")-b,I=s.length-u.length-T;return v(s.substr(0,T)+u+s.substr(s.length-I))}if(c=s.match(/^00,000\.([#0]*0)$/))return o<0?"-"+S(t,s,-o):A(""+o).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?n(0,3-t.length):"")+t}))+"."+n(0,c[1].length);switch(s){case"###,###":case"##,###":case"#,###":var P=A(""+_);return"0"!==P?D+P:"";default:if(s.match(/\.[0#?]*$/))return S(t,s.slice(0,s.lastIndexOf(".")),o)+v(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}return function(t,e,a){return(0|a)===a?S(t,e,a):C(t,e,a)}}();function T(t){for(var e=[],a=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:a=!a;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),!0===a)throw new Error("Format |"+t+"| unterminated string ");return e}t._split=T;var I=/\[[HhMmSs]*\]/;function P(t){var e=0,a="",n="";while(e<t.length)switch(a=t.charAt(e)){case"G":d(t,e)&&(e+=6),e++;break;case'"':for(;34!==t.charCodeAt(++e)&&e<t.length;)++e;++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if("1"===t.charAt(e+1)||"2"===t.charAt(e+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===t.substr(e,3).toUpperCase())return!0;if("AM/PM"===t.substr(e,5).toUpperCase())return!0;++e;break;case"[":n=a;while("]"!==t.charAt(e++)&&e<t.length)n+=t.charAt(e);if(n.match(I))return!0;break;case".":case"0":case"#":while(e<t.length&&("0#?.,E+-%".indexOf(a=t.charAt(++e))>-1||"\\"==a&&"-"==t.charAt(e+1)&&"0#".indexOf(t.charAt(e+2))>-1));break;case"?":while(t.charAt(++e)===a);break;case"*":++e," "!=t.charAt(e)&&"*"!=t.charAt(e)||++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":while(e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1);break;case" ":++e;break;default:++e;break}return!1}function N(t,e,a,n){var i,r,s,o=[],l="",u=0,c="",p="t",h="H";while(u<t.length)switch(c=t.charAt(u)){case"G":if(!d(t,u))throw new Error("unrecognized character "+c+" in "+t);o[o.length]={t:"G",v:"General"},u+=7;break;case'"':for(l="";34!==(s=t.charCodeAt(++u))&&u<t.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++u;break;case"\\":var g=t.charAt(++u),f="("===g||")"===g?g:"t";o[o.length]={t:f,v:g},++u;break;case"_":o[o.length]={t:"t",v:" "},u+=2;break;case"@":o[o.length]={t:"T",v:e},++u;break;case"B":case"b":if("1"===t.charAt(u+1)||"2"===t.charAt(u+1)){if(null==i&&(i=v(e,a,"2"===t.charAt(u+1)),null==i))return"";o[o.length]={t:"X",v:t.substr(u,2)},p=c,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0)return"";if(null==i&&(i=v(e,a),null==i))return"";l=c;while(++u<t.length&&t.charAt(u).toLowerCase()===c)l+=c;"m"===c&&"h"===p.toLowerCase()&&(c="M"),"h"===c&&(c=h),o[o.length]={t:c,v:l},p=c;break;case"A":case"a":var m={t:c,v:c};if(null==i&&(i=v(e,a)),"A/P"===t.substr(u,3).toUpperCase()?(null!=i&&(m.v=i.H>=12?"P":"A"),m.t="T",h="h",u+=3):"AM/PM"===t.substr(u,5).toUpperCase()?(null!=i&&(m.v=i.H>=12?"PM":"AM"),m.t="T",u+=5,h="h"):(m.t="t",++u),null==i&&"T"===m.t)return"";o[o.length]=m,p=c;break;case"[":l=c;while("]"!==t.charAt(u++)&&u<t.length)l+=t.charAt(u);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(I)){if(null==i&&(i=v(e,a),null==i))return"";o[o.length]={t:"Z",v:l.toLowerCase()},p=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",P(t)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=i){l=c;while(++u<t.length&&"0"===(c=t.charAt(u)))l+=c;o[o.length]={t:"s",v:l};break}case"0":case"#":l=c;while(++u<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(u))>-1||"\\"==c&&"-"==t.charAt(u+1)&&u<t.length-2&&"0#".indexOf(t.charAt(u+2))>-1)l+=c;o[o.length]={t:"n",v:l};break;case"?":l=c;while(t.charAt(++u)===c)l+=c;o[o.length]={t:c,v:l},p=c;break;case"*":++u," "!=t.charAt(u)&&"*"!=t.charAt(u)||++u;break;case"(":case")":o[o.length]={t:1===n?"t":c,v:c},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":l=c;while(u<t.length&&"0123456789".indexOf(t.charAt(++u))>-1)l+=t.charAt(u);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:c,v:c},++u;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c))throw new Error("unrecognized character "+c+" in "+t);o[o.length]={t:"t",v:c},++u;break}var b,y=0,_=0;for(u=o.length-1,p="t";u>=0;--u)switch(o[u].t){case"h":case"H":o[u].t=h,p="h",y<1&&(y=1);break;case"s":(b=o[u].v.match(/\.0+$/))&&(_=Math.max(_,b[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":p=o[u].t;break;case"m":"s"===p&&(o[u].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&o[u].v.match(/[Hh]/)&&(y=1),y<2&&o[u].v.match(/[Mm]/)&&(y=2),y<3&&o[u].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M);break}var D,C="";for(u=0;u<o.length;++u)switch(o[u].t){case"t":case"T":case" ":case"D":break;case"X":o[u].v="",o[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[u].v=S(o[u].t.charCodeAt(0),o[u].v,i,_),o[u].t="t";break;case"n":case"(":case"?":D=u+1;while(null!=o[D]&&("?"===(c=o[D].t)||"D"===c||(" "===c||"t"===c)&&null!=o[D+1]&&("?"===o[D+1].t||"t"===o[D+1].t&&"/"===o[D+1].v)||"("===o[u].t&&(" "===c||"n"===c||")"===c)||"t"===c&&("/"===o[D].v||" "===o[D].v&&null!=o[D+1]&&"?"==o[D+1].t)))o[u].v+=o[D].v,o[D]={v:"",t:";"},++D;C+=o[u].v,u=D-1;break;case"G":o[u].t="t",o[u].v=x(e,a);break}var w,k,A="";if(C.length>0){40==C.charCodeAt(0)?(w=e<0&&45===C.charCodeAt(0)?-e:e,k=E("(",C,w)):(w=e<0&&n>1?-e:e,k=E("n",C,w),w<0&&o[0]&&"t"==o[0].t&&(k=k.substr(1),o[0].v="-"+o[0].v)),D=k.length-1;var T=o.length;for(u=0;u<o.length;++u)if(null!=o[u]&&"t"!=o[u].t&&o[u].v.indexOf(".")>-1){T=u;break}var N=o.length;if(T===o.length&&-1===k.indexOf("E")){for(u=o.length-1;u>=0;--u)null!=o[u]&&-1!=="n?(".indexOf(o[u].t)&&(D>=o[u].v.length-1?(D-=o[u].v.length,o[u].v=k.substr(D+1,o[u].v.length)):D<0?o[u].v="":(o[u].v=k.substr(0,D+1),D=-1),o[u].t="t",N=u);D>=0&&N<o.length&&(o[N].v=k.substr(0,D+1)+o[N].v)}else if(T!==o.length&&-1===k.indexOf("E")){for(D=k.indexOf(".")-1,u=T;u>=0;--u)if(null!=o[u]&&-1!=="n?(".indexOf(o[u].t)){for(r=o[u].v.indexOf(".")>-1&&u===T?o[u].v.indexOf(".")-1:o[u].v.length-1,A=o[u].v.substr(r+1);r>=0;--r)D>=0&&("0"===o[u].v.charAt(r)||"#"===o[u].v.charAt(r))&&(A=k.charAt(D--)+A);o[u].v=A,o[u].t="t",N=u}for(D>=0&&N<o.length&&(o[N].v=k.substr(0,D+1)+o[N].v),D=k.indexOf(".")+1,u=T;u<o.length;++u)if(null!=o[u]&&(-1!=="n?(".indexOf(o[u].t)||u===T)){for(r=o[u].v.indexOf(".")>-1&&u===T?o[u].v.indexOf(".")+1:0,A=o[u].v.substr(0,r);r<o[u].v.length;++r)D<k.length&&(A+=k.charAt(D++));o[u].v=A,o[u].t="t",N=u}}}for(u=0;u<o.length;++u)null!=o[u]&&"n(?".indexOf(o[u].t)>-1&&(w=n>1&&e<0&&u>0&&"-"===o[u-1].v?-e:e,o[u].v=E(o[u].t,o[u].v,w),o[u].t="t");var R="";for(u=0;u!==o.length;++u)null!=o[u]&&(R+=o[u].v);return R}t.is_date=P,t._eval=N;var R=/\[[=<>]/,B=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function O(t,e){if(null==e)return!1;var a=parseFloat(e[2]);switch(e[1]){case"=":if(t==a)return!0;break;case">":if(t>a)return!0;break;case"<":if(t<a)return!0;break;case"<>":if(t!=a)return!0;break;case">=":if(t>=a)return!0;break;case"<=":if(t<=a)return!0;break}return!1}function M(t,e){var a=T(t),n=a.length,i=a[n-1].indexOf("@");if(n<4&&i>-1&&--n,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if("number"!==typeof e)return[4,4===a.length||i>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=i>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=i>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=i>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break;case 4:break}var r=e>0?a[0]:e<0?a[1]:a[2];if(-1===a[0].indexOf("[")&&-1===a[1].indexOf("["))return[n,r];if(null!=a[0].match(R)||null!=a[1].match(R)){var s=a[0].match(B),o=a[1].match(B);return O(e,s)?[n,a[0]]:O(e,o)?[n,a[1]]:[n,a[null!=s&&null!=o?2:1]]}return[n,r]}function L(t,e,a){null==a&&(a={});var n="";switch(c(t)){case"string":n="m/d/yy"==t&&a.dateNF?a.dateNF:t;break;case"number":n=14==t&&a.dateNF?a.dateNF:(null!=a.table?a.table:f)[t];break}if(d(n,0))return x(e,a);e instanceof Date&&(e=D(e,a.date1904));var i=M(n,e);if(d(i[1]))return x(e,a);if(!0===e)e="TRUE";else if(!1===e)e="FALSE";else if(""===e||null==e)return"";return N(i[1],e,a,i[0])}function U(t,e){if("number"!=typeof e){e=+e||-1;for(var a=0;a<392;++a)if(void 0!=f[a]){if(f[a]==t){e=a;break}}else e<0&&(e=a);e<0&&(e=391)}return f[e]=t,e}t.load=U,t._table=f,t.get_table=function(){return f},t.load_table=function(t){for(var e=0;392!=e;++e)void 0!==t[e]&&U(t[e],e)},t.init_table=g,t.format=L};F(U);var H={"General Number":"General","General Date":U._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":U._table[15],"Short Date":U._table[14],"Long Time":U._table[19],"Medium Time":U._table[18],"Short Time":U._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:U._table[2],Standard:U._table[4],Percent:U._table[10],Scientific:U._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},j={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},W=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function z(t){var e="number"==typeof t?U._table[t]:t;return e=e.replace(W,"(\\d+)"),new RegExp("^"+e+"$")}function V(t,e,a){var n=-1,i=-1,r=-1,s=-1,o=-1,l=-1;(e.match(W)||[]).forEach((function(t,e){var u=parseInt(a[e+1],10);switch(t.toLowerCase().charAt(0)){case"y":n=u;break;case"d":r=u;break;case"h":s=u;break;case"s":l=u;break;case"m":s>=0?o=u:i=u;break}})),l>=0&&-1==o&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(r>=1?r:1)).slice(-2);7==u.length&&(u="0"+u),8==u.length&&(u="20"+u);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==o&&-1==l?u:-1==n&&-1==i&&-1==r?d:u+"T"+d}var q,G=!0;(function(t){t(q={})})((function(t){function e(){for(var t=0,e=new Array(256),a=0;256!=a;++a)t=a,t=1&t?-306674912^t>>>1:t>>>1,t=1&t?-306674912^t>>>1:t>>>1,t=1&t?-306674912^t>>>1:t>>>1,t=1&t?-306674912^t>>>1:t>>>1,t=1&t?-306674912^t>>>1:t>>>1,t=1&t?-306674912^t>>>1:t>>>1,t=1&t?-306674912^t>>>1:t>>>1,t=1&t?-306674912^t>>>1:t>>>1,e[a]=t;return"undefined"!==typeof Int32Array?new Int32Array(e):e}t.version="1.2.0";var a=e();function n(t,e){for(var n=-1^e,i=t.length-1,r=0;r<i;)n=n>>>8^a[255&(n^t.charCodeAt(r++))],n=n>>>8^a[255&(n^t.charCodeAt(r++))];return r===i&&(n=n>>>8^a[255&(n^t.charCodeAt(r))]),-1^n}function i(t,e){if(t.length>1e4)return r(t,e);for(var n=-1^e,i=t.length-3,s=0;s<i;)n=n>>>8^a[255&(n^t[s++])],n=n>>>8^a[255&(n^t[s++])],n=n>>>8^a[255&(n^t[s++])],n=n>>>8^a[255&(n^t[s++])];while(s<i+3)n=n>>>8^a[255&(n^t[s++])];return-1^n}function r(t,e){for(var n=-1^e,i=t.length-7,r=0;r<i;)n=n>>>8^a[255&(n^t[r++])],n=n>>>8^a[255&(n^t[r++])],n=n>>>8^a[255&(n^t[r++])],n=n>>>8^a[255&(n^t[r++])],n=n>>>8^a[255&(n^t[r++])],n=n>>>8^a[255&(n^t[r++])],n=n>>>8^a[255&(n^t[r++])],n=n>>>8^a[255&(n^t[r++])];while(r<i+7)n=n>>>8^a[255&(n^t[r++])];return-1^n}function s(t,e){for(var n,i,r=-1^e,s=0,o=t.length;s<o;)n=t.charCodeAt(s++),n<128?r=r>>>8^a[255&(r^n)]:n<2048?(r=r>>>8^a[255&(r^(192|n>>6&31))],r=r>>>8^a[255&(r^(128|63&n))]):n>=55296&&n<57344?(n=64+(1023&n),i=1023&t.charCodeAt(s++),r=r>>>8^a[255&(r^(240|n>>8&7))],r=r>>>8^a[255&(r^(128|n>>2&63))],r=r>>>8^a[255&(r^(128|i>>6&15|(3&n)<<4))],r=r>>>8^a[255&(r^(128|63&i))]):(r=r>>>8^a[255&(r^(224|n>>12&15))],r=r>>>8^a[255&(r^(128|n>>6&63))],r=r>>>8^a[255&(r^(128|63&n))]);return-1^r}t.table=a,t.bstr=n,t.buf=i,t.str=s}));var K,X=function(){var t,e={};function n(t,e){for(var a=t.split("/"),n=e.split("/"),i=0,r=0,s=Math.min(a.length,n.length);i<s;++i){if(r=a[i].length-n[i].length)return r;if(a[i]!=n[i])return a[i]<n[i]?-1:1}return a.length-n.length}function i(t){if("/"==t.charAt(t.length-1))return-1===t.slice(0,-1).indexOf("/")?t:i(t.slice(0,-1));var e=t.lastIndexOf("/");return-1===e?t:t.slice(0,e+1)}function r(t){if("/"==t.charAt(t.length-1))return r(t.slice(0,-1));var e=t.lastIndexOf("/");return-1===e?t:t.slice(e+1)}function s(t,e){"string"===typeof e&&(e=new Date(e));var a=e.getHours();a=a<<6|e.getMinutes(),a=a<<5|e.getSeconds()>>>1,t._W(2,a);var n=e.getFullYear()-1980;n=n<<4|e.getMonth()+1,n=n<<5|e.getDate(),t._W(2,n)}function o(t){var e=65535&t._R(2),a=65535&t._R(2),n=new Date,i=31&a;a>>>=5;var r=15&a;a>>>=4,n.setMilliseconds(0),n.setFullYear(a+1980),n.setMonth(r-1),n.setDate(i);var s=31&e;e>>>=5;var o=63&e;return e>>>=6,n.setHours(e),n.setMinutes(o),n.setSeconds(s<<1),n}function l(t){Ze(t,0);var e={},a=0;while(t.l<=t.length-4){var n=t._R(2),i=t._R(2),r=t.l+i,s={};switch(n){case 21589:a=t._R(1),1&a&&(s.mtime=t._R(4)),i>5&&(2&a&&(s.atime=t._R(4)),4&a&&(s.ctime=t._R(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));break}t.l=r,e[n]=s}return e}function u(){return t||(t=a("f1ac"))}function d(t,e){if(80==t[0]&&75==t[1])return At(t,e);if(t.length<512)throw new Error("CFB file size "+t.length+" < 512");var a=3,n=512,i=0,r=0,s=0,o=0,l=0,u=[],d=t.slice(0,512);Ze(d,0);var f=c(d);switch(a=f[0],a){case 3:n=512;break;case 4:n=4096;break;case 0:if(0==f[1])return At(t,e);default:throw new Error("Major Version: Expected 3 or 4 saw "+a)}512!==n&&(d=t.slice(0,n),Ze(d,28));var v=t.slice(0,n);p(d,a);var _=d._R(4,"i");if(3===a&&0!==_)throw new Error("# Directory Sectors: Expected 0 saw "+_);d.l+=4,s=d._R(4,"i"),d.l+=4,d.chk("00100000","Mini Stream Cutoff Size: "),o=d._R(4,"i"),i=d._R(4,"i"),l=d._R(4,"i"),r=d._R(4,"i");for(var D=-1,C=0;C<109;++C){if(D=d._R(4,"i"),D<0)break;u[C]=D}var w=h(t,n);m(l,r,w,n,u);var x=b(w,s,u,n);x[s].name="!Directory",i>0&&o!==U&&(x[o].name="!MiniFAT"),x[u[0]].name="!FAT",x.fat_addrs=u,x.ssz=n;var k={},S=[],A=[],E=[];y(s,x,w,S,i,k,A,o),g(A,E,S),S.shift();var T={FileIndex:A,FullPaths:E};return e&&e.raw&&(T.raw={header:v,sectors:w}),T}function c(t){if(80==t[t.l]&&75==t[t.l+1])return[0,0];t.chk(F,"Header Signature: "),t.l+=16;var e=t._R(2,"u");return[t._R(2,"u"),e]}function p(t,e){var a=9;switch(t.l+=2,a=t._R(2)){case 9:if(3!=e)throw new Error("Sector Shift: Expected 9 saw "+a);break;case 12:if(4!=e)throw new Error("Sector Shift: Expected 12 saw "+a);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+a)}t.chk("0600","Mini Sector Shift: "),t.chk("000000000000","Reserved: ")}function h(t,e){for(var a=Math.ceil(t.length/e)-1,n=[],i=1;i<a;++i)n[i-1]=t.slice(i*e,(i+1)*e);return n[a-1]=t.slice(a*e),n}function g(t,e,a){for(var n=0,i=0,r=0,s=0,o=0,l=a.length,u=[],d=[];n<l;++n)u[n]=d[n]=n,e[n]=a[n];for(;o<d.length;++o)n=d[o],i=t[n].L,r=t[n].R,s=t[n].C,u[n]===n&&(-1!==i&&u[i]!==i&&(u[n]=u[i]),-1!==r&&u[r]!==r&&(u[n]=u[r])),-1!==s&&(u[s]=n),-1!==i&&n!=u[n]&&(u[i]=u[n],d.lastIndexOf(i)<o&&d.push(i)),-1!==r&&n!=u[n]&&(u[r]=u[n],d.lastIndexOf(r)<o&&d.push(r));for(n=1;n<l;++n)u[n]===n&&(-1!==r&&u[r]!==r?u[n]=u[r]:-1!==i&&u[i]!==i&&(u[n]=u[i]));for(n=1;n<l;++n)if(0!==t[n].type){if(o=n,o!=u[o])do{o=u[o],e[n]=e[o]+"/"+e[n]}while(0!==o&&-1!==u[o]&&o!=u[o]);u[n]=-1}for(e[0]+="/",n=1;n<l;++n)2!==t[n].type&&(e[n]+="/")}function f(t,e,a){var n=t.start,i=t.size,r=[],s=n;while(a&&i>0&&s>=0)r.push(e.slice(s*B,s*B+B)),i-=B,s=ze(a,4*s);return 0===r.length?ta(0):O(r).slice(0,t.size)}function m(t,e,a,n,i){var r=U;if(t===U){if(0!==e)throw new Error("DIFAT chain shorter than expected")}else if(-1!==t){var s=a[t],o=(n>>>2)-1;if(!s)return;for(var l=0;l<o;++l){if((r=ze(s,4*l))===U)break;i.push(r)}m(ze(s,n-4),e-1,a,n,i)}}function v(t,e,a,n,i){var r=[],s=[];i||(i=[]);var o=n-1,l=0,u=0;for(l=e;l>=0;){i[l]=!0,r[r.length]=l,s.push(t[l]);var d=a[Math.floor(4*l/n)];if(u=4*l&o,n<4+u)throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!t[d])break;l=ze(t[d],u)}return{nodes:r,data:De([s])}}function b(t,e,a,n){var i=t.length,r=[],s=[],o=[],l=[],u=n-1,d=0,c=0,p=0,h=0;for(d=0;d<i;++d)if(o=[],p=d+e,p>=i&&(p-=i),!s[p]){for(l=[],c=p;c>=0;){s[c]=!0,o[o.length]=c,l.push(t[c]);var g=a[Math.floor(4*c/n)];if(h=4*c&u,n<4+h)throw new Error("FAT boundary crossed: "+c+" 4 "+n);if(!t[g])break;c=ze(t[g],h)}r[p]={nodes:o,data:De([l])}}return r}function y(t,e,a,n,i,r,s,o){for(var l,u=0,d=n.length?2:0,c=e[t].data,p=0,h=0;p<c.length;p+=128){var g=c.slice(p,p+128);Ze(g,64),h=g._R(2),l=we(g,0,h-d),n.push(l);var m={name:l,type:g._R(1),color:g._R(1),L:g._R(4,"i"),R:g._R(4,"i"),C:g._R(4,"i"),clsid:g._R(16),state:g._R(4,"i"),start:0,size:0},b=g._R(2)+g._R(2)+g._R(2)+g._R(2);0!==b&&(m.ct=_(g,g.l-8));var y=g._R(2)+g._R(2)+g._R(2)+g._R(2);0!==y&&(m.mt=_(g,g.l-8)),m.start=g._R(4,"i"),m.size=g._R(4,"i"),m.size<0&&m.start<0&&(m.size=m.type=0,m.start=U,m.name=""),5===m.type?(u=m.start,i>0&&u!==U&&(e[u].name="!StreamData")):m.size>=4096?(m.storage="fat",void 0===e[m.start]&&(e[m.start]=v(a,m.start,e.fat_addrs,e.ssz)),e[m.start].name=m.name,m.content=e[m.start].data.slice(0,m.size)):(m.storage="minifat",m.size<0?m.size=0:u!==U&&m.start!==U&&e[u]&&(m.content=f(m,e[u].data,(e[o]||{}).data))),m.content&&Ze(m.content,0),r[l]=m,s.push(m)}}function _(t,e){return new Date(1e3*(We(t,e+4)/1e7*Math.pow(2,32)+We(t,e)/1e7-11644473600))}function D(e,a){return u(),d(t.readFileSync(e),a)}function C(t,e){switch(e&&e.type||"base64"){case"file":return D(t,e);case"base64":return d(I(x.decode(t)),e);case"binary":return d(I(t),e)}return d(t,e)}function w(t,e){var a=e||{},n=a.root||"Root Entry";if(t.FullPaths||(t.FullPaths=[]),t.FileIndex||(t.FileIndex=[]),t.FullPaths.length!==t.FileIndex.length)throw new Error("inconsistent CFB structure");0===t.FullPaths.length&&(t.FullPaths[0]=n+"/",t.FileIndex[0]={name:n,type:5}),a.CLSID&&(t.FileIndex[0].clsid=a.CLSID),S(t)}function S(t){var e="Sh33tJ5";if(!X.find(t,"/"+e)){var a=ta(4);a[0]=55,a[1]=a[3]=50,a[2]=54,t.FileIndex.push({name:e,type:2,content:a,size:4,L:69,R:69,C:69}),t.FullPaths.push(t.FullPaths[0]+e),A(t)}}function A(t,e){w(t);for(var a=!1,s=!1,o=t.FullPaths.length-1;o>=0;--o){var l=t.FileIndex[o];switch(l.type){case 0:s?a=!0:(t.FileIndex.pop(),t.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(l.R*l.L*l.C)&&(a=!0),l.R>-1&&l.L>-1&&l.R==l.L&&(a=!0);break;default:a=!0;break}}if(a||e){var u=new Date(1987,1,19),d=0,c=[];for(o=0;o<t.FullPaths.length;++o)0!==t.FileIndex[o].type&&c.push([t.FullPaths[o],t.FileIndex[o]]);for(o=0;o<c.length;++o){var p=i(c[o][0]);for(s=!1,d=0;d<c.length;++d)c[d][0]===p&&(s=!0);s||c.push([p,{name:r(p).replace("/",""),type:1,clsid:H,ct:u,mt:u,content:null}])}for(c.sort((function(t,e){return n(t[0],e[0])})),t.FullPaths=[],t.FileIndex=[],o=0;o<c.length;++o)t.FullPaths[o]=c[o][0],t.FileIndex[o]=c[o][1];for(o=0;o<c.length;++o){var h=t.FileIndex[o],g=t.FullPaths[o];if(h.name=r(g).replace("/",""),h.L=h.R=h.C=-(h.color=1),h.size=h.content?h.content.length:0,h.start=0,h.clsid=h.clsid||H,0===o)h.C=c.length>1?1:-1,h.size=0,h.type=5;else if("/"==g.slice(-1)){for(d=o+1;d<c.length;++d)if(i(t.FullPaths[d])==g)break;for(h.C=d>=c.length?-1:d,d=o+1;d<c.length;++d)if(i(t.FullPaths[d])==i(g))break;h.R=d>=c.length?-1:d,h.type=1}else i(t.FullPaths[o+1]||"")==i(g)&&(h.R=o+1),h.type=2}}}function P(t,e){var a=e||{};if(A(t),"zip"==a.fileType)return Tt(t,a);var n=function(t){for(var e=0,a=0,n=0;n<t.FileIndex.length;++n){var i=t.FileIndex[n];if(i.content){var r=i.content.length;r>0&&(r<4096?e+=r+63>>6:a+=r+511>>9)}}var s=t.FullPaths.length+3>>2,o=e+7>>3,l=e+127>>7,u=o+a+s+l,d=u+127>>7,c=d<=109?0:Math.ceil((d-109)/127);while(u+d+c+127>>7>d)c=++d<=109?0:Math.ceil((d-109)/127);var p=[1,c,d,l,s,a,e,0];return t.FileIndex[0].size=e<<6,p[7]=(t.FileIndex[0].start=p[0]+p[1]+p[2]+p[3]+p[4]+p[5])+(p[6]+7>>3),p}(t),i=ta(n[7]<<9),r=0,s=0;for(r=0;r<8;++r)i._W(1,$[r]);for(r=0;r<8;++r)i._W(2,0);for(i._W(2,62),i._W(2,3),i._W(2,65534),i._W(2,9),i._W(2,6),r=0;r<3;++r)i._W(2,0);for(i._W(4,0),i._W(4,n[2]),i._W(4,n[0]+n[1]+n[2]+n[3]-1),i._W(4,0),i._W(4,4096),i._W(4,n[3]?n[0]+n[1]+n[2]-1:U),i._W(4,n[3]),i._W(-4,n[1]?n[0]-1:U),i._W(4,n[1]),r=0;r<109;++r)i._W(-4,r<n[2]?n[1]+r:-1);if(n[1])for(s=0;s<n[1];++s){for(;r<236+127*s;++r)i._W(-4,r<n[2]?n[1]+r:-1);i._W(-4,s===n[1]-1?U:s+1)}var o=function(t){for(s+=t;r<s-1;++r)i._W(-4,r+1);t&&(++r,i._W(-4,U))};for(s=r=0,s+=n[1];r<s;++r)i._W(-4,j.DIFSECT);for(s+=n[2];r<s;++r)i._W(-4,j.FATSECT);o(n[3]),o(n[4]);for(var l=0,u=0,d=t.FileIndex[0];l<t.FileIndex.length;++l)d=t.FileIndex[l],d.content&&(u=d.content.length,u<4096||(d.start=s,o(u+511>>9)));o(n[6]+7>>3);while(511&i.l)i._W(-4,j.ENDOFCHAIN);for(s=r=0,l=0;l<t.FileIndex.length;++l)d=t.FileIndex[l],d.content&&(u=d.content.length,!u||u>=4096||(d.start=s,o(u+63>>6)));while(511&i.l)i._W(-4,j.ENDOFCHAIN);for(r=0;r<n[4]<<2;++r){var c=t.FullPaths[r];if(c&&0!==c.length){d=t.FileIndex[r],0===r&&(d.start=d.size?d.start-1:U);var p=0===r&&a.root||d.name;if(u=2*(p.length+1),i._W(64,p,"utf16le"),i._W(2,u),i._W(1,d.type),i._W(1,d.color),i._W(-4,d.L),i._W(-4,d.R),i._W(-4,d.C),d.clsid)i._W(16,d.clsid,"hex");else for(l=0;l<4;++l)i._W(4,0);i._W(4,d.state||0),i._W(4,0),i._W(4,0),i._W(4,0),i._W(4,0),i._W(4,d.start),i._W(4,d.size),i._W(4,0)}else{for(l=0;l<17;++l)i._W(4,0);for(l=0;l<3;++l)i._W(4,-1);for(l=0;l<12;++l)i._W(4,0)}}for(r=1;r<t.FileIndex.length;++r)if(d=t.FileIndex[r],d.size>=4096){for(i.l=d.start+1<<9,l=0;l<d.size;++l)i._W(1,d.content[l]);for(;511&l;++l)i._W(1,0)}for(r=1;r<t.FileIndex.length;++r)if(d=t.FileIndex[r],d.size>0&&d.size<4096){for(l=0;l<d.size;++l)i._W(1,d.content[l]);for(;63&l;++l)i._W(1,0)}while(i.l<i.length)i._W(1,0);return i}function N(t,e){var a=t.FullPaths.map((function(t){return t.toUpperCase()})),n=a.map((function(t){var e=t.split("/");return e[e.length-("/"==t.slice(-1)?2:1)]})),i=!1;47===e.charCodeAt(0)?(i=!0,e=a[0].slice(0,-1)+e):i=-1!==e.indexOf("/");var r=e.toUpperCase(),s=!0===i?a.indexOf(r):n.indexOf(r);if(-1!==s)return t.FileIndex[s];var o=!r.match(L);for(r=r.replace(M,""),o&&(r=r.replace(L,"!")),s=0;s<a.length;++s){if((o?a[s].replace(L,"!"):a[s]).replace(M,"")==r)return t.FileIndex[s];if((o?n[s].replace(L,"!"):n[s]).replace(M,"")==r)return t.FileIndex[s]}return null}e.version="1.1.3";var R,B=64,U=-2,F="d0cf11e0a1b11ae1",$=[208,207,17,224,161,177,26,225],H="00000000000000000000000000000000",j={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:F,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:H,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(e,a,n){u();var i=P(e,n);t.writeFileSync(a,i)}function z(t){for(var e=new Array(t.length),a=0;a<t.length;++a)e[a]=String.fromCharCode(t[a]);return e.join("")}function V(e,a){var n=P(e,a);switch(a&&a.type){case"file":return u(),t.writeFileSync(a.filename,n),n;case"binary":return z(n);case"base64":return x.encode(z(n))}return n}function G(t){try{var e=t.InflateRaw,a=new e;if(a._processChunk(new Uint8Array([3,0]),a._finishFlushFlag),!a.bytesRead)throw new Error("zlib does not expose bytesRead");R=t}catch(r){console.error("cannot use native zlib: "+(r.message||r))}}function K(t,e){if(!R)return kt(t,e);var a=R.InflateRaw,n=new a,i=n._processChunk(t.slice(t.l),n._finishFlushFlag);return t.l+=n.bytesRead,i}function Y(t){return R?R.deflateRawSync(t):ht(t)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function tt(t){var e=139536&(t<<1|t<<11)|558144&(t<<5|t<<15);return 255&(e>>16|e>>8|e)}for(var et="undefined"!==typeof Uint8Array,at=et?new Uint8Array(256):[],nt=0;nt<256;++nt)at[nt]=tt(nt);function it(t,e){var a=at[255&t];return e<=8?a>>>8-e:(a=a<<8|at[t>>8&255],e<=16?a>>>16-e:(a=a<<8|at[t>>16&255],a>>>24-e))}function rt(t,e){var a=7&e,n=e>>>3;return(t[n]|(a<=6?0:t[n+1]<<8))>>>a&3}function st(t,e){var a=7&e,n=e>>>3;return(t[n]|(a<=5?0:t[n+1]<<8))>>>a&7}function ot(t,e){var a=7&e,n=e>>>3;return(t[n]|(a<=4?0:t[n+1]<<8))>>>a&15}function lt(t,e){var a=7&e,n=e>>>3;return(t[n]|(a<=3?0:t[n+1]<<8))>>>a&31}function ut(t,e){var a=7&e,n=e>>>3;return(t[n]|(a<=1?0:t[n+1]<<8))>>>a&127}function dt(t,e,a){var n=7&e,i=e>>>3,r=(1<<a)-1,s=t[i]>>>n;return a<8-n?s&r:(s|=t[i+1]<<8-n,a<16-n?s&r:(s|=t[i+2]<<16-n,a<24-n||(s|=t[i+3]<<24-n),s&r))}function ct(t,e){var a=t.length,n=2*a>e?2*a:e+5,i=0;if(a>=e)return t;if(k){var r=T(n);if(t.copy)t.copy(r);else for(;i<t.length;++i)r[i]=t[i];return r}if(et){var s=new Uint8Array(n);if(s.set)s.set(t);else for(;i<t.length;++i)s[i]=t[i];return s}return t.length=n,t}function pt(t){for(var e=new Array(t),a=0;a<t;++a)e[a]=0;return e}var ht=function(){var t=function(){return function(t,e){var a=0;while(a<t.length){var n=Math.min(65535,t.length-a),i=a+n==t.length;e._W(1,+i),e._W(2,n),e._W(2,65535&~n);while(n-- >0)e[e.l++]=t[a++]}return e.l}}();return function(e){var a=ta(50+Math.floor(1.1*e.length)),n=t(e,a);return a.slice(0,n)}}();function gt(t,e,a){var n=1,i=0,r=0,s=0,o=0,l=t.length,u=et?new Uint16Array(32):pt(32);for(r=0;r<32;++r)u[r]=0;for(r=l;r<a;++r)t[r]=0;l=t.length;var d=et?new Uint16Array(l):pt(l);for(r=0;r<l;++r)u[i=t[r]]++,n<i&&(n=i),d[r]=0;for(u[0]=0,r=1;r<=n;++r)u[r+16]=o=o+u[r-1]<<1;for(r=0;r<l;++r)o=t[r],0!=o&&(d[r]=u[o+16]++);var c=0;for(r=0;r<l;++r)if(c=t[r],0!=c)for(o=it(d[r],n)>>n-c,s=(1<<n+4-c)-1;s>=0;--s)e[o|s<<c]=15&c|r<<4;return n}var ft=et?new Uint16Array(512):pt(512),mt=et?new Uint16Array(32):pt(32);if(!et){for(var vt=0;vt<512;++vt)ft[vt]=0;for(vt=0;vt<32;++vt)mt[vt]=0}(function(){for(var t=[],e=0;e<32;e++)t.push(5);gt(t,mt,32);var a=[];for(e=0;e<=143;e++)a.push(8);for(;e<=255;e++)a.push(9);for(;e<=279;e++)a.push(7);for(;e<=287;e++)a.push(8);gt(a,ft,288)})();var bt=et?new Uint16Array(32768):pt(32768),yt=et?new Uint16Array(32768):pt(32768),_t=et?new Uint16Array(128):pt(128),Dt=1,Ct=1;function wt(t,e){var a=lt(t,e)+257;e+=5;var n=lt(t,e)+1;e+=5;var i=ot(t,e)+4;e+=4;for(var r=0,s=et?new Uint8Array(19):pt(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,u=et?new Uint8Array(8):pt(8),d=et?new Uint8Array(8):pt(8),c=s.length,p=0;p<i;++p)s[J[p]]=r=st(t,e),l<r&&(l=r),u[r]++,e+=3;var h=0;for(u[0]=0,p=1;p<=l;++p)d[p]=h=h+u[p-1]<<1;for(p=0;p<c;++p)0!=(h=s[p])&&(o[p]=d[h]++);var g=0;for(p=0;p<c;++p)if(g=s[p],0!=g){h=at[o[p]]>>8-g;for(var f=(1<<7-g)-1;f>=0;--f)_t[h|f<<g]=7&g|p<<3}var m=[];for(l=1;m.length<a+n;)switch(h=_t[ut(t,e)],e+=7&h,h>>>=3){case 16:r=3+rt(t,e),e+=2,h=m[m.length-1];while(r-- >0)m.push(h);break;case 17:r=3+st(t,e),e+=3;while(r-- >0)m.push(0);break;case 18:r=11+ut(t,e),e+=7;while(r-- >0)m.push(0);break;default:m.push(h),l<h&&(l=h);break}var v=m.slice(0,a),b=m.slice(a);for(p=a;p<286;++p)v[p]=0;for(p=n;p<30;++p)b[p]=0;return Dt=gt(v,bt,286),Ct=gt(b,yt,30),e}function xt(t,e){if(3==t[0]&&!(3&t[1]))return[E(e),2];var a=0,n=0,i=T(e||1<<18),r=0,s=i.length>>>0,o=0,l=0;while(0==(1&n))if(n=st(t,a),a+=3,n>>>1!=0)for(n>>>1==1?(o=9,l=5):(a=wt(t,a),o=Dt,l=Ct),!e&&s<r+32767&&(i=ct(i,r+32767),s=i.length);;){var u=dt(t,a,o),d=n>>>1==1?ft[u]:bt[u];if(a+=15&d,d>>>=4,0===(d>>>8&255))i[r++]=d;else{if(256==d)break;d-=257;var c=d<8?0:d-4>>2;c>5&&(c=0);var p=r+Z[d];c>0&&(p+=dt(t,a,c),a+=c),u=dt(t,a,l),d=n>>>1==1?mt[u]:yt[u],a+=15&d,d>>>=4;var h=d<4?0:d-2>>1,g=Q[d];h>0&&(g+=dt(t,a,h),a+=h),!e&&s<p&&(i=ct(i,p),s=i.length);while(r<p)i[r]=i[r-g],++r}}else{7&a&&(a+=8-(7&a));var f=t[a>>>3]|t[1+(a>>>3)]<<8;if(a+=32,!e&&s<r+f&&(i=ct(i,r+f),s=i.length),"function"===typeof t.copy)t.copy(i,r,a>>>3,(a>>>3)+f),r+=f,a+=8*f;else while(f-- >0)i[r++]=t[a>>>3],a+=8}return[e?i:i.slice(0,r),a+7>>>3]}function kt(t,e){var a=t.slice(t.l||0),n=xt(a,e);return t.l+=n[1],n[0]}function St(t,e){if(!t)throw new Error(e);"undefined"!==typeof console&&console.error(e)}function At(t,e){var a=t;Ze(a,0);var n=[],i=[],r={FileIndex:n,FullPaths:i};w(r,{root:e.root});var s=a.length-4;while((80!=a[s]||75!=a[s+1]||5!=a[s+2]||6!=a[s+3])&&s>=0)--s;a.l=s+4,a.l+=4;var o=a._R(2);a.l+=6;var u=a._R(4);for(a.l=u,s=0;s<o;++s){a.l+=20;var d=a._R(4),c=a._R(4),p=a._R(2),h=a._R(2),g=a._R(2);a.l+=8;var f=a._R(4),m=l(a.slice(a.l+p,a.l+p+h));a.l+=p+h+g;var v=a.l;a.l=f+4,Et(a,d,c,r,m),a.l=v}return r}function Et(t,e,a,n,i){t.l+=2;var r=t._R(2),s=t._R(2),u=o(t);if(8257&r)throw new Error("Unsupported ZIP encryption");for(var d=t._R(4),c=t._R(4),p=t._R(4),h=t._R(2),g=t._R(2),f="",m=0;m<h;++m)f+=String.fromCharCode(t[t.l++]);if(g){var v=l(t.slice(t.l,t.l+g));(v[21589]||{}).mt&&(u=v[21589].mt),((i||{})[21589]||{}).mt&&(u=i[21589].mt)}t.l+=g;var b=t.slice(t.l,t.l+c);switch(s){case 8:b=K(t,p);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}var y=!1;8&r&&(d=t._R(4),134695760==d&&(d=t._R(4),y=!0),c=t._R(4),p=t._R(4)),c!=e&&St(y,"Bad compressed size: "+e+" != "+c),p!=a&&St(y,"Bad uncompressed size: "+a+" != "+p);var _=q.buf(b,0);d>>0!=_>>0&&St(y,"Bad CRC32 checksum: "+d+" != "+_),Pt(n,f,b,{unsafe:!0,mt:u})}function Tt(t,e){var a=e||{},n=[],i=[],r=ta(1),o=a.compression?8:0,l=0,u=!1;u&&(l|=8);var d=0,c=0,p=0,h=0,g=t.FullPaths[0],f=g,m=t.FileIndex[0],v=[],b=0;for(d=1;d<t.FullPaths.length;++d)if(f=t.FullPaths[d].slice(g.length),m=t.FileIndex[d],m.size&&m.content&&"Sh33tJ5"!=f){var y=p,_=ta(f.length);for(c=0;c<f.length;++c)_._W(1,127&f.charCodeAt(c));_=_.slice(0,_.l),v[h]=q.buf(m.content,0);var D=m.content;8==o&&(D=Y(D)),r=ta(30),r._W(4,67324752),r._W(2,20),r._W(2,l),r._W(2,o),m.mt?s(r,m.mt):r._W(4,0),r._W(-4,8&l?0:v[h]),r._W(4,8&l?0:D.length),r._W(4,8&l?0:m.content.length),r._W(2,_.length),r._W(2,0),p+=r.length,n.push(r),p+=_.length,n.push(_),p+=D.length,n.push(D),8&l&&(r=ta(12),r._W(-4,v[h]),r._W(4,D.length),r._W(4,m.content.length),p+=r.l,n.push(r)),r=ta(46),r._W(4,33639248),r._W(2,0),r._W(2,20),r._W(2,l),r._W(2,o),r._W(4,0),r._W(-4,v[h]),r._W(4,D.length),r._W(4,m.content.length),r._W(2,_.length),r._W(2,0),r._W(2,0),r._W(2,0),r._W(2,0),r._W(4,0),r._W(4,y),b+=r.l,i.push(r),b+=_.length,i.push(_),++h}return r=ta(22),r._W(4,101010256),r._W(2,0),r._W(2,0),r._W(2,h),r._W(2,h),r._W(4,b),r._W(4,p),r._W(2,0),O([O(n),O(i),r])}function It(t){var e={};return w(e,t),e}function Pt(t,e,a,n){var i=n&&n.unsafe;i||w(t);var s=!i&&X.find(t,e);if(!s){var o=t.FullPaths[0];e.slice(0,o.length)==o?o=e:("/"!=o.slice(-1)&&(o+="/"),o=(o+e).replace("//","/")),s={name:r(e),type:2},t.FileIndex.push(s),t.FullPaths.push(o),i||X.utils.cfb_gc(t)}return s.content=a,s.size=a?a.length:0,n&&(n.CLSID&&(s.clsid=n.CLSID),n.mt&&(s.mt=n.mt),n.ct&&(s.ct=n.ct)),s}function Nt(t,e){w(t);var a=X.find(t,e);if(a)for(var n=0;n<t.FileIndex.length;++n)if(t.FileIndex[n]==a)return t.FileIndex.splice(n,1),t.FullPaths.splice(n,1),!0;return!1}function Rt(t,e,a){w(t);var n=X.find(t,e);if(n)for(var i=0;i<t.FileIndex.length;++i)if(t.FileIndex[i]==n)return t.FileIndex[i].name=r(a),t.FullPaths[i]=a,!0;return!1}function Bt(t){A(t,!0)}return e.find=N,e.read=C,e.parse=d,e.write=V,e.writeFile=W,e.utils={cfb_new:It,cfb_add:Pt,cfb_del:Nt,cfb_mov:Rt,cfb_gc:Bt,ReadShift:qe,CheckField:Je,prep_blob:Ze,bconcat:O,use_zlib:G,_deflateRaw:ht,_inflateRaw:kt,consts:j},e}();"undefined"===typeof G&&(t.exports=X);try{K=a("f1ac")}catch(zm){}function Y(t){return"string"===typeof t?P(t):Array.isArray(t)?R(t):t}function J(t,e,a){if("undefined"!==typeof K&&K.writeFileSync)return a?K.writeFileSync(t,e,a):K.writeFileSync(t,e);var n="utf8"==a?Qt(e):e;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(n,t);if("undefined"!==typeof Blob){var i=new Blob([Y(n)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if("undefined"!==typeof saveAs)return saveAs(i,t);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var r=URL.createObjectURL(i);if("object"===("undefined"===typeof chrome?"undefined":c(chrome))&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(r)}),6e4),chrome.downloads.download({url:r,filename:t,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=t,s.href=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(r)}),6e4),r}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=N(e)),o.write(e),o.close(),e}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+t)}function Z(t){if("undefined"!==typeof K)return K.readFileSync(t);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var e=File(t);e.open("r"),e.encoding="binary";var a=e.read();return e.close(),a}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("Cannot access file "+t)}function Q(t){for(var e=Object.keys(t),a=[],n=0;n<e.length;++n)t.hasOwnProperty(e[n])&&a.push(e[n]);return a}function tt(t,e){for(var a=[],n=Q(t),i=0;i!==n.length;++i)null==a[t[n[i]][e]]&&(a[t[n[i]][e]]=n[i]);return a}function et(t){for(var e=[],a=Q(t),n=0;n!==a.length;++n)e[t[a[n]]]=a[n];return e}function at(t){for(var e=[],a=Q(t),n=0;n!==a.length;++n)e[t[a[n]]]=parseInt(a[n],10);return e}function nt(t){for(var e=[],a=Q(t),n=0;n!==a.length;++n)null==e[t[a[n]]]&&(e[t[a[n]]]=[]),e[t[a[n]]].push(a[n]);return e}var it=new Date(1899,11,30,0,0,0),rt=it.getTime()+6e4*((new Date).getTimezoneOffset()-it.getTimezoneOffset());function st(t,e){var a=t.getTime();return e&&(a-=1263168e5),(a-rt)/864e5}function ot(t){var e=new Date;return e.setTime(24*t*60*60*1e3+rt),e}function lt(t){var e=0,a=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var r=1;r!=i.length;++r)if(i[r]){switch(a=1,r>3&&(n=!0),i[r].slice(i[r].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[r].slice(i[r].length-1));case"D":a*=24;case"H":a*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");a*=60;case"S":break}e+=a*parseInt(i[r],10)}return e}var ut=new Date("2017-02-19T19:06:09.000Z");isNaN(ut.getFullYear())&&(ut=new Date("2/19/17"));var dt=2017==ut.getFullYear();function ct(t,e){var a=new Date(t);if(dt)return e>0?a.setTime(a.getTime()+60*a.getTimezoneOffset()*1e3):e<0&&a.setTime(a.getTime()-60*a.getTimezoneOffset()*1e3),a;if(t instanceof Date)return t;if(1917==ut.getFullYear()&&!isNaN(a.getFullYear())){var n=a.getFullYear();return t.indexOf(""+n)>-1||a.setFullYear(a.getFullYear()+100),a}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],r=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(r=new Date(r.getTime()-60*r.getTimezoneOffset()*1e3)),r}function pt(t){for(var e="",a=0;a!=t.length;++a)e+=String.fromCharCode(t[a]);return e}function ht(t){if("undefined"!=typeof JSON&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if("object"!=c(t)||null==t)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var a in t)t.hasOwnProperty(a)&&(e[a]=ht(t[a]));return e}function gt(t,e){var a="";while(a.length<e)a+=t;return a}function ft(t){var e=Number(t);if(!isNaN(e))return e;var a=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return a*=100,""}));return isNaN(e=Number(n))?(n=n.replace(/[(](.*)[)]/,(function(t,e){return a=-a,e})),isNaN(e=Number(n))?e:e/a):e/a}function mt(t){var e=new Date(t),a=new Date(NaN),n=e.getYear(),i=e.getMonth(),r=e.getDate();return isNaN(r)||n<0||n>8099?a:(i>0||r>1)&&101!=n||t.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)?e:t.match(/[^-0-9:,\/\\]/)?a:e}var vt,bt=5=="abacaba".split(/(:?b)/i).length;function yt(t,e,a){if(bt||"string"==typeof e)return t.split(e);for(var n=t.split(e),i=[n[0]],r=1;r<n.length;++r)i.push(a),i.push(n[r]);return i}function _t(t){return t?t.data?y(t.data):t.asNodeBuffer&&k?y(t.asNodeBuffer().toString("binary")):t.asBinary?y(t.asBinary()):t._data&&t._data.getContent?y(pt(Array.prototype.slice.call(t._data.getContent(),0))):t.content&&t.type?y(pt(t.content)):null:null}function Dt(t){if(!t)return null;if(t.data)return m(t.data);if(t.asNodeBuffer&&k)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return"string"==typeof e?m(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function Ct(t){return t&&".bin"===t.name.slice(-4)?Dt(t):_t(t)}function wt(t,e){for(var a=t.FullPaths||Q(t.files),n=e.toLowerCase(),i=n.replace(/\//g,"\\"),r=0;r<a.length;++r){var s=a[r].toLowerCase();if(n==s||i==s)return t.files[a[r]]}return null}function xt(t,e){var a=wt(t,e);if(null==a)throw new Error("Cannot find file "+e+" in zip");return a}function kt(t,e,a){if(!a)return Ct(xt(t,e));if(!e)return null;try{return kt(t,e)}catch(l){return null}}function St(t,e,a){if(!a)return _t(xt(t,e));if(!e)return null;try{return St(t,e)}catch(l){return null}}function At(t){for(var e=t.FullPaths||Q(t.files),a=[],n=0;n<e.length;++n)"/"!=e[n].slice(-1)&&a.push(e[n]);return a.sort()}function Et(t,e,a){t.FullPaths?X.utils.cfb_add(t,e,a):t.file(e,a)}function Tt(t,e){var a;switch(e.type){case"base64":a=new vt(t,{base64:!0});break;case"binary":case"array":a=new vt(t,{base64:!1});break;case"buffer":a=new vt(t);break;default:throw new Error("Unrecognized type "+e.type)}return a}function It(){return new vt}function Pt(t,e){var a=e.split("/");"/"!=e.slice(-1)&&a.pop();var n=t.split("/");while(0!==n.length){var i=n.shift();".."===i?a.pop():"."!==i&&a.push(i)}return a.join("/")}"undefined"!==typeof JSZipSync&&(vt=JSZipSync),t.exports&&"undefined"===typeof vt&&(vt=void 0);var Nt='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Rt=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Bt=/<[\/\?]?[a-zA-Z0-9:]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s?[\/\?]?>/g;Nt.match(Bt)||(Bt=/<[^>]*>/g);var Ot=/<\w*:/,Mt=/<(\/?)\w+:/;function Lt(t,e){for(var a={},n=0,i=0;n!==t.length;++n)if(32===(i=t.charCodeAt(n))||10===i||13===i)break;if(e||(a[0]=t.slice(0,n)),n===t.length)return a;var r=t.match(Rt),s=0,o="",l=0,u="",d="",c=1;if(r)for(l=0;l!=r.length;++l){for(d=r[l],i=0;i!=d.length;++i)if(61===d.charCodeAt(i))break;u=d.slice(0,i).trim();while(32==d.charCodeAt(i+1))++i;for(c=34==(n=d.charCodeAt(i+1))||39==n?1:0,o=d.slice(i+1+c,d.length-c),s=0;s!=u.length;++s)if(58===u.charCodeAt(s))break;if(s===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=o,a[u.toLowerCase()]=o;else{var p=(5===s&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(s+1);if(a[p]&&"ext"==u.slice(s-3,s))continue;a[p]=o,a[p.toLowerCase()]=o}}return a}function Ut(t){return t.replace(Mt,"<$1")}var Ft={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$t=et(Ft),Ht=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,e=/_x([\da-fA-F]{4})_/g;return function a(n){var i=n+"",r=i.indexOf("<![CDATA[");if(-1==r)return i.replace(t,(function(t,e){return Ft[t]||String.fromCharCode(parseInt(e,t.indexOf("x")>-1?16:10))||t})).replace(e,(function(t,e){return String.fromCharCode(parseInt(e,16))}));var s=i.indexOf("]]>");return a(i.slice(0,r))+i.slice(r+9,s)+a(i.slice(s+3))}}(),jt=/[&<>'"]/g,Wt=/[\u0000-\u0008\u000b-\u001f]/g;function zt(t){var e=t+"";return e.replace(jt,(function(t){return $t[t]})).replace(Wt,(function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function Vt(t){return zt(t).replace(/ /g,"_x0020_")}var qt=/[\u0000-\u001f]/g;function Gt(t){var e=t+"";return e.replace(jt,(function(t){return $t[t]})).replace(/\n/g,"<br/>").replace(qt,(function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"}))}function Kt(t){var e=t+"";return e.replace(jt,(function(t){return $t[t]})).replace(qt,(function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"}))}var Xt=function(){var t=/&#(\d+);/g;function e(t,e){return String.fromCharCode(parseInt(e,10))}return function(a){return a.replace(t,e)}}(),Yt=function(){return function(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}}();function Jt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}var Zt=function(t){var e="",a=0,n=0,i=0,r=0,s=0,o=0;while(a<t.length)n=t.charCodeAt(a++),n<128?e+=String.fromCharCode(n):(i=t.charCodeAt(a++),n>191&&n<224?(s=(31&n)<<6,s|=63&i,e+=String.fromCharCode(s)):(r=t.charCodeAt(a++),n<240?e+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&r):(s=t.charCodeAt(a++),o=((7&n)<<18|(63&i)<<12|(63&r)<<6|63&s)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(1023&o)))));return e},Qt=function(t){var e=[],a=0,n=0,i=0;while(a<t.length)switch(n=t.charCodeAt(a++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,i=t.charCodeAt(a++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(63&i)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(63&n)))}return e.join("")};if(k){var te=function(t){var e,a,n,r=i.alloc(2*t.length),s=1,o=0,l=0;for(a=0;a<t.length;a+=s)s=1,(n=t.charCodeAt(a))<128?e=n:n<224?(e=64*(31&n)+(63&t.charCodeAt(a+1)),s=2):n<240?(e=4096*(15&n)+64*(63&t.charCodeAt(a+1))+(63&t.charCodeAt(a+2)),s=3):(s=4,e=262144*(7&n)+4096*(63&t.charCodeAt(a+1))+64*(63&t.charCodeAt(a+2))+(63&t.charCodeAt(a+3)),e-=65536,l=55296+(e>>>10&1023),e=56320+(1023&e)),0!==l&&(r[o++]=255&l,r[o++]=l>>>8,l=0),r[o++]=e%256,r[o++]=e>>>8;return r.slice(0,o).toString("ucs2")},ee="foo bar bazâð£";Zt(ee)==te(ee)&&(Zt=te);var ae=function(t){return S(t,"binary").toString("utf8")};Zt(ee)==ae(ee)&&(Zt=ae),Qt=function(t){return S(t,"utf8").toString("binary")}}var ne=function(){var t={};return function(e,a){var n=e+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",a||"")}}(),ie=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(t){return[new RegExp("&"+t[0]+";","g"),t[1]]}));return function(e){for(var a=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}}(),re=function(){var t={};return function(e){return void 0!==t[e]?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),se=/<\/?(?:vt:)?variant>/g,oe=/<(?:vt:)([^>]*)>([\s\S]*)</;function le(t,e){var a=Lt(t),n=t.match(re(a.baseType))||[],i=[];if(n.length!=a.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+a.size);return i}return n.forEach((function(t){var e=t.replace(se,"").match(oe);e&&i.push({v:Zt(e[2]),t:e[1]})})),i}var ue=/(^\s|\s$|\n)/;function de(t,e){return"<"+t+(e.match(ue)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function ce(t){return Q(t).map((function(e){return" "+e+'="'+t[e]+'"'})).join("")}function pe(t,e,a){return"<"+t+(null!=a?ce(a):"")+(null!=e?(e.match(ue)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function he(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(o){if(e)throw o}return""}function ge(t){switch(c(t)){case"string":return pe("vt:lpwstr",t);case"number":return pe((0|t)==t?"vt:i4":"vt:r8",String(t));case"boolean":return pe("vt:bool",t?"true":"false")}if(t instanceof Date)return pe("vt:filetime",he(t));throw new Error("Unable to serialize "+t)}var fe={dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema",main:["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"]},me={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ve(t,e){for(var a=1-2*(t[e+7]>>>7),n=((127&t[e+7])<<4)+(t[e+6]>>>4&15),i=15&t[e+6],r=5;r>=0;--r)i=256*i+t[e+r];return 2047==n?0==i?a*(1/0):NaN:(0==n?n=-1022:(n-=1023,i+=Math.pow(2,52)),a*Math.pow(2,n-52)*i)}function be(t,e,a){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,r=0,s=n?-e:e;isFinite(s)?0==s?i=r=0:(i=Math.floor(Math.log(s)/Math.LN2),r=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(r)||r<Math.pow(2,52))?i=-1022:(r-=Math.pow(2,52),i+=1023)):(i=2047,r=isNaN(e)?26985:0);for(var o=0;o<=5;++o,r/=256)t[a+o]=255&r;t[a+6]=(15&i)<<4|15&r,t[a+7]=i>>4|n}var ye,_e,De=function(t){for(var e=[],a=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,r=t[0][n].length;i<r;i+=a)e.push.apply(e,t[0][n].slice(i,i+a));return e},Ce=De,we=function(t,e,a){for(var n=[],i=e;i<a;i+=2)n.push(String.fromCharCode(He(t,i)));return n.join("").replace(M,"")},xe=we,ke=function(t,e,a){for(var n=[],i=e;i<e+a;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Se=ke,Ae=function(t,e,a){for(var n=[],i=e;i<a;i++)n.push(String.fromCharCode($e(t,i)));return n.join("")},Ee=Ae,Te=function(t,e){var a=We(t,e);return a>0?Ae(t,e+4,e+4+a-1):""},Ie=Te,Pe=function(t,e){var a=We(t,e);return a>0?Ae(t,e+4,e+4+a-1):""},Ne=Pe,Re=function(t,e){var a=2*We(t,e);return a>0?Ae(t,e+4,e+4+a-1):""},Be=Re;ye=_e=function(t,e){var a=We(t,e);return a>0?we(t,e+4,e+4+a):""};var Oe,Me,Le=function(t,e){var a=We(t,e);return a>0?Ae(t,e+4,e+4+a):""},Ue=Le;Oe=Me=function(t,e){return ve(t,e)};var Fe=function(t){return Array.isArray(t)};k&&(we=function(t,e,a){return i.isBuffer(t)?t.toString("utf16le",e,a).replace(M,""):xe(t,e,a)},ke=function(t,e,a){return i.isBuffer(t)?t.toString("hex",e,e+a):Se(t,e,a)},Te=function(t,e){if(!i.isBuffer(t))return Ie(t,e);var a=t.readUInt32LE(e);return a>0?t.toString("utf8",e+4,e+4+a-1):""},Pe=function(t,e){if(!i.isBuffer(t))return Ne(t,e);var a=t.readUInt32LE(e);return a>0?t.toString("utf8",e+4,e+4+a-1):""},Re=function(t,e){if(!i.isBuffer(t))return Be(t,e);var a=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+a-1)},ye=function(t,e){if(!i.isBuffer(t))return _e(t,e);var a=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+a)},Le=function(t,e){if(!i.isBuffer(t))return Ue(t,e);var a=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+a)},Ae=function(t,e,a){return i.isBuffer(t)?t.toString("utf8",e,a):Ee(t,e,a)},De=function(t){return t[0].length>0&&i.isBuffer(t[0][0])?i.concat(t[0]):Ce(t)},O=function(t){return i.isBuffer(t[0])?i.concat(t):[].concat.apply([],t)},Oe=function(t,e){return i.isBuffer(t)?t.readDoubleLE(e):Me(t,e)},Fe=function(t){return i.isBuffer(t)||Array.isArray(t)}),"undefined"!==typeof cptable&&(we=function(t,e,a){return cptable.utils.decode(1200,t.slice(e,a)).replace(M,"")},Ae=function(t,e,a){return cptable.utils.decode(65001,t.slice(e,a))},Te=function(t,e){var a=We(t,e);return a>0?cptable.utils.decode(o,t.slice(e+4,e+4+a-1)):""},Pe=function(t,e){var a=We(t,e);return a>0?cptable.utils.decode(n,t.slice(e+4,e+4+a-1)):""},Re=function(t,e){var a=2*We(t,e);return a>0?cptable.utils.decode(1200,t.slice(e+4,e+4+a-1)):""},ye=function(t,e){var a=We(t,e);return a>0?cptable.utils.decode(1200,t.slice(e+4,e+4+a)):""},Le=function(t,e){var a=We(t,e);return a>0?cptable.utils.decode(65001,t.slice(e+4,e+4+a)):""});var $e=function(t,e){return t[e]},He=function(t,e){return 256*t[e+1]+t[e]},je=function(t,e){var a=256*t[e+1]+t[e];return a<32768?a:-1*(65535-a+1)},We=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ze=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Ve=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function qe(t,e){var a,r,s,o,l,u,d="",c=[];switch(e){case"dbcs":if(u=this.l,k&&i.isBuffer(this))d=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)d+=String.fromCharCode(He(this,u)),u+=2;t*=2;break;case"utf8":d=Ae(this,this.l,this.l+t);break;case"utf16le":t*=2,d=we(this,this.l,this.l+t);break;case"wstr":if("undefined"===typeof cptable)return qe.call(this,t,"dbcs");d=cptable.utils.decode(n,this.slice(this.l,this.l+2*t)),t*=2;break;case"lpstr-ansi":d=Te(this,this.l),t=4+We(this,this.l);break;case"lpstr-cp":d=Pe(this,this.l),t=4+We(this,this.l);break;case"lpwstr":d=Re(this,this.l),t=4+2*We(this,this.l);break;case"lpp4":t=4+We(this,this.l),d=ye(this,this.l),2&t&&(t+=2);break;case"8lpp4":t=4+We(this,this.l),d=Le(this,this.l),3&t&&(t+=4-(3&t));break;case"cstr":t=0,d="";while(0!==(s=$e(this,this.l+t++)))c.push(_(s));d=c.join("");break;case"_wstr":t=0,d="";while(0!==(s=He(this,this.l+t)))c.push(_(s)),t+=2;t+=2,d=c.join("");break;case"dbcs-cont":for(d="",u=this.l,l=0;l<t;++l){if(this.lens&&-1!==this.lens.indexOf(u))return s=$e(this,u),this.l=u+1,o=qe.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(_(He(this,u))),u+=2}d=c.join(""),t*=2;break;case"cpstr":if("undefined"!==typeof cptable){d=cptable.utils.decode(n,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(d="",u=this.l,l=0;l!=t;++l){if(this.lens&&-1!==this.lens.indexOf(u))return s=$e(this,u),this.l=u+1,o=qe.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(_($e(this,u))),u+=1}d=c.join("");break;default:switch(t){case 1:return a=$e(this,this.l),this.l++,a;case 2:return a=("i"===e?je:He)(this,this.l),this.l+=2,a;case 4:case-4:return"i"===e||0===(128&this[this.l+3])?(a=(t>0?ze:Ve)(this,this.l),this.l+=4,a):(r=We(this,this.l),this.l+=4,r);case 8:case-8:if("f"===e)return r=8==t?Oe(this,this.l):Oe([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;t=8;case 16:d=ke(this,this.l,t);break}}return this.l+=t,d}var Ge=function(t,e,a){t[a]=255&e,t[a+1]=e>>>8&255,t[a+2]=e>>>16&255,t[a+3]=e>>>24&255},Ke=function(t,e,a){t[a]=255&e,t[a+1]=e>>8&255,t[a+2]=e>>16&255,t[a+3]=e>>24&255},Xe=function(t,e,a){t[a]=255&e,t[a+1]=e>>>8&255};function Ye(t,e,a){var n=0,i=0;if("dbcs"===a){for(i=0;i!=e.length;++i)Xe(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if("sbcs"===a){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=255&e.charCodeAt(i);n=e.length}else{if("hex"===a){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===a){var r=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var s=e.charCodeAt(i);this[this.l++]=255&s,this[this.l++]=s>>8}while(this.l<r)this[this.l++]=0;return this}switch(t){case 1:n=1,this[this.l]=255&e;break;case 2:n=2,this[this.l]=255&e,e>>>=8,this[this.l+1]=255&e;break;case 3:n=3,this[this.l]=255&e,e>>>=8,this[this.l+1]=255&e,e>>>=8,this[this.l+2]=255&e;break;case 4:n=4,Ge(this,e,this.l);break;case 8:if(n=8,"f"===a){be(this,e,this.l);break}case 16:break;case-4:n=4,Ke(this,e,this.l);break}}return this.l+=n,this}function Je(t,e){var a=ke(this,this.l,t.length>>1);if(a!==t)throw new Error(e+"Expected "+t+" saw "+a);this.l+=t.length>>1}function Ze(t,e){t.l=e,t._R=qe,t.chk=Je,t._W=Ye}function Qe(t,e){t.l+=e}function ta(t){var e=E(t);return Ze(e,0),e}function ea(t,e,a){if(t){var n,i,r;Ze(t,t.l||0);var s=t.length,o=0,l=0;while(t.l<s){o=t._R(1),128&o&&(o=(127&o)+((127&t._R(1))<<7));var u=ff[o]||ff[65535];for(n=t._R(1),r=127&n,i=1;i<4&&128&n;++i)r+=(127&(n=t._R(1)))<<7*i;l=t.l+r;var d=(u.f||Qe)(t,r,a);if(t.l=l,e(d,u.n,o))return}}}function aa(){var t=[],e=k?256:2048,a=function(t){var e=ta(t);return Ze(e,0),e},n=a(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},r=function(t){return n&&t<n.length-n.l?n:(i(),n=a(Math.max(t+1,e)))},s=function(){return i(),De([t])},o=function(t){i(),n=t,null==n.l&&(n.l=n.length),r(e)};return{next:r,push:o,end:s,_bufs:t}}function na(t,e,a,n){var i,r=+mf[e];if(!isNaN(r)){n||(n=ff[r].p||(a||[]).length||0),i=1+(r>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=t.next(i);r<=127?s._W(1,r):(s._W(1,128+(127&r)),s._W(1,r>>7));for(var o=0;4!=o;++o){if(!(n>=128)){s._W(1,n);break}s._W(1,128+(127&n)),n>>=7}n>0&&Fe(a)&&t.push(a)}}function ia(t,e,a){var n=ht(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!a||a.biff<12){while(n.c>=256)n.c-=256;while(n.r>=65536)n.r-=65536}return n}function ra(t,e,a){var n=ht(t);return n.s=ia(n.s,e.s,a),n.e=ia(n.e,e.s,a),n}function sa(t,e){t.cRel&&t.c<0&&(t=ht(t),t.c+=e>8?16384:256),t.rRel&&t.r<0&&(t=ht(t),t.r+=e>8?1048576:e>5?65536:16384);var a=_a(t);return 0===t.cRel&&(a=ma(a)),0===t.rRel&&(a=pa(a)),a}function oa(t,e){return 0!=t.s.r||t.s.rRel||t.e.r!=(e.biff>=12?1048575:e.biff>=8?65536:16384)||t.e.rRel?0!=t.s.c||t.s.cRel||t.e.c!=(e.biff>=12?65535:255)||t.e.cRel?sa(t.s,e.biff)+":"+sa(t.e,e.biff):(t.s.rRel?"":"$")+ca(t.s.r)+":"+(t.e.rRel?"":"$")+ca(t.e.r):(t.s.cRel?"":"$")+fa(t.s.c)+":"+(t.e.cRel?"":"$")+fa(t.e.c)}var la={},ua=function(t,e){var a;if("undefined"!==typeof e)a=e;else{try{a=void 0}catch(l){a=null}}t.rc4=function(t,e){var a=new Array(256),n=0,r=0,s=0,o=0;for(r=0;256!=r;++r)a[r]=r;for(r=0;256!=r;++r)s=s+a[r]+t[r%t.length].charCodeAt(0)&255,o=a[r],a[r]=a[s],a[s]=o;r=s=0;var l=i(e.length);for(n=0;n!=e.length;++n)r=r+1&255,s=(s+a[r])%256,o=a[r],a[r]=a[s],a[s]=o,l[n]=e[n]^a[a[r]+a[s]&255];return l},t.md5=function(t){if(!a)throw new Error("Unsupported crypto");return a.createHash("md5").update(t).digest("hex")}};function da(t){return parseInt(ha(t),10)-1}function ca(t){return""+(t+1)}function pa(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ha(t){return t.replace(/\$(\d+)$/,"$1")}function ga(t){for(var e=va(t),a=0,n=0;n!==e.length;++n)a=26*a+e.charCodeAt(n)-64;return a-1}function fa(t){var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function ma(t){return t.replace(/^([A-Z])/,"$$$1")}function va(t){return t.replace(/^\$([A-Z])/,"$1")}function ba(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ya(t){var e=ba(t);return{c:ga(e[0]),r:da(e[1])}}function _a(t){return fa(t.c)+ca(t.r)}function Da(t){var e=t.split(":").map(ya);return{s:e[0],e:e[e.length-1]}}function Ca(t,e){return"undefined"===typeof e||"number"===typeof e?Ca(t.s,t.e):("string"!==typeof t&&(t=_a(t)),"string"!==typeof e&&(e=_a(e)),t==e?t:t+":"+e)}function wa(t){var e={s:{c:0,r:0},e:{c:0,r:0}},a=0,n=0,i=0,r=t.length;for(a=0;n<r;++n){if((i=t.charCodeAt(n)-64)<1||i>26)break;a=26*a+i}for(e.s.c=--a,a=0;n<r;++n){if((i=t.charCodeAt(n)-48)<0||i>9)break;a=10*a+i}if(e.s.r=--a,n===r||58===t.charCodeAt(++n))return e.e.c=e.s.c,e.e.r=e.s.r,e;for(a=0;n!=r;++n){if((i=t.charCodeAt(n)-64)<1||i>26)break;a=26*a+i}for(e.e.c=--a,a=0;n!=r;++n){if((i=t.charCodeAt(n)-48)<0||i>9)break;a=10*a+i}return e.e.r=--a,e}function xa(t,e){var a="d"==t.t&&e instanceof Date;if(null!=t.z)try{return t.w=U.format(t.z,a?st(e):e)}catch(l){}try{return t.w=U.format((t.XF||{}).numFmtId||(a?14:0),a?st(e):e)}catch(l){return""+e}}function ka(t,e,a){return null==t||null==t.t||"z"==t.t?"":void 0!==t.w?t.w:("d"==t.t&&!t.z&&a&&a.dateNF&&(t.z=a.dateNF),xa(t,void 0==e?t.v:e))}function Sa(t,e){var a=e&&e.sheet?e.sheet:"Sheet1",n={};return n[a]=t,{SheetNames:[a],Sheets:n}}function Aa(t,e,a){var n=a||{},i=t?Array.isArray(t):n.dense;null!=C&&null==i&&(i=C);var r=t||(i?[]:{}),s=0,o=0;if(r&&null!=n.origin)if("number"==typeof n.origin)s=n.origin;else{var l="string"==typeof n.origin?ya(n.origin):n.origin;s=l.r,o=l.c}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(r["!ref"]){var d=wa(r["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==s&&(u.e.r=s=d.e.r+1)}for(var p=0;p!=e.length;++p)if(e[p]){if(!Array.isArray(e[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[p].length;++h)if("undefined"!==typeof e[p][h]){var g={v:e[p][h]},f=s+p,m=o+h;if(u.s.r>f&&(u.s.r=f),u.s.c>m&&(u.s.c=m),u.e.r<f&&(u.e.r=f),u.e.c<m&&(u.e.c=m),!e[p][h]||"object"!==c(e[p][h])||Array.isArray(e[p][h])||e[p][h]instanceof Date)if(Array.isArray(g.v)&&(g.f=e[p][h][1],g.v=g.v[0]),null===g.v)if(g.f)g.t="n";else{if(!n.sheetStubs)continue;g.t="z"}else"number"===typeof g.v?g.t="n":"boolean"===typeof g.v?g.t="b":g.v instanceof Date?(g.z=n.dateNF||U._table[14],n.cellDates?(g.t="d",g.w=U.format(g.z,st(g.v))):(g.t="n",g.v=st(g.v),g.w=U.format(g.z,g.v))):g.t="s";else g=e[p][h];if(i)r[f]||(r[f]=[]),r[f][m]=g;else{var v=_a({c:m,r:f});r[v]=g}}}return u.s.c<1e7&&(r["!ref"]=Ca(u)),r}function Ea(t,e){return Aa(null,t,e)}function Ta(t,e){return e||(e=ta(4)),e._W(4,t),e}function Ia(t){var e=t._R(4);return 0===e?"":t._R(e,"dbcs")}function Pa(t,e){var a=!1;return null==e&&(a=!0,e=ta(4+2*t.length)),e._W(4,t.length),t.length>0&&e._W(0,t,"dbcs"),a?e.slice(0,e.l):e}function Na(t){return{ich:t._R(2),ifnt:t._R(2)}}function Ra(t,e){return e||(e=ta(4)),e._W(2,t.ich||0),e._W(2,t.ifnt||0),e}function Ba(t,e){var a=t.l,n=t._R(1),i=Ia(t),r=[],s={t:i,h:i};if(0!==(1&n)){for(var o=t._R(4),l=0;l!=o;++l)r.push(Na(t));s.r=r}else s.r=[{ich:0,ifnt:0}];return t.l=a+e,s}function Oa(t,e){var a=!1;return null==e&&(a=!0,e=ta(15+4*t.t.length)),e._W(1,0),Pa(t.t,e),a?e.slice(0,e.l):e}ua(la,"undefined"!==typeof crypto?crypto:void 0);var Ma=Ba;function La(t,e){var a=!1;return null==e&&(a=!0,e=ta(23+4*t.t.length)),e._W(1,1),Pa(t.t,e),e._W(4,1),Ra({ich:0,ifnt:0},e),a?e.slice(0,e.l):e}function Ua(t){var e=t._R(4),a=t._R(2);return a+=t._R(1)<<16,t.l++,{c:e,iStyleRef:a}}function Fa(t,e){return null==e&&(e=ta(8)),e._W(-4,t.c),e._W(3,t.iStyleRef||t.s),e._W(1,0),e}var $a=Ia,Ha=Pa;function ja(t){var e=t._R(4);return 0===e||4294967295===e?"":t._R(e,"dbcs")}function Wa(t,e){var a=!1;return null==e&&(a=!0,e=ta(127)),e._W(4,t.length>0?t.length:4294967295),t.length>0&&e._W(0,t,"dbcs"),a?e.slice(0,e.l):e}var za=Ia,Va=ja,qa=Wa;function Ga(t){var e=t.slice(t.l,t.l+4),a=1&e[0],n=2&e[0];t.l+=4,e[0]&=252;var i=0===n?Oe([0,0,0,0,e[0],e[1],e[2],e[3]],0):ze(e,0)>>2;return a?i/100:i}function Ka(t,e){null==e&&(e=ta(4));var a=0,n=0,i=100*t;if(t==(0|t)&&t>=-(1<<29)&&t<1<<29?n=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(n=1,a=1),!n)throw new Error("unsupported RkNumber "+t);e._W(-4,((a?i:t)<<2)+(a+2))}function Xa(t){var e={s:{},e:{}};return e.s.r=t._R(4),e.e.r=t._R(4),e.s.c=t._R(4),e.e.c=t._R(4),e}function Ya(t,e){return e||(e=ta(16)),e._W(4,t.s.r),e._W(4,t.e.r),e._W(4,t.s.c),e._W(4,t.e.c),e}var Ja=Xa,Za=Ya;function Qa(t){return t._R(8,"f")}function tn(t,e){return(e||ta(8))._W(8,t,"f")}var en={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},an=at(en);function nn(t){var e={},a=t._R(1),n=a>>>1,i=t._R(1),r=t._R(2,"i"),s=t._R(1),o=t._R(1),l=t._R(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=Nn[i];u&&(e.rgb=nl(u));break;case 2:e.rgb=nl([s,o,l]);break;case 3:e.theme=i;break}return 0!=r&&(e.tint=r>0?r/32767:r/32768),e}function rn(t,e){if(e||(e=ta(8)),!t||t.auto)return e._W(4,0),e._W(4,0),e;t.index?(e._W(1,2),e._W(1,t.index)):t.theme?(e._W(1,6),e._W(1,t.theme)):(e._W(1,5),e._W(1,0));var a=t.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),e._W(2,a),t.rgb){var n=t.rgb||"FFFFFF";e._W(1,parseInt(n.slice(0,2),16)),e._W(1,parseInt(n.slice(2,4),16)),e._W(1,parseInt(n.slice(4,6),16)),e._W(1,255)}else e._W(2,0),e._W(1,0),e._W(1,0);return e}function sn(t){var e=t._R(1);t.l++;var a={fItalic:2&e,fStrikeout:8&e,fOutline:16&e,fShadow:32&e,fCondense:64&e,fExtend:128&e};return a}function on(t,e){e||(e=ta(2));var a=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e._W(1,a),e._W(1,0),e}function ln(t,e){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t._R(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return a[t._R(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t._R(0,1==e?"lpstr":"lpwstr")}function un(t){return ln(t,1)}function dn(t){return ln(t,2)}var cn=2,pn=3,hn=11,gn=12,fn=19,mn=30,vn=64,bn=65,yn=71,_n=4096,Dn=80,Cn=81,wn=[Dn,Cn],xn={1:{n:"CodePage",t:cn},2:{n:"Category",t:Dn},3:{n:"PresentationFormat",t:Dn},4:{n:"ByteCount",t:pn},5:{n:"LineCount",t:pn},6:{n:"ParagraphCount",t:pn},7:{n:"SlideCount",t:pn},8:{n:"NoteCount",t:pn},9:{n:"HiddenCount",t:pn},10:{n:"MultimediaClipCount",t:pn},11:{n:"ScaleCrop",t:hn},12:{n:"HeadingPairs",t:_n|gn},13:{n:"TitlesOfParts",t:_n|mn},14:{n:"Manager",t:Dn},15:{n:"Company",t:Dn},16:{n:"LinksUpToDate",t:hn},17:{n:"CharacterCount",t:pn},19:{n:"SharedDoc",t:hn},22:{n:"HyperlinksChanged",t:hn},23:{n:"AppVersion",t:pn,p:"version"},24:{n:"DigSig",t:bn},26:{n:"ContentType",t:Dn},27:{n:"ContentStatus",t:Dn},28:{n:"Language",t:Dn},29:{n:"Version",t:Dn},255:{}},kn={1:{n:"CodePage",t:cn},2:{n:"Title",t:Dn},3:{n:"Subject",t:Dn},4:{n:"Author",t:Dn},5:{n:"Keywords",t:Dn},6:{n:"Comments",t:Dn},7:{n:"Template",t:Dn},8:{n:"LastAuthor",t:Dn},9:{n:"RevNumber",t:Dn},10:{n:"EditTime",t:vn},11:{n:"LastPrinted",t:vn},12:{n:"CreatedDate",t:vn},13:{n:"ModifiedDate",t:vn},14:{n:"PageCount",t:pn},15:{n:"WordCount",t:pn},16:{n:"CharCount",t:pn},17:{n:"Thumbnail",t:yn},18:{n:"Application",t:Dn},19:{n:"DocSecurity",t:pn},255:{}},Sn={2147483648:{n:"Locale",t:fn},2147483651:{n:"Behavior",t:fn},1919054434:{}};(function(){for(var t in Sn)Sn.hasOwnProperty(t)&&(xn[t]=kn[t]=Sn[t])})();var An=tt(xn,"n"),En=tt(kn,"n"),Tn={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},In=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Pn(t){return t.map((function(t){return[t>>16&255,t>>8&255,255&t]}))}var Nn=Pn([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Rn={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.sheetMetadata":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"TODO","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"vba","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Bn=function(){var t={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};return Q(t).forEach((function(e){["xlsm","xlam"].forEach((function(a){t[e][a]||(t[e][a]=t[e].xlsx)}))})),Q(t).forEach((function(e){Q(t[e]).forEach((function(a){Rn[t[e][a]]=e}))})),t}(),On=nt(Rn);function Mn(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],TODO:[],xmlns:""}}function Ln(t){var e=Mn();if(!t||!t.match)return e;var a={};if((t.match(Bt)||[]).forEach((function(t){var n=Lt(t);switch(n[0].replace(Ot,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[n.Extension]=n.ContentType;break;case"<Override":void 0!==e[Rn[n.ContentType]]&&e[Rn[n.ContentType]].push(n.PartName);break}})),e.xmlns!==fe.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=a,delete e.calcchains,e}fe.CT="http://schemas.openxmlformats.org/package/2006/content-types";var Un=pe("Types",null,{xmlns:fe.CT,"xmlns:xsd":fe.xsd,"xmlns:xsi":fe.xsi}),Fn=[["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels",On.rels[0]]].map((function(t){return pe("Default",null,{Extension:t[0],ContentType:t[1]})}));function $n(t,e){var a,n=[];n[n.length]=Nt,n[n.length]=Un,n=n.concat(Fn);var i=function(i){t[i]&&t[i].length>0&&(a=t[i][0],n[n.length]=pe("Override",null,{PartName:("/"==a[0]?"":"/")+a,ContentType:Bn[i][e.bookType||"xlsx"]}))},r=function(a){(t[a]||[]).forEach((function(t){n[n.length]=pe("Override",null,{PartName:("/"==t[0]?"":"/")+t,ContentType:Bn[a][e.bookType||"xlsx"]})}))},s=function(e){(t[e]||[]).forEach((function(t){n[n.length]=pe("Override",null,{PartName:("/"==t[0]?"":"/")+t,ContentType:On[e][0]})}))};return i("workbooks"),r("sheets"),r("charts"),s("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("drawings"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Hn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jn(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Wn(t,e){if(!t)return t;"/"!==e.charAt(0)&&(e="/"+e);var a={},n={};return(t.match(Bt)||[]).forEach((function(t){var i=Lt(t);if("<Relationship"===i[0]){var r={};r.Type=i.Type,r.Target=i.Target,r.Id=i.Id,r.TargetMode=i.TargetMode;var s="External"===i.TargetMode?i.Target:Pt(i.Target,e);a[s]=r,n[i.Id]=r}})),a["!id"]=n,a}fe.RELS="http://schemas.openxmlformats.org/package/2006/relationships";var zn=pe("Relationships",null,{xmlns:fe.RELS});function Vn(t){var e=[Nt,zn];return Q(t["!id"]).forEach((function(a){e[e.length]=pe("Relationship",null,t["!id"][a])})),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function qn(t,e,a,n,i){if(i||(i={}),t["!id"]||(t["!id"]={}),e<0)for(e=1;t["!id"]["rId"+e];++e);if(i.Id="rId"+e,i.Type=n,i.Target=a,i.Type==Hn.HLINK&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var Gn="application/vnd.oasis.opendocument.spreadsheet";function Kn(t,e){var a,n,i=Hg(t);while(a=jg.exec(i))switch(a[3]){case"manifest":break;case"file-entry":if(n=Lt(a[0],!1),"/"==n.path&&n.type!==Gn)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw a}}function Xn(t){var e=[Nt];e.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),e.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var a=0;a<t.length;++a)e.push('  <manifest:file-entry manifest:full-path="'+t[a][0]+'" manifest:media-type="'+t[a][1]+'"/>\n');return e.push("</manifest:manifest>"),e.join("")}function Yn(t,e,a){return['  <rdf:Description rdf:about="'+t+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+e+'"/>\n',"  </rdf:Description>\n"].join("")}function Jn(t,e){return['  <rdf:Description rdf:about="'+t+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+'"/>\n',"  </rdf:Description>\n"].join("")}function Zn(t){var e=[Nt];e.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var a=0;a!=t.length;++a)e.push(Yn(t[a][0],t[a][1])),e.push(Jn("",t[a][0]));return e.push(Yn("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}var Qn=function(){var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+e.version+"</meta:generator></office:meta></office:document-meta>";return function(){return t}}(),ti=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];fe.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Hn.CORE_PROPS="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties";var ei=function(){for(var t=new Array(ti.length),e=0;e<ti.length;++e){var a=ti[e],n="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function ai(t){var e={};t=Zt(t);for(var a=0;a<ti.length;++a){var n=ti[a],i=t.match(ei[a]);null!=i&&i.length>0&&(e[n[1]]=i[1]),"date"===n[2]&&e[n[1]]&&(e[n[1]]=ct(e[n[1]]))}return e}var ni=pe("cp:coreProperties",null,{"xmlns:cp":fe.CORE_PROPS,"xmlns:dc":fe.dc,"xmlns:dcterms":fe.dcterms,"xmlns:dcmitype":fe.dcmitype,"xmlns:xsi":fe.xsi});function ii(t,e,a,n,i){null==i[t]&&null!=e&&""!==e&&(i[t]=e,n[n.length]=a?pe(t,e,a):de(t,e))}function ri(t,e){var a=e||{},n=[Nt,ni],i={};if(!t&&!a.Props)return n.join("");t&&(null!=t.CreatedDate&&ii("dcterms:created","string"===typeof t.CreatedDate?t.CreatedDate:he(t.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),null!=t.ModifiedDate&&ii("dcterms:modified","string"===typeof t.ModifiedDate?t.ModifiedDate:he(t.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var r=0;r!=ti.length;++r){var s=ti[r],o=a.Props&&null!=a.Props[s[1]]?a.Props[s[1]]:t?t[s[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&ii(s[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var si=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];fe.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Hn.EXT_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties";var oi=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function li(t,e,a,n){var i=[];if("string"==typeof t)i=le(t,n);else for(var r=0;r<t.length;++r)i=i.concat(t[r].map((function(t){return{v:t}})));var s="string"==typeof e?le(e,n).map((function(t){return t.v})):e,o=0,l=0;if(s.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Werkbladen":a.Worksheets=l,a.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":a.NamedRanges=l,a.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":a.Chartsheets=l,a.ChartNames=s.slice(o,o+l);break}o+=l}}function ui(t,e,a){var n={};return e||(e={}),t=Zt(t),si.forEach((function(a){switch(a[2]){case"string":e[a[1]]=(t.match(ne(a[0]))||[])[1];break;case"bool":e[a[1]]="true"===(t.match(ne(a[0]))||[])[1];break;case"raw":var i=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}})),n.HeadingPairs&&n.TitlesOfParts&&li(n.HeadingPairs,n.TitlesOfParts,e,a),e}var di=pe("Properties",null,{xmlns:fe.EXT_PROPS,"xmlns:vt":fe.vt});function ci(t){var e=[],a=pe;return t||(t={}),t.Application="SheetJS",e[e.length]=Nt,e[e.length]=di,si.forEach((function(n){if(void 0!==t[n[1]]){var i;switch(n[2]){case"string":i=String(t[n[1]]);break;case"bool":i=t[n[1]]?"true":"false";break}void 0!==i&&(e[e.length]=a(n[0],i))}})),e[e.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=a("TitlesOfParts",a("vt:vector",t.SheetNames.map((function(t){return"<vt:lpstr>"+zt(t)+"</vt:lpstr>"})).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}fe.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Hn.CUST_PROPS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties";var pi=/<[^>]+>[^<]*/g;function hi(t,e){var a={},n="",i=t.match(pi);if(i)for(var r=0;r!=i.length;++r){var s=i[r],o=Lt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=o.name;break;case"</property>":n=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":a[n]=Ht(d);break;case"bool":a[n]=Jt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":a[n]=parseFloat(d);break;case"filetime":case"date":a[n]=ct(d);break;case"cy":case"error":a[n]=Ht(d);break;default:if("/"==u.slice(-1))break;e.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",s,u,l)}}else if("</"===s.slice(0,2));else if(e.WTF)throw new Error(s)}}return a}var gi=pe("Properties",null,{xmlns:fe.CUST_PROPS,"xmlns:vt":fe.vt});function fi(t){var e=[Nt,gi];if(!t)return e.join("");var a=1;return Q(t).forEach((function(n){++a,e[e.length]=pe("property",ge(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:n})})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var mi={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},vi=et(mi);function bi(t,e,a){e=vi[e]||e,t[e]=a}function yi(t,e){var a=[];return Q(mi).map((function(t){for(var e=0;e<ti.length;++e)if(ti[e][1]==t)return ti[e];for(e=0;e<si.length;++e)if(si[e][1]==t)return si[e];throw t})).forEach((function(n){if(null!=t[n[1]]){var i=e&&e.Props&&null!=e.Props[n[1]]?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),a.push(de(mi[n[1]]||n[1],i))}})),pe("DocumentProperties",a.join(""),{xmlns:me.o})}function _i(t,e){var a=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Q(t).forEach((function(e){if(t.hasOwnProperty(e)){for(var n=0;n<ti.length;++n)if(e==ti[n][1])return;for(n=0;n<si.length;++n)if(e==si[n][1])return;for(n=0;n<a.length;++n)if(e==a[n])return;var r=t[e],s="string";"number"==typeof r?(s="float",r=String(r)):!0===r||!1===r?(s="boolean",r=r?"1":"0"):r=String(r),i.push(pe(Vt(e),r,{"dt:dt":s}))}})),e&&Q(e).forEach((function(a){if(e.hasOwnProperty(a)&&(!t||!t.hasOwnProperty(a))){var n=e[a],r="string";"number"==typeof n?(r="float",n=String(n)):!0===n||!1===n?(r="boolean",n=n?"1":"0"):n instanceof Date?(r="dateTime.tz",n=n.toISOString()):n=String(n),i.push(pe(Vt(a),n,{"dt:dt":r}))}})),"<"+n+' xmlns="'+me.o+'">'+i.join("")+"</"+n+">"}function Di(t){var e=t._R(4),a=t._R(4);return new Date(1e3*(a/1e7*Math.pow(2,32)+e/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Ci(t){var e="string"==typeof t?new Date(Date.parse(t)):t,a=e.getTime()/1e3+11644473600,n=a%Math.pow(2,32),i=(a-n)/Math.pow(2,32);n*=1e7,i*=1e7;var r=n/Math.pow(2,32)|0;r>0&&(n%=Math.pow(2,32),i+=r);var s=ta(8);return s._W(4,n),s._W(4,i),s}function wi(t,e,a){var n=t.l,i=t._R(0,"lpstr-cp");if(a)while(t.l-n&3)++t.l;return i}function xi(t,e,a){var n=t._R(0,"lpwstr");return a&&(t.l+=4-(n.length+1&3)&3),n}function ki(t,e,a){return 31===e?xi(t):wi(t,e,a)}function Si(t,e,a){return ki(t,e,!1===a?0:4)}function Ai(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return ki(t,e,0)}function Ei(t){for(var e=t._R(4),a=[],n=0;n!=e;++n)a[n]=t._R(0,"lpstr-cp").replace(M,"");return a}function Ti(t){return Ei(t)}function Ii(t){var e=Mi(t,Cn),a=Mi(t,pn);return[e,a]}function Pi(t){for(var e=t._R(4),a=[],n=0;n!=e/2;++n)a.push(Ii(t));return a}function Ni(t){return Pi(t)}function Ri(t,e){for(var a=t._R(4),n={},i=0;i!=a;++i){var r=t._R(4),s=t._R(4);n[r]=t._R(s,1200===e?"utf16le":"utf8").replace(M,"").replace(L,"!"),1200===e&&s%2&&(t.l+=2)}return 3&t.l&&(t.l=t.l>>3<<2),n}function Bi(t){var e=t._R(4),a=t.slice(t.l,t.l+e);return t.l+=e,(3&e)>0&&(t.l+=4-(3&e)&3),a}function Oi(t){var e={};return e.Size=t._R(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Mi(t,e,a){var n,i=t._R(2),r=a||{};if(t.l+=2,e!==gn&&i!==e&&-1===wn.indexOf(e))throw new Error("Expected type "+e+" saw "+i);switch(e===gn?i:e){case 2:return n=t._R(2,"i"),r.raw||(t.l+=2),n;case 3:return n=t._R(4,"i"),n;case 11:return 0!==t._R(4);case 19:return n=t._R(4),n;case 30:return wi(t,i,4).replace(M,"");case 31:return xi(t);case 64:return Di(t);case 65:return Bi(t);case 71:return Oi(t);case 80:return Si(t,i,!r.raw).replace(M,"");case 81:return Ai(t,i).replace(M,"");case 4108:return Ni(t);case 4126:return Ti(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+i)}}function Li(t,e){var a=ta(4),n=ta(4);switch(a._W(4,80==t?31:t),t){case 3:n._W(-4,e);break;case 5:n=ta(8),n._W(8,e,"f");break;case 11:n._W(4,e?1:0);break;case 64:n=Ci(e);break;case 31:case 80:n=ta(4+2*(e.length+1)+(e.length%2?0:2)),n._W(4,e.length+1),n._W(0,e,"dbcs");while(n.l!=n.length)n._W(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return O([a,n])}function Ui(t,e){var a=t.l,n=t._R(4),i=t._R(4),r=[],s=0,o=0,l=-1,u={};for(s=0;s!=i;++s){var d=t._R(4),c=t._R(4);r[s]=[d,c+a]}r.sort((function(t,e){return t[1]-e[1]}));var p={};for(s=0;s!=i;++s){if(t.l!==r[s][1]){var h=!0;if(s>0&&e)switch(e[r[s-1][0]].t){case 2:t.l+2===r[s][1]&&(t.l+=2,h=!1);break;case 80:t.l<=r[s][1]&&(t.l=r[s][1],h=!1);break;case 4108:t.l<=r[s][1]&&(t.l=r[s][1],h=!1);break}if((!e||0==s)&&t.l<=r[s][1]&&(h=!1,t.l=r[s][1]),h)throw new Error("Read Error: Expected address "+r[s][1]+" at "+t.l+" :"+s)}if(e){var f=e[r[s][0]];if(p[f.n]=Mi(t,f.t,{raw:!0}),"version"===f.p&&(p[f.n]=String(p[f.n]>>16)+"."+("0000"+String(65535&p[f.n])).slice(-4)),"CodePage"==f.n)switch(p[f.n]){case 0:p[f.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:g(o=p[f.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[f.n])}}else if(1===r[s][0]){if(o=p.CodePage=Mi(t,cn),g(o),-1!==l){var m=t.l;t.l=r[l][1],u=Ri(t,o),t.l=m}}else if(0===r[s][0]){if(0===o){l=s,t.l=r[s+1][1];continue}u=Ri(t,o)}else{var v,b=u[r[s][0]];switch(t[t.l]){case 65:t.l+=4,v=Bi(t);break;case 30:t.l+=4,v=Si(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,v=Si(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,v=t._R(4,"i");break;case 19:t.l+=4,v=t._R(4);break;case 5:t.l+=4,v=t._R(8,"f");break;case 11:t.l+=4,v=Gi(t,4);break;case 64:t.l+=4,v=ct(Di(t));break;default:throw new Error("unparsed value: "+t[t.l])}p[b]=v}}return t.l=a+n,p}var Fi=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"].concat(oi);function $i(t){switch(c(t)){case"boolean":return 11;case"number":return(0|t)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Hi(t,e,a){var n=ta(8),i=[],r=[],s=8,o=0,l=ta(8),u=ta(8);if(l._W(4,2),l._W(4,1200),u._W(4,1),r.push(l),i.push(u),s+=8+l.length,!e){u=ta(8),u._W(4,0),i.unshift(u);var d=[ta(4)];for(d[0]._W(4,t.length),o=0;o<t.length;++o){var c=t[o][0];l=ta(8+2*(c.length+1)+(c.length%2?0:2)),l._W(4,o+2),l._W(4,c.length+1),l._W(0,c,"dbcs");while(l.l!=l.length)l._W(1,0);d.push(l)}l=O(d),r.unshift(l),s+=8+l.length}for(o=0;o<t.length;++o)if((!e||e[t[o][0]])&&!(Fi.indexOf(t[o][0])>-1)&&null!=t[o][1]){var p=t[o][1],h=0;if(e){h=+e[t[o][0]];var g=a[h];if("version"==g.p&&"string"==typeof p){var f=p.split(".");p=(+f[0]<<16)+(+f[1]||0)}l=Li(g.t,p)}else{var m=$i(p);-1==m&&(m=31,p=String(p)),l=Li(m,p)}r.push(l),u=ta(8),u._W(4,e?h:2+o),i.push(u),s+=8+l.length}var v=8*(r.length+1);for(o=0;o<r.length;++o)i[o]._W(4,v),v+=r[o].length;return n._W(4,s),n._W(4,r.length),O([n].concat(i).concat(r))}function ji(t,e,a){var n=t.content;if(!n)return{};Ze(n,0);var i,r,s,o,l=0;n.chk("feff","Byte Order: "),n._R(2);var u=n._R(4),d=n._R(16);if(d!==X.utils.consts.HEADER_CLSID&&d!==a)throw new Error("Bad PropertySet CLSID "+d);if(i=n._R(4),1!==i&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(r=n._R(16),o=n._R(4),1===i&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);2===i&&(s=n._R(16),l=n._R(4));var c,p=Ui(n,e),h={SystemIdentifier:u};for(var g in p)h[g]=p[g];if(h.FMTID=r,1===i)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{c=Ui(n,null)}catch(D){}for(g in c)h[g]=c[g];return h.FMTID=[r,s],h}function Wi(t,e,a,n,i,r){var s=ta(i?68:48),o=[s];s._W(2,65534),s._W(2,0),s._W(4,842412599),s._W(16,X.utils.consts.HEADER_CLSID,"hex"),s._W(4,i?2:1),s._W(16,e,"hex"),s._W(4,i?68:48);var l=Hi(t,a,n);if(o.push(l),i){var u=Hi(i,null,null);s._W(16,r,"hex"),s._W(4,68+l.length),o.push(u)}return O(o)}function zi(t,e){return t._R(e),null}function Vi(t,e){e||(e=ta(t));for(var a=0;a<t;++a)e._W(1,0);return e}function qi(t,e,a){var n=[],i=t.l+e;while(t.l<i)n.push(a(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Gi(t,e){return 1===t._R(e)}function Ki(t,e){return e||(e=ta(2)),e._W(2,+!!t),e}function Xi(t){return t._R(2,"u")}function Yi(t,e){return e||(e=ta(2)),e._W(2,t),e}function Ji(t,e){return qi(t,e,Xi)}function Zi(t){var e=t._R(1),a=t._R(1);return 1===a?e:1===e}function Qi(t,e,a){return a||(a=ta(2)),a._W(1,+t),a._W(1,"e"==e?1:0),a}function tr(t,e,a){var i=t._R(a&&a.biff>=12?2:1),r="sbcs-cont",s=n;if(a&&a.biff>=8&&(n=1200),a&&8!=a.biff)12==a.biff&&(r="wstr");else{var o=t._R(1);o&&(r="dbcs-cont")}a.biff>=2&&a.biff<=5&&(r="cpstr");var l=i?t._R(i,r):"";return n=s,l}function er(t){var e=n;n=1200;var a,i=t._R(2),r=t._R(1),s=4&r,o=8&r,l=1+(1&r),u=0,d={};o&&(u=t._R(2)),s&&(a=t._R(4));var c=2==l?"dbcs-cont":"sbcs-cont",p=0===i?"":t._R(i,c);return o&&(t.l+=4*u),s&&(t.l+=a),d.t=p,o||(d.raw="<t>"+d.t+"</t>",d.r=d.t),n=e,d}function ar(t,e,a){var n;if(a){if(a.biff>=2&&a.biff<=5)return t._R(e,"cpstr");if(a.biff>=12)return t._R(e,"dbcs-cont")}var i=t._R(1);return n=0===i?t._R(e,"sbcs-cont"):t._R(e,"dbcs-cont"),n}function nr(t,e,a){var n=t._R(a&&2==a.biff?1:2);return 0===n?(t.l++,""):ar(t,n,a)}function ir(t,e,a){if(a.biff>5)return nr(t,e,a);var n=t._R(1);return 0===n?(t.l++,""):t._R(n,a.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function rr(t,e,a){return a||(a=ta(3+2*t.length)),a._W(2,t.length),a._W(1,1),a._W(31,t,"utf16le"),a}function sr(t){var e=t._R(1);t.l++;var a=t._R(2);return t.l+=2,[e,a]}function or(t){var e=t._R(4),a=t.l,n=!1;e>24&&(t.l+=e-24,"795881f43b1d7f48af2c825dc4852763"===t._R(16)&&(n=!0),t.l=a);var i=t._R((n?e-24:e)>>1,"utf16le").replace(M,"");return n&&(t.l+=24),i}function lr(t){t.l+=2;var e=t._R(0,"lpstr-ansi");if(t.l+=2,57005!=t._R(2))throw new Error("Bad FileMoniker");var a=t._R(4);if(0===a)return e.replace(/\\/g,"/");var n=t._R(4);if(3!=t._R(2))throw new Error("Bad FileMoniker");var i=t._R(n>>1,"utf16le").replace(M,"");return i}function ur(t,e){var a=t._R(16);switch(e-=16,a){case"e0c9ea79f9bace118c8200aa004ba90b":return or(t,e);case"0303000000000000c000000000000046":return lr(t,e);default:throw new Error("Unsupported Moniker "+a)}}function dr(t){var e=t._R(4),a=e>0?t._R(e,"utf16le").replace(M,""):"";return a}function cr(t,e){var a=t.l+e,n=t._R(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var i=t._R(2);t.l+=2;var r,s,o,l,u,d,c="";16&i&&(r=dr(t,a-t.l)),128&i&&(s=dr(t,a-t.l)),257===(257&i)&&(o=dr(t,a-t.l)),1===(257&i)&&(l=ur(t,a-t.l)),8&i&&(c=dr(t,a-t.l)),32&i&&(u=t._R(16)),64&i&&(d=Di(t)),t.l=a;var p=s||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c);var h={Target:p};return u&&(h.guid=u),d&&(h.time=d),r&&(h.Tooltip=r),h}function pr(t){var e=ta(512),a=0,n=t.Target,i=n.indexOf("#")>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e._W(4,2),e._W(4,i);var r=[8,6815827,6619237,4849780,83];for(a=0;a<r.length;++a)e._W(4,r[a]);if(28==i){for(n=n.slice(1),e._W(4,n.length+1),a=0;a<n.length;++a)e._W(2,n.charCodeAt(a));e._W(2,0)}else if(2&i){for(r="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<r.length;++a)e._W(1,parseInt(r[a],16));for(e._W(4,2*(n.length+1)),a=0;a<n.length;++a)e._W(2,n.charCodeAt(a));e._W(2,0)}else{for(r="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<r.length;++a)e._W(1,parseInt(r[a],16));var s=0;while("../"==n.slice(3*s,3*s+3)||"..\\"==n.slice(3*s,3*s+3))++s;for(e._W(2,s),e._W(4,n.length+1),a=0;a<n.length;++a)e._W(1,255&n.charCodeAt(a));for(e._W(1,0),e._W(2,65535),e._W(2,57005),a=0;a<6;++a)e._W(4,0)}return e.slice(0,e.l)}function hr(t){var e=t._R(1),a=t._R(1),n=t._R(1),i=t._R(1);return[e,a,n,i]}function gr(t,e){var a=hr(t,e);return a[3]=0,a}function fr(t){var e=t._R(2),a=t._R(2),n=t._R(2);return{r:e,c:a,ixfe:n}}function mr(t,e,a,n){return n||(n=ta(6)),n._W(2,t),n._W(2,e),n._W(2,a||0),n}function vr(t){var e=t._R(2),a=t._R(2);return t.l+=8,{type:e,flags:a}}function br(t,e,a){return 0===e?"":ir(t,e,a)}function yr(t,e,a){var n=a.biff>8?4:2,i=t._R(n),r=t._R(n,"i"),s=t._R(n,"i");return[i,r,s]}function _r(t){var e=t._R(2),a=Ga(t);return[e,a]}function Dr(t,e,a){t.l+=4,e-=4;var n=t.l+e,i=tr(t,e,a),r=t._R(2);if(n-=t.l,r!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+r);return t.l+=r,i}function Cr(t){var e=t._R(2),a=t._R(2),n=t._R(2),i=t._R(2);return{s:{c:n,r:e},e:{c:i,r:a}}}function wr(t,e){return e||(e=ta(8)),e._W(2,t.s.r),e._W(2,t.e.r),e._W(2,t.s.c),e._W(2,t.e.c),e}function xr(t){var e=t._R(2),a=t._R(2),n=t._R(1),i=t._R(1);return{s:{c:n,r:e},e:{c:i,r:a}}}var kr=xr;function Sr(t){t.l+=4;var e=t._R(2),a=t._R(2),n=t._R(2);return t.l+=12,[a,e,n]}function Ar(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t._R(2),t.l+=4,e}function Er(t){var e={};return t.l+=4,t.cf=t._R(2),e}function Tr(t){t.l+=2,t.l+=t._R(2)}var Ir={0:Tr,4:Tr,5:Tr,6:Tr,7:Er,8:Tr,9:Tr,10:Tr,11:Tr,12:Tr,13:Ar,14:Tr,15:Tr,16:Tr,17:Tr,18:Tr,19:Tr,20:Tr,21:Sr};function Pr(t,e){var a=t.l+e,n=[];while(t.l<a){var i=t._R(2);t.l-=2;try{n.push(Ir[i](t,a-t.l))}catch(d){return t.l=a,n}}return t.l!=a&&(t.l=a),n}function Nr(t,e){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=t._R(2),e-=2,e>=2&&(a.dt=t._R(2),t.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return t._R(e),a}function Rr(t,e,a){var n=1536,i=16;switch(a.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var r=ta(i);return r._W(2,n),r._W(2,e),i>4&&r._W(2,29282),i>6&&r._W(2,1997),i>8&&(r._W(2,49161),r._W(2,1),r._W(2,1798),r._W(2,0)),r}function Br(t,e){return 0===e||t._R(2),1200}function Or(t,e,a){if(a.enc)return t.l+=e,"";var n=t.l,i=ir(t,0,a);return t._R(e+n-t.l),i}function Mr(t,e){var a=!e||8==e.biff,n=ta(a?112:54);n._W(8==e.biff?2:1,7),a&&n._W(1,0),n._W(4,859007059),n._W(4,5458548|(a?0:536870912));while(n.l<n.length)n._W(1,a?0:32);return n}function Lr(t,e,a){var n=a&&8==a.biff||2==e?t._R(2):(t.l+=e,0);return{fDialog:16&n}}function Ur(t,e,a){var n=t._R(4),i=3&t._R(1),r=t._R(1);switch(r){case 0:r="Worksheet";break;case 1:r="Macrosheet";break;case 2:r="Chartsheet";break;case 6:r="VBAModule";break}var s=tr(t,0,a);return 0===s.length&&(s="Sheet1"),{pos:n,hs:i,dt:r,name:s}}function Fr(t,e){var a=!e||e.biff>=8?2:1,n=ta(8+a*t.name.length);n._W(4,t.pos),n._W(1,t.hs||0),n._W(1,t.dt),n._W(1,t.name.length),e.biff>=8&&n._W(1,1),n._W(a*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function $r(t,e){for(var a=t.l+e,n=t._R(4),i=t._R(4),r=[],s=0;s!=i&&t.l<a;++s)r.push(er(t));return r.Count=n,r.Unique=i,r}function Hr(t,e){var a={};return a.dsst=t._R(2),t.l+=e-2,a}function jr(t){var e={};e.r=t._R(2),e.c=t._R(2),e.cnt=t._R(2)-e.c;var a=t._R(2);t.l+=4;var n=t._R(1);return t.l+=3,7&n&&(e.level=7&n),32&n&&(e.hidden=!0),64&n&&(e.hpt=a/20),e}function Wr(t){var e=vr(t);if(2211!=e.type)throw new Error("Invalid Future Record "+e.type);var a=t._R(4);return 0!==a}function zr(t){return t._R(2),t._R(4)}function Vr(t,e,a){var n=0;a&&2==a.biff||(n=t._R(2));var i=t._R(2);a&&2==a.biff&&(n=1-(i>>15),i&=32767);var r={Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3};return[r,i]}function qr(t){var e=t._R(2),a=t._R(2),n=t._R(2),i=t._R(2),r=t._R(2),s=t._R(2),o=t._R(2),l=t._R(2),u=t._R(2);return{Pos:[e,a],Dim:[n,i],Flags:r,CurTab:s,FirstTab:o,Selected:l,TabRatio:u}}function Gr(){var t=ta(18);return t._W(2,0),t._W(2,0),t._W(2,29280),t._W(2,17600),t._W(2,56),t._W(2,0),t._W(2,0),t._W(2,1),t._W(2,500),t}function Kr(t,e,a){if(a&&a.biff>=2&&a.biff<8)return{};var n=t._R(2);return{RTL:64&n}}function Xr(t){var e=ta(18),a=1718;return t&&t.RTL&&(a|=64),e._W(2,a),e._W(4,0),e._W(4,64),e._W(4,0),e._W(4,0),e}function Yr(t,e,a){var n={dyHeight:t._R(2),fl:t._R(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=tr(t,0,a),n}function Jr(t,e){var a=t.name||"Arial",n=e&&5==e.biff,i=n?15+a.length:16+2*a.length,r=ta(i);return r._W(2,20*(t.sz||12)),r._W(4,0),r._W(2,400),r._W(4,0),r._W(2,0),r._W(1,a.length),n||r._W(1,1),r._W((n?1:2)*a.length,a,n?"sbcs":"utf16le"),r}function Zr(t){var e=fr(t);return e.isst=t._R(4),e}function Qr(t,e,a){var n=t.l+e,i=fr(t,6);2==a.biff&&t.l++;var r=nr(t,n-t.l,a);return i.val=r,i}function ts(t,e,a,n,i){var r=!i||8==i.biff,s=ta(+r+8+(1+r)*a.length);return mr(t,e,n,s),s._W(2,a.length),r&&s._W(1,1),s._W((1+r)*a.length,a,r?"utf16le":"sbcs"),s}function es(t,e,a){var n=t._R(2),i=ir(t,0,a);return[n,i]}function as(t,e,a,n){var i=a&&5==a.biff;n||(n=ta(i?3+e.length:5+2*e.length)),n._W(2,t),n._W(i?1:2,e.length),i||n._W(1,1),n._W((i?1:2)*e.length,e,i?"sbcs":"utf16le");var r=n.length>n.l?n.slice(0,n.l):n;return null==r.l&&(r.l=r.length),r}var ns=ir;function is(t,e,a){var n=t.l+e,i=8!=a.biff&&a.biff?2:4,r=t._R(i),s=t._R(i),o=t._R(2),l=t._R(2);return t.l=n,{s:{r:r,c:o},e:{r:s,c:l}}}function rs(t,e){var a=8!=e.biff&&e.biff?2:4,n=ta(2*a+6);return n._W(a,t.s.r),n._W(a,t.e.r+1),n._W(2,t.s.c),n._W(2,t.e.c+1),n._W(2,0),n}function ss(t){var e=t._R(2),a=t._R(2),n=_r(t);return{r:e,c:a,ixfe:n[0],rknum:n[1]}}function os(t,e){var a=t.l+e-2,n=t._R(2),i=t._R(2),r=[];while(t.l<a)r.push(_r(t));if(t.l!==a)throw new Error("MulRK read error");var s=t._R(2);if(r.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:s,rkrec:r}}function ls(t,e){var a=t.l+e-2,n=t._R(2),i=t._R(2),r=[];while(t.l<a)r.push(t._R(2));if(t.l!==a)throw new Error("MulBlank read error");var s=t._R(2);if(r.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:s,ixfe:r}}function us(t,e,a,n){var i={},r=t._R(4),s=t._R(4),o=t._R(4),l=t._R(2);return i.patternType=In[o>>26],n.cellStyles?(i.alc=7&r,i.fWrap=r>>3&1,i.alcV=r>>4&7,i.fJustLast=r>>7&1,i.trot=r>>8&255,i.cIndent=r>>16&15,i.fShrinkToFit=r>>20&1,i.iReadOrder=r>>22&2,i.fAtrNum=r>>26&1,i.fAtrFnt=r>>27&1,i.fAtrAlc=r>>28&1,i.fAtrBdr=r>>29&1,i.fAtrPat=r>>30&1,i.fAtrProt=r>>31&1,i.dgLeft=15&s,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=127&o,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=127&l,i.icvBack=l>>7&127,i.fsxButton=l>>14&1,i):i}function ds(t,e,a){var n={};return n.ifnt=t._R(2),n.numFmtId=t._R(2),n.flags=t._R(2),n.fStyle=n.flags>>2&1,e-=6,n.data=us(t,e,n.fStyle,a),n}function cs(t,e,a,n){var i=a&&5==a.biff;return n||(n=ta(i?16:20)),n._W(2,0),t.style?(n._W(2,t.numFmtId||0),n._W(2,65524)):(n._W(2,t.numFmtId||0),n._W(2,e<<4)),n._W(4,0),n._W(4,0),i||n._W(4,0),n._W(2,0),n}function ps(t){t.l+=4;var e=[t._R(2),t._R(2)];if(0!==e[0]&&e[0]--,0!==e[1]&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function hs(t){var e=ta(8);return e._W(4,0),e._W(2,t[0]?t[0]+1:0),e._W(2,t[1]?t[1]+1:0),e}function gs(t,e,a){var n=fr(t,6);2==a.biff&&++t.l;var i=Zi(t,2);return n.val=i,n.t=!0===i||!1===i?"b":"e",n}function fs(t,e,a,n,i,r){var s=ta(8);return mr(t,e,n,s),Qi(a,r,s),s}function ms(t){var e=fr(t,6),a=Qa(t,8);return e.val=a,e}function vs(t,e,a,n){var i=ta(14);return mr(t,e,n,i),tn(a,i),i}var bs=br;function ys(t,e,a){var n=t.l+e,i=t._R(2),r=t._R(2);if(a.sbcch=r,1025==r||14849==r)return[r,i];if(r<1||r>255)throw new Error("Unexpected SupBook type: "+r);var s=ar(t,r),o=[];while(n>t.l)o.push(nr(t));return[r,i,s,o]}function _s(t,e,a){var n,i=t._R(2),r={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===a.sbcch&&(n=Dr(t,e-2,a)),r.body=n||t._R(e-2),"string"===typeof n&&(r.Name=n),r}var Ds=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Cs(t,e,a){var n=t.l+e,i=t._R(2),r=t._R(1),s=t._R(1),o=t._R(a&&2==a.biff?1:2),l=0;(!a||a.biff>=5)&&(5!=a.biff&&(t.l+=2),l=t._R(2),5==a.biff&&(t.l+=2),t.l+=4);var u=ar(t,s,a);32&i&&(u=Ds[u.charCodeAt(0)]);var d=n-t.l;a&&2==a.biff&&--d;var c=n==t.l||0===o?[]:Mc(t,d,a,o);return{chKey:r,Name:u,itab:l,rgce:c}}function ws(t,e,a){if(a.biff<8)return xs(t,e,a);var n=[],i=t.l+e,r=t._R(a.biff>8?4:2);while(0!==r--)n.push(yr(t,a.biff>8?12:6,a));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function xs(t,e,a){3==t[t.l+1]&&t[t.l]++;var n=tr(t,e,a);return 3==n.charCodeAt(0)?n.slice(1):n}function ks(t,e,a){if(!(a.biff<8)){var n=t._R(2),i=t._R(2),r=ar(t,n,a),s=ar(t,i,a);return[r,s]}t.l+=e}function Ss(t,e,a){var n=xr(t,6);t.l++;var i=t._R(1);return e-=8,[Lc(t,e,a),i,n]}function As(t,e,a){var n=kr(t,6);switch(a.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Bc(t,e,a,n)]}function Es(t){var e=0!==t._R(4),a=0!==t._R(4),n=t._R(4);return[e,a,n]}function Ts(t,e,a){if(!(a.biff<8)){var n=t._R(2),i=t._R(2),r=t._R(2),s=t._R(2),o=ir(t,0,a);return a.biff<8&&t._R(1),[{r:n,c:i},o,s,r]}}function Is(t,e,a){return Ts(t,e,a)}function Ps(t,e){var a=[],n=t._R(2);while(n--)a.push(Cr(t,e));return a}function Ns(t){var e=ta(2+8*t.length);e._W(2,t.length);for(var a=0;a<t.length;++a)wr(t[a],e);return e}function Rs(t,e,a){if(a&&a.biff<8)return Os(t,e,a);var n=Sr(t,22),i=Pr(t,e-22,n[1]);return{cmo:n,ft:i}}var Bs=[];function Os(t,e,a){t.l+=4;var n=t._R(2),i=t._R(2),r=t._R(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var s=[];return s.push((Bs[n]||Qe)(t,e,a)),{cmo:[i,n,r],ft:s}}function Ms(t,e,a){var n=t.l,i="";try{t.l+=4;var r=(a.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(r)?t.l+=6:sr(t,6,a);var s=t._R(2);t._R(2),Xi(t,2);var o=t._R(2);t.l+=o;for(var l=1;l<t.lens.length-1;++l){if(t.l-n!=t.lens[l])throw new Error("TxO: bad continue record");var u=t[t.l],d=ar(t,t.lens[l+1]-t.lens[l]-1);if(i+=d,i.length>=(u?s:2*s))break}if(i.length!==s&&i.length!==2*s)throw new Error("cchText: "+s+" != "+i.length);return t.l=n+e,{t:i}}catch(b){return t.l=n+e,{t:i}}}function Ls(t,e){var a=Cr(t,8);t.l+=16;var n=cr(t,e-24);return[a,n]}function Us(t){var e=ta(24),a=ya(t[0]);e._W(2,a.r),e._W(2,a.r),e._W(2,a.c),e._W(2,a.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e._W(1,parseInt(n[i],16));return O([e,pr(t[1])])}function Fs(t,e){t._R(2);var a=Cr(t,8),n=t._R((e-10)/2,"dbcs-cont");return n=n.replace(M,""),[a,n]}function $s(t){var e=t[1].Tooltip,a=ta(10+2*(e.length+1));a._W(2,2048);var n=ya(t[0]);a._W(2,n.r),a._W(2,n.r),a._W(2,n.c),a._W(2,n.c);for(var i=0;i<e.length;++i)a._W(2,e.charCodeAt(i));return a._W(2,0),a}function Hs(t){var e,a=[0,0];return e=t._R(2),a[0]=Tn[e]||e,e=t._R(2),a[1]=Tn[e]||e,a}function js(t){return t||(t=ta(4)),t._W(2,1),t._W(2,1),t}function Ws(t){var e=t._R(2),a=[];while(e-- >0)a.push(gr(t,8));return a}function zs(t){var e=t._R(2),a=[];while(e-- >0)a.push(gr(t,8));return a}function Vs(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t._R(2),e.crc=t._R(4),e}function qs(t,e,a){if(!a.cellStyles)return Qe(t,e);var n=a&&a.biff>=12?4:2,i=t._R(n),r=t._R(n),s=t._R(n),o=t._R(n),l=t._R(2);return 2==n&&(t.l+=2),{s:i,e:r,w:s,ixfe:o,flags:l}}function Gs(t,e){var a={};return e<32||(t.l+=16,a.header=Qa(t,8),a.footer=Qa(t,8),t.l+=2),a}function Ks(t,e,a){var n={area:!1};if(5!=a.biff)return t.l+=e,n;var i=t._R(1);return t.l+=3,16&i&&(n.area=!0),n}function Xs(t){for(var e=ta(2*t),a=0;a<t;++a)e._W(2,a+1);return e}Bs[8]=function(t,e){var a=t.l+e;t.l+=10;var n=t._R(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t._R(1);return t.l+=i,t.l=a,{fmt:n}};var Ys=fr,Js=Ji,Zs=nr;function Qs(t){var e=t._R(2),a=t._R(2),n=t._R(4),i={fmt:e,env:a,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function to(t,e,a){var n=fr(t,6);++t.l;var i=ir(t,e-7,a);return n.t="str",n.val=i,n}function eo(t){var e=fr(t,6);++t.l;var a=Qa(t,8);return e.t="n",e.val=a,e}function ao(t,e,a){var n=ta(15);return _f(n,t,e),n._W(8,a,"f"),n}function no(t){var e=fr(t,6);++t.l;var a=t._R(2);return e.t="n",e.val=a,e}function io(t,e,a){var n=ta(9);return _f(n,t,e),n._W(2,a),n}function ro(t){var e=t._R(1);return 0===e?(t.l++,""):t._R(e,"sbcs-cont")}function so(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function oo(t,e,a){var n=t.l+e,i=fr(t,6),r=t._R(2),s=ar(t,r,a);return t.l=n,i.t="str",i.val=s,i}var lo=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,255:16969},e=et({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(e,a){var n=[],i=E(1);switch(a.type){case"base64":i=I(x.decode(e));break;case"binary":i=I(e);break;case"buffer":case"array":i=e;break}Ze(i,0);var r=i._R(1),s=!1,o=!1,l=!1;switch(r){case 2:case 3:break;case 48:o=!0,s=!0;break;case 49:o=!0;break;case 131:s=!0;break;case 139:s=!0;break;case 140:s=!0,l=!0;break;case 245:s=!0;break;default:throw new Error("DBF Unsupported Version: "+r.toString(16))}var u=0,d=0;2==r&&(u=i._R(2)),i.l+=3,2!=r&&(u=i._R(4)),2!=r&&(d=i._R(2));var c=i._R(2),p=1252;2!=r&&(i.l+=16,i._R(1),0!==i[i.l]&&(p=t[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);var h=[],g={},f=d-10-(o?264:0),m=l?32:11;while(2==r?i.l<i.length&&13!=i[i.l]:i.l<f)switch(g={},g.name=cptable.utils.decode(p,i.slice(i.l,i.l+m)).replace(/[\u0000\r\n].*$/g,""),i.l+=m,g.type=String.fromCharCode(i._R(1)),2==r||l||(g.offset=i._R(4)),g.len=i._R(1),2==r&&(g.offset=i._R(2)),g.dec=i._R(1),g.name.length&&h.push(g),2!=r&&(i.l+=l?13:14),g.type){case"B":o&&8==g.len||!a.WTF||console.log("Skipping "+g.name+":"+g.type);break;case"G":case"P":a.WTF&&console.log("Skipping "+g.name+":"+g.type);break;case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":case"0":case"@":case"+":break;default:throw new Error("Unknown Field Type: "+g.type)}if(13!==i[i.l]?i.l=d-1:2==r&&(i.l=521),2!=r){if(13!==i._R(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=d}var v=0,b=0;for(n[0]=[],b=0;b!=h.length;++b)n[0][b]=h[b].name;while(u-- >0)if(42!==i[i.l])for(++i.l,n[++v]=[],b=0,b=0;b!=h.length;++b){var y=i.slice(i.l,i.l+h[b].len);i.l+=h[b].len,Ze(y,0);var _=cptable.utils.decode(p,y);switch(h[b].type){case"C":n[v][b]=cptable.utils.decode(p,y),n[v][b]=n[v][b].trim();break;case"D":8===_.length?n[v][b]=new Date(+_.slice(0,4),+_.slice(4,6)-1,+_.slice(6,8)):n[v][b]=_;break;case"F":n[v][b]=parseFloat(_.trim());break;case"+":case"I":n[v][b]=l?2147483648^y._R(-4,"i"):y._R(4,"i");break;case"L":switch(_.toUpperCase()){case"Y":case"T":n[v][b]=!0;break;case"N":case"F":n[v][b]=!1;break;case" ":case"?":n[v][b]=!1;break;default:throw new Error("DBF Unrecognized L:|"+_+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+r.toString(16));n[v][b]="##MEMO##"+(l?parseInt(_.trim(),10):y._R(4));break;case"N":n[v][b]=+_.replace(/\u0000/g,"").trim();break;case"@":n[v][b]=new Date(y._R(-8,"f")-621356832e5);break;case"T":n[v][b]=new Date(864e5*(y._R(4)-2440588)+y._R(4));break;case"Y":n[v][b]=y._R(4,"i")/1e4;break;case"O":n[v][b]=-y._R(-8,"f");break;case"B":if(o&&8==h[b].len){n[v][b]=y._R(8,"f");break}case"G":case"P":y.l+=h[b].len;break;case"0":if("_NullFlags"===h[b].name)break;default:throw new Error("DBF Unsupported data type "+h[b].type)}}else i.l+=c;if(2!=r&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return a&&a.sheetRows&&(n=n.slice(0,a.sheetRows)),n}function n(t,e){var n=e||{};return n.dateNF||(n.dateNF="yyyymmdd"),Ea(a(t,n),n)}function i(t,e){try{return Sa(n(t,e),e)}catch(o){if(e&&e.WTF)throw o}return{SheetNames:[],Sheets:{}}}var r={B:8,C:250,L:1,D:8,"?":0,"":0};function s(t,a){var n=a||{};if(+n.codepage>=0&&g(+n.codepage),"string"==n.type)throw new Error("Cannot write DBF to JS string");var i=aa(),s=Om(t,{header:1,raw:!0,cellDates:!0}),l=s[0],u=s.slice(1),d=0,p=0,h=0,f=1;for(d=0;d<l.length;++d)if(null!=d){if(++h,"number"===typeof l[d]&&(l[d]=l[d].toString(10)),"string"!==typeof l[d])throw new Error("DBF Invalid column name "+l[d]+" |"+c(l[d])+"|");if(l.indexOf(l[d])!==d)for(p=0;p<1024;++p)if(-1==l.indexOf(l[d]+"_"+p)){l[d]+="_"+p;break}}var m=wa(t["!ref"]),v=[];for(d=0;d<=m.e.c-m.s.c;++d){var b=[];for(p=0;p<u.length;++p)null!=u[p][d]&&b.push(u[p][d]);if(0!=b.length&&null!=l[d]){var y="",_="";for(p=0;p<b.length;++p){switch(c(b[p])){case"number":_="B";break;case"string":_="C";break;case"boolean":_="L";break;case"object":_=b[p]instanceof Date?"D":"C";break;default:_="C"}if(y=y&&y!=_?"C":_,"C"==y)break}f+=r[y]||0,v[d]=y}else v[d]="?"}var D=i.next(32);for(D._W(4,318902576),D._W(4,u.length),D._W(2,296+32*h),D._W(2,f),d=0;d<4;++d)D._W(4,0);for(D._W(4,0|(+e[o]||3)<<8),d=0,p=0;d<l.length;++d)if(null!=l[d]){var C=i.next(32),w=(l[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C._W(1,w,"sbcs"),C._W(1,"?"==v[d]?"C":v[d],"sbcs"),C._W(4,p),C._W(1,r[v[d]]||0),C._W(1,0),C._W(1,2),C._W(4,0),C._W(1,0),C._W(4,0),C._W(4,0),p+=r[v[d]]||0}var x=i.next(264);for(x._W(4,13),d=0;d<65;++d)x._W(4,0);for(d=0;d<u.length;++d){var k=i.next(f);for(k._W(1,0),p=0;p<l.length;++p)if(null!=l[p])switch(v[p]){case"L":k._W(1,null==u[d][p]?63:u[d][p]?84:70);break;case"B":k._W(8,u[d][p]||0,"f");break;case"D":u[d][p]?(k._W(4,("0000"+u[d][p].getFullYear()).slice(-4),"sbcs"),k._W(2,("00"+(u[d][p].getMonth()+1)).slice(-2),"sbcs"),k._W(2,("00"+u[d][p].getDate()).slice(-2),"sbcs")):k._W(8,"00000000","sbcs");break;case"C":var S=String(u[d][p]||"");for(k._W(1,S,"sbcs"),h=0;h<250-S.length;++h)k._W(1,32);break}}return i.next(1)._W(1,26),i.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),uo=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,0:176,1:177,2:178,3:179,B:180,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("N("+Q(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(e,a){var n=t[a];return"number"==typeof n?D(n):n},n=function(t,e,a){var n=e.charCodeAt(0)-32<<4|a.charCodeAt(0)-48;return 59==n?t:D(n)};function i(t,e){switch(e.type){case"base64":return r(x.decode(t),e);case"binary":return r(t,e);case"buffer":return r(t.toString("binary"),e);case"array":return r(pt(t),e)}throw new Error("Unrecognized type "+e.type)}function r(t,i){var r,s=t.split(/[\n\r]+/),o=-1,l=-1,u=0,d=0,c=[],p=[],h=null,f={},m=[],v=[],b=[],y=0;for(+i.codepage>=0&&g(+i.codepage);u!==s.length;++u){y=0;var _,D=s[u].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,a),C=D.replace(/;;/g,"\0").split(";").map((function(t){return t.replace(/\u0000/g,";")})),w=C[0];if(D.length>0)switch(w){case"ID":break;case"E":break;case"B":break;case"O":break;case"P":"P"==C[1].charAt(0)&&p.push(D.slice(3).replace(/;;/g,";"));break;case"C":var x=!1,k=!1;for(d=1;d<C.length;++d)switch(C[d].charAt(0)){case"X":l=parseInt(C[d].slice(1))-1,k=!0;break;case"Y":for(o=parseInt(C[d].slice(1))-1,k||(l=0),r=c.length;r<=o;++r)c[r]=[];break;case"K":_=C[d].slice(1),'"'===_.charAt(0)?_=_.slice(1,_.length-1):"TRUE"===_?_=!0:"FALSE"===_?_=!1:isNaN(ft(_))?isNaN(mt(_).getDate())||(_=ct(_)):(_=ft(_),null!==h&&U.is_date(h)&&(_=ot(_))),"undefined"!==typeof cptable&&"string"==typeof _&&"string"!=(i||{}).type&&(i||{}).codepage&&(_=cptable.utils.decode(i.codepage,_)),x=!0;break;case"E":var S=Zu(C[d].slice(1),{r:o,c:l});c[o][l]=[c[o][l],S];break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+D)}x&&(c[o][l]=_,h=null);break;case"F":var A=0;for(d=1;d<C.length;++d)switch(C[d].charAt(0)){case"X":l=parseInt(C[d].slice(1))-1,++A;break;case"Y":for(o=parseInt(C[d].slice(1))-1,r=c.length;r<=o;++r)c[r]=[];break;case"M":y=parseInt(C[d].slice(1))/20;break;case"F":break;case"G":break;case"P":h=p[parseInt(C[d].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=C[d].slice(1).split(" "),r=parseInt(b[0],10);r<=parseInt(b[1],10);++r)y=parseInt(b[2],10),v[r-1]=0===y?{hidden:!0}:{wch:y},ml(v[r-1]);break;case"C":l=parseInt(C[d].slice(1))-1,v[l]||(v[l]={});break;case"R":o=parseInt(C[d].slice(1))-1,m[o]||(m[o]={}),y>0?(m[o].hpt=y,m[o].hpx=_l(y)):0===y&&(m[o].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+D)}A<1&&(h=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+D)}}return m.length>0&&(f["!rows"]=m),v.length>0&&(f["!cols"]=v),i&&i.sheetRows&&(c=c.slice(0,i.sheetRows)),[c,f]}function s(t,e){var a=i(t,e),n=a[0],r=a[1],s=Ea(n,e);return Q(r).forEach((function(t){s[t]=r[t]})),s}function o(t,e){return Sa(s(t,e),e)}function l(t,e,a,n){var i="C;Y"+(a+1)+";X"+(n+1)+";K";switch(t.t){case"n":i+=t.v||0,t.f&&!t.F&&(i+=";E"+td(t.f,{r:a,c:n}));break;case"b":i+=t.v?"TRUE":"FALSE";break;case"e":i+=t.w||t.v;break;case"d":i+='"'+(t.w||t.v)+'"';break;case"s":i+='"'+t.v.replace(/"/g,"")+'"';break}return i}function u(t,e){e.forEach((function(e,a){var n="F;W"+(a+1)+" "+(a+1)+" ";e.hidden?n+="0":("number"==typeof e.width&&(e.wpx=cl(e.width)),"number"==typeof e.wpx&&(e.wch=pl(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&t.push(n)}))}function d(t,e){e.forEach((function(e,a){var n="F;";e.hidden?n+="M0;":e.hpt?n+="M"+20*e.hpt+";":e.hpx&&(n+="M"+20*yl(e.hpx)+";"),n.length>2&&t.push(n+"R"+(a+1))}))}function c(t,e){var a,n=["ID;PWXL;N;E"],i=[],r=wa(t["!ref"]),s=Array.isArray(t),o="\r\n";n.push("P;PGeneral"),n.push("F;P0;DG0G8;M255"),t["!cols"]&&u(n,t["!cols"]),t["!rows"]&&d(n,t["!rows"]),n.push("B;Y"+(r.e.r-r.s.r+1)+";X"+(r.e.c-r.s.c+1)+";D"+[r.s.c,r.s.r,r.e.c,r.e.r].join(" "));for(var c=r.s.r;c<=r.e.r;++c)for(var p=r.s.c;p<=r.e.c;++p){var h=_a({r:c,c:p});a=s?(t[c]||[])[p]:t[h],a&&(null!=a.v||a.f&&!a.F)&&i.push(l(a,t,c,p,e))}return n.join(o)+o+i.join(o)+o+"E"+o}return t["|"]=254,{to_workbook:o,to_sheet:s,from_sheet:c}}(),co=function(){function t(t,a){switch(a.type){case"base64":return e(x.decode(t),a);case"binary":return e(t,a);case"buffer":return e(t.toString("binary"),a);case"array":return e(pt(t),a)}throw new Error("Unrecognized type "+a.type)}function e(t,e){for(var a=t.split("\n"),n=-1,i=-1,r=0,s=[];r!==a.length;++r)if("BOT"!==a[r].trim()){if(!(n<0)){var o=a[r].trim().split(","),l=o[0],u=o[1];++r;var d=a[r].trim();switch(+l){case-1:if("BOT"===d){s[++n]=[],i=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?s[n][i]=!0:"FALSE"===d?s[n][i]=!1:isNaN(ft(u))?isNaN(mt(u).getDate())?s[n][i]=u:s[n][i]=ct(u):s[n][i]=ft(u),++i;break;case 1:d=d.slice(1,d.length-1),s[n][i++]=""!==d?d:null;break}if("EOD"===d)break}}else s[++n]=[],i=0;return e&&e.sheetRows&&(s=s.slice(0,e.sheetRows)),s}function a(e,a){return Ea(t(e,a),a)}function n(t,e){return Sa(a(t,e),e)}var i=function(){var t=function(t,e,a,n,i){t.push(e),t.push(a+","+n),t.push('"'+i.replace(/"/g,'""')+'"')},e=function(t,e,a,n){t.push(e+","+a),t.push(1==e?'"'+n.replace(/"/g,'""')+'"':n)};return function(a){var n,i=[],r=wa(a["!ref"]),s=Array.isArray(a);t(i,"TABLE",0,1,"sheetjs"),t(i,"VECTORS",0,r.e.r-r.s.r+1,""),t(i,"TUPLES",0,r.e.c-r.s.c+1,""),t(i,"DATA",0,0,"");for(var o=r.s.r;o<=r.e.r;++o){e(i,-1,0,"BOT");for(var l=r.s.c;l<=r.e.c;++l){var u=_a({r:o,c:l});if(n=s?(a[o]||[])[l]:a[u],n)switch(n.t){case"n":var d=w?n.w:n.v;d||null==n.v||(d=n.v),null==d?w&&n.f&&!n.F?e(i,1,0,"="+n.f):e(i,1,0,""):e(i,0,d,"V");break;case"b":e(i,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":e(i,1,0,!w||isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=U.format(n.z||U._table[14],st(ct(n.v)))),w?e(i,0,n.w,"V"):e(i,1,0,n.w);break;default:e(i,1,0,"")}else e(i,1,0,"")}}e(i,-1,0,"EOD");var c="\r\n",p=i.join(c);return p}}();return{to_workbook:n,to_sheet:a,from_sheet:i}}(),po=function(){function t(t){return t.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function e(t){return t.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(e,a){for(var n=e.split("\n"),i=-1,r=-1,s=0,o=[];s!==n.length;++s){var l=n[s].trim().split(":");if("cell"===l[0]){var u=ya(l[1]);if(o.length<=u.r)for(i=o.length;i<=u.r;++i)o[i]||(o[i]=[]);switch(i=u.r,r=u.c,l[2]){case"t":o[i][r]=t(l[3]);break;case"v":o[i][r]=+l[3];break;case"vtf":var d=l[l.length-1];case"vtc":switch(l[3]){case"nl":o[i][r]=!!+l[4];break;default:o[i][r]=+l[4];break}"vtf"==l[2]&&(o[i][r]=[o[i][r],d])}}}return a&&a.sheetRows&&(o=o.slice(0,a.sheetRows)),o}function n(t,e){return Ea(a(t,e),e)}function i(t,e){return Sa(n(t,e),e)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),l="--SocialCalcSpreadsheetControlSave--";function u(t){if(!t||!t["!ref"])return"";for(var a,n=[],i=[],r="",s=Da(t["!ref"]),o=Array.isArray(t),l=s.s.r;l<=s.e.r;++l)for(var u=s.s.c;u<=s.e.c;++u)if(r=_a({r:l,c:u}),a=o?(t[l]||[])[u]:t[r],a&&null!=a.v&&"z"!==a.t){switch(i=["cell",r,"t"],a.t){case"s":case"str":i.push(e(a.v));break;case"n":a.f?(i[2]="vtf",i[3]="n",i[4]=a.v,i[5]=e(a.f)):(i[2]="v",i[3]=a.v);break;case"b":i[2]="vt"+(a.f?"f":"c"),i[3]="nl",i[4]=a.v?"1":"0",i[5]=e(a.f||(a.v?"TRUE":"FALSE"));break;case"d":var d=st(ct(a.v));i[2]="vtc",i[3]="nd",i[4]=""+d,i[5]=a.w||U.format(a.z||U._table[14],d);break;case"e":continue}n.push(i.join(":"))}return n.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}function d(t){return[r,s,o,s,u(t),l].join("\n")}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),ho=function(){function t(t,e,a,n,i){i.raw?e[a][n]=t:"TRUE"===t?e[a][n]=!0:"FALSE"===t?e[a][n]=!1:""===t||(isNaN(ft(t))?isNaN(mt(t).getDate())?e[a][n]=t:e[a][n]=ct(t):e[a][n]=ft(t))}function e(e,a){var n=a||{},i=[];if(!e||0===e.length)return i;var r=e.split(/[\r\n]/),s=r.length-1;while(s>=0&&0===r[s].length)--s;for(var o=10,l=0,u=0;u<=s;++u)l=r[u].indexOf(" "),-1==l?l=r[u].length:l++,o=Math.max(o,l);for(u=0;u<=s;++u){i[u]=[];var d=0;for(t(r[u].slice(0,o).trim(),i,u,d,n),d=1;d<=(r[u].length-o)/10+1;++d)t(r[u].slice(o+10*(d-1),o+10*d).trim(),i,u,d,n)}return n.sheetRows&&(i=i.slice(0,n.sheetRows)),i}var a={44:",",9:"\t",59:";"},n={44:3,9:2,59:1};function i(t){for(var e={},i=!1,r=0,s=0;r<t.length;++r)34==(s=t.charCodeAt(r))?i=!i:!i&&s in a&&(e[s]=(e[s]||0)+1);for(r in s=[],e)e.hasOwnProperty(r)&&s.push([e[r],r]);if(!s.length)for(r in e=n,e)e.hasOwnProperty(r)&&s.push([e[r],r]);return s.sort((function(t,e){return t[0]-e[0]||n[t[1]]-n[e[1]]})),a[s.pop()[1]]}function r(t,e){var a=e||{},n="";null!=C&&null==a.dense&&(a.dense=C);var r=a.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==t.slice(0,4)&&10==t.charCodeAt(5)?(n=t.charAt(4),t=t.slice(6)):n=i(t.slice(0,1024));var o=0,l=0,u=0,d=0,c=0,p=n.charCodeAt(0),h=!1,g=0;t=t.replace(/\r\n/gm,"\n");var f=null!=a.dateNF?z(a.dateNF):null;function m(){var e=t.slice(d,c),n={};if('"'==e.charAt(0)&&'"'==e.charAt(e.length-1)&&(e=e.slice(1,-1).replace(/""/g,'"')),0===e.length)n.t="z";else if(a.raw)n.t="s",n.v=e;else if(0===e.trim().length)n.t="s",n.v=e;else if(61==e.charCodeAt(0))34==e.charCodeAt(1)&&34==e.charCodeAt(e.length-1)?(n.t="s",n.v=e.slice(2,-1).replace(/""/g,'"')):nd(e)?(n.t="n",n.f=e.slice(1)):(n.t="s",n.v=e);else if("TRUE"==e)n.t="b",n.v=!0;else if("FALSE"==e)n.t="b",n.v=!1;else if(isNaN(u=ft(e)))if(!isNaN(mt(e).getDate())||f&&e.match(f)){n.z=a.dateNF||U._table[14];var i=0;f&&e.match(f)&&(e=V(e,a.dateNF,e.match(f)||[]),i=1),a.cellDates?(n.t="d",n.v=ct(e,i)):(n.t="n",n.v=st(ct(e,i))),!1!==a.cellText&&(n.w=U.format(n.z,n.v instanceof Date?st(n.v):n.v)),a.cellNF||delete n.z}else n.t="s",n.v=e;else n.t="n",!1!==a.cellText&&(n.w=e),n.v=u;if("z"==n.t||(a.dense?(r[o]||(r[o]=[]),r[o][l]=n):r[_a({c:l,r:o})]=n),d=c+1,s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),g==p)++l;else if(l=0,++o,a.sheetRows&&a.sheetRows<=o)return!0}t:for(;c<t.length;++c)switch(g=t.charCodeAt(c)){case 34:h=!h;break;case p:case 10:case 13:if(!h&&m())break t;break;default:break}return c-d>0&&m(),r["!ref"]=Ca(s),r}function s(t,a){return"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?r(t,a):Ea(e(t,a),a)}function o(t,e){var a="",n="string"==e.type?[0,0,0,0]:gm(t,e);switch(e.type){case"base64":a=x.decode(t);break;case"binary":a=t;break;case"buffer":a=65001==e.codepage?t.toString("utf8"):e.codepage&&"undefined"!==typeof cptable?cptable.utils.decode(e.codepage,t):t.toString("binary");break;case"array":a=pt(t);break;case"string":a=t;break;default:throw new Error("Unrecognized type "+e.type)}return 239==n[0]&&187==n[1]&&191==n[2]?a=Zt(a.slice(3)):"binary"==e.type&&"undefined"!==typeof cptable&&e.codepage&&(a=cptable.utils.decode(e.codepage,cptable.utils.encode(1252,a))),"socialcalc:version:"==a.slice(0,19)?po.to_sheet("string"==e.type?a:Zt(a),e):s(a,e)}function l(t,e){return Sa(o(t,e),e)}function u(t){for(var e,a=[],n=wa(t["!ref"]),i=Array.isArray(t),r=n.s.r;r<=n.e.r;++r){for(var s=[],o=n.s.c;o<=n.e.c;++o){var l=_a({r:r,c:o});if(e=i?(t[r]||[])[o]:t[l],e&&null!=e.v){var u=(e.w||(ka(e),e.w)||"").slice(0,10);while(u.length<10)u+=" ";s.push(u+(0===o?" ":""))}else s.push("          ")}a.push(s.join(""))}return a.join("\n")}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function go(t,e){var a=e||{},n=!!a.WTF;a.WTF=!0;try{var i=uo.to_workbook(t,a);return a.WTF=n,i}catch(d){if(a.WTF=n,!d.message.match(/SYLK bad record ID/)&&n)throw d;return ho.to_workbook(t,e)}}var fo=function(){function t(t,e,a){if(t){Ze(t,t.l||0);var n=a.Enum||v;while(t.l<t.length){var i=t._R(2),r=n[i]||n[255],s=t._R(2),o=t.l+s,l=(r.f||Qe)(t,s,a);if(t.l=o,e(l,r.n,i))return}}}function e(t,e){switch(e.type){case"base64":return a(I(x.decode(t)),e);case"binary":return a(I(t),e);case"buffer":case"array":return a(t,e)}throw"Unsupported type "+e.type}function a(e,a){if(!e)return e;var n=a||{};null!=C&&null==n.dense&&(n.dense=C);var i=n.dense?[]:{},r="Sheet1",s=0,o={},l=[r],u={s:{r:0,c:0},e:{r:0,c:0}},d=n.sheetRows||0;if(2==e[2])n.Enum=v;else if(26==e[2])n.Enum=b;else{if(14!=e[2])throw new Error("Unrecognized LOTUS BOF "+e[2]);n.Enum=b,n.qpro=!0,e.l=0}return t(e,(function(t,a,c){if(2==e[2])switch(c){case 0:n.vers=t,t>=4096&&(n.qpro=!0);break;case 6:u=t;break;case 15:n.qpro||(t[1].v=t[1].v.slice(1));case 13:case 14:case 16:case 51:14==c&&112==(112&t[2])&&(15&t[2])>1&&(15&t[2])<15&&(t[1].z=n.dateNF||U._table[14],n.cellDates&&(t[1].t="d",t[1].v=ot(t[1].v))),n.dense?(i[t[0].r]||(i[t[0].r]=[]),i[t[0].r][t[0].c]=t[1]):i[_a(t[0])]=t[1];break}else switch(c){case 22:t[1].v=t[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(t[3]>s&&(i["!ref"]=Ca(u),o[r]=i,i=n.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},s=t[3],r="Sheet"+(s+1),l.push(r)),d>0&&t[0].r>=d)break;n.dense?(i[t[0].r]||(i[t[0].r]=[]),i[t[0].r][t[0].c]=t[1]):i[_a(t[0])]=t[1],u.e.c<t[0].c&&(u.e.c=t[0].c),u.e.r<t[0].r&&(u.e.r=t[0].r);break;default:break}}),n),i["!ref"]=Ca(u),o[r]=i,{SheetNames:l,Sheets:o}}function n(t){var e={s:{c:0,r:0},e:{c:0,r:0}};return e.s.c=t._R(2),e.s.r=t._R(2),e.e.c=t._R(2),e.e.r=t._R(2),65535==e.s.c&&(e.s.c=e.e.c=e.s.r=e.e.r=0),e}function i(t,e,a){var n=[{c:0,r:0},{t:"n",v:0},0];return a.qpro&&20768!=a.vers?(n[0].c=t._R(1),t.l++,n[0].r=t._R(2),t.l+=2):(n[2]=t._R(1),n[0].c=t._R(2),n[0].r=t._R(2)),n}function r(t,e,a){var n=t.l+e,r=i(t,e,a);if(r[1].t="s",20768==a.vers){t.l++;var s=t._R(1);return r[1].v=t._R(s,"utf8"),r}return a.qpro&&t.l++,r[1].v=t._R(n-t.l,"cstr"),r}function s(t,e,a){var n=i(t,e,a);return n[1].v=t._R(2,"i"),n}function o(t,e,a){var n=i(t,e,a);return n[1].v=t._R(8,"f"),n}function l(t,e,a){var n=t.l+e,r=i(t,e,a);if(r[1].v=t._R(8,"f"),a.qpro)t.l=n;else{var s=t._R(2);t.l+=s}return r}function u(t){var e=[{c:0,r:0},{t:"n",v:0},0];return e[0].r=t._R(2),e[3]=t[t.l++],e[0].c=t[t.l++],e}function d(t,e){var a=u(t,e);return a[1].t="s",a[1].v=t._R(e-4,"cstr"),a}function c(t,e){var a=u(t,e);a[1].v=t._R(2);var n=a[1].v>>1;if(1&a[1].v)switch(7&n){case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 4:n=(n>>3)/2e3;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64;break;default:throw"unknown NUMBER_18 encoding "+(7&n)}return a[1].v=n,a}function p(t,e){var a=u(t,e),n=t._R(4),i=t._R(4),r=t._R(2);if(65535==r)return a[1].v=0,a;var s=32768&r;return r=(32767&r)-16446,a[1].v=(2*s-1)*((r>0?i<<r:i>>>-r)+(r>-32?n<<r+32:n>>>-(r+32))),a}function h(t,e){var a=p(t,14);return t.l+=e-14,a}function g(t,e){var a=u(t,e),n=t._R(4);return a[1].v=n>>6,a}function f(t,e){var a=u(t,e),n=t._R(8,"f");return a[1].v=n,a}function m(t,e){var a=f(t,14);return t.l+=e-10,a}var v={0:{n:"BOF",f:Xi},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:n},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:s},14:{n:"NUMBER",f:o},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:l},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},255:{n:"",f:Qe}},b={0:{n:"BOF"},1:{n:"EOF"},3:{n:"??"},4:{n:"??"},5:{n:"??"},6:{n:"??"},7:{n:"??"},9:{n:"??"},10:{n:"??"},11:{n:"??"},12:{n:"??"},14:{n:"??"},15:{n:"??"},16:{n:"??"},17:{n:"??"},18:{n:"??"},19:{n:"??"},21:{n:"??"},22:{n:"LABEL16",f:d},23:{n:"NUMBER17",f:p},24:{n:"NUMBER18",f:c},25:{n:"FORMULA19",f:h},26:{n:"??"},27:{n:"??"},28:{n:"??"},29:{n:"??"},30:{n:"??"},31:{n:"??"},33:{n:"??"},37:{n:"NUMBER25",f:g},39:{n:"NUMBER27",f:f},40:{n:"FORMULA28",f:m},255:{n:"",f:Qe}};return{to_workbook:e}}(),mo=function(){var t=ne("t"),e=ne("rPr"),a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/,i=/\r\n/g,r=function(t,e,a){var n={},i=65001,r="",s=!1,o=t.match(Bt),l=0;if(o)for(;l!=o.length;++l){var u=Lt(o[l]);switch(u[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!u.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==u.val)break;i=d[parseInt(u.val,10)];break;case"<outline":if(!u.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=u.val;break;case"<sz":n.sz=u.val;break;case"<strike":if(!u.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!u.val)break;switch(u.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if("0"==u.val)break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if("0"==u.val)break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":u.rgb&&(n.color=u.rgb.slice(2,8));break;case"<family":n.family=u.val;break;case"<vertAlign":r=u.val;break;case"<scheme":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(47!==u[0].charCodeAt(1)&&!s)throw new Error("Unrecognized rich format "+u[0])}}var c=[];return n.u&&c.push("text-decoration: underline;"),n.uval&&c.push("text-underline-style:"+n.uval+";"),n.sz&&c.push("font-size:"+n.sz+"pt;"),n.outline&&c.push("text-effect: outline;"),n.shadow&&c.push("text-shadow: auto;"),e.push('<span style="'+c.join("")+'">'),n.b&&(e.push("<b>"),a.push("</b>")),n.i&&(e.push("<i>"),a.push("</i>")),n.strike&&(e.push("<s>"),a.push("</s>")),"superscript"==r?r="sup":"subscript"==r&&(r="sub"),""!=r&&(e.push("<"+r+">"),a.push("</"+r+">")),a.push("</span>"),i};function s(a){var n=[[],"",[]],s=a.match(t);if(!s)return"";n[1]=s[1];var o=a.match(e);return o&&r(o[1],n[0],n[2]),n[0].join("")+n[1].replace(i,"<br/>")+n[2].join("")}return function(t){return t.replace(a,"").split(n).map(s).join("")}}(),vo=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,bo=/<(?:\w+:)?r>/,yo=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function _o(t,e){var a=!e||e.cellHTML,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ht(Zt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Zt(t),a&&(n.h=Gt(n.t))):t.match(bo)&&(n.r=Zt(t),n.t=Ht(Zt((t.replace(yo,"").match(vo)||[]).join("").replace(Bt,""))),a&&(n.h=mo(n.r))),n):null}var Do=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Co=/<(?:\w+:)?(?:si|sstItem)>/g,wo=/<\/(?:\w+:)?(?:si|sstItem)>/;function xo(t,e){var a=[],n="";if(!t)return a;var i=t.match(Do);if(i){n=i[2].replace(Co,"").split(wo);for(var r=0;r!=n.length;++r){var s=_o(n[r].trim(),e);null!=s&&(a[a.length]=s)}i=Lt(i[1]),a.Count=i.count,a.Unique=i.uniqueCount}return a}Hn.SST="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings";var ko=/^\s|\s$|[\t\n\r]/;function So(t,e){if(!e.bookSST)return"";var a=[Nt];a[a.length]=pe("sst",null,{xmlns:fe.main[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(null!=t[n]){var i=t[n],r="<si>";i.r?r+=i.r:(r+="<t",i.t||(i.t=""),i.t.match(ko)&&(r+=' xml:space="preserve"'),r+=">"+zt(i.t)+"</t>"),r+="</si>",a[a.length]=r}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function Ao(t){return[t._R(4),t._R(4)]}function Eo(t,e){var a=[],n=!1;return ea(t,(function(t,i,r){switch(r){case 159:a.Count=t[0],a.Unique=t[1];break;case 19:a.push(t);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.indexOf("Begin")>0||i.indexOf("End"),!n||e.WTF)throw new Error("Unexpected record "+r+" "+i)}})),a}function To(t,e){return e||(e=ta(8)),e._W(4,t.Count),e._W(4,t.Unique),e}var Io=Oa;function Po(t){var e=aa();na(e,"BrtBeginSst",To(t));for(var a=0;a<t.length;++a)na(e,"BrtSSTItem",Io(t[a]));return na(e,"BrtEndSst"),e.end()}function No(t){if("undefined"!==typeof cptable)return cptable.utils.encode(o,t);for(var e=[],a=t.split(""),n=0;n<a.length;++n)e[n]=a[n].charCodeAt(0);return e}function Ro(t,e){var a={};return a.Major=t._R(2),a.Minor=t._R(2),e>=4&&(t.l+=e-4),a}function Bo(t){var e={};return e.id=t._R(0,"lpp4"),e.R=Ro(t,4),e.U=Ro(t,4),e.W=Ro(t,4),e}function Oo(t){var e=t._R(4),a=t.l+e-4,n={},i=t._R(4),r=[];while(i-- >0)r.push({t:t._R(4),v:t._R(0,"lpp4")});if(n.name=t._R(0,"lpp4"),n.comps=r,t.l!=a)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+a);return n}function Mo(t){var e=[];t.l+=4;var a=t._R(4);while(a-- >0)e.push(Oo(t));return e}function Lo(t){var e=[];t.l+=4;var a=t._R(4);while(a-- >0)e.push(t._R(0,"lpp4"));return e}function Uo(t){var e={};return t._R(4),t.l+=4,e.id=t._R(0,"lpp4"),e.name=t._R(0,"lpp4"),e.R=Ro(t,4),e.U=Ro(t,4),e.W=Ro(t,4),e}function Fo(t){var e=Uo(t);if(e.ename=t._R(0,"8lpp4"),e.blksz=t._R(4),e.cmode=t._R(4),4!=t._R(4))throw new Error("Bad !Primary record");return e}function $o(t,e){var a=t.l+e,n={};n.Flags=63&t._R(4),t.l+=4,n.AlgID=t._R(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=36==n.Flags;break;case 26625:i=4==n.Flags;break;case 0:i=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t._R(4),n.KeySize=t._R(4),n.ProviderType=t._R(4),t.l+=8,n.CSPName=t._R(a-t.l>>1,"utf16le"),t.l=a,n}function Ho(t,e){var a={},n=t.l+e;return t.l+=4,a.Salt=t.slice(t.l,t.l+16),t.l+=16,a.Verifier=t.slice(t.l,t.l+16),t.l+=16,t._R(4),a.VerifierHash=t.slice(t.l,n),t.l=n,a}function jo(t){var e=Ro(t);switch(e.Minor){case 2:return[e.Minor,Wo(t,e)];case 3:return[e.Minor,zo(t,e)];case 4:return[e.Minor,Vo(t,e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Wo(t){var e=t._R(4);if(36!=(63&e))throw new Error("EncryptionInfo mismatch");var a=t._R(4),n=$o(t,a),i=Ho(t,t.length-t.l);return{t:"Std",h:n,v:i}}function zo(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Vo(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var a=t._R(t.length-t.l,"utf8"),n={};return a.replace(Bt,(function(t){var a=Lt(t);switch(Ut(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach((function(t){n[t]=a[t]}));break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}})),n}function qo(t,e){var a={},n=a.EncryptionVersionInfo=Ro(t,4);if(e-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);a.Flags=t._R(4),e-=4;var i=t._R(4);return e-=4,a.EncryptionHeader=$o(t,i),e-=i,a.EncryptionVerifier=Ho(t,e),a}function Go(t){var e={},a=e.EncryptionVersionInfo=Ro(t,4);if(1!=a.Major||1!=a.Minor)throw"unrecognized version code "+a.Major+" : "+a.Minor;return e.Salt=t._R(16),e.EncryptedVerifier=t._R(16),e.EncryptedVerifierHash=t._R(16),e}function Ko(t){var e,a,n,i,r,s,o=0,l=No(t),u=l.length+1;for(e=E(u),e[0]=l.length,a=1;a!=u;++a)e[a]=l[a-1];for(a=u-1;a>=0;--a)n=e[a],i=0===(16384&o)?0:1,r=o<<1&32767,s=i|r,o=s^n;return 52811^o}var Xo=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(t){return 255&(t/2|128*t)},i=function(t,e){return n(t^e)},r=function(t){for(var n=e[t.length-1],i=104,r=t.length-1;r>=0;--r)for(var s=t[r],o=0;7!=o;++o)64&s&&(n^=a[i]),s*=2,--i;return n};return function(e){for(var a,n,s,o=No(e),l=r(o),u=o.length,d=E(16),c=0;16!=c;++c)d[c]=0;1===(1&u)&&(a=l>>8,d[u]=i(t[0],a),--u,a=255&l,n=o[o.length-1],d[u]=i(n,a));while(u>0)--u,a=l>>8,d[u]=i(o[u],a),--u,a=255&l,d[u]=i(o[u],a);u=15,s=15-o.length;while(s>0)a=l>>8,d[u]=i(t[s],a),--u,--s,a=255&l,d[u]=i(o[u],a),--u,--s;return d}}(),Yo=function(t,e,a,n,i){var r,s;for(i||(i=e),n||(n=Xo(t)),r=0;r!=e.length;++r)s=e[r],s^=n[a],s=255&(s>>5|s<<3),i[r]=s,++a;return[i,a,n]},Jo=function(t){var e=0,a=Xo(t);return function(t){var n=Yo("",t,e,a);return e=n[1],n[0]}};function Zo(t,e,a,n){var i={key:Xi(t),verificationBytes:Xi(t)};return a.password&&(i.verifier=Ko(a.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Jo(a.password)),i}function Qo(t,e,a){var n=a||{};return n.Info=t._R(2),t.l-=2,1===n.Info?n.Data=Go(t,e):n.Data=qo(t,e),n}function tl(t,e,a){var n={Type:a.biff>=8?t._R(2):0};return n.Type?Qo(t,e-2,n):Zo(t,a.biff>=8?e:e-2,a,n),n}var el=function(){function t(t,a){switch(a.type){case"base64":return e(x.decode(t),a);case"binary":return e(t,a);case"buffer":return e(t.toString("binary"),a);case"array":return e(pt(t),a)}throw new Error("Unrecognized type "+a.type)}function e(t,e){var a=e||{},n=a.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};if(!t.match(/\\trowd/))throw new Error("RTF missing table");return n["!ref"]=Ca(i),n}function a(e,a){return Sa(t(e,a),a)}function n(t){for(var e,a=["{\\rtf1\\ansi"],n=wa(t["!ref"]),i=Array.isArray(t),r=n.s.r;r<=n.e.r;++r){a.push("\\trowd\\trautofit1");for(var s=n.s.c;s<=n.e.c;++s)a.push("\\cellx"+(s+1));for(a.push("\\pard\\intbl"),s=n.s.c;s<=n.e.c;++s){var o=_a({r:r,c:s});e=i?(t[r]||[])[s]:t[o],e&&(null!=e.v||e.f&&!e.F)&&(a.push(" "+(e.w||(ka(e),e.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:a,to_sheet:t,from_sheet:n}}();function al(t){var e=t.slice("#"===t[0]?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function nl(t){for(var e=0,a=1;3!=e;++e)a=256*a+(t[e]>255?255:t[e]<0?0:t[e]);return a.toString(16).toUpperCase().slice(1)}function il(t){var e=t[0]/255,a=t[1]/255,n=t[2]/255,i=Math.max(e,a,n),r=Math.min(e,a,n),s=i-r;if(0===s)return[0,0,e];var o=0,l=0,u=i+r;switch(l=s/(u>1?2-u:u),i){case e:o=((a-n)/s+6)%6;break;case a:o=(n-e)/s+2;break;case n:o=(e-a)/s+4;break}return[o/6,l,u/2]}function rl(t){var e,a=t[0],n=t[1],i=t[2],r=2*n*(i<.5?i:1-i),s=i-r/2,o=[s,s,s],l=6*a;if(0!==n)switch(0|l){case 0:case 6:e=r*l,o[0]+=r,o[1]+=e;break;case 1:e=r*(2-l),o[0]+=e,o[1]+=r;break;case 2:e=r*(l-2),o[1]+=r,o[2]+=e;break;case 3:e=r*(4-l),o[1]+=e,o[2]+=r;break;case 4:e=r*(l-4),o[2]+=r,o[0]+=e;break;case 5:e=r*(6-l),o[2]+=e,o[0]+=r;break}for(var u=0;3!=u;++u)o[u]=Math.round(255*o[u]);return o}function sl(t,e){if(0===e)return t;var a=il(al(t));return a[2]=e<0?a[2]*(1+e):1-(1-a[2])*(1-e),nl(rl(a))}var ol=6,ll=15,ul=1,dl=ol;function cl(t){return Math.floor((t+Math.round(128/dl)/256)*dl)}function pl(t){return Math.floor((t-5)/dl*100+.5)/100}function hl(t){return Math.round((t*dl+5)/dl*256)/256}function gl(t){return hl(pl(cl(t)))}function fl(t){var e=Math.abs(t-gl(t)),a=dl;if(e>.005)for(dl=ul;dl<ll;++dl)Math.abs(t-gl(t))<=e&&(e=Math.abs(t-gl(t)),a=dl);dl=a}function ml(t){t.width?(t.wpx=cl(t.width),t.wch=pl(t.wpx),t.MDW=dl):t.wpx?(t.wch=pl(t.wpx),t.width=hl(t.wch),t.MDW=dl):"number"==typeof t.wch&&(t.width=hl(t.wch),t.wpx=cl(t.width),t.MDW=dl),t.customWidth&&delete t.customWidth}var vl=96,bl=vl;function yl(t){return 96*t/bl}function _l(t){return t*bl/96}var Dl={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Cl(t,e,a,n){e.Borders=[];var i={},r=!1;t[0].match(Bt).forEach((function(t){var a=Lt(t);switch(Ut(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=a.diagonalUp),a.diagonalDown&&(i.diagonalDown=a.diagonalDown),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(n&&n.WTF&&!r)throw new Error("unrecognized "+a[0]+" in borders")}}))}function wl(t,e,a,n){e.Fills=[];var i={},r=!1;t[0].match(Bt).forEach((function(t){var a=Lt(t);switch(Ut(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(n&&n.WTF&&!r)throw new Error("unrecognized "+a[0]+" in fills")}}))}function xl(t,e,a,n){e.Fonts=[];var i={},r=!1;t[0].match(Bt).forEach((function(t){var s=Lt(t);switch(Ut(s[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":s.val&&(i.name=s.val);break;case"<name/>":case"</name>":break;case"<b":i.bold=s.val?Jt(s.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=s.val?Jt(s.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(s.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=s.val?Jt(s.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=s.val?Jt(s.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=s.val?Jt(s.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=s.val?Jt(s.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=s.val?Jt(s.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":s.val&&(i.sz=+s.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":s.val&&(i.vertAlign=s.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":s.val&&(i.family=parseInt(s.val,10));break;case"<family/>":case"</family>":break;case"<scheme":s.val&&(i.scheme=s.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if("1"==s.val)break;s.codepage=d[parseInt(s.val,10)];break;case"<color":if(i.color||(i.color={}),s.auto&&(i.color.auto=Jt(s.auto)),s.rgb)i.color.rgb=s.rgb.slice(-6);else if(s.indexed){i.color.index=parseInt(s.indexed,10);var o=Nn[i.color.index];if(81==i.color.index&&(o=Nn[1]),!o)throw new Error(t);i.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else s.theme&&(i.color.theme=parseInt(s.theme,10),s.tint&&(i.color.tint=parseFloat(s.tint)),s.theme&&a.themeElements&&a.themeElements.clrScheme&&(i.color.rgb=sl(a.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(n&&n.WTF&&!r)throw new Error("unrecognized "+s[0]+" in fonts")}}))}function kl(t,e,a){e.NumberFmt=[];for(var n=Q(U._table),i=0;i<n.length;++i)e.NumberFmt[n[i]]=U._table[n[i]];var r=t[0].match(Bt);if(r)for(i=0;i<r.length;++i){var s=Lt(r[i]);switch(Ut(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var o=Ht(Zt(s.formatCode)),l=parseInt(s.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60;--l)if(null==e.NumberFmt[l])break;e.NumberFmt[l]=o}U.load(o,l)}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function Sl(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(a){for(var n=a[0];n<=a[1];++n)null!=t[n]&&(e[e.length]=pe("numFmt",null,{numFmtId:n,formatCode:zt(t[n])}))})),1===e.length?"":(e[e.length]="</numFmts>",e[0]=pe("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Al=["numFmtId","fillId","fontId","borderId","xfId"],El=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Tl(t,e,a){var n;e.CellXf=[];var i=!1;t[0].match(Bt).forEach((function(t){var r=Lt(t),s=0;switch(Ut(r[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=r,delete n[0],s=0;s<Al.length;++s)n[Al[s]]&&(n[Al[s]]=parseInt(n[Al[s]],10));for(s=0;s<El.length;++s)n[El[s]]&&(n[El[s]]=Jt(n[El[s]]));if(n.numFmtId>392)for(s=392;s>60;--s)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[s]){n.numFmtId=s;break}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};r.vertical&&(o.vertical=r.vertical),r.horizontal&&(o.horizontal=r.horizontal),null!=r.textRotation&&(o.textRotation=r.textRotation),r.indent&&(o.indent=r.indent),r.wrapText&&(o.wrapText=r.wrapText),n.alignment=o;break;case"</alignment>":break;case"<protection":case"</protection>":case"<protection/>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+r[0]+" in cellXfs")}}))}function Il(t){var e=[];return e[e.length]=pe("cellXfs",null),t.forEach((function(t){e[e.length]=pe("xf",null,t)})),e[e.length]="</cellXfs>",2===e.length?"":(e[0]=pe("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Pl=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(r,s,o){var l,u={};return r?(r=r.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,""),(l=r.match(t))&&kl(l,u,o),(l=r.match(n))&&xl(l,u,s,o),(l=r.match(a))&&wl(l,u,s,o),(l=r.match(i))&&Cl(l,u,s,o),(l=r.match(e))&&Tl(l,u,o),u):u}}(),Nl=pe("styleSheet",null,{xmlns:fe.main[0],"xmlns:vt":fe.vt});function Rl(t,e){var a,n=[Nt,Nl];return t.SSF&&null!=(a=Sl(t.SSF))&&(n[n.length]=a),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Il(e.cellXfs))&&(n[n.length]=a),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Bl(t,e){var a=t._R(2),n=Ia(t,e-2);return[a,n]}function Ol(t,e,a){a||(a=ta(6+4*e.length)),a._W(2,t),Pa(e,a);var n=a.length>a.l?a.slice(0,a.l):a;return null==a.l&&(a.l=a.length),n}function Ml(t,e,a){var n={};n.sz=t._R(2)/20;var i=sn(t,2,a);i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1),i.fItalic&&(n.italic=1);var r=t._R(2);switch(700===r&&(n.bold=1),t._R(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=t._R(1);0!=s&&(n.underline=s);var o=t._R(1);o>0&&(n.family=o);var l=t._R(1);switch(l>0&&(n.charset=l),t.l++,n.color=nn(t,8),t._R(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ia(t,e-21),n}function Ll(t,e){e||(e=ta(153)),e._W(2,20*t.sz),on(t,e),e._W(2,t.bold?700:400);var a=0;"superscript"==t.vertAlign?a=1:"subscript"==t.vertAlign&&(a=2),e._W(2,a),e._W(1,t.underline||0),e._W(1,t.family||0),e._W(1,t.charset||0),e._W(1,0),rn(t.color,e);var n=0;return"major"==t.scheme&&(n=1),"minor"==t.scheme&&(n=2),e._W(1,n),Pa(t.name,e),e.length>e.l?e.slice(0,e.l):e}Hn.STY="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles";var Ul=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Fl=et(Ul),$l=Qe;function Hl(t,e){e||(e=ta(84));var a=Fl[t.patternType];null==a&&(a=40),e._W(4,a);var n=0;if(40!=a)for(rn({auto:1},e),rn({auto:1},e);n<12;++n)e._W(4,0);else{for(;n<4;++n)e._W(4,0);for(;n<12;++n)e._W(4,0)}return e.length>e.l?e.slice(0,e.l):e}function jl(t,e){var a=t.l+e,n=t._R(2),i=t._R(2);return t.l=a,{ixfe:n,numFmtId:i}}function Wl(t,e,a){return a||(a=ta(16)),a._W(2,e||0),a._W(2,t.numFmtId||0),a._W(2,0),a._W(2,0),a._W(2,0),a._W(1,0),a._W(1,0),a._W(1,0),a._W(1,0),a._W(1,0),a._W(1,0),a}function zl(t,e){return e||(e=ta(10)),e._W(1,0),e._W(1,0),e._W(4,0),e._W(4,0),e}var Vl=Qe;function ql(t,e){return e||(e=ta(51)),e._W(1,0),zl(null,e),zl(null,e),zl(null,e),zl(null,e),zl(null,e),e.length>e.l?e.slice(0,e.l):e}function Gl(t,e){return e||(e=ta(52)),e._W(4,t.xfId),e._W(2,1),e._W(1,+t.builtinId),e._W(1,0),Wa(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Kl(t,e,a){var n=ta(2052);return n._W(4,t),Wa(e,n),Wa(a,n),n.length>n.l?n.slice(0,n.l):n}function Xl(t,e,a){var n={NumberFmt:[]};for(var i in U._table)n.NumberFmt[i]=U._table[i];n.CellXf=[],n.Fonts=[];var r=[],s=!1;return ea(t,(function(t,i,o){switch(o){case 44:n.NumberFmt[t[0]]=t[1],U.load(t[1],t[0]);break;case 43:n.Fonts.push(t),null!=t.color.theme&&e&&e.themeElements&&e.themeElements.clrScheme&&(t.color.rgb=sl(e.themeElements.clrScheme[t.color.theme].rgb,t.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:"BrtBeginCellXFs"==r[r.length-1]&&n.CellXf.push(t);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:r.push(i);break;case 38:r.pop();break;default:if((i||"").indexOf("Begin")>0)r.push(i);else if((i||"").indexOf("End")>0)r.pop();else if(!s||a.WTF)throw new Error("Unexpected record "+o+" "+i)}})),n}function Yl(t,e){if(e){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(t){for(var n=t[0];n<=t[1];++n)null!=e[n]&&++a})),0!=a&&(na(t,"BrtBeginFmts",Ta(a)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(a){for(var n=a[0];n<=a[1];++n)null!=e[n]&&na(t,"BrtFmt",Ol(n,e[n]))})),na(t,"BrtEndFmts"))}}function Jl(t){var e=1;0!=e&&(na(t,"BrtBeginFonts",Ta(e)),na(t,"BrtFont",Ll({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),na(t,"BrtEndFonts"))}function Zl(t){var e=2;0!=e&&(na(t,"BrtBeginFills",Ta(e)),na(t,"BrtFill",Hl({patternType:"none"})),na(t,"BrtFill",Hl({patternType:"gray125"})),na(t,"BrtEndFills"))}function Ql(t){var e=1;0!=e&&(na(t,"BrtBeginBorders",Ta(e)),na(t,"BrtBorder",ql({})),na(t,"BrtEndBorders"))}function tu(t){var e=1;na(t,"BrtBeginCellStyleXFs",Ta(e)),na(t,"BrtXF",Wl({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),na(t,"BrtEndCellStyleXFs")}function eu(t,e){na(t,"BrtBeginCellXFs",Ta(e.length)),e.forEach((function(e){na(t,"BrtXF",Wl(e,0))})),na(t,"BrtEndCellXFs")}function au(t){var e=1;na(t,"BrtBeginStyles",Ta(e)),na(t,"BrtStyle",Gl({xfId:0,builtinId:0,name:"Normal"})),na(t,"BrtEndStyles")}function nu(t){var e=0;na(t,"BrtBeginDXFs",Ta(e)),na(t,"BrtEndDXFs")}function iu(t){var e=0;na(t,"BrtBeginTableStyles",Kl(e,"TableStyleMedium9","PivotStyleMedium4")),na(t,"BrtEndTableStyles")}function ru(){}function su(t,e){var a=aa();return na(a,"BrtBeginStyleSheet"),Yl(a,t.SSF),Jl(a,t),Zl(a,t),Ql(a,t),tu(a,t),eu(a,e.cellXfs),au(a,t),nu(a,t),iu(a,t),ru(a,t),na(a,"BrtEndStyleSheet"),a.end()}function ou(t,e,a){e.themeElements.clrScheme=[];var n={};(t[0].match(Bt)||[]).forEach((function(t){var i=Lt(t);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===i[0].charAt(1)?(e.themeElements.clrScheme.push(n),n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}}))}function lu(){}function uu(){}Hn.THEME="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme";var du=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,cu=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,pu=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function hu(t,e,a){var n;e.themeElements={},[["clrScheme",du,ou],["fontScheme",cu,lu],["fmtScheme",pu,uu]].forEach((function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,a)}))}var gu=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function fu(t,e){if(!t||0===t.length)return fu(mu());var a,n={};if(!(a=t.match(gu)))throw new Error("themeElements not found in theme");return hu(a[0],n,e),n}function mu(t,e){if(e&&e.themeXLSX)return e.themeXLSX;var a=[Nt];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',a[a.length]='<a:font script="Hang" typeface="맑은 고딕"/>',a[a.length]='<a:font script="Hans" typeface="宋体"/>',a[a.length]='<a:font script="Hant" typeface="新細明體"/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',a[a.length]='<a:font script="Hang" typeface="맑은 고딕"/>',a[a.length]='<a:font script="Hans" typeface="宋体"/>',a[a.length]='<a:font script="Hant" typeface="新細明體"/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function vu(t,e,a){var n=t.l+e,i=t._R(4);if(124226!==i)if(a.cellStyles&&vt){var r,s=t.slice(t.l);t.l=n;try{r=new vt(s)}catch(h){return}var o=St(r,"theme/theme/theme1.xml",!0);if(o)return fu(o,a)}else t.l=n}function bu(t){return t._R(4)}function yu(t){var e={};switch(e.xclrType=t._R(2),e.nTintShade=t._R(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=_u(t,4);break;case 2:e.xclrValue=hr(t,4);break;case 3:e.xclrValue=bu(t,4);break;case 4:t.l+=4;break}return t.l+=8,e}function _u(t,e){return Qe(t,e)}function Du(t,e){return Qe(t,e)}function Cu(t){var e=t._R(2),a=t._R(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=yu(t,a);break;case 6:n[1]=Du(t,a);break;case 14:case 15:n[1]=t._R(1===a?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+a)}return n}function wu(t,e){var a=t.l+e;t.l+=2;var n=t._R(2);t.l+=2;var i=t._R(2),r=[];while(i-- >0)r.push(Cu(t,a-t.l));return{ixfe:n,ext:r}}function xu(t,e){e.forEach((function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}}))}function ku(t){var e=[];if(!t)return e;var a=1;return(t.match(Bt)||[]).forEach((function(t){var n=Lt(t);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?a=n.i:n.i=a,e.push(n);break}})),e}function Su(t){var e={};e.i=t._R(4);var a={};a.r=t._R(4),a.c=t._R(4),e.r=_a(a);var n=t._R(1);return 2&n&&(e.l="1"),8&n&&(e.a="1"),e}function Au(t,e,a){var n=[],i=!1;return ea(t,(function(t,e,r){switch(r){case 63:n.push(t);break;default:if((e||"").indexOf("Begin")>0);else if((e||"").indexOf("End")>0);else if(!i||a.WTF)throw new Error("Unexpected record "+r+" "+e)}})),n}function Eu(){}function Tu(t,e,a){if(!t)return t;var n=a||{},i=!1,r=!1;ea(t,(function(t,e,a){if(!r)switch(a){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if((e||"").indexOf("Begin")>0);else if((e||"").indexOf("End")>0);else if(!i||n.WTF)throw new Error("Unexpected record "+a.toString(16)+" "+e)}}),n)}function Iu(t,e){if(!t)return"??";var a=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][a].Target}Hn.IMG="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Hn.DRAW="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing";var Pu=1024;function Nu(t,e){var a=[21600,21600],n=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),i=[pe("xml",null,{"xmlns:v":me.v,"xmlns:o":me.o,"xmlns:x":me.x,"xmlns:mv":me.mv}).replace(/\/>/,">"),pe("o:shapelayout",pe("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),pe("v:shapetype",[pe("v:stroke",null,{joinstyle:"miter"}),pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:n})];while(Pu<1e3*t)Pu+=1e3;return e.forEach((function(t){var e=ya(t[0]);i=i.concat(["<v:shape"+ce({id:"_x0000_s"+ ++Pu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(t[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",pe("v:fill",pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}),{color2:"#BEFF82",angle:"-180",type:"gradient"}),pe("v:shadow",null,{on:"t",obscured:"t"}),pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",de("x:Anchor",[e.c,0,e.r,0,e.c+3,100,e.r+5,100].join(",")),de("x:AutoFill","False"),de("x:Row",String(e.r)),de("x:Column",String(e.c)),t[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),i.push("</xml>"),i.join("")}function Ru(t,e,a,n,i){for(var r=0;r!=e.length;++r){var s=e[r],o=wg(kt(t,s.replace(/^\//,""),!0),s,i);if(o&&o.length)for(var l=Q(a),u=0;u!=l.length;++u){var d=l[u],c=n[d];if(c){var p=c[s];p&&Bu(d,a[d],o)}}}}function Bu(t,e,a){var n,i=Array.isArray(e);a.forEach((function(t){var a=ya(t.ref);if(i?(e[a.r]||(e[a.r]=[]),n=e[a.r][a.c]):n=e[t.ref],!n){n={},i?e[a.r][a.c]=n:e[t.ref]=n;var r=wa(e["!ref"]||"BDWGO1000001:A1");r.s.r>a.r&&(r.s.r=a.r),r.e.r<a.r&&(r.e.r=a.r),r.s.c>a.c&&(r.s.c=a.c),r.e.c<a.c&&(r.e.c=a.c);var s=Ca(r);s!==e["!ref"]&&(e["!ref"]=s)}n.c||(n.c=[]);var o={a:t.author,t:t.t,r:t.r};t.h&&(o.h=t.h),n.c.push(o)}))}function Ou(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach((function(t){if(""!==t&&""!==t.trim()){var e=t.match(/<(?:\w+:)?author[^>]*>(.*)/);e&&a.push(e[1])}}));var r=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return r&&r[1]&&r[1].split(/<\/\w*:?comment>/).forEach((function(t){if(""!==t&&""!==t.trim()){var i=t.match(/<(?:\w+:)?comment[^>]*>/);if(i){var r=Lt(i[0]),s={author:r.authorId&&a[r.authorId]||"sheetjsghost",ref:r.ref,guid:r.guid},o=ya(r.ref);if(!(e.sheetRows&&e.sheetRows<=o.r)){var l=t.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),u=!!l&&!!l[1]&&_o(l[1])||{r:"",t:"",h:""};s.r=u.r,"<t></t>"==u.r&&(u.t=u.h=""),s.t=u.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.cellHTML&&(s.h=u.h),n.push(s)}}}})),n}Hn.CMNT="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments";var Mu=pe("comments",null,{xmlns:fe.main[0]});function Lu(t){var e=[Nt,Mu],a=[];return e.push("<authors>"),t.forEach((function(t){t[1].forEach((function(t){var n=zt(t.a);a.indexOf(n)>-1||(a.push(n),e.push("<author>"+n+"</author>"))}))})),e.push("</authors>"),e.push("<commentList>"),t.forEach((function(t){t[1].forEach((function(n){e.push('<comment ref="'+t[0]+'" authorId="'+a.indexOf(zt(n.a))+'"><text>'),e.push(de("t",null==n.t?"":zt(n.t))),e.push("</text></comment>")}))})),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function Uu(t){var e={};e.iauthor=t._R(4);var a=Ja(t,16);return e.rfx=a.s,e.ref=_a(a.s),t.l+=16,e}function Fu(t,e){return null==e&&(e=ta(36)),e._W(4,t[1].iauthor),Za(t[0],e),e._W(4,0),e._W(4,0),e._W(4,0),e._W(4,0),e}var $u=Ia;function Hu(t){return Pa(t.slice(0,54))}function ju(t,e){var a=[],n=[],i={},r=!1;return ea(t,(function(t,s,o){switch(o){case 632:n.push(t);break;case 635:i=t;break;case 637:i.t=t.t,i.h=t.h,i.r=t.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,a.push(i);break;case 3072:break;case 35:r=!0;break;case 36:r=!1;break;case 37:break;case 38:break;default:if((s||"").indexOf("Begin")>0);else if((s||"").indexOf("End")>0);else if(!r||e.WTF)throw new Error("Unexpected record "+o+" "+s)}})),a}function Wu(t){var e=aa(),a=[];return na(e,"BrtBeginComments"),na(e,"BrtBeginCommentAuthors"),t.forEach((function(t){t[1].forEach((function(t){a.indexOf(t.a)>-1||(a.push(t.a.slice(0,54)),na(e,"BrtCommentAuthor",Hu(t.a)))}))})),na(e,"BrtEndCommentAuthors"),na(e,"BrtBeginCommentList"),t.forEach((function(t){t[1].forEach((function(n){n.iauthor=a.indexOf(n.a);var i={s:ya(t[0]),e:ya(t[0])};na(e,"BrtBeginComment",Fu([i,n])),n.t&&n.t.length>0&&na(e,"BrtCommentText",La(n)),na(e,"BrtEndComment"),delete n.iauthor}))})),na(e,"BrtEndCommentList"),na(e,"BrtEndComments"),e.end()}var zu="application/vnd.ms-office.vbaProject";function Vu(t){var e=X.utils.cfb_new({root:"R"});return t.FullPaths.forEach((function(a,n){if("/"!==a.slice(-1)&&a.match(/_VBA_PROJECT_CUR/)){var i=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");X.utils.cfb_add(e,i,t.FileIndex[n].content)}})),X.write(e)}function qu(t,e){e.FullPaths.forEach((function(a,n){if(0!=n){var i=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&X.utils.cfb_add(t,i,e.FileIndex[n].content)}}))}var Gu=["xlsb","xlsm","xlam","biff8","xla"];function Ku(){return{"!type":"dialog"}}function Xu(){return{"!type":"dialog"}}function Yu(){return{"!type":"macro"}}function Ju(){return{"!type":"macro"}}Hn.DS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",Hn.MS="http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet";var Zu=function(){var t=/(^|[^A-Za-z])R(\[?)(-?\d+|)\]?C(\[?)(-?\d+|)\]?/g,e={r:0,c:0};function a(t,a,n,i,r,s){var o=i.length>0?0|parseInt(i,10):0,l=s.length>0?0|parseInt(s,10):0;l<0&&0===r.length&&(l=0);var u=!1,d=!1;return(r.length>0||0==s.length)&&(u=!0),u?l+=e.c:--l,(n.length>0||0==i.length)&&(d=!0),d?o+=e.r:--o,a+(u?"":"$")+fa(l)+(d?"":"$")+ca(o)}return function(n,i){return e=i,n.replace(t,a)}}(),Qu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)([1-9]\d{0,5}|10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6])(?![_.\(A-Za-z0-9])/g,td=function(){return function(t,e){return t.replace(Qu,(function(t,a,n,i,r,s){var o=ga(i)-(n?0:e.c),l=da(s)-(r?0:e.r),u=0==l?"":r?l+1:"["+l+"]",d=0==o?"":n?o+1:"["+o+"]";return a+"R"+u+"C"+d}))}}();function ed(t,e){return t.replace(Qu,(function(t,a,n,i,r,s){return a+("$"==n?n+i:fa(ga(i)+e.c))+("$"==r?r+s:ca(da(s)+e.r))}))}function ad(t,e,a){var n=Da(e),i=n.s,r=ya(a),s={r:r.r-i.r,c:r.c-i.c};return ed(t,s)}function nd(t){return 1!=t.length}function id(t){return t.replace(/_xlfn\./g,"")}function rd(t){t.l+=1}function sd(t,e){var a=t._R(1==e?1:2);return[16383&a,a>>14&1,a>>15&1]}function od(t,e,a){var n=2;if(a){if(a.biff>=2&&a.biff<=5)return ld(t,e,a);12==a.biff&&(n=4)}var i=t._R(n),r=t._R(n),s=sd(t,2),o=sd(t,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:r,c:o[0],cRel:o[1],rRel:o[2]}}}function ld(t){var e=sd(t,2),a=sd(t,2),n=t._R(1),i=t._R(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:a[0],c:i,cRel:a[1],rRel:a[2]}}}function ud(t,e,a){if(a.biff<8)return ld(t,e,a);var n=t._R(12==a.biff?4:2),i=t._R(12==a.biff?4:2),r=sd(t,2),s=sd(t,2);return{s:{r:n,c:r[0],cRel:r[1],rRel:r[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function dd(t,e,a){if(a&&a.biff>=2&&a.biff<=5)return cd(t,e,a);var n=t._R(a&&12==a.biff?4:2),i=sd(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function cd(t){var e=sd(t,2),a=t._R(1);return{r:e[0],c:a,cRel:e[1],rRel:e[2]}}function pd(t){var e=t._R(2),a=t._R(2);return{r:e,c:255&a,fQuoted:!!(16384&a),cRel:a>>15,rRel:a>>15}}function hd(t,e,a){var n=a&&a.biff?a.biff:8;if(n>=2&&n<=5)return gd(t,e,a);var i=t._R(n>=12?4:2),r=t._R(2),s=(16384&r)>>14,o=(32768&r)>>15;if(r&=16383,1==o)while(i>524287)i-=1048576;if(1==s)while(r>8191)r-=16384;return{r:i,c:r,cRel:s,rRel:o}}function gd(t){var e=t._R(2),a=t._R(1),n=(32768&e)>>15,i=(16384&e)>>14;return e&=16383,1==n&&e>=8192&&(e-=16384),1==i&&a>=128&&(a-=256),{r:e,c:a,cRel:i,rRel:n}}function fd(t,e,a){var n=(96&t[t.l++])>>5,i=od(t,a.biff>=2&&a.biff<=5?6:8,a);return[n,i]}function md(t,e,a){var n=(96&t[t.l++])>>5,i=t._R(2,"i"),r=8;if(a)switch(a.biff){case 5:t.l+=12,r=6;break;case 12:r=12;break}var s=od(t,r,a);return[n,i,s]}function vd(t,e,a){var n=(96&t[t.l++])>>5;return t.l+=a&&a.biff>8?12:a.biff<8?6:8,[n]}function bd(t,e,a){var n=(96&t[t.l++])>>5,i=t._R(2),r=8;if(a)switch(a.biff){case 5:t.l+=12,r=6;break;case 12:r=12;break}return t.l+=r,[n,i]}function yd(t,e,a){var n=(96&t[t.l++])>>5,i=ud(t,e-1,a);return[n,i]}function _d(t,e,a){var n=(96&t[t.l++])>>5;return t.l+=2==a.biff?6:12==a.biff?14:7,[n]}function Dd(t){var e=1&t[t.l+1],a=1;return t.l+=4,[e,a]}function Cd(t,e,a){t.l+=2;for(var n=t._R(a&&2==a.biff?1:2),i=[],r=0;r<=n;++r)i.push(t._R(a&&2==a.biff?1:2));return i}function wd(t,e,a){var n=255&t[t.l+1]?1:0;return t.l+=2,[n,t._R(a&&2==a.biff?1:2)]}function xd(t,e,a){var n=255&t[t.l+1]?1:0;return t.l+=2,[n,t._R(a&&2==a.biff?1:2)]}function kd(t){var e=255&t[t.l+1]?1:0;return t.l+=2,[e,t._R(2)]}function Sd(t,e,a){var n=255&t[t.l+1]?1:0;return t.l+=a&&2==a.biff?3:4,[n]}function Ad(t){var e=t._R(1),a=t._R(1);return[e,a]}function Ed(t){return t._R(2),Ad(t,2)}function Td(t){return t._R(2),Ad(t,2)}function Id(t,e,a){var n=(96&t[t.l])>>5;t.l+=1;var i=dd(t,0,a);return[n,i]}function Pd(t,e,a){var n=(96&t[t.l])>>5;t.l+=1;var i=hd(t,0,a);return[n,i]}function Nd(t,e,a){var n=(96&t[t.l])>>5;t.l+=1;var i=t._R(2);a&&5==a.biff&&(t.l+=12);var r=dd(t,0,a);return[n,i,r]}function Rd(t,e,a){var n=(96&t[t.l])>>5;t.l+=1;var i=t._R(a&&a.biff<=3?1:2);return[Gc[i],qc[i],n]}function Bd(t,e,a){var n=t[t.l++],i=t._R(1),r=a&&a.biff<=3?[88==n?-1:0,t._R(1)]:Od(t);return[i,(0===r[0]?qc:Vc)[r[1]]]}function Od(t){return[t[t.l+1]>>7,32767&t._R(2)]}function Md(t,e,a){t.l+=a&&2==a.biff?3:4}function Ld(t,e,a){if(t.l++,a&&12==a.biff)return[t._R(4,"i"),0];var n=t._R(2),i=t._R(a&&2==a.biff?1:2);return[n,i]}function Ud(t){return t.l++,en[t._R(1)]}function Fd(t){return t.l++,t._R(2)}function $d(t){return t.l++,0!==t._R(1)}function Hd(t){return t.l++,Qa(t,8)}function jd(t,e,a){return t.l++,tr(t,e-1,a)}function Wd(t,e){var a=[t._R(1)];if(12==e)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=Gi(t,1)?"TRUE":"FALSE",12!=e&&(t.l+=7);break;case 37:case 16:a[1]=en[t[t.l]],t.l+=12==e?4:8;break;case 0:t.l+=8;break;case 1:a[1]=Qa(t,8);break;case 2:a[1]=ir(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function zd(t,e,a){for(var n=t._R(12==a.biff?4:2),i=[],r=0;r!=n;++r)i.push((12==a.biff?Ja:Cr)(t,8));return i}function Vd(t,e,a){var n=0,i=0;12==a.biff?(n=t._R(4),i=t._R(4)):(i=1+t._R(1),n=1+t._R(2)),a.biff>=2&&a.biff<8&&(--n,0==--i&&(i=256));for(var r=0,s=[];r!=n&&(s[r]=[]);++r)for(var o=0;o!=i;++o)s[r][o]=Wd(t,a.biff);return s}function qd(t,e,a){var n=t._R(1)>>>5&3,i=!a||a.biff>=8?4:2,r=t._R(i);switch(a.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,r]}function Gd(t,e,a){if(5==a.biff)return Kd(t,e,a);var n=t._R(1)>>>5&3,i=t._R(2),r=t._R(4);return[n,i,r]}function Kd(t){var e=t._R(1)>>>5&3,a=t._R(2,"i");t.l+=8;var n=t._R(2);return t.l+=12,[e,a,n]}function Xd(t,e,a){var n=t._R(1)>>>5&3;t.l+=a&&2==a.biff?3:4;var i=t._R(a&&2==a.biff?1:2);return[n,i]}function Yd(t,e,a){var n=t._R(1)>>>5&3,i=t._R(a&&2==a.biff?1:2);return[n,i]}function Jd(t,e,a){var n=t._R(1)>>>5&3;return t.l+=4,a.biff<8&&t.l--,12==a.biff&&(t.l+=2),[n]}function Zd(t,e,a){var n=(96&t[t.l++])>>5,i=t._R(2),r=4;if(a)switch(a.biff){case 5:r=15;break;case 12:r=6;break}return t.l+=r,[n,i]}var Qd=Qe,tc=Qe,ec=Qe;function ac(t,e,a){return t.l+=2,[pd(t,4,a)]}function nc(t){return t.l+=6,[]}var ic=ac,rc=nc,sc=nc,oc=ac;function lc(t){return t.l+=2,[Xi(t),1&t._R(2)]}var uc=ac,dc=lc,cc=nc,pc=ac,hc=ac,gc=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fc(t){t.l+=2;var e=t._R(2),a=t._R(2),n=t._R(4),i=t._R(2),r=t._R(2),s=gc[a>>2&31];return{ixti:e,coltype:3&a,rt:s,idx:n,c:i,C:r}}function mc(t){return t.l+=2,[t._R(4)]}function vc(t,e,a){return t.l+=5,t.l+=2,t.l+=2==a.biff?1:4,["PTGSHEET"]}function bc(t,e,a){return t.l+=2==a.biff?4:5,["PTGENDSHEET"]}function yc(t){var e=t._R(1)>>>5&3,a=t._R(2);return[e,a]}function _c(t){var e=t._R(1)>>>5&3,a=t._R(2);return[e,a]}function Dc(t){return t.l+=4,[0,0]}var Cc={1:{n:"PtgExp",f:Ld},2:{n:"PtgTbl",f:ec},3:{n:"PtgAdd",f:rd},4:{n:"PtgSub",f:rd},5:{n:"PtgMul",f:rd},6:{n:"PtgDiv",f:rd},7:{n:"PtgPower",f:rd},8:{n:"PtgConcat",f:rd},9:{n:"PtgLt",f:rd},10:{n:"PtgLe",f:rd},11:{n:"PtgEq",f:rd},12:{n:"PtgGe",f:rd},13:{n:"PtgGt",f:rd},14:{n:"PtgNe",f:rd},15:{n:"PtgIsect",f:rd},16:{n:"PtgUnion",f:rd},17:{n:"PtgRange",f:rd},18:{n:"PtgUplus",f:rd},19:{n:"PtgUminus",f:rd},20:{n:"PtgPercent",f:rd},21:{n:"PtgParen",f:rd},22:{n:"PtgMissArg",f:rd},23:{n:"PtgStr",f:jd},26:{n:"PtgSheet",f:vc},27:{n:"PtgEndSheet",f:bc},28:{n:"PtgErr",f:Ud},29:{n:"PtgBool",f:$d},30:{n:"PtgInt",f:Fd},31:{n:"PtgNum",f:Hd},32:{n:"PtgArray",f:_d},33:{n:"PtgFunc",f:Rd},34:{n:"PtgFuncVar",f:Bd},35:{n:"PtgName",f:qd},36:{n:"PtgRef",f:Id},37:{n:"PtgArea",f:fd},38:{n:"PtgMemArea",f:Xd},39:{n:"PtgMemErr",f:Qd},40:{n:"PtgMemNoMem",f:tc},41:{n:"PtgMemFunc",f:Yd},42:{n:"PtgRefErr",f:Jd},43:{n:"PtgAreaErr",f:vd},44:{n:"PtgRefN",f:Pd},45:{n:"PtgAreaN",f:yd},46:{n:"PtgMemAreaN",f:yc},47:{n:"PtgMemNoMemN",f:_c},57:{n:"PtgNameX",f:Gd},58:{n:"PtgRef3d",f:Nd},59:{n:"PtgArea3d",f:md},60:{n:"PtgRefErr3d",f:Zd},61:{n:"PtgAreaErr3d",f:bd},255:{}},wc={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61};(function(){for(var t in wc)Cc[t]=Cc[wc[t]]})();var xc={1:{n:"PtgElfLel",f:lc},2:{n:"PtgElfRw",f:pc},3:{n:"PtgElfCol",f:ic},6:{n:"PtgElfRwV",f:hc},7:{n:"PtgElfColV",f:oc},10:{n:"PtgElfRadical",f:uc},11:{n:"PtgElfRadicalS",f:cc},13:{n:"PtgElfColS",f:rc},15:{n:"PtgElfColSV",f:sc},16:{n:"PtgElfRadicalLel",f:dc},25:{n:"PtgList",f:fc},29:{n:"PtgSxName",f:mc},255:{}},kc={0:{n:"PtgAttrNoop",f:Dc},1:{n:"PtgAttrSemi",f:Sd},2:{n:"PtgAttrIf",f:xd},4:{n:"PtgAttrChoose",f:Cd},8:{n:"PtgAttrGoto",f:wd},16:{n:"PtgAttrSum",f:Md},32:{n:"PtgAttrBaxcel",f:Dd},64:{n:"PtgAttrSpace",f:Ed},65:{n:"PtgAttrSpaceSemi",f:Td},128:{n:"PtgAttrIfError",f:kd},255:{}};function Sc(t,e,a,n){if(n.biff<8)return Qe(t,e);for(var i=t.l+e,r=[],s=0;s!==a.length;++s)switch(a[s][0]){case"PtgArray":a[s][1]=Vd(t,0,n),r.push(a[s][1]);break;case"PtgMemArea":a[s][2]=zd(t,a[s][1],n),r.push(a[s][2]);break;case"PtgExp":n&&12==n.biff&&(a[s][1][1]=t._R(4),r.push(a[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[s][0];default:break}return e=i-t.l,0!==e&&r.push(Qe(t,e)),r}function Ac(t,e,a){var n,i,r=t.l+e,s=[];while(r!=t.l)e=r-t.l,i=t[t.l],n=Cc[i],24!==i&&25!==i||(n=(24===i?xc:kc)[t[t.l+1]]),n&&n.f?s.push([n.n,n.f(t,e,a)]):Qe(t,e);return s}function Ec(t){for(var e=[],a=0;a<t.length;++a){for(var n=t[a],i=[],r=0;r<n.length;++r){var s=n[r];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}kc[33]=kc[32];var Tc={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ic(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return t.indexOf(" ")>-1?"'"+t+"'":t}function Pc(t,e,a){if(!t)return"SH33TJSERR0";if(a.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(a.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),0==e?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(a.biff>8)switch(t[n[0]][0]){case 357:return i=-1==n[1]?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return null!=a.SID?t.SheetNames[a.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=-1==n[1]?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map((function(t){return t.Name})).join(";;");default:return t[n[0]][0][3]?(i=-1==n[1]?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Nc(t,e,a){return Ic(Pc(t,e,a),a)}function Rc(t,e,a,n,i){var r,s,o,l,u=i&&i.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},c=[],p=0,h=0,g="";if(!t[0]||!t[0][0])return"";for(var f=-1,m="",v=0,b=t[0].length;v<b;++v){var y=t[0][v];switch(y[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(r=c.pop(),s=c.pop(),f>=0){switch(t[0][f][1][0]){case 0:m=gt(" ",t[0][f][1][1]);break;case 1:m=gt("\r",t[0][f][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][f][1][0])}s+=m,f=-1}c.push(s+Tc[y[0]]+r);break;case"PtgIsect":r=c.pop(),s=c.pop(),c.push(s+" "+r);break;case"PtgUnion":r=c.pop(),s=c.pop(),c.push(s+","+r);break;case"PtgRange":r=c.pop(),s=c.pop(),c.push(s+":"+r);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":o=ia(y[1][1],d,i),c.push(sa(o,u));break;case"PtgRefN":o=a?ia(y[1][1],a,i):y[1][1],c.push(sa(o,u));break;case"PtgRef3d":p=y[1][1],o=ia(y[1][2],d,i),g=Nc(n,p,i);c.push(g+"!"+sa(o,u));break;case"PtgFunc":case"PtgFuncVar":var _=y[1][0],D=y[1][1];_||(_=0),_&=127;var C=0==_?[]:c.slice(-_);c.length-=_,"User"===D&&(D=C.shift()),c.push(D+"("+C.join(",")+")");break;case"PtgBool":c.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(y[1]);break;case"PtgNum":c.push(String(y[1]));break;case"PtgStr":c.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(y[1]);break;case"PtgAreaN":l=ra(y[1][1],a?{s:a}:d,i),c.push(oa(l,i));break;case"PtgArea":l=ra(y[1][1],d,i),c.push(oa(l,i));break;case"PtgArea3d":p=y[1][1],l=y[1][2],g=Nc(n,p,i),c.push(g+"!"+oa(l,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var w=(n.names||[])[h-1]||(n[0]||[])[h],x=w?w.Name:"SH33TJSNAME"+String(h);x in Kc&&(x=Kc[x]),c.push(x);break;case"PtgNameX":var k,S=y[1][1];if(h=y[1][2],!(i.biff<=5)){var A="";if(14849==((n[S]||[])[0]||[])[0]||(1025==((n[S]||[])[0]||[])[0]?n[S][h]&&n[S][h].itab>0&&(A=n.SheetNames[n[S][h].itab-1]+"!"):A=n.SheetNames[h-1]+"!"),n[S]&&n[S][h])A+=n[S][h].Name;else if(n[0]&&n[0][h])A+=n[0][h].Name;else{var E=Pc(n,S,i).split(";;");E[h-1]?A=E[h-1]:A+="SH33TJSERRX"}c.push(A);break}S<0&&(S=-S),n[S]&&(k=n[S][h]),k||(k={Name:"SH33TJSERRY"}),c.push(k.Name);break;case"PtgParen":var T="(",I=")";if(f>=0){switch(m="",t[0][f][1][0]){case 2:T=gt(" ",t[0][f][1][1])+T;break;case 3:T=gt("\r",t[0][f][1][1])+T;break;case 4:I=gt(" ",t[0][f][1][1])+I;break;case 5:I=gt("\r",t[0][f][1][1])+I;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][f][1][0])}f=-1}c.push(T+c.pop()+I);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":o={c:y[1][1],r:y[1][0]};var P={c:a.c,r:a.r};if(n.sharedf[_a(o)]){var N=n.sharedf[_a(o)];c.push(Rc(N,d,P,n,i))}else{var R=!1;for(r=0;r!=n.arrayf.length;++r)if(s=n.arrayf[r],!(o.c<s[0].s.c||o.c>s[0].e.c)&&!(o.r<s[0].s.r||o.r>s[0].e.r)){c.push(Rc(s[1],d,P,n,i)),R=!0;break}R||c.push(y[1])}break;case"PtgArray":c.push("{"+Ec(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var B=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(3!=i.biff&&f>=0&&-1==B.indexOf(t[0][v][0])){y=t[0][f];var O=!0;switch(y[1][0]){case 4:O=!1;case 0:m=gt(" ",y[1][1]);break;case 5:O=!1;case 1:m=gt("\r",y[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}c.push((O?m:"")+c.pop()+(O?"":m)),f=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function Bc(t,e,a){var n,i=t.l+e,r=2==a.biff?1:2,s=t._R(r);if(65535==s)return[[],Qe(t,e-2)];var o=Ac(t,s,a);return e!==s+r&&(n=Sc(t,e-s-r,o,a)),t.l=i,[o,n]}function Oc(t,e,a){var n,i=t.l+e,r=2==a.biff?1:2,s=t._R(r);if(65535==s)return[[],Qe(t,e-2)];var o=Ac(t,s,a);return e!==s+r&&(n=Sc(t,e-s-r,o,a)),t.l=i,[o,n]}function Mc(t,e,a,n){var i,r=t.l+e,s=Ac(t,n,a);return r!==t.l&&(i=Sc(t,r-t.l,s,a)),[s,i]}function Lc(t,e,a){var n,i=t.l+e,r=t._R(2),s=Ac(t,r,a);return 65535==r?[[],Qe(t,e-2)]:(e!==r+2&&(n=Sc(t,i-r-2,s,a)),[s,n])}function Uc(t){var e;if(65535!==He(t,t.l+6))return[Qa(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=1===t[t.l+2],t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Fc(t,e,a){var n=t.l+e,i=fr(t,6);2==a.biff&&++t.l;var r=Uc(t,8),s=t._R(1);2!=a.biff&&(t._R(1),a.biff>=5&&t._R(4));var o=Oc(t,n-t.l,a);return{cell:i,val:r[0],formula:o,shared:s>>3&1,tt:r[1]}}function $c(t,e,a){var n=t._R(4),i=Ac(t,n,a),r=t._R(4),s=r>0?Sc(t,r,i,a):null;return[i,s]}var Hc=$c,jc=$c,Wc=$c,zc=$c,Vc={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},qc={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Gc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0},Kc={"_xlfn.ACOT":"ACOT","_xlfn.ACOTH":"ACOTH","_xlfn.AGGREGATE":"AGGREGATE","_xlfn.ARABIC":"ARABIC","_xlfn.AVERAGEIF":"AVERAGEIF","_xlfn.AVERAGEIFS":"AVERAGEIFS","_xlfn.BASE":"BASE","_xlfn.BETA.DIST":"BETA.DIST","_xlfn.BETA.INV":"BETA.INV","_xlfn.BINOM.DIST":"BINOM.DIST","_xlfn.BINOM.DIST.RANGE":"BINOM.DIST.RANGE","_xlfn.BINOM.INV":"BINOM.INV","_xlfn.BITAND":"BITAND","_xlfn.BITLSHIFT":"BITLSHIFT","_xlfn.BITOR":"BITOR","_xlfn.BITRSHIFT":"BITRSHIFT","_xlfn.BITXOR":"BITXOR","_xlfn.CEILING.MATH":"CEILING.MATH","_xlfn.CEILING.PRECISE":"CEILING.PRECISE","_xlfn.CHISQ.DIST":"CHISQ.DIST","_xlfn.CHISQ.DIST.RT":"CHISQ.DIST.RT","_xlfn.CHISQ.INV":"CHISQ.INV","_xlfn.CHISQ.INV.RT":"CHISQ.INV.RT","_xlfn.CHISQ.TEST":"CHISQ.TEST","_xlfn.COMBINA":"COMBINA","_xlfn.CONCAT":"CONCAT","_xlfn.CONFIDENCE.NORM":"CONFIDENCE.NORM","_xlfn.CONFIDENCE.T":"CONFIDENCE.T","_xlfn.COT":"COT","_xlfn.COTH":"COTH","_xlfn.COUNTIFS":"COUNTIFS","_xlfn.COVARIANCE.P":"COVARIANCE.P","_xlfn.COVARIANCE.S":"COVARIANCE.S","_xlfn.CSC":"CSC","_xlfn.CSCH":"CSCH","_xlfn.DAYS":"DAYS","_xlfn.DECIMAL":"DECIMAL","_xlfn.ECMA.CEILING":"ECMA.CEILING","_xlfn.ERF.PRECISE":"ERF.PRECISE","_xlfn.ERFC.PRECISE":"ERFC.PRECISE","_xlfn.EXPON.DIST":"EXPON.DIST","_xlfn.F.DIST":"F.DIST","_xlfn.F.DIST.RT":"F.DIST.RT","_xlfn.F.INV":"F.INV","_xlfn.F.INV.RT":"F.INV.RT","_xlfn.F.TEST":"F.TEST","_xlfn.FILTERXML":"FILTERXML","_xlfn.FLOOR.MATH":"FLOOR.MATH","_xlfn.FLOOR.PRECISE":"FLOOR.PRECISE","_xlfn.FORECAST.ETS":"FORECAST.ETS","_xlfn.FORECAST.ETS.CONFINT":"FORECAST.ETS.CONFINT","_xlfn.FORECAST.ETS.SEASONALITY":"FORECAST.ETS.SEASONALITY","_xlfn.FORECAST.ETS.STAT":"FORECAST.ETS.STAT","_xlfn.FORECAST.LINEAR":"FORECAST.LINEAR","_xlfn.FORMULATEXT":"FORMULATEXT","_xlfn.GAMMA":"GAMMA","_xlfn.GAMMA.DIST":"GAMMA.DIST","_xlfn.GAMMA.INV":"GAMMA.INV","_xlfn.GAMMALN.PRECISE":"GAMMALN.PRECISE","_xlfn.GAUSS":"GAUSS","_xlfn.HYPGEOM.DIST":"HYPGEOM.DIST","_xlfn.IFERROR":"IFERROR","_xlfn.IFNA":"IFNA","_xlfn.IFS":"IFS","_xlfn.IMCOSH":"IMCOSH","_xlfn.IMCOT":"IMCOT","_xlfn.IMCSC":"IMCSC","_xlfn.IMCSCH":"IMCSCH","_xlfn.IMSEC":"IMSEC","_xlfn.IMSECH":"IMSECH","_xlfn.IMSINH":"IMSINH","_xlfn.IMTAN":"IMTAN","_xlfn.ISFORMULA":"ISFORMULA","_xlfn.ISO.CEILING":"ISO.CEILING","_xlfn.ISOWEEKNUM":"ISOWEEKNUM","_xlfn.LOGNORM.DIST":"LOGNORM.DIST","_xlfn.LOGNORM.INV":"LOGNORM.INV","_xlfn.MAXIFS":"MAXIFS","_xlfn.MINIFS":"MINIFS","_xlfn.MODE.MULT":"MODE.MULT","_xlfn.MODE.SNGL":"MODE.SNGL","_xlfn.MUNIT":"MUNIT","_xlfn.NEGBINOM.DIST":"NEGBINOM.DIST","_xlfn.NETWORKDAYS.INTL":"NETWORKDAYS.INTL","_xlfn.NIGBINOM":"NIGBINOM","_xlfn.NORM.DIST":"NORM.DIST","_xlfn.NORM.INV":"NORM.INV","_xlfn.NORM.S.DIST":"NORM.S.DIST","_xlfn.NORM.S.INV":"NORM.S.INV","_xlfn.NUMBERVALUE":"NUMBERVALUE","_xlfn.PDURATION":"PDURATION","_xlfn.PERCENTILE.EXC":"PERCENTILE.EXC","_xlfn.PERCENTILE.INC":"PERCENTILE.INC","_xlfn.PERCENTRANK.EXC":"PERCENTRANK.EXC","_xlfn.PERCENTRANK.INC":"PERCENTRANK.INC","_xlfn.PERMUTATIONA":"PERMUTATIONA","_xlfn.PHI":"PHI","_xlfn.POISSON.DIST":"POISSON.DIST","_xlfn.QUARTILE.EXC":"QUARTILE.EXC","_xlfn.QUARTILE.INC":"QUARTILE.INC","_xlfn.QUERYSTRING":"QUERYSTRING","_xlfn.RANK.AVG":"RANK.AVG","_xlfn.RANK.EQ":"RANK.EQ","_xlfn.RRI":"RRI","_xlfn.SEC":"SEC","_xlfn.SECH":"SECH","_xlfn.SHEET":"SHEET","_xlfn.SHEETS":"SHEETS","_xlfn.SKEW.P":"SKEW.P","_xlfn.STDEV.P":"STDEV.P","_xlfn.STDEV.S":"STDEV.S","_xlfn.SUMIFS":"SUMIFS","_xlfn.SWITCH":"SWITCH","_xlfn.T.DIST":"T.DIST","_xlfn.T.DIST.2T":"T.DIST.2T","_xlfn.T.DIST.RT":"T.DIST.RT","_xlfn.T.INV":"T.INV","_xlfn.T.INV.2T":"T.INV.2T","_xlfn.T.TEST":"T.TEST","_xlfn.TEXTJOIN":"TEXTJOIN","_xlfn.UNICHAR":"UNICHAR","_xlfn.UNICODE":"UNICODE","_xlfn.VAR.P":"VAR.P","_xlfn.VAR.S":"VAR.S","_xlfn.WEBSERVICE":"WEBSERVICE","_xlfn.WEIBULL.DIST":"WEIBULL.DIST","_xlfn.WORKDAY.INTL":"WORKDAY.INTL","_xlfn.XOR":"XOR","_xlfn.Z.TEST":"Z.TEST"};function Xc(t){return"of:"==t.slice(0,3)&&(t=t.slice(3)),61==t.charCodeAt(0)&&(t=t.slice(1),61==t.charCodeAt(0)&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(t,e){return e.replace(/\./g,"")})),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Yc(t){var e="of:="+t.replace(Qu,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Jc(t){var e=t.split(":"),a=e[0].split(".")[0];return[a,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function Zc(t){return t.replace(/\./,"!")}var Qc={},tp={};Hn.WS=["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"];var ep="undefined"!==typeof Map;function ap(t,e,a){var n=0,i=t.length;if(a){if(ep?a.has(e):a.hasOwnProperty(e))for(var r=ep?a.get(e):a[e];n<r.length;++n)if(t[r[n]].t===e)return t.Count++,r[n]}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,a&&(ep?(a.has(e)||a.set(e,[]),a.get(e).push(i)):(a.hasOwnProperty(e)||(a[e]=[]),a[e].push(i))),i}function np(t,e){var a={min:t+1,max:t+1},n=-1;return e.MDW&&(dl=e.MDW),null!=e.width?a.customWidth=1:null!=e.wpx?n=pl(e.wpx):null!=e.wch&&(n=e.wch),n>-1?(a.width=hl(n),a.customWidth=1):null!=e.width&&(a.width=e.width),e.hidden&&(a.hidden=!0),a}function ip(t,e){if(t){var a=[.7,.7,.75,.75,.3,.3];"xlml"==e&&(a=[1,1,1,1,.5,.5]),null==t.left&&(t.left=a[0]),null==t.right&&(t.right=a[1]),null==t.top&&(t.top=a[2]),null==t.bottom&&(t.bottom=a[3]),null==t.header&&(t.header=a[4]),null==t.footer&&(t.footer=a[5])}}function rp(t,e,a){var n=a.revssf[null!=e.z?e.z:"General"],i=60,r=t.length;if(null==n&&a.ssf)for(;i<392;++i)if(null==a.ssf[i]){U.load(e.z,i),a.ssf[i]=e.z,a.revssf[e.z]=n=i;break}for(i=0;i!=r;++i)if(t[i].numFmtId===n)return i;return t[r]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},r}function sp(t,e,a,n,i,r){if("z"!==t.t){"d"===t.t&&"string"===typeof t.v&&(t.v=ct(t.v));try{n.cellNF&&(t.z=U._table[e])}catch(p){if(n.WTF)throw p}if(!n||!1!==n.cellText)try{if(null==U._table[e]&&U.load(j[e]||"General",e),"e"===t.t)t.w=t.w||en[t.v];else if(0===e)if("n"===t.t)(0|t.v)===t.v?t.w=U._general_int(t.v):t.w=U._general_num(t.v);else if("d"===t.t){var s=st(t.v);t.w=(0|s)===s?U._general_int(s):U._general_num(s)}else{if(void 0===t.v)return"";t.w=U._general(t.v,tp)}else"d"===t.t?t.w=U.format(e,st(t.v),tp):t.w=U.format(e,t.v,tp)}catch(p){if(n.WTF)throw p}if(n.cellStyles&&null!=a)try{t.s=r.Fills[a],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=sl(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=sl(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(p){if(n.WTF&&r.Fills)throw p}}}function op(t,e,a){if(t&&t["!ref"]){var n=wa(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+a+"): "+t["!ref"])}}function lp(t,e){var a=wa(e);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(t["!ref"]=Ca(a))}var up=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,dp=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,cp=/<(?:\w:)?hyperlink [^>]*>/gm,pp=/"(\w*:\w*)"/,hp=/<(?:\w:)?col\b[^>]*[\/]?>/g,gp=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,fp=/<(?:\w:)?pageMargins[^>]*\/>/g,mp=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,vp=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function bp(t,e,a,n,i,r,s){if(!t)return t;null!=C&&null==e.dense&&(e.dense=C);var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",c=t.match(dp);c?(u=t.slice(0,c.index),d=t.slice(c.index+c[0].length)):u=d=t;var p=u.match(mp);p&&_p(p[0],o,i,a);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var g=u.slice(h,h+50).match(pp);g&&lp(o,g[1])}var f=u.match(vp);f&&f[1]&&Ip(f[1],i);var m=[];if(e.cellStyles){var v=u.match(hp);v&&kp(m,v)}c&&Rp(c[1],o,e,l,r,s);var b=d.match(gp);b&&(o["!autofilter"]=Ap(b[0]));var y=[],_=d.match(up);if(_)for(h=0;h!=_.length;++h)y[h]=wa(_[h].slice(_[h].indexOf('"')+1));var D=d.match(cp);D&&Cp(o,D,n);var w=d.match(fp);if(w&&(o["!margins"]=wp(Lt(w[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ca(l)),e.sheetRows>0&&o["!ref"]){var x=wa(o["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>l.e.r&&(x.e.r=l.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>l.e.c&&(x.e.c=l.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ca(x))}return m.length>0&&(o["!cols"]=m),y.length>0&&(o["!merges"]=y),o}function yp(t){if(0===t.length)return"";for(var e='<mergeCells count="'+t.length+'">',a=0;a!=t.length;++a)e+='<mergeCell ref="'+Ca(t[a])+'"/>';return e+"</mergeCells>"}function _p(t,e,a,n){var i=Lt(t);a.Sheets[n]||(a.Sheets[n]={}),i.codeName&&(a.Sheets[n].CodeName=i.codeName)}function Dp(t){var e={sheet:1},a=["objects","scenarios","selectLockedCells","selectUnlockedCells"],n=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];return a.forEach((function(a){null!=t[a]&&t[a]&&(e[a]="1")})),n.forEach((function(a){null==t[a]||t[a]||(e[a]="0")})),t.password&&(e.password=Ko(t.password).toString(16).toUpperCase()),pe("sheetProtection",null,e)}function Cp(t,e,a){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var r=Lt(Zt(e[i]),!0);if(!r.ref)return;var s=((a||{})["!id"]||[])[r.id];s?(r.Target=s.Target,r.location&&(r.Target+="#"+r.location)):(r.Target="#"+r.location,s={Target:r.Target,TargetMode:"Internal"}),r.Rel=s,r.tooltip&&(r.Tooltip=r.tooltip,delete r.tooltip);for(var o=wa(r.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var d=_a({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=r):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=r)}}}function wp(t){var e={};return["left","right","top","bottom","header","footer"].forEach((function(a){t[a]&&(e[a]=parseFloat(t[a]))})),e}function xp(t){return ip(t),pe("pageMargins",null,t)}function kp(t,e){for(var a=!1,n=0;n!=e.length;++n){var i=Lt(e[n],!0);i.hidden&&(i.hidden=Jt(i.hidden));var r=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;delete i.min,delete i.max,i.width=+i.width,!a&&i.width&&(a=!0,fl(i.width)),ml(i);while(r<=s)t[r++]=ht(i)}}function Sp(t,e){for(var a,n=["<cols>"],i=0;i!=e.length;++i)(a=e[i])&&(n[n.length]=pe("col",null,np(i,a)));return n[n.length]="</cols>",n.join("")}function Ap(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Ep(t,e,a,n){var i="string"==typeof t.ref?t.ref:Ca(t.ref);a.Workbook||(a.Workbook={}),a.Workbook.Names||(a.Workbook.Names=[]);var r=a.Workbook.Names,s=Da(i);s.s.r==s.e.r&&(s.e.r=Da(e["!ref"]).e.r,i=Ca(s));for(var o=0;o<r.length;++o){var l=r[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref="'"+a.SheetNames[n]+"'!"+i;break}}return o==r.length&&r.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+a.SheetNames[n]+"'!"+i}),pe("autoFilter",null,{ref:i})}var Tp=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/>/;function Ip(t,e){(t.match(Tp)||[]).forEach((function(t){var a=Lt(t);Jt(a.rightToLeft)&&(e.Views||(e.Views=[{}]),e.Views[0]||(e.Views[0]={}),e.Views[0].RTL=!0)}))}function Pp(t,e,a,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),pe("sheetViews",pe("sheetView",null,i),{})}function Np(t,e,a,n){if(void 0===t.v&&void 0===t.f||"z"===t.t)return"";var i="",r=t.t,s=t.v;switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=en[t.v];break;case"d":n.cellDates?i=ct(t.v,-1).toISOString():(t=ht(t),t.t="n",i=""+(t.v=st(ct(t.v)))),"undefined"===typeof t.z&&(t.z=U._table[14]);break;default:i=t.v;break}var o=de("v",zt(i)),l={r:e},u=rp(n.cellXfs,t,n);switch(0!==u&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==t.v){delete t.t;break}if(n.bookSST){o=de("v",""+ap(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=r&&(t.t=r,t.v=s),t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=pe("f",zt(t.f),d)+(null!=t.v?o:"")}return t.l&&a["!links"].push([e,t.l]),t.c&&a["!comments"].push([e,t.c]),pe("c",o,l)}var Rp=function(){var t=/<(?:\w+:)?c[ >]/,e=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,r=ne("v"),s=ne("f");return function(o,l,u,d,c,p){for(var h,g,f,m,v,b=0,y="",_=[],D=[],C=0,w=0,x=0,k="",S=0,A=0,E=0,T=0,I=Array.isArray(p.CellXf),P=[],N=[],R=Array.isArray(l),B=[],O={},M=!1,L=o.split(e),F=0,$=L.length;F!=$;++F){y=L[F].trim();var H=y.length;if(0!==H){for(b=0;b<H;++b)if(62===y.charCodeAt(b))break;if(++b,g=Lt(y.slice(0,b),!0),S=null!=g.r?parseInt(g.r,10):S+1,A=-1,!(u.sheetRows&&u.sheetRows<S))for(d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),u&&u.cellStyles&&(O={},M=!1,g.ht&&(M=!0,O.hpt=parseFloat(g.ht),O.hpx=_l(O.hpt)),"1"==g.hidden&&(M=!0,O.hidden=!0),null!=g.outlineLevel&&(M=!0,O.level=+g.outlineLevel),M&&(B[S-1]=O)),_=y.slice(b).split(t),b=0;b!=_.length;++b)if(y=_[b].trim(),0!==y.length){if(D=y.match(a),C=b,w=0,x=0,y="<c "+("<"==y.slice(0,1)?">":"")+y,null!=D&&2===D.length){for(C=0,k=D[1],w=0;w!=k.length;++w){if((x=k.charCodeAt(w)-64)<1||x>26)break;C=26*C+x}--C,A=C}else++A;for(w=0;w!=y.length;++w)if(62===y.charCodeAt(w))break;if(++w,g=Lt(y.slice(0,w),!0),g.r||(g.r=_a({r:S-1,c:A})),k=y.slice(w),h={t:""},null!=(D=k.match(r))&&""!==D[1]&&(h.v=Ht(D[1])),u.cellFormula){null!=(D=k.match(s))&&""!==D[1]?(h.f=id(Ht(Zt(D[1]))),D[0].indexOf('t="array"')>-1?(h.F=(k.match(i)||[])[1],h.F.indexOf(":")>-1&&P.push([wa(h.F),h.F])):D[0].indexOf('t="shared"')>-1&&(m=Lt(D[0]),N[parseInt(m.si,10)]=[m,id(Ht(Zt(D[1]))),g.r])):(D=k.match(/<f[^>]*\/>/))&&(m=Lt(D[0]),N[m.si]&&(h.f=ad(N[m.si][1],N[m.si][2],g.r)));var j=ya(g.r);for(w=0;w<P.length;++w)j.r>=P[w][0].s.r&&j.r<=P[w][0].e.r&&j.c>=P[w][0].s.c&&j.c<=P[w][0].e.c&&(h.F=P[w][1])}if(null==g.t&&void 0===h.v)if(h.f||h.F)h.v=0,h.t="n";else{if(!u.sheetStubs)continue;h.t="z"}else h.t=g.t||"n";switch(d.s.c>A&&(d.s.c=A),d.e.c<A&&(d.e.c=A),h.t){case"n":if(""==h.v||null==h.v){if(!u.sheetStubs)continue;h.t="z"}else h.v=parseFloat(h.v);break;case"s":if("undefined"==typeof h.v){if(!u.sheetStubs)continue;h.t="z"}else f=Qc[parseInt(h.v,10)],h.v=f.t,h.r=f.r,u.cellHTML&&(h.h=f.h);break;case"str":h.t="s",h.v=null!=h.v?Zt(h.v):"",u.cellHTML&&(h.h=Gt(h.v));break;case"inlineStr":D=k.match(n),h.t="s",null!=D&&(f=_o(D[1]))?h.v=f.t:h.v="";break;case"b":h.v=Jt(h.v);break;case"d":u.cellDates?h.v=ct(h.v,1):(h.v=st(ct(h.v,1)),h.t="n");break;case"e":u&&!1===u.cellText||(h.w=h.v),h.v=an[h.v];break}if(E=T=0,I&&void 0!==g.s&&(v=p.CellXf[g.s],null!=v&&(null!=v.numFmtId&&(E=v.numFmtId),u.cellStyles&&null!=v.fillId&&(T=v.fillId))),sp(h,E,T,u,c,p),u.cellDates&&I&&"n"==h.t&&U.is_date(U._table[E])&&(h.t="d",h.v=ot(h.v)),R){var W=ya(g.r);l[W.r]||(l[W.r]=[]),l[W.r][W.c]=h}else l[g.r]=h}}}B.length>0&&(l["!rows"]=B)}}();function Bp(t,e,a,n){var i,r,s=[],o=[],l=wa(t["!ref"]),u="",d="",c=[],p=0,h=0,g=t["!rows"],f=Array.isArray(t),m={r:d},v=-1;for(h=l.s.c;h<=l.e.c;++h)c[h]=fa(h);for(p=l.s.r;p<=l.e.r;++p){for(o=[],d=ca(p),h=l.s.c;h<=l.e.c;++h){i=c[h]+d;var b=f?(t[p]||[])[h]:t[i];void 0!==b&&(null!=(u=Np(b,i,t,e,a,n))&&o.push(u))}(o.length>0||g&&g[p])&&(m={r:d},g&&g[p]&&(r=g[p],r.hidden&&(m.hidden=1),v=-1,r.hpx?v=yl(r.hpx):r.hpt&&(v=r.hpt),v>-1&&(m.ht=v,m.customHeight=1),r.level&&(m.outlineLevel=r.level)),s[s.length]=pe("row",o.join(""),m))}if(g)for(;p<g.length;++p)g&&g[p]&&(m={r:p+1},r=g[p],r.hidden&&(m.hidden=1),v=-1,r.hpx?v=yl(r.hpx):r.hpt&&(v=r.hpt),v>-1&&(m.ht=v,m.customHeight=1),r.level&&(m.outlineLevel=r.level),s[s.length]=pe("row","",m));return s.join("")}var Op=pe("worksheet",null,{xmlns:fe.main[0],"xmlns:r":fe.r});function Mp(t,e,a,n){var i=[Nt,Op],r=a.SheetNames[t],s=0,o="",l=a.Sheets[r];null==l&&(l={});var u=l["!ref"]||"A1",d=wa(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Ca(d)}if(n||(n={}),l["!comments"]=[],l["!drawing"]=[],"xlsx"!==e.bookType&&a.vbaraw){var c=a.SheetNames[t];try{a.Workbook&&(c=a.Workbook.Sheets[t].CodeName||c)}catch(b){}i[i.length]=pe("sheetPr",null,{codeName:zt(c)})}i[i.length]=pe("dimension",null,{ref:u}),i[i.length]=Pp(l,e,t,a),e.sheetFormat&&(i[i.length]=pe("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(i[i.length]=Sp(l,l["!cols"])),i[s=i.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=Bp(l,e,t,a,n),o.length>0&&(i[i.length]=o)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),null!=l["!protect"]&&(i[i.length]=Dp(l["!protect"])),null!=l["!autofilter"]&&(i[i.length]=Ep(l["!autofilter"],l,a,t)),null!=l["!merges"]&&l["!merges"].length>0&&(i[i.length]=yp(l["!merges"]));var p,h=-1,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach((function(t){t[1].Target&&(p={ref:t[0]},"#"!=t[1].Target.charAt(0)&&(g=qn(n,-1,zt(t[1].Target).replace(/#.*$/,""),Hn.HLINK),p["r:id"]="rId"+g),(h=t[1].Target.indexOf("#"))>-1&&(p.location=zt(t[1].Target.slice(h+1))),t[1].Tooltip&&(p.tooltip=zt(t[1].Tooltip)),i[i.length]=pe("hyperlink",null,p))})),i[i.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(i[i.length]=xp(l["!margins"])),i[i.length]="",e&&!e.ignoreEC&&void 0!=e.ignoreEC||(i[i.length]=de("ignoredErrors",pe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),l["!drawing"].length>0?(g=qn(n,-1,"../drawings/drawing"+(t+1)+".xml",Hn.DRAW),i[i.length]=pe("drawing",null,{"r:id":"rId"+g})):delete l["!drawing"],l["!comments"].length>0&&(g=qn(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Hn.VML),i[i.length]=pe("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>2&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Lp(t,e){var a={},n=t.l+e;a.r=t._R(4),t.l+=4;var i=t._R(2);t.l+=1;var r=t._R(1);return t.l=n,7&r&&(a.level=7&r),16&r&&(a.hidden=!0),32&r&&(a.hpt=i/20),a}function Up(t,e,a){var n=ta(145),i=(a["!rows"]||[])[t]||{};n._W(4,t),n._W(4,0);var r=320;i.hpx?r=20*yl(i.hpx):i.hpt&&(r=20*i.hpt),n._W(2,r),n._W(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n._W(1,s),n._W(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var c=-1,p=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var g=Array.isArray(a)?(a[u.r]||[])[u.c]:a[_a(u)];g&&(c<0&&(c=h),p=h)}c<0||(++o,n._W(4,c),n._W(4,p))}var f=n.l;return n.l=l,n._W(4,o),n.l=f,n.length>n.l?n.slice(0,n.l):n}function Fp(t,e,a,n){var i=Up(n,a,e);(i.length>17||(e["!rows"]||[])[n])&&na(t,"BrtRowHdr",i)}var $p=Ja,Hp=Za;function jp(){}function Wp(t,e){var a={};return t.l+=19,a.name=$a(t,e-19),a}function zp(t,e){null==e&&(e=ta(84+4*t.length));for(var a=0;a<3;++a)e._W(1,0);return rn({auto:1},e),e._W(-4,-1),e._W(-4,-1),Ha(t,e),e.slice(0,e.l)}function Vp(t){var e=Ua(t);return[e]}function qp(t,e,a){return null==a&&(a=ta(8)),Fa(e,a)}function Gp(t){var e=Ua(t),a=t._R(1);return[e,a,"b"]}function Kp(t,e,a){return null==a&&(a=ta(9)),Fa(e,a),a._W(1,t.v?1:0),a}function Xp(t){var e=Ua(t),a=t._R(1);return[e,a,"e"]}function Yp(t){var e=Ua(t),a=t._R(4);return[e,a,"s"]}function Jp(t,e,a){return null==a&&(a=ta(12)),Fa(e,a),a._W(4,e.v),a}function Zp(t){var e=Ua(t),a=Qa(t);return[e,a,"n"]}function Qp(t,e,a){return null==a&&(a=ta(16)),Fa(e,a),tn(t.v,a),a}function th(t){var e=Ua(t),a=Ga(t);return[e,a,"n"]}function eh(t,e,a){return null==a&&(a=ta(12)),Fa(e,a),Ka(t.v,a),a}function ah(t){var e=Ua(t),a=Ia(t);return[e,a,"str"]}function nh(t,e,a){return null==a&&(a=ta(12+4*t.v.length)),Fa(e,a),Pa(t.v,a),a.length>a.l?a.slice(0,a.l):a}function ih(t,e,a){var n=t.l+e,i=Ua(t);i.r=a["!row"];var r=t._R(1),s=[i,r,"b"];if(a.cellFormula){t.l+=2;var o=jc(t,n-t.l,a);s[3]=Rc(o,null,i,a.supbooks,a)}else t.l=n;return s}function rh(t,e,a){var n=t.l+e,i=Ua(t);i.r=a["!row"];var r=t._R(1),s=[i,r,"e"];if(a.cellFormula){t.l+=2;var o=jc(t,n-t.l,a);s[3]=Rc(o,null,i,a.supbooks,a)}else t.l=n;return s}function sh(t,e,a){var n=t.l+e,i=Ua(t);i.r=a["!row"];var r=Qa(t),s=[i,r,"n"];if(a.cellFormula){t.l+=2;var o=jc(t,n-t.l,a);s[3]=Rc(o,null,i,a.supbooks,a)}else t.l=n;return s}function oh(t,e,a){var n=t.l+e,i=Ua(t);i.r=a["!row"];var r=Ia(t),s=[i,r,"str"];if(a.cellFormula){t.l+=2;var o=jc(t,n-t.l,a);s[3]=Rc(o,null,i,a.supbooks,a)}else t.l=n;return s}var lh=Ja,uh=Za;function dh(t,e){return null==e&&(e=ta(4)),e._W(4,t),e}function ch(t,e){var a=t.l+e,n=Ja(t,16),i=ja(t),r=Ia(t),s=Ia(t),o=Ia(t);t.l=a;var l={rfx:n,relId:i,loc:r,display:o};return s&&(l.Tooltip=s),l}function ph(t,e){var a=ta(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Za({s:ya(t[0]),e:ya(t[0])},a),qa("rId"+e,a);var n=t[1].Target.indexOf("#"),i=-1==n?"":t[1].Target.slice(n+1);return Pa(i||"",a),Pa(t[1].Tooltip||"",a),Pa("",a),a.slice(0,a.l)}function hh(t,e,a){var n=t.l+e,i=Xa(t,16),r=t._R(1),s=[i];if(s[2]=r,a.cellFormula){var o=Hc(t,n-t.l,a);s[1]=o}else t.l=n;return s}function gh(t,e,a){var n=t.l+e,i=Ja(t,16),r=[i];if(a.cellFormula){var s=zc(t,n-t.l,a);r[1]=s,t.l=n}else t.l=n;return r}function fh(t,e,a){null==a&&(a=ta(18));var n=np(t,e);a._W(-4,t),a._W(-4,t),a._W(4,256*(n.width||10)),a._W(4,0);var i=0;return e.hidden&&(i|=1),"number"==typeof n.width&&(i|=2),a._W(1,i),a._W(1,0),a}var mh=["left","right","top","bottom","header","footer"];function vh(t){var e={};return mh.forEach((function(a){e[a]=Qa(t,8)})),e}function bh(t,e){return null==e&&(e=ta(48)),ip(t),mh.forEach((function(a){tn(t[a],e)})),e}function yh(t){var e=t._R(2);return t.l+=28,{RTL:32&e}}function _h(t,e,a){null==a&&(a=ta(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),a._W(2,n),a._W(4,0),a._W(4,0),a._W(4,0),a._W(1,0),a._W(1,0),a._W(2,0),a._W(2,100),a._W(2,0),a._W(2,0),a._W(2,0),a._W(4,0),a}function Dh(t){var e=ta(24);return e._W(4,4),e._W(4,1),Za(t,e),e}function Ch(t,e){return null==e&&(e=ta(66)),e._W(2,t.password?Ko(t.password):0),e._W(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(a){a[1]?e._W(4,null==t[a[0]]||t[a[0]]?0:1):e._W(4,null!=t[a[0]]&&t[a[0]]?0:1)})),e}function wh(t,e,a,n,i,r,s){if(!t)return t;var o=e||{};n||(n={"!id":{}}),null!=C&&null==o.dense&&(o.dense=C);var l,u,d,c,p,h,g,f,m,v,b=o.dense?[]:{},y={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=!1,D=!1,w=[];o.biff=12,o["!row"]=0;var x=0,k=!1,S=[],A={},E=o.supbooks||i.supbooks||[[]];if(E.sharedf=A,E.arrayf=S,E.SheetNames=i.SheetNames||i.Sheets.map((function(t){return t.name})),!o.supbooks&&(o.supbooks=E,i.Names))for(var T=0;T<i.Names.length;++T)E[0][T+1]=i.Names[T];var I=[],P=[],N=!1;if(ea(t,(function(t,e,C){if(!D)switch(C){case 148:l=t;break;case 0:u=t,o.sheetRows&&o.sheetRows<=u.r&&(D=!0),m=ca(p=u.r),o["!row"]=u.r,(t.hidden||t.hpt||null!=t.level)&&(t.hpt&&(t.hpx=_l(t.hpt)),P[t.r]=t);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:switch(d={t:t[2]},t[2]){case"n":d.v=t[1];break;case"s":f=Qc[t[1]],d.v=f.t,d.r=f.r;break;case"b":d.v=!!t[1];break;case"e":d.v=t[1],!1!==o.cellText&&(d.w=en[d.v]);break;case"str":d.t="s",d.v=t[1];break}if((c=s.CellXf[t[0].iStyleRef])&&sp(d,c.numFmtId,null,o,r,s),h=t[0].c,o.dense?(b[p]||(b[p]=[]),b[p][h]=d):b[fa(h)+m]=d,o.cellFormula){for(k=!1,x=0;x<S.length;++x){var T=S[x];u.r>=T[0].s.r&&u.r<=T[0].e.r&&h>=T[0].s.c&&h<=T[0].e.c&&(d.F=Ca(T[0]),k=!0)}!k&&t.length>3&&(d.f=t[3])}if(y.s.r>u.r&&(y.s.r=u.r),y.s.c>h&&(y.s.c=h),y.e.r<u.r&&(y.e.r=u.r),y.e.c<h&&(y.e.c=h),o.cellDates&&c&&"n"==d.t&&U.is_date(U._table[c.numFmtId])){var R=U.parse_date_code(d.v);R&&(d.t="d",d.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}break;case 1:if(!o.sheetStubs||_)break;d={t:"z",v:void 0},h=t[0].c,o.dense?(b[p]||(b[p]=[]),b[p][h]=d):b[fa(h)+m]=d,y.s.r>u.r&&(y.s.r=u.r),y.s.c>h&&(y.s.c=h),y.e.r<u.r&&(y.e.r=u.r),y.e.c<h&&(y.e.c=h);break;case 176:w.push(t);break;case 494:var B=n["!id"][t.relId];for(B?(t.Target=B.Target,t.loc&&(t.Target+="#"+t.loc),t.Rel=B):""==t.relId&&(t.Target="#"+t.loc),p=t.rfx.s.r;p<=t.rfx.e.r;++p)for(h=t.rfx.s.c;h<=t.rfx.e.c;++h)o.dense?(b[p]||(b[p]=[]),b[p][h]||(b[p][h]={t:"z",v:void 0}),b[p][h].l=t):(g=_a({c:h,r:p}),b[g]||(b[g]={t:"z",v:void 0}),b[g].l=t);break;case 426:if(!o.cellFormula)break;S.push(t),v=o.dense?b[p][h]:b[fa(h)+m],v.f=Rc(t[1],y,{r:u.r,c:h},E,o),v.F=Ca(t[0]);break;case 427:if(!o.cellFormula)break;A[_a(t[0].s)]=t[1],v=o.dense?b[p][h]:b[fa(h)+m],v.f=Rc(t[1],y,{r:u.r,c:h},E,o);break;case 60:if(!o.cellStyles)break;while(t.e>=t.s)I[t.e--]={width:t.w/256,hidden:!!(1&t.flags)},N||(N=!0,fl(t.w/256)),ml(I[t.e+1]);break;case 161:b["!autofilter"]={ref:Ca(t)};break;case 476:b["!margins"]=t;break;case 147:i.Sheets[a]||(i.Sheets[a]={}),t.name&&(i.Sheets[a].CodeName=t.name);break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),t.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 49:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 64:case 1053:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 151:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 152:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:break;case 38:break;default:if((e||"").indexOf("Begin")>0);else if((e||"").indexOf("End")>0);else if(!_||o.WTF)throw new Error("Unexpected record "+C+" "+e)}}),o),delete o.supbooks,delete o["!row"],!b["!ref"]&&(y.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(b["!ref"]=Ca(l||y)),o.sheetRows&&b["!ref"]){var R=wa(b["!ref"]);o.sheetRows<=+R.e.r&&(R.e.r=o.sheetRows-1,R.e.r>y.e.r&&(R.e.r=y.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>y.e.c&&(R.e.c=y.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),b["!fullref"]=b["!ref"],b["!ref"]=Ca(R))}return w.length>0&&(b["!merges"]=w),I.length>0&&(b["!cols"]=I),P.length>0&&(b["!rows"]=P),b}function xh(t,e,a,n,i,r){if(void 0===e.v)return"";var s="";switch(e.t){case"b":s=e.v?"1":"0";break;case"d":e=ht(e),e.z=e.z||U._table[14],e.v=st(ct(e.v)),e.t="n";break;case"n":case"e":s=""+e.v;break;default:s=e.v;break}var o={r:a,c:n};switch(o.s=rp(i.cellXfs,e,i),e.l&&r["!links"].push([_a(o),e.l]),e.c&&r["!comments"].push([_a(o),e.c]),e.t){case"s":case"str":return void(i.bookSST?(s=ap(i.Strings,e.v,i.revStrings),o.t="s",o.v=s,na(t,"BrtCellIsst",Jp(e,o))):(o.t="str",na(t,"BrtCellSt",nh(e,o))));case"n":return void(e.v==(0|e.v)&&e.v>-1e3&&e.v<1e3?na(t,"BrtCellRk",eh(e,o)):na(t,"BrtCellReal",Qp(e,o)));case"b":return o.t="b",void na(t,"BrtCellBool",Kp(e,o));case"e":o.t="e";break}na(t,"BrtCellBlank",qp(e,o))}function kh(t,e,a,n){var i,r=wa(e["!ref"]||"A1"),s="",o=[];na(t,"BrtBeginSheetData");var l=Array.isArray(e),u=r.e.r;e["!rows"]&&(u=Math.max(r.e.r,e["!rows"].length-1));for(var d=r.s.r;d<=u;++d)if(s=ca(d),Fp(t,e,r,d),d<=r.e.r)for(var c=r.s.c;c<=r.e.c;++c){d===r.s.r&&(o[c]=fa(c)),i=o[c]+s;var p=l?(e[d]||[])[c]:e[i];p&&xh(t,p,d,c,n,e)}na(t,"BrtEndSheetData")}function Sh(t,e){e&&e["!merges"]&&(na(t,"BrtBeginMergeCells",dh(e["!merges"].length)),e["!merges"].forEach((function(e){na(t,"BrtMergeCell",uh(e))})),na(t,"BrtEndMergeCells"))}function Ah(t,e){e&&e["!cols"]&&(na(t,"BrtBeginColInfos"),e["!cols"].forEach((function(e,a){e&&na(t,"BrtColInfo",fh(a,e))})),na(t,"BrtEndColInfos"))}function Eh(t,e){e&&e["!ref"]&&(na(t,"BrtBeginCellIgnoreECs"),na(t,"BrtCellIgnoreEC",Dh(wa(e["!ref"]))),na(t,"BrtEndCellIgnoreECs"))}function Th(t,e,a){e["!links"].forEach((function(e){if(e[1].Target){var n=qn(a,-1,e[1].Target.replace(/#.*$/,""),Hn.HLINK);na(t,"BrtHLink",ph(e,n))}})),delete e["!links"]}function Ih(t,e,a,n){if(e["!comments"].length>0){var i=qn(n,-1,"../drawings/vmlDrawing"+(a+1)+".vml",Hn.VML);na(t,"BrtLegacyDrawing",qa("rId"+i)),e["!legacy"]=i}}function Ph(t,e){e["!autofilter"]&&(na(t,"BrtBeginAFilter",Za(wa(e["!autofilter"].ref))),na(t,"BrtEndAFilter"))}function Nh(t,e,a){na(t,"BrtBeginWsViews"),na(t,"BrtBeginWsView",_h(e,a)),na(t,"BrtEndWsView"),na(t,"BrtEndWsViews")}function Rh(){}function Bh(t,e){e["!protect"]&&na(t,"BrtSheetProtection",Ch(e["!protect"]))}function Oh(t,e,a,n){var i=aa(),r=a.SheetNames[t],s=a.Sheets[r]||{},o=r;try{a&&a.Workbook&&(o=a.Workbook.Sheets[t].CodeName||o)}catch(g){}var l=wa(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],na(i,"BrtBeginSheet"),a.vbaraw&&na(i,"BrtWsProp",zp(o)),na(i,"BrtWsDim",Hp(l)),Nh(i,s,a.Workbook),Rh(i,s),Ah(i,s,t,e,a),kh(i,s,t,e,a),Bh(i,s),Ph(i,s),Sh(i,s),Th(i,s,n),s["!margins"]&&na(i,"BrtMargins",bh(s["!margins"])),e&&!e.ignoreEC&&void 0!=e.ignoreEC||Eh(i,s),Ih(i,s,t,n),na(i,"BrtEndSheet"),i.end()}function Mh(t){var e=[];(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(t){var a=t.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=+a[2])}));var a=Ht((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return[e,a]}function Lh(t,e,a,n,i,r){var s=r||{"!type":"chart"};if(!t)return r;var o=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(t){var e=Mh(t);d.s.r=d.s.c=0,d.e.c=o,u=fa(o),e[0].forEach((function(t,a){s[u+ca(a)]={t:"n",v:t,z:e[1]},l=a})),d.e.r<l&&(d.e.r=l),++o})),o>0&&(s["!ref"]=Ca(d)),s}Hn.CS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet";pe("chartsheet",null,{xmlns:fe.main[0],"xmlns:r":fe.r});function Uh(t,e,a,n,i){if(!t)return t;n||(n={"!id":{}});var r,s={"!type":"chart","!chart":null,"!rel":""},o=t.match(mp);return o&&_p(o[0],s,i,a),(r=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=r[1]),n["!id"][s["!rel"]]&&(s["!chart"]=n["!id"][s["!rel"]]),s}function Fh(t,e){t.l+=10;var a=Ia(t,e-10);return{name:a}}function $h(t,e,a,n,i){if(!t)return t;n||(n={"!id":{}});var r={"!type":"chart","!chart":null,"!rel":""},s=[],o=!1;return ea(t,(function(t,n,l){switch(l){case 550:r["!rel"]=t;break;case 651:i.Sheets[a]||(i.Sheets[a]={}),t.name&&(i.Sheets[a].CodeName=t.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(n);break;case 38:s.pop();break;default:if((n||"").indexOf("Begin")>0)s.push(n);else if((n||"").indexOf("End")>0)s.pop();else if(!o||e.WTF)throw new Error("Unexpected record "+l+" "+n)}}),e),n["!id"][r["!rel"]]&&(r["!chart"]=n["!id"][r["!rel"]]),r}var Hh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jh=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Wh=[],zh=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Vh(t,e){for(var a=0;a!=t.length;++a)for(var n=t[a],i=0;i!=e.length;++i){var r=e[i];if(null==n[r[0]])n[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof n[r[0]]&&(n[r[0]]=Jt(n[r[0]]));break;case"int":"string"==typeof n[r[0]]&&(n[r[0]]=parseInt(n[r[0]],10));break}}}function qh(t,e){for(var a=0;a!=e.length;++a){var n=e[a];if(null==t[n[0]])t[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof t[n[0]]&&(t[n[0]]=Jt(t[n[0]]));break;case"int":"string"==typeof t[n[0]]&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Gh(t){qh(t.WBProps,Hh),qh(t.CalcPr,zh),Vh(t.WBView,jh),Vh(t.Sheets,Wh),tp.date1904=Jt(t.WBProps.date1904)}function Kh(t){return t.Workbook&&t.Workbook.WBProps&&Jt(t.Workbook.WBProps.date1904)?"true":"false"}var Xh="][*?/\\".split("");function Yh(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var a=!0;return Xh.forEach((function(n){if(-1!=t.indexOf(n)){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");a=!1}})),a}function Jh(t,e,a){t.forEach((function(n,i){Yh(n);for(var r=0;r<i;++r)if(n==t[r])throw new Error("Duplicate Sheet Name: "+n);if(a){var s=e&&e[i]&&e[i].CodeName||n;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}}))}function Zh(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Jh(t.SheetNames,e,!!t.vbaraw);for(var a=0;a<t.SheetNames.length;++a)op(t.Sheets[t.SheetNames[a]],t.SheetNames[a],a)}var Qh=/<\w+:workbook/;function tg(t,e){if(!t)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",r={},s=0;if(t.replace(Bt,(function(o,l){var u=Lt(o);switch(Ut(u[0])){case"<?xml":break;case"<workbook":o.match(Qh)&&(i="xmlns"+o.match(/<(\w+):/)[1]),a.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],a.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Hh.forEach((function(t){if(null!=u[t[0]])switch(t[2]){case"bool":a.WBProps[t[0]]=Jt(u[t[0]]);break;case"int":a.WBProps[t[0]]=parseInt(u[t[0]],10);break;default:a.WBProps[t[0]]=u[t[0]]}})),u.codeName&&(a.WBProps.CodeName=u.codeName);break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],a.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ht(Zt(u.name)),delete u[0],a.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":r={},r.Name=Zt(u.name),u.comment&&(r.Comment=u.comment),u.localSheetId&&(r.Sheet=+u.localSheetId),Jt(u.hidden||"0")&&(r.Hidden=!0),s=l+o.length;break;case"</definedName>":r.Ref=Ht(Zt(t.slice(s,l))),a.Names.push(r);break;case"<definedName/>":break;case"<calcPr":delete u[0],a.CalcPr=u;break;case"<calcPr/>":delete u[0],a.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return o})),-1===fe.main.indexOf(a.xmlns))throw new Error("Unknown Namespace: "+a.xmlns);return Gh(a),a}var eg=pe("workbook",null,{xmlns:fe.main[0],"xmlns:r":fe.r});function ag(t){var e=[Nt];e[e.length]=eg;var a=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Hh.forEach((function(e){null!=t.Workbook.WBProps[e[0]]&&t.Workbook.WBProps[e[0]]!=e[1]&&(n[e[0]]=t.Workbook.WBProps[e[0]])})),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=pe("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],r=0;for(e[e.length]="<sheets>",r=0;r!=t.SheetNames.length;++r){var s={name:zt(t.SheetNames[r].slice(0,31))};if(s.sheetId=""+(r+1),s["r:id"]="rId"+(r+1),i[r])switch(i[r].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}e[e.length]=pe("sheet",null,s)}return e[e.length]="</sheets>",a&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach((function(t){var a={name:t.Name};t.Comment&&(a.comment=t.Comment),null!=t.Sheet&&(a.localSheetId=""+t.Sheet),t.Hidden&&(a.hidden="1"),t.Ref&&(e[e.length]=pe("definedName",String(t.Ref).replace(/</g,"&lt;").replace(/>/g,"&gt;"),a))})),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function ng(t,e){var a={};return a.Hidden=t._R(4),a.iTabID=t._R(4),a.strRelID=Va(t,e-8),a.name=Ia(t),a}function ig(t,e){return e||(e=ta(127)),e._W(4,t.Hidden),e._W(4,t.iTabID),qa(t.strRelID,e),Pa(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function rg(t,e){var a={},n=t._R(4);a.defaultThemeVersion=t._R(4);var i=e>8?Ia(t):"";return i.length>0&&(a.CodeName=i),a.autoCompressPictures=!!(65536&n),a.backupFile=!!(64&n),a.checkCompatibility=!!(4096&n),a.date1904=!!(1&n),a.filterPrivacy=!!(8&n),a.hidePivotFieldList=!!(1024&n),a.promptedSolutions=!!(16&n),a.publishItems=!!(2048&n),a.refreshAllConnections=!!(262144&n),a.saveExternalLinkValues=!!(128&n),a.showBorderUnselectedTables=!!(4&n),a.showInkAnnotation=!!(32&n),a.showObjects=["all","placeholders","none"][n>>13&3],a.showPivotChartFilter=!!(32768&n),a.updateLinks=["userSet","never","always"][n>>8&3],a}function sg(t,e){e||(e=ta(72));var a=0;return t&&t.filterPrivacy&&(a|=8),e._W(4,a),e._W(4,0),Ha(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function og(t,e){var a={};return t._R(4),a.ArchID=t._R(4),t.l+=e-8,a}function lg(t,e,a){var n=t.l+e;t.l+=4,t.l+=1;var i=t._R(4),r=za(t),s=Wc(t,0,a),o=ja(t);t.l=n;var l={Name:r,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function ug(t,e){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var r=[],s=[[]];return s.SheetNames=[],s.XTI=[],ea(t,(function(t,o,l){switch(l){case 156:s.SheetNames.push(t.name),a.Sheets.push(t);break;case 153:a.WBProps=t;break;case 39:null!=t.Sheet&&(e.SID=t.Sheet),t.Ref=Rc(t.Ptg,null,null,s,e),delete e.SID,delete t.Ptg,r.push(t);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([l,t]):s[0]=[l,t],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(t),s.XTI=s.XTI.concat(t);break;case 361:break;case 3072:case 3073:case 2071:case 534:case 677:case 158:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(o),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(o),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if((o||"").indexOf("Begin")>0);else if((o||"").indexOf("End")>0);else if(!i||e.WTF&&"BrtACBegin"!=n[n.length-1]&&"BrtFRTBegin"!=n[n.length-1])throw new Error("Unexpected record "+l+" "+o)}}),e),Gh(a),a.Names=r,a.supbooks=s,a}function dg(t,e){na(t,"BrtBeginBundleShs");for(var a=0;a!=e.SheetNames.length;++a){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[a]&&e.Workbook.Sheets[a].Hidden||0,i={Hidden:n,iTabID:a+1,strRelID:"rId"+(a+1),name:e.SheetNames[a]};na(t,"BrtBundleSh",ig(i))}na(t,"BrtEndBundleShs")}function cg(t,a){a||(a=ta(127));for(var n=0;4!=n;++n)a._W(4,0);return Pa("SheetJS",a),Pa(e.version,a),Pa(e.version,a),Pa("7262",a),a.length=a.l,a.length>a.l?a.slice(0,a.l):a}function pg(t,e){e||(e=ta(29)),e._W(-4,0),e._W(-4,460),e._W(4,28800),e._W(4,17600),e._W(4,500),e._W(4,t),e._W(4,t);var a=120;return e._W(1,a),e.length>e.l?e.slice(0,e.l):e}function hg(t,e){if(e.Workbook&&e.Workbook.Sheets){for(var a=e.Workbook.Sheets,n=0,i=-1,r=-1;n<a.length;++n)!a[n]||!a[n].Hidden&&-1==i?i=n:1==a[n].Hidden&&-1==r&&(r=n);r>i||(na(t,"BrtBeginBookViews"),na(t,"BrtBookView",pg(i)),na(t,"BrtEndBookViews"))}}function gg(t,e){var a=aa();return na(a,"BrtBeginBook"),na(a,"BrtFileVersion",cg()),na(a,"BrtWbProp",sg(t.Workbook&&t.Workbook.WBProps||null)),hg(a,t,e),dg(a,t,e),na(a,"BrtEndBook"),a.end()}function fg(t,e,a){return".bin"===e.slice(-4)?ug(t,a):tg(t,a)}function mg(t,e,a,n,i,r,s,o){return".bin"===e.slice(-4)?wh(t,n,a,i,r,s,o):bp(t,n,a,i,r,s,o)}function vg(t,e,a,n,i,r,s,o){return".bin"===e.slice(-4)?$h(t,n,a,i,r,s,o):Uh(t,n,a,i,r,s,o)}function bg(t,e,a,n,i,r,s,o){return".bin"===e.slice(-4)?Yu(t,n,a,i,r,s,o):Ju(t,n,a,i,r,s,o)}function yg(t,e,a,n,i,r,s,o){return".bin"===e.slice(-4)?Ku(t,n,a,i,r,s,o):Xu(t,n,a,i,r,s,o)}function _g(t,e,a,n){return".bin"===e.slice(-4)?Xl(t,a,n):Pl(t,a,n)}function Dg(t,e,a){return fu(t,a)}function Cg(t,e,a){return".bin"===e.slice(-4)?Eo(t,a):xo(t,a)}function wg(t,e,a){return".bin"===e.slice(-4)?ju(t,a):Ou(t,a)}function xg(t,e,a){return".bin"===e.slice(-4)?Au(t,e,a):ku(t,e,a)}function kg(t,e,a){return".bin"===e.slice(-4)?Tu(t,e,a):Eu(t,e,a)}function Sg(t,e,a){return(".bin"===e.slice(-4)?gg:ag)(t,a)}function Ag(t,e,a,n,i){return(".bin"===e.slice(-4)?Oh:Mp)(t,a,n,i)}function Eg(t,e,a){return(".bin"===e.slice(-4)?su:Rl)(t,a)}function Tg(t,e,a){return(".bin"===e.slice(-4)?Po:So)(t,a)}function Ig(t,e,a){return(".bin"===e.slice(-4)?Wu:Lu)(t,a)}var Pg=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ng=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Rg(t,e){var a=t.split(/\s+/),n=[];if(e||(n[0]=a[0]),1===a.length)return n;var i,r,s,o,l=t.match(Pg);if(l)for(o=0;o!=l.length;++o)i=l[o].match(Ng),-1===(r=i[1].indexOf(":"))?n[i[1]]=i[2].slice(1,i[2].length-1):(s="xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(r+1),n[s]=i[2].slice(1,i[2].length-1));return n}function Bg(t){var e=t.split(/\s+/),a={};if(1===e.length)return a;var n,i,r,s,o=t.match(Pg);if(o)for(s=0;s!=o.length;++s)n=o[s].match(Ng),-1===(i=n[1].indexOf(":"))?a[n[1]]=n[2].slice(1,n[2].length-1):(r="xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(i+1),a[r]=n[2].slice(1,n[2].length-1));return a}function Og(t,e){var a=H[t]||Ht(t);return"General"===a?U._general(e):U.format(a,e)}function Mg(t,e,a,n){var i=n;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Jt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=ct(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}t[Ht(e)]=i}function Lg(t,e,a){if("z"!==t.t){if(!a||!1!==a.cellText)try{"e"===t.t?t.w=t.w||en[t.v]:"General"===e?"n"===t.t?(0|t.v)===t.v?t.w=U._general_int(t.v):t.w=U._general_num(t.v):t.w=U._general(t.v):t.w=Og(e||"General",t.v)}catch(l){if(a.WTF)throw l}try{var n=H[e]||e||"General";if(a.cellNF&&(t.z=n),a.cellDates&&"n"==t.t&&U.is_date(n)){var i=U.parse_date_code(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(l){if(a.WTF)throw l}}}function Ug(t,e,a){if(a.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Dl[n.Pattern]||n.Pattern)}t[e.ID]=e}function Fg(t,e,a,n,i,r,s,o,l,u){var d="General",c=n.StyleID,p={};u=u||{};var h=[],g=0;void 0===c&&o&&(c=o.StyleID),void 0===c&&s&&(c=s.StyleID);while(void 0!==r[c]){if(r[c].nf&&(d=r[c].nf),r[c].Interior&&h.push(r[c].Interior),!r[c].Parent)break;c=r[c].Parent}switch(a.Type){case"Boolean":n.t="b",n.v=Jt(t);break;case"String":n.t="s",n.r=Xt(Ht(t)),n.v=t.indexOf("<")>-1?Ht(e):n.r;break;case"DateTime":"Z"!=t.slice(-1)&&(t+="Z"),n.v=(ct(t)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!==n.v?n.v=Ht(t):n.v<60&&(n.v=n.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=an[t],!1!==u.cellText&&(n.w=t);break;default:n.t="s",n.v=Xt(e||t);break}if(Lg(n,d,u),!1!==u.cellFormula)if(n.Formula){var f=Ht(n.Formula);61==f.charCodeAt(0)&&(f=f.slice(1)),n.f=Zu(f,i),delete n.Formula,"RC"==n.ArrayRange?n.F=Zu("RC:RC",i):n.ArrayRange&&(n.F=Zu(n.ArrayRange,i),l.push([wa(n.F),n.F]))}else for(g=0;g<l.length;++g)i.r>=l[g][0].s.r&&i.r<=l[g][0].e.r&&i.c>=l[g][0].s.c&&i.c<=l[g][0].e.c&&(n.F=l[g][1]);u.cellStyles&&(h.forEach((function(t){!p.patternType&&t.patternType&&(p.patternType=t.patternType)})),n.s=p),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function $g(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.v=t.w=t.ixfe=void 0}function Hg(t){if(k&&i.isBuffer(t))return t.toString("utf8");if("string"===typeof t)return t;if("undefined"!==typeof Uint8Array&&t instanceof Uint8Array)return Zt(N(B(t)));throw new Error("Bad input format: expected Buffer or string")}var jg=/<(\/?)([^\s?>!\/:]*:|)([^\s?>:\/]+)[^>]*>/gm;function Wg(t,e){var a=e||{};F(U);var n=y(Hg(t));"binary"!=a.type&&"array"!=a.type&&"base64"!=a.type||(n="undefined"!==typeof cptable?cptable.utils.decode(65001,m(n)):Zt(n));var i,r=n.slice(0,1024).toLowerCase(),s=!1;if(-1==r.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(t){r.indexOf("<"+t)>=0&&(s=!0)})),s)return Mf.to_workbook(n,a);var o,l=[];null!=C&&null==a.dense&&(a.dense=C);var u,d={},c=[],p=a.dense?[]:{},h="",g={},f={},v=Rg('<Data ss:Type="String">'),b=0,_=0,D=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},x={},k={},S="",A=0,E=[],T={},I={},P=0,N=[],R=[],B={},O=[],M=!1,L=[],$=[],j={},W=0,z=0,V={Sheets:[],WBProps:{date1904:!1}},q={};jg.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");while(i=jg.exec(n))switch(i[3]){case"Data":if(l[l.length-1][1])break;"/"===i[1]?Fg(n.slice(b,i.index),S,v,"Comment"==l[l.length-1][0]?B:g,{c:_,r:D},x,O[_],f,L,a):(S="",v=Rg(i[0]),b=i.index+i[0].length);break;case"Cell":if("/"===i[1])if(R.length>0&&(g.c=R),(!a.sheetRows||a.sheetRows>D)&&void 0!==g.v&&(a.dense?(p[D]||(p[D]=[]),p[D][_]=g):p[fa(_)+ca(D)]=g),g.HRef&&(g.l={Target:g.HRef},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(W=_+(0|parseInt(g.MergeAcross,10)),z=D+(0|parseInt(g.MergeDown,10)),E.push({s:{c:_,r:D},e:{c:W,r:z}})),a.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var G=_;G<=W;++G)for(var K=D;K<=z;++K)(G>_||K>D)&&(a.dense?(p[K]||(p[K]=[]),p[K][G]={t:"z"}):p[fa(G)+ca(K)]={t:"z"});_=W+1}else++_;else g.MergeAcross?_=W+1:++_;else g=Bg(i[0]),g.Index&&(_=+g.Index-1),_<w.s.c&&(w.s.c=_),_>w.e.c&&(w.e.c=_),"/>"===i[0].slice(-2)&&++_,R=[];break;case"Row":"/"===i[1]||"/>"===i[0].slice(-2)?(D<w.s.r&&(w.s.r=D),D>w.e.r&&(w.e.r=D),"/>"===i[0].slice(-2)&&(f=Rg(i[0]),f.Index&&(D=+f.Index-1)),_=0,++D):(f=Rg(i[0]),f.Index&&(D=+f.Index-1),j={},("0"==f.AutoFitHeight||f.Height)&&(j.hpx=parseInt(f.Height,10),j.hpt=yl(j.hpx),$[D]=j),"1"==f.Hidden&&(j.hidden=!0,$[D]=j));break;case"Worksheet":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"));c.push(h),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(p["!ref"]=Ca(w),a.sheetRows&&a.sheetRows<=w.e.r&&(p["!fullref"]=p["!ref"],w.e.r=a.sheetRows-1,p["!ref"]=Ca(w))),E.length&&(p["!merges"]=E),O.length>0&&(p["!cols"]=O),$.length>0&&(p["!rows"]=$),d[h]=p}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},D=_=0,l.push([i[3],!1]),o=Rg(i[0]),h=Ht(o.Name),p=a.dense?[]:{},E=[],L=[],$=[],q={name:h,Hidden:0},V.Sheets.push(q);break;case"Table":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"))}else{if("/>"==i[0].slice(-2))break;Rg(i[0]),l.push([i[3],!1]),O=[],M=!1}break;case"Style":"/"===i[1]?Ug(x,k,a):k=Rg(i[0]);break;case"NumberFormat":k.nf=Ht(Rg(i[0]).Format||"General"),H[k.nf]&&(k.nf=H[k.nf]);for(var X=0;392!=X;++X)if(U._table[X]==k.nf)break;if(392==X)for(X=57;392!=X;++X)if(null==U._table[X]){U.load(k.nf,X);break}break;case"Column":if("Table"!==l[l.length-1][0])break;if(u=Rg(i[0]),u.Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!M&&u.wpx>10){M=!0,dl=ol;for(var Y=0;Y<O.length;++Y)O[Y]&&ml(O[Y])}M&&ml(u),O[u.Index-1||O.length]=u;for(var J=0;J<+u.Span;++J)O[O.length]=ht(u);break;case"NamedRange":V.Names||(V.Names=[]);var Z=Lt(i[0]),Q={Name:Z.Name,Ref:Zu(Z.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(Q.Sheet=V.Sheets.length-1),V.Names.push(Q);break;case"NamedCell":break;case"B":break;case"I":break;case"U":break;case"S":break;case"Sub":break;case"Sup":break;case"Span":break;case"Border":break;case"Alignment":break;case"Borders":break;case"Font":if("/>"===i[0].slice(-2))break;"/"===i[1]?S+=n.slice(A,i.index):A=i.index+i[0].length;break;case"Interior":if(!a.cellStyles)break;k.Interior=Rg(i[0]);break;case"Protection":break;case"Author":case"Title":case"Description":case"Created":case"Keywords":case"Subject":case"Category":case"Company":case"LastAuthor":case"LastSaved":case"LastPrinted":case"Version":case"Revision":case"TotalTime":case"HyperlinkBase":case"Manager":case"ContentStatus":case"Identifier":case"Language":case"AppName":if("/>"===i[0].slice(-2))break;"/"===i[1]?bi(T,i[3],n.slice(P,i.index)):P=i.index+i[0].length;break;case"Paragraphs":break;case"Styles":case"Workbook":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"))}else l.push([i[3],!1]);break;case"Comment":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"));$g(B),R.push(B)}else l.push([i[3],!1]),o=Rg(i[0]),B={a:o.Author};break;case"AutoFilter":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"))}else if("/"!==i[0].charAt(i[0].length-2)){var tt=Rg(i[0]);p["!autofilter"]={ref:Zu(tt.Range).replace(/\$/g,"")},l.push([i[3],!0])}break;case"Name":break;case"ComponentOptions":case"DocumentProperties":case"CustomDocumentProperties":case"OfficeDocumentSettings":case"PivotTable":case"PivotCache":case"Names":case"MapInfo":case"PageBreaks":case"QueryTable":case"DataValidation":case"Sorting":case"Schema":case"data":case"ConditionalFormatting":case"SmartTagType":case"SmartTags":case"ExcelWorkbook":case"WorkbookOptions":case"WorksheetOptions":if("/"===i[1]){if((o=l.pop())[0]!==i[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&l.push([i[3],!0]);break;default:if(0==l.length&&"document"==i[3])return Wf(n,a);if(0==l.length&&"UOF"==i[3])return Wf(n,a);var et=!0;switch(l[l.length-1][0]){case"OfficeDocumentSettings":switch(i[3]){case"AllowPNG":break;case"RemovePersonalInformation":break;case"DownloadComponents":break;case"LocationOfComponents":break;case"Colors":break;case"Color":break;case"Index":break;case"RGB":break;case"PixelsPerInch":break;case"TargetScreenSize":break;case"ReadOnlyRecommended":break;default:et=!1}break;case"ComponentOptions":switch(i[3]){case"Toolbar":break;case"HideOfficeLogo":break;case"SpreadsheetAutoFit":break;case"Label":break;case"Caption":break;case"MaxHeight":break;case"MaxWidth":break;case"NextSheetNumber":break;default:et=!1}break;case"ExcelWorkbook":switch(i[3]){case"Date1904":V.WBProps.date1904=!0;break;case"WindowHeight":break;case"WindowWidth":break;case"WindowTopX":break;case"WindowTopY":break;case"TabRatio":break;case"ProtectStructure":break;case"ProtectWindows":break;case"ActiveSheet":break;case"DisplayInkNotes":break;case"FirstVisibleSheet":break;case"SupBook":break;case"SheetName":break;case"SheetIndex":break;case"SheetIndexFirst":break;case"SheetIndexLast":break;case"Dll":break;case"AcceptLabelsInFormulas":break;case"DoNotSaveLinkValues":break;case"Iteration":break;case"MaxIterations":break;case"MaxChange":break;case"Path":break;case"Xct":break;case"Count":break;case"SelectedSheets":break;case"Calculation":break;case"Uncalced":break;case"StartupPrompt":break;case"Crn":break;case"ExternName":break;case"Formula":break;case"ColFirst":break;case"ColLast":break;case"WantAdvise":break;case"Boolean":break;case"Error":break;case"Text":break;case"OLE":break;case"NoAutoRecover":break;case"PublishObjects":break;case"DoNotCalculateBeforeSave":break;case"Number":break;case"RefModeR1C1":break;case"EmbedSaveSmartTags":break;default:et=!1}break;case"WorkbookOptions":switch(i[3]){case"OWCVersion":break;case"Height":break;case"Width":break;default:et=!1}break;case"WorksheetOptions":switch(i[3]){case"Visible":if("/>"===i[0].slice(-2));else if("/"===i[1])switch(n.slice(P,i.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else P=i.index+i[0].length;break;case"Header":p["!margins"]||ip(p["!margins"]={},"xlml"),p["!margins"].header=Lt(i[0]).Margin;break;case"Footer":p["!margins"]||ip(p["!margins"]={},"xlml"),p["!margins"].footer=Lt(i[0]).Margin;break;case"PageMargins":var at=Lt(i[0]);p["!margins"]||ip(p["!margins"]={},"xlml"),at.Top&&(p["!margins"].top=at.Top),at.Left&&(p["!margins"].left=at.Left),at.Right&&(p["!margins"].right=at.Right),at.Bottom&&(p["!margins"].bottom=at.Bottom);break;case"DisplayRightToLeft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"Unsynced":break;case"Print":break;case"Panes":break;case"Scale":break;case"Pane":break;case"Number":break;case"Layout":break;case"PageSetup":break;case"Selected":break;case"ProtectObjects":break;case"EnableSelection":break;case"ProtectScenarios":break;case"ValidPrinterInfo":break;case"HorizontalResolution":break;case"VerticalResolution":break;case"NumberofCopies":break;case"ActiveRow":break;case"ActiveCol":break;case"ActivePane":break;case"TopRowVisible":break;case"TopRowBottomPane":break;case"LeftColumnVisible":break;case"LeftColumnRightPane":break;case"FitToPage":break;case"RangeSelection":break;case"PaperSizeIndex":break;case"PageLayoutZoom":break;case"PageBreakZoom":break;case"FilterOn":break;case"DoNotDisplayGridlines":break;case"SplitHorizontal":break;case"SplitVertical":break;case"FreezePanes":break;case"FrozenNoSplit":break;case"FitWidth":break;case"FitHeight":break;case"CommentsLayout":break;case"Zoom":break;case"LeftToRight":break;case"Gridlines":break;case"AllowSort":break;case"AllowFilter":break;case"AllowInsertRows":break;case"AllowDeleteRows":break;case"AllowInsertCols":break;case"AllowDeleteCols":break;case"AllowInsertHyperlinks":break;case"AllowFormatCells":break;case"AllowSizeCols":break;case"AllowSizeRows":break;case"NoSummaryRowsBelowDetail":break;case"TabColorIndex":break;case"DoNotDisplayHeadings":break;case"ShowPageLayoutZoom":break;case"NoSummaryColumnsRightDetail":break;case"BlackAndWhite":break;case"DoNotDisplayZeros":break;case"DisplayPageBreak":break;case"RowColHeadings":break;case"DoNotDisplayOutline":break;case"NoOrientation":break;case"AllowUsePivotTables":break;case"ZeroHeight":break;case"ViewableRange":break;case"Selection":break;case"ProtectContents":break;default:et=!1}break;case"PivotTable":case"PivotCache":switch(i[3]){case"ImmediateItemsOnDrop":break;case"ShowPageMultipleItemLabel":break;case"CompactRowIndent":break;case"Location":break;case"PivotField":break;case"Orientation":break;case"LayoutForm":break;case"LayoutSubtotalLocation":break;case"LayoutCompactRow":break;case"Position":break;case"PivotItem":break;case"DataType":break;case"DataField":break;case"SourceName":break;case"ParentField":break;case"PTLineItems":break;case"PTLineItem":break;case"CountOfSameItems":break;case"Item":break;case"ItemType":break;case"PTSource":break;case"CacheIndex":break;case"ConsolidationReference":break;case"FileName":break;case"Reference":break;case"NoColumnGrand":break;case"NoRowGrand":break;case"BlankLineAfterItems":break;case"Hidden":break;case"Subtotal":break;case"BaseField":break;case"MapChildItems":break;case"Function":break;case"RefreshOnFileOpen":break;case"PrintSetTitles":break;case"MergeLabels":break;case"DefaultVersion":break;case"RefreshName":break;case"RefreshDate":break;case"RefreshDateCopy":break;case"VersionLastRefresh":break;case"VersionLastUpdate":break;case"VersionUpdateableMin":break;case"VersionRefreshableMin":break;case"Calculation":break;default:et=!1}break;case"PageBreaks":switch(i[3]){case"ColBreaks":break;case"ColBreak":break;case"RowBreaks":break;case"RowBreak":break;case"ColStart":break;case"ColEnd":break;case"RowEnd":break;default:et=!1}break;case"AutoFilter":switch(i[3]){case"AutoFilterColumn":break;case"AutoFilterCondition":break;case"AutoFilterAnd":break;case"AutoFilterOr":break;default:et=!1}break;case"QueryTable":switch(i[3]){case"Id":break;case"AutoFormatFont":break;case"AutoFormatPattern":break;case"QuerySource":break;case"QueryType":break;case"EnableRedirections":break;case"RefreshedInXl9":break;case"URLString":break;case"HTMLTables":break;case"Connection":break;case"CommandText":break;case"RefreshInfo":break;case"NoTitles":break;case"NextId":break;case"ColumnInfo":break;case"OverwriteCells":break;case"DoNotPromptForFile":break;case"TextWizardSettings":break;case"Source":break;case"Number":break;case"Decimal":break;case"ThousandSeparator":break;case"TrailingMinusNumbers":break;case"FormatSettings":break;case"FieldType":break;case"Delimiters":break;case"Tab":break;case"Comma":break;case"AutoFormatName":break;case"VersionLastEdit":break;case"VersionLastRefresh":break;default:et=!1}break;case"Sorting":case"ConditionalFormatting":case"DataValidation":switch(i[3]){case"Range":break;case"Type":break;case"Min":break;case"Max":break;case"Sort":break;case"Descending":break;case"Order":break;case"CaseSensitive":break;case"Value":break;case"ErrorStyle":break;case"ErrorMessage":break;case"ErrorTitle":break;case"CellRangeList":break;case"InputMessage":break;case"InputTitle":break;case"ComboHide":break;case"InputHide":break;case"Condition":break;case"Qualifier":break;case"UseBlank":break;case"Value1":break;case"Value2":break;case"Format":break;default:et=!1}break;case"MapInfo":case"Schema":case"data":switch(i[3]){case"Map":break;case"Entry":break;case"Range":break;case"XPath":break;case"Field":break;case"XSDType":break;case"FilterOn":break;case"Aggregate":break;case"ElementType":break;case"AttributeType":break;case"schema":case"element":case"complexType":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:et=!1}break;case"SmartTags":break;default:et=!1;break}if(et)break;if(!l[l.length-1][1])throw"Unrecognized tag: "+i[3]+"|"+l.join("|");if("CustomDocumentProperties"===l[l.length-1][0]){if("/>"===i[0].slice(-2))break;"/"===i[1]?Mg(I,i[3],N,n.slice(P,i.index)):(N=i,P=i.index+i[0].length);break}if(a.WTF)throw"Unrecognized tag: "+i[3]+"|"+l.join("|")}var nt={};return a.bookSheets||a.bookProps||(nt.Sheets=d),nt.SheetNames=c,nt.Workbook=V,nt.SSF=U.get_table(),nt.Props=T,nt.Custprops=I,nt}function zg(t,e){switch(rm(e=e||{}),e.type||"base64"){case"base64":return Wg(x.decode(t),e);case"binary":case"buffer":case"file":return Wg(t,e);case"array":return Wg(N(t),e)}}function Vg(t,e){var a=[];return t.Props&&a.push(yi(t.Props,e)),t.Custprops&&a.push(_i(t.Props,t.Custprops,e)),a.join("")}function qg(){return""}function Gg(t,e){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach((function(t,e){var n=[];n.push(pe("NumberFormat",null,{"ss:Format":zt(U._table[t.numFmtId])})),a.push(pe("Style",n.join(""),{"ss:ID":"s"+(21+e)}))})),pe("Styles",a.join(""))}function Kg(t){return pe("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+td(t.Ref,{r:0,c:0})})}function Xg(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,a=[],n=0;n<e.length;++n){var i=e[n];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||a.push(Kg(i)))}return pe("Names",a.join(""))}function Yg(t,e,a,n){if(!t)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,r=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==a&&(o.Name.match(/^_xlfn\./)||r.push(Kg(o)))}return r.join("")}function Jg(t,e,a,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(pe("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(pe("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(pe("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[a])if(n.Workbook.Sheets[a].Hidden)i.push(pe("Visible",1==n.Workbook.Sheets[a].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var r=0;r<a;++r)if(n.Workbook.Sheets[r]&&!n.Workbook.Sheets[r].Hidden)break;r==a&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(de("ProtectContents","True")),t["!protect"].objects&&i.push(de("ProtectObjects","True")),t["!protect"].scenarios&&i.push(de("ProtectScenarios","True")),null==t["!protect"].selectLockedCells||t["!protect"].selectLockedCells?null==t["!protect"].selectUnlockedCells||t["!protect"].selectUnlockedCells||i.push(de("EnableSelection","UnlockedCells")):i.push(de("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(e){t["!protect"][e[0]]&&i.push("<"+e[1]+"/>")}))),0==i.length?"":pe("WorksheetOptions",i.join(""),{xmlns:me.x})}function Zg(t){return t.map((function(t){var e=Yt(t.t||""),a=pe("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return pe("Comment",a,{"ss:Author":t.a})})).join("")}function Qg(t,e,a,n,i,r,s){if(!t||void 0==t.v&&void 0==t.f)return"";var o={};if(t.f&&(o["ss:Formula"]="="+zt(td(t.f,s))),t.F&&t.F.slice(0,e.length)==e){var l=ya(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=zt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=zt(t.l.Tooltip))),a["!merges"])for(var u=a["!merges"],d=0;d!=u.length;++d)u[d].s.c==s.c&&u[d].s.r==s.r&&(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var c="",p="";switch(t.t){case"z":return"";case"n":c="Number",p=String(t.v);break;case"b":c="Boolean",p=t.v?"1":"0";break;case"e":c="Error",p=en[t.v];break;case"d":c="DateTime",p=new Date(t.v).toISOString(),null==t.z&&(t.z=t.z||U._table[14]);break;case"s":c="String",p=Kt(t.v||"");break}var h=rp(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var g=null!=t.v?p:"",f='<Data ss:Type="'+c+'">'+g+"</Data>";return(t.c||[]).length>0&&(f+=Zg(t.c)),pe("Cell",f,o)}function tf(t,e){var a='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=_l(e.hpt)),e.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(a+=' ss:Hidden="1"')),a+">"}function ef(t,e,a,n){if(!t["!ref"])return"";var i=wa(t["!ref"]),r=t["!merges"]||[],s=0,o=[];t["!cols"]&&t["!cols"].forEach((function(t,e){ml(t);var a=!!t.width,n=np(e,t),i={"ss:Index":e+1};a&&(i["ss:Width"]=cl(n.width)),t.hidden&&(i["ss:Hidden"]="1"),o.push(pe("Column",null,i))}));for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var d=[tf(u,(t["!rows"]||[])[u])],c=i.s.c;c<=i.e.c;++c){var p=!1;for(s=0;s!=r.length;++s)if(!(r[s].s.c>c)&&!(r[s].s.r>u)&&!(r[s].e.c<c)&&!(r[s].e.r<u)){r[s].s.c==c&&r[s].s.r==u||(p=!0);break}if(!p){var h={r:u,c:c},g=_a(h),f=l?(t[u]||[])[c]:t[g];d.push(Qg(f,g,t,e,a,n,h))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function af(t,e,a){var n=[],i=a.SheetNames[t],r=a.Sheets[i],s=r?Yg(r,e,t,a):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=r?ef(r,e,t,a):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Jg(r,e,t,a)),n.join("")}function nf(t,e){e||(e={}),t.SSF||(t.SSF=U.get_table()),t.SSF&&(F(U),U.load_table(t.SSF),e.revssf=at(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],rp(e.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(Vg(t,e)),a.push(qg(t,e)),a.push(""),a.push("");for(var n=0;n<t.SheetNames.length;++n)a.push(pe("Worksheet",af(n,e,t),{"ss:Name":zt(t.SheetNames[n])}));return a[2]=Gg(t,e),a[3]=Xg(t,e),Nt+pe("Workbook",a.join(""),{xmlns:me.ss,"xmlns:o":me.o,"xmlns:x":me.x,"xmlns:ss":me.ss,"xmlns:dt":me.dt,"xmlns:html":me.html})}function rf(t){var e={},a=t.content;if(a.l=28,e.AnsiUserType=a._R(0,"lpstr-ansi"),e.AnsiClipboardFormat=un(a),a.length-a.l<=4)return e;var n=a._R(4);return 0==n||n>40?e:(a.l-=4,e.Reserved1=a._R(0,"lpstr-ansi"),a.length-a.l<=4?e:(n=a._R(4),1907505652!==n?e:(e.UnicodeClipboardFormat=dn(a),n=a._R(4),0==n||n>40?e:(a.l-=4,void(e.Reserved2=a._R(0,"lpwstr"))))))}function sf(t,e,a,n){var i=a,r=[],s=e.slice(e.l,e.l+i);if(n&&n.enc&&n.enc.insitu)switch(t.n){case"BOF":case"FilePass":case"FileLock":case"InterfaceHdr":case"RRDInfo":case"RRDHead":case"UsrExcl":break;default:if(0===s.length)break;n.enc.insitu(s)}r.push(s),e.l+=i;var o=vf[He(e,e.l)],l=0;while(null!=o&&"Continue"===o.n.slice(0,8))i=He(e,e.l+2),l=e.l+4,"ContinueFrt"==o.n?l+=4:"ContinueFrt"==o.n.slice(0,11)&&(l+=12),r.push(e.slice(l,e.l+4+i)),e.l+=4+i,o=vf[He(e,e.l)];var u=O(r);Ze(u,0);var d=0;u.lens=[];for(var c=0;c<r.length;++c)u.lens.push(d),d+=r[c].length;return t.f(u,u.length,n)}function of(t,e,a){if("z"!==t.t&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=U._table[n])}catch(u){if(e.WTF)throw u}if(!e||!1!==e.cellText)try{"e"===t.t?t.w=t.w||en[t.v]:0===n||"General"==n?"n"===t.t?(0|t.v)===t.v?t.w=U._general_int(t.v):t.w=U._general_num(t.v):t.w=U._general(t.v):t.w=U.format(n,t.v,{date1904:!!a})}catch(u){if(e.WTF)throw u}if(e.cellDates&&n&&"n"==t.t&&U.is_date(U._table[n]||String(n))){var i=U.parse_date_code(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function lf(t,e,a){return{v:t,ixfe:e,t:a}}function uf(t,e){var a={opts:{}},n={};null!=C&&null==e.dense&&(e.dense=C);var i,r,s,o,l,u,d,c,p=e.dense?[]:{},h={},f={},m=null,v=[],b="",y={},_="",D={},w=[],x=!0,k=[],S=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},T=function(t){return t<8?Nn[t]:t<64&&S[t-8]||Nn[t]},I=function(t,e,a){var n,i=e.XF.data;i&&i.patternType&&a&&a.cellStyles&&(e.s={},e.s.patternType=i.patternType,(n=nl(T(i.icvFore)))&&(e.s.fgColor={rgb:n}),(n=nl(T(i.icvBack)))&&(e.s.bgColor={rgb:n}))},P=function(t,e,a){if(!(j>1)&&(a.sheetRows&&t.r>=a.sheetRows&&(x=!1),x)){if(a.cellStyles&&e.XF&&e.XF.data&&I(t,e,a),delete e.ixfe,delete e.XF,i=t,_=_a(t),f&&f.s&&f.e||(f={s:{r:0,c:0},e:{r:0,c:0}}),t.r<f.s.r&&(f.s.r=t.r),t.c<f.s.c&&(f.s.c=t.c),t.r+1>f.e.r&&(f.e.r=t.r+1),t.c+1>f.e.c&&(f.e.c=t.c+1),a.cellFormula&&e.f)for(var n=0;n<w.length;++n)if(!(w[n][0].s.c>t.c||w[n][0].s.r>t.r)&&!(w[n][0].e.c<t.c||w[n][0].e.r<t.r)){e.F=Ca(w[n][0]),w[n][0].s.c==t.c&&w[n][0].s.r==t.r||delete e.f,e.f&&(e.f=""+Rc(w[n][1],f,t,F,N));break}a.dense?(p[t.r]||(p[t.r]=[]),p[t.r][t.c]=e):p[_]=e}},N={enc:!1,sbcch:0,snames:[],sharedf:D,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var R=[],B=[],O=[],M=[],L=!1,F=[];F.SheetNames=N.snames,F.sharedf=N.sharedf,F.arrayf=N.arrayf,F.names=[],F.XTI=[];var $,H="",j=0,W=0,z=[],V=[];N.codepage=1200,g(1200);var q=!1;while(t.l<t.length-1){var G=t.l,K=t._R(2);if(0===K&&"EOF"===H)break;var X=t.l===t.length?0:t._R(2),Y=vf[K];if(Y&&Y.f){if(e.bookSheets&&"BoundSheet8"===H&&"BoundSheet8"!==Y.n)break;if(H=Y.n,2===Y.r||12==Y.r){var J=t._R(2);if(X-=2,!N.enc&&J!==K&&((255&J)<<8|J>>8)!==K)throw new Error("rt mismatch: "+J+"!="+K);12==Y.r&&(t.l+=10,X-=10)}var Z;Z="EOF"===Y.n?Y.f(t,X,N):sf(Y,t,X,N);var tt=Y.n;if(0==j&&"BOF"!=tt)continue;switch(tt){case"Date1904":a.opts.Date1904=A.WBProps.date1904=Z;break;case"WriteProtect":a.opts.WriteProtect=!0;break;case"FilePass":if(N.enc||(t.l=0),N.enc=Z,!e.password)throw new Error("File is password-protected");if(null==Z.valid)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case"WriteAccess":N.lastuser=Z;break;case"FileSharing":break;case"CodePage":switch(Z){case 21010:Z=1200;break;case 32768:Z=1e4;break;case 32769:Z=1252;break}g(N.codepage=Z),q=!0;break;case"RRTabId":N.rrtabid=Z;break;case"WinProtect":N.winlocked=Z;break;case"Template":break;case"BookBool":break;case"UsesELFs":break;case"MTRSettings":break;case"RefreshAll":case"CalcCount":case"CalcDelta":case"CalcIter":case"CalcMode":case"CalcPrecision":case"CalcSaveRecalc":a.opts[tt]=Z;break;case"CalcRefMode":N.CalcRefMode=Z;break;case"Uncalced":break;case"ForceFullCalculation":a.opts.FullCalc=Z;break;case"WsBool":Z.fDialog&&(p["!type"]="dialog");break;case"XF":k.push(Z);break;case"ExtSST":break;case"BookExt":break;case"RichTextStream":break;case"BkHim":break;case"SupBook":F.push([Z]),F[F.length-1].XTI=[];break;case"ExternName":F[F.length-1].push(Z);break;case"Index":break;case"Lbl":$={Name:Z.Name,Ref:Rc(Z.rgce,f,null,F,N)},Z.itab>0&&($.Sheet=Z.itab-1),F.names.push($),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(Z),"_xlnm._FilterDatabase"==Z.Name&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&"PtgArea3d"==Z.rgce[0][0][0]&&(V[Z.itab-1]={ref:Ca(Z.rgce[0][0][1][2])});break;case"ExternCount":N.ExternCount=Z;break;case"ExternSheet":0==F.length&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(Z),F.XTI=F.XTI.concat(Z);break;case"NameCmt":if(N.biff<8)break;null!=$&&($.Comment=Z[1]);break;case"Protect":p["!protect"]=Z;break;case"Password":0!==Z&&N.WTF&&console.error("Password verifier: "+Z);break;case"Prot4Rev":case"Prot4RevPass":break;case"BoundSheet8":h[Z.pos]=Z,N.snames.push(Z.name);break;case"EOF":if(--j)break;if(f.e){if(f.e.r>0&&f.e.c>0){if(f.e.r--,f.e.c--,p["!ref"]=Ca(f),e.sheetRows&&e.sheetRows<=f.e.r){var et=f.e.r;f.e.r=e.sheetRows-1,p["!fullref"]=p["!ref"],p["!ref"]=Ca(f),f.e.r=et}f.e.r++,f.e.c++}R.length>0&&(p["!merges"]=R),B.length>0&&(p["!objects"]=B),O.length>0&&(p["!cols"]=O),M.length>0&&(p["!rows"]=M),A.Sheets.push(E)}""===b?y=p:n[b]=p,p=e.dense?[]:{};break;case"BOF":if(8===N.biff&&(N.biff={9:2,521:3,1033:4}[K]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),8==N.biff&&0==Z.BIFFVer&&16==Z.dt&&(N.biff=2),j++)break;if(x=!0,p=e.dense?[]:{},N.biff<8&&!q&&(q=!0,g(N.codepage=e.codepage||1252)),N.biff<5){""===b&&(b="Sheet1"),f={s:{r:0,c:0},e:{r:0,c:0}};var at={pos:t.l-X,name:b};h[at.pos]=at,N.snames.push(b)}else b=(h[G]||{name:""}).name;32==Z.dt&&(p["!type"]="chart"),64==Z.dt&&(p["!type"]="macro"),R=[],B=[],N.arrayf=w=[],O=[],M=[],0,L=!1,E={Hidden:(h[G]||{hs:0}).hs,name:b};break;case"Number":case"BIFF2NUM":case"BIFF2INT":"chart"==p["!type"]&&(e.dense?(p[Z.r]||[])[Z.c]:p[_a({c:Z.c,r:Z.r})])&&++Z.c,u={ixfe:Z.ixfe,XF:k[Z.ixfe]||{},v:Z.val,t:"n"},W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P({c:Z.c,r:Z.r},u,e);break;case"BoolErr":u={ixfe:Z.ixfe,XF:k[Z.ixfe],v:Z.val,t:Z.t},W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P({c:Z.c,r:Z.r},u,e);break;case"RK":u={ixfe:Z.ixfe,XF:k[Z.ixfe],v:Z.rknum,t:"n"},W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P({c:Z.c,r:Z.r},u,e);break;case"MulRk":for(var nt=Z.c;nt<=Z.C;++nt){var it=Z.rkrec[nt-Z.c][0];u={ixfe:it,XF:k[it],v:Z.rkrec[nt-Z.c][1],t:"n"},W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P({c:nt,r:Z.r},u,e)}break;case"Formula":if("String"==Z.val){m=Z;break}if(u=lf(Z.val,Z.cell.ixfe,Z.tt),u.XF=k[u.ixfe],e.cellFormula){var rt=Z.formula;if(rt&&rt[0]&&rt[0][0]&&"PtgExp"==rt[0][0][0]){var st=rt[0][0][1][0],ot=rt[0][0][1][1],lt=_a({r:st,c:ot});D[lt]?u.f=""+Rc(Z.formula,f,Z.cell,F,N):u.F=((e.dense?(p[st]||[])[ot]:p[lt])||{}).F}else u.f=""+Rc(Z.formula,f,Z.cell,F,N)}W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P(Z.cell,u,e),m=Z;break;case"String":if(!m)throw new Error("String record expects Formula");m.val=Z,u=lf(Z,m.cell.ixfe,"s"),u.XF=k[u.ixfe],e.cellFormula&&(u.f=""+Rc(m.formula,f,m.cell,F,N)),W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P(m.cell,u,e),m=null;break;case"Array":w.push(Z);var ut=_a(Z[0].s);if(r=e.dense?(p[Z[0].s.r]||[])[Z[0].s.c]:p[ut],e.cellFormula&&r){if(!m)break;if(!ut||!r)break;r.f=""+Rc(Z[1],f,Z[0],F,N),r.F=Ca(Z[0])}break;case"ShrFmla":if(!x)break;if(!e.cellFormula)break;if(_){if(!m)break;D[_a(m.cell)]=Z[0],r=e.dense?(p[m.cell.r]||[])[m.cell.c]:p[_a(m.cell)],(r||{}).f=""+Rc(Z[0],f,i,F,N)}break;case"LabelSst":u=lf(v[Z.isst].t,Z.ixfe,"s"),u.XF=k[u.ixfe],W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P({c:Z.c,r:Z.r},u,e);break;case"Blank":e.sheetStubs&&(u={ixfe:Z.ixfe,XF:k[Z.ixfe],t:"z"},W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P({c:Z.c,r:Z.r},u,e));break;case"MulBlank":if(e.sheetStubs)for(var dt=Z.c;dt<=Z.C;++dt){var ct=Z.ixfe[dt-Z.c];u={ixfe:ct,XF:k[ct],t:"z"},W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P({c:dt,r:Z.r},u,e)}break;case"RString":case"Label":case"BIFF2STR":u=lf(Z.val,Z.ixfe,"s"),u.XF=k[u.ixfe],W>0&&(u.z=z[u.ixfe>>8&31]),of(u,e,a.opts.Date1904),P({c:Z.c,r:Z.r},u,e);break;case"Dimensions":1===j&&(f=Z);break;case"SST":v=Z;break;case"Format":if(4==N.biff){z[W++]=Z[1];for(var pt=0;pt<W+163;++pt)if(U._table[pt]==Z[1])break;pt>=163&&U.load(Z[1],W+163)}else U.load(Z[1],Z[0]);break;case"BIFF2FORMAT":z[W++]=Z;for(var ht=0;ht<W+163;++ht)if(U._table[ht]==Z)break;ht>=163&&U.load(Z,W+163);break;case"MergeCells":R=R.concat(Z);break;case"Obj":B[Z.cmo[0]]=N.lastobj=Z;break;case"TxO":N.lastobj.TxO=Z;break;case"ImData":N.lastobj.ImData=Z;break;case"HLink":for(l=Z[0].s.r;l<=Z[0].e.r;++l)for(o=Z[0].s.c;o<=Z[0].e.c;++o)r=e.dense?(p[l]||[])[o]:p[_a({c:o,r:l})],r&&(r.l=Z[1]);break;case"HLinkTooltip":for(l=Z[0].s.r;l<=Z[0].e.r;++l)for(o=Z[0].s.c;o<=Z[0].e.c;++o)r=e.dense?(p[l]||[])[o]:p[_a({c:o,r:l})],r&&r.l&&(r.l.Tooltip=Z[1]);break;case"Note":if(N.biff<=5&&N.biff>=2)break;r=e.dense?(p[Z[0].r]||[])[Z[0].c]:p[_a(Z[0])];var gt=B[Z[2]];r||(e.dense?(p[Z[0].r]||(p[Z[0].r]=[]),r=p[Z[0].r][Z[0].c]={t:"z"}):r=p[_a(Z[0])]={t:"z"},f.e.r=Math.max(f.e.r,Z[0].r),f.s.r=Math.min(f.s.r,Z[0].r),f.e.c=Math.max(f.e.c,Z[0].c),f.s.c=Math.min(f.s.c,Z[0].c)),r.c||(r.c=[]),s={a:Z[1],t:gt.TxO.t},r.c.push(s);break;default:switch(Y.n){case"ClrtClient":break;case"XFExt":xu(k[Z.ixfe],Z.ext);break;case"DefColWidth":Z;break;case"DefaultRowHeight":Z[1];break;case"ColInfo":if(!N.cellStyles)break;while(Z.e>=Z.s)O[Z.e--]={width:Z.w/256},L||(L=!0,fl(Z.w/256)),ml(O[Z.e+1]);break;case"Row":var ft={};null!=Z.level&&(M[Z.r]=ft,ft.level=Z.level),Z.hidden&&(M[Z.r]=ft,ft.hidden=!0),Z.hpt&&(M[Z.r]=ft,ft.hpt=Z.hpt,ft.hpx=_l(Z.hpt));break;case"LeftMargin":case"RightMargin":case"TopMargin":case"BottomMargin":p["!margins"]||ip(p["!margins"]={}),p["!margins"][tt.slice(0,-6).toLowerCase()]=Z;break;case"Setup":p["!margins"]||ip(p["!margins"]={}),p["!margins"].header=Z.header,p["!margins"].footer=Z.footer;break;case"Window2":Z.RTL&&(A.Views[0].RTL=!0);break;case"Header":break;case"Footer":break;case"HCenter":break;case"VCenter":break;case"Pls":break;case"GCW":break;case"LHRecord":break;case"DBCell":break;case"EntExU2":break;case"SxView":break;case"Sxvd":break;case"SXVI":break;case"SXVDEx":break;case"SxIvd":break;case"SXString":break;case"Sync":break;case"Addin":break;case"SXDI":break;case"SXLI":break;case"SXEx":break;case"QsiSXTag":break;case"Selection":break;case"Feat":break;case"FeatHdr":case"FeatHdr11":break;case"Feature11":case"Feature12":case"List12":break;case"Country":d=Z;break;case"RecalcId":break;case"DxGCol":break;case"Fbi":case"Fbi2":case"GelFrame":break;case"Font":break;case"XFCRC":break;case"Style":break;case"StyleExt":break;case"Palette":S=Z;break;case"Theme":c=Z;break;case"ScenarioProtect":break;case"ObjProtect":break;case"CondFmt12":break;case"Table":break;case"TableStyles":break;case"TableStyle":break;case"TableStyleElement":break;case"SXStreamID":break;case"SXVS":break;case"DConRef":break;case"SXAddl":break;case"DConBin":break;case"DConName":break;case"SXPI":break;case"SxFormat":break;case"SxSelect":break;case"SxRule":break;case"SxFilt":break;case"SxItm":break;case"SxDXF":break;case"ScenMan":break;case"DCon":break;case"CellWatch":break;case"PrintRowCol":break;case"PrintGrid":break;case"PrintSize":break;case"XCT":break;case"CRN":break;case"Scl":break;case"SheetExt":break;case"SheetExtOptional":break;case"ObNoMacros":break;case"ObProj":break;case"CodeName":b?E.CodeName=Z||E.name:A.WBProps.CodeName=Z||"ThisWorkbook";break;case"GUIDTypeLib":break;case"WOpt":break;case"PhoneticInfo":break;case"OleObjectSize":break;case"DXF":case"DXFN":case"DXFN12":case"DXFN12List":case"DXFN12NoCB":break;case"Dv":case"DVal":break;case"BRAI":case"Series":case"SeriesText":break;case"DConn":break;case"DbOrParamQry":break;case"DBQueryExt":break;case"OleDbConn":break;case"ExtString":break;case"IFmtRecord":break;case"CondFmt":case"CF":case"CF12":case"CFEx":break;case"Excel9File":break;case"Units":break;case"InterfaceHdr":case"Mms":case"InterfaceEnd":case"DSF":break;case"BuiltInFnGroupCount":break;case"Window1":case"HideObj":case"GridSet":case"Guts":case"UserBView":case"UserSViewBegin":case"UserSViewEnd":case"Pane":break;default:switch(Y.n){case"Dat":case"Begin":case"End":case"StartBlock":case"EndBlock":case"Frame":case"Area":case"Axis":case"AxisLine":case"Tick":break;case"AxesUsed":case"CrtLayout12":case"CrtLayout12A":case"CrtLink":case"CrtLine":case"CrtMlFrt":case"CrtMlFrtContinue":break;case"LineFormat":case"AreaFormat":case"Chart":case"Chart3d":case"Chart3DBarShape":case"ChartFormat":case"ChartFrtInfo":break;case"PlotArea":case"PlotGrowth":break;case"SeriesList":case"SerParent":case"SerAuxTrend":break;case"DataFormat":case"SerToCrt":case"FontX":break;case"CatSerRange":case"AxcExt":case"SerFmt":break;case"ShtProps":break;case"DefaultText":case"Text":case"CatLab":break;case"DataLabExtContents":break;case"Legend":case"LegendException":break;case"Pie":case"Scatter":break;case"PieFormat":case"MarkerFormat":break;case"StartObject":case"EndObject":break;case"AlRuns":case"ObjectLink":break;case"SIIndex":break;case"AttachedLabel":case"YMult":break;case"Line":case"Bar":break;case"Surf":break;case"AxisParent":break;case"Pos":break;case"ValueRange":break;case"SXViewEx9":break;case"SXViewLink":break;case"PivotChartBits":break;case"SBaseRef":break;case"TextPropsStream":break;case"LnExt":break;case"MkrExt":break;case"CrtCoopt":break;case"Qsi":case"Qsif":case"Qsir":case"QsiSXTag":break;case"TxtQry":break;case"FilterMode":break;case"AutoFilter":case"AutoFilterInfo":break;case"AutoFilter12":break;case"DropDownObjIds":break;case"Sort":break;case"SortData":break;case"ShapePropsStream":break;case"MsoDrawing":case"MsoDrawingGroup":case"MsoDrawingSelection":break;case"WebPub":case"AutoWebPub":break;case"HeaderFooter":case"HFPicture":case"PLV":case"HorizontalPageBreaks":case"VerticalPageBreaks":break;case"Backup":case"CompressPictures":case"Compat12":break;case"Continue":case"ContinueFrt12":break;case"FrtFontList":case"FrtWrapper":break;default:switch(Y.n){case"TabIdConf":case"Radar":case"RadarArea":case"DropBar":case"Intl":case"CoordList":case"SerAuxErrBar":break;case"BIFF2FONTCLR":case"BIFF2FMTCNT":case"BIFF2FONTXTRA":break;case"BIFF2XF":case"BIFF3XF":case"BIFF4XF":break;case"BIFF4FMTCNT":case"BIFF2ROW":case"BIFF2WINDOW2":break;case"SCENARIO":case"DConBin":case"PicF":case"DataLabExt":case"Lel":case"BopPop":case"BopPopCustom":case"RealTimeData":case"Name":break;case"LHNGraph":case"FnGroupName":case"AddMenu":case"LPr":break;case"ListObj":case"ListField":break;case"RRSort":break;case"BigName":break;case"ToolbarHdr":case"ToolbarEnd":break;case"DDEObjName":break;case"FRTArchId$":break;default:if(e.WTF)throw"Unrecognized Record "+Y.n}}}}}else t.l+=X}return a.SheetNames=Q(h).sort((function(t,e){return Number(t)-Number(e)})).map((function(t){return h[t].name})),e.bookSheets||(a.Sheets=n),a.Sheets&&V.forEach((function(t,e){a.Sheets[a.SheetNames[e]]["!autofilter"]=t})),a.Preamble=y,a.Strings=v,a.SSF=U.get_table(),N.enc&&(a.Encryption=N.enc),c&&(a.Themes=c),a.Metadata={},void 0!==d&&(a.Metadata.Country=d),F.names.length>0&&(A.Names=F.names),a.Workbook=A,a}var df={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function cf(t,e,a){var n=X.find(t,"!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ji(n,xn,df.DSI);for(var r in i)e[r]=i[r]}catch(p){if(a.WTF)throw p}var s=X.find(t,"!SummaryInformation");if(s&&s.size>0)try{var o=ji(s,kn,df.SI);for(var l in o)null==e[l]&&(e[l]=o[l])}catch(p){if(a.WTF)throw p}e.HeadingPairs&&e.TitlesOfParts&&(li(e.HeadingPairs,e.TitlesOfParts,e,a),delete e.HeadingPairs,delete e.TitlesOfParts)}function pf(t,e){var a,n=[],i=[],r=[],s=0;if(t.Props)for(a=Q(t.Props),s=0;s<a.length;++s)(An.hasOwnProperty(a[s])?n:En.hasOwnProperty(a[s])?i:r).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Q(t.Custprops),s=0;s<a.length;++s)(t.Props||{}).hasOwnProperty(a[s])||(An.hasOwnProperty(a[s])?n:En.hasOwnProperty(a[s])?i:r).push([a[s],t.Custprops[a[s]]]);var o=[];for(s=0;s<r.length;++s)Fi.indexOf(r[s][0])>-1||null!=r[s][1]&&o.push(r[s]);i.length&&X.utils.cfb_add(e,"/SummaryInformation",Wi(i,df.SI,En,kn)),(n.length||o.length)&&X.utils.cfb_add(e,"/DocumentSummaryInformation",Wi(n,df.DSI,An,xn,o.length?o:null,df.UDI))}function hf(t,e){var a,n,i,r;if(e||(e={}),rm(e),f(),e.codepage&&p(e.codepage),t.FullPaths){if(X.find(t,"/encryption"))throw new Error("File is password-protected");a=X.find(t,"!CompObj"),n=X.find(t,"/Workbook")||X.find(t,"/Book")}else{switch(e.type){case"base64":t=I(x.decode(t));break;case"binary":t=I(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Ze(t,0),n={content:t}}if(a&&rf(a),e.bookProps&&!e.bookSheets)i={};else{var s=k?"buffer":"array";if(n&&n.content)i=uf(n.content,e);else if((r=X.find(t,"PerfectOffice_MAIN"))&&r.content)i=fo.to_workbook(r.content,(e.type=s,e));else{if(!(r=X.find(t,"NativeContent_MAIN"))||!r.content)throw new Error("Cannot find Workbook stream");i=fo.to_workbook(r.content,(e.type=s,e))}e.bookVBA&&t.FullPaths&&X.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=Vu(t))}var o={};return t.FullPaths&&cf(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function gf(t,e){var a=e||{},n=X.utils.cfb_new({root:"R"}),i="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":i="/Workbook",a.biff=8;break;case"biff5":i="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return X.utils.cfb_add(n,i,Of(t,a)),8==a.biff&&(t.Props||t.Custprops)&&pf(t,n),8==a.biff&&t.vbaraw&&qu(n,X.read(t.vbaraw,{type:"string"==typeof t.vbaraw?"binary":"buffer"})),n}var ff={0:{n:"BrtRowHdr",f:Lp},1:{n:"BrtCellBlank",f:Vp},2:{n:"BrtCellRk",f:th},3:{n:"BrtCellError",f:Xp},4:{n:"BrtCellBool",f:Gp},5:{n:"BrtCellReal",f:Zp},6:{n:"BrtCellSt",f:ah},7:{n:"BrtCellIsst",f:Yp},8:{n:"BrtFmlaString",f:oh},9:{n:"BrtFmlaNum",f:sh},10:{n:"BrtFmlaBool",f:ih},11:{n:"BrtFmlaError",f:rh},16:{n:"BrtFRTArchID$",f:og},19:{n:"BrtSSTItem",f:Ba},20:{n:"BrtPCDIMissing"},21:{n:"BrtPCDINumber"},22:{n:"BrtPCDIBoolean"},23:{n:"BrtPCDIError"},24:{n:"BrtPCDIString"},25:{n:"BrtPCDIDatetime"},26:{n:"BrtPCDIIndex"},27:{n:"BrtPCDIAMissing"},28:{n:"BrtPCDIANumber"},29:{n:"BrtPCDIABoolean"},30:{n:"BrtPCDIAError"},31:{n:"BrtPCDIAString"},32:{n:"BrtPCDIADatetime"},33:{n:"BrtPCRRecord"},34:{n:"BrtPCRRecordDt"},35:{n:"BrtFRTBegin"},36:{n:"BrtFRTEnd"},37:{n:"BrtACBegin"},38:{n:"BrtACEnd"},39:{n:"BrtName",f:lg},40:{n:"BrtIndexRowBlock"},42:{n:"BrtIndexBlock"},43:{n:"BrtFont",f:Ml},44:{n:"BrtFmt",f:Bl},45:{n:"BrtFill",f:$l},46:{n:"BrtBorder",f:Vl},47:{n:"BrtXF",f:jl},48:{n:"BrtStyle"},49:{n:"BrtCellMeta"},50:{n:"BrtValueMeta"},51:{n:"BrtMdb"},52:{n:"BrtBeginFmd"},53:{n:"BrtEndFmd"},54:{n:"BrtBeginMdx"},55:{n:"BrtEndMdx"},56:{n:"BrtBeginMdxTuple"},57:{n:"BrtEndMdxTuple"},58:{n:"BrtMdxMbrIstr"},59:{n:"BrtStr"},60:{n:"BrtColInfo",f:qs},62:{n:"BrtCellRString"},63:{n:"BrtCalcChainItem$",f:Su},64:{n:"BrtDVal"},65:{n:"BrtSxvcellNum"},66:{n:"BrtSxvcellStr"},67:{n:"BrtSxvcellBool"},68:{n:"BrtSxvcellErr"},69:{n:"BrtSxvcellDate"},70:{n:"BrtSxvcellNil"},128:{n:"BrtFileVersion"},129:{n:"BrtBeginSheet"},130:{n:"BrtEndSheet"},131:{n:"BrtBeginBook",f:Qe,p:0},132:{n:"BrtEndBook"},133:{n:"BrtBeginWsViews"},134:{n:"BrtEndWsViews"},135:{n:"BrtBeginBookViews"},136:{n:"BrtEndBookViews"},137:{n:"BrtBeginWsView",f:yh},138:{n:"BrtEndWsView"},139:{n:"BrtBeginCsViews"},140:{n:"BrtEndCsViews"},141:{n:"BrtBeginCsView"},142:{n:"BrtEndCsView"},143:{n:"BrtBeginBundleShs"},144:{n:"BrtEndBundleShs"},145:{n:"BrtBeginSheetData"},146:{n:"BrtEndSheetData"},147:{n:"BrtWsProp",f:Wp},148:{n:"BrtWsDim",f:$p,p:16},151:{n:"BrtPane"},152:{n:"BrtSel"},153:{n:"BrtWbProp",f:rg},154:{n:"BrtWbFactoid"},155:{n:"BrtFileRecover"},156:{n:"BrtBundleSh",f:ng},157:{n:"BrtCalcProp"},158:{n:"BrtBookView"},159:{n:"BrtBeginSst",f:Ao},160:{n:"BrtEndSst"},161:{n:"BrtBeginAFilter",f:Ja},162:{n:"BrtEndAFilter"},163:{n:"BrtBeginFilterColumn"},164:{n:"BrtEndFilterColumn"},165:{n:"BrtBeginFilters"},166:{n:"BrtEndFilters"},167:{n:"BrtFilter"},168:{n:"BrtColorFilter"},169:{n:"BrtIconFilter"},170:{n:"BrtTop10Filter"},171:{n:"BrtDynamicFilter"},172:{n:"BrtBeginCustomFilters"},173:{n:"BrtEndCustomFilters"},174:{n:"BrtCustomFilter"},175:{n:"BrtAFilterDateGroupItem"},176:{n:"BrtMergeCell",f:lh},177:{n:"BrtBeginMergeCells"},178:{n:"BrtEndMergeCells"},179:{n:"BrtBeginPivotCacheDef"},180:{n:"BrtEndPivotCacheDef"},181:{n:"BrtBeginPCDFields"},182:{n:"BrtEndPCDFields"},183:{n:"BrtBeginPCDField"},184:{n:"BrtEndPCDField"},185:{n:"BrtBeginPCDSource"},186:{n:"BrtEndPCDSource"},187:{n:"BrtBeginPCDSRange"},188:{n:"BrtEndPCDSRange"},189:{n:"BrtBeginPCDFAtbl"},190:{n:"BrtEndPCDFAtbl"},191:{n:"BrtBeginPCDIRun"},192:{n:"BrtEndPCDIRun"},193:{n:"BrtBeginPivotCacheRecords"},194:{n:"BrtEndPivotCacheRecords"},195:{n:"BrtBeginPCDHierarchies"},196:{n:"BrtEndPCDHierarchies"},197:{n:"BrtBeginPCDHierarchy"},198:{n:"BrtEndPCDHierarchy"},199:{n:"BrtBeginPCDHFieldsUsage"},200:{n:"BrtEndPCDHFieldsUsage"},201:{n:"BrtBeginExtConnection"},202:{n:"BrtEndExtConnection"},203:{n:"BrtBeginECDbProps"},204:{n:"BrtEndECDbProps"},205:{n:"BrtBeginECOlapProps"},206:{n:"BrtEndECOlapProps"},207:{n:"BrtBeginPCDSConsol"},208:{n:"BrtEndPCDSConsol"},209:{n:"BrtBeginPCDSCPages"},210:{n:"BrtEndPCDSCPages"},211:{n:"BrtBeginPCDSCPage"},212:{n:"BrtEndPCDSCPage"},213:{n:"BrtBeginPCDSCPItem"},214:{n:"BrtEndPCDSCPItem"},215:{n:"BrtBeginPCDSCSets"},216:{n:"BrtEndPCDSCSets"},217:{n:"BrtBeginPCDSCSet"},218:{n:"BrtEndPCDSCSet"},219:{n:"BrtBeginPCDFGroup"},220:{n:"BrtEndPCDFGroup"},221:{n:"BrtBeginPCDFGItems"},222:{n:"BrtEndPCDFGItems"},223:{n:"BrtBeginPCDFGRange"},224:{n:"BrtEndPCDFGRange"},225:{n:"BrtBeginPCDFGDiscrete"},226:{n:"BrtEndPCDFGDiscrete"},227:{n:"BrtBeginPCDSDTupleCache"},228:{n:"BrtEndPCDSDTupleCache"},229:{n:"BrtBeginPCDSDTCEntries"},230:{n:"BrtEndPCDSDTCEntries"},231:{n:"BrtBeginPCDSDTCEMembers"},232:{n:"BrtEndPCDSDTCEMembers"},233:{n:"BrtBeginPCDSDTCEMember"},234:{n:"BrtEndPCDSDTCEMember"},235:{n:"BrtBeginPCDSDTCQueries"},236:{n:"BrtEndPCDSDTCQueries"},237:{n:"BrtBeginPCDSDTCQuery"},238:{n:"BrtEndPCDSDTCQuery"},239:{n:"BrtBeginPCDSDTCSets"},240:{n:"BrtEndPCDSDTCSets"},241:{n:"BrtBeginPCDSDTCSet"},242:{n:"BrtEndPCDSDTCSet"},243:{n:"BrtBeginPCDCalcItems"},244:{n:"BrtEndPCDCalcItems"},245:{n:"BrtBeginPCDCalcItem"},246:{n:"BrtEndPCDCalcItem"},247:{n:"BrtBeginPRule"},248:{n:"BrtEndPRule"},249:{n:"BrtBeginPRFilters"},250:{n:"BrtEndPRFilters"},251:{n:"BrtBeginPRFilter"},252:{n:"BrtEndPRFilter"},253:{n:"BrtBeginPNames"},254:{n:"BrtEndPNames"},255:{n:"BrtBeginPName"},256:{n:"BrtEndPName"},257:{n:"BrtBeginPNPairs"},258:{n:"BrtEndPNPairs"},259:{n:"BrtBeginPNPair"},260:{n:"BrtEndPNPair"},261:{n:"BrtBeginECWebProps"},262:{n:"BrtEndECWebProps"},263:{n:"BrtBeginEcWpTables"},264:{n:"BrtEndECWPTables"},265:{n:"BrtBeginECParams"},266:{n:"BrtEndECParams"},267:{n:"BrtBeginECParam"},268:{n:"BrtEndECParam"},269:{n:"BrtBeginPCDKPIs"},270:{n:"BrtEndPCDKPIs"},271:{n:"BrtBeginPCDKPI"},272:{n:"BrtEndPCDKPI"},273:{n:"BrtBeginDims"},274:{n:"BrtEndDims"},275:{n:"BrtBeginDim"},276:{n:"BrtEndDim"},277:{n:"BrtIndexPartEnd"},278:{n:"BrtBeginStyleSheet"},279:{n:"BrtEndStyleSheet"},280:{n:"BrtBeginSXView"},281:{n:"BrtEndSXVI"},282:{n:"BrtBeginSXVI"},283:{n:"BrtBeginSXVIs"},284:{n:"BrtEndSXVIs"},285:{n:"BrtBeginSXVD"},286:{n:"BrtEndSXVD"},287:{n:"BrtBeginSXVDs"},288:{n:"BrtEndSXVDs"},289:{n:"BrtBeginSXPI"},290:{n:"BrtEndSXPI"},291:{n:"BrtBeginSXPIs"},292:{n:"BrtEndSXPIs"},293:{n:"BrtBeginSXDI"},294:{n:"BrtEndSXDI"},295:{n:"BrtBeginSXDIs"},296:{n:"BrtEndSXDIs"},297:{n:"BrtBeginSXLI"},298:{n:"BrtEndSXLI"},299:{n:"BrtBeginSXLIRws"},300:{n:"BrtEndSXLIRws"},301:{n:"BrtBeginSXLICols"},302:{n:"BrtEndSXLICols"},303:{n:"BrtBeginSXFormat"},304:{n:"BrtEndSXFormat"},305:{n:"BrtBeginSXFormats"},306:{n:"BrtEndSxFormats"},307:{n:"BrtBeginSxSelect"},308:{n:"BrtEndSxSelect"},309:{n:"BrtBeginISXVDRws"},310:{n:"BrtEndISXVDRws"},311:{n:"BrtBeginISXVDCols"},312:{n:"BrtEndISXVDCols"},313:{n:"BrtEndSXLocation"},314:{n:"BrtBeginSXLocation"},315:{n:"BrtEndSXView"},316:{n:"BrtBeginSXTHs"},317:{n:"BrtEndSXTHs"},318:{n:"BrtBeginSXTH"},319:{n:"BrtEndSXTH"},320:{n:"BrtBeginISXTHRws"},321:{n:"BrtEndISXTHRws"},322:{n:"BrtBeginISXTHCols"},323:{n:"BrtEndISXTHCols"},324:{n:"BrtBeginSXTDMPS"},325:{n:"BrtEndSXTDMPs"},326:{n:"BrtBeginSXTDMP"},327:{n:"BrtEndSXTDMP"},328:{n:"BrtBeginSXTHItems"},329:{n:"BrtEndSXTHItems"},330:{n:"BrtBeginSXTHItem"},331:{n:"BrtEndSXTHItem"},332:{n:"BrtBeginMetadata"},333:{n:"BrtEndMetadata"},334:{n:"BrtBeginEsmdtinfo"},335:{n:"BrtMdtinfo"},336:{n:"BrtEndEsmdtinfo"},337:{n:"BrtBeginEsmdb"},338:{n:"BrtEndEsmdb"},339:{n:"BrtBeginEsfmd"},340:{n:"BrtEndEsfmd"},341:{n:"BrtBeginSingleCells"},342:{n:"BrtEndSingleCells"},343:{n:"BrtBeginList"},344:{n:"BrtEndList"},345:{n:"BrtBeginListCols"},346:{n:"BrtEndListCols"},347:{n:"BrtBeginListCol"},348:{n:"BrtEndListCol"},349:{n:"BrtBeginListXmlCPr"},350:{n:"BrtEndListXmlCPr"},351:{n:"BrtListCCFmla"},352:{n:"BrtListTrFmla"},353:{n:"BrtBeginExternals"},354:{n:"BrtEndExternals"},355:{n:"BrtSupBookSrc",f:Va},357:{n:"BrtSupSelf"},358:{n:"BrtSupSame"},359:{n:"BrtSupTabs"},360:{n:"BrtBeginSupBook"},361:{n:"BrtPlaceholderName"},362:{n:"BrtExternSheet",f:ws},363:{n:"BrtExternTableStart"},364:{n:"BrtExternTableEnd"},366:{n:"BrtExternRowHdr"},367:{n:"BrtExternCellBlank"},368:{n:"BrtExternCellReal"},369:{n:"BrtExternCellBool"},370:{n:"BrtExternCellError"},371:{n:"BrtExternCellString"},372:{n:"BrtBeginEsmdx"},373:{n:"BrtEndEsmdx"},374:{n:"BrtBeginMdxSet"},375:{n:"BrtEndMdxSet"},376:{n:"BrtBeginMdxMbrProp"},377:{n:"BrtEndMdxMbrProp"},378:{n:"BrtBeginMdxKPI"},379:{n:"BrtEndMdxKPI"},380:{n:"BrtBeginEsstr"},381:{n:"BrtEndEsstr"},382:{n:"BrtBeginPRFItem"},383:{n:"BrtEndPRFItem"},384:{n:"BrtBeginPivotCacheIDs"},385:{n:"BrtEndPivotCacheIDs"},386:{n:"BrtBeginPivotCacheID"},387:{n:"BrtEndPivotCacheID"},388:{n:"BrtBeginISXVIs"},389:{n:"BrtEndISXVIs"},390:{n:"BrtBeginColInfos"},391:{n:"BrtEndColInfos"},392:{n:"BrtBeginRwBrk"},393:{n:"BrtEndRwBrk"},394:{n:"BrtBeginColBrk"},395:{n:"BrtEndColBrk"},396:{n:"BrtBrk"},397:{n:"BrtUserBookView"},398:{n:"BrtInfo"},399:{n:"BrtCUsr"},400:{n:"BrtUsr"},401:{n:"BrtBeginUsers"},403:{n:"BrtEOF"},404:{n:"BrtUCR"},405:{n:"BrtRRInsDel"},406:{n:"BrtRREndInsDel"},407:{n:"BrtRRMove"},408:{n:"BrtRREndMove"},409:{n:"BrtRRChgCell"},410:{n:"BrtRREndChgCell"},411:{n:"BrtRRHeader"},412:{n:"BrtRRUserView"},413:{n:"BrtRRRenSheet"},414:{n:"BrtRRInsertSh"},415:{n:"BrtRRDefName"},416:{n:"BrtRRNote"},417:{n:"BrtRRConflict"},418:{n:"BrtRRTQSIF"},419:{n:"BrtRRFormat"},420:{n:"BrtRREndFormat"},421:{n:"BrtRRAutoFmt"},422:{n:"BrtBeginUserShViews"},423:{n:"BrtBeginUserShView"},424:{n:"BrtEndUserShView"},425:{n:"BrtEndUserShViews"},426:{n:"BrtArrFmla",f:hh},427:{n:"BrtShrFmla",f:gh},428:{n:"BrtTable"},429:{n:"BrtBeginExtConnections"},430:{n:"BrtEndExtConnections"},431:{n:"BrtBeginPCDCalcMems"},432:{n:"BrtEndPCDCalcMems"},433:{n:"BrtBeginPCDCalcMem"},434:{n:"BrtEndPCDCalcMem"},435:{n:"BrtBeginPCDHGLevels"},436:{n:"BrtEndPCDHGLevels"},437:{n:"BrtBeginPCDHGLevel"},438:{n:"BrtEndPCDHGLevel"},439:{n:"BrtBeginPCDHGLGroups"},440:{n:"BrtEndPCDHGLGroups"},441:{n:"BrtBeginPCDHGLGroup"},442:{n:"BrtEndPCDHGLGroup"},443:{n:"BrtBeginPCDHGLGMembers"},444:{n:"BrtEndPCDHGLGMembers"},445:{n:"BrtBeginPCDHGLGMember"},446:{n:"BrtEndPCDHGLGMember"},447:{n:"BrtBeginQSI"},448:{n:"BrtEndQSI"},449:{n:"BrtBeginQSIR"},450:{n:"BrtEndQSIR"},451:{n:"BrtBeginDeletedNames"},452:{n:"BrtEndDeletedNames"},453:{n:"BrtBeginDeletedName"},454:{n:"BrtEndDeletedName"},455:{n:"BrtBeginQSIFs"},456:{n:"BrtEndQSIFs"},457:{n:"BrtBeginQSIF"},458:{n:"BrtEndQSIF"},459:{n:"BrtBeginAutoSortScope"},460:{n:"BrtEndAutoSortScope"},461:{n:"BrtBeginConditionalFormatting"},462:{n:"BrtEndConditionalFormatting"},463:{n:"BrtBeginCFRule"},464:{n:"BrtEndCFRule"},465:{n:"BrtBeginIconSet"},466:{n:"BrtEndIconSet"},467:{n:"BrtBeginDatabar"},468:{n:"BrtEndDatabar"},469:{n:"BrtBeginColorScale"},470:{n:"BrtEndColorScale"},471:{n:"BrtCFVO"},472:{n:"BrtExternValueMeta"},473:{n:"BrtBeginColorPalette"},474:{n:"BrtEndColorPalette"},475:{n:"BrtIndexedColor"},476:{n:"BrtMargins",f:vh},477:{n:"BrtPrintOptions"},478:{n:"BrtPageSetup"},479:{n:"BrtBeginHeaderFooter"},480:{n:"BrtEndHeaderFooter"},481:{n:"BrtBeginSXCrtFormat"},482:{n:"BrtEndSXCrtFormat"},483:{n:"BrtBeginSXCrtFormats"},484:{n:"BrtEndSXCrtFormats"},485:{n:"BrtWsFmtInfo",f:jp},486:{n:"BrtBeginMgs"},487:{n:"BrtEndMGs"},488:{n:"BrtBeginMGMaps"},489:{n:"BrtEndMGMaps"},490:{n:"BrtBeginMG"},491:{n:"BrtEndMG"},492:{n:"BrtBeginMap"},493:{n:"BrtEndMap"},494:{n:"BrtHLink",f:ch},495:{n:"BrtBeginDCon"},496:{n:"BrtEndDCon"},497:{n:"BrtBeginDRefs"},498:{n:"BrtEndDRefs"},499:{n:"BrtDRef"},500:{n:"BrtBeginScenMan"},501:{n:"BrtEndScenMan"},502:{n:"BrtBeginSct"},503:{n:"BrtEndSct"},504:{n:"BrtSlc"},505:{n:"BrtBeginDXFs"},506:{n:"BrtEndDXFs"},507:{n:"BrtDXF"},508:{n:"BrtBeginTableStyles"},509:{n:"BrtEndTableStyles"},510:{n:"BrtBeginTableStyle"},511:{n:"BrtEndTableStyle"},512:{n:"BrtTableStyleElement"},513:{n:"BrtTableStyleClient"},514:{n:"BrtBeginVolDeps"},515:{n:"BrtEndVolDeps"},516:{n:"BrtBeginVolType"},517:{n:"BrtEndVolType"},518:{n:"BrtBeginVolMain"},519:{n:"BrtEndVolMain"},520:{n:"BrtBeginVolTopic"},521:{n:"BrtEndVolTopic"},522:{n:"BrtVolSubtopic"},523:{n:"BrtVolRef"},524:{n:"BrtVolNum"},525:{n:"BrtVolErr"},526:{n:"BrtVolStr"},527:{n:"BrtVolBool"},528:{n:"BrtBeginCalcChain$"},529:{n:"BrtEndCalcChain$"},530:{n:"BrtBeginSortState"},531:{n:"BrtEndSortState"},532:{n:"BrtBeginSortCond"},533:{n:"BrtEndSortCond"},534:{n:"BrtBookProtection"},535:{n:"BrtSheetProtection"},536:{n:"BrtRangeProtection"},537:{n:"BrtPhoneticInfo"},538:{n:"BrtBeginECTxtWiz"},539:{n:"BrtEndECTxtWiz"},540:{n:"BrtBeginECTWFldInfoLst"},541:{n:"BrtEndECTWFldInfoLst"},542:{n:"BrtBeginECTwFldInfo"},548:{n:"BrtFileSharing"},549:{n:"BrtOleSize"},550:{n:"BrtDrawing",f:Va},551:{n:"BrtLegacyDrawing"},552:{n:"BrtLegacyDrawingHF"},553:{n:"BrtWebOpt"},554:{n:"BrtBeginWebPubItems"},555:{n:"BrtEndWebPubItems"},556:{n:"BrtBeginWebPubItem"},557:{n:"BrtEndWebPubItem"},558:{n:"BrtBeginSXCondFmt"},559:{n:"BrtEndSXCondFmt"},560:{n:"BrtBeginSXCondFmts"},561:{n:"BrtEndSXCondFmts"},562:{n:"BrtBkHim"},564:{n:"BrtColor"},565:{n:"BrtBeginIndexedColors"},566:{n:"BrtEndIndexedColors"},569:{n:"BrtBeginMRUColors"},570:{n:"BrtEndMRUColors"},572:{n:"BrtMRUColor"},573:{n:"BrtBeginDVals"},574:{n:"BrtEndDVals"},577:{n:"BrtSupNameStart"},578:{n:"BrtSupNameValueStart"},579:{n:"BrtSupNameValueEnd"},580:{n:"BrtSupNameNum"},581:{n:"BrtSupNameErr"},582:{n:"BrtSupNameSt"},583:{n:"BrtSupNameNil"},584:{n:"BrtSupNameBool"},585:{n:"BrtSupNameFmla"},586:{n:"BrtSupNameBits"},587:{n:"BrtSupNameEnd"},588:{n:"BrtEndSupBook"},589:{n:"BrtCellSmartTagProperty"},590:{n:"BrtBeginCellSmartTag"},591:{n:"BrtEndCellSmartTag"},592:{n:"BrtBeginCellSmartTags"},593:{n:"BrtEndCellSmartTags"},594:{n:"BrtBeginSmartTags"},595:{n:"BrtEndSmartTags"},596:{n:"BrtSmartTagType"},597:{n:"BrtBeginSmartTagTypes"},598:{n:"BrtEndSmartTagTypes"},599:{n:"BrtBeginSXFilters"},600:{n:"BrtEndSXFilters"},601:{n:"BrtBeginSXFILTER"},602:{n:"BrtEndSXFilter"},603:{n:"BrtBeginFills"},604:{n:"BrtEndFills"},605:{n:"BrtBeginCellWatches"},606:{n:"BrtEndCellWatches"},607:{n:"BrtCellWatch"},608:{n:"BrtBeginCRErrs"},609:{n:"BrtEndCRErrs"},610:{n:"BrtCrashRecErr"},611:{n:"BrtBeginFonts"},612:{n:"BrtEndFonts"},613:{n:"BrtBeginBorders"},614:{n:"BrtEndBorders"},615:{n:"BrtBeginFmts"},616:{n:"BrtEndFmts"},617:{n:"BrtBeginCellXFs"},618:{n:"BrtEndCellXFs"},619:{n:"BrtBeginStyles"},620:{n:"BrtEndStyles"},625:{n:"BrtBigName"},626:{n:"BrtBeginCellStyleXFs"},627:{n:"BrtEndCellStyleXFs"},628:{n:"BrtBeginComments"},629:{n:"BrtEndComments"},630:{n:"BrtBeginCommentAuthors"},631:{n:"BrtEndCommentAuthors"},632:{n:"BrtCommentAuthor",f:$u},633:{n:"BrtBeginCommentList"},634:{n:"BrtEndCommentList"},635:{n:"BrtBeginComment",f:Uu},636:{n:"BrtEndComment"},637:{n:"BrtCommentText",f:Ma},638:{n:"BrtBeginOleObjects"},639:{n:"BrtOleObject"},640:{n:"BrtEndOleObjects"},641:{n:"BrtBeginSxrules"},642:{n:"BrtEndSxRules"},643:{n:"BrtBeginActiveXControls"},644:{n:"BrtActiveX"},645:{n:"BrtEndActiveXControls"},646:{n:"BrtBeginPCDSDTCEMembersSortBy"},648:{n:"BrtBeginCellIgnoreECs"},649:{n:"BrtCellIgnoreEC"},650:{n:"BrtEndCellIgnoreECs"},651:{n:"BrtCsProp",f:Fh},652:{n:"BrtCsPageSetup"},653:{n:"BrtBeginUserCsViews"},654:{n:"BrtEndUserCsViews"},655:{n:"BrtBeginUserCsView"},656:{n:"BrtEndUserCsView"},657:{n:"BrtBeginPcdSFCIEntries"},658:{n:"BrtEndPCDSFCIEntries"},659:{n:"BrtPCDSFCIEntry"},660:{n:"BrtBeginListParts"},661:{n:"BrtListPart"},662:{n:"BrtEndListParts"},663:{n:"BrtSheetCalcProp"},664:{n:"BrtBeginFnGroup"},665:{n:"BrtFnGroup"},666:{n:"BrtEndFnGroup"},667:{n:"BrtSupAddin"},668:{n:"BrtSXTDMPOrder"},669:{n:"BrtCsProtection"},671:{n:"BrtBeginWsSortMap"},672:{n:"BrtEndWsSortMap"},673:{n:"BrtBeginRRSort"},674:{n:"BrtEndRRSort"},675:{n:"BrtRRSortItem"},676:{n:"BrtFileSharingIso"},677:{n:"BrtBookProtectionIso"},678:{n:"BrtSheetProtectionIso"},679:{n:"BrtCsProtectionIso"},680:{n:"BrtRangeProtectionIso"},1024:{n:"BrtRwDescent"},1025:{n:"BrtKnownFonts"},1026:{n:"BrtBeginSXTupleSet"},1027:{n:"BrtEndSXTupleSet"},1028:{n:"BrtBeginSXTupleSetHeader"},1029:{n:"BrtEndSXTupleSetHeader"},1030:{n:"BrtSXTupleSetHeaderItem"},1031:{n:"BrtBeginSXTupleSetData"},1032:{n:"BrtEndSXTupleSetData"},1033:{n:"BrtBeginSXTupleSetRow"},1034:{n:"BrtEndSXTupleSetRow"},1035:{n:"BrtSXTupleSetRowItem"},1036:{n:"BrtNameExt"},1037:{n:"BrtPCDH14"},1038:{n:"BrtBeginPCDCalcMem14"},1039:{n:"BrtEndPCDCalcMem14"},1040:{n:"BrtSXTH14"},1041:{n:"BrtBeginSparklineGroup"},1042:{n:"BrtEndSparklineGroup"},1043:{n:"BrtSparkline"},1044:{n:"BrtSXDI14"},1045:{n:"BrtWsFmtInfoEx14"},1046:{n:"BrtBeginConditionalFormatting14"},1047:{n:"BrtEndConditionalFormatting14"},1048:{n:"BrtBeginCFRule14"},1049:{n:"BrtEndCFRule14"},1050:{n:"BrtCFVO14"},1051:{n:"BrtBeginDatabar14"},1052:{n:"BrtBeginIconSet14"},1053:{n:"BrtDVal14"},1054:{n:"BrtBeginDVals14"},1055:{n:"BrtColor14"},1056:{n:"BrtBeginSparklines"},1057:{n:"BrtEndSparklines"},1058:{n:"BrtBeginSparklineGroups"},1059:{n:"BrtEndSparklineGroups"},1061:{n:"BrtSXVD14"},1062:{n:"BrtBeginSXView14"},1063:{n:"BrtEndSXView14"},1064:{n:"BrtBeginSXView16"},1065:{n:"BrtEndSXView16"},1066:{n:"BrtBeginPCD14"},1067:{n:"BrtEndPCD14"},1068:{n:"BrtBeginExtConn14"},1069:{n:"BrtEndExtConn14"},1070:{n:"BrtBeginSlicerCacheIDs"},1071:{n:"BrtEndSlicerCacheIDs"},1072:{n:"BrtBeginSlicerCacheID"},1073:{n:"BrtEndSlicerCacheID"},1075:{n:"BrtBeginSlicerCache"},1076:{n:"BrtEndSlicerCache"},1077:{n:"BrtBeginSlicerCacheDef"},1078:{n:"BrtEndSlicerCacheDef"},1079:{n:"BrtBeginSlicersEx"},1080:{n:"BrtEndSlicersEx"},1081:{n:"BrtBeginSlicerEx"},1082:{n:"BrtEndSlicerEx"},1083:{n:"BrtBeginSlicer"},1084:{n:"BrtEndSlicer"},1085:{n:"BrtSlicerCachePivotTables"},1086:{n:"BrtBeginSlicerCacheOlapImpl"},1087:{n:"BrtEndSlicerCacheOlapImpl"},1088:{n:"BrtBeginSlicerCacheLevelsData"},1089:{n:"BrtEndSlicerCacheLevelsData"},1090:{n:"BrtBeginSlicerCacheLevelData"},1091:{n:"BrtEndSlicerCacheLevelData"},1092:{n:"BrtBeginSlicerCacheSiRanges"},1093:{n:"BrtEndSlicerCacheSiRanges"},1094:{n:"BrtBeginSlicerCacheSiRange"},1095:{n:"BrtEndSlicerCacheSiRange"},1096:{n:"BrtSlicerCacheOlapItem"},1097:{n:"BrtBeginSlicerCacheSelections"},1098:{n:"BrtSlicerCacheSelection"},1099:{n:"BrtEndSlicerCacheSelections"},1100:{n:"BrtBeginSlicerCacheNative"},1101:{n:"BrtEndSlicerCacheNative"},1102:{n:"BrtSlicerCacheNativeItem"},1103:{n:"BrtRangeProtection14"},1104:{n:"BrtRangeProtectionIso14"},1105:{n:"BrtCellIgnoreEC14"},1111:{n:"BrtList14"},1112:{n:"BrtCFIcon"},1113:{n:"BrtBeginSlicerCachesPivotCacheIDs"},1114:{n:"BrtEndSlicerCachesPivotCacheIDs"},1115:{n:"BrtBeginSlicers"},1116:{n:"BrtEndSlicers"},1117:{n:"BrtWbProp14"},1118:{n:"BrtBeginSXEdit"},1119:{n:"BrtEndSXEdit"},1120:{n:"BrtBeginSXEdits"},1121:{n:"BrtEndSXEdits"},1122:{n:"BrtBeginSXChange"},1123:{n:"BrtEndSXChange"},1124:{n:"BrtBeginSXChanges"},1125:{n:"BrtEndSXChanges"},1126:{n:"BrtSXTupleItems"},1128:{n:"BrtBeginSlicerStyle"},1129:{n:"BrtEndSlicerStyle"},1130:{n:"BrtSlicerStyleElement"},1131:{n:"BrtBeginStyleSheetExt14"},1132:{n:"BrtEndStyleSheetExt14"},1133:{n:"BrtBeginSlicerCachesPivotCacheID"},1134:{n:"BrtEndSlicerCachesPivotCacheID"},1135:{n:"BrtBeginConditionalFormattings"},1136:{n:"BrtEndConditionalFormattings"},1137:{n:"BrtBeginPCDCalcMemExt"},1138:{n:"BrtEndPCDCalcMemExt"},1139:{n:"BrtBeginPCDCalcMemsExt"},1140:{n:"BrtEndPCDCalcMemsExt"},1141:{n:"BrtPCDField14"},1142:{n:"BrtBeginSlicerStyles"},1143:{n:"BrtEndSlicerStyles"},1144:{n:"BrtBeginSlicerStyleElements"},1145:{n:"BrtEndSlicerStyleElements"},1146:{n:"BrtCFRuleExt"},1147:{n:"BrtBeginSXCondFmt14"},1148:{n:"BrtEndSXCondFmt14"},1149:{n:"BrtBeginSXCondFmts14"},1150:{n:"BrtEndSXCondFmts14"},1152:{n:"BrtBeginSortCond14"},1153:{n:"BrtEndSortCond14"},1154:{n:"BrtEndDVals14"},1155:{n:"BrtEndIconSet14"},1156:{n:"BrtEndDatabar14"},1157:{n:"BrtBeginColorScale14"},1158:{n:"BrtEndColorScale14"},1159:{n:"BrtBeginSxrules14"},1160:{n:"BrtEndSxrules14"},1161:{n:"BrtBeginPRule14"},1162:{n:"BrtEndPRule14"},1163:{n:"BrtBeginPRFilters14"},1164:{n:"BrtEndPRFilters14"},1165:{n:"BrtBeginPRFilter14"},1166:{n:"BrtEndPRFilter14"},1167:{n:"BrtBeginPRFItem14"},1168:{n:"BrtEndPRFItem14"},1169:{n:"BrtBeginCellIgnoreECs14"},1170:{n:"BrtEndCellIgnoreECs14"},1171:{n:"BrtDxf14"},1172:{n:"BrtBeginDxF14s"},1173:{n:"BrtEndDxf14s"},1177:{n:"BrtFilter14"},1178:{n:"BrtBeginCustomFilters14"},1180:{n:"BrtCustomFilter14"},1181:{n:"BrtIconFilter14"},1182:{n:"BrtPivotCacheConnectionName"},2048:{n:"BrtBeginDecoupledPivotCacheIDs"},2049:{n:"BrtEndDecoupledPivotCacheIDs"},2050:{n:"BrtDecoupledPivotCacheID"},2051:{n:"BrtBeginPivotTableRefs"},2052:{n:"BrtEndPivotTableRefs"},2053:{n:"BrtPivotTableRef"},2054:{n:"BrtSlicerCacheBookPivotTables"},2055:{n:"BrtBeginSxvcells"},2056:{n:"BrtEndSxvcells"},2057:{n:"BrtBeginSxRow"},2058:{n:"BrtEndSxRow"},2060:{n:"BrtPcdCalcMem15"},2067:{n:"BrtQsi15"},2068:{n:"BrtBeginWebExtensions"},2069:{n:"BrtEndWebExtensions"},2070:{n:"BrtWebExtension"},2071:{n:"BrtAbsPath15"},2072:{n:"BrtBeginPivotTableUISettings"},2073:{n:"BrtEndPivotTableUISettings"},2075:{n:"BrtTableSlicerCacheIDs"},2076:{n:"BrtTableSlicerCacheID"},2077:{n:"BrtBeginTableSlicerCache"},2078:{n:"BrtEndTableSlicerCache"},2079:{n:"BrtSxFilter15"},2080:{n:"BrtBeginTimelineCachePivotCacheIDs"},2081:{n:"BrtEndTimelineCachePivotCacheIDs"},2082:{n:"BrtTimelineCachePivotCacheID"},2083:{n:"BrtBeginTimelineCacheIDs"},2084:{n:"BrtEndTimelineCacheIDs"},2085:{n:"BrtBeginTimelineCacheID"},2086:{n:"BrtEndTimelineCacheID"},2087:{n:"BrtBeginTimelinesEx"},2088:{n:"BrtEndTimelinesEx"},2089:{n:"BrtBeginTimelineEx"},2090:{n:"BrtEndTimelineEx"},2091:{n:"BrtWorkBookPr15"},2092:{n:"BrtPCDH15"},2093:{n:"BrtBeginTimelineStyle"},2094:{n:"BrtEndTimelineStyle"},2095:{n:"BrtTimelineStyleElement"},2096:{n:"BrtBeginTimelineStylesheetExt15"},2097:{n:"BrtEndTimelineStylesheetExt15"},2098:{n:"BrtBeginTimelineStyles"},2099:{n:"BrtEndTimelineStyles"},2100:{n:"BrtBeginTimelineStyleElements"},2101:{n:"BrtEndTimelineStyleElements"},2102:{n:"BrtDxf15"},2103:{n:"BrtBeginDxfs15"},2104:{n:"brtEndDxfs15"},2105:{n:"BrtSlicerCacheHideItemsWithNoData"},2106:{n:"BrtBeginItemUniqueNames"},2107:{n:"BrtEndItemUniqueNames"},2108:{n:"BrtItemUniqueName"},2109:{n:"BrtBeginExtConn15"},2110:{n:"BrtEndExtConn15"},2111:{n:"BrtBeginOledbPr15"},2112:{n:"BrtEndOledbPr15"},2113:{n:"BrtBeginDataFeedPr15"},2114:{n:"BrtEndDataFeedPr15"},2115:{n:"BrtTextPr15"},2116:{n:"BrtRangePr15"},2117:{n:"BrtDbCommand15"},2118:{n:"BrtBeginDbTables15"},2119:{n:"BrtEndDbTables15"},2120:{n:"BrtDbTable15"},2121:{n:"BrtBeginDataModel"},2122:{n:"BrtEndDataModel"},2123:{n:"BrtBeginModelTables"},2124:{n:"BrtEndModelTables"},2125:{n:"BrtModelTable"},2126:{n:"BrtBeginModelRelationships"},2127:{n:"BrtEndModelRelationships"},2128:{n:"BrtModelRelationship"},2129:{n:"BrtBeginECTxtWiz15"},2130:{n:"BrtEndECTxtWiz15"},2131:{n:"BrtBeginECTWFldInfoLst15"},2132:{n:"BrtEndECTWFldInfoLst15"},2133:{n:"BrtBeginECTWFldInfo15"},2134:{n:"BrtFieldListActiveItem"},2135:{n:"BrtPivotCacheIdVersion"},2136:{n:"BrtSXDI15"},2137:{n:"BrtBeginModelTimeGroupings"},2138:{n:"BrtEndModelTimeGroupings"},2139:{n:"BrtBeginModelTimeGrouping"},2140:{n:"BrtEndModelTimeGrouping"},2141:{n:"BrtModelTimeGroupingCalcCol"},3072:{n:"BrtUid"},3073:{n:"BrtRevisionPtr"},5095:{n:"BrtBeginCalcFeatures"},5096:{n:"BrtEndCalcFeatures"},5097:{n:"BrtCalcFeature"},65535:{n:""}},mf=tt(ff,"n"),vf={3:{n:"BIFF2NUM",f:eo},4:{n:"BIFF2STR",f:to},6:{n:"Formula",f:Fc},9:{n:"BOF",f:Nr},10:{n:"EOF",f:zi},12:{n:"CalcCount",f:Xi},13:{n:"CalcMode",f:Xi},14:{n:"CalcPrecision",f:Gi},15:{n:"CalcRefMode",f:Gi},16:{n:"CalcDelta",f:Qa},17:{n:"CalcIter",f:Gi},18:{n:"Protect",f:Gi},19:{n:"Password",f:Xi},20:{n:"Header",f:bs},21:{n:"Footer",f:bs},23:{n:"ExternSheet",f:ws},24:{n:"Lbl",f:Cs},25:{n:"WinProtect",f:Gi},26:{n:"VerticalPageBreaks"},27:{n:"HorizontalPageBreaks"},28:{n:"Note",f:Is},29:{n:"Selection"},34:{n:"Date1904",f:Gi},35:{n:"ExternName",f:_s},38:{n:"LeftMargin",f:Qa},39:{n:"RightMargin",f:Qa},40:{n:"TopMargin",f:Qa},41:{n:"BottomMargin",f:Qa},42:{n:"PrintRowCol",f:Gi},43:{n:"PrintGrid",f:Gi},47:{n:"FilePass",f:tl},49:{n:"Font",f:Yr},51:{n:"PrintSize",f:Xi},60:{n:"Continue"},61:{n:"Window1",f:qr},64:{n:"Backup",f:Gi},65:{n:"Pane"},66:{n:"CodePage",f:Xi},77:{n:"Pls"},80:{n:"DCon"},81:{n:"DConRef"},82:{n:"DConName"},85:{n:"DefColWidth",f:Xi},89:{n:"XCT"},90:{n:"CRN"},91:{n:"FileSharing"},92:{n:"WriteAccess",f:Or},93:{n:"Obj",f:Rs},94:{n:"Uncalced"},95:{n:"CalcSaveRecalc",f:Gi},96:{n:"Template"},97:{n:"Intl"},99:{n:"ObjProtect",f:Gi},125:{n:"ColInfo",f:qs},128:{n:"Guts",f:ps},129:{n:"WsBool",f:Lr},130:{n:"GridSet",f:Xi},131:{n:"HCenter",f:Gi},132:{n:"VCenter",f:Gi},133:{n:"BoundSheet8",f:Ur},134:{n:"WriteProtect"},140:{n:"Country",f:Hs},141:{n:"HideObj",f:Xi},144:{n:"Sort"},146:{n:"Palette",f:zs},151:{n:"Sync"},152:{n:"LPr"},153:{n:"DxGCol"},154:{n:"FnGroupName"},155:{n:"FilterMode"},156:{n:"BuiltInFnGroupCount",f:Xi},157:{n:"AutoFilterInfo"},158:{n:"AutoFilter"},160:{n:"Scl",f:Js},161:{n:"Setup",f:Gs},174:{n:"ScenMan"},175:{n:"SCENARIO"},176:{n:"SxView"},177:{n:"Sxvd"},178:{n:"SXVI"},180:{n:"SxIvd"},181:{n:"SXLI"},182:{n:"SXPI"},184:{n:"DocRoute"},185:{n:"RecipName"},189:{n:"MulRk",f:os},190:{n:"MulBlank",f:ls},193:{n:"Mms",f:zi},197:{n:"SXDI"},198:{n:"SXDB"},199:{n:"SXFDB"},200:{n:"SXDBB"},201:{n:"SXNum"},202:{n:"SxBool",f:Gi},203:{n:"SxErr"},204:{n:"SXInt"},205:{n:"SXString"},206:{n:"SXDtr"},207:{n:"SxNil"},208:{n:"SXTbl"},209:{n:"SXTBRGIITM"},210:{n:"SxTbpg"},211:{n:"ObProj"},213:{n:"SXStreamID"},215:{n:"DBCell"},216:{n:"SXRng"},217:{n:"SxIsxoper"},218:{n:"BookBool",f:Xi},220:{n:"DbOrParamQry"},221:{n:"ScenarioProtect",f:Gi},222:{n:"OleObjectSize"},224:{n:"XF",f:ds},225:{n:"InterfaceHdr",f:Br},226:{n:"InterfaceEnd",f:zi},227:{n:"SXVS"},229:{n:"MergeCells",f:Ps},233:{n:"BkHim"},235:{n:"MsoDrawingGroup"},236:{n:"MsoDrawing"},237:{n:"MsoDrawingSelection"},239:{n:"PhoneticInfo"},240:{n:"SxRule"},241:{n:"SXEx"},242:{n:"SxFilt"},244:{n:"SxDXF"},245:{n:"SxItm"},246:{n:"SxName"},247:{n:"SxSelect"},248:{n:"SXPair"},249:{n:"SxFmla"},251:{n:"SxFormat"},252:{n:"SST",f:$r},253:{n:"LabelSst",f:Zr},255:{n:"ExtSST",f:Hr},256:{n:"SXVDEx"},259:{n:"SXFormula"},290:{n:"SXDBEx"},311:{n:"RRDInsDel"},312:{n:"RRDHead"},315:{n:"RRDChgCell"},317:{n:"RRTabId",f:Ji},318:{n:"RRDRenSheet"},319:{n:"RRSort"},320:{n:"RRDMove"},330:{n:"RRFormat"},331:{n:"RRAutoFmt"},333:{n:"RRInsertSh"},334:{n:"RRDMoveBegin"},335:{n:"RRDMoveEnd"},336:{n:"RRDInsDelBegin"},337:{n:"RRDInsDelEnd"},338:{n:"RRDConflict"},339:{n:"RRDDefName"},340:{n:"RRDRstEtxp"},351:{n:"LRng"},352:{n:"UsesELFs",f:Gi},353:{n:"DSF",f:zi},401:{n:"CUsr"},402:{n:"CbUsr"},403:{n:"UsrInfo"},404:{n:"UsrExcl"},405:{n:"FileLock"},406:{n:"RRDInfo"},407:{n:"BCUsrs"},408:{n:"UsrChk"},425:{n:"UserBView"},426:{n:"UserSViewBegin"},427:{n:"UserSViewEnd"},428:{n:"RRDUserView"},429:{n:"Qsi"},430:{n:"SupBook",f:ys},431:{n:"Prot4Rev",f:Gi},432:{n:"CondFmt"},433:{n:"CF"},434:{n:"DVal"},437:{n:"DConBin"},438:{n:"TxO",f:Ms},439:{n:"RefreshAll",f:Gi},440:{n:"HLink",f:Ls},441:{n:"Lel"},442:{n:"CodeName",f:nr},443:{n:"SXFDBType"},444:{n:"Prot4RevPass",f:Xi},445:{n:"ObNoMacros"},446:{n:"Dv"},448:{n:"Excel9File",f:zi},449:{n:"RecalcId",f:zr,r:2},450:{n:"EntExU2",f:zi},512:{n:"Dimensions",f:is},513:{n:"Blank",f:Ys},515:{n:"Number",f:ms},516:{n:"Label",f:Qr},517:{n:"BoolErr",f:gs},518:{n:"Formula",f:Fc},519:{n:"String",f:Zs},520:{n:"Row",f:jr},523:{n:"Index"},545:{n:"Array",f:As},549:{n:"DefaultRowHeight",f:Vr},566:{n:"Table"},574:{n:"Window2",f:Kr},638:{n:"RK",f:ss},659:{n:"Style"},1030:{n:"Formula",f:Fc},1048:{n:"BigName"},1054:{n:"Format",f:es},1084:{n:"ContinueBigName"},1212:{n:"ShrFmla",f:Ss},2048:{n:"HLinkTooltip",f:Fs},2049:{n:"WebPub"},2050:{n:"QsiSXTag"},2051:{n:"DBQueryExt"},2052:{n:"ExtString"},2053:{n:"TxtQry"},2054:{n:"Qsir"},2055:{n:"Qsif"},2056:{n:"RRDTQSIF"},2057:{n:"BOF",f:Nr},2058:{n:"OleDbConn"},2059:{n:"WOpt"},2060:{n:"SXViewEx"},2061:{n:"SXTH"},2062:{n:"SXPIEx"},2063:{n:"SXVDTEx"},2064:{n:"SXViewEx9"},2066:{n:"ContinueFrt"},2067:{n:"RealTimeData"},2128:{n:"ChartFrtInfo"},2129:{n:"FrtWrapper"},2130:{n:"StartBlock"},2131:{n:"EndBlock"},2132:{n:"StartObject"},2133:{n:"EndObject"},2134:{n:"CatLab"},2135:{n:"YMult"},2136:{n:"SXViewLink"},2137:{n:"PivotChartBits"},2138:{n:"FrtFontList"},2146:{n:"SheetExt"},2147:{n:"BookExt",r:12},2148:{n:"SXAddl"},2149:{n:"CrErr"},2150:{n:"HFPicture"},2151:{n:"FeatHdr",f:zi},2152:{n:"Feat"},2154:{n:"DataLabExt"},2155:{n:"DataLabExtContents"},2156:{n:"CellWatch"},2161:{n:"FeatHdr11"},2162:{n:"Feature11"},2164:{n:"DropDownObjIds"},2165:{n:"ContinueFrt11"},2166:{n:"DConn"},2167:{n:"List12"},2168:{n:"Feature12"},2169:{n:"CondFmt12"},2170:{n:"CF12"},2171:{n:"CFEx"},2172:{n:"XFCRC",f:Vs,r:12},2173:{n:"XFExt",f:wu,r:12},2174:{n:"AutoFilter12"},2175:{n:"ContinueFrt12"},2180:{n:"MDTInfo"},2181:{n:"MDXStr"},2182:{n:"MDXTuple"},2183:{n:"MDXSet"},2184:{n:"MDXProp"},2185:{n:"MDXKPI"},2186:{n:"MDB"},2187:{n:"PLV"},2188:{n:"Compat12",f:Gi,r:12},2189:{n:"DXF"},2190:{n:"TableStyles",r:12},2191:{n:"TableStyle"},2192:{n:"TableStyleElement"},2194:{n:"StyleExt"},2195:{n:"NamePublish"},2196:{n:"NameCmt",f:ks,r:12},2197:{n:"SortData"},2198:{n:"Theme",f:vu,r:12},2199:{n:"GUIDTypeLib"},2200:{n:"FnGrp12"},2201:{n:"NameFnGrp12"},2202:{n:"MTRSettings",f:Es,r:12},2203:{n:"CompressPictures",f:zi},2204:{n:"HeaderFooter"},2205:{n:"CrtLayout12"},2206:{n:"CrtMlFrt"},2207:{n:"CrtMlFrtContinue"},2211:{n:"ForceFullCalculation",f:Wr},2212:{n:"ShapePropsStream"},2213:{n:"TextPropsStream"},2214:{n:"RichTextStream"},2215:{n:"CrtLayout12A"},4097:{n:"Units"},4098:{n:"Chart"},4099:{n:"Series"},4102:{n:"DataFormat"},4103:{n:"LineFormat"},4105:{n:"MarkerFormat"},4106:{n:"AreaFormat"},4107:{n:"PieFormat"},4108:{n:"AttachedLabel"},4109:{n:"SeriesText"},4116:{n:"ChartFormat"},4117:{n:"Legend"},4118:{n:"SeriesList"},4119:{n:"Bar"},4120:{n:"Line"},4121:{n:"Pie"},4122:{n:"Area"},4123:{n:"Scatter"},4124:{n:"CrtLine"},4125:{n:"Axis"},4126:{n:"Tick"},4127:{n:"ValueRange"},4128:{n:"CatSerRange"},4129:{n:"AxisLine"},4130:{n:"CrtLink"},4132:{n:"DefaultText"},4133:{n:"Text"},4134:{n:"FontX",f:Xi},4135:{n:"ObjectLink"},4146:{n:"Frame"},4147:{n:"Begin"},4148:{n:"End"},4149:{n:"PlotArea"},4154:{n:"Chart3d"},4156:{n:"PicF"},4157:{n:"DropBar"},4158:{n:"Radar"},4159:{n:"Surf"},4160:{n:"RadarArea"},4161:{n:"AxisParent"},4163:{n:"LegendException"},4164:{n:"ShtProps",f:Ks},4165:{n:"SerToCrt"},4166:{n:"AxesUsed"},4168:{n:"SBaseRef"},4170:{n:"SerParent"},4171:{n:"SerAuxTrend"},4174:{n:"IFmtRecord"},4175:{n:"Pos"},4176:{n:"AlRuns"},4177:{n:"BRAI"},4187:{n:"SerAuxErrBar"},4188:{n:"ClrtClient",f:Ws},4189:{n:"SerFmt"},4191:{n:"Chart3DBarShape"},4192:{n:"Fbi"},4193:{n:"BopPop"},4194:{n:"AxcExt"},4195:{n:"Dat"},4196:{n:"PlotGrowth"},4197:{n:"SIIndex"},4198:{n:"GelFrame"},4199:{n:"BopPopCustom"},4200:{n:"Fbi2"},0:{n:"Dimensions",f:is},2:{n:"BIFF2INT",f:no},5:{n:"BoolErr",f:gs},7:{n:"String",f:ro},8:{n:"BIFF2ROW"},11:{n:"Index"},22:{n:"ExternCount",f:Xi},30:{n:"BIFF2FORMAT",f:ns},31:{n:"BIFF2FMTCNT"},32:{n:"BIFF2COLINFO"},33:{n:"Array",f:As},37:{n:"DefaultRowHeight",f:Vr},50:{n:"BIFF2FONTXTRA",f:so},52:{n:"DDEObjName"},62:{n:"BIFF2WINDOW2"},67:{n:"BIFF2XF"},69:{n:"BIFF2FONTCLR"},86:{n:"BIFF4FMTCNT"},126:{n:"RK"},127:{n:"ImData",f:Qs},135:{n:"Addin"},136:{n:"Edg"},137:{n:"Pub"},145:{n:"Sub"},148:{n:"LHRecord"},149:{n:"LHNGraph"},150:{n:"Sound"},169:{n:"CoordList"},171:{n:"GCW"},188:{n:"ShrFmla"},191:{n:"ToolbarHdr"},192:{n:"ToolbarEnd"},194:{n:"AddMenu"},195:{n:"DelMenu"},214:{n:"RString",f:oo},223:{n:"UDDesc"},234:{n:"TabIdConf"},354:{n:"XL5Modify"},421:{n:"FileSharing2"},521:{n:"BOF",f:Nr},536:{n:"Lbl",f:Cs},547:{n:"ExternName",f:_s},561:{n:"Font"},579:{n:"BIFF3XF"},1033:{n:"BOF",f:Nr},1091:{n:"BIFF4XF"},2157:{n:"FeatInfo"},2163:{n:"FeatInfo11"},2177:{n:"SXAddl12"},2240:{n:"AutoWebPub"},2241:{n:"ListObj"},2242:{n:"ListField"},2243:{n:"ListDV"},2244:{n:"ListCondFmt"},2245:{n:"ListCF"},2246:{n:"FMQry"},2247:{n:"FMSQry"},2248:{n:"PLV"},2249:{n:"LnExt"},2250:{n:"MkrExt"},2251:{n:"CrtCoopt"},2262:{n:"FRTArchId$",r:12},29282:{}},bf=tt(vf,"n");function yf(t,e,a,n){var i=+e||+bf[e];if(!isNaN(i)){var r=n||(a||[]).length||0,s=t.next(4);s._W(2,i),s._W(2,r),r>0&&Fe(a)&&t.push(a)}}function _f(t,e,a){return t||(t=ta(7)),t._W(2,e),t._W(2,a),t._W(2,0),t._W(1,0),t}function Df(t,e,a,n){var i=ta(9);return _f(i,t,e),"e"==n?(i._W(1,a),i._W(1,1)):(i._W(1,a?1:0),i._W(1,0)),i}function Cf(t,e,a){var n=ta(8+2*a.length);return _f(n,t,e),n._W(1,a.length),n._W(a.length,a,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function wf(t,e,a,n){if(null!=e.v)switch(e.t){case"d":case"n":var i="d"==e.t?st(ct(e.v)):e.v;return void(i==(0|i)&&i>=0&&i<65536?yf(t,2,io(a,n,i)):yf(t,3,ao(a,n,i)));case"b":case"e":return void yf(t,5,Df(a,n,e.v,e.t));case"s":case"str":return void yf(t,4,Cf(a,n,e.v))}yf(t,1,_f(null,a,n))}function xf(t,e,a,n){var i,r=Array.isArray(e),s=wa(e["!ref"]||"A1"),o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Ca(s)}for(var u=s.s.r;u<=s.e.r;++u){o=ca(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(l[d]=fa(d)),i=l[d]+o;var c=r?(e[u]||[])[d]:e[i];c&&wf(t,c,u,d,n)}}}function kf(t,e){var a=e||{};null!=C&&null==a.dense&&(a.dense=C);for(var n=aa(),i=0,r=0;r<t.SheetNames.length;++r)t.SheetNames[r]==a.sheet&&(i=r);if(0==i&&a.sheet&&t.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return yf(n,9,Rr(t,16,a)),xf(n,t.Sheets[t.SheetNames[i]],i,a,t),yf(n,10),n.end()}function Sf(t,e,a){yf(t,"Font",Jr({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},a))}function Af(t,e,a){e&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var i=n[0];i<=n[1];++i)null!=e[i]&&yf(t,"Format",as(i,e[i],a))}))}function Ef(t,e){var a=ta(19);a._W(4,2151),a._W(4,0),a._W(4,0),a._W(2,3),a._W(1,1),a._W(4,0),yf(t,"FeatHdr",a),a=ta(39),a._W(4,2152),a._W(4,0),a._W(4,0),a._W(2,3),a._W(1,0),a._W(4,0),a._W(2,1),a._W(4,4),a._W(2,0),wr(wa(e["!ref"]||"A1"),a),a._W(4,4),yf(t,"Feat",a)}function Tf(t,e){for(var a=0;a<16;++a)yf(t,"XF",cs({numFmtId:0,style:!0},0,e));e.cellXfs.forEach((function(a){yf(t,"XF",cs(a,0,e))}))}function If(t,e){for(var a=0;a<e["!links"].length;++a){var n=e["!links"][a];yf(t,"HLink",Us(n)),n[1].Tooltip&&yf(t,"HLinkTooltip",$s(n))}delete e["!links"]}function Pf(t,e,a,n,i){var r=16+rp(i.cellXfs,e,i);if(null!=e.v)switch(e.t){case"d":case"n":var s="d"==e.t?st(ct(e.v)):e.v;return void yf(t,"Number",vs(a,n,s,r,i));case"b":case"e":return void yf(t,517,fs(a,n,e.v,r,i,e.t));case"s":case"str":return void yf(t,"Label",ts(a,n,e.v,r,i))}yf(t,"Blank",mr(a,n,r))}function Nf(t,e,a){var n,i=aa(),r=a.SheetNames[t],s=a.Sheets[r]||{},o=(a||{}).Workbook||{},l=(o.Sheets||[])[t]||{},u=Array.isArray(s),d=8==e.biff,c="",p=[],h=wa(s["!ref"]||"A1"),g=d?65536:16384;if(h.e.c>255||h.e.r>=g){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,g-1)}yf(i,2057,Rr(a,16,e)),yf(i,"CalcMode",Yi(1)),yf(i,"CalcCount",Yi(100)),yf(i,"CalcRefMode",Ki(!0)),yf(i,"CalcIter",Ki(!1)),yf(i,"CalcDelta",tn(.001)),yf(i,"CalcSaveRecalc",Ki(!0)),yf(i,"PrintRowCol",Ki(!1)),yf(i,"PrintGrid",Ki(!1)),yf(i,"GridSet",Yi(1)),yf(i,"Guts",hs([0,0])),yf(i,"HCenter",Ki(!1)),yf(i,"VCenter",Ki(!1)),yf(i,512,rs(h,e)),d&&(s["!links"]=[]);for(var f=h.s.r;f<=h.e.r;++f){c=ca(f);for(var m=h.s.c;m<=h.e.c;++m){f===h.s.r&&(p[m]=fa(m)),n=p[m]+c;var v=u?(s[f]||[])[m]:s[n];v&&(Pf(i,v,f,m,e),d&&v.l&&s["!links"].push([n,v.l]))}}var b=l.CodeName||l.name||r;return d&&o.Views&&yf(i,"Window2",Xr(o.Views[0])),d&&(s["!merges"]||[]).length&&yf(i,"MergeCells",Ns(s["!merges"])),d&&If(i,s),yf(i,"CodeName",rr(b,e)),d&&Ef(i,s),yf(i,"EOF"),i.end()}function Rf(t,e,a){var n=aa(),i=(t||{}).Workbook||{},r=i.Sheets||[],s=i.WBProps||{},o=8==a.biff,l=5==a.biff;if(yf(n,2057,Rr(t,5,a)),"xla"==a.bookType&&yf(n,"Addin"),yf(n,"InterfaceHdr",o?Yi(1200):null),yf(n,"Mms",Vi(2)),l&&yf(n,"ToolbarHdr"),l&&yf(n,"ToolbarEnd"),yf(n,"InterfaceEnd"),yf(n,"WriteAccess",Mr("SheetJS",a)),yf(n,"CodePage",Yi(o?1200:1252)),o&&yf(n,"DSF",Yi(0)),o&&yf(n,"Excel9File"),yf(n,"RRTabId",Xs(t.SheetNames.length)),o&&t.vbaraw){yf(n,"ObProj");var u=s.CodeName||"ThisWorkbook";yf(n,"CodeName",rr(u,a))}yf(n,"BuiltInFnGroupCount",Yi(17)),yf(n,"WinProtect",Ki(!1)),yf(n,"Protect",Ki(!1)),yf(n,"Password",Yi(0)),o&&yf(n,"Prot4Rev",Ki(!1)),o&&yf(n,"Prot4RevPass",Yi(0)),yf(n,"Window1",Gr(a)),yf(n,"Backup",Ki(!1)),yf(n,"HideObj",Yi(0)),yf(n,"Date1904",Ki("true"==Kh(t))),yf(n,"CalcPrecision",Ki(!0)),o&&yf(n,"RefreshAll",Ki(!1)),yf(n,"BookBool",Yi(0)),Sf(n,t,a),Af(n,t.SSF,a),Tf(n,a),o&&yf(n,"UsesELFs",Ki(!1));var d=n.end(),c=aa();o&&yf(c,"Country",js()),yf(c,"EOF");var p=c.end(),h=aa(),g=0,f=0;for(f=0;f<t.SheetNames.length;++f)g+=(o?12:11)+(o?2:1)*t.SheetNames[f].length;var m=d.length+g+p.length;for(f=0;f<t.SheetNames.length;++f){var v=r[f]||{};yf(h,"BoundSheet8",Fr({pos:m,hs:v.Hidden||0,dt:0,name:t.SheetNames[f]},a)),m+=e[f].length}var b=h.end();if(g!=b.length)throw new Error("BS8 "+g+" != "+b.length);var y=[];return d.length&&y.push(d),b.length&&y.push(b),p.length&&y.push(p),De([y])}function Bf(t,e){var a=e||{},n=[];t&&!t.SSF&&(t.SSF=U.get_table()),t&&t.SSF&&(F(U),U.load_table(t.SSF),a.revssf=at(t.SSF),a.revssf[t.SSF[65535]]=0,a.ssf=t.SSF),a.cellXfs=[],a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,rp(a.cellXfs,{},{revssf:{General:0}});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=Nf(i,a,t);return n.unshift(Rf(t,n,a)),De([n])}function Of(t,e){var a=e||{};switch(a.biff||2){case 8:case 5:return Bf(t,e);case 4:case 3:case 2:return kf(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}var Mf=function(){function t(t,e){var a=e||{};null!=C&&null==a.dense&&(a.dense=C);var n=a.dense?[]:{},i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var r=t.match(/<\/table/i),s=i.index,o=r&&r.index||t.length,l=yt(t.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,c=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(s=0;s<l.length;++s){var f=l[s].trim(),m=f.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var v=f.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var b=v[o].trim();if(b.match(/<t[dh]/i)){var y=b,_=0;while("<"==y.charAt(0)&&(_=y.indexOf(">"))>-1)y=y.slice(_+1);for(var D=0;D<g.length;++D){var w=g[D];w.s.c==d&&w.s.r<u&&u<=w.e.r&&(d=w.e.c+1,D=-1)}var x=Lt(b.slice(0,b.indexOf(">")));p=x.colspan?+x.colspan:1,((c=+x.rowspan)>1||p>1)&&g.push({s:{r:u,c:d},e:{r:u+(c||1)-1,c:d+p-1}});var k=x.t||"";if(y.length){if(y=ie(y),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),y.length){var S={t:"s",v:y};a.raw||!y.trim().length||"s"==k||("TRUE"===y?S={t:"b",v:!0}:"FALSE"===y?S={t:"b",v:!1}:isNaN(ft(y))?isNaN(mt(y).getDate())||(S={t:"d",v:ct(y)},a.cellDates||(S={t:"n",v:st(S.v)}),S.z=a.dateNF||U._table[14]):S={t:"n",v:ft(y)}),a.dense?(n[u]||(n[u]=[]),n[u][d]=S):n[_a({r:u,c:d})]=S,d+=p}}else d+=p}}}}else{if(++u,a.sheetRows&&a.sheetRows<=u){--u;break}d=0}}return n["!ref"]=Ca(h),g.length&&(n["!merges"]=g),n}function e(e,a){return Sa(t(e,a),a)}function a(t,e,a,n){for(var i=t["!merges"]||[],r=[],s=e.s.c;s<=e.e.c;++s){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>a||i[u].s.c>s)&&!(i[u].e.r<a||i[u].e.c<s)){if(i[u].s.r<a||i[u].s.c<s){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var d=_a({r:a,c:s}),c=n.dense?(t[a]||[])[s]:t[d],p=c&&null!=c.v&&(c.h||Gt(c.w||(ka(c),c.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),h.t=c&&c.t||"z",n.editable&&(p='<span contenteditable="true">'+p+"</span>"),h.id="sjs-"+d,r.push(pe("td",p,h))}}var g="<tr>";return g+r.join("")+"</tr>"}function n(t,e,a){var n=[];return n.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}var i='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',r="</body></html>";function s(t,e){var s=e||{},o=null!=s.header?s.header:i,l=null!=s.footer?s.footer:r,u=[o],d=Da(t["!ref"]);s.dense=Array.isArray(t),u.push(n(t,d,s));for(var c=d.s.r;c<=d.e.r;++c)u.push(a(t,d,c,s));return u.push("</table>"+l),u.join("")}return{to_workbook:e,to_sheet:t,_row:a,BEGIN:i,END:r,_preamble:n,from_sheet:s}}();function Lf(t,e){var a=e||{};null!=C&&(a.dense=C);for(var n,i,r,s,o=a.dense?[]:{},l=t.getElementsByTagName("tr"),u=a.sheetRows||1e7,d={s:{r:0,c:0},e:{r:0,c:0}},c=[],p=0,h=[],g=0,f=0;g<l.length&&f<u;++g){var m=l[g];if(Ff(m)){if(a.display)continue;h[f]={hidden:!0}}var v=m.children;for(n=i=0;n<v.length;++n){var b=v[n];if(!a.display||!Ff(b)){var y=ie(b.innerHTML);for(p=0;p<c.length;++p){var _=c[p];_.s.c==i&&_.s.r<=f&&f<=_.e.r&&(i=_.e.c+1,p=-1)}s=+b.getAttribute("colspan")||1,((r=+b.getAttribute("rowspan"))>0||s>1)&&c.push({s:{r:f,c:i},e:{r:f+(r||1)-1,c:i+s-1}});var D={t:"s",v:y},w=b.getAttribute("t")||"";null!=y&&(0==y.length?D.t=w||"z":a.raw||0==y.trim().length||"s"==w||("TRUE"===y?D={t:"b",v:!0}:"FALSE"===y?D={t:"b",v:!1}:isNaN(ft(y))?isNaN(mt(y).getDate())||(D={t:"d",v:ct(y)},a.cellDates||(D={t:"n",v:st(D.v)}),D.z=a.dateNF||U._table[14]):D={t:"n",v:ft(y)})),a.dense?(o[f]||(o[f]=[]),o[f][i]=D):o[_a({c:i,r:f})]=D,d.e.c<i&&(d.e.c=i),i+=s}}++f}return c.length&&(o["!merges"]=c),h.length&&(o["!rows"]=h),d.e.r=f-1,o["!ref"]=Ca(d),f>=u&&(o["!fullref"]=Ca((d.e.r=l.length-g+f-1,d))),o}function Uf(t,e){return Sa(Lf(t,e),e)}function Ff(t){var e="",a=$f(t);return a&&(e=a(t).getPropertyValue("display")),e||(e=t.style.display),"none"===e}function $f(t){return t.ownerDocument.defaultView&&"function"===typeof t.ownerDocument.defaultView.getComputedStyle?t.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}var Hf=function(){var t=function(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(t,e){return Array(parseInt(e,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),a=Ht(e.replace(/<[^>]*>/g,""));return[a]},e={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};return function(a,n){var i=n||{};null!=C&&null==i.dense&&(i.dense=C);var r,s,o,l,u,d,c,p=Hg(a),h=[],g={name:""},f="",m=0,v={},b=[],y=i.dense?[]:{},_={value:""},D="",w=0,x=[],k=-1,S=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,T={},I=[],P={},N=0,R=0,B=[],O=1,M=1,L=[],U={Names:[]},F={},$=["",""],H=[],j={},W="",z=0,V=!1,q=!1,G=0;jg.lastIndex=0,p=p.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");while(u=jg.exec(p))switch(u[3]=u[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===u[1]?(A.e.c>=A.s.c&&A.e.r>=A.s.r&&(y["!ref"]=Ca(A)),i.sheetRows>0&&i.sheetRows<=A.e.r&&(y["!fullref"]=y["!ref"],A.e.r=i.sheetRows-1,y["!ref"]=Ca(A)),I.length&&(y["!merges"]=I),B.length&&(y["!rows"]=B),o.name=o["名称"]||o.name,"undefined"!==typeof JSON&&JSON.stringify(o),b.push(o.name),v[o.name]=y,q=!1):"/"!==u[0].charAt(u[0].length-2)&&(o=Lt(u[0],!1),k=S=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,y=i.dense?[]:{},I=[],B=[],q=!0);break;case"table-row-group":"/"===u[1]?--E:++E;break;case"table-row":case"行":if("/"===u[1]){k+=O,O=1;break}if(l=Lt(u[0],!1),l["行号"]?k=l["行号"]-1:-1==k&&(k=0),O=+l["number-rows-repeated"]||1,O<10)for(G=0;G<O;++G)E>0&&(B[k+G]={level:E});S=-1;break;case"covered-table-cell":"/"!==u[1]&&++S,i.sheetStubs&&(i.dense?(y[k]||(y[k]=[]),y[k][S]={t:"z"}):y[_a({r:k,c:S})]={t:"z"}),D="",x=[];break;case"table-cell":case"数据":if("/"===u[0].charAt(u[0].length-2))++S,_=Lt(u[0],!1),M=parseInt(_["number-columns-repeated"]||"1",10),d={t:"z",v:null},_.formula&&0!=i.cellFormula&&(d.f=Xc(Ht(_.formula))),"string"==(_["数据类型"]||_["value-type"])&&(d.t="s",d.v=Ht(_["string-value"]||""),i.dense?(y[k]||(y[k]=[]),y[k][S]=d):y[_a({r:k,c:S})]=d),S+=M-1;else if("/"!==u[1]){++S,M=1;var K=O?k+O-1:k;if(S>A.e.c&&(A.e.c=S),S<A.s.c&&(A.s.c=S),k<A.s.r&&(A.s.r=k),K>A.e.r&&(A.e.r=K),_=Lt(u[0],!1),H=[],j={},d={t:_["数据类型"]||_["value-type"],v:null},i.cellFormula)if(_.formula&&(_.formula=Ht(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(N=parseInt(_["number-matrix-rows-spanned"],10)||0,R=parseInt(_["number-matrix-columns-spanned"],10)||0,P={s:{r:k,c:S},e:{r:k+N-1,c:S+R-1}},d.F=Ca(P),L.push([P,d.F])),_.formula)d.f=Xc(_.formula);else for(G=0;G<L.length;++G)k>=L[G][0].s.r&&k<=L[G][0].e.r&&S>=L[G][0].s.c&&S<=L[G][0].e.c&&(d.F=L[G][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(N=parseInt(_["number-rows-spanned"],10)||0,R=parseInt(_["number-columns-spanned"],10)||0,P={s:{r:k,c:S},e:{r:k+N-1,c:S+R-1}},I.push(P)),_["number-columns-repeated"]&&(M=parseInt(_["number-columns-repeated"],10)),d.t){case"boolean":d.t="b",d.v=Jt(_["boolean-value"]);break;case"float":d.t="n",d.v=parseFloat(_.value);break;case"percentage":d.t="n",d.v=parseFloat(_.value);break;case"currency":d.t="n",d.v=parseFloat(_.value);break;case"date":d.t="d",d.v=ct(_["date-value"]),i.cellDates||(d.t="n",d.v=st(d.v)),d.z="m/d/yy";break;case"time":d.t="n",d.v=lt(_["time-value"])/86400;break;case"number":d.t="n",d.v=parseFloat(_["数据数值"]);break;default:if("string"!==d.t&&"text"!==d.t&&d.t)throw new Error("Unsupported value type "+d.t);d.t="s",null!=_["string-value"]&&(D=Ht(_["string-value"]),x=[])}}else{if(V=!1,"s"===d.t&&(d.v=D||"",x.length&&(d.R=x),V=0==w),F.Target&&(d.l=F),H.length>0&&(d.c=H,H=[]),D&&!1!==i.cellText&&(d.w=D),(!V||i.sheetStubs)&&!(i.sheetRows&&i.sheetRows<=k))for(var X=0;X<O;++X){if(M=parseInt(_["number-columns-repeated"]||"1",10),i.dense){y[k+X]||(y[k+X]=[]),y[k+X][S]=0==X?d:ht(d);while(--M>0)y[k+X][S+M]=ht(d)}else{y[_a({r:k+X,c:S})]=d;while(--M>0)y[_a({r:k+X,c:S+M})]=ht(d)}A.e.c<=S&&(A.e.c=S)}M=parseInt(_["number-columns-repeated"]||"1",10),S+=M-1,M=0,d={},D="",x=[]}F={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":if("/"===u[1]){if((r=h.pop())[0]!==u[3])throw"Bad state: "+r}else"/"!==u[0].charAt(u[0].length-2)&&h.push([u[3],!0]);break;case"annotation":if("/"===u[1]){if((r=h.pop())[0]!==u[3])throw"Bad state: "+r;j.t=D,x.length&&(j.R=x),j.a=W,H.push(j)}else"/"!==u[0].charAt(u[0].length-2)&&h.push([u[3],!1]);W="",z=0,D="",w=0,x=[];break;case"creator":"/"===u[1]?W=p.slice(z,u.index):z=u.index+u[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===u[1]){if((r=h.pop())[0]!==u[3])throw"Bad state: "+r}else"/"!==u[0].charAt(u[0].length-2)&&h.push([u[3],!1]);D="",w=0,x=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===u[1]){if(T[g.name]=f,(r=h.pop())[0]!==u[3])throw"Bad state: "+r}else"/"!==u[0].charAt(u[0].length-2)&&(f="",g=Lt(u[0],!1),h.push([u[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"master-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(h[h.length-1][0]){case"time-style":case"date-style":s=Lt(u[0],!1),f+=e[u[3]]["long"===s.style?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(h[h.length-1][0]){case"time-style":case"date-style":s=Lt(u[0],!1),f+=e[u[3]]["long"===s.style?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if("/>"===u[0].slice(-2))break;if("/"===u[1])switch(h[h.length-1][0]){case"number-style":case"date-style":case"time-style":f+=p.slice(m,u.index);break}else m=u.index+u[0].length;break;case"named-range":s=Lt(u[0],!1),$=Jc(s["cell-range-address"]);var Y={Name:s.name,Ref:$[0]+"!"+$[1]};q&&(Y.Sheet=b.length),U.Names.push(Y);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if("/"!==u[1]||_&&_["string-value"])c=Lt(u[0],!1),w=u.index+u[0].length;else{var J=t(p.slice(w,u.index),c);D=(D.length>0?D+"\n":"")+J[0]}break;case"s":break;case"database-range":if("/"===u[1])break;try{$=Jc(Lt(u[0])["target-range-address"]),v[$[0]]["!autofilter"]={ref:$[1]}}catch(it){}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if("/"!==u[1]){if(F=Lt(u[0],!1),!F.href)break;F.Target=F.href,delete F.href,"#"==F.Target.charAt(0)&&F.Target.indexOf(".")>-1&&($=Jc(F.Target.slice(1)),F.Target="#"+$[0]+"!"+$[1])}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(u[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(i.WTF)throw new Error(u)}}var Z={Sheets:v,SheetNames:b,Workbook:U};return i.bookSheets&&delete Z.Sheets,Z}}();function jf(t,e){e=e||{};var a=!!wt(t,"objectdata");a&&Kn(kt(t,"META-INF/manifest.xml"),e);var n=St(t,"content.xml");if(!n)throw new Error("Missing content.xml in "+(a?"ODS":"UOF")+" file");var i=Hf(a?n:Zt(n),e);return wt(t,"meta.xml")&&(i.Props=ai(kt(t,"meta.xml"))),i}function Wf(t,e){return Hf(t,e)}var zf=function(){var t="<office:document-styles "+ce({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+"></office:document-styles>";return function(){return Nt+t}}(),Vf=function(){var t=function(t){return zt(t).replace(/  +/g,(function(t){return'<text:s text:c="'+t.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"<text:line-break/>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e="          <table:table-cell />\n",a="          <table:covered-table-cell/>\n",n=function(n,i,r){var s=[];s.push('      <table:table table:name="'+zt(i.SheetNames[r])+'">\n');var o=0,l=0,u=Da(n["!ref"]),d=n["!merges"]||[],c=0,p=Array.isArray(n);for(o=0;o<u.s.r;++o)s.push("        <table:table-row></table:table-row>\n");for(;o<=u.e.r;++o){for(s.push("        <table:table-row>\n"),l=0;l<u.s.c;++l)s.push(e);for(;l<=u.e.c;++l){var h=!1,g={},f="";for(c=0;c!=d.length;++c)if(!(d[c].s.c>l)&&!(d[c].s.r>o)&&!(d[c].e.c<l)&&!(d[c].e.r<o)){d[c].s.c==l&&d[c].s.r==o||(h=!0),g["table:number-columns-spanned"]=d[c].e.c-d[c].s.c+1,g["table:number-rows-spanned"]=d[c].e.r-d[c].s.r+1;break}if(h)s.push(a);else{var m=_a({r:o,c:l}),v=p?(n[o]||[])[l]:n[m];if(v&&v.f&&(g["table:formula"]=zt(Yc(v.f)),v.F&&v.F.slice(0,m.length)==m)){var b=Da(v.F);g["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,g["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(v){switch(v.t){case"b":f=v.v?"TRUE":"FALSE",g["office:value-type"]="boolean",g["office:boolean-value"]=v.v?"true":"false";break;case"n":f=v.w||String(v.v||0),g["office:value-type"]="float",g["office:value"]=v.v||0;break;case"s":case"str":f=v.v,g["office:value-type"]="string";break;case"d":f=v.w||ct(v.v).toISOString(),g["office:value-type"]="date",g["office:date-value"]=ct(v.v).toISOString(),g["table:style-name"]="ce1";break;default:s.push(e);continue}var y=t(f);if(v.l&&v.l.Target){var _=v.l.Target;_="#"==_.charAt(0)?"#"+Zc(_.slice(1)):_,y=pe("text:a",y,{"xlink:href":_})}s.push("          "+pe("table:table-cell",pe("text:p",y,{}),g)+"\n")}else s.push(e)}}s.push("        </table:table-row>\n")}return s.push("      </table:table>\n"),s.join("")},i=function(t){t.push(" <office:automatic-styles>\n"),t.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),t.push('   <number:month number:style="long"/>\n'),t.push("   <number:text>/</number:text>\n"),t.push('   <number:day number:style="long"/>\n'),t.push("   <number:text>/</number:text>\n"),t.push("   <number:year/>\n"),t.push("  </number:date-style>\n"),t.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),t.push(" </office:automatic-styles>\n")};return function(t,e){var a=[Nt],r=ce({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),s=ce({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==e.bookType?a.push("<office:document"+r+s+">\n"):a.push("<office:document-content"+r+">\n"),i(a),a.push("  <office:body>\n"),a.push("    <office:spreadsheet>\n");for(var o=0;o!=t.SheetNames.length;++o)a.push(n(t.Sheets[t.SheetNames[o]],t,o,e));return a.push("    </office:spreadsheet>\n"),a.push("  </office:body>\n"),"fods"==e.bookType?a.push("</office:document>"):a.push("</office:document-content>"),a.join("")}}();function qf(t,e){if("fods"==e.bookType)return Vf(t,e);var a=It(),n="",i=[],r=[];return n="mimetype",Et(a,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Et(a,n,Vf(t,e)),i.push([n,"text/xml"]),r.push([n,"ContentFile"]),n="styles.xml",Et(a,n,zf(t,e)),i.push([n,"text/xml"]),r.push([n,"StylesFile"]),n="meta.xml",Et(a,n,Qn()),i.push([n,"text/xml"]),r.push([n,"MetadataFile"]),n="manifest.rdf",Et(a,n,Zn(r)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Et(a,n,Xn(i)),a}function Gf(t,e){if(!e)return 0;var a=t.SheetNames.indexOf(e);if(-1==a)throw new Error("Sheet not found: "+e);return a}function Kf(t){return function(e,a){var n=Gf(e,a.sheet);return t.from_sheet(e.Sheets[e.SheetNames[n]],a,e)}}var Xf=Kf(Mf),Yf=Kf({from_sheet:Um}),Jf=Kf("undefined"!==typeof uo?uo:{}),Zf=Kf("undefined"!==typeof co?co:{}),Qf=Kf("undefined"!==typeof ho?ho:{}),tm=Kf("undefined"!==typeof el?el:{}),em=Kf({from_sheet:Fm}),am=Kf("undefined"!==typeof lo?lo:{}),nm=Kf("undefined"!==typeof po?po:{});function im(t){return function(e){for(var a=0;a!=t.length;++a){var n=t[a];void 0===e[n[0]]&&(e[n[0]]=n[1]),"n"===n[2]&&(e[n[0]]=Number(e[n[0]]))}}}var rm=im([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]]),sm=im([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]]);function om(t){return Hn.WS.indexOf(t)>-1?"sheet":Hn.CS&&t==Hn.CS?"chart":Hn.DS&&t==Hn.DS?"dialog":Hn.MS&&t==Hn.MS?"macro":t&&t.length?t:"sheet"}function lm(t,e){if(!t)return 0;try{t=e.map((function(e){return e.id||(e.id=e.strRelID),[e.name,t["!id"][e.id].Target,om(t["!id"][e.id].Type)]}))}catch(o){return null}return t&&0!==t.length?t:null}function um(t,e,a,n,i,r,s,o,l,u,d,c){try{r[n]=Wn(St(t,a,!0),e);var p,h=kt(t,e);switch(o){case"sheet":p=mg(h,e,i,l,r[n],u,d,c);break;case"chart":if(p=vg(h,e,i,l,r[n],u,d,c),!p||!p["!chart"])break;var g=Pt(p["!chart"].Target,e),f=jn(g),m=Iu(St(t,g,!0),Wn(St(t,f,!0),g)),v=Pt(m,g),b=jn(v);p=Lh(St(t,v,!0),v,l,Wn(St(t,b,!0),v),u,p);break;case"macro":p=bg(h,e,i,l,r[n],u,d,c);break;case"dialog":p=yg(h,e,i,l,r[n],u,d,c);break}s[n]=p}catch(k){if(l.WTF)throw k}}function dm(t){return"/"==t.charAt(0)?t.slice(1):t}function cm(t,e){if(F(U),e=e||{},rm(e),wt(t,"META-INF/manifest.xml"))return jf(t,e);if(wt(t,"objectdata.xml"))return jf(t,e);if(wt(t,"Index/Document.iwa"))throw new Error("Unsupported NUMBERS file");var a,n,i=At(t),r=Ln(St(t,"[Content_Types].xml")),s=!1;if(0===r.workbooks.length&&(n="xl/workbook.xml",kt(t,n,!0)&&r.workbooks.push(n)),0===r.workbooks.length){if(n="xl/workbook.bin",!kt(t,n,!0))throw new Error("Could not find workbook");r.workbooks.push(n),s=!0}"bin"==r.workbooks[0].slice(-3)&&(s=!0);var o={},l={};if(!e.bookSheets&&!e.bookProps){if(Qc=[],r.sst)try{Qc=Cg(kt(t,dm(r.sst)),r.sst,e)}catch(f){if(e.WTF)throw f}e.cellStyles&&r.themes.length&&(o=Dg(St(t,r.themes[0].replace(/^\//,""),!0)||"",r.themes[0],e)),r.style&&(l=_g(kt(t,dm(r.style)),r.style,o,e))}r.links.map((function(a){return kg(kt(t,dm(a)),a,e)}));var u=fg(kt(t,dm(r.workbooks[0])),r.workbooks[0],e),d={},c="";r.coreprops.length&&(c=kt(t,dm(r.coreprops[0]),!0),c&&(d=ai(c)),0!==r.extprops.length&&(c=kt(t,dm(r.extprops[0]),!0),c&&ui(c,d,e)));var p={};e.bookSheets&&!e.bookProps||0!==r.custprops.length&&(c=St(t,dm(r.custprops[0]),!0),c&&(p=hi(c,e)));var h={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map((function(t){return t.name})):d.Worksheets&&d.SheetNames.length>0&&(a=d.SheetNames),e.bookProps&&(h.Props=d,h.Custprops=p),e.bookSheets&&"undefined"!==typeof a&&(h.SheetNames=a),e.bookSheets?h.SheetNames:e.bookProps))return h;a={};var g={};e.bookDeps&&r.calcchain&&(g=xg(kt(t,dm(r.calcchain)),r.calcchain,e));var m,v,b=0,y={},_=u.Sheets;d.Worksheets=_.length,d.SheetNames=[];for(var D=0;D!=_.length;++D)d.SheetNames[D]=_[D].name;var C=s?"bin":"xml",w=r.workbooks[0].lastIndexOf("/"),x=(r.workbooks[0].slice(0,w+1)+"_rels/"+r.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");wt(t,x)||(x="xl/_rels/workbook."+C+".rels");var k=Wn(St(t,x,!0),x);k&&(k=lm(k,u.Sheets));var S=kt(t,"xl/worksheets/sheet.xml",!0)?1:0;for(b=0;b!=d.Worksheets;++b){var A="sheet";k&&k[b]?(m="xl/"+k[b][1].replace(/[\/]?xl\//,""),wt(t,m)||(m=k[b][1]),wt(t,m)||(m=x.replace(/_rels\/.*$/,"")+k[b][1]),A=k[b][2]):(m="xl/worksheets/sheet"+(b+1-S)+"."+C,m=m.replace(/sheet0\./,"sheet.")),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),um(t,m,v,d.SheetNames[b],b,y,a,A,e,u,o,l)}return r.comments&&Ru(t,r.comments,a,y,e),h={Directory:r,Workbook:u,Props:d,Custprops:p,Deps:g,Sheets:a,SheetNames:d.SheetNames,Strings:Qc,Styles:l,Themes:o,SSF:U.get_table()},e.bookFiles&&(h.keys=i,h.files=t.files),e.bookVBA&&(r.vba.length>0?h.vbaraw=kt(t,dm(r.vba[0]),!0):r.defaults&&r.defaults.bin===zu&&(h.vbaraw=kt(t,"xl/vbaProject.bin",!0))),h}function pm(t,e){var a=e||{},n="Workbook",i=X.find(t,n);try{if(n="/!DataSpaces/Version",i=X.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Bo(i.content),n="/!DataSpaces/DataSpaceMap",i=X.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var r=Mo(i.content);if(1!==r.length||1!==r[0].comps.length||0!==r[0].comps[0].t||"StrongEncryptionDataSpace"!==r[0].name||"EncryptedPackage"!==r[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=X.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Lo(i.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=X.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Fo(i.content)}catch(h){}if(n="/EncryptionInfo",i=X.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=jo(i.content);if(n="/EncryptedPackage",i=X.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],i.content,a.password||"",a);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],i.content,a.password||"",a);throw new Error("File is password-protected")}function hm(t,e){if(Pu=1024,"ods"==e.bookType)return qf(t,e);t&&!t.SSF&&(t.SSF=U.get_table()),t&&t.SSF&&(F(U),U.load_table(t.SSF),e.revssf=at(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ep?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var a="xlsb"==e.bookType?"bin":"xml",n=Gu.indexOf(e.bookType)>-1,i=Mn();sm(e=e||{});var r=It(),s="",o=0;if(e.cellXfs=[],rp(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",Et(r,s,ri(t.Props,e)),i.coreprops.push(s),qn(e.rels,2,s,Hn.CORE_PROPS),s="docProps/app.xml",t.Props&&t.Props.SheetNames);else if(t.Workbook&&t.Workbook.Sheets){for(var l=[],u=0;u<t.SheetNames.length;++u)2!=(t.Workbook.Sheets[u]||{}).Hidden&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}else t.Props.SheetNames=t.SheetNames;for(t.Props.Worksheets=t.Props.SheetNames.length,Et(r,s,ci(t.Props,e)),i.extprops.push(s),qn(e.rels,3,s,Hn.EXT_PROPS),t.Custprops!==t.Props&&Q(t.Custprops||{}).length>0&&(s="docProps/custom.xml",Et(r,s,fi(t.Custprops,e)),i.custprops.push(s),qn(e.rels,4,s,Hn.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},c=t.Sheets[t.SheetNames[o-1]],p=(c||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+a,Et(r,s,Ag(o-1,s,e,t,d)),i.sheets.push(s),qn(e.wbrels,-1,"worksheets/sheet"+o+"."+a,Hn.WS[0])}if(c){var h=c["!comments"],g=!1;if(h&&h.length>0){var f="xl/comments"+o+"."+a;Et(r,f,Ig(h,f,e)),i.comments.push(f),qn(d,-1,"../comments"+o+"."+a,Hn.CMNT),g=!0}c["!legacy"]&&g&&Et(r,"xl/drawings/vmlDrawing"+o+".vml",Nu(o,c["!comments"])),delete c["!comments"],delete c["!legacy"]}d["!id"].rId1&&Et(r,jn(s),Vn(d))}return null!=e.Strings&&e.Strings.length>0&&(s="xl/sharedStrings."+a,Et(r,s,Tg(e.Strings,s,e)),i.strs.push(s),qn(e.wbrels,-1,"sharedStrings."+a,Hn.SST)),s="xl/workbook."+a,Et(r,s,Sg(t,s,e)),i.workbooks.push(s),qn(e.rels,1,s,Hn.WB),s="xl/theme/theme1.xml",Et(r,s,mu(t.Themes,e)),i.themes.push(s),qn(e.wbrels,-1,"theme/theme1.xml",Hn.THEME),s="xl/styles."+a,Et(r,s,Eg(t,s,e)),i.styles.push(s),qn(e.wbrels,-1,"styles."+a,Hn.STY),t.vbaraw&&n&&(s="xl/vbaProject.bin",Et(r,s,t.vbaraw),i.vba.push(s),qn(e.wbrels,-1,"vbaProject.bin",Hn.VBA)),Et(r,"[Content_Types].xml",$n(i,e)),Et(r,"_rels/.rels",Vn(e.rels)),Et(r,"xl/_rels/workbook."+a+".rels",Vn(e.wbrels)),delete e.revssf,delete e.ssf,r}function gm(t,e){var a="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3]];case"base64":a=x.decode(t.slice(0,24));break;case"binary":a=t;break;case"array":return[t[0],t[1],t[2],t[3]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]}function fm(t,e){return X.find(t,"EncryptedPackage")?pm(t,e):hf(t,e)}function mm(t,e){var a,n=t,r=e||{};return r.type||(r.type=k&&i.isBuffer(t)?"buffer":"base64"),a=Tt(n,r),cm(a,r)}function vm(t,e){var a=0;t:while(a<t.length)switch(t.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return zg(t.slice(a),e);default:break t}return ho.to_workbook(t,e)}function bm(t,e){var a="",n=gm(t,e);switch(e.type){case"base64":a=x.decode(t);break;case"binary":a=t;break;case"buffer":a=t.toString("binary");break;case"array":a=pt(t);break;default:throw new Error("Unrecognized type "+e.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(a=Zt(a)),vm(a,e)}function ym(t,e){var a=t;return"base64"==e.type&&(a=x.decode(a)),a=cptable.utils.decode(1200,a.slice(2),"str"),e.type="binary",vm(a,e)}function _m(t){return t.match(/[^\x00-\x7F]/)?Qt(t):t}function Dm(t,e,a,n){return n?(a.type="string",ho.to_workbook(t,a)):ho.to_workbook(e,a)}function Cm(t,e){if(f(),"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer)return Cm(new Uint8Array(t),e);var a=t,n=[0,0,0,0],r=!1,s=e||{};if(tp={},s.dateNF&&(tp.dateNF=s.dateNF),s.type||(s.type=k&&i.isBuffer(t)?"buffer":"base64"),"file"==s.type&&(s.type=k?"buffer":"binary",a=Z(t)),"string"==s.type&&(r=!0,s.type="binary",s.codepage=65001,a=_m(t)),"array"==s.type&&"undefined"!==typeof Uint8Array&&t instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return s=ht(s),s.type="array",Cm(B(a),s)}switch((n=gm(a,s))[0]){case 208:return fm(X.read(a,s),s);case 9:return hf(a,s);case 60:return zg(a,s);case 73:if(68===n[1])return go(a,s);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return co.to_workbook(a,s);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?mm(a,s):Dm(t,a,s,r);case 239:return 60===n[3]?zg(a,s):Dm(t,a,s,r);case 255:if(254===n[1])return ym(a,s);break;case 0:if(0===n[1]&&n[2]>=2&&0===n[3])return fo.to_workbook(a,s);break;case 3:case 131:case 139:case 140:return lo.to_workbook(a,s);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return el.to_workbook(a,s);break;case 10:case 13:case 32:return bm(a,s)}return n[2]<=12&&n[3]<=31?lo.to_workbook(a,s):Dm(t,a,s,r)}function wm(t,e){var a=e||{};return a.type="file",Cm(t,a)}function xm(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return J(e.file,X.write(t,{type:k?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return X.write(t,e)}function km(t,e){var a=e||{},n=hm(t,a),i={};if(a.compression&&(i.compression="DEFLATE"),a.password)i.type=k?"nodebuffer":"string";else switch(a.type){case"base64":i.type="base64";break;case"binary":i.type="string";break;case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");case"buffer":case"file":i.type=k?"nodebuffer":"string";break;default:throw new Error("Unrecognized type "+a.type)}var r=n.FullPaths?X.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[i.type]||i.type}):n.generate(i);return a.password&&"undefined"!==typeof encrypt_agile?xm(encrypt_agile(r,a.password),a):"file"===a.type?J(a.file,r):"string"==a.type?Zt(r):r}function Sm(t,e){var a=e||{},n=gf(t,a);return xm(n,a)}function Am(t,e,a){a||(a="");var n=a+t;switch(e.type){case"base64":return x.encode(Qt(n));case"binary":return Qt(n);case"string":return t;case"file":return J(e.file,n,"utf8");case"buffer":return k?S(n,"utf8"):Am(n,{type:"binary"}).split("").map((function(t){return t.charCodeAt(0)}))}throw new Error("Unrecognized type "+e.type)}function Em(t,e){switch(e.type){case"base64":return x.encode(t);case"binary":return t;case"string":return t;case"file":return J(e.file,t,"binary");case"buffer":return k?S(t,"binary"):t.split("").map((function(t){return t.charCodeAt(0)}))}throw new Error("Unrecognized type "+e.type)}function Tm(t,e){switch(e.type){case"string":case"base64":case"binary":for(var a="",n=0;n<t.length;++n)a+=String.fromCharCode(t[n]);return"base64"==e.type?x.encode(a):"string"==e.type?Zt(a):a;case"file":return J(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Im(t,e){Zh(t);var a=e||{};if("array"==a.type){a.type="binary";var n=Im(t,a);return a.type="array",P(n)}switch(a.bookType||"xlsb"){case"xml":case"xlml":return Am(nf(t,a),a);case"slk":case"sylk":return Am(Jf(t,a),a);case"htm":case"html":return Am(Xf(t,a),a);case"txt":return Em(em(t,a),a);case"csv":return Am(Yf(t,a),a,"\ufeff");case"dif":return Am(Zf(t,a),a);case"dbf":return Tm(am(t,a),a);case"prn":return Am(Qf(t,a),a);case"rtf":return Am(tm(t,a),a);case"eth":return Am(nm(t,a),a);case"fods":return Am(qf(t,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),Tm(Of(t,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),Sm(t,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"ods":return km(t,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function Pm(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(t.bookType=a.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Nm(t,e,a){var n=a||{};return n.type="file",n.file=e,Pm(n),Im(t,n)}function Rm(t,e,a,n){var i=a||{};i.type="file",i.file=t,Pm(i),i.type="buffer";var r=n;return r instanceof Function||(r=a),K.writeFile(t,Im(e,i),r)}function Bm(t,e,a,n,i,r,s,o){var l=ca(a),u=o.defval,d=o.raw||!o.hasOwnProperty("raw"),c=!0,p=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:a,enumerable:!1})}catch(y){p.__rowNum__=a}else p.__rowNum__=a;if(!s||t[a])for(var h=e.s.c;h<=e.e.c;++h){var g=s?t[a][h]:t[n[h]+l];if(void 0!==g&&void 0!==g.t){var f=g.v;switch(g.t){case"z":if(null==f)break;continue;case"e":f=void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(null!=r[h]){if(null==f)if(void 0!==u)p[r[h]]=u;else{if(!d||null!==f)continue;p[r[h]]=null}else p[r[h]]=d?f:ka(g,f,o);null!=f&&(c=!1)}}else{if(void 0===u)continue;null!=r[h]&&(p[r[h]]=u)}}return{row:p,isempty:c}}function Om(t,e){if(null==t||null==t["!ref"])return[];var a={t:"n",v:0},n=0,i=1,r=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=null!=u.range?u.range:t["!ref"];switch(1===u.header?n=1:"A"===u.header?n=2:Array.isArray(u.header)&&(n=3),c(d)){case"string":l=wa(d);break;case"number":l=wa(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(i=0);var p=ca(l.s.r),h=[],g=[],f=0,m=0,v=Array.isArray(t),b=l.s.r,y=0,_=0;for(v&&!t[b]&&(t[b]=[]),y=l.s.c;y<=l.e.c;++y)switch(h[y]=fa(y),a=v?t[b][y]:t[h[y]+p],n){case 1:r[y]=y-l.s.c;break;case 2:r[y]=h[y];break;case 3:r[y]=u.header[y-l.s.c];break;default:for(null==a&&(a={w:"__EMPTY",t:"s"}),o=s=ka(a,null,u),m=0,_=0;_<r.length;++_)r[_]==o&&(o=s+"_"+ ++m);r[y]=o}for(b=l.s.r+i;b<=l.e.r;++b){var D=Bm(t,l,b,h,n,r,v,u);(!1===D.isempty||(1===n?!1!==u.blankrows:u.blankrows))&&(g[f++]=D.row)}return g.length=f,g}var Mm=/"/g;function Lm(t,e,a,n,i,r,s,o){for(var l=!0,u=[],d="",c=ca(a),p=e.s.c;p<=e.e.c;++p)if(n[p]){var h=o.dense?(t[a]||[])[p]:t[n[p]+c];if(null==h)d="";else if(null!=h.v){l=!1,d=""+ka(h,null,o);for(var g=0,f=0;g!==d.length;++g)if((f=d.charCodeAt(g))===i||f===r||34===f){d='"'+d.replace(Mm,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==h.f||h.F?d="":(l=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(Mm,'""')+'"'));u.push(d)}return!1===o.blankrows&&l?null:u.join(s)}function Um(t,e){var a=[],n=null==e?{}:e;if(null==t||null==t["!ref"])return"";var i=wa(t["!ref"]),r=void 0!==n.FS?n.FS:",",s=r.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",l=o.charCodeAt(0),u=new RegExp(("|"==r?"\\|":r)+"+$"),d="",c=[];n.dense=Array.isArray(t);for(var p=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(p[g]||{}).hidden||(c[g]=fa(g));for(var f=i.s.r;f<=i.e.r;++f)(h[f]||{}).hidden||(d=Lm(t,i,f,c,s,l,r,n),null!=d&&(n.strip&&(d=d.replace(u,"")),a.push(d+o)));return delete n.dense,a.join("")}function Fm(t,e){e||(e={}),e.FS="\t",e.RS="\n";var a=Um(t,e);if("undefined"==typeof cptable||"string"==e.type)return a;var n=cptable.utils.encode(1200,a,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function $m(t){var e,a="",n="";if(null==t||null==t["!ref"])return[];var i,r=wa(t["!ref"]),s="",o=[],l=[],u=Array.isArray(t);for(i=r.s.c;i<=r.e.c;++i)o[i]=fa(i);for(var d=r.s.r;d<=r.e.r;++d)for(s=ca(d),i=r.s.c;i<=r.e.c;++i)if(a=o[i]+s,e=u?(t[d]||[])[i]:t[a],n="",void 0!==e){if(null!=e.F){if(a=e.F,!e.f)continue;n=e.f,-1==a.indexOf(":")&&(a=a+":"+a)}if(null!=e.f)n=e.f;else{if("z"==e.t)continue;if("n"==e.t&&null!=e.v)n=""+e.v;else if("b"==e.t)n=e.v?"TRUE":"FALSE";else if(void 0!==e.w)n="'"+e.w;else{if(void 0===e.v)continue;n="s"==e.t?"'"+e.v:""+e.v}}l[l.length]=a+"="+n}return l}function Hm(t,e,a){var n,i=a||{},r=+!i.skipHeader,s=t||{},o=0,l=0;if(s&&null!=i.origin)if("number"==typeof i.origin)o=i.origin;else{var u="string"==typeof i.origin?ya(i.origin):i.origin;o=u.r,l=u.c}var d={s:{c:0,r:0},e:{c:l,r:o+e.length-1+r}};if(s["!ref"]){var p=wa(s["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),-1==o&&(o=d.e.r+1,d.e.r=o+e.length-1+r)}var h=i.header||[],g=0;e.forEach((function(t,e){Q(t).forEach((function(a){-1==(g=h.indexOf(a))&&(h[g=h.length]=a);var u=t[a],d="z",p="";!u||"object"!==c(u)||u instanceof Date?("number"==typeof u?d="n":"boolean"==typeof u?d="b":"string"==typeof u?d="s":u instanceof Date&&(d="d",i.cellDates||(d="n",u=st(u)),p=i.dateNF||U._table[14]),s[_a({c:l+g,r:o+e+r})]=n={t:d,v:u},p&&(n.z=p)):s[_a({c:l+g,r:o+e+r})]=u}))})),d.e.c=Math.max(d.e.c,l+h.length-1);var f=ca(o);if(r)for(g=0;g<h.length;++g)s[fa(g+l)+f]={t:"s",v:h[g]};return s["!ref"]=Ca(d),s}function jm(t,e){return Hm(null,t,e)}var Wm={encode_col:fa,encode_row:ca,encode_cell:_a,encode_range:Ca,decode_col:ga,decode_row:da,split_cell:ba,decode_cell:ya,decode_range:Da,format_cell:ka,get_formulae:$m,make_csv:Um,make_json:Om,make_formulae:$m,sheet_add_aoa:Aa,sheet_add_json:Hm,aoa_to_sheet:Ea,json_to_sheet:jm,table_to_sheet:Lf,table_to_book:Uf,sheet_to_csv:Um,sheet_to_txt:Fm,sheet_to_json:Om,sheet_to_html:Mf.from_sheet,sheet_to_formulae:$m,sheet_to_row_object_array:Om};(function(t){function e(e){e.forEach((function(e){t.consts[e[0]]=e[1]}))}function a(t,e,a){return null!=t[e]?t[e]:t[e]=a}function n(t,e,a){return"string"==typeof e?t[e]||(t[e]={t:"z"}):n(t,_a("number"!=typeof e?e:{r:e,c:a||0}))}function i(t,e){if("number"==typeof e){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}if("string"==typeof e){var a=t.SheetNames.indexOf(e);if(a>-1)return a;throw new Error("Cannot find sheet name |"+e+"|")}throw new Error("Cannot find sheet |"+e+"|")}t.consts=t.consts||{},t.book_new=function(){return{SheetNames:[],Sheets:{}}},t.book_append_sheet=function(t,e,a){if(!a)for(var n=1;n<=65535;++n)if(-1==t.SheetNames.indexOf(a="Sheet"+n))break;if(!a)throw new Error("Too many worksheets");if(Yh(a),t.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");t.SheetNames.push(a),t.Sheets[a]=e},t.book_set_sheet_visibility=function(t,e,n){a(t,"Workbook",{}),a(t.Workbook,"Sheets",[]);var r=i(t,e);switch(a(t.Workbook.Sheets,r,{}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n},e([["SHEET_VISIBLE",0],["SHEET_HIDDEN",1],["SHEET_VERY_HIDDEN",2]]),t.cell_set_number_format=function(t,e){return t.z=e,t},t.cell_set_hyperlink=function(t,e,a){return e?(t.l={Target:e},a&&(t.l.Tooltip=a)):delete t.l,t},t.cell_set_internal_link=function(e,a,n){return t.cell_set_hyperlink(e,"#"+a,n)},t.cell_add_comment=function(t,e,a){t.c||(t.c=[]),t.c.push({t:e,a:a||"SheetJS"})},t.sheet_set_array_formula=function(t,e,a){for(var i="string"!=typeof e?e:wa(e),r="string"==typeof e?e:Ca(e),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=n(t,s,o);l.t="n",l.F=r,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=a)}return t}})(Wm),k&&function(){var t={}.Readable,a=function(e,a){var n=t(),i=null==a?{}:a;if(null==e||null==e["!ref"])return n.push(null),n;var r=wa(e["!ref"]),s=void 0!==i.FS?i.FS:",",o=s.charCodeAt(0),l=void 0!==i.RS?i.RS:"\n",u=l.charCodeAt(0),d=new RegExp(("|"==s?"\\|":s)+"+$"),c="",p=[];i.dense=Array.isArray(e);for(var h=i.skipHidden&&e["!cols"]||[],g=i.skipHidden&&e["!rows"]||[],f=r.s.c;f<=r.e.c;++f)(h[f]||{}).hidden||(p[f]=fa(f));var m=r.s.r,v=!1;return n._read=function(){if(!v)return v=!0,n.push("\ufeff");while(m<=r.e.r)if(++m,!(g[m-1]||{}).hidden&&(c=Lm(e,r,m-1,p,o,u,s,i),null!=c)){i.strip&&(c=c.replace(d,"")),n.push(c+l);break}return m>r.e.r?n.push(null):void 0},n},n=function(e,a){var n=t(),i=a||{},r=null!=i.header?i.header:Mf.BEGIN,s=null!=i.footer?i.footer:Mf.END;n.push(r);var o=Da(e["!ref"]);i.dense=Array.isArray(e),n.push(Mf._preamble(e,o,i));var l=o.s.r,u=!1;return n._read=function(){if(l>o.e.r)return u||(u=!0,n.push("</table>"+s)),n.push(null);while(l<=o.e.r){n.push(Mf._row(e,o,l,i)),++l;break}},n},i=function(e,a){var n=t({objectMode:!0});if(null==e||null==e["!ref"])return n.push(null),n;var i={t:"n",v:0},r=0,s=1,o=[],l=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},p=a||{},h=null!=p.range?p.range:e["!ref"];switch(1===p.header?r=1:"A"===p.header?r=2:Array.isArray(p.header)&&(r=3),c(h)){case"string":d=wa(h);break;case"number":d=wa(e["!ref"]),d.s.r=h;break;default:d=h}r>0&&(s=0);var g=ca(d.s.r),f=[],m=0,v=Array.isArray(e),b=d.s.r,y=0,_=0;for(v&&!e[b]&&(e[b]=[]),y=d.s.c;y<=d.e.c;++y)switch(f[y]=fa(y),i=v?e[b][y]:e[f[y]+g],r){case 1:o[y]=y-d.s.c;break;case 2:o[y]=f[y];break;case 3:o[y]=p.header[y-d.s.c];break;default:for(null==i&&(i={w:"__EMPTY",t:"s"}),u=l=ka(i,null,p),m=0,_=0;_<o.length;++_)o[_]==u&&(u=l+"_"+ ++m);o[y]=u}return b=d.s.r+s,n._read=function(){if(b>d.e.r)return n.push(null);while(b<=d.e.r){var t=Bm(e,d,b,f,r,o,v,p);if(++b,!1===t.isempty||(1===r?!1!==p.blankrows:p.blankrows)){n.push(t.row);break}}},n};e.stream={to_json:i,to_html:n,to_csv:a}}(),"undefined"!==typeof hf&&(e.parse_xlscfb=hf),e.parse_zip=cm,e.read=Cm,e.readFile=wm,e.readFileSync=wm,e.write=Im,e.writeFile=Nm,e.writeFileSync=Nm,e.writeFileAsync=Rm,e.utils=Wm,e.SSF=U,"undefined"!==typeof X&&(e.CFB=X)}h(e)}).call(this,a("fd40").Buffer,a("532c"),a("eef6"))},"7b3d":function(t,e,a){"use strict";var n=a("2e6f"),i=a.n(n);i.a},"7b6a":function(t,e,a){},"7ddb":function(t,e,a){},"7ed2":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m_pcform"},[a("div",{staticClass:"bg"}),t._v(" "),a("div",{staticClass:"content"},[a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.setinfo(!1)}}}),t._v(" "),a("div",{staticClass:"buttom_btn"},[a("i",{staticClass:"el-icon-arrow-left buttom_btn_icon",on:{click:t.minus}}),t._v(" "),a("i",{staticClass:"el-icon-arrow-right buttom_btn_icon",on:{click:t.add}}),t._v(" "),a("span",[t._v(t._s(t.nowSowForm+1)+" / "+t._s(t.forms.length))])]),t._v(" "),a("iframe",{attrs:{src:t.formSrc}})])])},i=[],r=a("e793"),s=(a("b130"),{data:function(){return{a:123456,formSrc:"",nowSowForm:0}},props:["forms","appid","instid","sess_id","matterType","status"],mounted:function(){this.setFormSrc()},created:function(){this.setData()},methods:{setinfo:function(t){this.$emit("setinfo",t)},setFormSrc:function(){this.formSrc=window.location.origin+"/v2/matter/preview?formid="+this.forms[this.nowSowForm].form_id+"&app_id="+this.appid+"&inst_id="+this.instid+"&sess_id="+this.sess_id+"&matterType="+this.matterType+"&shade=1&status="+this.status},add:function(){this.nowSowForm+1<this.forms.length&&(++this.nowSowForm,this.setFormSrc())},minus:function(){this.nowSowForm>0&&(--this.nowSowForm,this.setFormSrc())},setData:function(){var t=this.$store.state.form.allplugin,e={};for(var a in t)if(t.hasOwnProperty(a)){t[a].plugins;for(var n in e[a]={},t[a].plugins)if(t[a].plugins.hasOwnProperty(n)){var i=t[a].plugins[n];["dTable","dmultiText","dOneInput"].includes(i.type)||(e[a][n]=i.data)}}window.localStorage.setItem("previewplugindata",JSON.stringify(e))}}}),o=(a("2baf"),Object(r["a"])({name:"m_pcform"},s)),l=o,u=a("9ca4"),d=Object(u["a"])(l,n,i,!1,null,"6ce31c4e",null);e["a"]=d.exports},"7f96":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CODE128C=e.CODE128B=e.CODE128A=e.CODE128=void 0;var n=a("4e33"),i=c(n),r=a("e89f"),s=c(r),o=a("b476"),l=c(o),u=a("ae6a"),d=c(u);function c(t){return t&&t.__esModule?t:{default:t}}e.CODE128=i.default,e.CODE128A=s.default,e.CODE128B=l.default,e.CODE128C=d.default},"7fef":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};e.default=n},8106:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GenericBarcode=void 0;var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("2986"),r=s(i);function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(t,a){return o(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a))}return u(e,t),n(e,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),e}(r.default);e.GenericBarcode=d},8256:function(t,e,a){var n=a("26a2");n("Uint8",(function(t){return function(e,a,n){return t(this,e,a,n)}}))},"829d":function(t,e,a){"use strict";var n=a("5a9e"),i=n.aTypedArray,r=n.exportTypedArrayMethod,s=[].sort;r("sort",(function(t){return s.call(i(this),t)}))},8335:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getTotalWidthOfEncodings=e.calculateEncodingAttributes=e.getBarcodePadding=e.getEncodingHeight=e.getMaximumHeightOfEncodings=void 0;var n=a("dbb9"),i=r(n);function r(t){return t&&t.__esModule?t:{default:t}}function s(t,e){return e.height+(e.displayValue&&t.text.length>0?e.fontSize+e.textMargin:0)+e.marginTop+e.marginBottom}function o(t,e,a){if(a.displayValue&&e<t){if("center"==a.textAlign)return Math.floor((t-e)/2);if("left"==a.textAlign)return 0;if("right"==a.textAlign)return Math.floor(t-e)}return 0}function l(t,e,a){for(var n=0;n<t.length;n++){var r,l=t[n],u=(0,i.default)(e,l.options);r=u.displayValue?c(l.text,u,a):0;var d=l.data.length*u.width;l.width=Math.ceil(Math.max(r,d)),l.height=s(l,u),l.barcodePadding=o(r,d,u)}}function u(t){for(var e=0,a=0;a<t.length;a++)e+=t[a].width;return e}function d(t){for(var e=0,a=0;a<t.length;a++)t[a].height>e&&(e=t[a].height);return e}function c(t,e,a){var n;if(a)n=a;else{if("undefined"===typeof document)return 0;n=document.createElement("canvas").getContext("2d")}n.font=e.fontOptions+" "+e.fontSize+"px "+e.font;var i=n.measureText(t).width;return i}e.getMaximumHeightOfEncodings=d,e.getEncodingHeight=s,e.getBarcodePadding=o,e.calculateEncodingAttributes=l,e.getTotalWidthOfEncodings=u},"83db":function(t,e,a){"use strict";var n=a("5a9e"),i=a("5dfd").some,r=n.aTypedArray,s=n.exportTypedArrayMethod;s("some",(function(t){return i(r(this),t,arguments.length>1?arguments[1]:void 0)}))},8530:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAYAAABxlTA0AAAFrUlEQVR4Xu2cW2gcVRjH/99s1zbZ2Uot6ot9EcRLKZSK2toHsxtsrDdsVUTwqUpfvCAtVbOzwU27kxopFa2CpQUfRASlNkHofWdjRYooingpKKJUvIANaPcSmzbzyZQUkk1s9pydL860Z173O//vf37nn2TnnMwQzCVKgETVjTgMYOEQGMAGsDABYXmTYANYmICwvEmwASxMQFjeJNgAFiYgLG8SbAALExCWDyXBK/v/TM8da3sSjIcA3CzsWVCefgR4IOGP7Tzcc/kPYTRqGXCmr3Y3mN8kYFEYhiKiwQw4Zcfe2qqflgBn3Np6Au9s1URkxzPe8vL2ulb8aQPOuNUuAg600jwWYxkveXm7W9erFuAV27mtbaT2K4AFUxoTvgXjCMB/6Zqa7XHMSMKi24nRMV1vy6JlR7pTX+r40gKccaubCHi5sSEBz5Yc+1UdI1EYk91aXQUf7wOY3+DnsJdLdYGIVX1qAc661eMAbpjcjJ/xnPQOVQNRq+9wq0st4Aug4TDCQpfXbR9S9asLuHElj3uOfZNq86jWZ93KLoCeaPDX7zn2C6qewwHM2Obl7U2qzaNan+mr3U/Mgw3+3vMc+xFVz+EAJurxcqmiavOo1me3VLKwqDTRH4EHS076AVXP4QAGFTwn1avaPKr1nW71TgYaft/ygOek16h6Dgkw93pOuqDaPKr1498mDjb8Ed/rOem1qp4N4GmIxR5wsDmkmoRW6z95/spKsxqxBZzZXFlsJbCbQYubnWyIdb8xs1POp/fMpBlLwIUCW0eTtW8A3DjTBCU/n+Mnrj3U0/bThXrEEvD4/kVdEl4z2kx0TzmX2nfRAQ4mlHUrHwCk/FWnGXBN1pz0z5y5bqiw4IIbUbFMcABg9Ws89/SpWhEWloHP3ev7TYLRLyMQGAkAvxD5W0q5+d/PJBZbwDNNLCqfG8DCK2EAG8DCBITlTYINYGECwvImwQawMAFheZNgA3h6Aufu5Co1F4wlRGCfoXwMPlGZCAkCRn2gVHbsV8LiHtsES+5FMLAhLMixBCy+m8b4ysvbS8NIcSwBi+8HE73u5VJPX7KAg4lLnWgwYZ89mlr3YYFC2W+OZYInJivsMzmV87ZmEh57wM1M8v+sMYCF6RvABrAwAWF5k2ADWJiAsLxJsAEsTEBYPtYJzhQrDxJhiSQjIqqPMr39sZP6XadPbAF3upXNDOrRmbTGmJO+lbhlqLvtZ9WxsQTcUeB5VrI2ojrZ1urZ9Zx0XlUjloAfLvBlw8n6MMC26oR163Wf24sl4ABStlhfA/LfAdCmC63pcQRvZF7q3mMbSPmnJraAAzgd/fVrrLO8hAlkEYf6z3/sBwdRmEMWnSzl2o81vRgNhbEGrDvp2RxnAAvTNoAvOcDmSc//XPJwnpNjLnr59GzdQAjnF+jcWr2Lfeyf2IhAe0pOKngnkdIVDmDgI8+xp32ZhZKbiBRn3UoBoBcn2mHQG2Un9ZSqRV3AfwC4elIz5ju8fPqoqoGo1d9X4PZasnYCwMJJCWY8VsrbwXd4pUsPcF9tB5gbV/NvJqurnGv/VMlBhIpXFSpXjSUxyKDlDba+mzt6esX+3oWnVO1qAV5VrC86S36wylMv5l1MNGSBz+1k+SBL1dRs1ZPPbAG+T4kFgH8rCOsBXDGlP1trvXz7Xh1fWoCDRp1udSMD23SaxmkMMw6U8/ZqXc/agIOGmWJ1NxEe120e+XGEr0fmpW7T2c84P7eWAI9D7ifCc5GHpWyQB/wz9qNDBfpHeeiEAS0DDrQ6ivXlFvFGgIPHZIOnKmN7EfA5M7Z7efvdMCYRCuDzRoK3AVrglQy6HuBkGAZnR8NiEJ9gxmcW+QdLufnDYfUNFXBYpi4mHQNYeDUNYANYmICwvEmwASxMQFjeJNgAFiYgLG8SbAALExCWNwk2gIUJCMubBAsD/heGWaSG+I43tQAAAABJRU5ErkJggg=="},"858b":function(t,e,a){"use strict";function n(t){for(var e=0,a=0;a<t.length;a++){var n=parseInt(t[a]);(a+t.length)%2===0?e+=n:e+=2*n%10+Math.floor(2*n/10)}return(10-e%10)%10}function i(t){for(var e=0,a=[2,3,4,5,6,7],n=0;n<t.length;n++){var i=parseInt(t[t.length-1-n]);e+=a[n%a.length]*i}return(11-e%11)%11}Object.defineProperty(e,"__esModule",{value:!0}),e.mod10=n,e.mod11=i},"87fb":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.sendData&&"dOneInput"==t.sendData.type?a("dOneInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dIntegerInput"==t.sendData.type?a("dIntegerInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dNumericInput"==t.sendData.type?a("dNumericInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dmultiText"==t.sendData.type?a("dmultiText",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dmultiInputs"==t.sendData.type?a("dmultiInputs",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dSelect"==t.sendData.type?a("dSelect",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSelectV2"==t.sendData.type?a("dSelectV2",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRadio"==t.sendData.type?a("dRadio",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dCheckbox"==t.sendData.type?a("dCheckbox",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dInput"==t.sendData.type?a("dInput",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dImage"==t.sendData.type?a("dImage",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dUser"==t.sendData.type?a("dUser",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCountry"==t.sendData.type?a("dCountry",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCountryV2"==t.sendData.type?a("dCountryV2",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dUserSearch"==t.sendData.type?a("dUserSearch",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dMultiple"==t.sendData.type?a("dMultiple",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dOpinion"==t.sendData.type?a("dOpinion",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCalendar"==t.sendData.type?a("dCalendar",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dLink"==t.sendData.type?a("dLink",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dAvatar"==t.sendData.type?a("dAvatar",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dFile"==t.sendData.type?a("dFile",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dDepart"==t.sendData.type?a("dDepart",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dBinding"==t.sendData.type?a("dBinding",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSeal"==t.sendData.type?a("dSeal",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dJoinSign"==t.sendData.type?a("dJoinSign",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dProjectNumber"==t.sendData.type?a("dProjectNumber",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dPasswd"==t.sendData.type?a("dPasswd",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dCount"==t.sendData.type?a("dCount",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSync"==t.sendData.type?a("dSync",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dChildTable"==t.sendData.type?a("dChildTable",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dArticle"==t.sendData.type?a("dArticle",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dHandSignature"==t.sendData.type?a("dHandSignature",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dQuote"==t.sendData.type?a("dQuote",{attrs:{pluginData:t.sendData,forminfo:t.forminfo},on:{sendmessage:t.postMessage}}):t.sendData&&"dRegion"==t.sendData.type?a("dRegion",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dPayment"==t.sendData.type?a("dPayment",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,pluginData:t.sendData,plugin:t.plugin,forminfo:t.forminfo},on:{ptablesendmessage:t.ptablesendmessage,sendmessage:t.postMessage}}):t.sendData&&"dQrcode"==t.sendData.type?a("dQrcode",{attrs:{forminfo:t.forminfo,pluginData:t.sendData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dShow"==t.sendData.type?a("dShow",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSerial"==t.sendData.type?a("dSerial",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dShowHide"==t.sendData.type?a("dShowHide",{attrs:{forminfo:t.forminfo,pluginData:t.sendData,plugin:t.plugin},on:{ptablesendmessage:t.ptablesendmessage,sendmessage:t.postMessage}}):t.sendData&&"dDataSource"==t.sendData.type?a("dDataSource",{attrs:{forminfo:t.forminfo,pluginData:t.sendData,plugin:t.plugin},on:{ptablesendmessage:t.ptablesendmessage,sendmessage:t.postMessage}}):t.sendData&&"dValidate"==t.sendData.type?a("dValidate",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dAlert"==t.sendData.type?a("dAlert",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{ptablesendmessage:t.ptablesendmessage,sendmessage:t.postMessage}}):t.sendData&&"dTable"==t.sendData.type?a("dTable",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{ptablesendmessage:t.ptablesendmessage,rtsendmessage:t.rtpostMessage,sendmessage:t.postMessage}}):t.sendData&&"dOneColumn"==t.sendData.type?a("dOneColumn",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{ptablesendmessage:t.ptablesendmessage,rtsendmessage:t.rtpostMessage,sendmessage:t.postMessage}}):t.sendData&&"dRepeatTable"==t.sendData.type?a("dRepeatTableV3",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,plugin:t.plugin,pluginData:t.sendData,forminfo:t.forminfo},on:{ptablesendmessage:t.ptablesendmessage,rtsendmessage:t.rtpostMessage,sendmessage:t.postMessage}}):t.sendData&&"dPageSplit"==t.sendData.type?a("dPageSplit",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{rtsendmessage:t.rtpostMessage,sendmessage:t.postMessage}}):t.sendData&&"dConversion"==t.sendData.type?a("dConversion",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dXImage"==t.sendData.type?a("dXImage",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRichText"==t.sendData.type?a("dRichText",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dSubmit"==t.sendData.type?a("dSubmit",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dRoom"==t.sendData.type?a("dRoom",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t.sendData&&"dOcr"==t.sendData.type?a("dOcr",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage,ptablesendmessage:t.ptablesendmessage}}):t.sendData&&"dVariate"==t.sendData.type?a("dVariate",{attrs:{pluginData:t.sendData,forminfo:t.forminfo,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e()},i=[],r=a("e793"),s=a("2744"),o={name:"allPlugin",components:Object(r["a"])({},s["a"]),props:["sendmessage","watchmessage","sendrtmessage","rtupdateInfo","plugin","tablesendmessage","forminfo","pluginUpdateInfo"],data:function(){return{sendData:null}},watch:{watchmessage:function(t){this.sendData=t}},methods:{postMessage:function(t){this.$emit("sendmessage",t)},rtpostMessage:function(t){this.$emit("sendrtmessage",t)},ptablesendmessage:function(t){this.$emit("tablesendmessage",t)}},mounted:function(){this.sendData=this.watchmessage}},l=o,u=a("9ca4"),d=Object(u["a"])(l,n,i,!1,null,null,null);e["a"]=d.exports},"88ab":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("2d01"),i=s(n),r=a("858b");function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(t,a){return o(this,e),t+=(0,r.mod11)(t),t+=(0,r.mod10)(t),l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a))}return u(e,t),e}(i.default);e.default=d},"89cd":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){i(this,t),this.api=e}return n(t,[{key:"handleCatch",value:function(t){if("InvalidInputException"!==t.name)throw t;if(this.api._options.valid===this.api._defaults.valid)throw t.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(t){try{var e=t.apply(void 0,arguments);return this.api._options.valid(!0),e}catch(a){return this.handleCatch(a),this.api}}}]),t}();e.default=r},"8a20":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pharmacode=void 0;var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("2986"),r=s(i);function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(t,a){o(this,e);var n=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a));return n.number=parseInt(t,10),n}return u(e,t),n(e,[{key:"encode",value:function(){var t=this.number,e="";while(!isNaN(t)&&0!=t)t%2===0?(e="11100"+e,t=(t-2)/2):(e="100"+e,t=(t-1)/2);return e=e.slice(0,-2),{data:e,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),e}(r.default);e.pharmacode=d},"8a35":function(t,e,a){},"8ade":function(t,e,a){},"8b08":function(t,e,a){"use strict";var n=a("4226"),i=_(n),r=a("dbb9"),s=_(r),o=a("781b"),l=_(o),u=a("cd24"),d=_(u),c=a("0b37"),p=_(c),h=a("a92b"),g=_(h),f=a("89cd"),m=_(f),v=a("0bab"),b=a("7fef"),y=_(b);function _(t){return t&&t.__esModule?t:{default:t}}var D=function(){},C=function(t,e,a){var n=new D;if("undefined"===typeof t)throw Error("No element to render on was provided.");return n._renderProperties=(0,p.default)(t),n._encodings=[],n._options=y.default,n._errorHandler=new m.default(n),"undefined"!==typeof e&&(a=a||{},a.format||(a.format=S()),n.options(a)[a.format](e,a).render()),n};for(var w in C.getModule=function(t){return i.default[t]},i.default)i.default.hasOwnProperty(w)&&x(i.default,w);function x(t,e){D.prototype[e]=D.prototype[e.toUpperCase()]=D.prototype[e.toLowerCase()]=function(a,n){var i=this;return i._errorHandler.wrapBarcodeCall((function(){n.text="undefined"===typeof n.text?void 0:""+n.text;var r=(0,s.default)(i._options,n);r=(0,g.default)(r);var o=t[e],l=k(a,o,r);return i._encodings.push(l),i}))}}function k(t,e,a){t=""+t;var n=new e(t,a);if(!n.valid())throw new v.InvalidInputException(n.constructor.name,t);var i=n.encode();i=(0,l.default)(i);for(var r=0;r<i.length;r++)i[r].options=(0,s.default)(a,i[r].options);return i}function S(){return i.default["CODE128"]?"CODE128":Object.keys(i.default)[0]}function A(t,e,a){e=(0,l.default)(e);for(var n=0;n<e.length;n++)e[n].options=(0,s.default)(a,e[n].options),(0,d.default)(e[n].options);(0,d.default)(a);var i=t.renderer,r=new i(t.element,e,a);r.render(),t.afterRender&&t.afterRender()}D.prototype.options=function(t){return this._options=(0,s.default)(this._options,t),this},D.prototype.blank=function(t){var e=new Array(t+1).join("0");return this._encodings.push({data:e}),this},D.prototype.init=function(){var t;if(this._renderProperties)for(var e in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){t=this._renderProperties[e];var a=(0,s.default)(this._options,t.options);"auto"==a.format&&(a.format=S()),this._errorHandler.wrapBarcodeCall((function(){var e=a.value,n=i.default[a.format.toUpperCase()],r=k(e,n,a);A(t,r,a)}))}},D.prototype.render=function(){if(!this._renderProperties)throw new v.NoElementException;if(Array.isArray(this._renderProperties))for(var t=0;t<this._renderProperties.length;t++)A(this._renderProperties[t],this._encodings,this._options);else A(this._renderProperties,this._encodings,this._options);return this},D.prototype._defaults=y.default,"undefined"!==typeof window&&(window.JsBarcode=C),"undefined"!==typeof jQuery&&(jQuery.fn.JsBarcode=function(t,e){var a=[];return jQuery(this).each((function(){a.push(this)})),C(a,t,e)}),t.exports=C},"8b80":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("2d01"),i=s(n),r=a("858b");function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(t,a){return o(this,e),t+=(0,r.mod10)(t),t+=(0,r.mod10)(t),l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a))}return u(e,t),e}(i.default);e.default=d},"8b99":function(t,e,a){"use strict";var n=a("e281"),i=a.n(n);i.a},"8cea":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,a,n){i(this,t),this.object=e,this.encodings=a,this.options=n}return n(t,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),t}();e.default=r},"8e80":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAABGdBTUEAALGPC/xhBQAABRJJREFUWAnVmU2IHEUUx1/1hJmdZDGH7G60HXIxqBCIYrK6hxyMeolgojdzEkFQWFECCgY9GhQUguCiJ6/eNEvAXFQ85LAxrmgg4EWQZXZMsht1cdbZmcxM+f7VXU13TVd/TM/Oknfp6qp67/2m5vWr6teCCsqtZ2fvbW/Rc1LKIySES5JcIumSoH3cvk0kGtxukJQNIcRyZYIuznxz9UYRt2IY5cYzxw70+p3TDHeKYeYkk2W1wxMl/7glVlksOeUv3W8vr2TV1fMyO4NC/enH9/Vl/11uzrPrsjYy9FVQh3UXHOGcq333I/8r2SQTtDxxolJvr5+RJN9h2L3ZTOeYJWhDkPiwVpk6Ly5daqdppkKrmG3R1ww8l2as6DiDL1Wq9EJazCdCN56ae6wne4sMXCsKlFWfweslUTrlfr/0s03HsQ2sHj96koEvjxMYLPAHv/BvY4tdaX+FAVy1KW53P694i1f8WNyKD6w0YtgPiR0DxoJgwcABHnOBItDIEm3voRtbDJtA4XuEiuJhrnB/BNpPa9YsIaq7aVftQFi/cBv2YNcmDD4HrvB4ENP+xvG7LQ+XDx2m6Q8+IWdykrZ+Xab1994iudkM28rVFnsmaer9j2nikSPUbzZp7eyb1Ll+Ld4G53HegB7QG1Cw0mqnS9g47jn9kgKGVTia/uhTguNhBHrQhx0IFgL2rcJc/k6spihonCX4bt6qxAO9f/6ODFcePjQUuAaGflhM++Exvz3vc5KCVoeflLPExhefUbdRj9jKC24Dhl3YTxTm8w5p/M+oiVI+n6jAg/2/btOtM68NDZ4EDLuwnyo+p/DOFrKR9XhZmt5PM+c/p11uNCu2f7tOa2+/HvtwpgH31m6m8mICZw1ZqQrX6bToZFZgKMJBnhUfFTB8gxMvHA43vEcYvRklK/gogQM0SUcdKei+oCNHIw3cmdmvsouZJfDQ4Z/KGhImEnjFyvHZn3jhc6+2NmaL8X6rRU41enwpCuz5FMucPfgltIDYVnx7gAEqXUe9NReAhmoA/udqrKXujUahkIgY5bd8hx/JDAkyohZ70/9vk/qbm7Fjvea/hPGRCPNyeHBdoqDoLFE++GCspcrBh4ba8mONMS/CoxC0BjazhOx2Iz7zbvkR5fAN83J4yKGhbcDIEjffeGXoLT/MONBmXgelqoGBDB1JwMjDd3hbz7NzZnCppoDXQW0Ne3pWJcxLA9YbR5BVCp4ONZs6ezCv4xVGxBU9kHbNCqztjBSca4Dg9Y6mQlzQTpKueYG1rdGBi0XYVNCoXnIWQTHQKmL3nkJniVRwtp8ozKc4eZKC9sutC0lKe19+lcy0lvcskQQO+ymyoMvCXniAnsutvNobNkWzdJAXWNu1gZv29Xx19d7Gz+m+ABqv5yi36gHz2rz4Fcmet2HcWfmj0FlCg8MOBHZh3ybg0uUDzAnqHrhRdeit9R9QIMG9KSX3fvWa1bn2C8lOahnZVB+4F+UKlQ8/St3VOvUshy0GXqpNTD0ZrltHoGHVr0dfRUlqwMuYOxi4zvXqWbNeHYSH5sEE1IdZoaX7duIK/+AwgcEyAI1OlFf5UPLiToHDL/zHlXnBNxAe6NRy130JADh+KWKKfzl/Qtt+gR/4s62wJogNDz2IK2JKPb1CnE3K42Gd3G183WL78BMXw6a9xPAwJ99V3xFN+OCLraqtySfyVKh4lTD9Cn+1vTCWL7YmPO5VXh/zt/H/AZG91yEKKC++AAAAAElFTkSuQmCC"},9112:function(t,e,a){},9119:function(t,e,a){var n=a("26a2");n("Uint16",(function(t){return function(e,a,n){return t(this,e,a,n)}}))},"91cc":function(t,e,a){"use strict";a("4194");var n=a("e793"),i=a("ce3c"),r=(a("fe59"),a("b130"),a("ecb4"),a("ea69"),a("e18c"),a("e35a"),a("1c2e"),a("90aa"),a("5e9f"),a("0d7a"),a("08ba"),{setSize:function(t){this.pageSize.width=t.width,this.pageSize.height=t.height,this.pageSize.type=t.type,this.setHistory("setSize")},addTable:function(t){var e=this._getTableNode();e.tdid&&(t.margin=0),this._setTableBaseInfo(e,t),this._setTableTdModel(e,0,e.colnum),this._addTableTr(e,0,e.rownum),this.removeSelect(),this.postMessage({oid:"addtable",data:{method:"setStatus",status:!1}}),this.setHistory("addTable")},toShowoutbox:function(t){this.showoutbox=t.show},pluginToDoInfo:function(t){this.pluginUpdateInfo=t},tableSendMessage:function(t){this[t.type]&&this[t.type](t)},doAppEvent:function(t){t.data&&t.data.method&&this.postMessage(t.data)},resetRtable:function(t){var e=this;this.resetTableList.push({method:t.method,key:t.key,data:t}),this.resetTableBar||(this.resetTableBar=setInterval((function(){1==e.resetTableList.length&&(clearInterval(e.resetTableBar),e.resetTableBar=null),e.resetTableList.length&&(e.rtupdateInfo=e.resetTableList.shift())}),100))},updateTrStatus:function(t){for(var e in this.eleidsrelation.table){var a=this.getTableData(e);for(var n in a.trs){var i=a.trs[n],r=[],s=[];for(var o in i.tds){var l=i.tds[o];if(l.dataid){r.push(l.dataid);var u=this.plugin.plugins[l.dataid];u&&!u.status.isshow&&s.push(l.dataid)}}if(r.includes(t.key)){var d=this.isCanHideMegerTD(i.tds);JSON.stringify(r)==JSON.stringify(s)?d&&(a.trs[n].isHide=!0):a.trs[n].isHide=!1}}}},isCanHideMegerTD:function(t){var e=!0,a={};for(var n in this.plugin.plugins){var i=this.plugin.plugins[n];a[i.tdid]=i}for(var r in t){var s=t[r];if(0===s.colspan&&0===s.rowspan){for(var o in this.mergeInfo){var l=this.mergeInfo[o],u=(i=a[o],{});for(var d in this.plugin.plugins)this.plugin.plugins.hasOwnProperty(d)&&this.plugin.plugins[d].tdid==o&&(u=this.plugin.plugins[d]);if(l.mergeIds.includes(s.id)&&i&&(i.status.isshow||u.status.isshow)){e=!1;break}}if(!e)break}}return e},_getTableNode:function(){var t=this.appCommonH.copyObj(this.initTable),e=this.selectData.selectIds[0];if(1==this.selectData.selectIds.length&&""==this.selectById("td",this.selectById("table",e))){var a={};return this.tableData.trs.forEach((function(n,i){n.tds.forEach((function(n,i){n.id==e&&(t.tdid=e,n.table=t,a=n.table)}))})),a}return this.tableData=t,this.tableData},_setTableBaseInfo:function(t,e){t.style.margin=e.margin,t.rownum=e.rownum,t.colnum=e.colnum,t.tdid?(t.width=$('[data-id="'+t.tdid+'"]').innerWidth(),t.id=this.getTableId("table",t.tdid,this.selectById("tr",t.tdid),this.selectById("table",t.tdid))):(t.width=this.pageSize.width-2*t.style.margin,t.id=this.getTableId("table","","",""))},_setTableTdModel:function(t,e,a,n){void 0===n&&(n=t.width/t.colnum);for(var i=0;i<a;i++)t.tdModels.splice(e+i,0,{width:n})},_addTableTr:function(t,e,a){for(var n=null,i=0;i<a;i++)n=this._getTrData(t.id,t.colnum),t.trs.splice(e+i,0,n)},_getPrintTrData:function(t,e){var a=this.appCommonH.copyObj(this.initTr);return a.style.height=this.tableStyle.printDefaultHeight,a.id=this.getTableId("tr","","",t),a.type="print",a.tds.push(this._getTdData(t,a.id)),a.tds[0].colspan=e,a.tds[0].style.borderStyle=a.tds[0].style.borderStyle+" dashed",a.tds[0].style.borderColor=a.tds[0].style.borderColor+" #BBBBB1",a.tds[0].style.borderWidth=a.tds[0].style.borderWidth,a},_getTrData:function(t,e){var a=this.appCommonH.copyObj(this.initTr);a.style.height=this.tableStyle.defaultHeight,a.id=this.getTableId("tr","","",t);for(var n=0;n<e;n++)a.tds.push(this._getTdData(t,a.id));return a},_getTdData:function(t,e){var a=this.appCommonH.copyObj(this.initTd);return a.style.borderColor=this.tableStyle.borderColor,a.style.borderStyle=this.tableStyle.borderStyle,a.style.borderWidth=this.tableStyle.borderWidth,a.id=this.getTableId("td","",e,t),a},getTrIndexByTdid:function(t){return $('[data-id="'+t+'"]').parent("tr").index()-1},getTdIndexByTdid:function(t){return $('[data-id="'+t+'"]').index()},getTableData:function(t){var e=this.selectById("td",t),a={};return e?this.tableData.trs.forEach((function(t){return t.tds.forEach((function(t){return t.id==e&&(a=t.table,!0)}))})):a=this.tableData,a},selectById:function(t,e){var a=e.split("_")[0];return this.eleidsrelation[a]&&this.eleidsrelation[a][e]?this.eleidsrelation[a][e][t]:""},getTableId:function(t,e,a,n){t=void 0!==t?t:"table";var i=+Math.random().toString().substring(2),r=(new Date).getTime(),s=t+"_"+(r+i);return this.eleidsrelation[t][s]={table:n,tr:a,td:e},s},getStyle:function(t,e,a,n,i,r){return"table"!=a||this.formmodeedit||("dashed"==t.borderStyle&&(t.borderColor="transparent",!t.borderTopStyle&&t.borderTopColor&&(t.borderTopColor="transparent"),!t.borderBottomStyle&&t.borderBottomColor&&(t.borderBottomColor="transparent")),"dashed"==t.borderTopStyle&&(t.borderTopColor="transparent"),"dashed"==t.borderBottomStyle&&(t.borderBottomColor="transparent"),"dashed"==t.borderLeftStyle&&(t.borderLeftColor="transparent"),"dashed"==t.borderRightStyle&&(t.borderRightColor="transparent"),t.borderStyle&&t.borderColor&&-1!==t.borderStyle.indexOf("dashed")&&(t.borderColor=t.borderColor.replace("#BBBBB1","transparent")),"print"==n&&(i&&(t.borderTopColor="transparent"),r&&(t.borderBottomColor="transparent"))),this.appCommonH.getStyle(t,e)},getOtherStyle:function(t,e,a,n){var i=this.selectById("table",t),r=this.getTableData(i),s=this.isPrintStyle&&this.isFullChildTable(i),o={},l=this.mergeInfo[t]?this.mergeInfo[t]:{rowStart:0,rowEnd:0,colStart:0,colEnd:0},u=l.rowEnd-l.rowStart,d=l.colEnd-l.colStart;return e++,a++,this.selectById("td",i)&&(1==e?o["borderTopWidth"]="0px":(o["borderTopWidth"]=n.borderWidth,o["borderTopStyle"]=n.borderStyle,o["borderTopColor"]=n.borderColor),e+u==r.rownum?o["borderBottomWidth"]="0px":(o["borderBottomWidth"]=n.borderWidth,o["borderBottomStyle"]=n.borderStyle,o["borderBottomColor"]=n.borderColor),1!=a||s?(o["borderLeftWidth"]=n.borderWidth,o["borderLeftStyle"]=n.borderStyle,o["borderLeftColor"]=n.borderColor):o["borderLeftWidth"]="0px",a+d!=r.colnum||s?(o["borderRightWidth"]=n.borderWidth,o["borderRightStyle"]=n.borderStyle,o["borderRightColor"]=n.borderColor):o["borderRightWidth"]="0px"),o},isFullChildTable:function(t,e){var a=!1,n=!1;if(t){var i=this.getTableData(t);i.trs.forEach((function(t){"print"==t.type&&(a=!0)}))}if(e&&$('[data-id="'+e+'"]').find("div")){var r=$('[data-id="'+e+'"]').find("div").attr("data-key");r=r||"",-1===r.indexOf("RepeatTable_")||$.isEmptyObject(this.getRepeatPrintInfo[r])||(n=!0)}e=e||this.selectById("td",t);var s=this.selectById("table",e),o=this.mergeInfo[e]?this.mergeInfo[e]:"",l=s==this.tableData.id&&o&&o.mergeIds.length==this.tableData.tdModels.length-1;return l&&(a||n)},getTdStyleByTdInfo:function(t){return this.appCommonH.mergeObj(t.table.id?{padding:"0px"}:{},t.dataid?this.plugin.plugins[t.dataid].attr.style.tdStyle:{},this.isFullChildTable("",t.id)&&this.isPrintStyle?{borderWidth:"0px"}:{})},changeBorderCollapse:function(t){$('[data-id="'+t+'"]').css({borderSpacing:"1px"}),setTimeout((function(){$('[data-id="'+t+'"]').css({borderSpacing:"0px"})}),50)},changeTableWidth:function(t,e){$('[data-id="'+t+'"]').css({width:e+"px"})},changeCursor:function(t){$("body").css({cursor:t})},checkCanAddTable:function(){if(1!==this.selectData.selectIds.length)return!1;var t=this.selectData.selectIds[0];return!this.selectById("td",this.selectById("table",t))},checkTdCanSelect:function(t){var e=!0,a=this.selectById("table",t),n=this.getTableData(a);for(var i in this.eleidsrelation.table)this.eleidsrelation.table[i].td==t&&(e=!1);return n.trs.forEach((function(a,n){a.tds.forEach((function(a,n){a.dataid&&t==a.id&&(e=!1)}))})),e},checkTdIsHas:function(t,e){var a=!1;if(e){for(var n in this.plugin.plugins)if("dRepeatTable"==this.plugin.plugins[n].type&&this.checkTdIsHasInNowData(t,this.plugin.plugins[n].attr.data)){a=!0;break}}else{var i=this.selectById("table",t),r=this.getTableData(i);r.trs&&this.checkTdIsHasInNowData(t,r)&&(a=!0)}return a},checkTdIsHasInNowData:function(t,e){var a=!1;return e.trs.forEach((function(e,n){e.tds.forEach((function(e,n){t==e.id&&(a=!0)}))})),a},tdChangeMousemove:function(t){if(!this.formmodeedit)return!1;var e=t.target;if("TD"==e.tagName&&(t.offsetX>=e.offsetWidth-10?this.changeCursor("col-resize"):this.changeCursor("default")),this.tdChangeInfo.nowTarget){var a=t.x-this.tdChangeInfo.oldEventX,n=$(this.tdChangeInfo.nowTarget).index(),i=this.getTableData(this.selectById("table",$(this.tdChangeInfo.nowTarget).attr("data-id"))),r=i.tdModels[n].width+a;r=r<10?10:r,i.tdModels[n].width=r,i.width=i.width+a,this.changeTableWidth(i.id,i.width),this.tdChangeInfo.oldEventX=t.x}return!1},tdChangeMousedown:function(t){if(!this.formmodeedit)return!1;t.offsetX>=t.target.offsetWidth-10&&"TD"==t.target.tagName&&(this.selectData.start.id="",this.selectData.selectIds=[],this.tdChangeInfo.nowTarget=t.target,this.tdChangeInfo.oldEventX=t.x)},tdChangeMouseup:function(t){this.tdChangeInfo.nowTarget=null,this.tdChangeInfo.oldEventX=0,this.changeCursor("default")},tdPrintMouseDown:function(t,e){var a=this,n=this.getTableData(this.selectById("table",e));n.trs.forEach((function(t){t.id==e&&(a.tdPrint.trData=t)})),this.tdPrint.oldEventY=t.y},tdPrintMouseMove:function(t){if(!this.tdPrint.trData)return!1;var e=t.originalEvent.y-this.tdPrint.oldEventY,a=this.tdPrint.trData.style.height,n=a+e>this.tableStyle.printDefaultHeight?a+e:this.tableStyle.printDefaultHeight;this.tdPrint.trData.style.height=n,this.tdPrint.oldEventY=t.originalEvent.y,this.changeBorderCollapse(this.selectById("table",this.tdPrint.trData.id))},tdPrintMouseUp:function(){this.tdPrint.oldEventY="",this.tdPrint.trData=null}}),s={mergeTd:function(){var t=this,e=this.getTableData(this.selectData.tableid),a="",n=this.getMinMax(this.selectData.start.row,this.selectData.end.row,this.selectData.start.col,this.selectData.end.col),i=n.minrow,r=n.maxrow,s=n.mincol,o=n.maxcol;e.trs.forEach((function(e,n){e.tds.forEach((function(e,l){n>=i&&n<=r&&l>=s&&l<=o&&(n==i&&l==s?(e.rowspan=r-i+1,e.colspan=o-s+1,a=e.id):(e.rowspan=0,e.colspan=0),t.mergeInfo[e.id]&&delete t.mergeInfo[e.id],t.saveMergeInfo(e.id,a,i,r,s,o))}))})),this.removeSelect(),this.changeBorderCollapse(e.id),this.setHistory("mergeTd")},sliptTd:function(){if(!this.selectData.selectIds.length)return!1;var t=this.selectData.selectIds[0],e=(this.selectById("table",t),this.mergeInfo[t].mergeIds),a=this.getTableData(this.selectData.tableid);a.trs.forEach((function(a,n){a.tds.forEach((function(a,n){(t==a.id||e.includes(a.id))&&(a.rowspan=1,a.colspan=1)}))})),delete this.mergeInfo[t],this.removeSelect(),this.changeBorderCollapse(a.id),this.setHistory("sliptTd")},tdMouserdown:function(t,e){return!(!this.formmodeedit&&!this.isPrintMake)&&(!!this.checkTdCanSelect(t)&&(this.changeBorderCollapse(this.selectData.tableid),this.selectData.tableid=this.selectById("table",t),this.selectData.start.id=t,this.selectData.start=Object(n["a"])(Object(n["a"])({},this.selectData.start),this.getRowCol(e,"start")),this.removeSelect(),this.selectData.selectIds.push(t),this.selectData.selectIds=this.appCommonH.copyObj(this.selectData.selectIds),void this.changeBorderCollapse(this.selectData.tableid)))},tdMouseover:function(t,e){return!!this.formmodeedit&&(!(!this.checkTdCanSelect(t)||!this.selectData.start.id||this.selectById("table",t)!=this.selectData.tableid)&&(this.selectData.end.id=t,this.selectData.end=Object(n["a"])(Object(n["a"])({},this.selectData.end),this.getRowCol(e,"end")),this.setSelectTd(this.selectData.tableid,this.selectData.start.row,this.selectData.end.row,this.selectData.start.col,this.selectData.end.col),!1))},isDownDirection:function(t,e,a){if(this.selectData.selectIds.length>=1){this.getTrIndexByTdid(t),this.getTdIndexByTdid(t);var i={trIndex:this.getTrIndexByTdid(e),tdIndex:this.getTdIndexByTdid(e)};if(this.mergeInfo[t]){var r=this.getMergeTdInfo(t);i.trIndex<=r.cutline.trIndex&&i.tdIndex<=r.cutline.tdIndex&&(this.selectData.start.row=r.bottomright.trIndex,this.selectData.start.col=r.bottomright.tdIndex),i.trIndex<r.cutline.trIndex&&i.tdIndex>r.cutline.tdIndex&&(this.selectData.start.row=r.bottomleft.trIndex,this.selectData.start.col=r.bottomleft.tdIndex),i.trIndex>r.cutline.trIndex&&i.tdIndex<r.cutline.tdIndex&&(this.selectData.start.row=r.topright.trIndex,this.selectData.start.col=r.topright.tdIndex),i.trIndex>=r.cutline.trIndex&&i.tdIndex>=r.cutline.tdIndex&&(this.selectData.start.row=r.topleft.trIndex,this.selectData.start.col=r.topleft.tdIndex)}this.mergeInfo[e]&&(this.selectData.end=Object(n["a"])(Object(n["a"])({},this.selectData.end),this.getRowCol(a,"start")))}return!0},getMergeTdInfo:function(t){var e=this.mergeInfo[t];return{topleft:{trIndex:e.rowStart,tdIndex:e.colStart},topright:{trIndex:e.rowStart,tdIndex:e.colEnd},bottomleft:{trIndex:e.rowEnd,tdIndex:e.colStart},bottomright:{trIndex:e.rowEnd,tdIndex:e.colEnd},cutline:{trIndex:e.rowStart-1+Math.ceil((e.rowEnd-e.rowStart)/2),tdIndex:e.colStart-1+Math.ceil((e.colEnd-e.colStart)/2)}}},tdMouseup:function(t,e){return this.selectData.start.id="",!1},toMouseout:function(t){this.selectData.tableid==t&&this.tdMouseup(t)},saveMergeInfo:function(t,e,a,n,i,r){t==e?(this.mergeInfo[e]={},this.mergeInfo[e].rowStart=a,this.mergeInfo[e].rowEnd=n,this.mergeInfo[e].colStart=i,this.mergeInfo[e].colEnd=r,this.mergeInfo[e].mergeIds=[]):this.mergeInfo[e].mergeIds.push(t)},getMinMax:function(t,e,a,n){var i={minrow:0,maxrow:0,mincol:0,maxcol:0};return e>=t?(i.minrow=t,i.maxrow=e):(i.minrow=e,i.maxrow=t),n>=a?(i.mincol=a,i.maxcol=n):(i.mincol=n,i.maxcol=a),i},getRowCol:function(t,e){var a=$(t.target).attr("data-id"),n=this.mergeInfo[a]?this.mergeInfo[a]:null,i=0,r=0;return n?(i=n["row"+this.appCommonH.firstUppercase(e)],r=n["col"+this.appCommonH.firstUppercase(e)]):(i=$(t.target).parent("tr").index()-1,r=$(t.target).index()),{row:i,col:r}},checkCanMerge:function(){var t=this,e=!0;return this.selectData.selectIds.forEach((function(a){var n=t.mergeInfo[a]?t.mergeInfo[a]:null;for(var i in $('[data-id="'+a+'"]').find(".printLine").length&&(e=!1),t.mergeInfo)if(t.mergeInfo[i].mergeIds.includes(a)){n=t.mergeInfo[i];break}if(n&&n.mergeIds.forEach((function(a){if(!t.selectData.selectIds.includes(a))return e=!1,!1})),!e)return!1})),e},removeResetMergeInfo:function(){var t=this;for(var e in this.mergeInfo){var a=!1,n=this.mergeInfo[e],i=this.appCommonH.copyObj(n.mergeIds),r=[],s=-1,o=-1;if(i.push(e),i.forEach((function(n,i){if(t.eleidsrelation.td[n]){var l=t.getTrIndexByTdid(n),u=t.getTdIndexByTdid(n);n!==e&&r.push(n),s=l>s?l:s,o=u>o?u:o}else a=!0})),a){n.mergeIds=r,n.rowEnd=s,n.colEnd=o,0===n.mergeIds.length&&this.$delete(this.mergeInfo,e);var l=this.selectById("table",e),u=this.getTableData(l);u.trs.forEach((function(t,a){t.tds.forEach((function(t,a){t.id==e&&(t.rowspan=n.rowEnd-n.rowStart+1,t.colspan=n.colEnd-n.colStart+1)}))})),t.changeBorderCollapse(u.id)}}},addResetMergeInfo:function(){var t=this;for(var e in this.mergeInfo){var a=this.mergeInfo[e],n=this.getTrIndexByTdid(e),i=-1,r=this.getTdIndexByTdid(e),s=-1;if(a.mergeIds.forEach((function(e,a){var n=t.getTrIndexByTdid(e),r=t.getTdIndexByTdid(e);i=n>i?n:i,s=r>s?r:s})),a.rowEnd!==i||a.colEnd!==s){a.rowStart=n,a.rowEnd=i,a.colStart=r,a.colEnd=s;var o=this.selectById("table",e),l=this.getTableData(o);n=a.rowStart,i=a.rowEnd,r=a.colStart,s=a.colEnd;l.trs.forEach((function(a,o){a.tds.forEach((function(a,l){o>=n&&o<=i&&l>=r&&l<=s&&(o==n&&l==r?(a.rowspan=i-n+1,a.colspan=s-r+1):(a.rowspan=0,a.colspan=0),t.mergeInfo[a.id]&&delete t.mergeInfo[a.id],t.saveMergeInfo(a.id,e,n,i,r,s))}))})),this.changeBorderCollapse(l.id)}}},perfectMergeInfo:function(){var t={};for(var e in this.eleidsrelation.table){var a=this.getTableData(e);a.trs.forEach((function(e,a){e.tds.forEach((function(e,n){for(var i in(e.rowspan>1||e.colspan>1)&&(t[e.id]={rowStart:a,rowEnd:a+e.rowspan-1,colStart:n,colEnd:n+e.colspan-1,mergeIds:[]}),t){var r=t[i];a>=r.rowStart&&a<=r.rowEnd&&n>=r.colStart&&n<=r.colEnd&&(a==r.rowStart&&n==r.colStart||r.mergeIds.push(e.id))}}))}))}JSON.stringify(this.mergeInfo)==JSON.stringify(t)?this.$message({type:"warning",message:"未发现可修复合并数据"}):(this.mergeInfo=t,this.$message({type:"success",message:"修复成功"}))}},o={setSelectTd:function(t,e,a,n,i){var r=this.getTableData(t),s=[],o=this.getMinMax(e,a,n,i),l=o.minrow,u=o.maxrow,d=o.mincol,c=o.maxcol;r.trs.forEach((function(t,e){t.tds.forEach((function(t,a){e>=l&&e<=u&&a>=d&&a<=c&&(s.includes(t.id)||s.push(t.id))}))})),this.selectData.selectIds=s},removeSelect:function(t){this.selectData.selectIds=[],this.rtupdateInfo={method:"updateSelectData",data:[]}},isSelect:function(t){return this.selectData.selectIds.includes(t)&&this.formmodeedit?"selected":""}},l=a("69c6"),u=(a("b4fb"),{checkAlertStatus:function(t){if(1!==this.selectData.selectIds.length&&!t)return!1;this.operationAlert={removeRow:!0,topAddRow:!0,bottomAddRow:!0,removeCol:!0,leftAddCol:!0,rightAddCol:!0,removeTable:!0,prevPrint:!0,nextPrint:!0};var e=this.selectData.selectIds[0]?this.selectData.selectIds[0]:t,a=this.getTrIndexByTdid(e),n=this.getTdIndexByTdid(e),i=this.selectById("table",e),r=this.getTableData(i);return this.operationAlert.removeRow=this.checkRemoveRow(e,a,n,i,r),this.operationAlert.removeCol=this.checkRemoveCol(e,a,n,i,r),this.tdPrintMouseUp(),!0},checkRemoveRow:function(t,e,a,n,i){var r=this,s=!0;if(s=this.forEachMerge((function(t,a,i,s,o){var l=r.getTrIndexByTdid(o);return l!=e||s.rowStart==s.rowEnd||i!=n})),1==i.trs.length&&(s=!1),!this.formmodeedit&&this.isPrintMake){var o=this.selectById("tr",t);i.trs.forEach((function(t){t.id==o&&"print"!=t.type&&(s=!1)}))}return s},checkRemoveCol:function(t,e,a,n,i){var r=this,s=!0;return s=this.forEachMerge((function(e,n,i,s,o){var l=r.getTdIndexByTdid(o);return t!=o||l!=a||s.colStart==s.colEnd})),1==i.trs[0].tds.length&&(s=!1),s},forEachMerge:function(t){var e=this,a=!0;for(var n in this.mergeInfo){var i=this.appCommonH.copyObj(this.mergeInfo[n].mergeIds);i.unshift(n),i.forEach((function(i){var r=e.getTrIndexByTdid(i),s=e.getTdIndexByTdid(i),o=e.selectById("table",i);t(r,s,o,e.mergeInfo[n],n)||(a=!1)}))}return a},totopvalue:function(t,e){"up"==t?this.upRowNum=e.target.value.replace(/[^\d]/g,""):"down"==t?this.downRowNum=e.target.value.replace(/[^\d]/g,""):"left"==t?this.leftColNum=e.target.value.replace(/[^\d]/g,""):"right"==t&&(this.rightColNum=e.target.value.replace(/[^\d]/g,""))},removeRow:function(){var t=this.selectData.selectIds[0],e=$('[data-id="'+t+'"]').parent("tr").attr("data-id"),a=this.getTableData(this.selectById("table",t)),n=[];a.rownum=+a.rownum-1,a.trs.forEach((function(t){t.id!==e?n.push(t):t})),a.trs=n,this.removeEleidTr(e),this.removeSelect(),this.changeBorderCollapse(a.id),this.$nextTick((function(){this.removeResetMergeInfo(),this.setHistory("removeRow")}))},addRow:function(t,e){var a=this,n=this.selectData.selectIds[0],i=this.selectById("table",n),r=($('[data-id="'+n+'"]').parent("tr").attr("data-id"),this.getTrIndexByTdid(n)),s=this.getTableData(i),o=[],l=this.mergeInfo[n],u=[],d="up"==t?this.upRowNum:this.downRowNum;if(e&&"down"==t&&l&&(r+=l.rowEnd-l.rowStart),e)u.push(a["_getPrintTrData"](i,s.colnum)),s.rownum=+s.rownum+1;else{if(!d)return this.$message("请输入行数"),!1;if(d<1||d>100)return this.$message("批量插入只能是整数1-100之间"),!1;for(var c=0;c<d;c++)u.push(a["_getTrData"](i,s.colnum));s.rownum=+s.rownum+ +a.upRowNum}s.trs.forEach((function(e,a){"up"==t&&a==r?(o.push.apply(o,u),o.push(e)):"down"==t&&a==r?(o.push(e),o.push.apply(o,u)):o.push(e)})),s.trs=o,s=this.appCommonH.copyObj(s),this.removeSelect(),this.isPrintStyle&&this.setTableTrColor(u[0].id,this.printBorderColor),this.changeBorderCollapse(s.id),this.$nextTick((function(){this.addResetMergeInfo(),this.setHistory("addRow")})),e||$(".operationalert").hide(),this.upRowNum=1,this.downRowNum=1},removeCol:function(){var t=this,e=this.selectData.selectIds[0],a=this.getTdIndexByTdid(e),n=this.getTableData(this.selectById("table",e)),i=a;n.colnum=+n.colnum-1;var r=n.tdModels.splice(i,1)[0];n.width=n.width-r.width,this.changeTableWidth(n.id,n.width),n.trs.forEach((function(e,a){var n=e.tds.splice(i,1);t.removeEleidTd(n[0].id)})),n=this.appCommonH.copyObj(n),this.removeSelect(),this.changeBorderCollapse(n.id),this.$nextTick((function(){this.removeResetMergeInfo(),this.setHistory("removeCol")}))},addCol:function(t){var e,a=this,n=this.selectData.selectIds[0],i=this.getTdIndexByTdid(n),r=this.getTableData(this.selectById("table",n)),s=i+1+("right"==t?0:-1),o="left"==t?this.leftColNum:this.rightColNum,l=[];if(!o)return this.$message("请输入列数"),!1;if(o<1||o>100)return this.$message("批量插入只能是整数1-100之间"),!1;for(var u=0;u<o;u++)l.push({width:this.tableStyle.defaultWidth});r.colnum=+r.colnum+ +o,r.width=r.width+this.tableStyle.defaultWidth*o,(e=r.tdModels).splice.apply(e,[s,0].concat(l)),this.changeTableWidth(r.id,r.width),r.trs.forEach((function(t,e){for(var n,i=[],l=0;l<o;l++)i.push(a._getTdData(r.id,t.id));(n=t.tds).splice.apply(n,[s,0].concat(i))})),r=this.appCommonH.copyObj(r),this.removeSelect(),this.changeBorderCollapse(r.id),this.$nextTick((function(){this.addResetMergeInfo(),this.setHistory("addCol")})),$(".operationalert").hide(),this.leftColNum=1,this.rightColNum=1},removeTable:function(){var t=this.selectData.selectIds[0],e=this.selectById("table",t),a=this.selectById("td",e);a?this.tableData.trs.forEach((function(t,e){t.tds.forEach((function(t,e){a==t.id&&(t.table={})}))})):this.tableData={},this.removeSelect(),this.removeTableInfo(e),this.setHistory("removeTable")},removeTableById:function(t){var e=this.selectById("td",t);e?this.tableData.trs.forEach((function(t,a){t.tds.forEach((function(t,a){e==t.id&&(t.table={})}))})):this.tableData={},this.removeSelect(),this.removeTableInfo(t),this.setHistory("removeTable")},removeTableInfo:function(t){for(var e in this.mergeInfo)this.selectById("table",e)==t&&delete this.mergeInfo[e];this.removeEleidTable(t)},removeEleidTable:function(t){for(var e in this.eleidsrelation)if("td"!=e)for(var a in this.eleidsrelation[e])"table"==e?a==t&&delete this.eleidsrelation[e][a]:this.eleidsrelation[e][a].table==t&&"tr"==e&&this.removeEleidTr(a)},removeEleidTr:function(t){for(var e in this.eleidsrelation)if("table"!=e)for(var a in this.eleidsrelation[e])"tr"==e?a==t&&delete this.eleidsrelation[e][a]:"td"==e&&this.eleidsrelation[e][a].tr==t&&this.removeEleidTd(a)},removeEleidTd:function(t){for(var e in this.eleidsrelation)if("td"==e)for(var a in this.eleidsrelation[e])for(var n in a==t&&delete this.eleidsrelation[e][a],this.eleidsrelation.table)this.eleidsrelation.table[n].td==t&&this.removeEleidTable(n)}}),d=(a("f3dd"),a("0a51"),a("6367")),c=a("2744"),p={removePlugin:function(){if(!this.selectPlugins.length)return!1;var t=this;this.selectPlugins.forEach((function(e){t.delPlugin(e)})),this.setHistory("removePlugin")},addPlugin:function(t){if(t.type&&c["a"][t.type]){if(1==this.selectPlugins.length&&1!=this.selectData.selectIds.length&&1!=this.rtselectData.length&&(this.delPluginSelectTd(this.selectPlugins[0]),this.setPluginAttr(this.selectPlugins[0],!1)),1==this.selectData.selectIds.length){var e=this,a=this.selectData.selectIds[0],n=this.getTableData(this.selectData.tableid);n.trs.forEach((function(n,i){n.tds.forEach((function(n,i){a==n.id&&(n.dataid=t.isshear?t.key:e.createPluginNum(t.columnType),e.addPluginData(n.dataid,t,a,"plugins"))}))})),this.changeBorderCollapse(n.id),this.removeSelect()}else if(1==this.rtselectData.length){e=this,a=this.rtselectData[0].id,n=this.plugin.plugins[this.rtselectData[0].key].attr.data;n.trs.forEach((function(n,i){n.tds.forEach((function(n,i){a==n.id&&(n.dataid=t.isshear?t.key:e.createPluginNum(t.columnType),e.addPluginData(n.dataid,t,a,"rtplugins",e.rtselectData[0].key))}))})),this.removeSelect()}this.selectPlugins=this.appCommonH.copyObj(this.selectPlugins),this.plugin=this.appCommonH.copyObj(this.plugin),this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:this.appCommonH.copyObj(this.plugin)}),this.setHistory("addPlugin")}},addOutPlugin:function(t){if(t.type&&c["a"][t.type]){var e=this.createPluginNum(t.columnType);this.addPluginData(e,t,"","plugins")}},createPluginNum:function(t){return this.plugin.nowNum++,t+"_"+this.plugin.nowNum},addPluginData:function(t,e,a,i,r){var s=this.appCommonH.copyObj(this.initPlugin);s.tdid=a,s.key=t,s.columnType=e.columnType,s.classtype=void 0!==e.classtype?e.classtype:s.classtype,void 0!==e.description&&(s.description=e.description),void 0!==e.initdata&&(s.initdata=e.initdata,s.data=e.initdata),(e.iscopy||e.isshear)&&(s.data=e.data),void 0!==e.type&&(s.type=e.type),void 0!==e.pluginname&&(s.pluginname=e.pluginname),void 0!==e.mobileshow&&(s.mobileshow=e.mobileshow),void 0===e.sort||e.iscopy?s.sort=10*this.plugin.nowNum+2e3:s.sort=e.sort,void 0!==e.attr&&(e.attr.style&&(s.attr.style=Object(n["a"])(Object(n["a"])({},s.attr.style),e.attr.style)),e.attr.data&&(s.attr.data=Object(n["a"])(Object(n["a"])({},s.attr.data),e.attr.data)),e.attr.setInfo&&(s.attr.setInfo=Object(n["a"])(Object(n["a"])({},s.attr.setInfo),e.attr.setInfo))),void 0!==e.status&&(s.status=Object(n["a"])(Object(n["a"])({},s.status),e.status)),void 0!==r&&(s.pkey=r),s=this.appCommonH.copyObj(s),"rtplugins"==i&&this.plugin[i]instanceof Array&&(this.plugin[i]={}),this.$set(this.plugin[i],t,s),"dRepeatTable"==s.type?this.addRepeatTable(s):this.addSelectPlugin(t,!0)},delPluginByTdId:function(t){var e=this.getTableData(this.selectById("table",t)),a=this;e.trs.forEach((function(e,n){e.tds.forEach((function(e,n){e.id==t&&e.dataid&&a.delPlugin(e.dataid)}))}))},delPlugin:function(t){var e=this.getPluginType(t),a=this.plugin[e][t];if(!a)return!1;this.$delete(this.plugin[e],a.key);var n={};if(n=a.pkey?this.plugin.plugins[a.pkey].attr.data:this.getTableData(this.selectById("table",a.tdid)),n.trs.forEach((function(t,e){t.tds.forEach((function(t,e){a.tdid==t.id&&(t.dataid="")}))})),this.selectPlugins.includes(t)){var i=[];this.selectPlugins.forEach((function(e){e!==t&&i.push(e)})),this.selectPlugins=i}},addSelectPlugin:function(t,e){if(this.selectPlugins.includes(t))return!1;var a=this;e&&(this.selectPlugins.forEach((function(t){a.selectPlugins.includes(t)&&a.setPluginAttr(t,!1)})),this.selectPlugins=[]),this.selectPlugins.push(t),this.selectPlugins=this.appCommonH.copyObj(this.selectPlugins),this.selectPlugins.forEach((function(t){a.setPluginAttr(t,!0)}))},removeAllSelectPlugin:function(){if(!this.selectPlugins.length)return!1;var t=this;this.selectPlugins.forEach((function(e){t.setPluginAttr(e,!1)})),this.selectPlugins=[]},setPluginAttr:function(t,e){var a=this.getPluginType(t);if(a&&!this.plugin[a][t]||!a)return!1;var n=this.appCommonH.copyObj(this.plugin[a][t]);n.status.modeedit=e,n.status.modeedit&&(n.status.warning=!1),this.$set(this.plugin[a],t,this.appCommonH.copyObj(n))},setPluginValue:function(t,e){var a=this;e=this.getPluginType(t.key);t.key&&e&&this.plugin[e][t.key]&&(this.plugin[e][t.key]=this.appCommonH.copyObj(t),this.formmodeedit&&(this.plugin=this.appCommonH.copyObj(this.plugin)),this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:{plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins}})),setTimeout((function(){var e={};if(e[t.key]=t.data,d["a"].add(e,"formData"+a.nowModeId),window["tablevm"+a.nowModeId]){var n={},i=window["tablevm"+a.nowModeId].plugin.plugins;for(var r in i)i.hasOwnProperty(r)&&!["dTable","dmultiText","dOneInput"].includes(i[r].type)&&(n[r]=i[r].data);d["a"].add({all:n},"formData"+a.nowModeId),d["a"].add({all:n},"fomeData")}}),500)},getPluginType:function(t){return this.plugin.plugins[t]?"plugins":this.plugin.rtplugins[t]?"rtplugins":""},delPluginSelectTd:function(t){var e=this.getPluginByKey(t);e&&(this.delPlugin(t),e.pkey?this.rtselectData=[{key:e.pkey,id:e.tdid}]:(this.tdMouserdown(e.tdid,{target:$('[data-id="'+e.tdid+'"]')}),this.tdMouseup()))},getPluginByKey:function(t){var e=null;for(var a in this.plugin.plugins)a==t&&(e=this.plugin.plugins[a]);for(var n in this.plugin.rtplugins)n==t&&(e=this.plugin.rtplugins[n]);return e},copyPlugin:function(){1==this.selectPlugins.length?(this.copyPluginData=this.getPluginByKey(this.selectPlugins[0]),this.copyPluginData.iscopy=!0,this.$message({type:"success",message:"复制成功"})):this.selectPlugins.length>1?this.$message({type:"warning",message:"不可同时复制多个组件"}):this.$message({type:"warning",message:"未发现可复制组件"})},pastePlugin:function(){this.copyPluginData.columnType&&(this.addPlugin(this.copyPluginData),this.copyPluginData.isshear&&(this.copyPluginData={}))},shearPlugin:function(){1==this.selectPlugins.length?(this.copyPluginData=this.getPluginByKey(this.selectPlugins[0]),this.copyPluginData.isshear=!0,this.delPlugin(this.selectPlugins[0]),this.$message({type:"success",message:"剪切成功"})):this.selectPlugins.length>1?this.$message({type:"warning",message:"不可同时剪切多个组件"}):this.$message({type:"warning",message:"未发现可剪切组件"})},setOutPluginList:function(t){var e={};for(var a in t)1==t[a].classtype&&(e[t[a].type]||(e[t[a].type]=[]),e[t[a].type].push(t[a]));return e}},h={addRepeatTable:function(t){var e=this.appCommonH.copyObj(this.initTable);this._rtsetTableBaseInfo(e,t),this._rtsetTableTdModel(e,0,e.colnum),this._rtaddTableTr(e,0,e.rownum),t.attr.data=e},_rtsetTableBaseInfo:function(t,e){t.rownum=e.attr.data.rownum,t.colnum=e.attr.data.colnum,t.style.margin=e.attr.data.margin,t.width=$('[data-id="'+e.tdid+'"]').innerWidth()-10-2*e.attr.data.margin},_rtsetTableTdModel:function(t,e,a,n){var i=30;void 0===n&&(n=(t.width-i)/t.colnum-1);for(var r=0;r<a;r++)r!=a-1?t.tdModels.splice(e+r,0,{width:n}):t.tdModels.splice(e+r,0,{width:i})},_rtaddTableTr:function(t,e,a){for(var n=null,i=0;i<a;i++)n=this._rtgetTrData(t.id,t.colnum),t.trs.splice(e+i,0,n)},_rtgetTrData:function(t,e){var a=this.appCommonH.copyObj(this.initTr);a.style.height=this.tableStyle.defaultHeight;for(var n=0;n<e;n++)a.tds.push(this._rtgetTdData(t));return a},_rtgetTdData:function(t){var e=this.appCommonH.copyObj(this.initTd);return e.style.borderColor=this.tableStyle.borderColor,e.style.borderStyle=this.tableStyle.borderStyle,e.style.borderWidth=this.tableStyle.borderWidth,e.id=this.rtgetTableId(),e},rtgetTableId:function(){var t=+Math.random().toString().substring(2),e=(new Date).getTime(),a="td_"+(e+t);return a},rtPostMessage:function(t){t.method&&this[t.method]&&this[t.method](t)},updateRtSelectData:function(t){var e=[];this.rtselectData.forEach((function(a,n){a.key!==t.key&&e.push(a)})),t.data.forEach((function(a,n){e.push({key:t.key,id:a})})),this.rtselectData=e},removeOtherSelect:function(t){var e=[];this.rtselectData.forEach((function(a,n){a.key===t.key&&e.push(a)})),this.selectData.selectIds=[],this.rtselectData=e,this.rtupdateInfo={method:"updateSelectData",data:this.rtselectData}},delRtPlugin:function(t){this.delPlugin(t.pluginkey)},repeatHistory:function(t){this.setHistory(t.type)},selectRTable:function(t){this.addSelectPlugin(t.key,!0)},removeRepeatPrintRow:function(){this.resetRtable({method:"toRemovePrintRow",key:this.repeatOperationAlert.key})},addRepeatPrintRow:function(t){this.resetRtable({method:"toAddPrintRow",key:this.repeatOperationAlert.key,type:t})}},g=(a("053b"),a("e10c")),f=a.n(g),m=a("eead"),v=a("f69e"),b={apiValidate:function(t){if(t.errordata&&t.errordata.length){var e="",a=this,n={};t.errordata.forEach((function(i,r){var s=!!a.plugin.plugins[i.key]&&a.plugin.plugins[i.key];s=s||a.plugin.rtplugins[i.key],s=s||!1;if(!s)return!0;var o=!!s.pkey&&a.plugin.plugins[s.pkey];switch("validator"==i.type?a.validateWarning(s):void 0!==i.row&&o?(n[o.key]=n[o.key]?n[o.key]:[],n[o.key].push({row:i.row,key:i.key})):(s.status.warning=!0,a.$set(a.plugin.plugins,i.key,a.appCommonH.copyObj(s))),i.type){case"require":e+="<p>必须填写"+(void 0!==i.row?a.getRtTableAlertPrefix(s,i.row):s.description)+"</p>";break;case"sensitive":e+="<p>"+i.error+"</p>";break;case"validator":e+="<p>"+i.message+"</p>";break}r<t.errordata.length-1&&(e+="<br />")})),$.isEmptyObject(n)||(this.rtupdateInfo={method:"showRequired",data:n}),e&&t.isAlert&&(this.$message.error({dangerouslyUseHTMLString:!0,message:e,showClose:!0}),$(".el-message .el-message__closeBtn").css({top:"15px"}))}},getRtTableAlertPrefix:function(t,e){var a="重复表",n=this.plugin.plugins[t.pkey];return a+"“"+n.description+"”第"+(e+1)+"行的“"+t.description+"”"},validateWarning:function(t){var e=t.attr.data.apiParams;for(var a in e){var n=e[a];t=!!this.plugin.plugins[n]&&this.plugin.plugins[n];t&&(t.status.warning=!0,this.$set(this.plugin.plugins,n,this.appCommonH.copyObj(t)))}},refreshSetColor:function(){for(var t in this.eleidsrelation.table)this.setTableColor(this.getTableData(t),this.tableStyle.borderColor,!0);for(var e in this.plugin.plugins)"dRepeatTable"==this.plugin.plugins[e].type&&this.setTableColor(this.plugin.plugins[e].attr.data,this.tableStyle.borderColor,!0)},setReTableToTop:function(){for(var t in this.plugin.plugins)switch(this.plugin.plugins[t].type){case"dmultiInputs":case"dRepeatTable":this.plugin.plugins[t].attr.style.tdStyle=Object(n["a"])(Object(n["a"])({},this.plugin.plugins[t].attr.style.tdStyle?this.plugin.plugins[t].attr.style.tdStyle:{}),{verticalAlign:"top"});break}},toImportForm:function(t){try{var e=JSON.parse(t.data);if(!e.plugins||!e.table.tableData||!e.table.eleidsrelation||!e.table.mergeInfo||!e.table.pageSize)return this.$message({type:"error",message:"导入的文件已损坏"}),!1;this.eleidsrelation=e.table.eleidsrelation,this.mergeInfo=e.table.mergeInfo,this.pageSize=e.table.pageSize,this.plugin=e.plugins,this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:this.appCommonH.copyObj(this.plugin)}),this.tableData=e.table.tableData,this.$message({type:"success",message:"导入成功"})}catch(a){this.$message({type:"error",message:"导入的文件已损坏"})}},toExportForm:function(){if(!this.tableData.tdModels)return this.$message("表格不可为空"),!1;var t={};if(this.delNoUsePlugin(),!this.checkPluginDesc())return this.$message({type:"error",message:"请设置字段含义"}),!1;t.table={tableData:this.tableData,eleidsrelation:this.eleidsrelation,mergeInfo:this.mergeInfo,pageSize:this.pageSize},t.plugins=this.setPluginStatus(this.appCommonH.copyObj(this.plugin),{warning:!1,modeedit:!1,formmodeedit:!0}),t.table=t.table,t.plugins=t.plugins;var e=new Blob([JSON.stringify(t)],{type:"text/plain;charset=utf-8"});f.a.saveAs(e,"导出表单.txt")},heavyLoad:function(t){this.setPluginData(t,"plugins"),this.plugin=this.appCommonH.copyObj(this.plugin),this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:this.appCommonH.copyObj(this.plugin)}),this.rtupdateInfo={method:"resetInit"}},savePrintInfo:function(t){var e={app_id:this.formInfo.appId,form_id:this.nowModeId,inst_id:this.formInfo.instId,table:{tableData:this.tableData,eleidsrelation:this.eleidsrelation,mergeInfo:this.mergeInfo,pageSize:this.pageSize,repeatTable:this.getRepeatPrintInfo}};e.table=JSON.stringify(e.table);var a=this;return this.appFetch({url:"savePrintInfo",method:"POST",data:e},(function(t){a.$message.success({message:0==t.e?"保存成功":t.m,showClose:!0})}),(function(t){a.$message.error({message:"保存打印排版数据失败，请重新保存",showClose:!0})}))},initFormData:function(t){this.nowModeId=t.fid,this.instId=t.inst_id,this.appId=t.appId,this.bpmnId=t.bpmnId,this.nodeId=t.nodeId,this.fVId=t.fVId?t.fVId:0,this.formmodeedit=!1,this.otherStyle=t.otherStyle?t.otherStyle:{};var e=void 0===t.ispc||t.ispc;this.pluginStatus={ispc:e,formmodeedit:!1},window["tablevm"+this.nowModeId]=this,this.setPluginsEvn(t);var a=this;this.startDoPlugin=!1,this.setFormInfo("instId",this.instId),this.setFormInfo("appId",this.appId),this.setFormInfo("bpmnId",this.bpmnId),this.setFormInfo("nodeId",this.nodeId),this.setFormInfo("sessId",t.sess_id?t.sess_id:0),this.setFormInfo("matterType",t.matter_type?t.matter_type:1),this.setFormInfo("version",this.version),this.getFormMode(t.inst_id,t).then((function(){a.setPluginAuth(t,"plugins"),a.setPluginAuth(t,"rtplugins"),a.plugin=a.appCommonH.copyObj(a.plugin),a.SET_ALLPLUGINS({id:a.nowModeId,allplugin:a.appCommonH.copyObj(a.plugin)}),a.startDoPlugin=!0,a.rtupdateInfo={method:"resetInit"},a.$nextTick((function(){a.startDoOutPlugin=!0})),t.isPrintMode&&a.printSetColor(),t.isBrowserPrint&&setTimeout((function(){window.print()}),200)}))},setPluginAuth:function(t,e){for(var a in this.plugin[e]){!t.formData[a]&&0!==t.formData[a]||this.plugin[e][a].pkey||(this.plugin[e][a].data=t.formData[a]);var i=t.formAuth[a]?t.formAuth[a]:t.formAuth.defaultAuth;this.plugin[e][a].classtype&&t.formAuth.outDefaultAuth&&!t.formAuth[a]&&(i=t.formAuth.outDefaultAuth),i&&(this.plugin[e][a].status=Object(n["a"])(Object(n["a"])({},this.plugin[e][a].status),this.getStatusByType(i)))}},setPluginsEvn:function(t){if(t){var e={},a=t.formData;for(var n in a)a.hasOwnProperty(n)&&(e[n]=a[n]);d["a"].add(e,"formData"+this.nowModeId),d["a"].add({all:e},"formData"+this.nowModeId)}},setPluginData:function(t,e){for(var a in this.plugin[e])t.formData[a]&&!this.plugin[e][a].pkey&&(this.plugin[e][a].data=t.formData[a])},printSetColor:function(){for(var t in this.eleidsrelation.table)this.setTableColor(this.getTableData(t),this.printBorderColor);for(var e in this.plugin.plugins)"dRepeatTable"==this.plugin.plugins[e].type&&this.setTableColor(this.plugin.plugins[e].attr.data,this.printBorderColor);this.printSetTextColor()},printSetTextColor:function(){for(var t in this.plugin.plugins)1!=this.plugin.plugins[t].printResetColor&&void 0!=this.plugin.plugins[t].printResetColor||(this.plugin.plugins[t].attr.style.color=this.printTextColor);for(var t in this.plugin.rtplugins)1!=this.plugin.rtplugins[t].printResetColor&&void 0!=this.plugin.rtplugins[t].printResetColor||(this.plugin.rtplugins[t].attr.style.color=this.printTextColor)},setTableColor:function(t,e,a){var n=this;t.trs.forEach((function(t){t.tds.forEach((function(t){n.setTableTdColor(t,e,a)}))})),this.changeBorderCollapse(t.id)},setTableTrColor:function(t,e){var a=this.getTableData(this.selectById("table",t)),n=this;a.trs.forEach((function(a){if(a.id!==t)return!0;a.tds.forEach((function(t){n.setTableTdColor(t,e)}))}))},setTableTdColor:function(t,e,a){(t.style.borderColor==this.tableStyle.borderColor||t.style.borderColor==this.tableStyle.oldborderColor||a)&&(t.style.borderColor=e),(t.style.borderTopColor==this.tableStyle.borderColor||t.style.borderTopColor==this.tableStyle.oldborderColor||a)&&(t.style.borderTopColor=e),(t.style.borderBottomColor==this.tableStyle.borderColor||t.style.borderBottomColor==this.tableStyle.oldborderColor||a)&&(t.style.borderBottomColor=e),(t.style.borderColor&&-1!==t.style.borderColor.indexOf(this.tableStyle.borderColor)||a)&&(t.style.borderColor=t.style.borderColor.replace(this.tableStyle.borderColor,e))},initFormMode:function(t){this.nowModeId=t.fid,this.appId=t.appid,this.bpmnId=t.bpmnid,this.formmodeedit=!0,this.fVId=t.fVId,this.published=t.published,this.nowModeId?this.getFormMode():(this.loadEvent(),this.postMessage({method:"updateModeId",fid:this.nowModeId,appid:this.appId,bpmnId:this.bpmnId,name:this.formName,version:this.version}))},initPrintPreview:function(t){var e=this;this.nowModeId=t.fid,this.bpmnId=t.bpmnId,this.formmodeedit=!1,this.pluginStatus={readonly:!0,formmodeedit:this.formmodeedit},this.getFormMode().then((function(){e.printSetColor()}))},initExPreview:function(t){this.nowModeId=t.fid,this.bpmnId=t.bpmnId,this.formmodeedit=!1,this.pluginStatus={formmodeedit:this.formmodeedit},this.getFormMode()},initMobilePreview:function(t){this.nowModeId=t.fid,this.bpmnId=t.bpmnId,this.formmodeedit=!1,this.pluginStatus={ispc:!1,formmodeedit:this.formmodeedit},this.getFormMode()},getStatusByType:function(t){var e={};switch(t){case"forbidden":e={isshow:!1,readonly:!1,required:!1,disappear:!1,issave:!1};break;case"hidden":e={isshow:!1,readonly:!1,required:!1,disappear:!0,issave:!0};break;case"front_readonly":e={isshow:!0,readonly:!0,required:!1,disappear:!1,issave:!0};break;case"readable":e={isshow:!0,readonly:!0,required:!1,disappear:!1,issave:!1};break;case"writable":e={isshow:!0,readonly:!1,required:!1,disappear:!1,issave:!0};break;case"require":e={isshow:!0,readonly:!1,required:!0,disappear:!1,issave:!0};break}return e},setFormData:function(t){for(var e in this.plugin.plugins)t.formData[e]&&(this.plugin.plugins[e].data=t.formData[e],this.plugin.plugins[e]=this.appCommonH.copyObj(this.plugin.plugins[e]));this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:{plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins}}),this.rtupdateInfo={method:"resetInit"}},saveDraft:function(t){var e=this;this.appFetch({url:"saveFormDraft",method:"POST",data:{id:t.did,app_id:this.appId,form_id:this.nowModeId,form_data:this.getFormData(),name:t.name}},(function(t){0==t.e?(e.postMessage({method:"saveDraftSuccess"}),e.postMessage({method:"getDraftList"}),e.$message({message:"保存成功",type:"success"})):e.$message(t.m)}),(function(t){e.$message("保存草稿失败")}))},getSaveFormData:function(t){if(this.setPluginStatusNew(this.plugin,{warning:!1}),t.isCheck){if(!this.checkDataRequired())return!1;if(!this.checkPluginValidate())return!1;if(!this.validateWordNumber())return!1}this.postMessage({method:t.callback,did:this.nowModeId,status:"success",data:this.getFormData()})},setPluginStatusNew:function(t,e){for(var a in t.plugins){var i=!1;for(var r in t.plugins[a].status)void 0!==e[r]&&t.plugins[a].status[r]!=e[r]&&(i=!0,t.plugins[a].status[r]=e[r]);i&&this.$set(t.plugins,a,Object(n["a"])(Object(n["a"])({},{key:a}),t.plugins[a]))}},delNoUsePlugin:function(){for(var t in this.plugin.plugins){var e=this.plugin.plugins[t];this.checkTdIsHas(e.tdid,!1)||1==e.classtype||this.$delete(this.plugin.plugins,t)}for(var t in this.plugin.rtplugins){var a=this.plugin.rtplugins[t];this.checkTdIsHas(a.tdid,!0)||this.$delete(this.plugin.rtplugins,t)}},checkRtableIsMust:function(t){var e=!1;for(var a in this.plugin.rtplugins)this.plugin.rtplugins[a].pkey==t.key&&this.plugin.rtplugins[a].status.required&&(e=!0);return e},checkDataRequired:function(){var t=this.plugin.plugins,e=!0,a="";for(var n in t)if(t[n].showHideSet)if(t[n].status.warning&&(t[n].status.warning=!1,this.$set(t,n,this.appCommonH.copyObj(t[n]))),"dRepeatTable"==t[n].type){var i=m["a"].dRepeatTable(t[n],this.plugin.rtplugins);this.checkRtableIsMust(t[n])&&i.length&&(a||(a="重复表"),this.apiValidate({errordata:i,isAlert:!0}),e=!1)}else t[n].status.required&&!m["a"].checkValue(t[n])&&(a||(a="必须填写"+t[n].description),t[n].status.warning=!0,this.$set(t,n,this.appCommonH.copyObj(t[n])),e=!1);return e||this.postMessage({method:"getDataCallback",did:this.nowModeId,status:"warning",warningmsg:"重复表"==a?"":a}),e},checkPluginValidate:function(){var t=this.plugin.plugins;for(var e in t){var a=t[e];if("dValidate"===a.type&&!a.status.readonly)switch(a.attr.data.type){case 2:var n=!1;if(n=-1!==a.attr.data.rule.indexOf("$selfFunction")&&a.attr.data.functionStr?v["a"].getFuncResult(a.attr.data.rule,a.attr.data.functionStr,this.getCheckKeyVal(a),this.appCommonH.copyObj(this.plugin),this.formInfo.formId):!!v["a"].getResult(a.attr.data.rule,this.getCheckKeyVal(a),this.appCommonH.copyObj(this.plugin)),n){if(1===a.attr.data.errorlevel){this.ADD_WARNING({fid:this.nowModeId,warningmsg:a.attr.data.alert});break}return this.postMessage({method:"getDataCallback",did:this.nowModeId,status:"warning",warningmsg:a.attr.data.alert}),!1}break;case 1:var i=t[a.attr.data.validateKey];if(!i)return!0;n=m["a"].checkRegular(i.data,a.attr.data.method);if(!n){if(i.status.warning=!0,this.$set(t,a.attr.data.validateKey,this.appCommonH.copyObj(i)),1===a.attr.data.errorlevel){this.ADD_WARNING({fid:this.nowModeId,warningmsg:a.attr.data.alert});break}return this.postMessage({method:"getDataCallback",did:this.nowModeId,status:"warning",warningmsg:a.attr.data.alert}),!1}break}}return!0},validateWordNumber:function(){for(var t in this.plugin.plugins){var e=this.plugin.plugins[t],a=["dmultiInputs","dInput"];if(a.includes(e.type)&&!e.status.readonly&&(e.attr.data.minWord||e.attr.data.maxWord)&&e.data&&!this.appCommonH.validateWordNumber(e.data,e.attr.data.maxWord,e.attr.data.minWord))return this.postMessage({method:"getDataCallback",did:this.nowModeId,status:"warning",warningmsg:"".concat(e.description,"：请输入规定的字数")}),!1}return!0},getCheckKeyVal:function(t){var e={};for(var a in t.attr.data.keyval){var n=t.attr.data.keyval[a];"plugin"==n.type?(e[a]=n.evalVar,e[n.key+"Data"]=this.plugin.plugins[n.key]?this.plugin.plugins[n.key].data:""):e[a]=n.evalMethod}return e},getFormData:function(t){var e={};for(var a in this.plugin.plugins)this.plugin.plugins[a].status.issave&&(e[a]=t?JSON.stringify(this.plugin.plugins[a].data):this.plugin.plugins[a].data);return e},getFormMode:function(t,e){var a=this,n=e&&e.isqrcode,i=e&&e.isToPdfMode,r=e&&e.secret;i=i?1:void 0,r=r?e.secret:void 0,a.SET_PRINTSTYLE({fid:this.nowModeId,data:!!i}),a.setFormInfo("formId",this.nowModeId),a.ADD_STARTLOADING();var s=n?"codeGetForm":"getFromMode",o={id:this.nowModeId,bpmn_id:this.bpmnId?this.bpmnId:void 0,inst_id:t,preview:i,secret:r};return 2==this.$route.query.matterType&&(s="getFormOneDetail",o={id:this.fVId?this.fVId:this.$route.query.fVId?this.$route.query.fVId:0}),this.appFetch({url:s,method:"GET",data:o},(function(t){0==t.e&&t.d.table?(a.formModeData=t.d,a.formModeData.bpmn_id=a.bpmnId?a.bpmnId:void 0,a.fVId=a.fVId?a.fVId:t.d.form_version_id,a.loadForm(t.d),a.loadEvent()):a.$message("获取表单失败，请联系管理员"),a.toReduceStartLoading()}),(function(t){a.toReduceStartLoading(),a.$message("获取表单失败，请联系管理员")}))},checkPluginDesc:function(){var t=!0;for(var e in this.plugin.plugins)this.plugin.plugins[e].description?this.plugin.plugins[e].status.warning&&(this.plugin.plugins[e].status.warning=!1,this.$set(this.plugin.plugins,e,this.appCommonH.copyObj(this.plugin.plugins[e]))):(this.plugin.plugins[e].status.warning=!0,this.$set(this.plugin.plugins,e,this.appCommonH.copyObj(this.plugin.plugins[e])),t=!1);return t},saveFormMode:function(t){if(!this.tableData.tdModels)return this.$message("表格不可为空"),!1;var e={};if(t.id?e=this.formModeData:(e.app_id=t.appId?t.appId:void 0,e.bpmn_id=t.bpmnId?t.bpmnId:void 0),e.name=t.name,this.delNoUsePlugin(),!this.checkPluginDesc())return this.$message({type:"error",message:"请设置字段含义"}),!1;e.table={tableData:this.tableData,eleidsrelation:this.eleidsrelation,mergeInfo:this.mergeInfo,pageSize:this.pageSize},e.plugins=this.setPluginStatus(this.appCommonH.copyObj(this.plugin),{warning:!1,modeedit:!1,formmodeedit:!0}),e.table=JSON.stringify(e.table),e.plugins=JSON.stringify(e.plugins);var a=this,n="",i={};return 2==this.$route.query.matterType&&this.$route.query.isClone?(this.cloneFrom(e),!1):(e.id?(n=this.published?"saveFormAttr":"updateFormModel",i={form_version_id:this.fVId,table:e.table,plugins:e.plugins,name:e.name}):(n="createFormModel",i={bpmn_id:e.bpmn_id,app_id:e.app_id,table:e.table,plugins:e.plugins,name:e.name,version:this.version}),this.appFetch({url:n,method:"POST",data:i},(function(t){0==t.e?(a.nowModeId||(a.formName=e.name,a.nowModeId=t.d.form_id,a.fVId=t.d.form_version_id,a.formModeData={id:a.nowModeId,name:e.name,app_id:e.app_id,bpmn_id:e.bpmn_id}),a.$message({message:"保存成功",type:"success"}),a.postMessage({method:"saveFormFileSuccess",id:t.d.form_id})):a.$message(t.m)}),(function(t){a.$message("保存表单失败，请联系管理员")})))},cloneFrom:function(t){var e={form_id:t.id,bpmn_id:t.bpmn_id,app_id:t.app_id,table:t.table,plugins:t.plugins,name:t.name},a=this;this.appFetch({url:"createNewForm",method:"POST",data:e},(function(e){0==e.e?(a.$message({type:"success",message:e.m,showClose:!0}),setTimeout((function(){window.location.href="".concat(a.appConfig.baseUrl,"form/editform?id=").concat(t.id,"&app_id=").concat(t.app_id,"&bpmn_id=").concat(t.bpmn_id,"&fVId=").concat(e.d.form_version_id,"&matterType=2")}),2e3)):a.$message({type:"error",message:e.m,showClose:!0})}),(function(t){a.$message({message:"保存表单失败，请联系管理员",showClose:!0})}))},setSortKeys:function(){for(var t in this.plugin.plugins)this.plugin.plugins[t].tdid&&this.sortKeys.push(t)},loadForm:function(t){if(t.table=JSON.parse(t.table),t.plugins=JSON.parse(t.plugins),!$.isEmptyObject(t.plugins.plugins)&&!this.pluginStatus.ispc){var e=[],a=[],i={};for(var r in t.plugins.plugins){var s=t.plugins.plugins[r];e[s.sort]||(e[s.sort]=[]),e[s.sort].push(s)}e.forEach((function(t){t&&t.length&&(a=a.concat(t))})),a.forEach((function(t){i[t.key]=t})),t.plugins.plugins=i}this.initFormStatus({fid:this.nowModeId,plugins:t.plugins.plugins}),this.formName=t.name,this.tableData=t.table.tableData,this.eleidsrelation=t.table.eleidsrelation,this.mergeInfo=t.table.mergeInfo?t.table.mergeInfo:{},this.pageSize=t.table.pageSize,this.SET_TABLEPAGEINFO({fid:this.nowModeId,data:t.table.pageSize}),this.SET_ALLPRINTMAKE({fid:this.nowModeId,data:t.table.repeatTable?t.table.repeatTable:{}});var o=this.setPluginStatus(Object(n["a"])(Object(n["a"])({},this.plugin),t.plugins),this.pluginStatus);o=this.patchInfo(o);this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:this.appCommonH.copyObj(o)}),this.plugin=o,this.setSortKeys();var l=this;this.postMessage({oid:"setsize",data:{method:"setType",sizeType:this.pageSize.type}}),setTimeout((function(){l.postMessage({method:"updateModeId",fid:l.nowModeId,appid:l.appId,bpmnId:l.bpmnId,name:l.formName,version:this.version})}),200)},patchInfo:function(t){return t=this.selectRadioShowHide(t),t=this.sealPosition(t),t},sealPosition:function(t){for(var e in t.plugins){var a=t.plugins[e];if("dSeal"==a.type){if(void 0!==a.attr.style.left)continue;a.attr.style.left=0,a.attr.style.tdStyle={overflow:"visible"}}}for(var e in t.rtplugins){a=t.rtplugins[e];if("dSeal"==a.type){if(void 0!==a.attr.style.left)continue;a.attr.style.left=0,a.attr.style.tdStyle={overflow:"visible"}}}for(var e in t.plugins){a=t.plugins[e];if("dUserSearch"==a.type){if(void 0!==a.attr.data.selectShow)continue;a.attr.data.selectShow="1"}}for(var e in t.plugins){a=t.plugins[e];if("dSelect"==a.type){if(void 0!==a.attr.data.borderStyle)continue;a.attr.data.borderStyle="0"}}for(var e in t.plugins){a=t.plugins[e];if("dPasswd"==a.type){if(void 0!==a.attr.data.isRandom)continue;a.attr.data.isRandom="1"}}for(var e in t.plugins){var n=t.plugins[e];if("dSerial"==n.type){if(void 0!==n.attr.data.type)continue;n.attr.data.type="format"}}for(var e in t.plugins){var i=t.plugins[e];if("dAlert"==i.type){if(void 0!==i.attr.data.defaultOrApi)continue;i.attr.data.defaultOrApi="1"}}return t},selectRadioShowHide:function(t){for(var e in t.plugins){var a=t.plugins[e];if("dmultiInputs"==a.type){if(a.attr.data.placeholder)continue;a.attr.data.placeholder=""}if("dLink"==a.type){if(void 0!=a.attr.data.type)continue;a.attr.data.type=!0}"dRadio"!==a.type&&"dSelect"!==a.type||(a.attr.data.allPlugin||(a.attr.data.allPlugin={},a.attr.data.linkage=[]))}for(var e in t.rtplugins){a=t.rtplugins[e];if("dLink"==a.type){if(void 0!=a.attr.data.type)continue;a.attr.data.type=!0}if("dmultiInputs"==a.type){if(a.attr.data.placeholder)continue;a.attr.data.placeholder=""}"dRadio"!==a.type&&"dSelect"!==a.type||(a.attr.data.allPlugin||(a.attr.data.allPlugin={},a.attr.data.linkage=[]))}return t},setPluginStatus:function(t,e){for(var a in t.plugins)for(var n in t.plugins[a].status)void 0!==e[n]&&(t.plugins[a].status[n]=e[n]);for(var i in t.rtplugins)for(var r in t.rtplugins[i].status)void 0!==e[r]&&(t.rtplugins[i].status[r]=e[r]);return t},setFormInfo:function(t,e){this.$set(this.formInfo,t,e)}},y=(a("77ad"),{toOld:function(){if(this.formHistory.nowIndex<=0)return!1;this.formHistory.nowIndex=this.formHistory.nowIndex-1,this.loadHistory()},toNew:function(){if(this.formHistory.nowIndex>=this.formHistory.list.length-1)return!1;this.formHistory.nowIndex=this.formHistory.nowIndex+1,this.loadHistory()},loadHistory:function(){var t=this.formHistory.list[this.formHistory.nowIndex];this.tableData=this.appCommonH.copyObj(t.tableData),this.eleidsrelation=this.appCommonH.copyObj(t.eleidsrelation),this.mergeInfo=this.appCommonH.copyObj(t.mergeInfo),this.pageSize=this.appCommonH.copyObj(t.pageSize),this.plugin={plugins:this.appCommonH.copyObj(t.plugins),rtplugins:this.appCommonH.copyObj(t.rtplugins),nowNum:this.plugin.nowNum},this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:this.appCommonH.copyObj(this.plugin)})},setHistory:function(t){this.formHistory.list.push(this.appCommonH.copyObj({type:t,tableData:this.tableData,eleidsrelation:this.eleidsrelation,mergeInfo:this.mergeInfo,pageSize:this.pageSize,plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins})),this.formHistory.list.length>5&&(this.formHistory.list=this.formHistory.list.slice(-5)),this.formHistory.nowIndex=this.formHistory.list.length-1}}),_=(a("5557"),a("9f3a")),D=a("599e"),C=a("0227");e["a"]={data:function(){var t,e=this;return{formtableClass:{formtable:!0,formtablenoedit:!1},formModeData:{},formHistory:{nowIndex:-1,list:[]},pageSize:{width:0,height:0,type:""},tableData:{},tableStyle:{borderWidth:1,oldborderColor:"#DCDFE6",borderColor:"#BBBBBB",borderStyle:"solid",defaultWidth:50,defaultHeight:35,printDefaultHeight:20},initTable:{id:"",style:{margin:0},rownum:0,colnum:0,width:0,tdid:"",tdModels:[],trs:[]},initTr:{id:"",style:{height:0},tds:[]},initTd:{id:"",rowspan:1,colspan:1,style:(t={borderColor:""},Object(i["a"])(t,"borderColor","#000"),Object(i["a"])(t,"borderStyle","solid"),t),table:{},dataid:""},printBorderColor:"#000",printTextColor:"#000",selectData:{tableid:"",start:{id:"",row:0,col:0},end:{id:"",row:0,col:0},selectIds:[]},eleidsrelation:{table:{},tr:{},td:{}},plugin:{nowNum:0,plugins:{},rtplugins:{}},initPlugin:{tdid:"",key:"",pkey:"",description:"",initdata:{},data:{},columnType:"",type:"",pluginname:"",mobileshow:!0,printResetColor:!0,bringOutData:!0,sort:1e3,groupname:"",classtype:0,attr:{style:{fontSize:14,fontFamily:"微软雅黑",fontWeight:"normal",fontStyle:"normal",color:e.mixStyleColor,textDecoration:"none",textAlign:"left",marginTop:0,marginBottom:0,lineHeight:20,letterSpacing:0},data:{},setInfo:{}},status:{isshow:!0,readonly:!1,required:!1,prohibit:!1,warning:!1,modeedit:!1,formmodeedit:!0,ispc:!0}},mergeInfo:{},tdChangeInfo:{nowTarget:null,oldEventX:0},operationAlert:{removeRow:!0,addRow:!0,removeCol:!0,addCol:!0,removeTable:!0},selectPlugins:[],rtselectData:[],rtupdateInfo:{},pluginUpdateInfo:{},formmodeedit:!0,pluginStatus:{isshow:!0,readonly:!1,required:!1,disappear:!1,warning:!1,modeedit:!1,formmodeedit:!0,ispc:!0},copyPluginData:{},nowModeId:0,fVId:0,published:!1,formName:"",appId:0,instId:0,bpmnId:0,nodeId:"",showoutbox:!1,startDoPlugin:!0,startDoOutPlugin:!1,formHeightBar:null,cutLineInfo:[],formInfo:{},resetTableList:[],resetTableBar:null,sortKeys:[],tdPrint:{trData:"",oldEventY:0},upRowNum:1,downRowNum:1,leftColNum:1,rightColNum:1,otherStyle:{},version:"v2"}},props:["sendmessage","watchmessage"],computed:Object(n["a"])({},Object(_["d"])("form",{getAllPluginById:function(){var t=void 0!==this.nowModeId?this.nowModeId:"0";return this.$store.state.form.allplugin[t]},isPrintMake:function(){return this.$store.state.form.isPrintMake},getRepeatPrintInfo:function(){var t=void 0!==this.nowModeId?this.nowModeId:"0",e=this.$store.state.form.repeatPrintInfo[t];return e||{}},isPrintStyle:function(){var t=void 0!==this.nowModeId?this.nowModeId:"0";return!!this.$store.state.form.printStyle[t]},repeatOperationAlert:function(){return this.$store.state.form.repeatOperationAlert}})),watch:{watchmessage:function(t){t.method&&"function"==typeof this[t.method]&&this[t.method](t)},tableData:function(t){if(!t.id){var e=this;setTimeout((function(){e.postMessage({oid:"addtable",data:{method:"setStatus",status:!0}})}),200)}},rtselectData:function(t){this.postMessage({oid:"removeselect",data:{method:"setStatus",status:!!this.rtselectData.length||!!this.selectData.selectIds.length||!!this.selectPlugins.length}})},"selectData.selectIds":function(t){this.selectTdChange(t.length)},"selectData.selectIds.length":function(t){this.selectTdChange(t)},selectPlugins:function(t){this.selectPluginChange(t.length)},"selectPlugins.length":function(t){this.selectPluginChange(t)},nowModeId:function(t){this.postMessage({method:"updateModeId",fid:t,appid:this.appId,bpmnid:this.bpmnId,name:this.formName})},"formHistory.nowIndex":function(t){if(-1==t)return!1;this.postMessage({oid:"tonew",data:{method:"setStatus",status:t<this.formHistory.list.length-1}});var e=this;setTimeout((function(){e.postMessage({oid:"toold",data:{method:"setStatus",status:e.formHistory.list.length>1&&0!==t}})}),200)}},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])({},r),o),s),l["a"]),u),p),h),b),y),Object(_["c"])("form",["SET_ALLPLUGINS","ADD_STARTLOADING","SET_ALLPRINTMAKE","SET_TABLEPAGEINFO","SET_PRINTSTYLE","SET_FORMLOADED","ADD_WARNING","REPEAT_OPERATIONALERT","SET_FORMSTATUS"])),Object(_["b"])("form",["toReduceStartLoading","initFormStatus","onlySetFormStatus"])),{},{no:function(){},selectPluginChange:function(t){var e=this;this.postMessage({oid:"removeplugin",data:{method:"setStatus",status:!!t}}),setTimeout((function(){e.postMessage({oid:"removeselect",data:{method:"setStatus",status:!!t}})}),50)},selectTdChange:function(t){var e=this;this.postMessage({oid:"removeselect",data:{method:"setStatus",status:!!this.rtselectData.length||!!this.selectData.selectIds.length||!!this.selectPlugins.length}}),setTimeout((function(){e.postMessage({oid:"addtable",data:{method:"setStatus",status:e.checkCanAddTable()}})}),100),setTimeout((function(){e.postMessage({oid:"sliptrc",data:{method:"setStatus",status:1==t&&e.mergeInfo[e.selectData.selectIds[0]]}})}),50),setTimeout((function(){e.postMessage({oid:"mergerc",data:{method:"setStatus",status:t>1&&e.checkCanMerge()}})}),50)},postMessage:function(t,e){e=e||"operation",this.$emit("sendmessage",t,e)},loadEvent:function(){if(this.formtableClass.formtablenoedit=!this.formmodeedit,!this.isPrintMake)return!1;var t=this;function e(e){var a=$(".operationalert .insertTr"),n=$(".operationalert input"),i=$(".operationalert i");!$(".operationalert").is(":visible")||a.is(e.target)||n.is(e.target)||i.is(e.target)||($(".operationalert").hide(),t.upRowNum=1,t.downRowNum=1,t.leftColNum=1,t.rightColNum=1),t.repeatOperationAlert.key&&t.REPEAT_OPERATIONALERT({})}this.pageSize.height&&(this.formHeightBar=setInterval((function(){t.watchPageHeight()}),200)),$(document).on("mouseleave",".formtable",(function(e){return t.toMouseout($(this).attr("data-id")),!1})),$(document).on("mouseleave",".pageBox",(function(e){return t.tdChangeMouseup(e),t.tdPrint.trData&&t.tdPrintMouseUp(e),!1})),$(document).on("mousemove",".pageBox",(function(e){t.tdPrint.trData&&t.tdPrintMouseMove(e)})),$(document).on("contextmenu",".pageBox",(function(e){var a=null,n="TD"==e.target.tagName?$(e.target):$(e.target).parents("td").length?$(e.target).parents("td")[0]:$(e.target).parents("td");if(n=$(n),n.length&&n.find(".dplugin-box").length){var i=n.find(".dplugin-box").attr("data-key"),r=t.getPluginByKey(i);a=r.pkey?a:r.tdid,a&&(t.selectData.selectIds=[a])}if(!t.checkAlertStatus(a))return!1;var s=!t.formmodeedit&&t.isPrintMake?"body":".table_content",o=$(".pageBox").offset(),l=(o.left,o.top+$(s).scrollTop()),u=o.left+$(".pageBox").width(),d=l-20+($(s).outerHeight()>$(".pageBox").height()?$(".pageBox").height():$(s).outerHeight()),c={width:$(".operationalert").width(),height:$(".operationalert").height()},p=e.clientY,h=e.clientX;return u-e.clientX<c.width&&(h=e.clientX-c.width-2),d-e.clientY<c.height&&(p=e.clientY-c.height-2),$(".operationalert").css({top:p+"px",left:h+"px"}).show(),!1})),$(document).on("click","body",(function(t){e(t)}));var a=!t.formmodeedit&&t.isPrintMake?window:".table_content";if($(a).scroll((function(t){e(t)})),$(document).on("mouseover",".operationalert li",(function(){return $(this).hasClass("active")||($(this).siblings("li").removeClass("active"),$(this).addClass("active")),!1})),$(document).on("mouseleave",".operationalert",(function(){return $(this).find(".active").removeClass("active"),!1})),!this.formmodeedit)return!1;function n(){$(".form_content").length&&($(".form_content .content_box").height($(window).height()-$(".header_box").height()-30),$(".form_content .content_box .table_content").width($(window).width()-360-30-10),$(".form_content .plugin_content, .form_content .table_content").height($(window).height()-$(".header_box").height()-30))}$(document).on("click",".dplugin-box",(function(e){t.addSelectPlugin($(this).attr("data-key"),!e.shiftKey)})),n(),$(window).resize(n),$(document).keydown((function(e){if($(".form_content").length&&e.shiftKey)switch(e.keyCode){case 68:t.removePlugin();break;case 82:t.removeSelect(),t.removeAllSelectPlugin();break;case 67:t.copyPlugin();break;case 86:t.pastePlugin();break;case 88:t.shearPlugin();break}}))},watchPageHeight:function(){for(var t=$("#pageBox").height(),e=Math.floor(t/this.pageSize.height),a=[],n=1;n<=e;n++)a.push(n*this.pageSize.height);a.length&&this.cutLineInfo.length!=a.length&&(this.cutLineInfo=a)}}),beforeDestory:function(){clearInterval(this.formHeightBar),$(document).off("mouseleave",".formtable"),$(document).off("mouseleave",".pageBox"),$(document).off("mousemove",".pageBox"),$(document).off("mouseup",".pageBox"),$(document).off("contextmenu","table"),$(document).off("mouseover",".operationalert li"),$(document).off("mouseleave",".operationalert"),$(document).off("click",".dplugin-box"),$(document).off("click",".ctrl-close")},mounted:function(){window.tablevm=this,this.initPlugin.attr.style.color=this.mixStyleColor},mixins:[D["a"],C["a"]]}},"927c":function(t,e,a){"use strict";var n=a("5a9e"),i=a("5dfd").every,r=n.aTypedArray,s=n.exportTypedArrayMethod;s("every",(function(t){return i(r(this),t,arguments.length>1?arguments[1]:void 0)}))},"939f":function(t,e,a){"use strict";var n=a("5a9e"),i=a("d88d"),r=a("e1d6"),s=a("ef4c"),o=n.aTypedArray,l=n.exportTypedArrayMethod;l("subarray",(function(t,e){var a=o(this),n=a.length,l=r(t,n);return new(s(a,a.constructor))(a.buffer,a.byteOffset+l*a.BYTES_PER_ELEMENT,i((void 0===e?n:r(e,n))-l))}))},"9acd":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("dbb9"),r=o(i),s=a("8335");function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var u="http://www.w3.org/2000/svg",d=function(){function t(e,a,n){l(this,t),this.svg=e,this.encodings=a,this.options=n,this.document=n.xmlDocument||document}return n(t,[{key:"render",value:function(){var t=this.options.marginLeft;this.prepareSVG();for(var e=0;e<this.encodings.length;e++){var a=this.encodings[e],n=(0,r.default)(this.options,a.options),i=this.createGroup(t,n.marginTop,this.svg);this.setGroupOptions(i,n),this.drawSvgBarcode(i,n,a),this.drawSVGText(i,n,a),t+=a.width}}},{key:"prepareSVG",value:function(){while(this.svg.firstChild)this.svg.removeChild(this.svg.firstChild);(0,s.calculateEncodingAttributes)(this.encodings,this.options);var t=(0,s.getTotalWidthOfEncodings)(this.encodings),e=(0,s.getMaximumHeightOfEncodings)(this.encodings),a=t+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(a,e),this.options.background&&this.drawRect(0,0,a,e,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(t,e,a){var n,i=a.data;n="top"==e.textPosition?e.fontSize+e.textMargin:0;for(var r=0,s=0,o=0;o<i.length;o++)s=o*e.width+a.barcodePadding,"1"===i[o]?r++:r>0&&(this.drawRect(s-e.width*r,n,e.width*r,e.height,t),r=0);r>0&&this.drawRect(s-e.width*(r-1),n,e.width*r,e.height,t)}},{key:"drawSVGText",value:function(t,e,a){var n,i,r=this.document.createElementNS(u,"text");e.displayValue&&(r.setAttribute("style","font:"+e.fontOptions+" "+e.fontSize+"px "+e.font),i="top"==e.textPosition?e.fontSize-e.textMargin:e.height+e.textMargin+e.fontSize,"left"==e.textAlign||a.barcodePadding>0?(n=0,r.setAttribute("text-anchor","start")):"right"==e.textAlign?(n=a.width-1,r.setAttribute("text-anchor","end")):(n=a.width/2,r.setAttribute("text-anchor","middle")),r.setAttribute("x",n),r.setAttribute("y",i),r.appendChild(this.document.createTextNode(a.text)),t.appendChild(r))}},{key:"setSvgAttributes",value:function(t,e){var a=this.svg;a.setAttribute("width",t+"px"),a.setAttribute("height",e+"px"),a.setAttribute("x","0px"),a.setAttribute("y","0px"),a.setAttribute("viewBox","0 0 "+t+" "+e),a.setAttribute("xmlns",u),a.setAttribute("version","1.1"),a.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(t,e,a){var n=this.document.createElementNS(u,"g");return n.setAttribute("transform","translate("+t+", "+e+")"),a.appendChild(n),n}},{key:"setGroupOptions",value:function(t,e){t.setAttribute("style","fill:"+e.lineColor+";")}},{key:"drawRect",value:function(t,e,a,n,i){var r=this.document.createElementNS(u,"rect");return r.setAttribute("x",t),r.setAttribute("y",e),r.setAttribute("width",a),r.setAttribute("height",n),i.appendChild(r),r}}]),t}();e.default=d},"9aec":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.version?["v3"==t.version?a("formTableV3",{attrs:{watchmessage:t.newInfo},on:{sendmessage:t.toSendMessage}}):t._e(),t._v(" "),"v2"==t.version?a("formTableV2",{attrs:{watchmessage:t.newInfo},on:{sendmessage:t.toSendMessage}}):t._e()]:t._e()],2)},i=[],r=(a("0e07"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m_formList"},[t._l(t.sortKeys,(function(e){return t.plugin.plugins[e]&&t.plugin.plugins[e].status.isshow&&t.plugin.plugins[e].mobileshow&&!t.plugin.plugins[e].classtype?[e.includes("Submit")?t._e():a("div",{staticClass:"pluginnames"},[a("span",[t._v(t._s(t.plugin.plugins[e].description))]),t._v(" "),t.plugin.plugins[e].status.required?a("i",{staticClass:"iconfont icon_mobile_required"}):t._e()]),t._v(" "),!t.plugin.plugins[e].status.readonly&&t.plugin.plugins[e].alertFoucsMsg?a("div",{staticClass:"dplugin-mobile-zhuyi"},[a("i",{staticClass:"icon iconfont iconzhuyi1"}),t._v(" "),a("span",{domProps:{innerHTML:t._s(t.plugin.plugins[e].alertFoucsMsg)}})]):t._e(),t._v(" "),a("allPlugin",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,forminfo:t.formInfo,plugin:t.plugin,watchmessage:t.plugin.plugins[e]},on:{sendmessage:t.setPluginValue,sendrtmessage:t.rtPostMessage,tablesendmessage:t.tableSendMessage}})]:t._e()})),t._v(" "),!t.formmodeedit&&t.startDoOutPlugin?a("div",{staticStyle:{display:"none"}},[a("ul",t._l(t.plugin.plugins,(function(e){return 1==e.classtype?a("li",[a("span",[t._v(t._s(e.pluginname)+"：")]),t._v(" "),a("allPlugin",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,plugin:t.plugin,forminfo:t.formInfo,watchmessage:e},on:{sendmessage:t.setPluginValue,sendrtmessage:t.rtPostMessage,tablesendmessage:t.tableSendMessage}})],1):t._e()})),0)]):t._e()],2)}),s=[],o=a("e793"),l=a("91cc"),u=a("62da"),d=Object(o["a"])({name:"mformtable",components:{allPlugin:u["a"]}},l["a"]);window.onload=function(){document.addEventListener("gesturestart",(function(t){t.preventDefault()})),document.addEventListener("dblclick",(function(t){t.preventDefault()})),document.addEventListener("touchstart",(function(t){t.touches.length>1&&t.preventDefault()}));var t=0;document.addEventListener("touchend",(function(e){var a=(new Date).getTime();a-t<=300&&e.preventDefault(),t=a}),!1)};var c=d,p=a("9ca4"),h=Object(p["a"])(c,r,s,!1,null,null,null),g=h.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{m_formList:!0,import_border_top:t.moduleInfo.length}},[t._l(t.sortKeys,(function(e){return-1===e.indexOf("module_")?[t.plugin.plugins[e]&&t.plugin.plugins[e].status.isshow&&t.plugin.plugins[e].mobileshow&&!t.plugin.plugins[e].classtype?[a("div",{key:e},[e.includes("Submit")?t._e():a("div",{staticClass:"pluginnames"},[a("span",{style:t.appCommonH.getStyle(t.plugin.plugins[e].attr.style.mobileTitleStyle?t.plugin.plugins[e].attr.style.mobileTitleStyle:{})},[t._v("\n              "+t._s(t.plugin.plugins[e].description)+"\n            ")]),t._v(" "),t.plugin.plugins[e].status.required?a("i",{staticClass:"iconfont icon_mobile_required"}):t._e()]),t._v(" "),!t.plugin.plugins[e].status.readonly&&t.plugin.plugins[e].alertFoucsMsg?a("div",{staticClass:"dplugin-mobile-zhuyi"},[a("i",{staticClass:"icon iconfont iconzhuyi1"}),t._v(" "),a("span",{domProps:{innerHTML:t._s(t.plugin.plugins[e].alertFoucsMsg)}})]):t._e(),t._v(" "),a("allPlugin",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,forminfo:t.formInfo,plugin:t.plugin,watchmessage:t.plugin.plugins[e]},on:{sendmessage:t.setPluginValue,sendrtmessage:t.rtPostMessage,tablesendmessage:t.tableSendMessage}})],1)]:t._e()]:[t.modules_show.show_module&&t.modules_show.is_show[t.getModuleInfoByIndex(e).key]?a("span",{staticClass:"module_anchor",attrs:{id:t.getModuleInfoByIndex(e).key}},[t._v("\n\t\t\t\t"+t._s(t.getModuleInfoByIndex(e).name)+"\n\t\t\t")]):t._e()]})),t._v(" "),!t.formmodeedit&&t.startDoOutPlugin?a("div",{staticStyle:{display:"none"}},[a("ul",t._l(t.plugin.plugins,(function(e){return 1==e.classtype?a("li",[a("span",[t._v(t._s(e.pluginname)+"：")]),t._v(" "),a("allPlugin",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,plugin:t.plugin,forminfo:t.formInfo,watchmessage:e},on:{sendmessage:t.setPluginValue,sendrtmessage:t.rtPostMessage,tablesendmessage:t.tableSendMessage}})],1):t._e()})),0)]):t._e(),t._v(" "),t.moduleInfo.length&&t.modules_show.show_module?a("div",{staticClass:"module_dropdown"},[a("span",{staticClass:"dropdown_link",on:{click:t.slideToggle_module}},[t._v("\n\t\t\t\t导航"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("ul",t._l(t.moduleInfo,(function(e){return t.modules_show.is_show[e.key]?a("li",{on:{click:function(a){return t.to_anchor(e.key)}}},[a("span",[t._v(t._s(e.name))])]):t._e()})),0)]):t._e()],2)},m=[],v=(a("71a9"),a("ddf9")),b=a("87fb"),y=Object(o["a"])({name:"mformtable",components:{allPlugin:b["a"]}},v["a"]);window.onload=function(){document.addEventListener("gesturestart",(function(t){t.preventDefault()})),document.addEventListener("dblclick",(function(t){t.preventDefault()})),document.addEventListener("touchstart",(function(t){t.touches.length>1&&t.preventDefault()}));var t=0;document.addEventListener("touchend",(function(e){var a=(new Date).getTime();a-t<=300&&e.preventDefault(),t=a}),!1)};var _=y,D=Object(p["a"])(_,f,m,!1,null,null,null),C=D.exports,w={name:"allFromTable",components:{formTableV2:g,formTableV3:C},props:["sendmessage","watchmessage"],data:function(){return{version:"",newInfo:{},isInit:!1}},watch:{watchmessage:function(t){if(!t)return this.newInfo={},this.version="",this.isInit=!1,!1;if(this.version=t.version?t.version:this.version,this.newInfo=t,!this.isInit){this.isInit=!0;var e=this;setTimeout((function(){e.newInfo=e.appCommonH.copyObj(t)}),200)}}},methods:{toSendMessage:function(t){this.$emit("sendmessage",t)}}},x=w,k=Object(p["a"])(x,n,i,!1,null,null,null);e["a"]=k.exports},"9b97":function(t,e,a){"use strict";var n;function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}Object.defineProperty(e,"__esModule",{value:!0});var r=e.SET_A=0,s=e.SET_B=1,o=e.SET_C=2,l=(e.SHIFT=98,e.START_A=103),u=e.START_B=104,d=e.START_C=105;e.MODULO=103,e.STOP=106,e.FNC1=207,e.SET_BY_CODE=(n={},i(n,l,r),i(n,u,s),i(n,d,o),n),e.SWAP={101:r,100:s,99:o},e.A_START_CHAR=String.fromCharCode(208),e.B_START_CHAR=String.fromCharCode(209),e.C_START_CHAR=String.fromCharCode(210),e.A_CHARS="[\0-_È-Ï]",e.B_CHARS="[ -È-Ï]",e.C_CHARS="(Ï*[0-9]{2}Ï*)",e.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]},"9be0":function(module,exports,__webpack_require__){__webpack_require__("b4fb"),__webpack_require__("dbb3"),__webpack_require__("ecb4"),__webpack_require__("9302"),__webpack_require__("6ae3"),__webpack_require__("77ad"),__webpack_require__("ea69"),__webpack_require__("053b"),__webpack_require__("513c"),__webpack_require__("20a5"),__webpack_require__("e18c"),__webpack_require__("84c2"),__webpack_require__("e35a"),__webpack_require__("1c2e"),__webpack_require__("f4e3"),__webpack_require__("2bbe"),__webpack_require__("5e9f"),__webpack_require__("9cf3"),__webpack_require__("0d7a"),__webpack_require__("6db4"),__webpack_require__("3a93"),__webpack_require__("31a0");var _typeof=__webpack_require__("a1fa");
/*!
 * UEditor
 * version: ueditor
 * build: Wed Aug 10 2016 11:06:02 GMT+0800 (CST)
 */(function(){UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu,window.UE=baidu.editor=window.UE||{},UE.plugins={},UE.commands={},UE.instants={},UE.I18N={},UE._customizeUI={},UE.version="1.4.3";var dom=UE.dom={},browser=UE.browser=function(){var t=navigator.userAgent.toLowerCase(),e=window.opera,a={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(t),opera:!!e&&e.version,webkit:t.indexOf(" applewebkit/")>-1,mac:t.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode};a.gecko="Gecko"==navigator.product&&!a.webkit&&!a.opera&&!a.ie;var n=0;if(a.ie){var i=t.match(/(?:msie\s([\w.]+))/),r=t.match(/(?:trident.*rv:([\w.]+))/);n=i&&r&&i[1]&&r[1]?Math.max(1*i[1],1*r[1]):i&&i[1]?1*i[1]:r&&r[1]?1*r[1]:0,a.ie11Compat=11==document.documentMode,a.ie9Compat=9==document.documentMode,a.ie8=!!document.documentMode,a.ie8Compat=8==document.documentMode,a.ie7Compat=7==n&&!document.documentMode||7==document.documentMode,a.ie6Compat=n<7||a.quirks,a.ie9above=n>8,a.ie9below=n<9,a.ie11above=n>10,a.ie11below=n<11}if(a.gecko){var s=t.match(/rv:([\d\.]+)/);s&&(s=s[1].split("."),n=1e4*s[0]+100*(s[1]||0)+1*(s[2]||0))}return/chrome\/(\d+\.\d)/i.test(t)&&(a.chrome=+RegExp["$1"]),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(t)&&!/chrome/i.test(t)&&(a.safari=+(RegExp["$1"]||RegExp["$2"])),a.opera&&(n=parseFloat(e.version())),a.webkit&&(n=parseFloat(t.match(/ applewebkit\/(\d+)/)[1])),a.version=n,a.isCompatible=!a.mobile&&(a.ie&&n>=6||a.gecko&&n>=10801||a.opera&&n>=9.5||a.air&&n>=1||a.webkit&&n>=522||!1),a}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera,utils=UE.utils={each:function(t,e,a){if(null!=t)if(t.length===+t.length){for(var n=0,i=t.length;n<i;n++)if(!1===e.call(a,t[n],n,t))return!1}else for(var r in t)if(t.hasOwnProperty(r)&&!1===e.call(a,t[r],r,t))return!1},makeInstance:function(t){var e=new Function;return e.prototype=t,t=new e,e.prototype=null,t},extend:function(t,e,a){if(e)for(var n in e)a&&t.hasOwnProperty(n)||(t[n]=e[n]);return t},extend2:function(t){for(var e=arguments,a=1;a<e.length;a++){var n=e[a];for(var i in n)t.hasOwnProperty(i)||(t[i]=n[i])}return t},inherits:function(t,e){var a=t.prototype,n=utils.makeInstance(e.prototype);return utils.extend(n,a,!0),t.prototype=n,n.constructor=t},bind:function(t,e){return function(){return t.apply(e,arguments)}},defer:function(t,e,a){var n;return function(){a&&clearTimeout(n),n=setTimeout(t,e)}},indexOf:function(t,e,a){var n=-1;return a=this.isNumber(a)?a:0,this.each(t,(function(t,i){if(i>=a&&t===e)return n=i,!1})),n},removeItem:function(t,e){for(var a=0,n=t.length;a<n;a++)t[a]===e&&(t.splice(a,1),a--)},trim:function(t){return t.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(t){if(!t)return{};t=utils.isArray(t)?t:t.split(",");for(var e,a=0,n={};e=t[a++];)n[e.toUpperCase()]=n[e]=1;return n},unhtml:function(t,e){return t?t.replace(e||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,(function(t,e){return e?t:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[t]})):""},unhtmlForUrl:function(t,e){return t?t.replace(e||/[<">']/g,(function(t){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[t]})):""},html:function(t){return t?t.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,(function(t){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[t]})):""},cssStyleToDomStyle:function(){var t=document.createElement("div").style,e={float:void 0!=t.cssFloat?"cssFloat":void 0!=t.styleFloat?"styleFloat":"float"};return function(t){return e[t]||(e[t]=t.toLowerCase().replace(/-./g,(function(t){return t.charAt(1).toUpperCase()})))}}(),loadFile:function(){var t=[];function e(e,a){try{for(var n,i=0;n=t[i++];)if(n.doc===e&&n.url==(a.src||a.href))return n}catch(r){return null}}return function(a,n,i){var r=e(a,n);if(r)r.ready?i&&i():r.funs.push(i);else if(t.push({doc:a,url:n.src||n.href,funs:[i]}),a.body){if(!n.id||!a.getElementById(n.id)){var s=a.createElement(n.tag);for(var o in delete n.tag,n)s.setAttribute(o,n[o]);s.onload=s.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(r=e(a,n),r.funs.length>0){r.ready=1;for(var t;t=r.funs.pop();)t()}s.onload=s.onreadystatechange=null}},s.onerror=function(){throw Error("The load "+(n.href||n.src)+" fails,check the url settings of file ueditor.config.js ")},a.getElementsByTagName("head")[0].appendChild(s)}}else{var l=[];for(var o in n)"tag"!=o&&l.push(o+'="'+n[o]+'"');a.write("<"+n.tag+" "+l.join(" ")+" ></"+n.tag+">")}}}(),isEmptyObject:function(t){if(null==t)return!0;if(this.isArray(t)||this.isString(t))return 0===t.length;for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},fixColor:function(t,e){if(/color/i.test(t)&&/rgba?/.test(e)){var a=e.split(",");if(a.length>3)return"";e="#";for(var n,i=0;n=a[i++];)n=parseInt(n.replace(/[^\d]/gi,""),10).toString(16),e+=1==n.length?"0"+n:n;e=e.toUpperCase()}return e},optCss:function(t){var e,a;function n(t,e){if(!t)return"";var a=t.top,n=t.bottom,i=t.left,r=t.right,s="";if(a&&i&&n&&r)s+=";"+e+":"+(a==n&&n==i&&i==r?a:a==n&&i==r?a+" "+i:i==r?a+" "+i+" "+n:a+" "+r+" "+n+" "+i)+";";else for(var o in t)s+=";"+e+"-"+o+":"+t[o]+";";return s}return t=t.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,(function(t,n,i,r){if(1==r.split(" ").length)switch(n){case"padding":return!e&&(e={}),e[i]=r,"";case"margin":return!a&&(a={}),a[i]=r,"";case"border":return"initial"==r?"":t}return t})),t+=n(e,"padding")+n(a,"margin"),t.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,(function(t,e){return e?e+";;":";"}))},clone:function(t,e){var a;for(var n in e=e||{},t)t.hasOwnProperty(n)&&(a=t[n],"object"==_typeof(a)?(e[n]=utils.isArray(a)?[]:{},utils.clone(t[n],e[n])):e[n]=a);return e},transUnitToPx:function(t){if(!/(pt|cm)/.test(t))return t;var e;switch(t.replace(/([\d.]+)(\w+)/,(function(a,n,i){t=n,e=i})),e){case"cm":t=25*parseFloat(t);break;case"pt":t=Math.round(96*parseFloat(t)/72)}return t+(t?"px":"")},domReady:function(){var t=[];function e(e){e.isReady=!0;for(var a;a=t.pop();a());}return function(a,n){n=n||window;var i=n.document;a&&t.push(a),"complete"===i.readyState?e(i):(i.isReady&&e(i),browser.ie&&11!=browser.version?(function(){if(!i.isReady){try{i.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e(i)}}(),n.attachEvent("onload",(function(){e(i)}))):(i.addEventListener("DOMContentLoaded",(function(){i.removeEventListener("DOMContentLoaded",arguments.callee,!1),e(i)}),!1),n.addEventListener("load",(function(){e(i)}),!1)))}}(),cssRule:browser.ie&&11!=browser.version?function(t,e,a){var n,i;return void 0===e||e&&e.nodeType&&9==e.nodeType?(a=e&&e.nodeType&&9==e.nodeType?e:a||document,n=a.indexList||(a.indexList={}),i=n[t],void 0!==i?a.styleSheets[i].cssText:void 0):(a=a||document,n=a.indexList||(a.indexList={}),i=n[t],""===e?void 0!==i&&(a.styleSheets[i].cssText="",delete n[t],!0):(void 0!==i?sheetStyle=a.styleSheets[i]:(sheetStyle=a.createStyleSheet("",i=a.styleSheets.length),n[t]=i),void(sheetStyle.cssText=e)))}:function(t,e,a){var n;return void 0===e||e&&e.nodeType&&9==e.nodeType?(a=e&&e.nodeType&&9==e.nodeType?e:a||document,n=a.getElementById(t),n?n.innerHTML:void 0):(a=a||document,n=a.getElementById(t),""===e?!!n&&(n.parentNode.removeChild(n),!0):void(n?n.innerHTML=e:(n=a.createElement("style"),n.id=t,n.innerHTML=e,a.getElementsByTagName("head")[0].appendChild(n))))},sort:function(t,e){e=e||function(t,e){return t.localeCompare(e)};for(var a=0,n=t.length;a<n;a++)for(var i=a,r=t.length;i<r;i++)if(e(t[a],t[i])>0){var s=t[a];t[a]=t[i],t[i]=s}return t},serializeParam:function(t){var e=[];for(var a in t)if("method"!=a&&"timeout"!=a&&"async"!=a)if("function"!=_typeof(t[a]).toLowerCase()&&"object"!=_typeof(t[a]).toLowerCase())e.push(encodeURIComponent(a)+"="+encodeURIComponent(t[a]));else if(utils.isArray(t[a]))for(var n=0;n<t[a].length;n++)e.push(encodeURIComponent(a)+"[]="+encodeURIComponent(t[a][n]));return e.join("&")},formatUrl:function(t){var e=t.replace(/&&/g,"&");return e=e.replace(/\?&/g,"?"),e=e.replace(/&$/g,""),e=e.replace(/&#/g,"#"),e=e.replace(/&+/g,"&"),e},isCrossDomainUrl:function(t){var e=document.createElement("a");return e.href=t,browser.ie&&(e.href=e.href),!(e.protocol==location.protocol&&e.hostname==location.hostname&&(e.port==location.port||"80"==e.port&&""==location.port||""==e.port&&"80"==location.port))},clearEmptyAttrs:function(t){for(var e in t)""===t[e]&&delete t[e];return t},str2json:function(t){return utils.isString(t)?window.JSON?JSON.parse(t):new Function("return "+utils.trim(t||""))():null},json2str:function(){if(window.JSON)return JSON.stringify;var t=function(t){return/["\\\x00-\x1f]/.test(t)&&(t=t.replace(/["\\\x00-\x1f]/g,(function(t){var e=i[t];return e||(e=t.charCodeAt(),"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16))}))),'"'+t+'"'},e=function(t){var e,a,n,i=["["],r=t.length;for(a=0;a<r;a++)switch(n=t[a],_typeof(n)){case"undefined":case"function":case"unknown":break;default:e&&i.push(","),i.push(utils.json2str(n)),e=1}return i.push("]"),i.join("")},a=function(t){return t<10?"0"+t:t},n=function(t){return'"'+t.getFullYear()+"-"+a(t.getMonth()+1)+"-"+a(t.getDate())+"T"+a(t.getHours())+":"+a(t.getMinutes())+":"+a(t.getSeconds())+'"'},i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(a){switch(_typeof(a)){case"undefined":return"undefined";case"number":return isFinite(a)?String(a):"null";case"string":return t(a);case"boolean":return String(a);default:if(null===a)return"null";if(utils.isArray(a))return e(a);if(utils.isDate(a))return n(a);var i,r,s=["{"],o=utils.json2str;for(var l in a)if(Object.prototype.hasOwnProperty.call(a,l))switch(r=a[l],_typeof(r)){case"undefined":case"unknown":case"function":break;default:i&&s.push(","),i=1,s.push(o(l)+":"+o(r))}return s.push("}"),s.join("")}}}()};utils.each(["String","Function","Array","Number","RegExp","Object","Date"],(function(t){UE.utils["is"+t]=function(e){return Object.prototype.toString.apply(e)=="[object "+t+"]"}}));var EventBase=UE.EventBase=function(){};function getListener(t,e,a){var n;return e=e.toLowerCase(),(n=t.__allListeners||a&&(t.__allListeners={}))&&(n[e]||a&&(n[e]=[]))}EventBase.prototype={addListener:function(t,e){t=utils.trim(t).split(/\s+/);for(var a,n=0;a=t[n++];)getListener(this,a,!0).push(e)},on:function(t,e){return this.addListener(t,e)},off:function(t,e){return this.removeListener(t,e)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(t,e){t=utils.trim(t).split(/\s+/);for(var a,n=0;a=t[n++];)utils.removeItem(getListener(this,a)||[],e)},fireEvent:function(){var t=arguments[0];t=utils.trim(t).split(" ");for(var e,a=0;e=t[a++];){var n,i,r,s=getListener(this,e);if(s){r=s.length;while(r--)if(s[r]){if(i=s[r].apply(this,arguments),!0===i)return i;void 0!==i&&(n=i)}}(i=this["on"+e.toLowerCase()])&&(n=i.apply(this,arguments))}return n}};var dtd=dom.dtd=function(){function t(t){for(var e in t)t[e.toUpperCase()]=t[e];return t}var e=utils.extend2,a=t({isindex:1,fieldset:1}),n=t({input:1,button:1,select:1,textarea:1,label:1}),i=e(t({a:1}),n),r=e({iframe:1},i),s=t({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),o=t({ins:1,del:1,script:1,style:1}),l=e(t({b:1,acronym:1,bdo:1,var:1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),o),u=e(t({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),l),d=e(t({p:1}),u),c=e(t({iframe:1}),u,n),p=t({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,var:1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),h=e(t({a:0}),c),g=t({tr:1}),f=t({"#":1}),m=e(t({param:1}),p),v=e(t({form:1}),a,r,s,d),b=t({li:1,ol:1,ul:1}),y=t({style:1,script:1}),_=t({base:1,link:1,meta:1,title:1}),D=e(_,y),C=t({head:1,body:1}),w=t({html:1}),x=t({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),k=t({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return t({$nonBodyContent:e(w,C,_),$block:x,$inline:h,$inlineWithA:e(t({a:1}),h),$body:e(t({script:1,style:1}),x),$cdata:t({script:1,style:1}),$empty:k,$nonChild:t({iframe:1,textarea:1}),$listItem:t({dd:1,dt:1,li:1}),$list:t({ul:1,ol:1,dl:1}),$isNotEmpty:t({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:t({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1}),$removeEmptyBlock:t({p:1,div:1}),$tableContent:t({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:t({pre:1,script:1,style:1,textarea:1}),html:C,head:D,style:f,script:f,body:v,base:{},link:{},meta:{},title:f,col:{},tr:t({td:1,th:1}),img:{},embed:{},colgroup:t({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:v,td:v,br:{},th:v,center:v,kbd:h,button:e(d,s),basefont:{},h5:h,h4:h,samp:h,h6:h,ol:b,h1:h,h3:h,option:f,h2:h,form:e(a,r,s,d),select:t({optgroup:1,option:1}),font:h,ins:h,menu:b,abbr:h,label:h,table:t({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:h,tfoot:g,cite:h,li:v,input:{},iframe:v,strong:h,textarea:f,noframes:v,big:h,small:h,span:t({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:h,dt:h,sub:h,optgroup:t({option:1}),param:{},bdo:h,var:h,div:v,object:m,sup:h,dd:v,strike:h,area:{},dir:b,map:e(t({area:1,form:1,p:1}),a,o,s),applet:m,dl:t({dt:1,dd:1}),del:h,isindex:{},fieldset:e(t({legend:1}),p),thead:g,ul:b,acronym:h,b:h,a:e(t({a:1}),c),blockquote:e(t({td:1,tr:1,tbody:1,li:1}),v),caption:h,i:h,u:h,tbody:g,s:h,address:e(r,d),tt:h,legend:h,q:h,pre:e(l,i),p:e(t({a:1}),h),em:h,dfn:h})}();function getDomNode(t,e,a,n,i,r){var s,o=n&&t[e];!o&&(o=t[a]);while(!o&&(s=(s||t).parentNode)){if("BODY"==s.tagName||r&&!r(s))return null;o=s[a]}return o&&i&&!i(o)?getDomNode(o,e,a,!1,i):o}var attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&"6"==browser.version?"\ufeff":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(t,e){if(t===e)return 0;var a,n=[t],i=[e];a=t;while(a=a.parentNode){if(a===e)return 10;n.push(a)}a=e;while(a=a.parentNode){if(a===t)return 20;i.push(a)}if(n.reverse(),i.reverse(),n[0]!==i[0])return 1;var r=-1;while(r++,n[r]===i[r]);t=n[r],e=i[r];while(t=t.nextSibling)if(t===e)return 4;return 2},getNodeIndex:function(t,e){var a=t,n=0;while(a=a.previousSibling)e&&3==a.nodeType?a.nodeType!=a.nextSibling.nodeType&&n++:n++;return n},inDoc:function(t,e){return 10==domUtils.getPosition(t,e)},findParent:function(t,e,a){if(t&&!domUtils.isBody(t)){t=a?t:t.parentNode;while(t){if(!e||e(t)||domUtils.isBody(t))return e&&!e(t)&&domUtils.isBody(t)?null:t;t=t.parentNode}}return null},findParentByTagName:function(t,e,a,n){return e=utils.listToMap(utils.isArray(e)?e:[e]),domUtils.findParent(t,(function(t){return e[t.tagName]&&!(n&&n(t))}),a)},findParents:function(t,e,a,n){var i=e&&(a&&a(t)||!a)?[t]:[];while(t=domUtils.findParent(t,a))i.push(t);return n?i:i.reverse()},insertAfter:function(t,e){return t.nextSibling?t.parentNode.insertBefore(e,t.nextSibling):t.parentNode.appendChild(e)},remove:function(t,e){var a,n=t.parentNode;if(n){if(e&&t.hasChildNodes())while(a=t.firstChild)n.insertBefore(a,t);n.removeChild(t)}return t},getNextDomNode:function(t,e,a,n){return getDomNode(t,"firstChild","nextSibling",e,a,n)},getPreDomNode:function(t,e,a,n){return getDomNode(t,"lastChild","previousSibling",e,a,n)},isBookmarkNode:function(t){return 1==t.nodeType&&t.id&&/^_baidu_bookmark_/i.test(t.id)},getWindow:function(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow},getCommonAncestor:function(t,e){if(t===e)return t;var a=[t],n=[e],i=t,r=-1;while(i=i.parentNode){if(i===e)return i;a.push(i)}i=e;while(i=i.parentNode){if(i===t)return i;n.push(i)}a.reverse(),n.reverse();while(r++,a[r]===n[r]);return 0==r?null:a[r-1]},clearEmptySibling:function(t,e,a){function n(t,e){var a;while(t&&!domUtils.isBookmarkNode(t)&&(domUtils.isEmptyInlineElement(t)||!new RegExp("[^\t\n\r"+domUtils.fillChar+"]").test(t.nodeValue)))a=t[e],domUtils.remove(t),t=a}!e&&n(t.nextSibling,"nextSibling"),!a&&n(t.previousSibling,"previousSibling")},split:function(t,e){var a=t.ownerDocument;if(browser.ie&&e==t.nodeValue.length){var n=a.createTextNode("");return domUtils.insertAfter(t,n)}var i=t.splitText(e);if(browser.ie8){var r=a.createTextNode("");domUtils.insertAfter(i,r),domUtils.remove(r)}return i},isWhitespace:function(t){return!new RegExp("[^ \t\n\r"+domUtils.fillChar+"]").test(t.nodeValue)},getXY:function(t){var e=0,a=0;while(t.offsetParent)a+=t.offsetTop,e+=t.offsetLeft,t=t.offsetParent;return{x:e,y:a}},on:function(t,e,a){var n=utils.isArray(e)?e:utils.trim(e).split(/\s+/),i=n.length;if(i)while(i--)if(e=n[i],t.addEventListener)t.addEventListener(e,a,!1);else{a._d||(a._d={els:[]});var r=e+a.toString(),s=utils.indexOf(a._d.els,t);a._d[r]&&-1!=s||(-1==s&&a._d.els.push(t),a._d[r]||(a._d[r]=function(t){return a.call(t.srcElement,t||window.event)}),t.attachEvent("on"+e,a._d[r]))}t=null},un:function(t,e,a){var n=utils.isArray(e)?e:utils.trim(e).split(/\s+/),i=n.length;if(i)while(i--)if(e=n[i],t.removeEventListener)t.removeEventListener(e,a,!1);else{var r=e+a.toString();try{t.detachEvent("on"+e,a._d?a._d[r]:a)}catch(o){}if(a._d&&a._d[r]){var s=utils.indexOf(a._d.els,t);-1!=s&&a._d.els.splice(s,1),0==a._d.els.length&&delete a._d[r]}}},isSameElement:function(t,e){if(t.tagName!=e.tagName)return!1;var a=t.attributes,n=e.attributes;if(!ie&&a.length!=n.length)return!1;for(var i,r,s=0,o=0,l=0;i=a[l++];){if("style"==i.nodeName){if(i.specified&&s++,domUtils.isSameStyle(t,e))continue;return!1}if(ie){if(!i.specified)continue;s++,r=n.getNamedItem(i.nodeName)}else r=e.attributes[i.nodeName];if(!r.specified||i.nodeValue!=r.nodeValue)return!1}if(ie){for(l=0;r=n[l++];)r.specified&&o++;if(s!=o)return!1}return!0},isSameStyle:function(t,e){var a=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),n=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){if(a=t.style,n=e.style,a.length!=n.length)return!1;for(var i in a)if(!/^(\d+|csstext)$/i.test(i)&&a[i]!=n[i])return!1;return!0}if(!a||!n)return a==n;if(a=a.split(";"),n=n.split(";"),a.length!=n.length)return!1;for(var r,s=0;r=a[s++];)if(-1==utils.indexOf(n,r))return!1;return!0},isBlockElm:function(t){return 1==t.nodeType&&(dtd.$block[t.tagName]||styleBlock[domUtils.getComputedStyle(t,"display")])&&!dtd.$nonChild[t.tagName]},isBody:function(t){return t&&1==t.nodeType&&"body"==t.tagName.toLowerCase()},breakParent:function(t,e){var a,n,i,r=t,s=t;do{r=r.parentNode,n?(a=r.cloneNode(!1),a.appendChild(n),n=a,a=r.cloneNode(!1),a.appendChild(i),i=a):(n=r.cloneNode(!1),i=n.cloneNode(!1));while(a=s.previousSibling)n.insertBefore(a,n.firstChild);while(a=s.nextSibling)i.appendChild(a);s=r}while(e!==r);return a=e.parentNode,a.insertBefore(n,e),a.insertBefore(i,e),a.insertBefore(t,i),domUtils.remove(e),t},isEmptyInlineElement:function(t){if(1!=t.nodeType||!dtd.$removeEmpty[t.tagName])return 0;t=t.firstChild;while(t){if(domUtils.isBookmarkNode(t))return 0;if(1==t.nodeType&&!domUtils.isEmptyInlineElement(t)||3==t.nodeType&&!domUtils.isWhitespace(t))return 0;t=t.nextSibling}return 1},trimWhiteTextNode:function(t){function e(e){var a;while((a=t[e])&&3==a.nodeType&&domUtils.isWhitespace(a))t.removeChild(a)}e("firstChild"),e("lastChild")},mergeChild:function(t,e,a){for(var n,i=domUtils.getElementsByTagName(t,t.tagName.toLowerCase()),r=0;n=i[r++];)if(n.parentNode&&!domUtils.isBookmarkNode(n))if("span"!=n.tagName.toLowerCase())domUtils.isSameElement(t,n)&&domUtils.remove(n,!0);else{if(t===n.parentNode&&(domUtils.trimWhiteTextNode(t),1==t.childNodes.length)){t.style.cssText=n.style.cssText+";"+t.style.cssText,domUtils.remove(n,!0);continue}if(n.style.cssText=t.style.cssText+";"+n.style.cssText,a){var s=a.style;if(s){s=s.split(";");for(var o,l=0;o=s[l++];)n.style[utils.cssStyleToDomStyle(o.split(":")[0])]=o.split(":")[1]}}domUtils.isSameStyle(n,t)&&domUtils.remove(n,!0)}},getElementsByTagName:function(t,e,a){if(a&&utils.isString(a)){var n=a;a=function(t){return domUtils.hasClass(t,n)}}e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");for(var i,r=[],s=0;i=e[s++];)for(var o,l=t.getElementsByTagName(i),u=0;o=l[u++];)a&&!a(o)||r.push(o);return r},mergeToParent:function(t){var e=t.parentNode;while(e&&dtd.$removeEmpty[e.tagName]){if(e.tagName==t.tagName||"A"==e.tagName){if(domUtils.trimWhiteTextNode(e),"SPAN"==e.tagName&&!domUtils.isSameStyle(e,t)||"A"==e.tagName&&"SPAN"==t.tagName){if(e.childNodes.length>1||e!==t.parentNode){t.style.cssText=e.style.cssText+";"+t.style.cssText,e=e.parentNode;continue}e.style.cssText+=";"+t.style.cssText,"A"==e.tagName&&(e.style.textDecoration="underline")}if("A"!=e.tagName){e===t.parentNode&&domUtils.remove(t,!0);break}}e=e.parentNode}},mergeSibling:function(t,e,a){function n(t,e,a){var n;if((n=a[t])&&!domUtils.isBookmarkNode(n)&&1==n.nodeType&&domUtils.isSameElement(a,n)){while(n.firstChild)"firstChild"==e?a.insertBefore(n.lastChild,a.firstChild):a.appendChild(n.firstChild);domUtils.remove(n)}}!e&&n("previousSibling","firstChild",t),!a&&n("nextSibling","lastChild",t)},unSelectable:ie&&browser.ie9below||browser.opera?function(t){t.onselectstart=function(){return!1},t.onclick=t.onkeyup=t.onkeydown=function(){return!1},t.unselectable="on",t.setAttribute("unselectable","on");for(var e,a=0;e=t.all[a++];)switch(e.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:e.unselectable="on",t.setAttribute("unselectable","on")}}:function(t){t.style.MozUserSelect=t.style.webkitUserSelect=t.style.msUserSelect=t.style.KhtmlUserSelect="none"},removeAttributes:function(t,e){e=utils.isArray(e)?e:utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");for(var a,n=0;a=e[n++];){switch(a=attrFix[a]||a,a){case"className":t[a]="";break;case"style":t.style.cssText="";var i=t.getAttributeNode("style");!browser.ie&&i&&t.removeAttributeNode(i)}t.removeAttribute(a)}},createElement:function(t,e,a){return domUtils.setAttributes(t.createElement(e),a)},setAttributes:function(t,e){for(var a in e)if(e.hasOwnProperty(a)){var n=e[a];switch(a){case"class":t.className=n;break;case"style":t.style.cssText=t.style.cssText+";"+n;break;case"innerHTML":t[a]=n;break;case"value":t.value=n;break;default:t.setAttribute(attrFix[a]||a,n)}}return t},getComputedStyle:function(t,e){var a="width height top left";if(a.indexOf(e)>-1)return t["offset"+e.replace(/^\w/,(function(t){return t.toUpperCase()}))]+"px";if(3==t.nodeType&&(t=t.parentNode),browser.ie&&browser.version<9&&"font-size"==e&&!t.style.fontSize&&!dtd.$empty[t.tagName]&&!dtd.$nonChild[t.tagName]){var n=t.ownerDocument.createElement("span");n.style.cssText="padding:0;border:0;font-family:simsun;",n.innerHTML=".",t.appendChild(n);var i=n.offsetHeight;return t.removeChild(n),n=null,i+"px"}try{var r=domUtils.getStyle(t,e)||(window.getComputedStyle?domUtils.getWindow(t).getComputedStyle(t,"").getPropertyValue(e):(t.currentStyle||t.style)[utils.cssStyleToDomStyle(e)])}catch(s){return""}return utils.transUnitToPx(utils.fixColor(e,r))},removeClasses:function(t,e){e=utils.isArray(e)?e:utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");for(var a,n=0,i=t.className;a=e[n++];)i=i.replace(new RegExp("\\b"+a+"\\b"),"");i=utils.trim(i).replace(/[ ]{2,}/g," "),i?t.className=i:domUtils.removeAttributes(t,["class"])},addClass:function(t,e){if(t){e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");for(var a,n=0,i=t.className;a=e[n++];)new RegExp("\\b"+a+"\\b").test(i)||(i+=" "+a);t.className=utils.trim(i)}},hasClass:function(t,e){if(utils.isRegExp(e))return e.test(t.className);e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");for(var a,n=0,i=t.className;a=e[n++];)if(!new RegExp("\\b"+a+"\\b","i").test(i))return!1;return n-1==e.length},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},removeStyle:function(t,e){browser.ie?("color"==e&&(e="(^|;)"+e),t.style.cssText=t.style.cssText.replace(new RegExp(e+"[^:]*:[^;]+;?","ig"),"")):t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(utils.cssStyleToDomStyle(e)),t.style.cssText||domUtils.removeAttributes(t,["style"])},getStyle:function(t,e){var a=t.style[utils.cssStyleToDomStyle(e)];return utils.fixColor(e,a)},setStyle:function(t,e,a){t.style[utils.cssStyleToDomStyle(e)]=a,utils.trim(t.style.cssText)||this.removeAttributes(t,"style")},setStyles:function(t,e){for(var a in e)e.hasOwnProperty(a)&&domUtils.setStyle(t,a,e[a])},removeDirtyAttr:function(t){for(var e,a=0,n=t.getElementsByTagName("*");e=n[a++];)e.removeAttribute("_moz_dirty");t.removeAttribute("_moz_dirty")},getChildCount:function(t,e){var a=0,n=t.firstChild;e=e||function(){return 1};while(n)e(n)&&a++,n=n.nextSibling;return a},isEmptyNode:function(t){return!t.firstChild||0==domUtils.getChildCount(t,(function(t){return!domUtils.isBr(t)&&!domUtils.isBookmarkNode(t)&&!domUtils.isWhitespace(t)}))},clearSelectedArr:function(t){var e;while(e=t.pop())domUtils.removeAttributes(e,["class"])},scrollToView:function(t,e,a){var n=function(){var t=e.document,a="CSS1Compat"==t.compatMode;return{width:(a?t.documentElement.clientWidth:t.body.clientWidth)||0,height:(a?t.documentElement.clientHeight:t.body.clientHeight)||0}},i=function(t){if("pageXOffset"in t)return{x:t.pageXOffset||0,y:t.pageYOffset||0};var e=t.document;return{x:e.documentElement.scrollLeft||e.body.scrollLeft||0,y:e.documentElement.scrollTop||e.body.scrollTop||0}},r=n().height,s=-1*r+a;s+=t.offsetHeight||0;var o=domUtils.getXY(t);s+=o.y;var l=i(e).y;(s>l||s<l-r)&&e.scrollTo(0,s+(s<0?-20:20))},isBr:function(t){return 1==t.nodeType&&"BR"==t.tagName},isFillChar:function(t,e){if(3!=t.nodeType)return!1;var a=t.nodeValue;return e?new RegExp("^"+domUtils.fillChar).test(a):!a.replace(new RegExp(domUtils.fillChar,"g"),"").length},isStartInblock:function(t){var e,a=t.cloneRange(),n=0,i=a.startContainer;if(1==i.nodeType&&i.childNodes[a.startOffset]){i=i.childNodes[a.startOffset];var r=i.previousSibling;while(r&&domUtils.isFillChar(r))i=r,r=r.previousSibling}this.isFillChar(i,!0)&&1==a.startOffset&&(a.setStartBefore(i),i=a.startContainer);while(i&&domUtils.isFillChar(i))e=i,i=i.previousSibling;e&&(a.setStartBefore(e),i=a.startContainer),1==i.nodeType&&domUtils.isEmptyNode(i)&&1==a.startOffset&&a.setStart(i,0).collapse(!0);while(!a.startOffset){if(i=a.startContainer,domUtils.isBlockElm(i)||domUtils.isBody(i)){n=1;break}var s;r=a.startContainer.previousSibling;if(r){while(r&&domUtils.isFillChar(r))s=r,r=r.previousSibling;s?a.setStartBefore(s):a.setStartBefore(a.startContainer)}else a.setStartBefore(a.startContainer)}return n&&!domUtils.isBody(a.startContainer)?1:0},isEmptyBlock:function(t,e){if(1!=t.nodeType)return 0;if(e=e||new RegExp("[  \t\r\n"+domUtils.fillChar+"]","g"),t[browser.ie?"innerText":"textContent"].replace(e,"").length>0)return 0;for(var a in dtd.$isNotEmpty)if(t.getElementsByTagName(a).length)return 0;return 1},setViewportOffset:function(t,e){var a=0|parseInt(t.style.left),n=0|parseInt(t.style.top),i=t.getBoundingClientRect(),r=e.left-i.left,s=e.top-i.top;r&&(t.style.left=a+r+"px"),s&&(t.style.top=n+s+"px")},fillNode:function(t,e){var a=browser.ie?t.createTextNode(domUtils.fillChar):t.createElement("br");e.innerHTML="",e.appendChild(a)},moveChild:function(t,e,a){while(t.firstChild)a&&e.firstChild?e.insertBefore(t.lastChild,e.firstChild):e.appendChild(t.firstChild)},hasNoAttributes:function(t){return browser.ie?/^<\w+\s*?>/.test(t.outerHTML):0==t.attributes.length},isCustomeNode:function(t){return 1==t.nodeType&&t.getAttribute("_ue_custom_node_")},isTagNode:function(t,e){return 1==t.nodeType&&new RegExp("\\b"+t.tagName+"\\b","i").test(e)},filterNodeList:function(t,e,a){var n=[];if(!utils.isFunction(e)){var i=e;e=function(t){return-1!=utils.indexOf(utils.isArray(i)?i:i.split(" "),t.tagName.toLowerCase())}}return utils.each(t,(function(t){e(t)&&n.push(t)})),0==n.length?null:1!=n.length&&a?n:n[0]},isInNodeEndBoundary:function(t,e){var a=t.startContainer;if(3==a.nodeType&&t.startOffset!=a.nodeValue.length)return 0;if(1==a.nodeType&&t.startOffset!=a.childNodes.length)return 0;while(a!==e){if(a.nextSibling)return 0;a=a.parentNode}return 1},isBoundaryNode:function(t,e){var a;while(!domUtils.isBody(t))if(a=t,t=t.parentNode,a!==t[e])return!1;return!0},fillHtml:browser.ie11below?"&nbsp;":"<br/>"},fillCharReg=new RegExp(domUtils.fillChar,"g");(function(){var t,e=0,a=domUtils.fillChar;function n(t){t.collapsed=t.startContainer&&t.endContainer&&t.startContainer===t.endContainer&&t.startOffset==t.endOffset}function i(t){return!t.collapsed&&1==t.startContainer.nodeType&&t.startContainer===t.endContainer&&t.endOffset-t.startOffset==1}function r(t,e,a,i){return 1==e.nodeType&&(dtd.$empty[e.tagName]||dtd.$nonChild[e.tagName])&&(a=domUtils.getNodeIndex(e)+(t?0:1),e=e.parentNode),t?(i.startContainer=e,i.startOffset=a,i.endContainer||i.collapse(!0)):(i.endContainer=e,i.endOffset=a,i.startContainer||i.collapse(!1)),n(i),i}function s(t,e){var a,n,i=t.startContainer,r=t.endContainer,s=t.startOffset,o=t.endOffset,l=t.document,u=l.createDocumentFragment();if(1==i.nodeType&&(i=i.childNodes[s]||(a=i.appendChild(l.createTextNode("")))),1==r.nodeType&&(r=r.childNodes[o]||(n=r.appendChild(l.createTextNode("")))),i===r&&3==i.nodeType)return u.appendChild(l.createTextNode(i.substringData(s,o-s))),e&&(i.deleteData(s,o-s),t.collapse(!0)),u;for(var d,c,p=u,h=domUtils.findParents(i,!0),g=domUtils.findParents(r,!0),f=0;h[f]==g[f];)f++;for(var m,v=f;m=h[v];v++){d=m.nextSibling,m==i?a||(3==t.startContainer.nodeType?(p.appendChild(l.createTextNode(i.nodeValue.slice(s))),e&&i.deleteData(s,i.nodeValue.length-s)):p.appendChild(e?i:i.cloneNode(!0))):(c=m.cloneNode(!1),p.appendChild(c));while(d){if(d===r||d===g[v])break;m=d.nextSibling,p.appendChild(e?d:d.cloneNode(!0)),d=m}p=c}p=u,h[f]||(p.appendChild(h[f-1].cloneNode(!1)),p=p.firstChild);var b;for(v=f;b=g[v];v++){if(d=b.previousSibling,b==r?n||3!=t.endContainer.nodeType||(p.appendChild(l.createTextNode(r.substringData(0,o))),e&&r.deleteData(0,o)):(c=b.cloneNode(!1),p.appendChild(c)),v!=f||!h[f])while(d){if(d===i)break;b=d.previousSibling,p.insertBefore(e?d:d.cloneNode(!0),p.firstChild),d=b}p=c}return e&&t.setStartBefore(g[f]?h[f]?g[f]:h[f-1]:g[f-1]).collapse(!0),a&&domUtils.remove(a),n&&domUtils.remove(n),u}var o=dom.Range=function(t){var e=this;e.startContainer=e.startOffset=e.endContainer=e.endOffset=null,e.document=t,e.collapsed=!0};function l(e,a){try{if(t&&domUtils.inDoc(t,e))if(t.nodeValue.replace(fillCharReg,"").length)t.nodeValue=t.nodeValue.replace(fillCharReg,"");else{var n=t.parentNode;domUtils.remove(t);while(n&&domUtils.isEmptyInlineElement(n)&&(browser.safari?!(domUtils.getPosition(n,a)&domUtils.POSITION_CONTAINS):!n.contains(a)))t=n.parentNode,domUtils.remove(n),n=t}}catch(i){}}function u(t,e){var a;t=t[e];while(t&&domUtils.isFillChar(t))a=t[e],domUtils.remove(t),t=a}o.prototype={cloneContents:function(){return this.collapsed?null:s(this,0)},deleteContents:function(){var t;return this.collapsed||s(this,1),browser.webkit&&(t=this.startContainer,3!=t.nodeType||t.nodeValue.length||(this.setStartBefore(t).collapse(!0),domUtils.remove(t))),this},extractContents:function(){return this.collapsed?null:s(this,2)},setStart:function(t,e){return r(!0,t,e,this)},setEnd:function(t,e){return r(!1,t,e,this)},setStartAfter:function(t){return this.setStart(t.parentNode,domUtils.getNodeIndex(t)+1)},setStartBefore:function(t){return this.setStart(t.parentNode,domUtils.getNodeIndex(t))},setEndAfter:function(t){return this.setEnd(t.parentNode,domUtils.getNodeIndex(t)+1)},setEndBefore:function(t){return this.setEnd(t.parentNode,domUtils.getNodeIndex(t))},setStartAtFirst:function(t){return this.setStart(t,0)},setStartAtLast:function(t){return this.setStart(t,3==t.nodeType?t.nodeValue.length:t.childNodes.length)},setEndAtFirst:function(t){return this.setEnd(t,0)},setEndAtLast:function(t){return this.setEnd(t,3==t.nodeType?t.nodeValue.length:t.childNodes.length)},selectNode:function(t){return this.setStartBefore(t).setEndAfter(t)},selectNodeContents:function(t){return this.setStart(t,0).setEndAtLast(t)},cloneRange:function(){var t=this;return new o(t.document).setStart(t.startContainer,t.startOffset).setEnd(t.endContainer,t.endOffset)},collapse:function(t){var e=this;return t?(e.endContainer=e.startContainer,e.endOffset=e.startOffset):(e.startContainer=e.endContainer,e.startOffset=e.endOffset),e.collapsed=!0,e},shrinkBoundary:function(t){var e,a=this,n=a.collapsed;function i(t){return 1==t.nodeType&&!domUtils.isBookmarkNode(t)&&!dtd.$empty[t.tagName]&&!dtd.$nonChild[t.tagName]}while(1==a.startContainer.nodeType&&(e=a.startContainer.childNodes[a.startOffset])&&i(e))a.setStart(e,0);if(n)return a.collapse(!0);if(!t)while(1==a.endContainer.nodeType&&a.endOffset>0&&(e=a.endContainer.childNodes[a.endOffset-1])&&i(e))a.setEnd(e,e.childNodes.length);return a},getCommonAncestor:function(t,e){var a=this,n=a.startContainer,r=a.endContainer;return n===r?t&&i(this)&&(n=n.childNodes[a.startOffset],1==n.nodeType)?n:e&&3==n.nodeType?n.parentNode:n:domUtils.getCommonAncestor(n,r)},trimBoundary:function(t){this.txtToElmBoundary();var e=this.startContainer,a=this.startOffset,n=this.collapsed,i=this.endContainer;if(3==e.nodeType){if(0==a)this.setStartBefore(e);else if(a>=e.nodeValue.length)this.setStartAfter(e);else{var r=domUtils.split(e,a);e===i?this.setEnd(r,this.endOffset-a):e.parentNode===i&&(this.endOffset+=1),this.setStartBefore(r)}if(n)return this.collapse(!0)}return t||(a=this.endOffset,i=this.endContainer,3==i.nodeType&&(0==a?this.setEndBefore(i):(a<i.nodeValue.length&&domUtils.split(i,a),this.setEndAfter(i)))),this},txtToElmBoundary:function(t){function e(t,e){var a=t[e+"Container"],n=t[e+"Offset"];3==a.nodeType&&(n?n>=a.nodeValue.length&&t["set"+e.replace(/(\w)/,(function(t){return t.toUpperCase()}))+"After"](a):t["set"+e.replace(/(\w)/,(function(t){return t.toUpperCase()}))+"Before"](a))}return!t&&this.collapsed||(e(this,"start"),e(this,"end")),this},insertNode:function(t){var e=t,a=1;11==t.nodeType&&(e=t.firstChild,a=t.childNodes.length),this.trimBoundary(!0);var n=this.startContainer,i=this.startOffset,r=n.childNodes[i];return r?n.insertBefore(t,r):n.appendChild(t),e.parentNode===this.endContainer&&(this.endOffset=this.endOffset+a),this.setStartBefore(e)},setCursor:function(t,e){return this.collapse(!t).select(e)},createBookmark:function(t,a){var n,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("‍")),i.id="_baidu_bookmark_start_"+(a?"":e++),this.collapsed||(n=i.cloneNode(!0),n.id="_baidu_bookmark_end_"+(a?"":e++)),this.insertNode(i),n&&this.collapse().insertNode(n).setEndBefore(n),this.setStartAfter(i),{start:t?i.id:i,end:n?t?n.id:n:null,id:t}},moveToBookmark:function(t){var e=t.id?this.document.getElementById(t.start):t.start,a=t.end&&t.id?this.document.getElementById(t.end):t.end;return this.setStartBefore(e),domUtils.remove(e),a?(this.setEndBefore(a),domUtils.remove(a)):this.collapse(!0),this},enlarge:function(t,e){var a,n,i=domUtils.isBody,r=this.document.createTextNode("");if(t){n=this.startContainer,1==n.nodeType?n.childNodes[this.startOffset]?a=n=n.childNodes[this.startOffset]:(n.appendChild(r),a=n=r):a=n;while(1){if(domUtils.isBlockElm(n)){n=a;while((a=n.previousSibling)&&!domUtils.isBlockElm(a))n=a;this.setStartBefore(n);break}a=n,n=n.parentNode}n=this.endContainer,1==n.nodeType?((a=n.childNodes[this.endOffset])?n.insertBefore(r,a):n.appendChild(r),a=n=r):a=n;while(1){if(domUtils.isBlockElm(n)){n=a;while((a=n.nextSibling)&&!domUtils.isBlockElm(a))n=a;this.setEndAfter(n);break}a=n,n=n.parentNode}r.parentNode===this.endContainer&&this.endOffset--,domUtils.remove(r)}if(!this.collapsed){while(0==this.startOffset){if(e&&e(this.startContainer))break;if(i(this.startContainer))break;this.setStartBefore(this.startContainer)}while(this.endOffset==(1==this.endContainer.nodeType?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(e&&e(this.endContainer))break;if(i(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},enlargeToBlockElm:function(t){while(!domUtils.isBlockElm(this.startContainer))this.setStartBefore(this.startContainer);if(!t)while(!domUtils.isBlockElm(this.endContainer))this.setEndAfter(this.endContainer);return this},adjustmentBoundary:function(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!domUtils.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(t,e,a){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,(function(t){return 1==t.nodeType&&domUtils.isBlockElm(t)})).adjustmentBoundary();var n,i,r=this.createBookmark(),s=r.end,o=function(t){return 1==t.nodeType?"br"!=t.tagName.toLowerCase():!domUtils.isWhitespace(t)},l=domUtils.getNextDomNode(r.start,!1,o),u=this.cloneRange();while(l&&domUtils.getPosition(l,s)&domUtils.POSITION_PRECEDING)if(3==l.nodeType||dtd[t][l.tagName]){u.setStartBefore(l),n=l;while(n&&(3==n.nodeType||dtd[t][n.tagName])&&n!==s)i=n,n=domUtils.getNextDomNode(n,1==n.nodeType,null,(function(e){return dtd[t][e.tagName]}));var d,c,p=u.setEndAfter(i).extractContents();if(a&&a.length>0){var h,g;g=h=a[0].cloneNode(!1);for(var f,m=1;f=a[m++];)h.appendChild(f.cloneNode(!1)),h=h.firstChild;d=h}else d=u.document.createElement(t);if(e&&domUtils.setAttributes(d,e),d.appendChild(p),u.insertNode(a?g:d),"span"==t&&e.style&&/text\-decoration/.test(e.style)&&(c=domUtils.findParentByTagName(d,"a",!0))?(domUtils.setAttributes(c,e),domUtils.remove(d,!0),d=c):(domUtils.mergeSibling(d),domUtils.clearEmptySibling(d)),domUtils.mergeChild(d,e),l=domUtils.getNextDomNode(d,!1,o),domUtils.mergeToParent(d),n===s)break}else l=domUtils.getNextDomNode(l,!0,o);return this.moveToBookmark(r)},removeInlineStyle:function(t){if(this.collapsed)return this;t=utils.isArray(t)?t:[t],this.shrinkBoundary().adjustmentBoundary();var e=this.startContainer,a=this.endContainer;while(1){if(1==e.nodeType){if(utils.indexOf(t,e.tagName.toLowerCase())>-1)break;if("body"==e.tagName.toLowerCase()){e=null;break}}e=e.parentNode}while(1){if(1==a.nodeType){if(utils.indexOf(t,a.tagName.toLowerCase())>-1)break;if("body"==a.tagName.toLowerCase()){a=null;break}}a=a.parentNode}var n,i,r=this.createBookmark();e&&(i=this.cloneRange().setEndBefore(r.start).setStartBefore(e),n=i.extractContents(),i.insertNode(n),domUtils.clearEmptySibling(e,!0),e.parentNode.insertBefore(r.start,e)),a&&(i=this.cloneRange().setStartAfter(r.end).setEndAfter(a),n=i.extractContents(),i.insertNode(n),domUtils.clearEmptySibling(a,!1,!0),a.parentNode.insertBefore(r.end,a.nextSibling));var s,o=domUtils.getNextDomNode(r.start,!1,(function(t){return 1==t.nodeType}));while(o&&o!==r.end)s=domUtils.getNextDomNode(o,!0,(function(t){return 1==t.nodeType})),utils.indexOf(t,o.tagName.toLowerCase())>-1&&domUtils.remove(o,!0),o=s;return this.moveToBookmark(r)},getClosedNode:function(){var t;if(!this.collapsed){var e=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(i(e)){var a=e.startContainer.childNodes[e.startOffset];a&&1==a.nodeType&&(dtd.$empty[a.tagName]||dtd.$nonChild[a.tagName])&&(t=a)}}return t},select:browser.ie?function(e,n){var i;this.collapsed||this.shrinkBoundary();var r=this.getClosedNode();if(r&&!n){try{i=this.document.body.createControlRange(),i.addElement(r),i.select()}catch(g){}return this}var s,o=this.createBookmark(),d=o.start;if(i=this.document.body.createTextRange(),i.moveToElementText(d),i.moveStart("character",1),this.collapsed){if(!e&&3!=this.startContainer.nodeType){var c=this.document.createTextNode(a),p=this.document.createElement("span");p.appendChild(this.document.createTextNode(a)),d.parentNode.insertBefore(p,d),d.parentNode.insertBefore(c,d),l(this.document,c),t=c,u(p,"previousSibling"),u(d,"nextSibling"),i.moveStart("character",-1),i.collapse(!0)}}else{var h=this.document.body.createTextRange();s=o.end,h.moveToElementText(s),i.setEndPoint("EndToEnd",h)}this.moveToBookmark(o),p&&domUtils.remove(p);try{i.select()}catch(g){}return this}:function(e){function n(t){function e(e,a,n){3==e.nodeType&&e.nodeValue.length<a&&(t[n+"Offset"]=e.nodeValue.length)}e(t.startContainer,t.startOffset,"start"),e(t.endContainer,t.endOffset,"end")}var i,r=domUtils.getWindow(this.document),s=r.getSelection();if(browser.gecko?this.document.body.focus():r.focus(),s){if(s.removeAllRanges(),this.collapsed&&!e){var o=this.startContainer,d=o;1==o.nodeType&&(d=o.childNodes[this.startOffset]),3==o.nodeType&&this.startOffset||(d?d.previousSibling&&3==d.previousSibling.nodeType:o.lastChild&&3==o.lastChild.nodeType)||(i=this.document.createTextNode(a),this.insertNode(i),l(this.document,i),u(i,"previousSibling"),u(i,"nextSibling"),t=i,this.setStart(i,browser.webkit?1:0).collapse(!0))}var c=this.document.createRange();if(this.collapsed&&browser.opera&&1==this.startContainer.nodeType){d=this.startContainer.childNodes[this.startOffset];if(d){while(d&&domUtils.isBlockElm(d)){if(1!=d.nodeType||!d.childNodes[0])break;d=d.childNodes[0]}d&&this.setStartBefore(d).collapse(!0)}else d=this.startContainer.lastChild,d&&domUtils.isBr(d)&&this.setStartBefore(d).collapse(!0)}n(this),c.setStart(this.startContainer,this.startOffset),c.setEnd(this.endContainer,this.endOffset),s.addRange(c)}return this},scrollToView:function(t,e){t=t?window:domUtils.getWindow(this.document);var a=this,n=a.document.createElement("span");return n.innerHTML="&nbsp;",a.cloneRange().insertNode(n),domUtils.scrollToView(n,t,e),domUtils.remove(n),a},inFillChar:function(){var t=this.startContainer;return!(!this.collapsed||3!=t.nodeType||t.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1!=t.nodeValue.length)},createAddress:function(t,e){var a={},n=this;function i(t){for(var a,i=t?n.startContainer:n.endContainer,r=domUtils.findParents(i,!0,(function(t){return!domUtils.isBody(t)})),s=[],o=0;a=r[o++];)s.push(domUtils.getNodeIndex(a,e));var l=0;if(e)if(3==i.nodeType){var u=i.previousSibling;while(u&&3==u.nodeType)l+=u.nodeValue.replace(fillCharReg,"").length,u=u.previousSibling;l+=t?n.startOffset:n.endOffset}else if(i=i.childNodes[t?n.startOffset:n.endOffset],i)l=domUtils.getNodeIndex(i,e);else{i=t?n.startContainer:n.endContainer;var d=i.firstChild;while(d)if(domUtils.isFillChar(d))d=d.nextSibling;else if(l++,3==d.nodeType)while(d&&3==d.nodeType)d=d.nextSibling;else d=d.nextSibling}else l=t?domUtils.isFillChar(i)?0:n.startOffset:n.endOffset;return l<0&&(l=0),s.push(l),s}return a.startAddress=i(!0),t||(a.endAddress=n.collapsed?[].concat(a.startAddress):i()),a},moveToAddress:function(t,e){var a=this;function n(t,e){for(var n,i,r,s=a.document.body,o=0,l=t.length;o<l;o++)if(r=t[o],n=s,s=s.childNodes[r],!s){i=r;break}e?s?a.setStartBefore(s):a.setStart(n,i):s?a.setEndBefore(s):a.setEnd(n,i)}return n(t.startAddress,!0),!e&&t.endAddress&&n(t.endAddress),a},equals:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e]!==t[e])return!1;return!0},traversal:function(t,e){if(this.collapsed)return this;var a=this.createBookmark(),n=a.end,i=domUtils.getNextDomNode(a.start,!1,e);while(i&&i!==n&&domUtils.getPosition(i,n)&domUtils.POSITION_PRECEDING){var r=domUtils.getNextDomNode(i,!1,e);t(i),i=r}return this.moveToBookmark(a)}}})(),function(){function t(t,e){var a=domUtils.getNodeIndex;t=t.duplicate(),t.collapse(e);var n=t.parentElement();if(!n.hasChildNodes())return{container:n,offset:0};var i,r,s=n.children,o=t.duplicate(),l=0,u=s.length-1,d=-1;while(l<=u){d=Math.floor((l+u)/2),i=s[d],o.moveToElementText(i);var c=o.compareEndPoints("StartToStart",t);if(c>0)u=d-1;else{if(!(c<0))return{container:n,offset:a(i)};l=d+1}}if(-1==d){if(o.moveToElementText(n),o.setEndPoint("StartToStart",t),r=o.text.replace(/(\r\n|\r)/g,"\n").length,s=n.childNodes,!r)return i=s[s.length-1],{container:i,offset:i.nodeValue.length};var p=s.length;while(r>0)r-=s[--p].nodeValue.length;return{container:s[p],offset:-r}}if(o.collapse(c>0),o.setEndPoint(c>0?"StartToStart":"EndToStart",t),r=o.text.replace(/(\r\n|\r)/g,"\n").length,!r)return dtd.$empty[i.tagName]||dtd.$nonChild[i.tagName]?{container:n,offset:a(i)+(c>0?0:1)}:{container:i,offset:c>0?0:i.childNodes.length};while(r>0)try{var h=i;i=i[c>0?"previousSibling":"nextSibling"],r-=i.nodeValue.length}catch(g){return{container:n,offset:a(h)}}return{container:i,offset:c>0?-r:i.nodeValue.length+r}}function e(e,a){if(e.item)a.selectNode(e.item(0));else{var n=t(e,!0);a.setStart(n.container,n.offset),0!=e.compareEndPoints("StartToEnd",e)&&(n=t(e,!1),a.setEnd(n.container,n.offset))}return a}function a(t){var e;try{e=t.getNative().createRange()}catch(n){return null}var a=e.item?e.item(0):e.parentElement();return(a.ownerDocument||a)===t.document?e:null}var n=dom.Selection=function(t){var e,n=this;n.document=t,browser.ie9below&&(e=domUtils.getWindow(t).frameElement,domUtils.on(e,"beforedeactivate",(function(){n._bakIERange=n.getIERange()})),domUtils.on(e,"activate",(function(){try{!a(n)&&n._bakIERange&&n._bakIERange.select()}catch(t){}n._bakIERange=null}))),e=t=null};n.prototype={rangeInBody:function(t,e){var a=browser.ie9below||e?t.item?t.item():t.parentElement():t.startContainer;return a===this.document.body||domUtils.inDoc(a,this.document)},getNative:function(){var t=this.document;try{return t?browser.ie9below?t.selection:domUtils.getWindow(t).getSelection():null}catch(e){return null}},getIERange:function(){var t=a(this);return!t&&this._bakIERange?this._bakIERange:t},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var t=this.getStart();return t?domUtils.findParents(t,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(browser.ie9below){var t=a(this);return!(!t||!this.rangeInBody(t))}return!!this.getNative().rangeCount}catch(e){return!1}},getRange:function(){var t=this;function a(e){var a=t.document.body.firstChild,n=e.collapsed;while(a&&a.firstChild)e.setStart(a,0),a=a.firstChild;e.startContainer||e.setStart(t.document.body,0),n&&e.collapse(!0)}if(null!=t._cachedRange)return this._cachedRange;var n=new baidu.editor.dom.Range(t.document);if(browser.ie9below){var i=t.getIERange();if(i)try{e(i,n)}catch(l){a(n)}else a(n)}else{var r=t.getNative();if(r&&r.rangeCount){var s=r.getRangeAt(0),o=r.getRangeAt(r.rangeCount-1);n.setStart(s.startContainer,s.startOffset).setEnd(o.endContainer,o.endOffset),n.collapsed&&domUtils.isBody(n.startContainer)&&!n.startOffset&&a(n)}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;a(n)}}return this._bakRange=n},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var t,e,a,n,i=browser.ie9below?this.getIERange():this.getRange();if(browser.ie9below){if(!i)return this.document.body.firstChild;if(i.item)return i.item(0);t=i.duplicate(),t.text.length>0&&t.moveStart("character",1),t.collapse(1),e=t.parentElement(),n=a=i.parentElement();while(a=a.parentNode)if(a==e){e=n;break}}else if(i.shrinkBoundary(),e=i.startContainer,1==e.nodeType&&e.hasChildNodes()&&(e=e.childNodes[Math.min(e.childNodes.length-1,i.startOffset)]),3==e.nodeType)return e.parentNode;return e},getText:function(){var t,e;return this.isFocus()&&(t=this.getNative())?(e=browser.ie9below?t.createRange():t.getRangeAt(0),browser.ie9below?e.text:e.toString()):""},clearRange:function(){this.getNative()[browser.ie9below?"empty":"removeAllRanges"]()}}}(),function(){var t,e=0;function a(t,e){var a;if(e.textarea)if(utils.isString(e.textarea)){for(var n,i=0,r=domUtils.getElementsByTagName(t,"textarea");n=r[i++];)if(n.id=="ueditor_textarea_"+e.options.textarea){a=n;break}}else a=e.textarea;a||(t.appendChild(a=domUtils.createElement(document,"textarea",{name:e.options.textarea,id:"ueditor_textarea_"+e.options.textarea,style:"display:none"})),e.textarea=a),!a.getAttribute("name")&&a.setAttribute("name",e.options.textarea),a.value=e.hasContents()?e.options.allHtmlEnabled?e.getAllHtml():e.getContent(null,null,!0):""}function n(t){for(var e in t)return e}function i(t){t.langIsReady=!0,t.fireEvent("langReady")}var r=UE.Editor=function(t){var a=this;a.uid=e++,EventBase.call(a),a.commands={},a.options=utils.extend(utils.clone(t||{}),UEDITOR_CONFIG,!0),a.shortcutkeys={},a.inputRules=[],a.outputRules=[],a.setOpt(r.defaultOptions(a)),a.loadServerConfig(),utils.isEmptyObject(UE.I18N)?utils.loadFile(document,{src:a.options.langPath+a.options.lang+"/"+a.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},(function(){UE.plugin.load(a),i(a)})):(a.options.lang=n(UE.I18N),UE.plugin.load(a),i(a)),UE.instants["ueditorInstant"+a.uid]=a};r.prototype={registerCommand:function(t,e){this.commands[t]=e},ready:function(t){var e=this;t&&(e.isReady?t.apply(e):e.addListener("ready",t))},setOpt:function(t,e){var a={};utils.isString(t)?a[t]=e:a=t,utils.extend(this.options,a,!0)},getOpt:function(t){return this.options[t]},destroy:function(){var t=this;t.fireEvent("destroy");var e=t.container.parentNode,a=t.textarea;a?a.style.display="":(a=document.createElement("textarea"),e.parentNode.insertBefore(a,e)),a.style.width=t.iframe.offsetWidth+"px",a.style.height=t.iframe.offsetHeight+"px",a.value=t.getContent(),a.id=t.key,e.innerHTML="",domUtils.remove(e);var n=t.key;for(var i in t)t.hasOwnProperty(i)&&delete this[i];UE.delEditor(n)},render:function(t){var e=this,a=e.options,n=function(e){return parseInt(domUtils.getComputedStyle(t,e))};if(utils.isString(t)&&(t=document.getElementById(t)),t){a.initialFrameWidth?a.minFrameWidth=a.initialFrameWidth:a.minFrameWidth=a.initialFrameWidth=t.offsetWidth,a.initialFrameHeight?a.minFrameHeight=a.initialFrameHeight:a.initialFrameHeight=a.minFrameHeight=t.offsetHeight,t.style.width=/%$/.test(a.initialFrameWidth)?"100%":a.initialFrameWidth-n("padding-left")-n("padding-right")+"px",t.style.height=/%$/.test(a.initialFrameHeight)?"100%":a.initialFrameHeight-n("padding-top")-n("padding-bottom")+"px",t.style.zIndex=a.zIndex;var i=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}</style>"+(a.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(a.iframeCssUrl)+"'/>":"")+(a.initialStyle?"<style>"+a.initialStyle+"</style>":"")+"</head><body class='view' ></body><script type='text/javascript' "+(ie?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+e.uid+"'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);<\/script></html>";t.appendChild(domUtils.createElement(document,"iframe",{id:"ueditor_"+e.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(a.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+i+'");document.close();}())'})),t.style.overflow="hidden",setTimeout((function(){/%$/.test(a.initialFrameWidth)&&(a.minFrameWidth=a.initialFrameWidth=t.offsetWidth),/%$/.test(a.initialFrameHeight)&&(a.minFrameHeight=a.initialFrameHeight=t.offsetHeight,t.style.height=a.initialFrameHeight+"px")}))}},_setup:function(t){var e,n=this,i=n.options;ie?(t.body.disabled=!0,t.body.contentEditable=!0,t.body.disabled=!1):t.body.contentEditable=!0,t.body.spellcheck=!1,n.document=t,n.window=t.defaultView||t.parentWindow,n.iframe=n.window.frameElement,n.body=t.body,n.selection=new dom.Selection(t),browser.gecko&&(e=this.selection.getNative())&&e.removeAllRanges(),this._initEvents();for(var r=this.iframe.parentNode;!domUtils.isBody(r);r=r.parentNode)if("FORM"==r.tagName){n.form=r,n.options.autoSyncData?domUtils.on(n.window,"blur",(function(){a(r,n)})):domUtils.on(r,"submit",(function(){a(this,n)}));break}if(i.initialContent)if(i.autoClearinitialContent){var s=n.execCommand;n.execCommand=function(){return n.fireEvent("firstBeforeExecCommand"),s.apply(n,arguments)},this._setDefaultContent(i.initialContent)}else this.setContent(i.initialContent,!1,!0);domUtils.isEmptyNode(n.body)&&(n.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"),i.focus&&setTimeout((function(){n.focus(n.options.focusInEnd),!n.options.autoClearinitialContent&&n._selectionChange()}),0),n.container||(n.container=this.iframe.parentNode),i.fullscreen&&n.ui&&n.ui.setFullScreen(!0);try{n.document.execCommand("2D-position",!1,!1)}catch(o){}try{n.document.execCommand("enableInlineTableEditing",!1,!1)}catch(o){}try{n.document.execCommand("enableObjectResizing",!1,!1)}catch(o){}n._bindshortcutKeys(),n.isReady=1,n.fireEvent("ready"),i.onready&&i.onready.call(n),browser.ie9below||domUtils.on(n.window,["blur","focus"],(function(t){if("blur"==t.type){n._bakRange=n.selection.getRange();try{n._bakNativeRange=n.selection.getNative().getRangeAt(0),n.selection.getNative().removeAllRanges()}catch(t){n._bakNativeRange=null}}else try{n._bakRange&&n._bakRange.select()}catch(t){}})),browser.gecko&&browser.version<=10902&&(n.body.contentEditable=!1,setTimeout((function(){n.body.contentEditable=!0}),100),setInterval((function(){n.body.style.height=n.iframe.offsetHeight-20+"px"}),100)),!i.isShow&&n.setHide(),i.readonly&&n.setDisabled()},sync:function(t){var e=this,n=t?document.getElementById(t):domUtils.findParent(e.iframe.parentNode,(function(t){return"FORM"==t.tagName}),!0);n&&a(n,e)},setHeight:function(t,e){t!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=t+"px"),!e&&(this.options.minFrameHeight=this.options.initialFrameHeight=t),this.body.style.height=t+"px",!e&&this.trigger("setHeight")},addshortcutkey:function(t,e){var a={};e?a[t]=e:a=t,utils.extend(this.shortcutkeys,a)},_bindshortcutKeys:function(){var t=this,e=this.shortcutkeys;t.addListener("keydown",(function(a,n){var i=n.keyCode||n.which;for(var r in e)for(var s,o=e[r].split(","),l=0;s=o[l++];){s=s.split(":");var u=s[0],d=s[1];(/^(ctrl)(\+shift)?\+(\d+)$/.test(u.toLowerCase())||/^(\d+)$/.test(u))&&("ctrl"==RegExp.$1&&(n.ctrlKey||n.metaKey)&&(""==RegExp.$2||n[RegExp.$2.slice(1)+"Key"])&&i==RegExp.$3||i==RegExp.$1)&&(-1!=t.queryCommandState(r,d)&&t.execCommand(r,d),domUtils.preventDefault(n))}}))},getContent:function(t,e,a,n,i){var r=this;if(t&&utils.isFunction(t)&&(e=t,t=""),e?!e():!this.hasContents())return"";r.fireEvent("beforegetcontent");var s=UE.htmlparser(r.body.innerHTML,n);return r.filterOutputRule(s),r.fireEvent("aftergetcontent",t,s),s.toHtml(i)},getAllHtml:function(){var t=this,e=[];if(t.fireEvent("getAllHtml",e),browser.ie&&browser.version>8){var a="";utils.each(t.document.styleSheets,(function(t){a+=t.href?'<link rel="stylesheet" type="text/css" href="'+t.href+'" />':"<style>"+t.cssText+"</style>"})),utils.each(t.document.getElementsByTagName("script"),(function(t){a+=t.outerHTML}))}return"<html><head>"+(t.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+t.options.charset+'"/>':"")+(a||t.document.getElementsByTagName("head")[0].innerHTML)+e.join("\n")+"</head><body "+(ie&&browser.version<9?'class="view"':"")+">"+t.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var t=new RegExp(domUtils.fillChar,"g"),e=this.body.innerHTML.replace(/[\n\r]/g,"");return e=e.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,(function(t,e,a){return dtd.$block[a]?"\n":e||""})),e.replace(t,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var t=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(t,"").replace(/\u00a0/g," ")},setContent:function(t,e,n){var i=this;i.fireEvent("beforesetcontent",t);var r,s=UE.htmlparser(t);function o(t){return"DIV"==t.tagName&&t.getAttribute("cdata_tag")}if(i.filterInputRule(s),t=s.toHtml(),i.body.innerHTML=(e?i.body.innerHTML:"")+t,"p"==i.options.enterTag){var l,u=this.body.firstChild;if(!u||1==u.nodeType&&(dtd.$cdata[u.tagName]||o(u)||domUtils.isCustomeNode(u))&&u===this.body.lastChild)this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else{var d=i.document.createElement("p");while(u){while(u&&(3==u.nodeType||1==u.nodeType&&dtd.p[u.tagName]&&!dtd.$cdata[u.tagName]))l=u.nextSibling,d.appendChild(u),u=l;if(d.firstChild){if(!u){i.body.appendChild(d);break}u.parentNode.insertBefore(d,u),d=i.document.createElement("p")}u=u.nextSibling}}}i.fireEvent("aftersetcontent"),i.fireEvent("contentchange"),!n&&i._selectionChange(),i._bakRange=i._bakIERange=i._bakNativeRange=null,browser.gecko&&(r=this.selection.getNative())&&r.removeAllRanges(),i.options.autoSyncData&&i.form&&a(i.form,i)},focus:function(t){try{var e=this,a=e.selection.getRange();if(t){var n=e.body.lastChild;n&&1==n.nodeType&&!dtd.$empty[n.tagName]&&(domUtils.isEmptyBlock(n)?a.setStartAtFirst(n):a.setStartAtLast(n),a.collapse(!0)),a.setCursor(!0)}else{if(!a.collapsed&&domUtils.isBody(a.startContainer)&&0==a.startOffset){n=e.body.firstChild;n&&1==n.nodeType&&!dtd.$empty[n.tagName]&&a.setStartAtFirst(n).collapse(!0)}a.select(!0)}this.fireEvent("focus selectionchange")}catch(i){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var t=this.selection.getNative();if(t.empty&&browser.ie){var e=document.body.createTextRange();e.moveToElementText(document.body),e.collapse(!0),e.select(),t.empty()}else t.removeAllRanges()},_initEvents:function(){var t=this,e=t.document,a=t.window;t._proxyDomEvent=utils.bind(t._proxyDomEvent,t),domUtils.on(e,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],t._proxyDomEvent),domUtils.on(a,["focus","blur"],t._proxyDomEvent),domUtils.on(t.body,"drop",(function(e){browser.gecko&&e.stopPropagation&&e.stopPropagation(),t.fireEvent("contentchange")})),domUtils.on(e,["mouseup","keydown"],(function(e){"keydown"==e.type&&(e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)||2!=e.button&&t._selectionChange(250,e)}))},_proxyDomEvent:function(t){return!1!==this.fireEvent("before"+t.type.replace(/^on/,"").toLowerCase())&&(!1!==this.fireEvent(t.type.replace(/^on/,""),t)&&this.fireEvent("after"+t.type.replace(/^on/,"").toLowerCase()))},_selectionChange:function(e,a){var n,i,r=this,s=!1;if(browser.ie&&browser.version<9&&a&&"mouseup"==a.type){var o=this.selection.getRange();o.collapsed||(s=!0,n=a.clientX,i=a.clientY)}clearTimeout(t),t=setTimeout((function(){if(r.selection&&r.selection.getNative()){var t,e;if(s&&"None"==r.selection.getNative().type){t=r.document.body.createTextRange();try{t.moveToPoint(n,i)}catch(o){t=null}}t&&(e=r.selection.getIERange,r.selection.getIERange=function(){return t}),r.selection.cache(),e&&(r.selection.getIERange=e),r.selection._cachedRange&&r.selection._cachedStartElement&&(r.fireEvent("beforeselectionchange"),r.fireEvent("selectionchange",!!a),r.fireEvent("afterselectionchange"),r.selection.clear())}}),e||50)},_callCmdFn:function(t,e){var a,n,i=e[0].toLowerCase();return a=this.commands[i]||UE.commands[i],n=a&&a[t],a&&n||"queryCommandState"!=t?n?n.apply(this,e):void 0:0},execCommand:function(t){t=t.toLowerCase();var e,a=this,n=a.commands[t]||UE.commands[t];return n&&n.execCommand?(n.notNeedUndo||a.__hasEnterExecCommand?(e=this._callCmdFn("execCommand",arguments),!a.__hasEnterExecCommand&&!n.ignoreContentChange&&!a._ignoreContentChange&&a.fireEvent("contentchange")):(a.__hasEnterExecCommand=!0,-1!=a.queryCommandState.apply(a,arguments)&&(a.fireEvent("saveScene"),a.fireEvent.apply(a,["beforeexeccommand",t].concat(arguments)),e=this._callCmdFn("execCommand",arguments),a.fireEvent.apply(a,["afterexeccommand",t].concat(arguments)),a.fireEvent("saveScene")),a.__hasEnterExecCommand=!1),!a.__hasEnterExecCommand&&!n.ignoreContentChange&&!a._ignoreContentChange&&a._selectionChange(),e):null},queryCommandState:function(t){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(t){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(t){if(t)for(var e,a=0;e=t[a++];)if(this.document.getElementsByTagName(e).length>0)return!0;if(!domUtils.isEmptyBlock(this.body))return!0;for(t=["div"],a=0;e=t[a++];)for(var n,i=domUtils.getElementsByTagName(this.document,e),r=0;n=i[r++];)if(domUtils.isCustomeNode(n))return!0;return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var t,e=this;if("false"==e.body.contentEditable){e.body.contentEditable=!0,t=e.selection.getRange();try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(a){t.setStartAtFirst(e.body).collapse(!0)}t.select(!0),e.bkqueryCommandState&&(e.queryCommandState=e.bkqueryCommandState,delete e.bkqueryCommandState),e.bkqueryCommandValue&&(e.queryCommandValue=e.bkqueryCommandValue,delete e.bkqueryCommandValue),e.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(t){var e=this;t=t?utils.isArray(t)?t:[t]:[],"true"==e.body.contentEditable&&(e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0)),e.body.contentEditable=!1,e.bkqueryCommandState=e.queryCommandState,e.bkqueryCommandValue=e.queryCommandValue,e.queryCommandState=function(a){return-1!=utils.indexOf(t,a)?e.bkqueryCommandState.apply(e,arguments):-1},e.queryCommandValue=function(a){return-1!=utils.indexOf(t,a)?e.bkqueryCommandValue.apply(e,arguments):null},e.fireEvent("selectionchange"))},disable:function(t){return this.setDisabled(t)},_setDefaultContent:function(){function t(){var e=this;e.document.getElementById("initContent")&&(e.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>",e.removeListener("firstBeforeExecCommand focus",t),setTimeout((function(){e.focus(),e._selectionChange()}),0))}return function(e){var a=this;a.body.innerHTML='<p id="initContent">'+e+"</p>",a.addListener("firstBeforeExecCommand focus",t)}}(),setShow:function(){var t=this,e=t.selection.getRange();if("none"==t.container.style.display){try{e.moveToBookmark(t.lastBk),delete t.lastBk}catch(a){e.setStartAtFirst(t.body).collapse(!0)}setTimeout((function(){e.select(!0)}),100),t.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var t=this;t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0)),t.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(t){var e=UE.I18N[this.options.lang];if(!e)throw Error("not import language file");t=(t||"").split(".");for(var a,n=0;a=t[n++];)if(e=e[a],!e)break;return e},getContentLength:function(t,e){var a=this.getContent(!1,!1,!0).length;if(t){e=(e||[]).concat(["hr","img","iframe"]),a=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var n,i=0;n=e[i++];)a+=this.document.getElementsByTagName(n).length}return a},addInputRule:function(t){this.inputRules.push(t)},filterInputRule:function(t){for(var e,a=0;e=this.inputRules[a++];)e.call(this,t)},addOutputRule:function(t){this.outputRules.push(t)},filterOutputRule:function(t){for(var e,a=0;e=this.outputRules[a++];)e.call(this,t)},getActionUrl:function(t){var e=this.getOpt(t)||t,a=this.getOpt("imageUrl"),n=this.getOpt("serverUrl");return!n&&a&&(n=a.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2")),n?(n=n+(-1==n.indexOf("?")?"?":"&")+"action="+(e||""),utils.formatUrl(n)):""}},utils.inherits(r,EventBase)}(),UE.Editor.defaultOptions=function(t){var e=t.options.UEDITOR_HOME_URL;return{isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:e+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:e+"lang/",theme:"default",themePath:e+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0,fileNameFormat:"{time}{rand:6}"}},function(){UE.Editor.prototype.loadServerConfig=function(){var me=this;function showErrorMsg(t){console&&console.error(t)}setTimeout((function(){try{me.options.imageUrl&&me.setOpt("serverUrl",me.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var configUrl=me.getActionUrl("config"),isJsonp=utils.isCrossDomainUrl(configUrl);me._serverConfigLoaded=!1,configUrl&&UE.ajax.request(configUrl,{method:"GET",dataType:isJsonp?"jsonp":"",onsuccess:function onsuccess(r){try{var config=isJsonp?r:eval("("+r.responseText+")");utils.extend(me.options,config),me.fireEvent("serverConfigLoaded"),me._serverConfigLoaded=!0}catch(e){showErrorMsg(me.getLang("loadconfigFormatError"))}},onerror:function(){showErrorMsg(me.getLang("loadconfigHttpError"))}})}catch(e){showErrorMsg(me.getLang("loadconfigError"))}}))},UE.Editor.prototype.isServerConfigLoaded=function(){var t=this;return t._serverConfigLoaded||!1},UE.Editor.prototype.afterConfigReady=function(t){if(t&&utils.isFunction(t)){var e=this,a=function a(){t.apply(e,arguments),e.removeListener("serverConfigLoaded",a)};e.isServerConfigLoaded()?t.call(e,"serverConfigLoaded"):e.addListener("serverConfigLoaded",a)}}}(),UE.ajax=function(){var t="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP"),t="ActiveXObject('Msxml2.XMLHTTP')"}catch(r){try{new ActiveXObject("Microsoft.XMLHTTP"),t="ActiveXObject('Microsoft.XMLHTTP')"}catch(r){}}var e=new Function("return new "+t);function a(t){var e=[];for(var a in t)if("method"!=a&&"timeout"!=a&&"async"!=a&&"dataType"!=a&&"callback"!=a&&void 0!=t[a]&&null!=t[a])if("function"!=_typeof(t[a]).toLowerCase()&&"object"!=_typeof(t[a]).toLowerCase())e.push(encodeURIComponent(a)+"="+encodeURIComponent(t[a]));else if(utils.isArray(t[a]))for(var n=0;n<t[a].length;n++)e.push(encodeURIComponent(a)+"[]="+encodeURIComponent(t[a][n]));return e.join("&")}function n(t,n){var i=e(),r=!1,s={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};if("object"===_typeof(t)&&(n=t,t=n.url),i&&t){var o=n?utils.extend(s,n):s,l=a(o);utils.isEmptyObject(o.data)||(l+=(l?"&":"")+a(o.data));var u=setTimeout((function(){4!=i.readyState&&(r=!0,i.abort(),clearTimeout(u))}),o.timeout),d=o.method.toUpperCase(),c=t+(-1==t.indexOf("?")?"?":"&")+("POST"==d?"":l+"&noCache="+ +new Date);i.open(d,c,o.async),i.onreadystatechange=function(){4==i.readyState&&(r||200!=i.status?o.onerror(i):o.onsuccess(i))},"POST"==d?(i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(l)):i.send(null)}}function i(t,e){var n,i,s,o=e.onsuccess||function(){},l=document.createElement("SCRIPT"),u=e||{},d=u["charset"],c=u["jsonp"]||"callback",p=u["timeOut"]||0,h=new RegExp("(\\?|&)"+c+"=([^&]*)");utils.isFunction(o)?(n="bd__editor__"+Math.floor(2147483648*Math.random()).toString(36),window[n]=m(0)):utils.isString(o)?n=o:(s=h.exec(t))&&(n=s[2]),t=t.replace(h,"$1"+c+"="+n),t.search(h)<0&&(t+=(t.indexOf("?")<0?"?":"&")+c+"="+n);var g=a(e);function f(t,e,a){t.setAttribute("type","text/javascript"),t.setAttribute("defer","defer"),a&&t.setAttribute("charset",a),t.setAttribute("src",e),document.getElementsByTagName("head")[0].appendChild(t)}function m(t){return function(){try{if(t)u.onerror&&u.onerror();else try{clearTimeout(i),o.apply(window,arguments)}catch(r){}}catch(e){u.onerror&&u.onerror.call(window,e)}finally{u.oncomplete&&u.oncomplete.apply(window,arguments),l.parentNode&&l.parentNode.removeChild(l),window[n]=null;try{delete window[n]}catch(r){}}}}utils.isEmptyObject(e.data)||(g+=(g?"&":"")+a(e.data)),g&&(t=t.replace(/\?/,"?"+g+"&")),l.onerror=m(1),p&&(i=setTimeout(m(1),p)),f(l,t,d)}return{request:function(t,e){e&&"jsonp"==e.dataType?i(t,e):n(t,e)},getJSONP:function(t,e,a){var n={data:e,oncomplete:a};i(t,n)}}}();var filterWord=UE.filterWord=function(){function t(t){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/gi.test(t)}function e(t){return t=t.replace(/[\d.]+\w+/g,(function(t){return utils.transUnitToPx(t)})),t}function a(t){return t.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,(function(t){if(browser.opera)return"";try{if(/Bitmap/i.test(t))return"";var a=t.match(/width:([ \d.]*p[tx])/i)[1],n=t.match(/height:([ \d.]*p[tx])/i)[1],i=t.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+e(a)+'" height="'+e(n)+'" src="'+i+'" />'}catch(r){return""}})).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,(function(t,e,a,n){return"class"==e&&"MsoListParagraph"==n?t:""})).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,(function(t,e,a){return a.replace(/[\t\r\n ]+/g," ")})).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,(function(t,a,n,i){for(var r,s=[],o=i.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,(function(t){return utils.transUnitToPx(t)})).split(/;\s*/g),l=0;r=o[l];l++){var u,d,c=r.split(":");if(2==c.length){if(u=c[0].toLowerCase(),d=c[1].toLowerCase(),/^(background)\w*/.test(u)&&0==d.replace(/(initial|\s)/g,"").length||/^(margin)\w*/.test(u)&&/^0\w+$/.test(d))continue;switch(u){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(a)||(s[l]=u.replace(/^mso-|-alt$/g,"")+":"+e(d));continue;case"horiz-align":s[l]="text-align:"+d;continue;case"vert-align":s[l]="vertical-align:"+d;continue;case"font-color":case"mso-foreground":s[l]="color:"+d;continue;case"mso-background":case"mso-highlight":s[l]="background:"+d;continue;case"mso-default-height":s[l]="min-height:"+e(d);continue;case"mso-default-width":s[l]="min-width:"+e(d);continue;case"mso-padding-between-alt":s[l]="border-collapse:separate;border-spacing:"+e(d);continue;case"text-line-through":"single"!=d&&"double"!=d||(s[l]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==d&&(s[l]="display:none");continue;case"margin":if(!/[1-9]/.test(d))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(u)||/text\-indent|padding|margin/.test(u)&&/\-[\d.]+/.test(d))continue;s[l]=u+":"+c[1]}}return a+(s.length?' style="'+s.join(";").replace(/;{2,}/g,";")+'"':"")}))}return function(e){return t(e)?a(e):e}}();(function(){var t=UE.uNode=function(t){this.type=t.type,this.data=t.data,this.tagName=t.tagName,this.parentNode=t.parentNode,this.attrs=t.attrs||{},this.children=t.children},e={href:1,src:1,_src:1,_href:1,cdata_data:1},a={style:1,script:1},n="    ",i="\n";function r(t,e,a){return t.push(i),e+(a?1:-1)}function s(t,e){for(var a=0;a<e;a++)t.push(n)}function o(t,e,a,n){switch(t.type){case"root":for(var i,c=0;i=t.children[c++];)a&&"element"==i.type&&!dtd.$inlineWithA[i.tagName]&&c>1&&(r(e,n,!0),s(e,n)),o(i,e,a,n);break;case"text":l(t,e);break;case"element":u(t,e,a,n);break;case"comment":d(t,e,a)}return e}function l(t,e){"pre"==t.parentNode.tagName?e.push(t.data):e.push(a[t.parentNode.tagName]?utils.html(t.data):t.data.replace(/[ ]{2}/g," &nbsp;"))}function u(t,a,n,i){var l="";if(t.attrs){l=[];var u=t.attrs;for(var d in u)l.push(d+(void 0!==u[d]?'="'+(e[d]?utils.html(u[d]).replace(/["]/g,(function(t){return"&quot;"})):utils.unhtml(u[d]))+'"':""));l=l.join(" ")}if(a.push("<"+t.tagName+(l?" "+l:"")+(dtd.$empty[t.tagName]?"/":"")+">"),n&&!dtd.$inlineWithA[t.tagName]&&"pre"!=t.tagName&&t.children&&t.children.length&&(i=r(a,i,!0),s(a,i)),t.children&&t.children.length)for(var c,p=0;c=t.children[p++];)n&&"element"==c.type&&!dtd.$inlineWithA[c.tagName]&&p>1&&(r(a,i),s(a,i)),o(c,a,n,i);dtd.$empty[t.tagName]||(n&&!dtd.$inlineWithA[t.tagName]&&"pre"!=t.tagName&&t.children&&t.children.length&&(i=r(a,i),s(a,i)),a.push("</"+t.tagName+">"))}function d(t,e){e.push("\x3c!--"+t.data+"--\x3e")}function c(t,e){var a;if("element"==t.type&&t.getAttr("id")==e)return t;if(t.children&&t.children.length)for(var n,i=0;n=t.children[i++];)if(a=c(n,e))return a}function p(t,e,a){if("element"==t.type&&t.tagName==e&&a.push(t),t.children&&t.children.length)for(var n,i=0;n=t.children[i++];)p(n,e,a)}function h(t,e){if(t.children&&t.children.length)for(var a,n=0;a=t.children[n];)h(a,e),a.parentNode&&(a.children&&a.children.length&&e(a),a.parentNode&&n++);else e(t)}t.createElement=function(e){return/[<>]/.test(e)?UE.htmlparser(e).children[0]:new t({type:"element",children:[],tagName:e})},t.createText=function(t,e){return new UE.uNode({type:"text",data:e?t:utils.unhtml(t||"")})},t.prototype={toHtml:function(t){var e=[];return o(this,e,t,0),e.join("")},innerHTML:function(t){if("element"!=this.type||dtd.$empty[this.tagName])return this;if(utils.isString(t)){if(this.children)for(var e=0;a=this.children[e++];)a.parentNode=null;this.children=[];var a,n=UE.htmlparser(t);for(e=0;a=n.children[e++];)this.children.push(a),a.parentNode=this;return this}n=new UE.uNode({type:"root",children:this.children});return n.toHtml()},innerText:function(e,a){if("element"!=this.type||dtd.$empty[this.tagName])return this;if(e){if(this.children)for(var n,i=0;n=this.children[i++];)n.parentNode=null;return this.children=[],this.appendChild(t.createText(e,a)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return"element"==this.type?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var t,e=this.parentNode,a=0;t=e.children[a];a++)if(t===this)return 0==a?null:e.children[a-1]},nextSibling:function(){for(var t,e=this.parentNode,a=0;t=e.children[a++];)if(t===this)return e.children[a]},replaceChild:function(t,e){if(this.children){t.parentNode&&t.parentNode.removeChild(t);for(var a,n=0;a=this.children[n];n++)if(a===e)return this.children.splice(n,1,t),e.parentNode=null,t.parentNode=this,t}},appendChild:function(t){if("root"==this.type||"element"==this.type&&!dtd.$empty[this.tagName]){this.children||(this.children=[]),t.parentNode&&t.parentNode.removeChild(t);for(var e,a=0;e=this.children[a];a++)if(e===t){this.children.splice(a,1);break}return this.children.push(t),t.parentNode=this,t}},insertBefore:function(t,e){if(this.children){t.parentNode&&t.parentNode.removeChild(t);for(var a,n=0;a=this.children[n];n++)if(a===e)return this.children.splice(n,0,t),t.parentNode=this,t}},insertAfter:function(t,e){if(this.children){t.parentNode&&t.parentNode.removeChild(t);for(var a,n=0;a=this.children[n];n++)if(a===e)return this.children.splice(n+1,0,t),t.parentNode=this,t}},removeChild:function(t,e){if(this.children)for(var a,n=0;a=this.children[n];n++)if(a===t){if(this.children.splice(n,1),a.parentNode=null,e&&a.children&&a.children.length)for(var i,r=0;i=a.children[r];r++)this.children.splice(n+r,0,i),i.parentNode=this;return a}},getAttr:function(t){return this.attrs&&this.attrs[t.toLowerCase()]},setAttr:function(t,e){if(t)if(this.attrs||(this.attrs={}),utils.isObject(t))for(var a in t)t[a]?this.attrs[a.toLowerCase()]=t[a]:delete this.attrs[a];else e?this.attrs[t.toLowerCase()]=e:delete this.attrs[t];else delete this.attrs},getIndex:function(){for(var t,e=this.parentNode,a=0;t=e.children[a];a++)if(t===this)return a;return-1},getNodeById:function(t){var e;if(this.children&&this.children.length)for(var a,n=0;a=this.children[n++];)if(e=c(a,t))return e},getNodesByTagName:function(t){t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");var e=[],a=this;return utils.each(t,(function(t){if(a.children&&a.children.length)for(var n,i=0;n=a.children[i++];)p(n,t,e)})),e},getStyle:function(t){var e=this.getAttr("style");if(!e)return"";var a=new RegExp("(^|;)\\s*"+t+":([^;]+)","i"),n=e.match(a);return n&&n[0]?n[2]:""},setStyle:function(t,e){function a(t,e){var a=new RegExp("(^|;)\\s*"+t+":([^;]+;?)","gi");n=n.replace(a,"$1"),e&&(n=t+":"+utils.unhtml(e)+";"+n)}var n=this.getAttr("style");if(n||(n=""),utils.isObject(t))for(var i in t)a(i,t[i]);else a(t,e);this.setAttr("style",utils.trim(n))},traversal:function(t){return this.children&&this.children.length&&h(this,t),this}}})();var htmlparser=UE.htmlparser=function(t,e){var a=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,n=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,i={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};t=t.replace(new RegExp(domUtils.fillChar,"g"),""),e||(t=t.replace(new RegExp("[\\r\\t\\n"+(e?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(e?"":" ")+"]*","g"),(function(t,a){return a&&i[a.toLowerCase()]?t.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):t.replace(new RegExp("^[\\r\\n"+(e?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(e?"":" ")+"]+$"),"")})));var r={href:1,src:1},s=UE.uNode,o={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},l={ol:"li",ul:"li"};function u(t,e){if(l[t.tagName]){var a=s.createElement(l[t.tagName]);t.appendChild(a),a.appendChild(s.createText(e)),t=a}else t.appendChild(s.createText(e))}function d(t,e,a){var i;if(i=o[e]){var l,u=t;while("root"!=u.type){if(utils.isArray(i)?-1!=utils.indexOf(i,u.tagName):i==u.tagName){t=u,l=!0;break}u=u.parentNode}l||(t=d(t,utils.isArray(i)?i[0]:i))}var c=new s({parentNode:t,type:"element",tagName:e.toLowerCase(),children:dtd.$empty[e]?null:[]});if(a){var p,h={};while(p=n.exec(a))h[p[1].toLowerCase()]=r[p[1].toLowerCase()]?p[2]||p[3]||p[4]:utils.unhtml(p[2]||p[3]||p[4]);c.attrs=h}return t.children.push(c),dtd.$empty[e]?t:c}function c(t,e){t.children.push(new s({type:"comment",data:e,parentNode:t}))}var p,h=0,g=0,f=new s({type:"root",children:[]}),m=f;while(p=a.exec(t)){h=p.index;try{if(h>g&&u(m,t.slice(g,h)),p[3])dtd.$cdata[m.tagName]?u(m,p[0]):m=d(m,p[3].toLowerCase(),p[4]);else if(p[1]){if("root"!=m.type)if(dtd.$cdata[m.tagName]&&!dtd.$cdata[p[1]])u(m,p[0]);else{var v=m;while("element"==m.type&&m.tagName!=p[1].toLowerCase())if(m=m.parentNode,"root"==m.type)throw m=v,"break";m=m.parentNode}}else p[2]&&c(m,p[2])}catch(b){}g=a.lastIndex}return g<t.length&&u(m,t.slice(g)),f},filterNode=UE.filterNode=function(){function t(e,a){switch(e.type){case"text":break;case"element":var n;if(n=a[e.tagName])if("-"===n)e.parentNode.removeChild(e);else if(utils.isFunction(n)){var i=e.parentNode,r=e.getIndex();if(n(e),e.parentNode){if(e.children)for(var s=0;p=e.children[s];)t(p,a),p.parentNode&&s++}else for(s=r;p=i.children[s];)t(p,a),p.parentNode&&s++}else{var o=n["$"];if(o&&e.attrs){var l,u={};for(var d in o){if(l=e.getAttr(d),"style"==d&&utils.isArray(o[d])){var c=[];utils.each(o[d],(function(t){var a;(a=e.getStyle(t))&&c.push(t+":"+a)})),l=c.join(";")}l&&(u[d]=l)}e.attrs=u}if(e.children)for(s=0;p=e.children[s];)t(p,a),p.parentNode&&s++}else if(dtd.$cdata[e.tagName])e.parentNode.removeChild(e);else{i=e.parentNode,r=e.getIndex();e.parentNode.removeChild(e,!0);var p;for(s=r;p=i.children[s];)t(p,a),p.parentNode&&s++}break;case"comment":e.parentNode.removeChild(e)}}return function(e,a){if(utils.isEmptyObject(a))return e;var n;(n=a["-"])&&utils.each(n.split(" "),(function(t){a[t]="-"}));for(var i,r=0;i=e.children[r];)t(i,a),i.parentNode&&r++;return e}}();UE.plugin=function(){var t={};return{register:function(e,a,n,i){n&&utils.isFunction(n)&&(i=n,n=null),t[e]={optionName:n||e,execFn:a,afterDisabled:i}},load:function(e){utils.each(t,(function(t){var a=t.execFn.call(e);!1!==e.options[t.optionName]?a&&utils.each(a,(function(t,a){switch(a.toLowerCase()){case"shortcutkey":e.addshortcutkey(t);break;case"bindevents":utils.each(t,(function(t,a){e.addListener(a,t)}));break;case"bindmultievents":utils.each(utils.isArray(t)?t:[t],(function(t){var a=utils.trim(t.type).split(/\s+/);utils.each(a,(function(a){e.addListener(a,t.handler)}))}));break;case"commands":utils.each(t,(function(t,a){e.commands[a]=t}));break;case"outputrule":e.addOutputRule(t);break;case"inputrule":e.addInputRule(t);break;case"defaultoptions":e.setOpt(t)}})):t.afterDisabled&&t.afterDisabled.call(e)})),utils.each(UE.plugins,(function(t){t.call(e)}))},run:function(e,a){var n=t[e];n&&n.exeFn.call(a)}}}();var keymap=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78},LocalStorage=UE.LocalStorage=function(){var t=window.localStorage||a()||null,e="localStorage";return{saveLocalData:function(e,a){return!(!t||!a)&&(t.setItem(e,a),!0)},getLocalData:function(e){return t?t.getItem(e):null},removeItem:function(e){t&&t.removeItem(e)}};function a(){var t=document.createElement("div");return t.style.display="none",t.addBehavior?(t.addBehavior("#default#userdata"),{getItem:function(a){var n=null;try{document.body.appendChild(t),t.load(e),n=t.getAttribute(a),document.body.removeChild(t)}catch(i){}return n},setItem:function(a,n){document.body.appendChild(t),t.setAttribute(a,n),t.save(e),document.body.removeChild(t)},removeItem:function(a){document.body.appendChild(t),t.removeAttribute(a),t.save(e),document.body.removeChild(t)}}):null}}();(function(){var t="ueditor_preference";UE.Editor.prototype.setPreferences=function(e,a){var n={};utils.isString(e)?n[e]=a:n=e;var i=LocalStorage.getLocalData(t);i&&(i=utils.str2json(i))?utils.extend(i,n):i=n,i&&LocalStorage.saveLocalData(t,utils.json2str(i))},UE.Editor.prototype.getPreferences=function(e){var a=LocalStorage.getLocalData(t);return a&&(a=utils.str2json(a))?e?a[e]:a:null},UE.Editor.prototype.removePreferences=function(e){var a=LocalStorage.getLocalData(t);a&&(a=utils.str2json(a))&&(a[e]=void 0,delete a[e]),a&&LocalStorage.saveLocalData(t,utils.json2str(a))}})(),UE.plugins["defaultfilter"]=function(){var t=this;t.setOpt({allowDivTransToP:!0,disabledTableInTable:!0}),t.addInputRule((function(e){var a,n=this.options.allowDivTransToP;function i(t){while(t&&"element"==t.type){if("td"==t.tagName)return!0;t=t.parentNode}return!1}e.traversal((function(e){if("element"==e.type){if(!dtd.$cdata[e.tagName]&&t.options.autoClearEmptyNode&&dtd.$inline[e.tagName]&&!dtd.$empty[e.tagName]&&(!e.attrs||utils.isEmptyObject(e.attrs)))return void(e.firstChild()?"span"!=e.tagName||e.attrs&&!utils.isEmptyObject(e.attrs)||e.parentNode.removeChild(e,!0):e.parentNode.removeChild(e));switch(e.tagName){case"style":case"script":e.setAttr({cdata_tag:e.tagName,cdata_data:e.innerHTML()||"",_ue_custom_node_:"true"}),e.tagName="div",e.innerHTML("");break;case"a":(a=e.getAttr("href"))&&e.setAttr("_href",a);break;case"img":if((a=e.getAttr("src"))&&/^data:/.test(a)){e.parentNode.removeChild(e);break}e.setAttr("_src",e.getAttr("src"));break;case"span":browser.webkit&&(a=e.getStyle("white-space"))&&/nowrap|normal/.test(a)&&(e.setStyle("white-space",""),t.options.autoClearEmptyNode&&utils.isEmptyObject(e.attrs)&&e.parentNode.removeChild(e,!0)),a=e.getAttr("id"),a&&/^_baidu_bookmark_/i.test(a)&&e.parentNode.removeChild(e);break;case"p":(a=e.getAttr("align"))&&(e.setAttr("align"),e.setStyle("text-align",a)),utils.each(e.children,(function(t){if("element"==t.type&&"p"==t.tagName){var a=t.nextSibling();e.parentNode.insertAfter(t,e);var n=t;while(a){var i=a.nextSibling();e.parentNode.insertAfter(a,n),n=a,a=i}return!1}})),e.firstChild()||e.innerHTML(browser.ie?"&nbsp;":"<br/>");break;case"div":if(e.getAttr("cdata_tag"))break;if(a=e.getAttr("class"),a&&/^line number\d+/.test(a))break;if(!n)break;var r,s=UE.uNode.createElement("p");while(r=e.firstChild())"text"!=r.type&&UE.dom.dtd.$block[r.tagName]?s.firstChild()?(e.parentNode.insertBefore(s,e),s=UE.uNode.createElement("p")):e.parentNode.insertBefore(r,e):s.appendChild(r);s.firstChild()&&e.parentNode.insertBefore(s,e),e.parentNode.removeChild(e);break;case"dl":e.tagName="ul";break;case"dt":case"dd":e.tagName="li";break;case"li":var o=e.getAttr("class");o&&/list\-/.test(o)||e.setAttr();var l=e.getNodesByTagName("ol ul");UE.utils.each(l,(function(t){e.parentNode.insertAfter(t,e)}));break;case"td":case"th":case"caption":e.children&&e.children.length||e.appendChild(browser.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"));break;case"table":t.options.disabledTableInTable&&i(e)&&(e.parentNode.insertBefore(UE.uNode.createText(e.innerText()),e),e.parentNode.removeChild(e))}}}))})),t.addOutputRule((function(e){var a;e.traversal((function(e){if("element"==e.type){if(t.options.autoClearEmptyNode&&dtd.$inline[e.tagName]&&!dtd.$empty[e.tagName]&&(!e.attrs||utils.isEmptyObject(e.attrs)))return void(e.firstChild()?"span"!=e.tagName||e.attrs&&!utils.isEmptyObject(e.attrs)||e.parentNode.removeChild(e,!0):e.parentNode.removeChild(e));switch(e.tagName){case"div":(a=e.getAttr("cdata_tag"))&&(e.tagName=a,e.appendChild(UE.uNode.createText(e.getAttr("cdata_data"))),e.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""}));break;case"a":(a=e.getAttr("_href"))&&e.setAttr({href:utils.html(a),_href:""});break;case"span":a=e.getAttr("id"),a&&/^_baidu_bookmark_/i.test(a)&&e.parentNode.removeChild(e);break;case"img":(a=e.getAttr("_src"))&&e.setAttr({src:e.getAttr("_src"),_src:""})}}}))}))},UE.commands["inserthtml"]={execCommand:function(t,e,a){var n,i,r=this;if(e&&!0!==r.fireEvent("beforeinserthtml",e)){if(n=r.selection.getRange(),i=n.document.createElement("div"),i.style.display="inline",!a){var s=UE.htmlparser(e);r.options.filterRules&&UE.filterNode(s,r.options.filterRules),r.filterInputRule(s),e=s.toHtml()}if(i.innerHTML=utils.trim(e),!n.collapsed){var o=n.startContainer;if(domUtils.isFillChar(o)&&n.setStartBefore(o),o=n.endContainer,domUtils.isFillChar(o)&&n.setEndAfter(o),n.txtToElmBoundary(),n.endContainer&&1==n.endContainer.nodeType&&(o=n.endContainer.childNodes[n.endOffset],o&&domUtils.isBr(o)&&n.setEndAfter(o)),0==n.startOffset&&(o=n.startContainer,domUtils.isBoundaryNode(o,"firstChild")&&(o=n.endContainer,n.endOffset==(3==o.nodeType?o.nodeValue.length:o.childNodes.length)&&domUtils.isBoundaryNode(o,"lastChild")&&(r.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",n.setStart(r.body.firstChild,0).collapse(!0)))),!n.collapsed&&n.deleteContents(),1==n.startContainer.nodeType){var l=n.startContainer.childNodes[n.startOffset];if(l&&domUtils.isBlockElm(l)&&(v=l.previousSibling)&&domUtils.isBlockElm(v)){n.setEnd(v,v.childNodes.length).collapse();while(l.firstChild)v.appendChild(l.firstChild);domUtils.remove(l)}}}var u,d,c,p=0;n.inFillChar()&&(l=n.startContainer,domUtils.isFillChar(l)?(n.setStartBefore(l).collapse(!0),domUtils.remove(l)):domUtils.isFillChar(l,!0)&&(l.nodeValue=l.nodeValue.replace(fillCharReg,""),n.startOffset--,n.collapsed&&n.collapse(!0)));var h=domUtils.findParentByTagName(n.startContainer,"li",!0);if(h){var g;while(l=i.firstChild){while(l&&(3==l.nodeType||!domUtils.isBlockElm(l)||"HR"==l.tagName))b=l.nextSibling,n.insertNode(l).collapse(),g=l,l=b;if(l)if(/^(ol|ul)$/i.test(l.tagName)){while(l.firstChild)g=l.firstChild,domUtils.insertAfter(h,l.firstChild),h=h.nextSibling;domUtils.remove(l)}else{var f;b=l.nextSibling,f=r.document.createElement("li"),domUtils.insertAfter(h,f),f.appendChild(l),g=l,l=b,h=f}}h=domUtils.findParentByTagName(n.startContainer,"li",!0),domUtils.isEmptyBlock(h)&&domUtils.remove(h),g&&n.setStartAfter(g).collapse(!0).select(!0)}else{while(l=i.firstChild){if(p){var m=r.document.createElement("p");while(l&&(3==l.nodeType||!dtd.$block[l.tagName]))c=l.nextSibling,m.appendChild(l),l=c;m.firstChild&&(l=m)}if(n.insertNode(l),c=l.nextSibling,!p&&l.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(l)&&(u=domUtils.findParent(l,(function(t){return domUtils.isBlockElm(t)})),u&&"body"!=u.tagName.toLowerCase()&&(!dtd[u.tagName][l.nodeName]||l.parentNode!==u))){if(dtd[u.tagName][l.nodeName]){d=l.parentNode;while(d!==u)v=d,d=d.parentNode}else v=u;domUtils.breakParent(l,v||d);var v=l.previousSibling;domUtils.trimWhiteTextNode(v),v.childNodes.length||domUtils.remove(v),!browser.ie&&(b=l.nextSibling)&&domUtils.isBlockElm(b)&&b.lastChild&&!domUtils.isBr(b.lastChild)&&b.appendChild(r.document.createElement("br")),p=1}var b=l.nextSibling;if(!i.firstChild&&b&&domUtils.isBlockElm(b)){n.setStart(b,0).collapse(!0);break}n.setEndAfter(l).collapse()}if(l=n.startContainer,c&&domUtils.isBr(c)&&domUtils.remove(c),domUtils.isBlockElm(l)&&domUtils.isEmptyNode(l))if(c=l.nextSibling)domUtils.remove(l),1==c.nodeType&&dtd.$block[c.tagName]&&n.setStart(c,0).collapse(!0).shrinkBoundary();else try{l.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}catch(y){n.setStartBefore(l),domUtils.remove(l)}try{n.select(!0)}catch(y){}}setTimeout((function(){n=r.selection.getRange(),n.scrollToView(r.autoHeightEnabled,r.autoHeightEnabled?domUtils.getXY(r.iframe).y:0),r.fireEvent("afterinserthtml",e)}),200)}}},UE.plugins["autotypeset"]=function(){this.setOpt({autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:utils.extend({div:1},dtd.$removeEmpty),indent:!1,indentValue:"2em",bdc2sb:!1,tobdc:!1}});var t,e=this,a=e.options.autotypeset,n={selectTdClass:1,pagebreak:1,anchorclass:1},i={li:1},r={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1};function s(e,a){return e&&3!=e.nodeType?domUtils.isBr(e)?1:e&&e.parentNode&&r[e.tagName.toLowerCase()]?t&&t.contains(e)||e.getAttribute("pagebreak")?0:a?!domUtils.isEmptyBlock(e):domUtils.isEmptyBlock(e,new RegExp("[\\s"+domUtils.fillChar+"]","g")):void 0:0}function o(t){t.style.cssText||(domUtils.removeAttributes(t,["style"]),"span"==t.tagName.toLowerCase()&&domUtils.hasNoAttributes(t)&&domUtils.remove(t,!0))}function l(e,r){var l,c=this;if(r){if(!a.pasteFilter)return;l=c.document.createElement("div"),l.innerHTML=r.html}else l=c.document.body;for(var p,h=domUtils.getElementsByTagName(l,"*"),g=0;p=h[g++];)if(!0!==c.fireEvent("excludeNodeinautotype",p)){if(a.clearFontSize&&p.style.fontSize&&(domUtils.removeStyle(p,"font-size"),o(p)),a.clearFontFamily&&p.style.fontFamily&&(domUtils.removeStyle(p,"font-family"),o(p)),s(p)){if(a.mergeEmptyline){var f=p.nextSibling,m=domUtils.isBr(p);while(s(f)){if(b=f,f=b.nextSibling,m&&(!f||f&&!domUtils.isBr(f)))break;domUtils.remove(b)}}if(a.removeEmptyline&&domUtils.inDoc(p,l)&&!i[p.parentNode.tagName.toLowerCase()]){if(domUtils.isBr(p)&&(f=p.nextSibling,f&&!domUtils.isBr(f)))continue;domUtils.remove(p);continue}}if(s(p,!0)&&"SPAN"!=p.tagName&&(a.indent&&(p.style.textIndent=a.indentValue),a.textAlign&&(p.style.textAlign=a.textAlign)),a.removeClass&&p.className&&!n[p.className.toLowerCase()]){if(t&&t.contains(p))continue;domUtils.removeAttributes(p,["class"])}if(a.imageBlockLine&&"img"==p.tagName.toLowerCase()&&!p.getAttribute("emotion"))if(r){var v=p;switch(a.imageBlockLine){case"left":case"right":case"none":var b,y,_=v.parentNode;while(dtd.$inline[_.tagName]||"A"==_.tagName)_=_.parentNode;if(b=_,"P"==b.tagName&&"center"==domUtils.getStyle(b,"text-align")&&!domUtils.isBody(b)&&1==domUtils.getChildCount(b,(function(t){return!domUtils.isBr(t)&&!domUtils.isWhitespace(t)})))if(y=b.previousSibling,f=b.nextSibling,y&&f&&1==y.nodeType&&1==f.nodeType&&y.tagName==f.tagName&&domUtils.isBlockElm(y)){y.appendChild(b.firstChild);while(f.firstChild)y.appendChild(f.firstChild);domUtils.remove(b),domUtils.remove(f)}else domUtils.setStyle(b,"text-align","");domUtils.setStyle(v,"float",a.imageBlockLine);break;case"center":if("center"!=c.queryCommandValue("imagefloat")){_=v.parentNode,domUtils.setStyle(v,"float","none"),b=v;while(_&&1==domUtils.getChildCount(_,(function(t){return!domUtils.isBr(t)&&!domUtils.isWhitespace(t)}))&&(dtd.$inline[_.tagName]||"A"==_.tagName))b=_,_=_.parentNode;var D=c.document.createElement("p");domUtils.setAttributes(D,{style:"text-align:center"}),b.parentNode.insertBefore(D,b),D.appendChild(b),domUtils.setStyle(b,"float","")}}}else{var C=c.selection.getRange();C.selectNode(p).select(),c.execCommand("imagefloat",a.imageBlockLine)}a.removeEmptyNode&&a.removeTagNames[p.tagName.toLowerCase()]&&domUtils.hasNoAttributes(p)&&domUtils.isEmptyBlock(p)&&domUtils.remove(p)}if(a.tobdc){var w=UE.htmlparser(l.innerHTML);w.traversal((function(t){"text"==t.type&&(t.data=d(t.data))})),l.innerHTML=w.toHtml()}if(a.bdc2sb){w=UE.htmlparser(l.innerHTML);w.traversal((function(t){"text"==t.type&&(t.data=u(t.data))})),l.innerHTML=w.toHtml()}r&&(r.html=l.innerHTML)}function u(t){for(var e="",a=0;a<t.length;a++){var n=t.charCodeAt(a);e+=n>=65281&&n<=65373?String.fromCharCode(t.charCodeAt(a)-65248):12288==n?String.fromCharCode(t.charCodeAt(a)-12288+32):t.charAt(a)}return e}function d(t){t=utils.html(t);for(var e="",a=0;a<t.length;a++)32==t.charCodeAt(a)?e+=String.fromCharCode(12288):t.charCodeAt(a)<127?e+=String.fromCharCode(t.charCodeAt(a)+65248):e+=t.charAt(a);return e}function c(){var t=e.getPreferences("autotypeset");utils.extend(e.options.autotypeset,t)}a&&(c(),a.pasteFilter&&e.addListener("beforepaste",l),e.commands["autotypeset"]={execCommand:function(){e.removeListener("beforepaste",l),a.pasteFilter&&e.addListener("beforepaste",l),l.call(e)}})},UE.plugin.register("autosubmit",(function(){return{shortcutkey:{autosubmit:"ctrl+13"},commands:{autosubmit:{execCommand:function(){var t=this,e=domUtils.findParentByTagName(t.iframe,"form",!1);if(e){if(!1===t.fireEvent("beforesubmit"))return;t.sync(),e.submit()}}}}}})),UE.plugin.register("background",(function(){var t,e=this,a="editor_background",n=new RegExp("body[\\s]*\\{(.+)\\}","i");function i(t){var e={},a=t.split(";");return utils.each(a,(function(t){var a=t.indexOf(":"),n=utils.trim(t.substr(0,a)).toLowerCase();n&&(e[n]=utils.trim(t.substr(a+1)||""))})),e}function r(t){if(t){var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(i+":"+t[i]+"; ");utils.cssRule(a,n.length?"body{"+n.join("")+"}":"",e.document)}else utils.cssRule(a,"",e.document)}var s=e.hasContents;return e.hasContents=function(){return!!e.queryCommandValue("background")||s.apply(e,arguments)},{bindEvents:{getAllHtml:function(t,a){var n=this.body,i=domUtils.getComputedStyle(n,"background-image"),r="";r=i.indexOf(e.options.imagePath)>0?i.substring(i.indexOf(e.options.imagePath),i.length-1).replace(/"|\(|\)/gi,""):"none"!=i?i.replace(/url\("?|"?\)/gi,""):"";var s='<style type="text/css">body{',o={"background-color":domUtils.getComputedStyle(n,"background-color")||"#ffffff","background-image":r?"url("+r+")":"","background-repeat":domUtils.getComputedStyle(n,"background-repeat")||"","background-position":browser.ie?domUtils.getComputedStyle(n,"background-position-x")+" "+domUtils.getComputedStyle(n,"background-position-y"):domUtils.getComputedStyle(n,"background-position"),height:domUtils.getComputedStyle(n,"height")};for(var l in o)o.hasOwnProperty(l)&&(s+=l+":"+o[l]+"; ");s+="}</style> ",a.push(s)},aftersetcontent:function(){0==t&&r()}},inputRule:function(e){t=!1,utils.each(e.getNodesByTagName("p"),(function(e){var a=e.getAttr("data-background");a&&(t=!0,r(i(a)),e.parentNode.removeChild(e))}))},outputRule:function(t){var e=this,i=(utils.cssRule(a,e.document)||"").replace(/[\n\r]+/g,"").match(n);i&&t.appendChild(UE.uNode.createElement('<p style="display:none;" data-background="'+utils.trim(i[1].replace(/"/g,"").replace(/[\s]+/g," "))+'"><br/></p>'))},commands:{background:{execCommand:function(t,e){r(e)},queryCommandValue:function(){var t=this,e=(utils.cssRule(a,t.document)||"").replace(/[\n\r]+/g,"").match(n);return e?i(e[1]):null},notNeedUndo:!0}}}})),UE.commands["imagefloat"]={execCommand:function(t,e){var a=this,n=a.selection.getRange();if(!n.collapsed){var i=n.getClosedNode();if(i&&"IMG"==i.tagName)switch(e){case"left":case"right":case"none":var r,s,o,l=i.parentNode;while(dtd.$inline[l.tagName]||"A"==l.tagName)l=l.parentNode;if(r=l,"P"==r.tagName&&"center"==domUtils.getStyle(r,"text-align")){if(!domUtils.isBody(r)&&1==domUtils.getChildCount(r,(function(t){return!domUtils.isBr(t)&&!domUtils.isWhitespace(t)})))if(s=r.previousSibling,o=r.nextSibling,s&&o&&1==s.nodeType&&1==o.nodeType&&s.tagName==o.tagName&&domUtils.isBlockElm(s)){s.appendChild(r.firstChild);while(o.firstChild)s.appendChild(o.firstChild);domUtils.remove(r),domUtils.remove(o)}else domUtils.setStyle(r,"text-align","");n.selectNode(i).select()}domUtils.setStyle(i,"float","none"==e?"":e),"none"==e&&domUtils.removeAttributes(i,"align");break;case"center":if("center"!=a.queryCommandValue("imagefloat")){l=i.parentNode,domUtils.setStyle(i,"float",""),domUtils.removeAttributes(i,"align"),r=i;while(l&&1==domUtils.getChildCount(l,(function(t){return!domUtils.isBr(t)&&!domUtils.isWhitespace(t)}))&&(dtd.$inline[l.tagName]||"A"==l.tagName))r=l,l=l.parentNode;n.setStartBefore(r).setCursor(!1),l=a.document.createElement("div"),l.appendChild(r),domUtils.setStyle(r,"float",""),a.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+l.innerHTML+"</p>"),r=a.document.getElementById("_img_parent_tmp"),r.removeAttribute("id"),r=r.firstChild,n.selectNode(r).select(),o=r.parentNode.nextSibling,o&&domUtils.isEmptyNode(o)&&domUtils.remove(o)}break}}},queryCommandValue:function(){var t,e,a=this.selection.getRange();return a.collapsed?"none":(t=a.getClosedNode(),t&&1==t.nodeType&&"IMG"==t.tagName?(e=domUtils.getComputedStyle(t,"float")||t.getAttribute("align"),"none"==e&&(e="center"==domUtils.getComputedStyle(t.parentNode,"text-align")?"center":e),{left:1,right:1,center:1}[e]?e:"none"):"none")},queryCommandState:function(){var t,e=this.selection.getRange();return e.collapsed?-1:(t=e.getClosedNode(),t&&1==t.nodeType&&"IMG"==t.tagName?0:-1)}},UE.commands["insertimage"]={execCommand:function(t,e){if(e=utils.isArray(e)?e:[e],e.length){var a=this,n=a.selection.getRange(),i=n.getClosedNode();if(!0!==a.fireEvent("beforeinsertimage",e)){if(!i||!/img/i.test(i.tagName)||"edui-faked-video"==i.className&&-1==i.className.indexOf("edui-upload-video")||i.getAttribute("word_img")){var r,s=[],o="";if(r=e[0],1==e.length)c(r),o='<img src="'+r.src+'" '+(r._src?' _src="'+r._src+'" ':"")+(r.width?'width="'+r.width+'" ':"")+(r.height?' height="'+r.height+'" ':"")+("left"==r["floatStyle"]||"right"==r["floatStyle"]?' style="float:'+r["floatStyle"]+';"':"")+(r.title&&""!=r.title?' title="'+r.title+'"':"")+(r.border&&"0"!=r.border?' border="'+r.border+'"':"")+(r.alt&&""!=r.alt?' alt="'+r.alt+'"':"")+(r.hspace&&"0"!=r.hspace?' hspace = "'+r.hspace+'"':"")+(r.vspace&&"0"!=r.vspace?' vspace = "'+r.vspace+'"':"")+"/>","center"==r["floatStyle"]&&(o='<p style="text-align: center">'+o+"</p>"),s.push(o);else for(var l=0;r=e[l++];)c(r),o="<p "+("center"==r["floatStyle"]?'style="text-align: center" ':"")+'><img src="'+r.src+'" '+(r.width?'width="'+r.width+'" ':"")+(r._src?' _src="'+r._src+'" ':"")+(r.height?' height="'+r.height+'" ':"")+' style="'+(r["floatStyle"]&&"center"!=r["floatStyle"]?"float:"+r["floatStyle"]+";":"")+(r.border||"")+'" '+(r.title?' title="'+r.title+'"':"")+" /></p>",s.push(o);a.execCommand("insertHtml",s.join(""))}else{var u=e.shift(),d=u["floatStyle"];delete u["floatStyle"],domUtils.setAttributes(i,u),a.execCommand("imagefloat",d),e.length>0&&(n.setStartAfter(i).setCursor(!1,!0),a.execCommand("insertimage",e))}a.fireEvent("afterinsertimage",e)}}function c(t){utils.each("width,height,border,hspace,vspace".split(","),(function(e){t[e]&&(t[e]=parseInt(t[e],10)||0)})),utils.each("src,_src".split(","),(function(e){t[e]&&(t[e]=utils.unhtmlForUrl(t[e]))})),utils.each("title,alt".split(","),(function(e){t[e]&&(t[e]=utils.unhtml(t[e]))}))}}},UE.plugins["justify"]=function(){var t=domUtils.isBlockElm,e={left:1,right:1,center:1,justify:1},a=function(e,a){var n=e.createBookmark(),i=function(t){return 1==t.nodeType?"br"!=t.tagName.toLowerCase()&&!domUtils.isBookmarkNode(t):!domUtils.isWhitespace(t)};e.enlarge(!0);var r,s=e.createBookmark(),o=domUtils.getNextDomNode(s.start,!1,i),l=e.cloneRange();while(o&&!(domUtils.getPosition(o,s.end)&domUtils.POSITION_FOLLOWING))if(3!=o.nodeType&&t(o))o=domUtils.getNextDomNode(o,!0,i);else{l.setStartBefore(o);while(o&&o!==s.end&&!t(o))r=o,o=domUtils.getNextDomNode(o,!1,null,(function(e){return!t(e)}));l.setEndAfter(r);var u=l.getCommonAncestor();if(!domUtils.isBody(u)&&t(u))domUtils.setStyles(u,utils.isString(a)?{"text-align":a}:a),o=u;else{var d=e.document.createElement("p");domUtils.setStyles(d,utils.isString(a)?{"text-align":a}:a);var c=l.extractContents();d.appendChild(c),l.insertNode(d),o=d}o=domUtils.getNextDomNode(o,!1,i)}return e.moveToBookmark(s).moveToBookmark(n)};UE.commands["justify"]={execCommand:function(t,e){var n,i=this.selection.getRange();return i.collapsed&&(n=this.document.createTextNode("p"),i.insertNode(n)),a(i,e),n&&(i.setStartBefore(n).collapse(!0),domUtils.remove(n)),i.select(),!0},queryCommandValue:function(){var t=this.selection.getStart(),a=domUtils.getComputedStyle(t,"text-align");return e[a]?a:"left"},queryCommandState:function(){var t=this.selection.getStart(),e=t&&domUtils.findParentByTagName(t,["td","th","caption"],!0);return e?-1:0}}},UE.plugins["font"]=function(){var t=this,e={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},a={underline:1,strikethrough:1,fontborder:1},n={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"};function i(t){var e;while(e=t.parentNode){if("SPAN"!=e.tagName||1!=domUtils.getChildCount(e,(function(t){return!domUtils.isBookmarkNode(t)&&!domUtils.isBr(t)})))break;e.style.cssText+=t.style.cssText,domUtils.remove(t,!0),t=e}}function r(t,e,a){if(n[e]&&(t.adjustmentBoundary(),!t.collapsed&&1==t.startContainer.nodeType)){var i=t.startContainer.childNodes[t.startOffset];if(i&&domUtils.isTagNode(i,"span")){var r=t.createBookmark();utils.each(domUtils.getElementsByTagName(i,"span"),(function(t){t.parentNode&&!domUtils.isBookmarkNode(t)&&("backcolor"==e&&domUtils.getComputedStyle(t,"background-color").toLowerCase()===a||(domUtils.removeStyle(t,n[e]),0==t.style.cssText.replace(/^\s+$/,"").length&&domUtils.remove(t,!0)))})),t.moveToBookmark(r)}}}function s(t,e,a){var n,s=t.collapsed,o=t.createBookmark();if(s){n=o.start.parentNode;while(dtd.$inline[n.tagName])n=n.parentNode}else n=domUtils.getCommonAncestor(o.start,o.end);utils.each(domUtils.getElementsByTagName(n,"span"),(function(t){if(t.parentNode&&!domUtils.isBookmarkNode(t))if(/\s*border\s*:\s*none;?\s*/i.test(t.style.cssText))/^\s*border\s*:\s*none;?\s*$/.test(t.style.cssText)?domUtils.remove(t,!0):domUtils.removeStyle(t,"border");else{if(/border/i.test(t.style.cssText)&&"SPAN"==t.parentNode.tagName&&/border/i.test(t.parentNode.style.cssText)&&(t.style.cssText=t.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"")),"fontborder"!=e||"none"!=a){var n=t.nextSibling;while(n&&1==n.nodeType&&"SPAN"==n.tagName)if(domUtils.isBookmarkNode(n)&&"fontborder"==e)t.appendChild(n),n=t.nextSibling;else{if(n.style.cssText==t.style.cssText&&(domUtils.moveChild(n,t),domUtils.remove(n)),t.nextSibling===n)break;n=t.nextSibling}}if(i(t),browser.ie&&browser.version>8){var r=domUtils.findParent(t,(function(t){return"SPAN"==t.tagName&&/background-color/.test(t.style.cssText)}));r&&!/background-color/.test(t.style.cssText)&&(t.style.backgroundColor=r.style.backgroundColor)}}})),t.moveToBookmark(o),r(t,e,a)}for(var o in t.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]}),t.addInputRule((function(t){utils.each(t.getNodesByTagName("u s del font strike"),(function(t){if("font"==t.tagName){var e=[];for(var a in t.attrs)switch(a){case"size":e.push("font-size:"+({1:"10",2:"12",3:"16",4:"18",5:"24",6:"32",7:"48"}[t.attrs[a]]||t.attrs[a])+"px");break;case"color":e.push("color:"+t.attrs[a]);break;case"face":e.push("font-family:"+t.attrs[a]);break;case"style":e.push(t.attrs[a])}t.attrs={style:e.join(";")}}else{var n="u"==t.tagName?"underline":"line-through";t.attrs={style:(t.getAttr("style")||"")+"text-decoration:"+n+";"}}t.tagName="span"}))})),e)(function(t,e){UE.commands[t]={execCommand:function(n,i){i=i||(this.queryCommandState(n)?"none":"underline"==n?"underline":"fontborder"==n?"1px solid #000":"line-through");var r,o=this,l=this.selection.getRange();if("default"==i)l.collapsed&&(r=o.document.createTextNode("font"),l.insertNode(r).select()),o.execCommand("removeFormat","span,a",e),r&&(l.setStartBefore(r).collapse(!0),domUtils.remove(r)),s(l,n,i),l.select();else if(l.collapsed){var u=domUtils.findParentByTagName(l.startContainer,"span",!0);if(r=o.document.createTextNode("font"),!u||u.children.length||u[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){if(l.insertNode(r),l.selectNode(r).select(),u=l.document.createElement("span"),a[t]){if(domUtils.findParentByTagName(r,"a",!0))return l.setStartBefore(r).setCursor(),void domUtils.remove(r);o.execCommand("removeFormat","span,a",e)}if(u.style.cssText=e+":"+i,r.parentNode.insertBefore(u,r),!browser.ie||browser.ie&&9==browser.version){var d=u.parentNode;while(!domUtils.isBlockElm(d))"SPAN"==d.tagName&&(u.style.cssText=d.style.cssText+";"+u.style.cssText),d=d.parentNode}opera?setTimeout((function(){l.setStart(u,0).collapse(!0),s(l,n,i),l.select()})):(l.setStart(u,0).collapse(!0),s(l,n,i),l.select())}else l.insertNode(r),a[t]&&(l.selectNode(r).select(),o.execCommand("removeFormat","span,a",e,null),u=domUtils.findParentByTagName(r,"span",!0),l.setStartBefore(r)),u&&(u.style.cssText+=";"+e+":"+i),l.collapse(!0).select();domUtils.remove(r)}else a[t]&&o.queryCommandValue(t)&&o.execCommand("removeFormat","span,a",e),l=o.selection.getRange(),l.applyInlineStyle("span",{style:e+":"+i}),s(l,n,i),l.select();return!0},queryCommandValue:function(t){var a=this.selection.getStart();if("underline"==t||"strikethrough"==t){var n,i=a;while(i&&!domUtils.isBlockElm(i)&&!domUtils.isBody(i)){if(1==i.nodeType&&(n=domUtils.getComputedStyle(i,e),"none"!=n))return n;i=i.parentNode}return"none"}if("fontborder"==t){var r,s=a;while(s&&dtd.$inline[s.tagName]){if((r=domUtils.getComputedStyle(s,"border"))&&/1px/.test(r)&&/solid/.test(r))return r;s=s.parentNode}return""}if("FontSize"==t){var o=domUtils.getComputedStyle(a,e);s=/^([\d\.]+)(\w+)$/.exec(o);return s?Math.floor(s[1])+s[2]:o}return domUtils.getComputedStyle(a,e)},queryCommandState:function(t){if(!a[t])return 0;var e=this.queryCommandValue(t);return"fontborder"==t?/1px/.test(e)&&/solid/.test(e):"underline"==t?/underline/.test(e):/line\-through/.test(e)}}})(o,e[o])},UE.plugins["link"]=function(){function t(t){var e=t.startContainer,a=t.endContainer;(e=domUtils.findParentByTagName(e,"a",!0))&&t.setStartBefore(e),(a=domUtils.findParentByTagName(a,"a",!0))&&t.setEndAfter(a)}function e(e,a,n){var i=e.cloneRange(),r=n.queryCommandValue("link");t(e=e.adjustmentBoundary());var s=e.startContainer;if(1==s.nodeType&&r&&(s=s.childNodes[e.startOffset],s&&1==s.nodeType&&"A"==s.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(s[browser.ie?"innerText":"textContent"])&&(s[browser.ie?"innerText":"textContent"]=utils.html(a.textValue||a.href))),i.collapsed&&!r||(e.removeInlineStyle("a"),i=e.cloneRange()),i.collapsed){var o=e.document.createElement("a"),l="";a.textValue?(l=utils.html(a.textValue),delete a.textValue):l=utils.html(a.href),domUtils.setAttributes(o,a),s=domUtils.findParentByTagName(i.startContainer,"a",!0),s&&domUtils.isInNodeEndBoundary(i,s)&&e.setStartAfter(s).collapse(!0),o[browser.ie?"innerText":"textContent"]=l,e.insertNode(o).selectNode(o)}else e.applyInlineStyle("a",a)}UE.commands["unlink"]={execCommand:function(){var e,a=this.selection.getRange();a.collapsed&&!domUtils.findParentByTagName(a.startContainer,"a",!0)||(e=a.createBookmark(),t(a),a.removeInlineStyle("a").moveToBookmark(e).select())},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands["link"]={execCommand:function(t,a){var n;a._href&&(a._href=utils.unhtml(a._href,/[<">]/g)),a.href&&(a.href=utils.unhtml(a.href,/[<">]/g)),a.textValue&&(a.textValue=utils.unhtml(a.textValue,/[<">]/g)),e(n=this.selection.getRange(),a,this),n.collapse().select(!0)},queryCommandValue:function(){var t,e=this.selection.getRange();if(!e.collapsed){e.shrinkBoundary();var a=3!=e.startContainer.nodeType&&e.startContainer.childNodes[e.startOffset]?e.startContainer.childNodes[e.startOffset]:e.startContainer,n=3==e.endContainer.nodeType||0==e.endOffset?e.endContainer:e.endContainer.childNodes[e.endOffset-1],i=e.getCommonAncestor();if(t=domUtils.findParentByTagName(i,"a",!0),!t&&1==i.nodeType)for(var r,s,o,l=i.getElementsByTagName("a"),u=0;o=l[u++];)if(r=domUtils.getPosition(o,a),s=domUtils.getPosition(o,n),(r&domUtils.POSITION_FOLLOWING||r&domUtils.POSITION_CONTAINS)&&(s&domUtils.POSITION_PRECEDING||s&domUtils.POSITION_CONTAINS)){t=o;break}return t}if(t=e.startContainer,t=1==t.nodeType?t:t.parentNode,t&&(t=domUtils.findParentByTagName(t,"a",!0))&&!domUtils.isInNodeEndBoundary(e,t))return t},queryCommandState:function(){var t=this.selection.getRange().getClosedNode(),e=t&&("edui-faked-video"==t.className||-1!=t.className.indexOf("edui-upload-video"));return e?-1:0}}},UE.plugins["insertframe"]=function(){var t=this;function e(){t._iframe&&delete t._iframe}t.addListener("selectionchange",(function(){e()}))},UE.commands["scrawl"]={queryCommandState:function(){return browser.ie&&browser.version<=8?-1:0}},UE.plugins["removeformat"]=function(){var t=this;t.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),t.commands["removeformat"]={execCommand:function(t,e,a,n,i){var r,s,o=new RegExp("^(?:"+(e||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),l=a?[]:(n||this.options.removeFormatAttributes).split(","),u=new dom.Range(this.document),d=function(t){return 1==t.nodeType};function c(t){if(3==t.nodeType||"span"!=t.tagName.toLowerCase())return 0;if(browser.ie){var e=t.attributes;if(e.length){for(var a=0,n=e.length;a<n;a++)if(e[a].specified)return 0;return 1}}return!t.attributes.length}function p(t){var e=t.createBookmark();if(t.collapsed&&t.enlarge(!0),!i){var n=domUtils.findParentByTagName(t.startContainer,"a",!0);n&&t.setStartBefore(n),n=domUtils.findParentByTagName(t.endContainer,"a",!0),n&&t.setEndAfter(n)}r=t.createBookmark(),f=r.start;while((s=f.parentNode)&&!domUtils.isBlockElm(s))domUtils.breakParent(f,s),domUtils.clearEmptySibling(f);if(r.end){f=r.end;while((s=f.parentNode)&&!domUtils.isBlockElm(s))domUtils.breakParent(f,s),domUtils.clearEmptySibling(f);var u,p=domUtils.getNextDomNode(r.start,!1,d);while(p){if(p==r.end)break;u=domUtils.getNextDomNode(p,!0,d),dtd.$empty[p.tagName.toLowerCase()]||domUtils.isBookmarkNode(p)||(o.test(p.tagName)?a?(domUtils.removeStyle(p,a),c(p)&&"text-decoration"!=a&&domUtils.remove(p,!0)):domUtils.remove(p,!0):dtd.$tableContent[p.tagName]||dtd.$list[p.tagName]||(domUtils.removeAttributes(p,l),c(p)&&domUtils.remove(p,!0))),p=u}}var h=r.start.parentNode;!domUtils.isBlockElm(h)||dtd.$tableContent[h.tagName]||dtd.$list[h.tagName]||domUtils.removeAttributes(h,l),h=r.end.parentNode,r.end&&domUtils.isBlockElm(h)&&!dtd.$tableContent[h.tagName]&&!dtd.$list[h.tagName]&&domUtils.removeAttributes(h,l),t.moveToBookmark(r).moveToBookmark(e);var g,f=t.startContainer,m=t.collapsed;while(1==f.nodeType&&domUtils.isEmptyNode(f)&&dtd.$removeEmpty[f.tagName])g=f.parentNode,t.setStartBefore(f),t.startContainer===t.endContainer&&t.endOffset--,domUtils.remove(f),f=g;if(!m){f=t.endContainer;while(1==f.nodeType&&domUtils.isEmptyNode(f)&&dtd.$removeEmpty[f.tagName])g=f.parentNode,t.setEndBefore(f),domUtils.remove(f),f=g}}u=this.selection.getRange(),p(u),u.select()}}},UE.plugins["blockquote"]=function(){var t=this;function e(t){return domUtils.filterNodeList(t.selection.getStartElementPath(),"blockquote")}t.commands["blockquote"]={execCommand:function(t,a){var n=this.selection.getRange(),i=e(this),r=dtd.blockquote,s=n.createBookmark();if(i){var o=n.startContainer,l=domUtils.isBlockElm(o)?o:domUtils.findParent(o,(function(t){return domUtils.isBlockElm(t)})),u=n.endContainer,d=domUtils.isBlockElm(u)?u:domUtils.findParent(u,(function(t){return domUtils.isBlockElm(t)}));l=domUtils.findParentByTagName(l,"li",!0)||l,d=domUtils.findParentByTagName(d,"li",!0)||d,"LI"==l.tagName||"TD"==l.tagName||l===i||domUtils.isBody(l)?domUtils.remove(i,!0):domUtils.breakParent(l,i),l!==d&&(i=domUtils.findParentByTagName(d,"blockquote"),i&&("LI"==d.tagName||"TD"==d.tagName||domUtils.isBody(d)?i.parentNode&&domUtils.remove(i,!0):domUtils.breakParent(d,i)));for(var c,p=domUtils.getElementsByTagName(this.document,"blockquote"),h=0;c=p[h++];)c.childNodes.length?domUtils.getPosition(c,l)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(c,d)&domUtils.POSITION_PRECEDING&&domUtils.remove(c,!0):domUtils.remove(c)}else{var g=n.cloneRange(),f=1==g.startContainer.nodeType?g.startContainer:g.startContainer.parentNode,m=f,v=1;while(1){if(domUtils.isBody(f)){m!==f?n.collapsed?(g.selectNode(m),v=0):g.setStartBefore(m):g.setStart(f,0);break}if(!r[f.tagName]){n.collapsed?g.selectNode(m):g.setStartBefore(m);break}m=f,f=f.parentNode}if(v){m=f=f=1==g.endContainer.nodeType?g.endContainer:g.endContainer.parentNode;while(1){if(domUtils.isBody(f)){m!==f?g.setEndAfter(m):g.setEnd(f,f.childNodes.length);break}if(!r[f.tagName]){g.setEndAfter(m);break}m=f,f=f.parentNode}}f=n.document.createElement("blockquote"),domUtils.setAttributes(f,a),f.appendChild(g.extractContents()),g.insertNode(f);var b,y=domUtils.getElementsByTagName(f,"blockquote");for(h=0;b=y[h++];)b.parentNode&&domUtils.remove(b,!0)}n.moveToBookmark(s).select()},queryCommandState:function(){return e(this)?1:0}}},UE.commands["touppercase"]=UE.commands["tolowercase"]={execCommand:function(t){var e=this,a=e.selection.getRange();if(a.collapsed)return a;var n=a.createBookmark(),i=n.end,r=function(t){return!domUtils.isBr(t)&&!domUtils.isWhitespace(t)},s=domUtils.getNextDomNode(n.start,!1,r);while(s&&domUtils.getPosition(s,i)&domUtils.POSITION_PRECEDING)if(3==s.nodeType&&(s.nodeValue=s.nodeValue["touppercase"==t?"toUpperCase":"toLowerCase"]()),s=domUtils.getNextDomNode(s,!0,r),s===i)break;a.moveToBookmark(n).select()}},UE.commands["indent"]={execCommand:function(){var t=this,e=t.queryCommandState("indent")?"0em":t.options.indentValue||"2em";t.execCommand("Paragraph","p",{style:"text-indent:"+e})},queryCommandState:function(){var t=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t&&t.style.textIndent&&parseInt(t.style.textIndent)?1:0}},UE.commands["print"]={execCommand:function(){this.window.print()},notNeedUndo:1},UE.commands["preview"]={execCommand:function(){var t=window.open("","_blank",""),e=t.document;e.open(),e.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"><\/script><script>setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)<\/script></head><body><div>"+this.getContent(null,null,!0)+"</div></body></html>"),e.close()},notNeedUndo:1},UE.plugins["selectall"]=function(){var t=this;t.commands["selectall"]={execCommand:function(){var t=this,e=t.body,a=t.selection.getRange();a.selectNodeContents(e),domUtils.isEmptyBlock(e)&&(browser.opera&&e.firstChild&&1==e.firstChild.nodeType&&a.setStartAtFirst(e.firstChild),a.collapse(!0)),a.select(!0)},notNeedUndo:1},t.addshortcutkey({selectAll:"ctrl+65"})},UE.plugins["paragraph"]=function(){var t=this,e=domUtils.isBlockElm,a=["TD","LI","PRE"],n=function(t,n,i,r){var s,o=t.createBookmark(),l=function(t){return 1==t.nodeType?"br"!=t.tagName.toLowerCase()&&!domUtils.isBookmarkNode(t):!domUtils.isWhitespace(t)};t.enlarge(!0);var u,d=t.createBookmark(),c=domUtils.getNextDomNode(d.start,!1,l),p=t.cloneRange();while(c&&!(domUtils.getPosition(c,d.end)&domUtils.POSITION_FOLLOWING))if(3!=c.nodeType&&e(c))c=domUtils.getNextDomNode(c,!0,l);else{p.setStartBefore(c);while(c&&c!==d.end&&!e(c))u=c,c=domUtils.getNextDomNode(c,!1,null,(function(t){return!e(t)}));p.setEndAfter(u),s=t.document.createElement(n),i&&(domUtils.setAttributes(s,i),r&&"customstyle"==r&&i.style&&(s.style.cssText=i.style)),s.appendChild(p.extractContents()),domUtils.isEmptyNode(s)&&domUtils.fillChar(t.document,s),p.insertNode(s);var h=s.parentNode;e(h)&&!domUtils.isBody(s.parentNode)&&-1==utils.indexOf(a,h.tagName)&&(r&&"customstyle"==r||(h.getAttribute("dir")&&s.setAttribute("dir",h.getAttribute("dir")),h.style.cssText&&(s.style.cssText=h.style.cssText+";"+s.style.cssText),h.style.textAlign&&!s.style.textAlign&&(s.style.textAlign=h.style.textAlign),h.style.textIndent&&!s.style.textIndent&&(s.style.textIndent=h.style.textIndent),h.style.padding&&!s.style.padding&&(s.style.padding=h.style.padding)),i&&/h\d/i.test(h.tagName)&&!/h\d/i.test(s.tagName)?(domUtils.setAttributes(h,i),r&&"customstyle"==r&&i.style&&(h.style.cssText=i.style),domUtils.remove(s,!0),s=h):domUtils.remove(s.parentNode,!0)),c=-1!=utils.indexOf(a,h.tagName)?h:s,c=domUtils.getNextDomNode(c,!1,l)}return t.moveToBookmark(d).moveToBookmark(o)};t.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),t.commands["paragraph"]={execCommand:function(t,e,a,i){var r=this.selection.getRange();if(r.collapsed){var s=this.document.createTextNode("p");if(r.insertNode(s),browser.ie){var o=s.previousSibling;o&&domUtils.isWhitespace(o)&&domUtils.remove(o),o=s.nextSibling,o&&domUtils.isWhitespace(o)&&domUtils.remove(o)}}if(r=n(r,e,a,i),s&&(r.setStartBefore(s).collapse(!0),pN=s.parentNode,domUtils.remove(s),domUtils.isBlockElm(pN)&&domUtils.isEmptyNode(pN)&&domUtils.fillNode(this.document,pN)),browser.gecko&&r.collapsed&&1==r.startContainer.nodeType){var l=r.startContainer.childNodes[r.startOffset];l&&1==l.nodeType&&l.tagName.toLowerCase()==e&&r.setStart(l,0).collapse(!0)}return r.select(),!0},queryCommandValue:function(){var t=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t?t.tagName.toLowerCase():""}}},function(){var t=domUtils.isBlockElm,e=function(t){return domUtils.filterNodeList(t.selection.getStartElementPath(),(function(t){return t&&1==t.nodeType&&t.getAttribute("dir")}))},a=function(a,n,i){var r,s=function(t){return 1==t.nodeType?!domUtils.isBookmarkNode(t):!domUtils.isWhitespace(t)},o=e(n);if(o&&a.collapsed)return o.setAttribute("dir",i),a;r=a.createBookmark(),a.enlarge(!0);var l,u=a.createBookmark(),d=domUtils.getNextDomNode(u.start,!1,s),c=a.cloneRange();while(d&&!(domUtils.getPosition(d,u.end)&domUtils.POSITION_FOLLOWING))if(3!=d.nodeType&&t(d))d=domUtils.getNextDomNode(d,!0,s);else{c.setStartBefore(d);while(d&&d!==u.end&&!t(d))l=d,d=domUtils.getNextDomNode(d,!1,null,(function(e){return!t(e)}));c.setEndAfter(l);var p=c.getCommonAncestor();if(!domUtils.isBody(p)&&t(p))p.setAttribute("dir",i),d=p;else{var h=a.document.createElement("p");h.setAttribute("dir",i);var g=c.extractContents();h.appendChild(g),c.insertNode(h),d=h}d=domUtils.getNextDomNode(d,!1,s)}return a.moveToBookmark(u).moveToBookmark(r)};UE.commands["directionality"]={execCommand:function(t,e){var n=this.selection.getRange();if(n.collapsed){var i=this.document.createTextNode("d");n.insertNode(i)}return a(n,this,e),i&&(n.setStartBefore(i).collapse(!0),domUtils.remove(i)),n.select(),!0},queryCommandValue:function(){var t=e(this);return t?t.getAttribute("dir"):"ltr"}}}(),UE.plugins["horizontal"]=function(){var t=this;t.commands["horizontal"]={execCommand:function(t){var e=this;if(-1!==e.queryCommandState(t)){e.execCommand("insertHtml","<hr>");var a,n=e.selection.getRange(),i=n.startContainer;if(1==i.nodeType&&!i.childNodes[n.startOffset])(a=i.childNodes[n.startOffset-1])&&1==a.nodeType&&"HR"==a.tagName&&("p"==e.options.enterTag?(a=e.document.createElement("p"),n.insertNode(a),n.setStart(a,0).setCursor()):(a=e.document.createElement("br"),n.insertNode(a),n.setStartBefore(a).setCursor()));return!0}},queryCommandState:function(){return domUtils.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}},t.addListener("delkeydown",(function(t,e){var a=this.selection.getRange();if(a.txtToElmBoundary(!0),domUtils.isStartInblock(a)){var n=a.startContainer,i=n.previousSibling;if(i&&domUtils.isTagNode(i,"hr"))return domUtils.remove(i),a.select(),domUtils.preventDefault(e),!0}}))},UE.commands["time"]=UE.commands["date"]={execCommand:function(t,e){var a=new Date;function n(t,e){var a=("0"+t.getHours()).slice(-2),n=("0"+t.getMinutes()).slice(-2),i=("0"+t.getSeconds()).slice(-2);return e=e||"hh:ii:ss",e.replace(/hh/gi,a).replace(/ii/gi,n).replace(/ss/gi,i)}function i(t,e){var a=("000"+t.getFullYear()).slice(-4),n=a.slice(-2),i=("0"+(t.getMonth()+1)).slice(-2),r=("0"+t.getDate()).slice(-2);return e=e||"yyyy-mm-dd",e.replace(/yyyy/gi,a).replace(/yy/gi,n).replace(/mm/gi,i).replace(/dd/gi,r)}this.execCommand("insertHtml","time"==t?n(a,e):i(a,e))}},UE.plugins["rowspacing"]=function(){var t=this;t.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]}),t.commands["rowspacing"]={execCommand:function(t,e,a){return this.execCommand("paragraph","p",{style:"margin-"+a+":"+e+"px"}),!0},queryCommandValue:function(t,e){var a,n=domUtils.filterNodeList(this.selection.getStartElementPath(),(function(t){return domUtils.isBlockElm(t)}));return n?(a=domUtils.getComputedStyle(n,"margin-"+e).replace(/[^\d]/g,""),a||0):0}}},UE.plugins["lineheight"]=function(){var t=this;t.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]}),t.commands["lineheight"]={execCommand:function(t,e){return this.execCommand("paragraph","p",{style:"line-height:"+("1"==e?"normal":e+"em")}),!0},queryCommandValue:function(){var t=domUtils.filterNodeList(this.selection.getStartElementPath(),(function(t){return domUtils.isBlockElm(t)}));if(t){var e=domUtils.getComputedStyle(t,"line-height");return"normal"==e?1:e.replace(/[^\d.]*/gi,"")}}}},UE.plugins["insertcode"]=function(){var t=this;t.ready((function(){utils.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}",t.document)})),t.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"}),t.commands["insertcode"]={execCommand:function(t,e){var a=this,n=a.selection.getRange(),i=domUtils.findParentByTagName(n.startContainer,"pre",!0);if(i)i.className="brush:"+e+";toolbar:false;";else{var r="";if(n.collapsed)r=browser.ie&&browser.ie11below?browser.version<=8?"&nbsp;":"":"<br/>";else{var s=n.extractContents(),o=a.document.createElement("div");o.appendChild(s),utils.each(UE.filterNode(UE.htmlparser(o.innerHTML.replace(/[\r\t]/g,"")),a.options.filterTxtRules).children,(function(t){if(browser.ie&&browser.ie11below&&browser.version>8)"element"==t.type?"br"==t.tagName?r+="\n":dtd.$empty[t.tagName]||(utils.each(t.children,(function(e){"element"==e.type?"br"==e.tagName?r+="\n":dtd.$empty[t.tagName]||(r+=e.innerText()):r+=e.data})),/\n$/.test(r)||(r+="\n")):r+=t.data+"\n",!t.nextSibling()&&/\n$/.test(r)&&(r=r.replace(/\n$/,""));else if(browser.ie&&browser.ie11below)"element"==t.type?"br"==t.tagName?r+="<br>":dtd.$empty[t.tagName]||(utils.each(t.children,(function(e){"element"==e.type?"br"==e.tagName?r+="<br>":dtd.$empty[t.tagName]||(r+=e.innerText()):r+=e.data})),/br>$/.test(r)||(r+="<br>")):r+=t.data+"<br>",!t.nextSibling()&&/<br>$/.test(r)&&(r=r.replace(/<br>$/,""));else if(r+="element"==t.type?dtd.$empty[t.tagName]?"":t.innerText():t.data,!/br\/?\s*>$/.test(r)){if(!t.nextSibling())return;r+="<br>"}}))}a.execCommand("inserthtml",'<pre id="coder"class="brush:'+e+';toolbar:false">'+r+"</pre>",!0),i=a.document.getElementById("coder"),domUtils.removeAttributes(i,"id");var l=i.previousSibling;l&&(3==l.nodeType&&1==l.nodeValue.length&&browser.ie&&6==browser.version||domUtils.isEmptyBlock(l))&&domUtils.remove(l);n=a.selection.getRange();domUtils.isEmptyBlock(i)?n.setStart(i,0).setCursor(!1,!0):n.selectNodeContents(i).select()}},queryCommandValue:function(){var t=this.selection.getStartElementPath(),e="";return utils.each(t,(function(t){if("PRE"==t.nodeName){var a=t.className.match(/brush:([^;]+)/);return e=a&&a[1]?a[1]:"",!1}})),e}},t.addInputRule((function(t){utils.each(t.getNodesByTagName("pre"),(function(t){var e=t.getNodesByTagName("br");if(e.length)browser.ie&&browser.ie11below&&browser.version>8&&utils.each(e,(function(t){var e=UE.uNode.createText("\n");t.parentNode.insertBefore(e,t),t.parentNode.removeChild(t)}));else if(!(browser.ie&&browser.ie11below&&browser.version>8)){var a=t.innerText().split(/\n/);t.innerHTML(""),utils.each(a,(function(e){e.length&&t.appendChild(UE.uNode.createText(e)),t.appendChild(UE.uNode.createElement("br"))}))}}))})),t.addOutputRule((function(t){utils.each(t.getNodesByTagName("pre"),(function(t){var e="";utils.each(t.children,(function(t){"text"==t.type?e+=t.data.replace(/[ ]/g,"&nbsp;").replace(/\n$/,""):"br"==t.tagName?e+="\n":e+=dtd.$empty[t.tagName]?t.innerText():""})),t.innerText(e.replace(/(&nbsp;|\n)+$/,""))}))})),t.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,insertcode:1,inserthtml:1,selectall:1};t.queryCommandState;t.queryCommandState=function(t){var e=this;return!e.notNeedCodeQuery[t.toLowerCase()]&&e.selection&&e.queryCommandValue("insertcode")?-1:UE.Editor.prototype.queryCommandState.apply(this,arguments)},t.addListener("beforeenterkeydown",(function(){var e=t.selection.getRange(),a=domUtils.findParentByTagName(e.startContainer,"pre",!0);if(a){if(t.fireEvent("saveScene"),e.collapsed||e.deleteContents(),!browser.ie||browser.ie9above){var n=t.document.createElement("br");e.insertNode(n).setStartAfter(n).collapse(!0);var i=n.nextSibling;i||browser.ie&&!(browser.version>10)?e.setStartAfter(n):e.insertNode(n.cloneNode(!1)),a=n.previousSibling;while(a)if(c=a,a=a.previousSibling,!a||"BR"==a.nodeName){a=c;break}if(a){var r="";while(a&&"BR"!=a.nodeName&&new RegExp("^[\\s"+domUtils.fillChar+"]*$").test(a.nodeValue))r+=a.nodeValue,a=a.nextSibling;if("BR"!=a.nodeName){var s=a.nodeValue.match(new RegExp("^([\\s"+domUtils.fillChar+"]+)"));s&&s[1]&&(r+=s[1])}r&&(r=t.document.createTextNode(r),e.insertNode(r).setStartAfter(r))}e.collapse(!0).select(!0)}else if(browser.version>8){var o=t.document.createTextNode("\n"),l=e.startContainer;if(0==e.startOffset){var u=l.previousSibling;if(u){e.insertNode(o);var d=t.document.createTextNode(" ");e.setStartAfter(o).insertNode(d).setStart(d,0).collapse(!0).select(!0)}}else{e.insertNode(o).setStartAfter(o);d=t.document.createTextNode(" ");l=e.startContainer.childNodes[e.startOffset],l&&!/^\n/.test(l.nodeValue)&&e.setStartBefore(o),e.insertNode(d).setStart(d,0).collapse(!0).select(!0)}}else{var c;n=t.document.createElement("br");e.insertNode(n),e.insertNode(t.document.createTextNode(domUtils.fillChar)),e.setStartAfter(n),a=n.previousSibling;while(a)if(c=a,a=a.previousSibling,!a||"BR"==a.nodeName){a=c;break}if(a){r="";while(a&&"BR"!=a.nodeName&&new RegExp("^[ "+domUtils.fillChar+"]*$").test(a.nodeValue))r+=a.nodeValue,a=a.nextSibling;if("BR"!=a.nodeName){s=a.nodeValue.match(new RegExp("^([ "+domUtils.fillChar+"]+)"));s&&s[1]&&(r+=s[1])}r=t.document.createTextNode(r),e.insertNode(r).setStartAfter(r)}e.collapse(!0).select()}return t.fireEvent("saveScene"),!0}})),t.addListener("tabkeydown",(function(e,a){var n=t.selection.getRange(),i=domUtils.findParentByTagName(n.startContainer,"pre",!0);if(i){if(t.fireEvent("saveScene"),a.shiftKey);else if(n.collapsed){var r=t.document.createTextNode("    ");n.insertNode(r).setStartAfter(r).collapse(!0).select(!0)}else{var s=n.createBookmark(),o=s.start.previousSibling;while(o){if(i.firstChild===o&&!domUtils.isBr(o)){i.insertBefore(t.document.createTextNode("    "),o);break}if(domUtils.isBr(o)){i.insertBefore(t.document.createTextNode("    "),o.nextSibling);break}o=o.previousSibling}var l=s.end;o=s.start.nextSibling,i.firstChild===s.start&&i.insertBefore(t.document.createTextNode("    "),o.nextSibling);while(o&&o!==l){if(domUtils.isBr(o)&&o.nextSibling){if(o.nextSibling===l)break;i.insertBefore(t.document.createTextNode("    "),o.nextSibling)}o=o.nextSibling}n.moveToBookmark(s).select()}return t.fireEvent("saveScene"),!0}})),t.addListener("beforeinserthtml",(function(t,e){var a=this,n=a.selection.getRange(),i=domUtils.findParentByTagName(n.startContainer,"pre",!0);if(i){n.collapsed||n.deleteContents();var r="";if(browser.ie&&browser.version>8){utils.each(UE.filterNode(UE.htmlparser(e),a.options.filterTxtRules).children,(function(t){"element"==t.type?"br"==t.tagName?r+="\n":dtd.$empty[t.tagName]||(utils.each(t.children,(function(e){"element"==e.type?"br"==e.tagName?r+="\n":dtd.$empty[t.tagName]||(r+=e.innerText()):r+=e.data})),/\n$/.test(r)||(r+="\n")):r+=t.data+"\n",!t.nextSibling()&&/\n$/.test(r)&&(r=r.replace(/\n$/,""))}));var s=a.document.createTextNode(utils.html(r.replace(/&nbsp;/g," ")));n.insertNode(s).selectNode(s).select()}else{var o=a.document.createDocumentFragment();utils.each(UE.filterNode(UE.htmlparser(e),a.options.filterTxtRules).children,(function(t){"element"==t.type?"br"==t.tagName?o.appendChild(a.document.createElement("br")):dtd.$empty[t.tagName]||(utils.each(t.children,(function(e){"element"==e.type?"br"==e.tagName?o.appendChild(a.document.createElement("br")):dtd.$empty[t.tagName]||o.appendChild(a.document.createTextNode(utils.html(e.innerText().replace(/&nbsp;/g," ")))):o.appendChild(a.document.createTextNode(utils.html(e.data.replace(/&nbsp;/g," "))))})),"BR"!=o.lastChild.nodeName&&o.appendChild(a.document.createElement("br"))):o.appendChild(a.document.createTextNode(utils.html(t.data.replace(/&nbsp;/g," ")))),t.nextSibling()||"BR"!=o.lastChild.nodeName||o.removeChild(o.lastChild)})),n.insertNode(o).select()}return!0}})),t.addListener("keydown",(function(t,e){var a=this,n=e.keyCode||e.which;if(40==n){var i,r=a.selection.getRange(),s=r.startContainer;if(r.collapsed&&(i=domUtils.findParentByTagName(r.startContainer,"pre",!0))&&!i.nextSibling){var o=i.lastChild;while(o&&"BR"==o.nodeName)o=o.previousSibling;(o===s||r.startContainer===i&&r.startOffset==i.childNodes.length)&&(a.execCommand("insertparagraph"),domUtils.preventDefault(e))}}})),t.addListener("delkeydown",(function(e,a){var n=this.selection.getRange();n.txtToElmBoundary(!0);var i=n.startContainer;if(domUtils.isTagNode(i,"pre")&&n.collapsed&&domUtils.isStartInblock(n)){var r=t.document.createElement("p");return domUtils.fillNode(t.document,r),i.parentNode.insertBefore(r,i),domUtils.remove(i),n.setStart(r,0).setCursor(!1,!0),domUtils.preventDefault(a),!0}}))},UE.commands["cleardoc"]={execCommand:function(t){var e=this,a=e.options.enterTag,n=e.selection.getRange();"br"==a?(e.body.innerHTML="<br/>",n.setStart(e.body,0).setCursor()):(e.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>",n.setStart(e.body.firstChild,0).setCursor(!1,!0)),setTimeout((function(){e.fireEvent("clearDoc")}),0)}},UE.plugin.register("anchor",(function(){return{bindEvents:{ready:function(){utils.cssRule("anchor",".anchorclass{background: url('"+this.options.themePath+this.options.theme+"/images/anchor.gif') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}",this.document)}},outputRule:function(t){utils.each(t.getNodesByTagName("img"),(function(t){var e;(e=t.getAttr("anchorname"))&&(t.tagName="a",t.setAttr({anchorname:"",name:e,class:""}))}))},inputRule:function(t){utils.each(t.getNodesByTagName("a"),(function(t){t.getAttr("name")&&!t.getAttr("href")&&(t.tagName="img",t.setAttr({anchorname:t.getAttr("name"),class:"anchorclass"}),t.setAttr("name"))}))},commands:{anchor:{execCommand:function(t,e){var a=this.selection.getRange(),n=a.getClosedNode();if(n&&n.getAttribute("anchorname"))e?n.setAttribute("anchorname",e):(a.setStartBefore(n).setCursor(),domUtils.remove(n));else if(e){var i=this.document.createElement("img");a.collapse(!0),domUtils.setAttributes(i,{anchorname:e,class:"anchorclass"}),a.insertNode(i).setStartAfter(i).setCursor(!1,!0)}}}}}})),UE.plugins["wordcount"]=function(){var t,e=this;e.setOpt("wordCount",!0),e.addListener("contentchange",(function(){e.fireEvent("wordcount")})),e.addListener("ready",(function(){var e=this;domUtils.on(e.body,"keyup",(function(a){var n=a.keyCode||a.which,i={16:1,18:1,20:1,37:1,38:1,39:1,40:1};n in i||(clearTimeout(t),t=setTimeout((function(){e.fireEvent("wordcount")}),200))}))}))},UE.plugins["pagebreak"]=function(){var t=this,e=["td"];function a(e){if(domUtils.isEmptyBlock(e)){var a,n=e.firstChild;while(n&&1==n.nodeType&&domUtils.isEmptyBlock(n))a=n,n=n.firstChild;!a&&(a=e),domUtils.fillNode(t.document,a)}}function n(t){return t&&1==t.nodeType&&"HR"==t.tagName&&"pagebreak"==t.className}t.setOpt("pageBreakTag","_ueditor_page_break_tag_"),t.ready((function(){utils.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",t.document)})),t.addInputRule((function(e){e.traversal((function(e){if("text"==e.type&&e.data==t.options.pageBreakTag){var a=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');e.parentNode.insertBefore(a,e),e.parentNode.removeChild(e)}}))})),t.addOutputRule((function(e){utils.each(e.getNodesByTagName("hr"),(function(e){if("pagebreak"==e.getAttr("class")){var a=UE.uNode.createText(t.options.pageBreakTag);e.parentNode.insertBefore(a,e),e.parentNode.removeChild(e)}}))})),t.commands["pagebreak"]={execCommand:function(){var i=t.selection.getRange(),r=t.document.createElement("hr");domUtils.setAttributes(r,{class:"pagebreak",noshade:"noshade",size:"5"}),domUtils.unSelectable(r);var s=domUtils.findParentByTagName(i.startContainer,e,!0),o=[];if(s)switch(s.tagName){case"TD":if(c=s.parentNode,c.previousSibling)c.parentNode.insertBefore(r,c),o=domUtils.findParents(r);else{var l=domUtils.findParentByTagName(c,"table");l.parentNode.insertBefore(r,l),o=domUtils.findParents(r,!0)}c=o[1],r!==c&&domUtils.breakParent(r,c),t.fireEvent("afteradjusttable",t.document)}else{if(!i.collapsed){i.deleteContents();var u=i.startContainer;while(!domUtils.isBody(u)&&domUtils.isBlockElm(u)&&domUtils.isEmptyNode(u))i.setStartBefore(u).collapse(!0),domUtils.remove(u),u=i.startContainer}i.insertNode(r);var d,c=r.parentNode;while(!domUtils.isBody(c))domUtils.breakParent(r,c),d=r.nextSibling,d&&domUtils.isEmptyBlock(d)&&domUtils.remove(d),c=r.parentNode;d=r.nextSibling;var p=r.previousSibling;if(n(p)?domUtils.remove(p):p&&a(p),d)n(d)?domUtils.remove(d):a(d),i.setEndAfter(r).collapse(!1);else{var h=t.document.createElement("p");r.parentNode.appendChild(h),domUtils.fillNode(t.document,h),i.setStart(h,0).collapse(!0)}i.select(!0)}}}},UE.plugin.register("wordimage",(function(){var t=this,e=[];return{commands:{wordimage:{execCommand:function(){for(var e,a=domUtils.getElementsByTagName(t.body,"img"),n=[],i=0;e=a[i++];){var r=e.getAttribute("word_img");r&&n.push(r)}return n},queryCommandState:function(){e=domUtils.getElementsByTagName(t.body,"img");for(var a,n=0;a=e[n++];)if(a.getAttribute("word_img"))return 1;return-1},notNeedUndo:!0}},inputRule:function(e){utils.each(e.getNodesByTagName("img"),(function(e){var a=e.attrs,n=parseInt(a.width)<128||parseInt(a.height)<43,i=t.options,r=i.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";a["src"]&&/^(?:(file:\/+))/.test(a["src"])&&e.setAttr({width:a.width,height:a.height,alt:a.alt,word_img:a.src,src:r,style:"background:url("+(n?i.themePath+i.theme+"/images/word.gif":i.langPath+i.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd"})}))}}})),UE.plugins["dragdrop"]=function(){var t=this;t.ready((function(){domUtils.on(this.body,"dragend",(function(){var e=t.selection.getRange(),a=e.getClosedNode()||t.selection.getStart();if(a&&"IMG"==a.tagName){var n,i=a.previousSibling;while(n=a.nextSibling){if(1!=n.nodeType||"SPAN"!=n.tagName||n.firstChild)break;domUtils.remove(n)}(!i||1!=i.nodeType||domUtils.isEmptyBlock(i))&&i||n&&(!n||domUtils.isEmptyBlock(n))||(i&&"P"==i.tagName&&!domUtils.isEmptyBlock(i)?(i.appendChild(a),domUtils.moveChild(n,i),domUtils.remove(n)):n&&"P"==n.tagName&&!domUtils.isEmptyBlock(n)&&n.insertBefore(a,n.firstChild),i&&"P"==i.tagName&&domUtils.isEmptyBlock(i)&&domUtils.remove(i),n&&"P"==n.tagName&&domUtils.isEmptyBlock(n)&&domUtils.remove(n),e.selectNode(a).select(),t.fireEvent("saveScene"))}}))})),t.addListener("keyup",(function(e,a){var n=a.keyCode||a.which;if(13==n){var i,r=t.selection.getRange();(i=domUtils.findParentByTagName(r.startContainer,"p",!0))&&"center"==domUtils.getComputedStyle(i,"text-align")&&domUtils.removeStyle(i,"text-align")}}))},UE.plugins["undo"]=function(){var t,e=this,a=e.options.maxUndoCount||20,n=e.options.maxInputCount||20,i=new RegExp(domUtils.fillChar+"|</hr>","gi"),r={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},s=e.options.autoClearEmptyNode;function o(t,e){if(t.length!=e.length)return 0;for(var a=0,n=t.length;a<n;a++)if(t[a]!=e[a])return 0;return 1}function l(t,e){return t.collapsed!=e.collapsed?0:o(t.startAddress,e.startAddress)&&o(t.endAddress,e.endAddress)?1:0}function u(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&1==this.list.length)return void this.reset();while(this.list[this.index].content==this.list[this.index-1].content)if(this.index--,0==this.index)return this.restore(0);this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},this.restore=function(){var t=this.editor,e=this.list[this.index],a=UE.htmlparser(e.content.replace(i,""));t.options.autoClearEmptyNode=!1,t.filterInputRule(a),t.options.autoClearEmptyNode=s,t.document.body.innerHTML=a.toHtml(),t.fireEvent("afterscencerestore"),browser.ie&&utils.each(domUtils.getElementsByTagName(t.document,"td th caption p"),(function(e){domUtils.isEmptyNode(e)&&domUtils.fillNode(t.document,e)}));try{var n=new dom.Range(t.document).moveToAddress(e.address);n.select(r[n.startContainer.nodeName.toLowerCase()])}catch(o){}this.update(),this.clearKey(),t.fireEvent("reset",!0)},this.getScene=function(){var t=this.editor,e=t.selection.getRange(),a=e.createAddress(!1,!0);t.fireEvent("beforegetscene");var n=UE.htmlparser(t.body.innerHTML);t.options.autoClearEmptyNode=!1,t.filterOutputRule(n),t.options.autoClearEmptyNode=s;var i=n.toHtml();return t.fireEvent("aftergetscene"),{address:a,content:i}},this.save=function(n,i){clearTimeout(t);var r=this.getScene(i),s=this.list[this.index];s&&s.content!=r.content&&e.trigger("contentchange"),s&&s.content==r.content&&(n||l(s.address,r.address))||(this.list=this.list.slice(0,this.index+1),this.list.push(r),this.list.length>a&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){c=0,null}}e.undoManger=new u,e.undoManger.editor=e,e.addListener("saveScene",(function(){var t=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,t)})),e.addListener("reset",(function(t,e){e||this.undoManger.reset()})),e.commands["redo"]=e.commands["undo"]={execCommand:function(t){this.undoManger[t]()},queryCommandState:function(t){return this.undoManger["has"+("undo"==t.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var d={16:1,17:1,18:1,37:1,38:1,39:1,40:1},c=0,p=!1;e.addListener("ready",(function(){domUtils.on(this.body,"compositionstart",(function(){p=!0})),domUtils.on(this.body,"compositionend",(function(){p=!1}))})),e.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var h=!0;e.addListener("keydown",(function(e,a){var i=this,r=a.keyCode||a.which;if(!d[r]&&!a.ctrlKey&&!a.metaKey&&!a.shiftKey&&!a.altKey){var s=function(t){t.undoManger.save(!1,!0),t.fireEvent("selectionchange")};if(p)return;if(!i.selection.getRange().collapsed)return i.undoManger.save(!1,!0),void(h=!1);0==i.undoManger.list.length&&i.undoManger.save(!0),clearTimeout(t),t=setTimeout((function(){if(p)var t=setInterval((function(){p||(s(i),clearInterval(t))}),300);else s(i)}),200),r,c++,c>=n&&s(i)}})),e.addListener("keyup",(function(t,e){var a=e.keyCode||e.which;if(!d[a]&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&!e.altKey){if(p)return;h||(this.undoManger.save(!1,!0),h=!0)}})),e.stopCmdUndo=function(){e.__hasEnterExecCommand=!0},e.startCmdUndo=function(){e.__hasEnterExecCommand=!1}},UE.plugin.register("copy",(function(){var t=this;function e(){ZeroClipboard.config({debug:!1,swfPath:t.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.swf"});var e=t.zeroclipboard=new ZeroClipboard;e.on("copy",(function(e){var a=e.client,n=t.selection.getRange(),i=document.createElement("div");i.appendChild(n.cloneContents()),a.setText(i.innerText||i.textContent),a.setHtml(i.innerHTML),n.select()})),e.on("mouseover mouseout",(function(t){var e=t.target;"mouseover"==t.type?domUtils.addClass(e,"edui-state-hover"):"mouseout"==t.type&&domUtils.removeClasses(e,"edui-state-hover")})),e.on("wrongflash noflash",(function(){ZeroClipboard.destroy()}))}return{bindEvents:{ready:function(){if(!browser.ie){if(!window.ZeroClipboard)return;e()}}},commands:{copy:{execCommand:function(e){t.document.execCommand("copy")||alert(t.getLang("copymsg"))}}}}})),UE.plugins["paste"]=function(){function t(t){var e=this.document;if(!e.getElementById("baidu_pastebin")){var a=this.selection.getRange(),n=a.createBookmark(),i=e.createElement("div");i.id="baidu_pastebin",browser.webkit&&i.appendChild(e.createTextNode(domUtils.fillChar+domUtils.fillChar)),e.body.appendChild(i),n.start.style.display="",i.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(n.start).y+"px",a.selectNodeContents(i).select(!0),setTimeout((function(){if(browser.webkit)for(var r,s=0,o=e.querySelectorAll("#baidu_pastebin");r=o[s++];){if(!domUtils.isEmptyNode(r)){i=r;break}domUtils.remove(r)}try{i.parentNode.removeChild(i)}catch(l){}a.moveToBookmark(n).select(!0),t(i)}),0)}}var e,a,n,i=this;function r(t){return t.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,(function(t,e,a,n){return a=a.toLowerCase(),{img:1}[a]?t:(n=n.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,(function(t,e,a){return{src:1,href:1,name:1}[e.toLowerCase()]?e+"="+a+" ":""})),{span:1,div:1}[a]?"":"<"+e+a+" "+utils.trim(n)+">")}))}function s(t){var s;if(t.firstChild){for(var o,l=domUtils.getElementsByTagName(t,"span"),u=0;o=l[u++];)"_baidu_cut_start"!=o.id&&"_baidu_cut_end"!=o.id||domUtils.remove(o);if(browser.webkit){var d,c=t.querySelectorAll("div br");for(u=0;d=c[u++];){var p=d.parentNode;"DIV"==p.tagName&&1==p.childNodes.length&&(p.innerHTML="<p><br/></p>",domUtils.remove(p))}var h,g=t.querySelectorAll("#baidu_pastebin");for(u=0;h=g[u++];){var f=i.document.createElement("p");h.parentNode.insertBefore(f,h);while(h.firstChild)f.appendChild(h.firstChild);domUtils.remove(h)}var m=t.querySelectorAll("meta");for(u=0;b=m[u++];)domUtils.remove(b);c=t.querySelectorAll("br");for(u=0;b=c[u++];)/^apple-/i.test(b.className)&&domUtils.remove(b)}if(browser.gecko){var v=t.querySelectorAll("[_moz_dirty]");for(u=0;b=v[u++];)b.removeAttribute("_moz_dirty")}if(!browser.ie){var b,y=t.querySelectorAll("span.Apple-style-span");for(u=0;b=y[u++];)domUtils.remove(b,!0)}s=t.innerHTML,s=UE.filterWord(s);var _=UE.htmlparser(s);if(i.options.filterRules&&UE.filterNode(_,i.options.filterRules),i.filterInputRule(_),browser.webkit){var D=_.lastChild();D&&"element"==D.type&&"br"==D.tagName&&_.removeChild(D),utils.each(i.body.querySelectorAll("div"),(function(t){domUtils.isEmptyBlock(t)&&domUtils.remove(t,!0)}))}if(s={html:_.toHtml()},i.fireEvent("beforepaste",s,_),!s.html)return;_=UE.htmlparser(s.html,!0),1===i.queryCommandState("pasteplain")?i.execCommand("insertHtml",UE.filterNode(_,i.options.filterTxtRules).toHtml(),!0):(UE.filterNode(_,i.options.filterTxtRules),e=_.toHtml(),a=s.html,n=i.selection.getRange().createAddress(!0),i.execCommand("insertHtml",!0===i.getOpt("retainOnlyLabelPasted")?r(a):a,!0)),i.fireEvent("afterpaste",s)}}i.setOpt({retainOnlyLabelPasted:!1}),i.addListener("pasteTransfer",(function(t,s){if(n&&e&&a&&e!=a){var o=i.selection.getRange();if(o.moveToAddress(n,!0),!o.collapsed){while(!domUtils.isBody(o.startContainer)){var l=o.startContainer;if(1==l.nodeType){if(l=l.childNodes[o.startOffset],!l){o.setStartBefore(o.startContainer);continue}var u=l.previousSibling;u&&3==u.nodeType&&new RegExp("^[\n\r\t "+domUtils.fillChar+"]*$").test(u.nodeValue)&&o.setStartBefore(u)}if(0!=o.startOffset)break;o.setStartBefore(o.startContainer)}while(!domUtils.isBody(o.endContainer)){var d=o.endContainer;if(1==d.nodeType){if(d=d.childNodes[o.endOffset],!d){o.setEndAfter(o.endContainer);continue}var c=d.nextSibling;c&&3==c.nodeType&&new RegExp("^[\n\r\t"+domUtils.fillChar+"]*$").test(c.nodeValue)&&o.setEndAfter(c)}if(o.endOffset!=o.endContainer[3==o.endContainer.nodeType?"nodeValue":"childNodes"].length)break;o.setEndAfter(o.endContainer)}}o.deleteContents(),o.select(!0),i.__hasEnterExecCommand=!0;var p=a;2===s?p=r(p):s&&(p=e),i.execCommand("inserthtml",p,!0),i.__hasEnterExecCommand=!1;var h=i.selection.getRange();while(!domUtils.isBody(h.startContainer)&&!h.startOffset&&h.startContainer[3==h.startContainer.nodeType?"nodeValue":"childNodes"].length)h.setStartBefore(h.startContainer);var g=h.createAddress(!0);n.endAddress=g.startAddress}})),i.addListener("ready",(function(){domUtils.on(i.body,"cut",(function(){var t=i.selection.getRange();!t.collapsed&&i.undoManger&&i.undoManger.save()})),domUtils.on(i.body,browser.ie||browser.opera?"keydown":"paste",(function(e){(!browser.ie&&!browser.opera||(e.ctrlKey||e.metaKey)&&"86"==e.keyCode)&&t.call(i,(function(t){s(t)}))}))})),i.commands["paste"]={execCommand:function(e){browser.ie?(t.call(i,(function(t){s(t)})),i.document.execCommand("paste")):alert(i.getLang("pastemsg"))}}},UE.plugins["pasteplain"]=function(){var t=this;t.setOpt({pasteplain:!1,filterTxtRules:function(){function t(t){t.tagName="p",t.setStyle()}function e(t){t.parentNode.removeChild(t,!0)}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(t){var e,a=UE.uNode.createElement("p");while(e=t.firstChild())"text"!=e.type&&UE.dom.dtd.$block[e.tagName]?a.firstChild()?(t.parentNode.insertBefore(a,t),a=UE.uNode.createElement("p")):t.parentNode.insertBefore(e,t):a.appendChild(e);a.firstChild()&&t.parentNode.insertBefore(a,t),t.parentNode.removeChild(t)},ol:e,ul:e,dl:e,dt:e,dd:e,li:e,caption:t,th:t,tr:t,h1:t,h2:t,h3:t,h4:t,h5:t,h6:t,td:function(t){var e=!!t.innerText();e&&t.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),t),t.parentNode.removeChild(t,t.innerText())}}}()});var e=t.options.pasteplain;t.commands["pasteplain"]={queryCommandState:function(){return e?1:0},execCommand:function(){e=0|!e},notNeedUndo:1}},UE.plugins["list"]=function(){var t=this,e={TD:1,PRE:1,BLOCKQUOTE:1},a={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};function n(t){var e=[];for(var a in t)e.push(a);return e}t.setOpt({autoTransWordToList:!1,insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1,disablePInList:!1});var i={OL:n(t.options.insertorderedlist),UL:n(t.options.insertunorderedlist)},r=t.options.listiconpath;for(var s in a)t.options.insertorderedlist.hasOwnProperty(s)||t.options.insertunorderedlist.hasOwnProperty(s)||delete a[s];function o(t){var e=t.className;return domUtils.hasClass(t,/custom_/)?e.match(/custom_(\w+)/)[1]:domUtils.getStyle(t,"list-style-type")}function l(t,e){utils.each(domUtils.getElementsByTagName(t,"ol ul"),(function(n){if(domUtils.inDoc(n,t)){var r=n.parentNode;if(r.tagName==n.tagName){var s=o(n)||("OL"==n.tagName?"decimal":"disc"),l=o(r)||("OL"==r.tagName?"decimal":"disc");if(s==l){var c=utils.indexOf(i[n.tagName],s);c=c+1==i[n.tagName].length?0:c+1,d(n,i[n.tagName][c])}}var p=0,h=2;domUtils.hasClass(n,/custom_/)?/[ou]l/i.test(r.tagName)&&domUtils.hasClass(r,/custom_/)||(h=1):/[ou]l/i.test(r.tagName)&&domUtils.hasClass(r,/custom_/)&&(h=3);var g=domUtils.getStyle(n,"list-style-type");g&&(n.style.cssText="list-style-type:"+g),n.className=utils.trim(n.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+h,utils.each(domUtils.getElementsByTagName(n,"li"),(function(t){if(t.style.cssText&&(t.style.cssText=""),t.firstChild){if(t.parentNode===n){if(p++,domUtils.hasClass(n,/custom_/)){var e=1,i=o(n);if("OL"==n.tagName){if(i)switch(i){case"cn":case"cn1":case"cn2":p>10&&(p%10==0||p>10&&p<20)?e=2:p>20&&(e=3);break;case"num2":p>9&&(e=2)}t.className="list-"+a[i]+p+" list-"+i+"-paddingleft-"+e}else t.className="list-"+a[i]+" list-"+i+"-paddingleft"}else t.className=t.className.replace(/list-[\w\-]+/gi,"");var r=t.getAttribute("class");null===r||r.replace(/\s/g,"")||domUtils.removeAttributes(t,"class")}}else domUtils.remove(t)})),!e&&u(n,n.tagName.toLowerCase(),o(n)||domUtils.getStyle(n,"list-style-type"),!0)}}))}function u(t,e,a,n){var i=t.nextSibling;i&&1==i.nodeType&&i.tagName.toLowerCase()==e&&(o(i)||domUtils.getStyle(i,"list-style-type")||("ol"==e?"decimal":"disc"))==a&&(domUtils.moveChild(i,t),0==i.childNodes.length&&domUtils.remove(i)),i&&domUtils.isFillChar(i)&&domUtils.remove(i);var r=t.previousSibling;r&&1==r.nodeType&&r.tagName.toLowerCase()==e&&(o(r)||domUtils.getStyle(r,"list-style-type")||("ol"==e?"decimal":"disc"))==a&&domUtils.moveChild(t,r),r&&domUtils.isFillChar(r)&&domUtils.remove(r),!n&&domUtils.isEmptyBlock(t)&&domUtils.remove(t),o(t)&&l(t.ownerDocument,!0)}function d(t,e){a[e]&&(t.className="custom_"+e);try{domUtils.setStyle(t,"list-style-type",e)}catch(n){}}function c(t){var e=t.previousSibling;e&&domUtils.isEmptyBlock(e)&&domUtils.remove(e),e=t.nextSibling,e&&domUtils.isEmptyBlock(e)&&domUtils.remove(e)}function p(t){while(t&&!domUtils.isBody(t)){if("TABLE"==t.nodeName)return null;if("LI"==t.nodeName)return t;t=t.parentNode}}t.ready((function(){var e=[];for(var n in a){if("dash"==n||"dot"==n)e.push("li.list-"+a[n]+"{background-image:url("+r+a[n]+".gif)}"),e.push("ul.custom_"+n+"{list-style:none;}ul.custom_"+n+" li{background-position:0 3px;background-repeat:no-repeat}");else{for(var i=0;i<99;i++)e.push("li.list-"+a[n]+i+"{background-image:url("+r+"list-"+a[n]+i+".gif)}");e.push("ol.custom_"+n+"{list-style:none;}ol.custom_"+n+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(n){case"cn":e.push("li.list-"+n+"-paddingleft-1{padding-left:25px}"),e.push("li.list-"+n+"-paddingleft-2{padding-left:40px}"),e.push("li.list-"+n+"-paddingleft-3{padding-left:55px}");break;case"cn1":e.push("li.list-"+n+"-paddingleft-1{padding-left:30px}"),e.push("li.list-"+n+"-paddingleft-2{padding-left:40px}"),e.push("li.list-"+n+"-paddingleft-3{padding-left:55px}");break;case"cn2":e.push("li.list-"+n+"-paddingleft-1{padding-left:40px}"),e.push("li.list-"+n+"-paddingleft-2{padding-left:55px}"),e.push("li.list-"+n+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":e.push("li.list-"+n+"-paddingleft-1{padding-left:25px}");break;case"num2":e.push("li.list-"+n+"-paddingleft-1{padding-left:35px}"),e.push("li.list-"+n+"-paddingleft-2{padding-left:40px}");break;case"dash":e.push("li.list-"+n+"-paddingleft{padding-left:35px}");break;case"dot":e.push("li.list-"+n+"-paddingleft{padding-left:20px}")}}e.push(".list-paddingleft-1{padding-left:0}"),e.push(".list-paddingleft-2{padding-left:"+t.options.listDefaultPaddingLeft+"px}"),e.push(".list-paddingleft-3{padding-left:"+2*t.options.listDefaultPaddingLeft+"px}"),utils.cssRule("list","ol,ul{margin:0;pading:0;"+(browser.ie?"":"width:95%")+"}li{clear:both;}"+e.join("\n"),t.document)})),t.ready((function(){domUtils.on(t.body,"cut",(function(){setTimeout((function(){var e,a=t.selection.getRange();if(!a.collapsed&&(e=domUtils.findParentByTagName(a.startContainer,"li",!0))&&!e.nextSibling&&domUtils.isEmptyBlock(e)){var n,i=e.parentNode;if(n=i.previousSibling)domUtils.remove(i),a.setStartAtLast(n).collapse(!0),a.select(!0);else if(n=i.nextSibling)domUtils.remove(i),a.setStartAtFirst(n).collapse(!0),a.select(!0);else{var r=t.document.createElement("p");domUtils.fillNode(t.document,r),i.parentNode.insertBefore(r,i),domUtils.remove(i),a.setStart(r,0).collapse(!0),a.select(!0)}}}))}))})),t.addListener("beforepaste",(function(t,e){var n,r=this,s=r.selection.getRange(),l=UE.htmlparser(e.html,!0);if(n=domUtils.findParentByTagName(s.startContainer,"li",!0)){var u=n.parentNode,d="OL"==u.tagName?"ul":"ol";utils.each(l.getNodesByTagName(d),(function(e){if(e.tagName=u.tagName,e.setAttr(),e.parentNode===l)t=o(u)||("OL"==u.tagName?"decimal":"disc");else{var n=e.parentNode.getAttr("class");t=n&&/custom_/.test(n)?n.match(/custom_(\w+)/)[1]:e.parentNode.getStyle("list-style-type"),t||(t="OL"==u.tagName?"decimal":"disc")}var r=utils.indexOf(i[u.tagName],t);e.parentNode!==l&&(r=r+1==i[u.tagName].length?0:r+1);var s=i[u.tagName][r];a[s]?e.setAttr("class","custom_"+s):e.setStyle("list-style-type",s)}))}e.html=l.toHtml()})),!0===t.getOpt("disablePInList")&&t.addOutputRule((function(t){utils.each(t.getNodesByTagName("li"),(function(t){var e=[],a=0;utils.each(t.children,(function(n){if("p"==n.tagName){var i;while(i=n.children.pop())e.splice(a,0,i),i.parentNode=t,lastNode=i;if(i=e[e.length-1],!i||"element"!=i.type||"br"!=i.tagName){var r=UE.uNode.createElement("br");r.parentNode=t,e.push(r)}a=e.length}})),e.length&&(t.children=e)}))})),t.addInputRule((function(e){if(utils.each(e.getNodesByTagName("li"),(function(t){for(var e,a=UE.uNode.createElement("p"),n=0;e=t.children[n];)"text"==e.type||dtd.p[e.tagName]?a.appendChild(e):a.firstChild()?(t.insertBefore(a,e),a=UE.uNode.createElement("p"),n+=2):n++;(a.firstChild()&&!a.parentNode||!t.firstChild())&&t.appendChild(a),a.firstChild()||a.innerHTML(browser.ie?"&nbsp;":"<br/>");var i=t.firstChild(),r=i.lastChild();r&&"text"==r.type&&/^\s*$/.test(r.data)&&i.removeChild(r)})),t.options.autoTransWordToList){var n=function(t,e){var a=e.firstChild();if(a&&"element"==a.type&&"span"==a.tagName&&/Wingdings|Symbol/.test(a.getStyle("font-family"))){for(var n in r)if(r[n]==a.data)return n;return"disc"}for(var n in i)if(i[n].test(t))return n},i={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},r={square:"n"};utils.each(e.getNodesByTagName("p"),(function(e){if("MsoListParagraph"==e.getAttr("class")){e.setStyle("margin",""),e.setStyle("margin-left",""),e.setAttr("class","");var r,s=e,o=e;if("li"!=e.parentNode.tagName&&(r=n(e.innerText(),e))){var l=UE.uNode.createElement(t.options.insertorderedlist.hasOwnProperty(r)?"ol":"ul");a[r]?l.setAttr("class","custom_"+r):l.setStyle("list-style-type",r);while(e&&"li"!=e.parentNode.tagName&&n(e.innerText(),e))s=e.nextSibling(),s||e.parentNode.insertBefore(l,e),d(l,e,r),e=s;!l.parentNode&&e&&e.parentNode&&e.parentNode.insertBefore(l,e)}var u=o.firstChild();u&&"element"==u.type&&"span"==u.tagName&&/^\s*(&nbsp;)+\s*$/.test(u.innerText())&&u.parentNode.removeChild(u)}function d(t,e,a){if("ol"==t.tagName)if(browser.ie){var n=e.firstChild();"element"==n.type&&"span"==n.tagName&&i[a].test(n.innerText())&&e.removeChild(n)}else e.innerHTML(e.innerHTML().replace(i[a],""));else e.removeChild(e.firstChild());var r=UE.uNode.createElement("li");r.appendChild(e),t.appendChild(r)}}))}})),t.addListener("contentchange",(function(){l(t.document)})),t.addListener("keydown",(function(e,a){function n(){a.preventDefault?a.preventDefault():a.returnValue=!1,t.fireEvent("contentchange"),t.undoManger&&t.undoManger.save()}function i(t,e){while(t&&!domUtils.isBody(t)){if(e(t))return null;if(1==t.nodeType&&/[ou]l/i.test(t.tagName))return t;t=t.parentNode}return null}var r=a.keyCode||a.which;if(13==r&&!a.shiftKey){var s=t.selection.getRange(),o=domUtils.findParent(s.startContainer,(function(t){return domUtils.isBlockElm(t)}),!0),l=domUtils.findParentByTagName(s.startContainer,"li",!0);if(o&&"PRE"!=o.tagName&&!l){var u=o.innerHTML.replace(new RegExp(domUtils.fillChar,"g"),"");/^\s*1\s*\.[^\d]/.test(u)&&(o.innerHTML=u.replace(/^\s*1\s*\./,""),s.setStartAtLast(o).collapse(!0).select(),t.__hasEnterExecCommand=!0,t.execCommand("insertorderedlist"),t.__hasEnterExecCommand=!1)}var d=t.selection.getRange(),p=i(d.startContainer,(function(t){return"TABLE"==t.tagName})),h=d.collapsed?p:i(d.endContainer,(function(t){return"TABLE"==t.tagName}));if(p&&h&&p===h){if(!d.collapsed){if(p=domUtils.findParentByTagName(d.startContainer,"li",!0),h=domUtils.findParentByTagName(d.endContainer,"li",!0),!p||!h||p!==h){var g=d.cloneRange(),f=g.collapse(!1).createBookmark();d.deleteContents(),g.moveToBookmark(f);l=domUtils.findParentByTagName(g.startContainer,"li",!0);return c(l),g.select(),void n()}if(d.deleteContents(),l=domUtils.findParentByTagName(d.startContainer,"li",!0),l&&domUtils.isEmptyBlock(l))return D=l.previousSibling,next=l.nextSibling,b=t.document.createElement("p"),domUtils.fillNode(t.document,b),m=l.parentNode,D&&next?(d.setStart(next,0).collapse(!0).select(!0),domUtils.remove(l)):((D||next)&&D?l.parentNode.parentNode.insertBefore(b,m.nextSibling):m.parentNode.insertBefore(b,m),domUtils.remove(l),m.firstChild||domUtils.remove(m),d.setStart(b,0).setCursor()),void n()}if(l=domUtils.findParentByTagName(d.startContainer,"li",!0),l){if(domUtils.isEmptyBlock(l)){f=d.createBookmark();var m=l.parentNode;if(l!==m.lastChild?(domUtils.breakParent(l,m),c(l)):(m.parentNode.insertBefore(l,m.nextSibling),domUtils.isEmptyNode(m)&&domUtils.remove(m)),!dtd.$list[l.parentNode.tagName])if(domUtils.isBlockElm(l.firstChild))domUtils.remove(l,!0);else{b=t.document.createElement("p"),l.parentNode.insertBefore(b,l);while(l.firstChild)b.appendChild(l.firstChild);domUtils.remove(l)}d.moveToBookmark(f).select()}else{var v=l.firstChild;if(!v||!domUtils.isBlockElm(v)){var b=t.document.createElement("p");!l.firstChild&&domUtils.fillNode(t.document,b);while(l.firstChild)b.appendChild(l.firstChild);l.appendChild(b),v=b}var y=t.document.createElement("span");d.insertNode(y),domUtils.breakParent(y,l);var _=y.nextSibling;v=_.firstChild,v||(b=t.document.createElement("p"),domUtils.fillNode(t.document,b),_.appendChild(b),v=b),domUtils.isEmptyNode(v)&&(v.innerHTML="",domUtils.fillNode(t.document,v)),d.setStart(v,0).collapse(!0).shrinkBoundary().select(),domUtils.remove(y);var D=_.previousSibling;D&&domUtils.isEmptyBlock(D)&&(D.innerHTML="<p></p>",domUtils.fillNode(t.document,D.firstChild))}n()}}}if(8==r&&(d=t.selection.getRange(),d.collapsed&&domUtils.isStartInblock(d)&&(g=d.cloneRange().trimBoundary(),l=domUtils.findParentByTagName(d.startContainer,"li",!0),l&&domUtils.isStartInblock(g)))){if(p=domUtils.findParentByTagName(d.startContainer,"p",!0),p&&p!==l.firstChild){m=domUtils.findParentByTagName(p,["ol","ul"]);return domUtils.breakParent(p,m),c(p),t.fireEvent("contentchange"),d.setStart(p,0).setCursor(!1,!0),t.fireEvent("saveScene"),void domUtils.preventDefault(a)}if(l&&(D=l.previousSibling)){if(46==r&&l.childNodes.length)return;if(dtd.$list[D.tagName]&&(D=D.lastChild),t.undoManger&&t.undoManger.save(),v=l.firstChild,domUtils.isBlockElm(v))if(domUtils.isEmptyNode(v)){D.appendChild(v),d.setStart(v,0).setCursor(!1,!0);while(l.firstChild)D.appendChild(l.firstChild)}else y=t.document.createElement("span"),d.insertNode(y),domUtils.isEmptyBlock(D)&&(D.innerHTML=""),domUtils.moveChild(l,D),d.setStartBefore(y).collapse(!0).select(!0),domUtils.remove(y);else if(domUtils.isEmptyNode(l)){b=t.document.createElement("p");D.appendChild(b),d.setStart(b,0).setCursor()}else{d.setEnd(D,D.childNodes.length).collapse().select(!0);while(l.firstChild)D.appendChild(l.firstChild)}return domUtils.remove(l),t.fireEvent("contentchange"),t.fireEvent("saveScene"),void domUtils.preventDefault(a)}if(l&&!l.previousSibling){m=l.parentNode,f=d.createBookmark();if(domUtils.isTagNode(m.parentNode,"ol ul"))m.parentNode.insertBefore(l,m),domUtils.isEmptyNode(m)&&domUtils.remove(m);else{while(l.firstChild)m.parentNode.insertBefore(l.firstChild,m);domUtils.remove(l),domUtils.isEmptyNode(m)&&domUtils.remove(m)}return d.moveToBookmark(f).setCursor(!1,!0),t.fireEvent("contentchange"),t.fireEvent("saveScene"),void domUtils.preventDefault(a)}}})),t.addListener("keyup",(function(e,a){var n=a.keyCode||a.which;if(8==n){var i,r=t.selection.getRange();(i=domUtils.findParentByTagName(r.startContainer,["ol","ul"],!0))&&u(i,i.tagName.toLowerCase(),o(i)||domUtils.getComputedStyle(i,"list-style-type"),!0)}})),t.addListener("tabkeydown",(function(){var e=t.selection.getRange();function a(e){if(-1!=t.options.maxListLevel){var a=e.parentNode,n=0;while(/[ou]l/i.test(a.tagName))n++,a=a.parentNode;if(n>=t.options.maxListLevel)return!0}}var n=domUtils.findParentByTagName(e.startContainer,"li",!0);if(n){var r;if(!e.collapsed){t.fireEvent("saveScene"),r=e.createBookmark();for(var s,l,c=0,p=domUtils.findParents(n);l=p[c++];)if(domUtils.isTagNode(l,"ol ul")){s=l;break}var h=n;if(r.end)while(h&&!(domUtils.getPosition(h,r.end)&domUtils.POSITION_FOLLOWING))if(a(h))h=domUtils.getNextDomNode(h,!1,null,(function(t){return t!==s}));else{f=h.parentNode,m=t.document.createElement(f.tagName),v=utils.indexOf(i[m.tagName],o(f)||domUtils.getComputedStyle(f,"list-style-type"));var g=v+1==i[m.tagName].length?0:v+1;b=i[m.tagName][g];d(m,b),f.insertBefore(m,h);while(h&&!(domUtils.getPosition(h,r.end)&domUtils.POSITION_FOLLOWING)){if(n=h.nextSibling,m.appendChild(h),!n||domUtils.isTagNode(n,"ol ul")){if(n){while(n=n.firstChild)if("LI"==n.tagName)break}else n=domUtils.getNextDomNode(h,!1,null,(function(t){return t!==s}));break}h=n}u(m,m.tagName.toLowerCase(),b),h=n}return t.fireEvent("contentchange"),e.moveToBookmark(r).select(),!0}if(a(n))return!0;var f=n.parentNode,m=t.document.createElement(f.tagName),v=utils.indexOf(i[m.tagName],o(f)||domUtils.getComputedStyle(f,"list-style-type"));v=v+1==i[m.tagName].length?0:v+1;var b=i[m.tagName][v];if(d(m,b),domUtils.isStartInblock(e))return t.fireEvent("saveScene"),r=e.createBookmark(),f.insertBefore(m,n),m.appendChild(n),u(m,m.tagName.toLowerCase(),b),t.fireEvent("contentchange"),e.moveToBookmark(r).select(!0),!0}})),t.commands["insertorderedlist"]=t.commands["insertunorderedlist"]={execCommand:function(t,a){a||(a="insertorderedlist"==t.toLowerCase()?"decimal":"disc");var n=this,i=this.selection.getRange(),r=function(t){return 1==t.nodeType?"br"!=t.tagName.toLowerCase():!domUtils.isWhitespace(t)},s="insertorderedlist"==t.toLowerCase()?"ol":"ul",l=n.document.createDocumentFragment();i.adjustmentBoundary().shrinkBoundary();var c,h,g,f,m=i.createBookmark(!0),v=p(n.document.getElementById(m.start)),b=0,y=p(n.document.getElementById(m.end)),_=0;if(v||y){if(v&&(c=v.parentNode),m.end||(y=v),y&&(h=y.parentNode),c===h){while(v!==y){if(f=v,v=v.nextSibling,!domUtils.isBlockElm(f.firstChild)){var D=n.document.createElement("p");while(f.firstChild)D.appendChild(f.firstChild);f.appendChild(D)}l.appendChild(f)}if(f=n.document.createElement("span"),c.insertBefore(f,y),!domUtils.isBlockElm(y.firstChild)){D=n.document.createElement("p");while(y.firstChild)D.appendChild(y.firstChild);y.appendChild(D)}l.appendChild(y),domUtils.breakParent(f,c),domUtils.isEmptyNode(f.previousSibling)&&domUtils.remove(f.previousSibling),domUtils.isEmptyNode(f.nextSibling)&&domUtils.remove(f.nextSibling);var C=o(c)||domUtils.getComputedStyle(c,"list-style-type")||("insertorderedlist"==t.toLowerCase()?"decimal":"disc");if(c.tagName.toLowerCase()==s&&C==a){for(var w=0,x=n.document.createDocumentFragment();O=l.firstChild;)if(domUtils.isTagNode(O,"ol ul"))x.appendChild(O);else while(O.firstChild)x.appendChild(O.firstChild),domUtils.remove(O);f.parentNode.insertBefore(x,f)}else g=n.document.createElement(s),d(g,a),g.appendChild(l),f.parentNode.insertBefore(g,f);return domUtils.remove(f),g&&u(g,s,a),void i.moveToBookmark(m).select()}if(v){while(v){if(f=v.nextSibling,domUtils.isTagNode(v,"ol ul"))l.appendChild(v);else{var k=n.document.createDocumentFragment(),S=0;while(v.firstChild)domUtils.isBlockElm(v.firstChild)&&(S=1),k.appendChild(v.firstChild);if(S)l.appendChild(k);else{var A=n.document.createElement("p");A.appendChild(k),l.appendChild(A)}domUtils.remove(v)}v=f}c.parentNode.insertBefore(l,c.nextSibling),domUtils.isEmptyNode(c)?(i.setStartBefore(c),domUtils.remove(c)):i.setStartAfter(c),b=1}if(y&&domUtils.inDoc(h,n.document)){v=h.firstChild;while(v&&v!==y){if(f=v.nextSibling,domUtils.isTagNode(v,"ol ul"))l.appendChild(v);else{k=n.document.createDocumentFragment(),S=0;while(v.firstChild)domUtils.isBlockElm(v.firstChild)&&(S=1),k.appendChild(v.firstChild);S?l.appendChild(k):(A=n.document.createElement("p"),A.appendChild(k),l.appendChild(A)),domUtils.remove(v)}v=f}var E=domUtils.createElement(n.document,"div",{tmpDiv:1});domUtils.moveChild(y,E),l.appendChild(E),domUtils.remove(y),h.parentNode.insertBefore(l,h),i.setEndBefore(h),domUtils.isEmptyNode(h)&&domUtils.remove(h),_=1}}b||i.setStartBefore(n.document.getElementById(m.start)),m.end&&!_&&i.setEndAfter(n.document.getElementById(m.end)),i.enlarge(!0,(function(t){return e[t.tagName]})),l=n.document.createDocumentFragment();var T=i.createBookmark(),I=domUtils.getNextDomNode(T.start,!1,r),P=i.cloneRange(),N=domUtils.isBlockElm;while(I&&I!==T.end&&domUtils.getPosition(I,T.end)&domUtils.POSITION_PRECEDING)if(3==I.nodeType||dtd.li[I.tagName]){if(1==I.nodeType&&dtd.$list[I.tagName]){while(I.firstChild)l.appendChild(I.firstChild);B=domUtils.getNextDomNode(I,!1,r),domUtils.remove(I),I=B;continue}B=I,P.setStartBefore(I);while(I&&I!==T.end&&(!N(I)||domUtils.isBookmarkNode(I)))B=I,I=domUtils.getNextDomNode(I,!1,null,(function(t){return!e[t.tagName]}));I&&N(I)&&(f=domUtils.getNextDomNode(B,!1,r),f&&domUtils.isBookmarkNode(f)&&(I=domUtils.getNextDomNode(f,!1,r),B=f)),P.setEndAfter(B),I=domUtils.getNextDomNode(B,!1,r);var R=i.document.createElement("li");if(R.appendChild(P.extractContents()),domUtils.isEmptyNode(R)){var B=i.document.createElement("p");while(R.firstChild)B.appendChild(R.firstChild);R.appendChild(B)}l.appendChild(R)}else I=domUtils.getNextDomNode(I,!0,r);i.moveToBookmark(T).collapse(!0),g=n.document.createElement(s),d(g,a),g.appendChild(l),i.insertNode(g),u(g,s,a);w=0;for(var O,M=domUtils.getElementsByTagName(g,"div");O=M[w++];)O.getAttribute("tmpDiv")&&domUtils.remove(O,!0);i.moveToBookmark(m).select()},queryCommandState:function(t){for(var e,a="insertorderedlist"==t.toLowerCase()?"ol":"ul",n=this.selection.getStartElementPath(),i=0;e=n[i++];){if("TABLE"==e.nodeName)return 0;if(a==e.nodeName.toLowerCase())return 1}return 0},queryCommandValue:function(t){for(var e,a,n="insertorderedlist"==t.toLowerCase()?"ol":"ul",i=this.selection.getStartElementPath(),r=0;a=i[r++];){if("TABLE"==a.nodeName){e=null;break}if(n==a.nodeName.toLowerCase()){e=a;break}}return e?o(e)||domUtils.getComputedStyle(e,"list-style-type"):null}}},function(){var t={textarea:function(t,e){var a=e.ownerDocument.createElement("textarea");return a.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",browser.ie&&browser.version<8&&(a.style.width=e.offsetWidth+"px",a.style.height=e.offsetHeight+"px",e.onresize=function(){a.style.width=e.offsetWidth+"px",a.style.height=e.offsetHeight+"px"}),e.appendChild(a),{setContent:function(t){a.value=t},getContent:function(){return a.value},select:function(){var t;browser.ie?(t=a.createTextRange(),t.collapse(!0),t.select()):(a.setSelectionRange(0,0),a.focus())},dispose:function(){e.removeChild(a),e.onresize=null,a=null,e=null}}},codemirror:function(t,e){var a=window.CodeMirror(e,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),n=a.getWrapperElement();return n.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',a.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",a.refresh(),{getCodeMirror:function(){return a},setContent:function(t){a.setValue(t)},getContent:function(){return a.getValue()},select:function(){a.focus()},dispose:function(){e.removeChild(n),n=null,a=null}}}};UE.plugins["source"]=function(){var e,a,n,i,r,s=this,o=this.options,l=!1;function u(e){return t["codemirror"==o.sourceEditor&&window.CodeMirror?"codemirror":"textarea"](s,e)}o.sourceEditor=browser.ie?"textarea":o.sourceEditor||"codemirror",s.setOpt({sourceEditorFirst:!1}),s.commands["source"]={execCommand:function(){if(l=!l,l){r=s.selection.getRange().createAddress(!1,!0),s.undoManger&&s.undoManger.save(!0),browser.gecko&&(s.body.contentEditable=!1),n=s.iframe.style.cssText,s.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;",s.fireEvent("beforegetcontent");var t=UE.htmlparser(s.body.innerHTML);s.filterOutputRule(t),t.traversal((function(t){if("element"==t.type)switch(t.tagName){case"td":case"th":case"caption":t.children&&1==t.children.length&&"br"==t.firstChild().tagName&&t.removeChild(t.firstChild());break;case"pre":t.innerText(t.innerText().replace(/&nbsp;/g," "))}})),s.fireEvent("aftergetcontent");var o=t.toHtml(!0);e=u(s.iframe.parentNode),e.setContent(o),a=s.setContent,s.setContent=function(t){var a=UE.htmlparser(t);s.filterInputRule(a),t=a.toHtml(),e.setContent(t)},setTimeout((function(){e.select(),s.addListener("fullscreenchanged",(function(){try{e.getCodeMirror().refresh()}catch(t){}}))})),i=s.getContent,s.getContent=function(){return e.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>"}}else{s.iframe.style.cssText=n;var d=e.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";d=d.replace(new RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>","g"),(function(t,e){return e&&!dtd.$inlineWithA[e.toLowerCase()]?t.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,""):t.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,"")})),s.setContent=a,s.setContent(d),e.dispose(),e=null,s.getContent=i;var c=s.body.firstChild;if(c||(s.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",c=s.body.firstChild),s.undoManger&&s.undoManger.save(!0),browser.gecko){var p=document.createElement("input");p.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(p),s.body.contentEditable=!1,setTimeout((function(){domUtils.setViewportOffset(p,{left:-32768,top:0}),p.focus(),setTimeout((function(){s.body.contentEditable=!0,s.selection.getRange().moveToAddress(r).select(!0),domUtils.remove(p)}))}))}else try{s.selection.getRange().moveToAddress(r).select(!0)}catch(h){}}this.fireEvent("sourcemodechanged",l)},queryCommandState:function(){return 0|l},notNeedUndo:1};var d=s.queryCommandState;s.queryCommandState=function(t){return t=t.toLowerCase(),l?t in{source:1,fullscreen:1}?1:-1:d.apply(this,arguments)},o.sourceEditor}}(),UE.plugins["enterkey"]=function(){var t,e=this,a=e.options.enterTag;e.addListener("keyup",(function(a,n){var i=n.keyCode||n.which;if(13==i){var r,s=e.selection.getRange(),o=s.startContainer;if(browser.ie)e.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(t)){if(browser.gecko){var l=domUtils.findParentByTagName(o,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0);l||(e.document.execCommand("formatBlock",!1,"<p>"),r=1)}else if(1==o.nodeType){var u,d=e.document.createTextNode("");if(s.insertNode(d),u=domUtils.findParentByTagName(d,"div",!0),u){var c=e.document.createElement("p");while(u.firstChild)c.appendChild(u.firstChild);u.parentNode.insertBefore(c,u),domUtils.remove(u),s.setStartBefore(d).setCursor(),r=1}domUtils.remove(d)}e.undoManger&&r&&e.undoManger.save()}browser.opera&&s.select()}}})),e.addListener("keydown",(function(n,i){var r=i.keyCode||i.which;if(13==r){if(e.fireEvent("beforeenterkeydown"))return void domUtils.preventDefault(i);e.fireEvent("saveScene",!0,!0),t="";var s=e.selection.getRange();if(!s.collapsed){var o=s.startContainer,l=s.endContainer,u=domUtils.findParentByTagName(o,"td",!0),d=domUtils.findParentByTagName(l,"td",!0);if(u&&d&&u!==d||!u&&d||u&&!d)return void(i.preventDefault?i.preventDefault():i.returnValue=!1)}if("p"==a)browser.ie||(o=domUtils.findParentByTagName(s.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),o||browser.opera?(t=o.tagName,"p"==o.tagName.toLowerCase()&&browser.gecko&&domUtils.removeDirtyAttr(o)):(e.document.execCommand("formatBlock",!1,"<p>"),browser.gecko&&(s=e.selection.getRange(),o=domUtils.findParentByTagName(s.startContainer,"p",!0),o&&domUtils.removeDirtyAttr(o))));else if(i.preventDefault?i.preventDefault():i.returnValue=!1,s.collapsed){p=s.document.createElement("br"),s.insertNode(p);var c=p.parentNode;c.lastChild===p?(p.parentNode.insertBefore(p.cloneNode(!0),p),s.setStartBefore(p)):s.setStartAfter(p),s.setCursor()}else if(s.deleteContents(),o=s.startContainer,1==o.nodeType&&(o=o.childNodes[s.startOffset])){while(1==o.nodeType){if(dtd.$empty[o.tagName])return s.setStartBefore(o).setCursor(),e.undoManger&&e.undoManger.save(),!1;if(!o.firstChild){var p=s.document.createElement("br");return o.appendChild(p),s.setStart(o,0).setCursor(),e.undoManger&&e.undoManger.save(),!1}o=o.firstChild}o===s.startContainer.childNodes[s.startOffset]?(p=s.document.createElement("br"),s.insertNode(p).setCursor()):s.setStart(o,0).setCursor()}else p=s.document.createElement("br"),s.insertNode(p).setStartAfter(p).setCursor()}}))},UE.plugins["keystrokes"]=function(){var t=this,e=!0;t.addListener("keydown",(function(a,n){var i=n.keyCode||n.which,r=t.selection.getRange();if(!r.collapsed&&!(n.ctrlKey||n.shiftKey||n.altKey||n.metaKey)&&(i>=65&&i<=90||i>=48&&i<=57||i>=96&&i<=111||{13:1,8:1,46:1}[i])){var s=r.startContainer;if(domUtils.isFillChar(s)&&r.setStartBefore(s),s=r.endContainer,domUtils.isFillChar(s)&&r.setEndAfter(s),r.txtToElmBoundary(),r.endContainer&&1==r.endContainer.nodeType&&(s=r.endContainer.childNodes[r.endOffset],s&&domUtils.isBr(s)&&r.setEndAfter(s)),0==r.startOffset&&(s=r.startContainer,domUtils.isBoundaryNode(s,"firstChild")&&(s=r.endContainer,r.endOffset==(3==s.nodeType?s.nodeValue.length:s.childNodes.length)&&domUtils.isBoundaryNode(s,"lastChild"))))return t.fireEvent("saveScene"),t.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",r.setStart(t.body.firstChild,0).setCursor(!1,!0),void t._selectionChange()}if(i==keymap.Backspace){if(r=t.selection.getRange(),e=r.collapsed,t.fireEvent("delkeydown",n))return;var o,l;if(r.collapsed&&r.inFillChar()&&(o=r.startContainer,domUtils.isFillChar(o)?(r.setStartBefore(o).shrinkBoundary(!0).collapse(!0),domUtils.remove(o)):(o.nodeValue=o.nodeValue.replace(new RegExp("^"+domUtils.fillChar),""),r.startOffset--,r.collapse(!0).select(!0))),o=r.getClosedNode())return t.fireEvent("saveScene"),r.setStartBefore(o),domUtils.remove(o),r.setCursor(),t.fireEvent("saveScene"),void domUtils.preventDefault(n);if(!browser.ie&&(o=domUtils.findParentByTagName(r.startContainer,"table",!0),l=domUtils.findParentByTagName(r.endContainer,"table",!0),o&&!l||!o&&l||o!==l))return void n.preventDefault()}if(i==keymap.Tab){var u={ol:1,ul:1,table:1};if(t.fireEvent("tabkeydown",n))return void domUtils.preventDefault(n);var d=t.selection.getRange();t.fireEvent("saveScene");for(var c=0,p="",h=t.options.tabSize||4,g=t.options.tabNode||"&nbsp;";c<h;c++)p+=g;var f=t.document.createElement("span");if(f.innerHTML=p+domUtils.fillChar,d.collapsed)d.insertNode(f.cloneNode(!0).firstChild).setCursor(!0);else{var m=function(t){return domUtils.isBlockElm(t)&&!u[t.tagName.toLowerCase()]};if(o=domUtils.findParent(d.startContainer,m,!0),l=domUtils.findParent(d.endContainer,m,!0),o&&l&&o===l)d.deleteContents(),d.insertNode(f.cloneNode(!0).firstChild).setCursor(!0);else{var v=d.createBookmark();d.enlarge(!0);var b=d.createBookmark(),y=domUtils.getNextDomNode(b.start,!1,m);while(y&&!(domUtils.getPosition(y,b.end)&domUtils.POSITION_FOLLOWING))y.insertBefore(f.cloneNode(!0).firstChild,y.firstChild),y=domUtils.getNextDomNode(y,!1,m);d.moveToBookmark(b).moveToBookmark(v).select()}}domUtils.preventDefault(n)}if(browser.gecko&&46==i&&(d=t.selection.getRange(),d.collapsed&&(o=d.startContainer,domUtils.isEmptyBlock(o)))){var _=o.parentNode;while(1==domUtils.getChildCount(_)&&!domUtils.isBody(_))o=_,_=_.parentNode;o===_.lastChild&&n.preventDefault()}else;})),t.addListener("keyup",(function(t,a){var n,i=a.keyCode||a.which,r=this;if(i==keymap.Backspace){if(r.fireEvent("delkeyup"))return;if(n=r.selection.getRange(),n.collapsed){var s=["h1","h2","h3","h4","h5","h6"];if((u=domUtils.findParentByTagName(n.startContainer,s,!0))&&domUtils.isEmptyBlock(u)){var o=u.previousSibling;if(o&&"TABLE"!=o.nodeName)return domUtils.remove(u),void n.setStartAtLast(o).setCursor(!1,!0);var l=u.nextSibling;if(l&&"TABLE"!=l.nodeName)return domUtils.remove(u),void n.setStartAtFirst(l).setCursor(!1,!0)}if(domUtils.isBody(n.startContainer)){var u=domUtils.createElement(r.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});n.insertNode(u).setStart(u,0).setCursor(!1,!0)}}if(!e&&(3==n.startContainer.nodeType||1==n.startContainer.nodeType&&domUtils.isEmptyBlock(n.startContainer)))if(browser.ie){var d=n.document.createElement("span");n.insertNode(d).setStartBefore(d).collapse(!0),n.select(),domUtils.remove(d)}else n.select()}}))},UE.plugins["fiximgclick"]=function(){var t=!1;function e(){this.editor=null,this.resizer=null,this.cover=null,this.doc=document,this.prePos={x:0,y:0},this.startPos={x:0,y:0}}return function(){var a=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];e.prototype={init:function(t){var e=this;e.editor=t,e.startPos=this.prePos={x:0,y:0},e.dragId=-1;var a=[],n=e.cover=document.createElement("div"),r=e.resizer=document.createElement("div");for(n.id=e.editor.ui.id+"_imagescale_cover",n.style.cssText="position:absolute;display:none;z-index:"+e.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;",domUtils.on(n,"mousedown click",(function(){e.hide()})),i=0;i<8;i++)a.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');r.id=e.editor.ui.id+"_imagescale",r.className="edui-editor-imagescale",r.innerHTML=a.join(""),r.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+e.editor.options.zIndex+";",e.editor.ui.getDom().appendChild(n),e.editor.ui.getDom().appendChild(r),e.initStyle(),e.initEvents()},initStyle:function(){utils.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},initEvents:function(){var t=this;t.startPos.x=t.startPos.y=0,t.isDraging=!1},_eventHandler:function(e){var a=this;switch(e.type){case"mousedown":var n=e.target||e.srcElement;-1!=n.className.indexOf("edui-editor-imagescale-hand")&&-1==a.dragId&&(a.dragId=n.className.slice(-1),a.startPos.x=a.prePos.x=e.clientX,a.startPos.y=a.prePos.y=e.clientY,domUtils.on(a.doc,"mousemove",a.proxy(a._eventHandler,a)));break;case"mousemove":-1!=a.dragId&&(a.updateContainerStyle(a.dragId,{x:e.clientX-a.prePos.x,y:e.clientY-a.prePos.y}),a.prePos.x=e.clientX,a.prePos.y=e.clientY,t=!0,a.updateTargetElement());break;case"mouseup":-1!=a.dragId&&(a.updateContainerStyle(a.dragId,{x:e.clientX-a.prePos.x,y:e.clientY-a.prePos.y}),a.updateTargetElement(),a.target.parentNode&&a.attachTo(a.target),a.dragId=-1),domUtils.un(a.doc,"mousemove",a.proxy(a._eventHandler,a)),t&&(t=!1,a.editor.fireEvent("contentchange"));break;default:break}},updateTargetElement:function(){var t=this;domUtils.setStyles(t.target,{width:t.resizer.style.width,height:t.resizer.style.height}),t.target.width=parseInt(t.resizer.style.width),t.target.height=parseInt(t.resizer.style.height),t.attachTo(t.target)},updateContainerStyle:function(t,e){var n,i=this,r=i.resizer;0!=a[t][0]&&(n=parseInt(r.style.left)+e.x,r.style.left=i._validScaledProp("left",n)+"px"),0!=a[t][1]&&(n=parseInt(r.style.top)+e.y,r.style.top=i._validScaledProp("top",n)+"px"),0!=a[t][2]&&(n=r.clientWidth+a[t][2]*e.x,r.style.width=i._validScaledProp("width",n)+"px"),0!=a[t][3]&&(n=r.clientHeight+a[t][3]*e.y,r.style.height=i._validScaledProp("height",n)+"px")},_validScaledProp:function(t,e){var a=this.resizer,n=document;switch(e=isNaN(e)?0:e,t){case"left":return e<0?0:e+a.clientWidth>n.clientWidth?n.clientWidth-a.clientWidth:e;case"top":return e<0?0:e+a.clientHeight>n.clientHeight?n.clientHeight-a.clientHeight:e;case"width":return e<=0?1:e+a.offsetLeft>n.clientWidth?n.clientWidth-a.offsetLeft:e;case"height":return e<=0?1:e+a.offsetTop>n.clientHeight?n.clientHeight-a.offsetTop:e}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var t=this,e=domUtils.getXY(t.editor.ui.getDom()),a=domUtils.getXY(t.editor.iframe);domUtils.setStyles(t.cover,{width:t.editor.iframe.offsetWidth+"px",height:t.editor.iframe.offsetHeight+"px",top:a.y-e.y+"px",left:a.x-e.x+"px",position:"absolute",display:""})},show:function(t){var e=this;e.resizer.style.display="block",t&&e.attachTo(t),domUtils.on(this.resizer,"mousedown",e.proxy(e._eventHandler,e)),domUtils.on(e.doc,"mouseup",e.proxy(e._eventHandler,e)),e.showCover(),e.editor.fireEvent("afterscaleshow",e),e.editor.fireEvent("saveScene")},hide:function(){var t=this;t.hideCover(),t.resizer.style.display="none",domUtils.un(t.resizer,"mousedown",t.proxy(t._eventHandler,t)),domUtils.un(t.doc,"mouseup",t.proxy(t._eventHandler,t)),t.editor.fireEvent("afterscalehide",t)},proxy:function(t,e){return function(a){return t.apply(e||this,arguments)}},attachTo:function(t){var e=this,a=e.target=t,n=this.resizer,i=domUtils.getXY(a),r=domUtils.getXY(e.editor.iframe),s=domUtils.getXY(n.parentNode);domUtils.setStyles(n,{width:a.width+"px",height:a.height+"px",left:r.x+i.x-e.editor.document.body.scrollLeft-s.x-parseInt(n.style.borderLeftWidth)+"px",top:r.y+i.y-e.editor.document.body.scrollTop-s.y-parseInt(n.style.borderTopWidth)+"px"})}}}(),function(){var t,a=this;a.setOpt("imageScaleEnabled",!0),!browser.ie&&a.options.imageScaleEnabled&&a.addListener("click",(function(n,i){var r=a.selection.getRange(),s=r.getClosedNode();if(s&&"IMG"==s.tagName&&"false"!=a.body.contentEditable){if(-1!=s.className.indexOf("edui-faked-music")||s.getAttribute("anchorname")||domUtils.hasClass(s,"loadingclass")||domUtils.hasClass(s,"loaderrorclass"))return;if(!t){t=new e,t.init(a),a.ui.getDom().appendChild(t.resizer);var o,l=function(e){t.hide(),t.target&&a.selection.getRange().selectNode(t.target).select()},u=function(t){var e=t.target||t.srcElement;!e||void 0!==e.className&&-1!=e.className.indexOf("edui-editor-imagescale")||l(t)};a.addListener("afterscaleshow",(function(t){a.addListener("beforekeydown",l),a.addListener("beforemousedown",u),domUtils.on(document,"keydown",l),domUtils.on(document,"mousedown",u),a.selection.getNative().removeAllRanges()})),a.addListener("afterscalehide",(function(e){a.removeListener("beforekeydown",l),a.removeListener("beforemousedown",u),domUtils.un(document,"keydown",l),domUtils.un(document,"mousedown",u);var n=t.target;n.parentNode&&a.selection.getRange().selectNode(n).select()})),domUtils.on(t.resizer,"mousedown",(function(e){a.selection.getNative().removeAllRanges();var n=e.target||e.srcElement;n&&-1==n.className.indexOf("edui-editor-imagescale-hand")&&(o=setTimeout((function(){t.hide(),t.target&&a.selection.getRange().selectNode(n).select()}),200))})),domUtils.on(t.resizer,"mouseup",(function(t){var e=t.target||t.srcElement;e&&-1==e.className.indexOf("edui-editor-imagescale-hand")&&clearTimeout(o)}))}t.show(s)}else t&&"none"!=t.resizer.style.display&&t.hide()})),browser.webkit&&a.addListener("click",(function(t,e){if("IMG"==e.target.tagName&&"false"!=a.body.contentEditable){var n=new dom.Range(a.document);n.selectNode(e.target).select()}}))}}(),UE.plugin.register("autolink",(function(){return browser.ie?{}:{bindEvents:{reset:function(){0},keydown:function(t,e){var a=this,n=e.keyCode||e.which;if(32==n||13==n){var i,r,s=a.selection.getNative(),o=s.getRangeAt(0).cloneRange(),l=o.startContainer;while(1==l.nodeType&&o.startOffset>0){if(l=o.startContainer.childNodes[o.startOffset-1],!l)break;o.setStart(l,1==l.nodeType?l.childNodes.length:l.nodeValue.length),o.collapse(!0),l=o.startContainer}do{if(0==o.startOffset){l=o.startContainer.previousSibling;while(l&&1==l.nodeType)l=l.lastChild;if(!l||domUtils.isFillChar(l))break;i=l.nodeValue.length}else l=o.startContainer,i=o.startOffset;o.setStart(l,i-1),r=o.toString().charCodeAt(0)}while(160!=r&&32!=r);if(o.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(o.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(o.toString()))break;try{o.setStart(o.startContainer,o.startOffset+1)}catch(p){l=o.startContainer;while(!(next=l.nextSibling)){if(domUtils.isBody(l))return;l=l.parentNode}o.setStart(next,0)}}if(domUtils.findParentByTagName(o.startContainer,"a",!0))return;var u,d=a.document.createElement("a"),c=a.document.createTextNode(" ");a.undoManger&&a.undoManger.save(),d.appendChild(o.extractContents()),d.href=d.innerHTML=d.innerHTML.replace(/<[^>]+>/g,""),u=d.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),""),u=/^(?:https?:\/\/)/gi.test(u)?u:"http://"+u,d.setAttribute("_src",utils.html(u)),d.href=utils.html(u),o.insertNode(d),d.parentNode.insertBefore(c,d.nextSibling),o.setStart(c,0),o.collapse(!0),s.removeAllRanges(),s.addRange(o),a.undoManger&&a.undoManger.save()}}}}}}),(function(){var t={37:1,38:1,39:1,40:1,13:1,32:1};function e(t){if(3==t.nodeType)return null;if("A"==t.nodeName)return t;var e=t.lastChild;while(e){if("A"==e.nodeName)return e;if(3==e.nodeType){if(domUtils.isWhitespace(e)){e=e.previousSibling;continue}return null}e=e.lastChild}}browser.ie&&this.addListener("keyup",(function(a,n){var i=this,r=n.keyCode;if(t[r]){var s=i.selection.getRange(),o=s.startContainer;if(13==r){while(o&&!domUtils.isBody(o)&&!domUtils.isBlockElm(o))o=o.parentNode;if(o&&!domUtils.isBody(o)&&"P"==o.nodeName){var l=o.previousSibling;if(l&&1==l.nodeType){l=e(l);l&&!l.getAttribute("_href")&&domUtils.remove(l,!0)}}}else if(32==r)3==o.nodeType&&/^\s$/.test(o.nodeValue)&&(o=o.previousSibling,o&&"A"==o.nodeName&&!o.getAttribute("_href")&&domUtils.remove(o,!0));else if(o=domUtils.findParentByTagName(o,"a",!0),o&&!o.getAttribute("_href")){var u=s.createBookmark();domUtils.remove(o,!0),s.moveToBookmark(u).select(!0)}}}))})),UE.plugins["autoheight"]=function(){var t=this;if(t.autoHeightEnabled=!1!==t.options.autoHeightEnabled,t.autoHeightEnabled){var e,a,n,i,r=0,s=t.options;t.addListener("fullscreenchanged",(function(t,e){i=e})),t.addListener("destroy",(function(){t.removeListener("contentchange afterinserthtml keyup mouseup",o)})),t.enableAutoHeight=function(){var t=this;if(t.autoHeightEnabled){var a=t.document;t.autoHeightEnabled=!0,e=a.body.style.overflowY,a.body.style.overflowY="hidden",t.addListener("contentchange afterinserthtml keyup mouseup",o),setTimeout((function(){o.call(t)}),browser.gecko?100:0),t.fireEvent("autoheightchanged",t.autoHeightEnabled)}},t.disableAutoHeight=function(){t.body.style.overflowY=e||"",t.removeListener("contentchange",o),t.removeListener("keyup",o),t.removeListener("mouseup",o),t.autoHeightEnabled=!1,t.fireEvent("autoheightchanged",t.autoHeightEnabled)},t.on("setHeight",(function(){t.disableAutoHeight()})),t.addListener("ready",(function(){var e,a;t.enableAutoHeight(),domUtils.on(browser.ie?t.body:t.document,browser.webkit?"dragover":"drop",(function(){clearTimeout(e),e=setTimeout((function(){o.call(t)}),100)})),window.onscroll=function(){null===a?a=this.scrollY:0==this.scrollY&&0!=a&&(t.window.scrollTo(0,0),a=null)}}))}function o(){var t=this;clearTimeout(n),i||(!t.queryCommandState||t.queryCommandState&&1!=t.queryCommandState("source"))&&(n=setTimeout((function(){var e=t.body.lastChild;while(e&&1!=e.nodeType)e=e.previousSibling;e&&1==e.nodeType&&(e.style.clear="both",a=Math.max(domUtils.getXY(e).y+e.offsetHeight+25,Math.max(s.minFrameHeight,s.initialFrameHeight)),a!=r&&(a!==parseInt(t.iframe.parentNode.style.height)&&(t.iframe.parentNode.style.height=a+"px"),t.body.style.height=a+"px",r=a),domUtils.removeStyle(e,"clear"))}),50))}},UE.plugins["autofloat"]=function(){var t=this,e=t.getLang();t.setOpt({topOffset:0});var a=!1!==t.options.autoFloatEnabled,n=t.options.topOffset;if(a){var i,r,s,o,l=UE.ui.uiUtils,u=browser.ie&&browser.version<=6,d=browser.quirks,c=document.createElement("div"),p=!0,h=utils.defer((function(){b()}),browser.ie?200:100,!0);t.addListener("destroy",(function(){domUtils.un(window,["scroll","resize"],b),t.removeListener("keydown",h)})),t.addListener("ready",(function(){if(g(t)){if(!t.ui)return;o=l.getClientRect,r=t.ui.getDom("toolbarbox"),s=o(r).top,i=r.style.cssText,c.style.height=r.offsetHeight+"px",u&&f(),domUtils.on(window,["scroll","resize"],b),t.addListener("keydown",h),t.addListener("beforefullscreenchange",(function(t,e){e&&v()})),t.addListener("fullscreenchanged",(function(t,e){e||b()})),t.addListener("sourcemodechanged",(function(t,e){setTimeout((function(){b()}),0)})),t.addListener("clearDoc",(function(){setTimeout((function(){b()}),0)}))}}))}function g(){return UE.ui?1:(alert(e.autofloatMsg),0)}function f(){var t=document.body.style;t.backgroundImage='url("about:blank")',t.backgroundAttachment="fixed"}function m(){var e=domUtils.getXY(r),a=domUtils.getComputedStyle(r,"position"),i=domUtils.getComputedStyle(r,"left");r.style.width=r.offsetWidth+"px",r.style.zIndex=1*t.options.zIndex+1,r.parentNode.insertBefore(c,r),u||d&&browser.ie?("absolute"!=r.style.position&&(r.style.position="absolute"),r.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-s+n+"px"):(browser.ie7Compat&&p&&(p=!1,r.style.left=domUtils.getXY(r).x-document.documentElement.getBoundingClientRect().left+2+"px"),"fixed"!=r.style.position&&(r.style.position="fixed",r.style.top=n+"px",("absolute"==a||"relative"==a)&&parseFloat(i)&&(r.style.left=e.x+"px")))}function v(){p=!0,c.parentNode&&c.parentNode.removeChild(c),r.style.cssText=i}function b(){var e=o(t.container),a=t.options.toolbarTopOffset||0;e.top<0&&e.bottom-r.offsetHeight>a?m():v()}},UE.plugins["video"]=function(){var t=this;function e(e,a,n,i,r,s,o){var l;switch(e=utils.unhtmlForUrl(e),r=utils.unhtml(r),s=utils.unhtml(s),a=parseInt(a,10)||0,n=parseInt(n,10)||0,o){case"image":l="<img "+(i?'id="'+i+'"':"")+' width="'+a+'" height="'+n+'" _url="'+e+'" class="'+s.replace(/\bvideo-js\b/,"")+'" src="'+t.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+t.options.UEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(r?"float:"+r+";":"")+'" />';break;case"embed":l='<embed type="application/x-shockwave-flash" class="'+s+'" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+utils.html(e)+'" width="'+a+'" height="'+n+'"'+(r?' style="float:'+r+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';break;case"video":var u=e.substr(e.lastIndexOf(".")+1);"ogv"==u&&(u="ogg"),l="<video"+(i?' id="'+i+'"':"")+' class="'+s+' video-js" '+(r?' style="float:'+r+'"':"")+' controls preload="none" width="'+a+'" height="'+n+'" src="'+e+'" data-setup="{}"><source src="'+e+'" type="video/'+u+'" /></video>';break}return l}function a(t,a){utils.each(t.getNodesByTagName(a?"img":"embed video"),(function(t){var n=t.getAttr("class");if(n&&-1!=n.indexOf("edui-faked-video")){var i=e(a?t.getAttr("_url"):t.getAttr("src"),t.getAttr("width"),t.getAttr("height"),null,t.getStyle("float")||"",n,a?"embed":"image");t.parentNode.replaceChild(UE.uNode.createElement(i),t)}if(n&&-1!=n.indexOf("edui-upload-video")){i=e(a?t.getAttr("_url"):t.getAttr("src"),t.getAttr("width"),t.getAttr("height"),null,t.getStyle("float")||"",n,a?"video":"image");t.parentNode.replaceChild(UE.uNode.createElement(i),t)}}))}t.addOutputRule((function(t){a(t,!0)})),t.addInputRule((function(t){a(t)})),t.commands["insertvideo"]={execCommand:function(a,n,i){n=utils.isArray(n)?n:[n];for(var r,s,o=[],l="tmpVedio",u=0,d=n.length;u<d;u++)s=n[u],r="upload"==i?"edui-upload-video video-js vjs-default-skin":"edui-faked-video",o.push(e(s.url,s.width||420,s.height||280,l+u,null,r,"image"));t.execCommand("inserthtml",o.join(""),!0);var c=this.selection.getRange();for(u=0,d=n.length;u<d;u++){var p=this.document.getElementById("tmpVedio"+u);domUtils.removeAttributes(p,"id"),c.selectNode(p).select(),t.execCommand("imagefloat",n[u].align)}},queryCommandState:function(){var e=t.selection.getRange().getClosedNode(),a=e&&("edui-faked-video"==e.className||-1!=e.className.indexOf("edui-upload-video"));return a?1:0}}},function(){var t=UE.UETable=function(t){this.table=t,this.indexTable=[],this.selectedTds=[],this.cellsRange={},this.update(t)};function e(t){}t.removeSelectedClass=function(t){utils.each(t,(function(t){domUtils.removeClasses(t,"selectTdClass")}))},t.addSelectedClass=function(t){utils.each(t,(function(t){domUtils.addClass(t,"selectTdClass")}))},t.isEmptyBlock=function(t){var e=new RegExp(domUtils.fillChar,"g");if(t[browser.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(e,"").length>0)return 0;for(var a in dtd.$isNotEmpty)if(dtd.$isNotEmpty.hasOwnProperty(a)&&t.getElementsByTagName(a).length)return 0;return 1},t.getWidth=function(t){return t?parseInt(domUtils.getComputedStyle(t,"width"),10):0},t.getTableCellAlignState=function(t){!utils.isArray(t)&&(t=[t]);var e={},a=["align","valign"],n=null,i=!0;return utils.each(t,(function(t){return utils.each(a,(function(a){if(n=t.getAttribute(a),!e[a]&&n)e[a]=n;else if(!e[a]||n!==e[a])return i=!1,!1})),i})),i?e:null},t.getTableItemsByRange=function(t){var e=t.selection.getStart();e&&e.id&&0===e.id.indexOf("_baidu_bookmark_start_")&&e.nextSibling&&(e=e.nextSibling);var a=e&&domUtils.findParentByTagName(e,["td","th"],!0),n=a&&a.parentNode,i=e&&domUtils.findParentByTagName(e,"caption",!0),r=i?i.parentNode:n&&n.parentNode.parentNode;return{cell:a,tr:n,table:r,caption:i}},t.getUETableBySelected=function(e){var a=t.getTableItemsByRange(e).table;return a&&a.ueTable&&a.ueTable.selectedTds.length?a.ueTable:null},t.getDefaultValue=function(t,e){var a,n,i,r,s={thin:"0px",medium:"1px",thick:"2px"};if(e)return o=e.getElementsByTagName("td")[0],r=domUtils.getComputedStyle(e,"border-left-width"),a=parseInt(s[r]||r,10),r=domUtils.getComputedStyle(o,"padding-left"),n=parseInt(s[r]||r,10),r=domUtils.getComputedStyle(o,"border-left-width"),i=parseInt(s[r]||r,10),{tableBorder:a,tdPadding:n,tdBorder:i};e=t.document.createElement("table"),e.insertRow(0).insertCell(0).innerHTML="xxx",t.body.appendChild(e);var o=e.getElementsByTagName("td")[0];return r=domUtils.getComputedStyle(e,"border-left-width"),a=parseInt(s[r]||r,10),r=domUtils.getComputedStyle(o,"padding-left"),n=parseInt(s[r]||r,10),r=domUtils.getComputedStyle(o,"border-left-width"),i=parseInt(s[r]||r,10),domUtils.remove(e),{tableBorder:a,tdPadding:n,tdBorder:i}},t.getUETable=function(e){var a=e.tagName.toLowerCase();return e="td"==a||"th"==a||"caption"==a?domUtils.findParentByTagName(e,"table",!0):e,e.ueTable||(e.ueTable=new t(e)),e.ueTable},t.cloneCell=function(t,e,a){if(!t||utils.isString(t))return this.table.ownerDocument.createElement(t||"td");var n=domUtils.hasClass(t,"selectTdClass");n&&domUtils.removeClasses(t,"selectTdClass");var i=t.cloneNode(!0);return e&&(i.rowSpan=i.colSpan=1),!a&&domUtils.removeAttributes(i,"width height"),!a&&domUtils.removeAttributes(i,"style"),i.style.borderLeftStyle="",i.style.borderTopStyle="",i.style.borderLeftColor=t.style.borderRightColor,i.style.borderLeftWidth=t.style.borderRightWidth,i.style.borderTopColor=t.style.borderBottomColor,i.style.borderTopWidth=t.style.borderBottomWidth,n&&domUtils.addClass(t,"selectTdClass"),i},t.prototype={getMaxRows:function(){for(var t,e=this.table.rows,a=1,n=0;t=e[n];n++){for(var i,r=1,s=0;i=t.cells[s++];)r=Math.max(i.rowSpan||1,r);a=Math.max(r+n,a)}return a},getMaxCols:function(){for(var t,e=this.table.rows,a=0,n={},i=0;t=e[i];i++){for(var r,s=0,o=0;r=t.cells[o++];)if(s+=r.colSpan||1,r.rowSpan&&r.rowSpan>1)for(var l=1;l<r.rowSpan;l++)n["row_"+(i+l)]?n["row_"+(i+l)]++:n["row_"+(i+l)]=r.colSpan||1;s+=n["row_"+i]||0,a=Math.max(s,a)}return a},getCellColIndex:function(t){},getHSideCell:function(t,a){try{var n,i,r=this.getCellInfo(t),s=this.selectedTds.length,o=this.cellsRange;return!a&&(s?!o.beginColIndex:!r.colIndex)||a&&(s?o.endColIndex==this.colsNum-1:r.colIndex==this.colsNum-1)?null:(n=s?o.beginRowIndex:r.rowIndex,i=a?s?o.endColIndex+1:r.colIndex+1:s?o.beginColIndex-1:r.colIndex<1?0:r.colIndex-1,this.getCell(this.indexTable[n][i].rowIndex,this.indexTable[n][i].cellIndex))}catch(l){e(l)}},getTabNextCell:function(t,e){var a,n=this.getCellInfo(t),i=e||n.rowIndex,r=n.colIndex+1+(n.colSpan-1);try{a=this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex)}catch(s){try{i=1*i+1,r=0,a=this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex)}catch(s){}}return a},getVSideCell:function(t,a,n){try{var i,r,s=this.getCellInfo(t),o=this.selectedTds.length&&!n,l=this.cellsRange;return!a&&0==s.rowIndex||a&&(o?l.endRowIndex==this.rowsNum-1:s.rowIndex+s.rowSpan>this.rowsNum-1)?null:(i=a?o?l.endRowIndex+1:s.rowIndex+s.rowSpan:o?l.beginRowIndex-1:s.rowIndex-1,r=o?l.beginColIndex:s.colIndex,this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex))}catch(u){e(u)}},getSameEndPosCells:function(t,a){try{for(var n="x"===a.toLowerCase(),i=domUtils.getXY(t)[n?"x":"y"]+t["offset"+(n?"Width":"Height")],r=this.table.rows,s=null,o=[],l=0;l<this.rowsNum;l++){s=r[l].cells;for(var u,d=0;u=s[d++];){var c=domUtils.getXY(u)[n?"x":"y"]+u["offset"+(n?"Width":"Height")];if(c>i&&n)break;if((t==u||i==c)&&(1==u[n?"colSpan":"rowSpan"]&&o.push(u),n))break}}return o}catch(p){e(p)}},setCellContent:function(t,e){t.innerHTML=e||(browser.ie?domUtils.fillChar:"<br />")},cloneCell:t.cloneCell,getSameStartPosXCells:function(t){try{for(var a,n=domUtils.getXY(t).x+t.offsetWidth,i=this.table.rows,r=[],s=0;s<this.rowsNum;s++){a=i[s].cells;for(var o,l=0;o=a[l++];){var u=domUtils.getXY(o).x;if(u>n)break;if(u==n&&1==o.colSpan){r.push(o);break}}}return r}catch(d){e(d)}},update:function(t){this.table=t||this.table,this.selectedTds=[],this.cellsRange={},this.indexTable=[];var e=this.table.rows,a=this.getMaxRows(),n=a-e.length,i=this.getMaxCols();while(n--)this.table.insertRow(e.length);this.rowsNum=a,this.colsNum=i;for(var r=0,s=e.length;r<s;r++)this.indexTable[r]=new Array(i);for(var o,l=0;o=e[l];l++)for(var u,d=0,c=o.cells;u=c[d];d++){u.rowSpan>a&&(u.rowSpan=a);var p=d,h=u.rowSpan||1,g=u.colSpan||1;while(this.indexTable[l][p])p++;for(var f=0;f<h;f++)for(var m=0;m<g;m++)this.indexTable[l+f][p+m]={rowIndex:l,cellIndex:d,colIndex:p,rowSpan:h,colSpan:g}}for(f=0;f<a;f++)for(m=0;m<i;m++)void 0===this.indexTable[f][m]&&(o=e[f],u=o.cells[o.cells.length-1],u=u?u.cloneNode(!0):this.table.ownerDocument.createElement("td"),this.setCellContent(u),1!==u.colSpan&&(u.colSpan=1),1!==u.rowSpan&&(u.rowSpan=1),o.appendChild(u),this.indexTable[f][m]={rowIndex:f,cellIndex:u.cellIndex,colIndex:m,rowSpan:1,colSpan:1});var v=domUtils.getElementsByTagName(this.table,"td"),b=[];if(utils.each(v,(function(t){domUtils.hasClass(t,"selectTdClass")&&b.push(t)})),b.length){var y=b[0],_=b[b.length-1],D=this.getCellInfo(y),C=this.getCellInfo(_);this.selectedTds=b,this.cellsRange={beginRowIndex:D.rowIndex,beginColIndex:D.colIndex,endRowIndex:C.rowIndex+C.rowSpan-1,endColIndex:C.colIndex+C.colSpan-1}}if(!domUtils.hasClass(this.table.rows[0],"firstRow")){domUtils.addClass(this.table.rows[0],"firstRow");for(r=1;r<this.table.rows.length;r++)domUtils.removeClasses(this.table.rows[r],"firstRow")}},getCellInfo:function(t){if(t)for(var e=t.cellIndex,a=t.parentNode.rowIndex,n=this.indexTable[a],i=this.colsNum,r=e;r<i;r++){var s=n[r];if(s.rowIndex===a&&s.cellIndex===e)return s}},getCell:function(t,e){return t<this.rowsNum&&this.table.rows[t].cells[e]||null},deleteCell:function(t,e){e="number"==typeof e?e:t.parentNode.rowIndex;var a=this.table.rows[e];a.deleteCell(t.cellIndex)},getCellsRange:function(t,e){function a(t,e,i,r){var s,o,l,u=t,d=e,c=i,p=r;if(t>0)for(o=e;o<r;o++)s=n.indexTable[t][o],l=s.rowIndex,l<t&&(u=Math.min(l,u));if(r<n.colsNum)for(l=t;l<i;l++)s=n.indexTable[l][r],o=s.colIndex+s.colSpan-1,o>r&&(p=Math.max(o,p));if(i<n.rowsNum)for(o=e;o<r;o++)s=n.indexTable[i][o],l=s.rowIndex+s.rowSpan-1,l>i&&(c=Math.max(l,c));if(e>0)for(l=t;l<i;l++)s=n.indexTable[l][e],o=s.colIndex,o<e&&(d=Math.min(s.colIndex,d));return u!=t||d!=e||c!=i||p!=r?a(u,d,c,p):{beginRowIndex:t,beginColIndex:e,endRowIndex:i,endColIndex:r}}try{var n=this,i=n.getCellInfo(t);if(t===e)return{beginRowIndex:i.rowIndex,beginColIndex:i.colIndex,endRowIndex:i.rowIndex+i.rowSpan-1,endColIndex:i.colIndex+i.colSpan-1};var r=n.getCellInfo(e),s=Math.min(i.rowIndex,r.rowIndex),o=Math.min(i.colIndex,r.colIndex),l=Math.max(i.rowIndex+i.rowSpan-1,r.rowIndex+r.rowSpan-1),u=Math.max(i.colIndex+i.colSpan-1,r.colIndex+r.colSpan-1);return a(s,o,l,u)}catch(d){}},getCells:function(t){this.clearSelected();for(var e,a,n,i=t.beginRowIndex,r=t.beginColIndex,s=t.endRowIndex,o=t.endColIndex,l={},u=[],d=i;d<=s;d++)for(var c=r;c<=o;c++){e=this.indexTable[d][c],a=e.rowIndex,n=e.colIndex;var p=a+"|"+n;if(!l[p]){if(l[p]=1,a<d||n<c||a+e.rowSpan-1>s||n+e.colSpan-1>o)return null;u.push(this.getCell(a,e.cellIndex))}}return u},clearSelected:function(){t.removeSelectedClass(this.selectedTds),this.selectedTds=[],this.cellsRange={}},setSelected:function(e){var a=this.getCells(e);t.addSelectedClass(a),this.selectedTds=a,this.cellsRange=e},isFullRow:function(){var t=this.cellsRange;return t.endColIndex-t.beginColIndex+1==this.colsNum},isFullCol:function(){var t=this.cellsRange,e=this.table,a=e.getElementsByTagName("th"),n=t.endRowIndex-t.beginRowIndex+1;return a.length?n==this.rowsNum||n==this.rowsNum-1:n==this.rowsNum},getNextCell:function(t,a,n){try{var i,r,s=this.getCellInfo(t),o=this.selectedTds.length&&!n,l=this.cellsRange;return!a&&0==s.rowIndex||a&&(o?l.endRowIndex==this.rowsNum-1:s.rowIndex+s.rowSpan>this.rowsNum-1)?null:(i=a?o?l.endRowIndex+1:s.rowIndex+s.rowSpan:o?l.beginRowIndex-1:s.rowIndex-1,r=o?l.beginColIndex:s.colIndex,this.getCell(this.indexTable[i][r].rowIndex,this.indexTable[i][r].cellIndex))}catch(u){e(u)}},getPreviewCell:function(t,a){try{var n,i,r=this.getCellInfo(t),s=this.selectedTds.length,o=this.cellsRange;return!a&&(s?!o.beginColIndex:!r.colIndex)||a&&(s?o.endColIndex==this.colsNum-1:r.rowIndex>this.colsNum-1)?null:(n=a?s?o.beginRowIndex:r.rowIndex<1?0:r.rowIndex-1:s?o.beginRowIndex:r.rowIndex,i=a?s?o.endColIndex+1:r.colIndex:s?o.beginColIndex-1:r.colIndex<1?0:r.colIndex-1,this.getCell(this.indexTable[n][i].rowIndex,this.indexTable[n][i].cellIndex))}catch(l){e(l)}},moveContent:function(e,a){if(!t.isEmptyBlock(a))if(t.isEmptyBlock(e))e.innerHTML=a.innerHTML;else{var n=e.lastChild;3!=n.nodeType&&dtd.$block[n.tagName]||e.appendChild(e.ownerDocument.createElement("br"));while(n=a.firstChild)e.appendChild(n)}},mergeRight:function(t){var e=this.getCellInfo(t),a=e.colIndex+e.colSpan,n=this.indexTable[e.rowIndex][a],i=this.getCell(n.rowIndex,n.cellIndex);t.colSpan=e.colSpan+n.colSpan,t.removeAttribute("width"),this.moveContent(t,i),this.deleteCell(i,n.rowIndex),this.update()},mergeDown:function(t){var e=this.getCellInfo(t),a=e.rowIndex+e.rowSpan,n=this.indexTable[a][e.colIndex],i=this.getCell(n.rowIndex,n.cellIndex);t.rowSpan=e.rowSpan+n.rowSpan,t.removeAttribute("height"),this.moveContent(t,i),this.deleteCell(i,n.rowIndex),this.update()},mergeRange:function(){var t=this.cellsRange,e=this.getCell(t.beginRowIndex,this.indexTable[t.beginRowIndex][t.beginColIndex].cellIndex);if("TH"==e.tagName&&t.endRowIndex!==t.beginRowIndex){var a=this.indexTable,n=this.getCellInfo(e);e=this.getCell(1,a[1][n.colIndex].cellIndex),t=this.getCellsRange(e,this.getCell(a[this.rowsNum-1][n.colIndex].rowIndex,a[this.rowsNum-1][n.colIndex].cellIndex))}for(var i,r=this.getCells(t),s=0;i=r[s++];)i!==e&&(this.moveContent(e,i),this.deleteCell(i));if(e.rowSpan=t.endRowIndex-t.beginRowIndex+1,e.rowSpan>1&&e.removeAttribute("height"),e.colSpan=t.endColIndex-t.beginColIndex+1,e.colSpan>1&&e.removeAttribute("width"),e.rowSpan==this.rowsNum&&1!=e.colSpan&&(e.colSpan=1),e.colSpan==this.colsNum&&1!=e.rowSpan){var o=e.parentNode.rowIndex;if(this.table.deleteRow){s=o+1;for(var l=o+1,u=e.rowSpan;s<u;s++)this.table.deleteRow(l)}else for(s=0,u=e.rowSpan-1;s<u;s++){var d=this.table.rows[o+1];d.parentNode.removeChild(d)}e.rowSpan=1}this.update()},insertRow:function(t,e){var a,n=this.colsNum,i=this.table,r=i.insertRow(t),s="string"==typeof e&&"TH"==e.toUpperCase();function o(t,e,a){if(0==t){var n=a.nextSibling||a.previousSibling,i=n.cells[t];"TH"==i.tagName&&(i=e.ownerDocument.createElement("th"),i.appendChild(e.firstChild),a.insertBefore(i,e),domUtils.remove(e))}else if("TH"==e.tagName){var r=e.ownerDocument.createElement("td");r.appendChild(e.firstChild),a.insertBefore(r,e),domUtils.remove(e)}}if(0==t||t==this.rowsNum)for(var l=0;l<n;l++)a=this.cloneCell(e,!0),this.setCellContent(a),a.getAttribute("vAlign")&&a.setAttribute("vAlign",a.getAttribute("vAlign")),r.appendChild(a),s||o(l,a,r);else{var u=this.indexTable[t];for(l=0;l<n;l++){var d=u[l];d.rowIndex<t?(a=this.getCell(d.rowIndex,d.cellIndex),a.rowSpan=d.rowSpan+1):(a=this.cloneCell(e,!0),this.setCellContent(a),r.appendChild(a)),s||o(l,a,r)}}return this.update(),r},deleteRow:function(t){for(var e=this.table.rows[t],a=this.indexTable[t],n=this.colsNum,i=0,r=0;r<n;){var s=a[r],o=this.getCell(s.rowIndex,s.cellIndex);if(o.rowSpan>1&&s.rowIndex==t){var l=o.cloneNode(!0);l.rowSpan=o.rowSpan-1,l.innerHTML="",o.rowSpan=1;var u,d=t+1,c=this.table.rows[d],p=this.getPreviewMergedCellsNum(d,r)-i;p<r?(u=r-p-1,domUtils.insertAfter(c.cells[u],l)):c.cells.length&&c.insertBefore(l,c.cells[0]),i+=1}r+=o.colSpan||1}var h=[],g={};for(r=0;r<n;r++){var f=a[r].rowIndex,m=a[r].cellIndex,v=f+"_"+m;g[v]||(g[v]=1,o=this.getCell(f,m),h.push(o))}var b=[];utils.each(h,(function(t){1==t.rowSpan?t.parentNode.removeChild(t):b.push(t)})),utils.each(b,(function(t){t.rowSpan--})),e.parentNode.removeChild(e),this.update()},insertCol:function(t,e,a){var n,i,r,s=this.rowsNum,o=0,l=parseInt((this.table.offsetWidth-20*(this.colsNum+1)-(this.colsNum+1))/(this.colsNum+1),10),u="string"==typeof e&&"TH"==e.toUpperCase();function d(t,e,a){if(0==t){var n=e.nextSibling||e.previousSibling;"TH"==n.tagName&&(n=e.ownerDocument.createElement("th"),n.appendChild(e.firstChild),a.insertBefore(n,e),domUtils.remove(e))}else if("TH"==e.tagName){var i=e.ownerDocument.createElement("td");i.appendChild(e.firstChild),a.insertBefore(i,e),domUtils.remove(e)}}if(0==t||t==this.colsNum)for(;o<s;o++)n=this.table.rows[o],r=n.cells[0==t?t:n.cells.length],i=this.cloneCell(e,!0),this.setCellContent(i),i.setAttribute("vAlign",i.getAttribute("vAlign")),r&&i.setAttribute("width",r.getAttribute("width")),t?domUtils.insertAfter(n.cells[n.cells.length-1],i):n.insertBefore(i,n.cells[0]),u||d(o,i,n);else for(;o<s;o++){var c=this.indexTable[o][t];c.colIndex<t?(i=this.getCell(c.rowIndex,c.cellIndex),i.colSpan=c.colSpan+1):(n=this.table.rows[o],r=n.cells[c.cellIndex],i=this.cloneCell(e,!0),this.setCellContent(i),i.setAttribute("vAlign",i.getAttribute("vAlign")),r&&i.setAttribute("width",r.getAttribute("width")),r?n.insertBefore(i,r):n.appendChild(i)),u||d(o,i,n)}this.update(),this.updateWidth(l,a||{tdPadding:10,tdBorder:1})},updateWidth:function(e,a){var n=this.table,i=t.getWidth(n)-2*a.tdPadding-a.tdBorder+e;if(i<n.ownerDocument.body.offsetWidth)n.setAttribute("width",i);else{var r=domUtils.getElementsByTagName(this.table,"td th");utils.each(r,(function(t){t.setAttribute("width",e)}))}},deleteCol:function(t){for(var e=this.indexTable,a=this.table.rows,n=this.table.getAttribute("width"),i=0,r=this.rowsNum,s={},o=0;o<r;){var l=e[o],u=l[t],d=u.rowIndex+"_"+u.colIndex;if(!s[d]){s[d]=1;var c=this.getCell(u.rowIndex,u.cellIndex);i||(i=c&&parseInt(c.offsetWidth/c.colSpan,10).toFixed(0)),c.colSpan>1?c.colSpan--:a[o].deleteCell(u.cellIndex),o+=u.rowSpan||1}}this.table.setAttribute("width",n-i),this.update()},splitToCells:function(t){var e=this,a=this.splitToRows(t);utils.each(a,(function(t){e.splitToCols(t)}))},splitToRows:function(t){var e=this.getCellInfo(t),a=e.rowIndex,n=e.colIndex,i=[];t.rowSpan=1,i.push(t);for(var r=a,s=a+e.rowSpan;r<s;r++)if(r!=a){var o=this.table.rows[r],l=o.insertCell(n-this.getPreviewMergedCellsNum(r,n));l.colSpan=e.colSpan,this.setCellContent(l),l.setAttribute("vAlign",t.getAttribute("vAlign")),l.setAttribute("align",t.getAttribute("align")),t.style.cssText&&(l.style.cssText=t.style.cssText),i.push(l)}return this.update(),i},getPreviewMergedCellsNum:function(t,e){for(var a=this.indexTable[t],n=0,i=0;i<e;){var r=a[i].colSpan,s=a[i].rowIndex;n+=r-(s==t?1:0),i+=r}return n},splitToCols:function(t){var e=(t.offsetWidth/t.colSpan-22).toFixed(0),a=this.getCellInfo(t),n=a.rowIndex,i=a.colIndex,r=[];t.colSpan=1,t.setAttribute("width",e),r.push(t);for(var s=i,o=i+a.colSpan;s<o;s++)if(s!=i){var l=this.table.rows[n],u=l.insertCell(this.indexTable[n][s].cellIndex+1);if(u.rowSpan=a.rowSpan,this.setCellContent(u),u.setAttribute("vAlign",t.getAttribute("vAlign")),u.setAttribute("align",t.getAttribute("align")),u.setAttribute("width",e),t.style.cssText&&(u.style.cssText=t.style.cssText),"TH"==t.tagName){var d=t.ownerDocument.createElement("th");d.appendChild(u.firstChild),d.setAttribute("vAlign",t.getAttribute("vAlign")),d.rowSpan=u.rowSpan,l.insertBefore(d,u),domUtils.remove(u)}r.push(u)}return this.update(),r},isLastCell:function(t,e,a){e=e||this.rowsNum,a=a||this.colsNum;var n=this.getCellInfo(t);return n.rowIndex+n.rowSpan==e&&n.colIndex+n.colSpan==a},getLastCell:function(t){t=t||this.table.getElementsByTagName("td");this.getCellInfo(t[0]);var e,a=this,n=t[0],i=n.parentNode,r=0,s=0;return utils.each(t,(function(t){t.parentNode==i&&(s+=t.colSpan||1),r+=t.rowSpan*t.colSpan||1})),e=r/s,utils.each(t,(function(t){if(a.isLastCell(t,e,s))return n=t,!1})),n},selectRow:function(t){var e=this.indexTable[t],a=this.getCell(e[0].rowIndex,e[0].cellIndex),n=this.getCell(e[this.colsNum-1].rowIndex,e[this.colsNum-1].cellIndex),i=this.getCellsRange(a,n);this.setSelected(i)},selectTable:function(){var t=this.table.getElementsByTagName("td"),e=this.getCellsRange(t[0],t[t.length-1]);this.setSelected(e)},setBackground:function(t,e){if("string"===typeof e)utils.each(t,(function(t){t.style.backgroundColor=e}));else if("object"===_typeof(e)){e=utils.extend({repeat:!0,colorList:["#ddd","#fff"]},e);for(var a,n=this.getCellInfo(t[0]).rowIndex,i=0,r=e.colorList,s=function(t,e,a){return t[e]?t[e]:a?t[e%t.length]:""},o=0;a=t[o++];){var l=this.getCellInfo(a);a.style.backgroundColor=s(r,n+i==l.rowIndex?i:++i,e.repeat)}}},removeBackground:function(t){utils.each(t,(function(t){t.style.backgroundColor=""}))}}}(),function(){var t=UE.UETable,e=function(e){return t.getTableItemsByRange(e)},a=function(e){return t.getUETableBySelected(e)},n=function(e,a){return t.getDefaultValue(e,a)},i=function(e){return t.getUETable(e)};function r(t,e){var a=domUtils.getElementsByTagName(t,"td th");utils.each(a,(function(t){t.removeAttribute("width")})),t.setAttribute("width",s(e,!0,n(e,t)));var i=[];setTimeout((function(){utils.each(a,(function(t){1==t.colSpan&&i.push(t.offsetWidth)})),utils.each(a,(function(t,e){1==t.colSpan&&t.setAttribute("width",i[e]+"")}))}),0)}function s(t,e,a){var n=t.body;return n.offsetWidth-(e?2*parseInt(domUtils.getComputedStyle(n,"margin-left"),10):0)-2*a.tableBorder-(t.options.offsetWidth||0)}function o(t){var a=e(t).cell;if(a){var n=i(a);return n.selectedTds.length?n.selectedTds:[a]}return[]}UE.commands["inserttable"]={queryCommandState:function(){return e(this).table?-1:0},execCommand:function(t,e){function a(t,e){for(var a=[],n=t.numRows,i=t.numCols,r=0;r<n;r++){a.push("<tr"+(0==r?' class="firstRow"':"")+">");for(var s=0;s<i;s++)a.push('<td width="'+e+'"  vAlign="'+t.tdvalign+'" >'+(browser.ie&&browser.version<11?domUtils.fillChar:"<br/>")+"</td>");a.push("</tr>")}return"<table><tbody>"+a.join("")+"</tbody></table>"}e||(e=utils.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign}));var i=this,r=this.selection.getRange(),s=r.startContainer,o=domUtils.findParent(s,(function(t){return domUtils.isBlockElm(t)}),!0)||i.body,l=n(i),u=o.offsetWidth,d=Math.floor(u/e.numCols-2*l.tdPadding-l.tdBorder);!e.tdvalign&&(e.tdvalign=i.options.tdvalign),i.execCommand("inserthtml",a(e,d))}},UE.commands["insertparagraphbeforetable"]={queryCommandState:function(){return e(this).cell?0:-1},execCommand:function(){var t=e(this).table;if(t){var a=this.document.createElement("p");a.innerHTML=browser.ie?"&nbsp;":"<br />",t.parentNode.insertBefore(a,t),this.selection.getRange().setStart(a,0).setCursor()}}},UE.commands["deletetable"]={queryCommandState:function(){var t=this.selection.getRange();return domUtils.findParentByTagName(t.startContainer,"table",!0)?0:-1},execCommand:function(t,e){var a=this.selection.getRange();if(e=e||domUtils.findParentByTagName(a.startContainer,"table",!0),e){var n=e.nextSibling;n||(n=domUtils.createElement(this.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"}),e.parentNode.insertBefore(n,e)),domUtils.remove(e),a=this.selection.getRange(),3==n.nodeType?a.setStartBefore(n):a.setStart(n,0),a.setCursor(!1,!0),this.fireEvent("tablehasdeleted")}}},UE.commands["cellalign"]={queryCommandState:function(){return o(this).length?0:-1},execCommand:function(t,e){var a=o(this);if(a.length)for(var n,i=0;n=a[i++];)n.setAttribute("align",e)}},UE.commands["cellvalign"]={queryCommandState:function(){return o(this).length?0:-1},execCommand:function(t,e){var a=o(this);if(a.length)for(var n,i=0;n=a[i++];)n.setAttribute("vAlign",e)}},UE.commands["insertcaption"]={queryCommandState:function(){var t=e(this).table;return t&&0==t.getElementsByTagName("caption").length?1:-1},execCommand:function(){var t=e(this).table;if(t){var a=this.document.createElement("caption");a.innerHTML=browser.ie?domUtils.fillChar:"<br/>",t.insertBefore(a,t.firstChild);var n=this.selection.getRange();n.setStart(a,0).setCursor()}}},UE.commands["deletecaption"]={queryCommandState:function(){var t=this.selection.getRange(),e=domUtils.findParentByTagName(t.startContainer,"table");return e?0==e.getElementsByTagName("caption").length?-1:1:-1},execCommand:function(){var t=this.selection.getRange(),e=domUtils.findParentByTagName(t.startContainer,"table");if(e){domUtils.remove(e.getElementsByTagName("caption")[0]);var a=this.selection.getRange();a.setStart(e.rows[0].cells[0],0).setCursor()}}},UE.commands["inserttitle"]={queryCommandState:function(){var t=e(this).table;if(t){var a=t.rows[0];return"th"!=a.cells[a.cells.length-1].tagName.toLowerCase()?0:-1}return-1},execCommand:function(){var t=e(this).table;t&&i(t).insertRow(0,"th");var a=t.getElementsByTagName("th")[0];this.selection.getRange().setStart(a,0).setCursor(!1,!0)}},UE.commands["deletetitle"]={queryCommandState:function(){var t=e(this).table;if(t){var a=t.rows[0];return"th"==a.cells[a.cells.length-1].tagName.toLowerCase()?0:-1}return-1},execCommand:function(){var t=e(this).table;t&&domUtils.remove(t.rows[0]);var a=t.getElementsByTagName("td")[0];this.selection.getRange().setStart(a,0).setCursor(!1,!0)}},UE.commands["inserttitlecol"]={queryCommandState:function(){var t=e(this).table;if(t){var a=t.rows[t.rows.length-1];return a.getElementsByTagName("th").length?-1:0}return-1},execCommand:function(t){var a=e(this).table;a&&i(a).insertCol(0,"th"),r(a,this);var n=a.getElementsByTagName("th")[0];this.selection.getRange().setStart(n,0).setCursor(!1,!0)}},UE.commands["deletetitlecol"]={queryCommandState:function(){var t=e(this).table;if(t){var a=t.rows[t.rows.length-1];return a.getElementsByTagName("th").length?0:-1}return-1},execCommand:function(){var t=e(this).table;if(t)for(var a=0;a<t.rows.length;a++)domUtils.remove(t.rows[a].children[0]);r(t,this);var n=t.getElementsByTagName("td")[0];this.selection.getRange().setStart(n,0).setCursor(!1,!0)}},UE.commands["mergeright"]={queryCommandState:function(t){var a=e(this),n=a.table,r=a.cell;if(!n||!r)return-1;var s=i(n);if(s.selectedTds.length)return-1;var o=s.getCellInfo(r),l=o.colIndex+o.colSpan;if(l>=s.colsNum)return-1;var u=s.indexTable[o.rowIndex][l],d=n.rows[u.rowIndex].cells[u.cellIndex];return d&&r.tagName==d.tagName&&u.rowIndex==o.rowIndex&&u.rowSpan==o.rowSpan?0:-1},execCommand:function(t){var a=this.selection.getRange(),n=a.createBookmark(!0),r=e(this).cell,s=i(r);s.mergeRight(r),a.moveToBookmark(n).select()}},UE.commands["mergedown"]={queryCommandState:function(t){var a=e(this),n=a.table,r=a.cell;if(!n||!r)return-1;var s=i(n);if(s.selectedTds.length)return-1;var o=s.getCellInfo(r),l=o.rowIndex+o.rowSpan;if(l>=s.rowsNum)return-1;var u=s.indexTable[l][o.colIndex],d=n.rows[u.rowIndex].cells[u.cellIndex];return d&&r.tagName==d.tagName&&u.colIndex==o.colIndex&&u.colSpan==o.colSpan?0:-1},execCommand:function(){var t=this.selection.getRange(),a=t.createBookmark(!0),n=e(this).cell,r=i(n);r.mergeDown(n),t.moveToBookmark(a).select()}},UE.commands["mergecells"]={queryCommandState:function(){return a(this)?0:-1},execCommand:function(){var t=a(this);if(t&&t.selectedTds.length){var e=t.selectedTds[0];t.mergeRange();var n=this.selection.getRange();domUtils.isEmptyBlock(e)?n.setStart(e,0).collapse(!0):n.selectNodeContents(e),n.select()}}},UE.commands["insertrow"]={queryCommandState:function(){var t=e(this),a=t.cell;return a&&("TD"==a.tagName||"TH"==a.tagName&&t.tr!==t.table.rows[0])&&i(t.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var t=this.selection.getRange(),a=t.createBookmark(!0),n=e(this),r=n.cell,s=n.table,o=i(s),l=o.getCellInfo(r);if(o.selectedTds.length)for(var u=o.cellsRange,d=0,c=u.endRowIndex-u.beginRowIndex+1;d<c;d++)o.insertRow(u.beginRowIndex,r);else o.insertRow(l.rowIndex,r);t.moveToBookmark(a).select(),"enabled"===s.getAttribute("interlaced")&&this.fireEvent("interlacetable",s)}},UE.commands["insertrownext"]={queryCommandState:function(){var t=e(this),a=t.cell;return a&&"TD"==a.tagName&&i(t.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var t=this.selection.getRange(),a=t.createBookmark(!0),n=e(this),r=n.cell,s=n.table,o=i(s),l=o.getCellInfo(r);if(o.selectedTds.length)for(var u=o.cellsRange,d=0,c=u.endRowIndex-u.beginRowIndex+1;d<c;d++)o.insertRow(u.endRowIndex+1,r);else o.insertRow(l.rowIndex+l.rowSpan,r);t.moveToBookmark(a).select(),"enabled"===s.getAttribute("interlaced")&&this.fireEvent("interlacetable",s)}},UE.commands["deleterow"]={queryCommandState:function(){var t=e(this);return t.cell?0:-1},execCommand:function(){var t=e(this).cell,a=i(t),n=a.cellsRange,r=a.getCellInfo(t),s=a.getVSideCell(t),o=a.getVSideCell(t,!0),l=this.selection.getRange();if(utils.isEmptyObject(n))a.deleteRow(r.rowIndex);else for(var u=n.beginRowIndex;u<n.endRowIndex+1;u++)a.deleteRow(n.beginRowIndex);var d=a.table;if(d.getElementsByTagName("td").length)if(1==r.rowSpan||r.rowSpan==n.endRowIndex-n.beginRowIndex+1)(o||s)&&l.selectNodeContents(o||s).setCursor(!1,!0);else{var c=a.getCell(r.rowIndex,a.indexTable[r.rowIndex][r.colIndex].cellIndex);c&&l.selectNodeContents(c).setCursor(!1,!0)}else{var p=d.nextSibling;domUtils.remove(d),p&&l.setStart(p,0).setCursor(!1,!0)}"enabled"===d.getAttribute("interlaced")&&this.fireEvent("interlacetable",d)}},UE.commands["insertcol"]={queryCommandState:function(t){var a=e(this),n=a.cell;return n&&("TD"==n.tagName||"TH"==n.tagName&&n!==a.tr.cells[0])&&i(a.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(t){var a=this.selection.getRange(),n=a.createBookmark(!0);if(-1!=this.queryCommandState(t)){var r=e(this).cell,s=i(r),o=s.getCellInfo(r);if(s.selectedTds.length)for(var l=s.cellsRange,u=0,d=l.endColIndex-l.beginColIndex+1;u<d;u++)s.insertCol(l.beginColIndex,r);else s.insertCol(o.colIndex,r);a.moveToBookmark(n).select(!0)}}},UE.commands["insertcolnext"]={queryCommandState:function(){var t=e(this),a=t.cell;return a&&i(t.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var t=this.selection.getRange(),a=t.createBookmark(!0),n=e(this).cell,r=i(n),s=r.getCellInfo(n);if(r.selectedTds.length)for(var o=r.cellsRange,l=0,u=o.endColIndex-o.beginColIndex+1;l<u;l++)r.insertCol(o.endColIndex+1,n);else r.insertCol(s.colIndex+s.colSpan,n);t.moveToBookmark(a).select()}},UE.commands["deletecol"]={queryCommandState:function(){var t=e(this);return t.cell?0:-1},execCommand:function(){var t=e(this).cell,a=i(t),n=a.cellsRange,r=a.getCellInfo(t),s=a.getHSideCell(t),o=a.getHSideCell(t,!0);if(utils.isEmptyObject(n))a.deleteCol(r.colIndex);else for(var l=n.beginColIndex;l<n.endColIndex+1;l++)a.deleteCol(n.beginColIndex);var u=a.table,d=this.selection.getRange();if(u.getElementsByTagName("td").length)domUtils.inDoc(t,this.document)?d.setStart(t,0).setCursor(!1,!0):o&&domUtils.inDoc(o,this.document)?d.selectNodeContents(o).setCursor(!1,!0):s&&domUtils.inDoc(s,this.document)&&d.selectNodeContents(s).setCursor(!0,!0);else{var c=u.nextSibling;domUtils.remove(u),c&&d.setStart(c,0).setCursor(!1,!0)}}},UE.commands["splittocells"]={queryCommandState:function(){var t=e(this),a=t.cell;if(!a)return-1;var n=i(t.table);return n.selectedTds.length>0?-1:a&&(a.colSpan>1||a.rowSpan>1)?0:-1},execCommand:function(){var t=this.selection.getRange(),a=t.createBookmark(!0),n=e(this).cell,r=i(n);r.splitToCells(n),t.moveToBookmark(a).select()}},UE.commands["splittorows"]={queryCommandState:function(){var t=e(this),a=t.cell;if(!a)return-1;var n=i(t.table);return n.selectedTds.length>0?-1:a&&a.rowSpan>1?0:-1},execCommand:function(){var t=this.selection.getRange(),a=t.createBookmark(!0),n=e(this).cell,r=i(n);r.splitToRows(n),t.moveToBookmark(a).select()}},UE.commands["splittocols"]={queryCommandState:function(){var t=e(this),a=t.cell;if(!a)return-1;var n=i(t.table);return n.selectedTds.length>0?-1:a&&a.colSpan>1?0:-1},execCommand:function(){var t=this.selection.getRange(),a=t.createBookmark(!0),n=e(this).cell,r=i(n);r.splitToCols(n),t.moveToBookmark(a).select()}},UE.commands["adaptbytext"]=UE.commands["adaptbywindow"]={queryCommandState:function(){return e(this).table?0:-1},execCommand:function(t){var a=e(this),n=a.table;if(n)if("adaptbywindow"==t)r(n,this);else{var i=domUtils.getElementsByTagName(n,"td th");utils.each(i,(function(t){t.removeAttribute("width")})),n.removeAttribute("width")}}},UE.commands["averagedistributecol"]={queryCommandState:function(){var t=a(this);return t&&(t.isFullRow()||t.isFullCol())?0:-1},execCommand:function(t){var e=this,i=a(e);function r(){var t,a=i.table,r=0,s=0,o=n(e,a);if(i.isFullRow())r=a.offsetWidth,s=i.colsNum;else for(var l,u=i.cellsRange.beginColIndex,d=i.cellsRange.endColIndex,c=u;c<=d;)l=i.selectedTds[c],r+=l.offsetWidth,c+=l.colSpan,s+=1;return t=Math.ceil(r/s)-2*o.tdBorder-2*o.tdPadding,t}function s(t){utils.each(domUtils.getElementsByTagName(i.table,"th"),(function(t){t.setAttribute("width","")}));var e=i.isFullRow()?domUtils.getElementsByTagName(i.table,"td"):i.selectedTds;utils.each(e,(function(e){1==e.colSpan&&e.setAttribute("width",t)}))}i&&i.selectedTds.length&&s(r())}},UE.commands["averagedistributerow"]={queryCommandState:function(){var t=a(this);return t?t.selectedTds&&/th/gi.test(t.selectedTds[0].tagName)?-1:t.isFullRow()||t.isFullCol()?0:-1:-1},execCommand:function(t){var e=this,i=a(e);function r(){var t,a,r=0,s=i.table,o=n(e,s),l=parseInt(domUtils.getComputedStyle(s.getElementsByTagName("td")[0],"padding-top"));if(i.isFullCol()){var u,d,c=domUtils.getElementsByTagName(s,"caption"),p=domUtils.getElementsByTagName(s,"th");c.length>0&&(u=c[0].offsetHeight),p.length>0&&(d=p[0].offsetHeight),r=s.offsetHeight-(u||0)-(d||0),a=0==p.length?i.rowsNum:i.rowsNum-1}else{for(var h=i.cellsRange.beginRowIndex,g=i.cellsRange.endRowIndex,f=0,m=domUtils.getElementsByTagName(s,"tr"),v=h;v<=g;v++)r+=m[v].offsetHeight,f+=1;a=f}return t=browser.ie&&browser.version<9?Math.ceil(r/a):Math.ceil(r/a)-2*o.tdBorder-2*l,t}function s(t){var e=i.isFullCol()?domUtils.getElementsByTagName(i.table,"td"):i.selectedTds;utils.each(e,(function(e){1==e.rowSpan&&e.setAttribute("height",t)}))}i&&i.selectedTds.length&&s(r())}},UE.commands["cellalignment"]={queryCommandState:function(){return e(this).table?0:-1},execCommand:function(t,e){var n=this,i=a(n);if(i)utils.each(i.selectedTds,(function(t){domUtils.setAttributes(t,e)}));else{var r=n.selection.getStart(),s=r&&domUtils.findParentByTagName(r,["td","th","caption"],!0);/caption/gi.test(s.tagName)?(s.style.textAlign=e.align,s.style.verticalAlign=e.vAlign):domUtils.setAttributes(s,e),n.selection.getRange().setCursor(!0)}},queryCommandValue:function(t){var a=e(this).cell;if(a||(a=o(this)[0]),a){var n=UE.UETable.getUETable(a).selectedTds;return!n.length&&(n=a),UE.UETable.getTableCellAlignState(n)}return null}},UE.commands["tablealignment"]={queryCommandState:function(){return browser.ie&&browser.version<8?-1:e(this).table?0:-1},execCommand:function(t,e){var a=this,n=a.selection.getStart(),i=n&&domUtils.findParentByTagName(n,["table"],!0);i&&i.setAttribute("align",e)}},UE.commands["edittable"]={queryCommandState:function(){return e(this).table?0:-1},execCommand:function(t,e){var a=this.selection.getRange(),n=domUtils.findParentByTagName(a.startContainer,"table");if(n){var i=domUtils.getElementsByTagName(n,"td").concat(domUtils.getElementsByTagName(n,"th"),domUtils.getElementsByTagName(n,"caption"));utils.each(i,(function(t){t.style.borderColor=e}))}}},UE.commands["edittd"]={queryCommandState:function(){return e(this).table?0:-1},execCommand:function(t,e){var n=this,i=a(n);if(i)utils.each(i.selectedTds,(function(t){t.style.backgroundColor=e}));else{var r=n.selection.getStart(),s=r&&domUtils.findParentByTagName(r,["td","th","caption"],!0);s&&(s.style.backgroundColor=e)}}},UE.commands["settablebackground"]={queryCommandState:function(){return o(this).length>1?0:-1},execCommand:function(t,e){var a,n;a=o(this),n=i(a[0]),n.setBackground(a,e)}},UE.commands["cleartablebackground"]={queryCommandState:function(){var t=o(this);if(!t.length)return-1;for(var e,a=0;e=t[a++];)if(""!==e.style.backgroundColor)return 0;return-1},execCommand:function(){var t=o(this),e=i(t[0]);e.removeBackground(t)}},UE.commands["interlacetable"]=UE.commands["uninterlacetable"]={queryCommandState:function(t){var a=e(this).table;if(!a)return-1;var n=a.getAttribute("interlaced");return"interlacetable"==t?"enabled"===n?-1:0:n&&"disabled"!==n?0:-1},execCommand:function(t,a){var n=e(this).table;"interlacetable"==t?(n.setAttribute("interlaced","enabled"),this.fireEvent("interlacetable",n,a)):(n.setAttribute("interlaced","disabled"),this.fireEvent("uninterlacetable",n))}},UE.commands["setbordervisible"]={queryCommandState:function(t){var a=e(this).table;return a?0:-1},execCommand:function(){var t=e(this).table;utils.each(domUtils.getElementsByTagName(t,"td"),(function(t){t.style.borderWidth="1px",t.style.borderStyle="solid"}))}}}(),UE.plugins["table"]=function(){var t=this,e=null,a=5,n=!1,i=5,r=10,s=0,o=null,l=360,u=UE.UETable,d=function(t){return u.getUETable(t)},c=function(t){return u.getUETableBySelected(t)},p=function(t,e){return u.getDefaultValue(t,e)},h=function(t){return u.removeSelectedClass(t)};function g(t){}t.ready((function(){var t=this,e=t.selection.getText;t.selection.getText=function(){var a=c(t);if(a){var n="";return utils.each(a.selectedTds,(function(t){n+=t[browser.ie?"innerText":"textContent"]})),n}return e.call(t.selection)}}));var f=null,m=null,v="",b=!1,y=null,_=!1,D=null,C=null,w=!1,x=!0;t.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:t.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:!1,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]}),t.getUETable=d;var k={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1};function S(t,e){A(t,"width",!0),A(t,"height",!0)}function A(t,e,a){t.style[e]&&(a&&t.setAttribute(e,parseInt(t.style[e],10)),t.style[e]="")}function E(t){return"TD"==t.tagName||"TH"==t.tagName?t:(e=domUtils.findParentByTagName(t,"td",!0)||domUtils.findParentByTagName(t,"th",!0))?e:null;var e}function T(t){var e=new RegExp(domUtils.fillChar,"g");if(t[browser.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(e,"").length>0)return 0;for(var a in dtd.$isNotEmpty)if(t.getElementsByTagName(a).length)return 0;return 1}function I(e){return e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+t.document.body.scrollLeft-t.document.body.clientLeft,y:e.clientY+t.document.body.scrollTop-t.document.body.clientTop}}function P(e){if(!J())try{var a,i=E(e.target||e.srcElement);if(n&&(t.body.style.webkitUserSelect="none",(Math.abs(o.x-e.clientX)>r||Math.abs(o.y-e.clientY)>r)&&(z(),n=!1,s=0,q(e))),v&&C)return s=0,t.body.style.webkitUserSelect="none",t.selection.getNative()[browser.ie9below?"empty":"removeAllRanges"](),a=I(e),L(t,!0,v,a,i),void("h"==v?D.style.left=O(C,e)+"px":"v"==v&&(D.style.top=M(C,e)+"px"));if(i){if(!0===t.fireEvent("excludetable",i))return;a=I(e);var l=U(i,a),u=domUtils.findParentByTagName(i,"table",!0);if(B(u,i,e,!0)){if(!0===t.fireEvent("excludetable",u))return;t.body.style.cursor="url("+t.options.cursorpath+"h.png),pointer"}else if(B(u,i,e)){if(!0===t.fireEvent("excludetable",u))return;t.body.style.cursor="url("+t.options.cursorpath+"v.png),pointer"}else{t.body.style.cursor="text";/\d/.test(l)&&(l=l.replace(/\d/,""),i=d(i).getPreviewCell(i,"v"==l)),L(t,!!i&&!!l,i?l:"",a,i)}}else N(!1,u,t)}catch(c){g(c)}}function N(t,e,a){if(t)R(e,a);else{if(_)return;setTimeout((function(){!_&&y&&y.parentNode&&y.parentNode.removeChild(y)}),2e3)}}function R(t,e){var a,n=domUtils.getXY(t),i=t.ownerDocument;if(y&&y.parentNode)return y;function r(n,i){clearTimeout(a),a=setTimeout((function(){e.fireEvent("tableClicked",t,i)}),300)}function s(n){clearTimeout(a);var i=d(t),r=t.rows[0].cells[0],s=i.getLastCell(),o=i.getCellsRange(r,s);e.selection.getRange().setStart(r,0).setCursor(!1,!0),i.setSelected(o)}y=i.createElement("div"),y.contentEditable=!1,y.innerHTML="",y.style.cssText="width:15px;height:15px;background-image:url("+e.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(n.y-15)+"px;left:"+n.x+"px;",domUtils.unSelectable(y),y.onmouseover=function(t){_=!0},y.onmouseout=function(t){_=!1},domUtils.on(y,"click",(function(t,e){r(e,this)})),domUtils.on(y,"dblclick",(function(t,e){s(e)})),domUtils.on(y,"dragstart",(function(t,e){domUtils.preventDefault(e)})),i.body.appendChild(y)}function B(t,e,a,n){var i=I(a),r=U(e,i);if(n){var s=t.getElementsByTagName("caption")[0],o=s?s.offsetHeight:0;return"v1"==r&&i.y-domUtils.getXY(t).y-o<8}return"h1"==r&&i.x-domUtils.getXY(t).x<8}function O(e,n){var i=d(e);if(i){var r=i.getSameEndPosCells(e,"x")[0],s=i.getSameStartPosXCells(e)[0],o=I(n).x,l=(r?domUtils.getXY(r).x:domUtils.getXY(i.table).x)+20,u=s?domUtils.getXY(s).x+s.offsetWidth-20:t.body.offsetWidth+5||parseInt(domUtils.getComputedStyle(t.body,"width"),10);return l+=a,u-=a,o<l?l:o>u?u:o}}function M(t,e){try{var a=domUtils.getXY(t).y,n=I(e).y;return n<a?a:n}catch(i){g(i)}}function L(t,e,a,n,i){try{t.body.style.cursor="h"==a?"col-resize":"v"==a?"row-resize":"text",browser.ie&&(!a||w||c(t)?rt(t):(it(t,t.document),st(a,i))),b=e}catch(r){g(r)}}function U(t,e){var a=domUtils.getXY(t);return a?a.x+t.offsetWidth-e.x<i?"h":e.x-a.x<i?"h1":a.y+t.offsetHeight-e.y<i?"v":e.y-a.y<i?"v1":"":""}function F(e,a){if(!J())if(o={x:a.clientX,y:a.clientY},2==a.button){var n=c(t),i=!1;if(n){var r=dt(t,a);utils.each(n.selectedTds,(function(t){t===r&&(i=!0)})),i?(r=n.selectedTds[0],setTimeout((function(){t.selection.getRange().setStart(r,0).setCursor(!1,!0)}),0)):(h(domUtils.getElementsByTagName(t.body,"th td")),n.clearSelected())}}else H(a)}function $(e){s=0,e=e||t.window.event;var a,n=E(e.target||e.srcElement);if(n&&(a=U(n,I(e)))){if(rt(t),"h1"==a)if(a="h",B(domUtils.findParentByTagName(n,"table"),n,e))t.execCommand("adaptbywindow");else if(n=d(n).getPreviewCell(n),n){var i=t.selection.getRange();i.selectNodeContents(n).setCursor(!0,!0)}if("h"==a){var r=d(n),o=r.table,l=Q(n,o,!0);l=W(l,"left"),r.width=r.offsetWidth;var u=[],c=[];utils.each(l,(function(t){u.push(t.offsetWidth)})),utils.each(l,(function(t){t.removeAttribute("width")})),window.setTimeout((function(){var t=!0;utils.each(l,(function(e,a){var n=e.offsetWidth;if(n>u[a])return t=!1,!1;c.push(n)}));var e=t?c:u;utils.each(l,(function(t,a){t.width=e[a]-nt()}))}),0)}}}function H(e){if(h(domUtils.getElementsByTagName(t.body,"td th")),utils.each(t.document.getElementsByTagName("table"),(function(t){t.ueTable=null})),f=dt(t,e),f){var a=domUtils.findParentByTagName(f,"table",!0);ut=d(a),ut&&ut.clearSelected(),b?j(e):(t.document.body.style.webkitUserSelect="",w=!0,t.addListener("mouseover",K))}}function j(t){browser.ie&&(t=V(t)),z(),n=!0,e=setTimeout((function(){q(t)}),l)}function W(t,e){for(var a=[],n=null,i=0,r=t.length;i<r;i++)n=t[i][e],n&&a.push(n);return a}function z(){e&&clearTimeout(e),e=null}function V(t){var e=["pageX","pageY","clientX","clientY","srcElement","target"],a={};if(t)for(var n,i,r=0;n=e[r];r++)i=t[n],i&&(a[n]=i);return a}function q(e){if(n=!1,f=e.target||e.srcElement,f){var a=U(f,I(e));/\d/.test(a)&&(a=a.replace(/\d/,""),f=d(f).getPreviewCell(f,"v"==a)),rt(t),it(t,t.document),t.fireEvent("saveScene"),st(a,f),w=!0,v=a,C=f}}function G(t,e){if(!J()){if(z(),n=!1,b&&(s=++s%3,o={x:e.clientX,y:e.clientY},setTimeout((function(){s>0&&s--}),l),2===s))return s=0,void $(e);if(2!=e.button){var a=this,i=a.selection.getRange(),r=domUtils.findParentByTagName(i.startContainer,"table",!0),u=domUtils.findParentByTagName(i.endContainer,"table",!0);if((r||u)&&(r===u?(r=domUtils.findParentByTagName(i.startContainer,["td","th","caption"],!0),u=domUtils.findParentByTagName(i.endContainer,["td","th","caption"],!0),r!==u&&a.selection.clearRange()):a.selection.clearRange()),w=!1,a.document.body.style.webkitUserSelect="",v&&C&&(a.selection.getNative()[browser.ie9below?"empty":"removeAllRanges"](),s=0,D=a.document.getElementById("ue_tableDragLine"),D)){var c=domUtils.getXY(C),p=domUtils.getXY(D);switch(v){case"h":Y(C,p.x-c.x);break;case"v":Z(C,p.y-c.y-C.offsetHeight);break;default:}return v="",C=null,rt(a),void a.fireEvent("saveScene")}if(f){var h=d(f),g=h?h.selectedTds[0]:null;if(g)i=new dom.Range(a.document),domUtils.isEmptyBlock(g)?i.setStart(g,0).setCursor(!1,!0):i.selectNodeContents(g).shrinkBoundary().setCursor(!1,!0);else if(i=a.selection.getRange().shrinkBoundary(),!i.collapsed){r=domUtils.findParentByTagName(i.startContainer,["td","th"],!0),u=domUtils.findParentByTagName(i.endContainer,["td","th"],!0);(r&&!u||!r&&u||r&&u&&r!==u)&&i.setCursor(!1,!0)}f=null,a.removeListener("mouseover",K)}else{var m=domUtils.findParentByTagName(e.target||e.srcElement,"td",!0);if(m||(m=domUtils.findParentByTagName(e.target||e.srcElement,"th",!0)),m&&("TD"==m.tagName||"TH"==m.tagName)){if(!0===a.fireEvent("excludetable",m))return;i=new dom.Range(a.document),i.setStart(m,0).setCursor(!1,!0)}}a._selectionChange(250,e)}}}function K(t,e){if(!J()){var a=this,n=e.target||e.srcElement;if(m=domUtils.findParentByTagName(n,"td",!0)||domUtils.findParentByTagName(n,"th",!0),f&&m&&("TD"==f.tagName&&"TD"==m.tagName||"TH"==f.tagName&&"TH"==m.tagName)&&domUtils.findParentByTagName(f,"table")==domUtils.findParentByTagName(m,"table")){var i=d(m);if(f!=m){a.document.body.style.webkitUserSelect="none",a.selection.getNative()[browser.ie9below?"empty":"removeAllRanges"]();var r=i.getCellsRange(f,m);i.setSelected(r)}else a.document.body.style.webkitUserSelect="",i.clearSelected()}e.preventDefault?e.preventDefault():e.returnValue=!1}}function X(t,e,a){var n=parseInt(domUtils.getComputedStyle(t,"line-height"),10),i=a+e;e=i<n?n:i,t.style.height&&(t.style.height=""),1==t.rowSpan?t.setAttribute("height",e):t.removeAttribute&&t.removeAttribute("height")}function Y(t,e){var a=d(t);if(a){var n=a.table,i=Q(t,n);if(n.style.width="",n.removeAttribute("width"),e=tt(e,t,i),t.nextSibling){utils.each(i,(function(t){t.left.width=+t.left.width+e,t.right&&(t.right.width=+t.right.width-e)}))}else utils.each(i,(function(t){t.left.width-=-e}))}}function J(){return"false"===t.body.contentEditable}function Z(t,e){if(!(Math.abs(e)<10)){var a=d(t);if(a)for(var n,i=a.getSameEndPosCells(t,"y"),r=i[0]?i[0].offsetHeight:0,s=0;n=i[s++];)X(n,e,r)}}function Q(t,e,a){if(e||(e=domUtils.findParentByTagName(t,"table")),!e)return null;domUtils.getNodeIndex(t);var n=t,i=e.rows,r=0;while(n)1===n.nodeType&&(r+=n.colSpan||1),n=n.previousSibling;n=null;var s=[];return utils.each(i,(function(t){var e=t.cells,n=0;utils.each(e,(function(t){return n+=t.colSpan||1,n===r?(s.push({left:t,right:t.nextSibling||null}),!1):n>r?(a&&s.push({left:t}),!1):void 0}))})),s}function tt(t,e,n){if(t-=nt(),t<0)return 0;t-=et(e);var i=t<0?"left":"right";return t=Math.abs(t),utils.each(n,(function(e){var n=e[i];n&&(t=Math.min(t,et(n)-a))})),t=t<0?0:t,"left"===i?-t:t}function et(t){var e=0;e=t.offsetWidth-nt();t.nextSibling||(e-=at(t)),e=e<0?0:e;try{t.width=e}catch(a){}return e}function at(t){if(tab=domUtils.findParentByTagName(t,"table",!1),void 0===tab.offsetVal){var e=t.previousSibling;tab.offsetVal=e&&t.offsetWidth-e.offsetWidth===u.borderWidth?u.borderWidth:0}return tab.offsetVal}function nt(){if(void 0===u.tabcellSpace){var e=t.document.createElement("table"),a=t.document.createElement("tbody"),n=t.document.createElement("tr"),i=t.document.createElement("td"),r=null;i.style.cssText="border: 0;",i.width=1,n.appendChild(i),n.appendChild(r=i.cloneNode(!1)),a.appendChild(n),e.appendChild(a),e.style.cssText="visibility: hidden;",t.body.appendChild(e),u.paddingSpace=i.offsetWidth-1;var s=e.offsetWidth;i.style.cssText="",r.style.cssText="",u.borderWidth=(e.offsetWidth-s)/3,u.tabcellSpace=u.paddingSpace+u.borderWidth,t.body.removeChild(e)}return nt=function(){return u.tabcellSpace},u.tabcellSpace}function it(t,e){w||(D=t.document.createElement("div"),domUtils.setAttributes(D,{id:"ue_tableDragLine",unselectable:"on",contenteditable:!1,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"}),t.body.appendChild(D))}function rt(t){var e;if(!w)while(e=t.document.getElementById("ue_tableDragLine"))domUtils.remove(e)}function st(t,e){if(e){var a,n=domUtils.findParentByTagName(e,"table"),i=n.getElementsByTagName("caption"),r=n.offsetWidth,s=n.offsetHeight-(i.length>0?i[0].offsetHeight:0),o=domUtils.getXY(n),l=domUtils.getXY(e);switch(t){case"h":a="height:"+s+"px;top:"+(o.y+(i.length>0?i[0].offsetHeight:0))+"px;left:"+(l.x+e.offsetWidth),D.style.cssText=a+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":a="width:"+r+"px;left:"+o.x+"px;top:"+(l.y+e.offsetHeight),D.style.cssText=a+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)";break;default:}}}function ot(t,e){for(var a,n,i=domUtils.getElementsByTagName(t.body,"table"),r=0;n=i[r++];){var s=domUtils.getElementsByTagName(n,"td");s[0]&&(e?(a=s[0].style.borderColor.replace(/\s/g,""),/(#ffffff)|(rgb\(255,255,255\))/gi.test(a)&&domUtils.addClass(n,"noBorderTable")):domUtils.removeClasses(n,"noBorderTable"))}}function lt(t,e,a){var n=t.body;return n.offsetWidth-(e?2*parseInt(domUtils.getComputedStyle(n,"margin-left"),10):0)-2*a.tableBorder-(t.options.offsetWidth||0)}function dt(t,e){var a=domUtils.findParentByTagName(e.target||e.srcElement,["td","th"],!0),n=null;if(!a)return null;if(n=U(a,I(e)),!a)return null;if("h1"===n&&a.previousSibling){var i=domUtils.getXY(a),r=a.offsetWidth;Math.abs(i.x+r-e.clientX)>r/3&&(a=a.previousSibling)}else if("v1"===n&&a.parentNode.previousSibling){i=domUtils.getXY(a);var s=a.offsetHeight;Math.abs(i.y+s-e.clientY)>s/3&&(a=a.parentNode.previousSibling.firstChild)}return a&&!0!==t.fireEvent("excludetable",a)?a:null}t.ready((function(){var e,a,n,i;utils.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:1px solid #BBB;background-color:#F7F7F7;}table tr.firstRow th{border-top-width:2px;}.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }td p{margin:0;padding:0;}",t.document),t.addListener("keydown",(function(t,i){var r=this,s=i.keyCode||i.which;if(8==s){var o=c(r);o&&o.selectedTds.length&&(o.isFullCol()?r.execCommand("deletecol"):o.isFullRow()?r.execCommand("deleterow"):r.fireEvent("delcells"),domUtils.preventDefault(i));var l=domUtils.findParentByTagName(r.selection.getStart(),"caption",!0),u=r.selection.getRange();if(u.collapsed&&l&&T(l)){r.fireEvent("saveScene");var d=l.parentNode;domUtils.remove(l),d&&u.setStart(d.rows[0].cells[0],0).setCursor(!1,!0),r.fireEvent("saveScene")}}if(46==s&&(o=c(r),o)){r.fireEvent("saveScene");for(var p=0;y=o.selectedTds[p++];)domUtils.fillNode(r.document,y);r.fireEvent("saveScene"),domUtils.preventDefault(i)}if(13==s){var h=r.selection.getRange();l=domUtils.findParentByTagName(h.startContainer,"caption",!0);if(l){d=domUtils.findParentByTagName(l,"table");return h.collapsed?l&&h.setStart(d.rows[0].cells[0],0).setCursor(!1,!0):(h.deleteContents(),r.fireEvent("saveScene")),void domUtils.preventDefault(i)}if(h.collapsed){d=domUtils.findParentByTagName(h.startContainer,"table");if(d){var g=d.rows[0].cells[0],f=domUtils.findParentByTagName(r.selection.getStart(),["td","th"],!0),m=d.previousSibling;if(g===f&&(!m||1==m.nodeType&&"TABLE"==m.tagName)&&domUtils.isStartInblock(h)){var v=domUtils.findParent(r.selection.getStart(),(function(t){return domUtils.isBlockElm(t)}),!0);v&&(/t(h|d)/i.test(v.tagName)||v===f.firstChild)&&(r.execCommand("insertparagraphbeforetable"),domUtils.preventDefault(i))}}}}if((i.ctrlKey||i.metaKey)&&"67"==i.keyCode){e=null;o=c(r);if(o){var b=o.selectedTds;a=o.isFullCol(),n=o.isFullRow(),e=[[o.cloneCell(b[0],null,!0)]];var y;for(p=1;y=b[p];p++)y.parentNode!==b[p-1].parentNode?e.push([o.cloneCell(y,null,!0)]):e[e.length-1].push(o.cloneCell(y,null,!0))}}})),t.addListener("tablehasdeleted",(function(){L(this,!1,"",null),y&&domUtils.remove(y)})),t.addListener("beforepaste",(function(t,i){var r=this,s=r.selection.getRange();if(domUtils.findParentByTagName(s.startContainer,"caption",!0)){var o=r.document.createElement("div");return o.innerHTML=i.html,void(i.html=o[browser.ie9below?"innerText":"textContent"])}var l=c(r);if(e){r.fireEvent("saveScene");s=r.selection.getRange();var h,g,f=domUtils.findParentByTagName(s.startContainer,["td","th"],!0);if(f){var m=d(f);if(n){var v=m.getCellInfo(f).rowIndex;"TH"==f.tagName&&v++;for(var b=0;w=e[b++];){for(var y=m.insertRow(v++,"td"),_=0;E=w[_];_++){var D=y.cells[_];D||(D=y.insertCell(_)),D.innerHTML=E.innerHTML,E.getAttribute("width")&&D.setAttribute("width",E.getAttribute("width")),E.getAttribute("vAlign")&&D.setAttribute("vAlign",E.getAttribute("vAlign")),E.getAttribute("align")&&D.setAttribute("align",E.getAttribute("align")),E.style.cssText&&(D.style.cssText=E.style.cssText)}for(_=0;E=y.cells[_];_++){if(!w[_])break;E.innerHTML=w[_].innerHTML,w[_].getAttribute("width")&&E.setAttribute("width",w[_].getAttribute("width")),w[_].getAttribute("vAlign")&&E.setAttribute("vAlign",w[_].getAttribute("vAlign")),w[_].getAttribute("align")&&E.setAttribute("align",w[_].getAttribute("align")),w[_].style.cssText&&(E.style.cssText=w[_].style.cssText)}}}else{if(a){A=m.getCellInfo(f);for(var C=0,w=(_=0,e[0]);E=w[_++];)C+=E.colSpan||1;for(r.__hasEnterExecCommand=!0,b=0;b<C;b++)r.execCommand("insertcol");r.__hasEnterExecCommand=!1,f=m.table.rows[0].cells[A.cellIndex],"TH"==f.tagName&&(f=m.table.rows[1].cells[A.cellIndex])}for(b=0;w=e[b++];){h=f;for(_=0;E=w[_++];)if(f)f.innerHTML=E.innerHTML,E.getAttribute("width")&&f.setAttribute("width",E.getAttribute("width")),E.getAttribute("vAlign")&&f.setAttribute("vAlign",E.getAttribute("vAlign")),E.getAttribute("align")&&f.setAttribute("align",E.getAttribute("align")),E.style.cssText&&(f.style.cssText=E.style.cssText),g=f,f=f.nextSibling;else{var k=E.cloneNode(!0);domUtils.removeAttributes(k,["class","rowSpan","colSpan"]),g.parentNode.appendChild(k)}if(f=m.getNextCell(h,!0,!0),!e[b])break;if(!f){var A=m.getCellInfo(h);m.table.insertRow(m.table.rows.length),m.update(),f=m.getVSideCell(h,!0)}}}m.update()}else{l=r.document.createElement("table");for(b=0;w=e[b++];){var E;for(y=l.insertRow(l.rows.length),_=0;E=w[_++];)k=u.cloneCell(E,null,!0),domUtils.removeAttributes(k,["class"]),y.appendChild(k);2==_&&k.rowSpan>1&&(k.rowSpan=1)}var I=p(r),P=r.body.offsetWidth-(x?2*parseInt(domUtils.getComputedStyle(r.body,"margin-left"),10):0)-2*I.tableBorder-(r.options.offsetWidth||0);r.execCommand("insertHTML","<table  "+(a&&n?'width="'+P+'"':"")+">"+l.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}return r.fireEvent("contentchange"),r.fireEvent("saveScene"),i.html="",!0}var N;o=r.document.createElement("div");o.innerHTML=i.html,N=o.getElementsByTagName("table"),domUtils.findParentByTagName(r.selection.getStart(),"table")?(utils.each(N,(function(t){domUtils.remove(t)})),domUtils.findParentByTagName(r.selection.getStart(),"caption",!0)&&(o.innerHTML=o[browser.ie?"innerText":"textContent"])):utils.each(N,(function(t){S(t,!0),domUtils.removeAttributes(t,["style","border"]),utils.each(domUtils.getElementsByTagName(t,"td"),(function(t){T(t)&&domUtils.fillNode(r.document,t),S(t,!0)}))})),i.html=o.innerHTML})),t.addListener("afterpaste",(function(){utils.each(domUtils.getElementsByTagName(t.body,"table"),(function(e){if(e.offsetWidth>t.body.offsetWidth){var a=p(t,e);e.style.width=t.body.offsetWidth-(x?2*parseInt(domUtils.getComputedStyle(t.body,"margin-left"),10):0)-2*a.tableBorder-(t.options.offsetWidth||0)+"px"}}))})),t.addListener("blur",(function(){e=null})),t.addListener("keydown",(function(){clearTimeout(i),i=setTimeout((function(){var e=t.selection.getRange(),a=domUtils.findParentByTagName(e.startContainer,["th","td"],!0);if(a){var n=a.parentNode.parentNode.parentNode;n.offsetWidth>n.getAttribute("width")&&(a.style.wordBreak="break-all")}}),100)})),t.addListener("selectionchange",(function(){L(t,!1,"",null)})),t.addListener("contentchange",(function(){var t=this;if(rt(t),!c(t)){var e=t.selection.getRange(),a=e.startContainer;a=domUtils.findParentByTagName(a,["td","th"],!0),utils.each(domUtils.getElementsByTagName(t.document,"table"),(function(e){!0!==t.fireEvent("excludetable",e)&&(e.ueTable=new u(e),e.onmouseover=function(){t.fireEvent("tablemouseover",e)},e.onmousemove=function(){t.fireEvent("tablemousemove",e),t.options.tableDragable&&N(!0,this,t),utils.defer((function(){t.fireEvent("contentchange",50)}),!0)},e.onmouseout=function(){t.fireEvent("tablemouseout",e),L(t,!1,"",null),rt(t)},e.onclick=function(e){e=t.window.event||e;var a=E(e.target||e.srcElement);if(a){var n,i=d(a),r=i.table,s=i.getCellInfo(a),o=t.selection.getRange();if(B(r,a,e,!0)){var l=i.getCell(i.indexTable[i.rowsNum-1][s.colIndex].rowIndex,i.indexTable[i.rowsNum-1][s.colIndex].cellIndex);e.shiftKey&&i.selectedTds.length?i.selectedTds[0]!==l?(n=i.getCellsRange(i.selectedTds[0],l),i.setSelected(n)):o&&o.selectNodeContents(l).select():a!==l?(n=i.getCellsRange(a,l),i.setSelected(n)):o&&o.selectNodeContents(l).select()}else if(B(r,a,e)){var u=i.getCell(i.indexTable[s.rowIndex][i.colsNum-1].rowIndex,i.indexTable[s.rowIndex][i.colsNum-1].cellIndex);e.shiftKey&&i.selectedTds.length?i.selectedTds[0]!==u?(n=i.getCellsRange(i.selectedTds[0],u),i.setSelected(n)):o&&o.selectNodeContents(u).select():a!==u?(n=i.getCellsRange(a,u),i.setSelected(n)):o&&o.selectNodeContents(u).select()}}})})),ot(t,!0)}})),domUtils.on(t.document,"mousemove",P),domUtils.on(t.document,"mouseout",(function(e){var a=e.target||e.srcElement;"TABLE"==a.tagName&&L(t,!1,"",null)})),t.addListener("interlacetable",(function(t,e,a){if(e)for(var n=this,i=e.rows,r=i.length,s=function(t,e,a){return t[e]?t[e]:a?t[e%t.length]:""},o=0;o<r;o++)i[o].className=s(a||n.options.classList,o,!0)})),t.addListener("uninterlacetable",(function(t,e){if(e)for(var a=this,n=e.rows,i=a.options.classList,r=n.length,s=0;s<r;s++)domUtils.removeClasses(n[s],i)})),t.addListener("mousedown",F),t.addListener("mouseup",G),domUtils.on(t.body,"dragstart",(function(e){G.call(t,"dragstart",e)})),t.addOutputRule((function(t){utils.each(t.getNodesByTagName("div"),(function(t){"ue_tableDragLine"==t.getAttr("id")&&t.parentNode.removeChild(t)}))}));var r=0;t.addListener("mousedown",(function(){r=0})),t.addListener("tabkeydown",(function(){var e=this.selection.getRange(),a=e.getCommonAncestor(!0,!0),n=domUtils.findParentByTagName(a,"table");if(n){if(domUtils.findParentByTagName(a,"caption",!0)){var i=domUtils.getElementsByTagName(n,"th td");i&&i.length&&e.setStart(i[0],0).setCursor(!1,!0)}else{i=domUtils.findParentByTagName(a,["td","th"],!0);var s=d(i);r=i.rowSpan>1?r:s.getCellInfo(i).rowIndex;var o=s.getTabNextCell(i,r);o?T(o)?e.setStart(o,0).setCursor(!1,!0):e.selectNodeContents(o).select():(t.fireEvent("saveScene"),t.__hasEnterExecCommand=!0,this.execCommand("insertrownext"),t.__hasEnterExecCommand=!1,e=this.selection.getRange(),e.setStart(n.rows[n.rows.length-1].cells[0],0).setCursor(),t.fireEvent("saveScene"))}return!0}})),browser.ie&&t.addListener("selectionchange",(function(){L(this,!1,"",null)})),t.addListener("keydown",(function(t,e){var a=this,n=e.keyCode||e.which;if(8!=n&&46!=n){var i=!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&!e.altKey;i&&h(domUtils.getElementsByTagName(a.body,"td"));var r=c(a);r&&i&&r.clearSelected()}})),t.addListener("beforegetcontent",(function(){ot(this,!1),browser.ie&&utils.each(this.document.getElementsByTagName("caption"),(function(t){domUtils.isEmptyNode(t)&&(t.innerHTML="&nbsp;")}))})),t.addListener("aftergetcontent",(function(){ot(this,!0)})),t.addListener("getAllHtml",(function(){h(t.document.getElementsByTagName("td"))})),t.addListener("fullscreenchanged",(function(e,a){if(!a){var n=this.body.offsetWidth/document.body.offsetWidth,i=domUtils.getElementsByTagName(this.body,"table");utils.each(i,(function(e){if(e.offsetWidth<t.body.offsetWidth)return!1;var a=domUtils.getElementsByTagName(e,"td"),i=[];utils.each(a,(function(t){i.push(t.offsetWidth)}));for(var r,s=0;r=a[s];s++)r.setAttribute("width",Math.floor(i[s]*n));e.setAttribute("width",Math.floor(lt(t,x,p(t))))}))}}));var s=t.execCommand;t.execCommand=function(t,e){var a=this;t=t.toLowerCase();var n,i,r=c(a),o=new dom.Range(a.document),l=a.commands[t]||UE.commands[t];if(l){if(!r||k[t]||l.notNeedUndo||a.__hasEnterExecCommand)i=s.apply(a,arguments);else{a.__hasEnterExecCommand=!0,a.fireEvent("beforeexeccommand",t),n=r.selectedTds;for(var u,d,p,h=-2,g=-2,f=0;p=n[f];f++)T(p)?o.setStart(p,0).setCursor(!1,!0):o.selectNode(p).select(!0),d=a.queryCommandState(t),u=a.queryCommandValue(t),-1!=d&&(h===d&&g===u||(a._ignoreContentChange=!0,i=s.apply(a,arguments),a._ignoreContentChange=!1),h=a.queryCommandState(t),g=a.queryCommandValue(t),domUtils.isEmptyBlock(p)&&domUtils.fillNode(a.document,p));o.setStart(n[0],0).shrinkBoundary(!0).setCursor(!1,!0),a.fireEvent("contentchange"),a.fireEvent("afterexeccommand",t),a.__hasEnterExecCommand=!1,a._selectionChange()}return i}}}))},UE.UETable.prototype.sortTable=function(t,e){var a=this.table,n=a.rows,i=[],r="TH"===n[0].cells[0].tagName,s=0;if(this.selectedTds.length){for(var o=this.cellsRange,l=o.endRowIndex+1,u=o.beginRowIndex;u<l;u++)i[u]=n[u];i.splice(0,o.beginRowIndex),s=o.endRowIndex+1===this.rowsNum?0:o.endRowIndex+1}else for(u=0,l=n.length;u<l;u++)i[u]=n[u];var d={reversecurrent:function(t,e){return 1},orderbyasc:function(t,e){var a=t.innerText||t.textContent,n=e.innerText||e.textContent;return a.localeCompare(n)},reversebyasc:function(t,e){var a=t.innerHTML,n=e.innerHTML;return n.localeCompare(a)},orderbynum:function(t,e){var a=t[browser.ie?"innerText":"textContent"].match(/\d+/),n=e[browser.ie?"innerText":"textContent"].match(/\d+/);return a&&(a=+a[0]),n&&(n=+n[0]),(a||0)-(n||0)},reversebynum:function(t,e){var a=t[browser.ie?"innerText":"textContent"].match(/\d+/),n=e[browser.ie?"innerText":"textContent"].match(/\d+/);return a&&(a=+a[0]),n&&(n=+n[0]),(n||0)-(a||0)}};a.setAttribute("data-sort-type",e&&"string"===typeof e&&d[e]?e:""),r&&i.splice(0,1),i=utils.sort(i,(function(a,n){var i;return i=e&&"function"===typeof e?e.call(this,a.cells[t],n.cells[t]):e&&"number"===typeof e?1:e&&"string"===typeof e&&d[e]?d[e].call(this,a.cells[t],n.cells[t]):d["orderbyasc"].call(this,a.cells[t],n.cells[t]),i}));var c=a.ownerDocument.createDocumentFragment(),p=0;for(l=i.length;p<l;p++)c.appendChild(i[p]);var h=a.getElementsByTagName("tbody")[0];s?h.insertBefore(c,n[s-o.endRowIndex+o.beginRowIndex-1]):h.appendChild(c)},UE.plugins["tablesort"]=function(){var t=this,e=UE.UETable,a=function(t){return e.getUETable(t)},n=function(t){return e.getTableItemsByRange(t)};t.ready((function(){utils.cssRule("tablesort","table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;   background-image:url("+t.options.themePath+t.options.theme+"/images/sortable.png);}",t.document),t.addListener("afterexeccommand",(function(t,e){"mergeright"!=e&&"mergedown"!=e&&"mergecells"!=e||this.execCommand("disablesort")}))})),UE.commands["sorttable"]={queryCommandState:function(){var t=this,e=n(t);if(!e.cell)return-1;for(var a,i=e.table,r=i.getElementsByTagName("td"),s=0;a=r[s++];)if(1!=a.rowSpan||1!=a.colSpan)return-1;return 0},execCommand:function(t,e){var i=this,r=i.selection.getRange(),s=r.createBookmark(!0),o=n(i),l=o.cell,u=a(o.table),d=u.getCellInfo(l);u.sortTable(d.cellIndex,e),r.moveToBookmark(s);try{r.select()}catch(c){}}},UE.commands["enablesort"]=UE.commands["disablesort"]={queryCommandState:function(t){var e=n(this).table;if(e&&"enablesort"==t)for(var a=domUtils.getElementsByTagName(e,"th td"),i=0;i<a.length;i++)if(a[i].getAttribute("colspan")>1||a[i].getAttribute("rowspan")>1)return-1;return e?"enablesort"==t^"sortEnabled"!=e.getAttribute("data-sort")?-1:0:-1},execCommand:function(t){var e=n(this).table;e.setAttribute("data-sort","enablesort"==t?"sortEnabled":"sortDisabled"),"enablesort"==t?domUtils.addClass(e,"sortEnabled"):domUtils.removeClasses(e,"sortEnabled")}}},UE.plugins["contextmenu"]=function(){var t=this;if(t.setOpt("enableContextMenu",!0),!1!==t.getOpt("enableContextMenu")){var e,a=t.getLang("contextMenu"),n=t.options.contextMenu||[{label:a["selectall"],cmdName:"selectall"},{label:a.cleardoc,cmdName:"cleardoc",exec:function(){confirm(a.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:a.unlink,cmdName:"unlink"},"-",{group:a.paragraph,icon:"justifyjustify",subMenu:[{label:a.justifyleft,cmdName:"justify",value:"left"},{label:a.justifyright,cmdName:"justify",value:"right"},{label:a.justifycenter,cmdName:"justify",value:"center"},{label:a.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:a.table,icon:"table",subMenu:[{label:a.inserttable,cmdName:"inserttable"},{label:a.deletetable,cmdName:"deletetable"},"-",{label:a.deleterow,cmdName:"deleterow"},{label:a.deletecol,cmdName:"deletecol"},{label:a.insertcol,cmdName:"insertcol"},{label:a.insertcolnext,cmdName:"insertcolnext"},{label:a.insertrow,cmdName:"insertrow"},{label:a.insertrownext,cmdName:"insertrownext"},"-",{label:a.insertcaption,cmdName:"insertcaption"},{label:a.deletecaption,cmdName:"deletecaption"},{label:a.inserttitle,cmdName:"inserttitle"},{label:a.deletetitle,cmdName:"deletetitle"},{label:a.inserttitlecol,cmdName:"inserttitlecol"},{label:a.deletetitlecol,cmdName:"deletetitlecol"},"-",{label:a.mergecells,cmdName:"mergecells"},{label:a.mergeright,cmdName:"mergeright"},{label:a.mergedown,cmdName:"mergedown"},"-",{label:a.splittorows,cmdName:"splittorows"},{label:a.splittocols,cmdName:"splittocols"},{label:a.splittocells,cmdName:"splittocells"},"-",{label:a.averageDiseRow,cmdName:"averagedistributerow"},{label:a.averageDisCol,cmdName:"averagedistributecol"},"-",{label:a.edittd,cmdName:"edittd",exec:function(){UE.ui["edittd"]&&new UE.ui["edittd"](this),this.getDialog("edittd").open()}},{label:a.edittable,cmdName:"edittable",exec:function(){UE.ui["edittable"]&&new UE.ui["edittable"](this),this.getDialog("edittable").open()}},{label:a.setbordervisible,cmdName:"setbordervisible"}]},{group:a.tablesort,icon:"tablesort",subMenu:[{label:a.enablesort,cmdName:"enablesort"},{label:a.disablesort,cmdName:"disablesort"},"-",{label:a.reversecurrent,cmdName:"sorttable",value:"reversecurrent"},{label:a.orderbyasc,cmdName:"sorttable",value:"orderbyasc"},{label:a.reversebyasc,cmdName:"sorttable",value:"reversebyasc"},{label:a.orderbynum,cmdName:"sorttable",value:"orderbynum"},{label:a.reversebynum,cmdName:"sorttable",value:"reversebynum"}]},{group:a.borderbk,icon:"borderBack",subMenu:[{label:a.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:a.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:a.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#bbb","#ccc"]})}},{label:a.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},{label:a.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["red","blue"]})}},{label:a.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:a.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:a.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:a.tableleft,value:"left"},{cmdName:"tablealignment",className:"center",label:a.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:a.tableright,value:"right"}]},"-",{label:a.insertparagraphbefore,cmdName:"insertparagraph",value:!0},{label:a.insertparagraphafter,cmdName:"insertparagraph"},{label:a["copy"],cmdName:"copy"},{label:a["paste"],cmdName:"paste"}];if(n.length){var i=UE.ui.uiUtils;t.addListener("contextmenu",(function(r,s){var o=i.getViewportOffsetByEvent(s);t.fireEvent("beforeselectionchange"),e&&e.destroy();for(var l,u=0,d=[];l=n[u];u++){var c;(function(e){if("-"==e)(c=d[d.length-1])&&"-"!==c&&d.push("-");else if(e.hasOwnProperty("group")){for(var n,i=0,r=[];n=e.subMenu[i];i++)(function(e){"-"==e?(c=r[r.length-1])&&"-"!==c?r.push("-"):r.splice(r.length-1):(t.commands[e.cmdName]||UE.commands[e.cmdName]||e.query)&&(e.query?e.query():t.queryCommandState(e.cmdName))>-1&&r.push({label:e.label||t.getLang("contextMenu."+e.cmdName+(e.value||""))||"",className:"edui-for-"+e.cmdName+(e.className?" edui-for-"+e.cmdName+"-"+e.className:""),onclick:e.exec?function(){e.exec.call(t)}:function(){t.execCommand(e.cmdName,e.value)}})})(n);if(r.length){var s=function(){switch(e.icon){case"table":return t.getLang("contextMenu.table");case"justifyjustify":return t.getLang("contextMenu.paragraph");case"aligntd":return t.getLang("contextMenu.aligntd");case"aligntable":return t.getLang("contextMenu.aligntable");case"tablesort":return a.tablesort;case"borderBack":return a.borderbk;default:return""}};d.push({label:s(),className:"edui-for-"+e.icon,subMenu:{items:r,editor:t}})}}else(t.commands[e.cmdName]||UE.commands[e.cmdName]||e.query)&&(e.query?e.query.call(t):t.queryCommandState(e.cmdName))>-1&&d.push({label:e.label||t.getLang("contextMenu."+e.cmdName),className:"edui-for-"+(e.icon?e.icon:e.cmdName+(e.value||"")),onclick:e.exec?function(){e.exec.call(t)}:function(){t.execCommand(e.cmdName,e.value)}})})(l)}if("-"==d[d.length-1]&&d.pop(),e=new UE.ui.Menu({items:d,className:"edui-contextmenu",editor:t}),e.render(),e.showAt(o),t.fireEvent("aftershowcontextmenu",e),domUtils.preventDefault(s),browser.ie){var p;try{p=t.selection.getNative().createRange()}catch(g){return}if(p.item){var h=new dom.Range(t.document);h.selectNode(p.item(0)).select(!0,!0)}}})),t.addListener("aftershowcontextmenu",(function(e,a){if(t.zeroclipboard){var n=a.items;for(var i in n)"edui-for-copy"==n[i].className&&t.zeroclipboard.clip(n[i].getDom())}}))}}},UE.plugins["shortcutmenu"]=function(){var t,e=this,a=e.options.shortcutMenu||[];a.length&&(e.addListener("contextmenu mouseup",(function(e,n){var i=this,r={type:e,target:n.target||n.srcElement,screenX:n.screenX,screenY:n.screenY,clientX:n.clientX,clientY:n.clientY};if(setTimeout((function(){var n=i.selection.getRange();!1!==n.collapsed&&"contextmenu"!=e||(t||(t=new baidu.editor.ui.ShortCutMenu({editor:i,items:a,theme:i.options.theme,className:"edui-shortcutmenu"}),t.render(),i.fireEvent("afterrendershortcutmenu",t)),t.show(r,!!UE.plugins["contextmenu"]))})),"contextmenu"==e&&(domUtils.preventDefault(n),browser.ie9below)){var s;try{s=i.selection.getNative().createRange()}catch(n){return}if(s.item){var o=new dom.Range(i.document);o.selectNode(s.item(0)).select(!0,!0)}}})),e.addListener("keydown",(function(e){"keydown"==e&&t&&!t.isHidden&&t.hide()})))},UE.plugins["basestyle"]=function(){var t={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},e=function(t,e){return domUtils.filterNodeList(t.selection.getStartElementPath(),e)},a=this;for(var n in a.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"}),a.addInputRule((function(t){utils.each(t.getNodesByTagName("b i"),(function(t){switch(t.tagName){case"b":t.tagName="strong";break;case"i":t.tagName="em"}}))})),t)(function(t,n){a.commands[t]={execCommand:function(t){var i=a.selection.getRange(),r=e(this,n);if(i.collapsed){if(r){var s=a.document.createTextNode("");i.insertNode(s).removeInlineStyle(n),i.setStartBefore(s),domUtils.remove(s)}else{var o=i.document.createElement(n[0]);"superscript"!=t&&"subscript"!=t||(s=a.document.createTextNode(""),i.insertNode(s).removeInlineStyle(["sub","sup"]).setStartBefore(s).collapse(!0)),i.insertNode(o).setStart(o,0)}i.collapse(!0)}else"superscript"!=t&&"subscript"!=t||r&&r.tagName.toLowerCase()==t||i.removeInlineStyle(["sub","sup"]),r?i.removeInlineStyle(n):i.applyInlineStyle(n[0]);i.select()},queryCommandState:function(){return e(this,n)?1:0}}})(n,t[n])},UE.plugins["elementpath"]=function(){var t,e,a=this;a.setOpt("elementPathEnabled",!0),a.options.elementPathEnabled&&(a.commands["elementpath"]={execCommand:function(n,i){var r=e[i],s=a.selection.getRange();t=1*i,s.selectNode(r).select()},queryCommandValue:function(){var a=[].concat(this.selection.getStartElementPath()).reverse(),n=[];e=a;for(var i,r=0;i=a[r];r++)if(3!=i.nodeType){var s=i.tagName.toLowerCase();if("img"==s&&i.getAttribute("anchorname")&&(s="anchor"),n[r]=s,t==r){t=-1;break}}return n}})},UE.plugins["formatmatch"]=function(){var t,e=this,a=[],n=0;function i(r,s){if(browser.webkit)var o="IMG"==s.target.tagName?s.target:null;function l(t){return p&&t.selectNode(p),t.applyInlineStyle(a[a.length-1].tagName,null,a)}e.undoManger&&e.undoManger.save();var u=e.selection.getRange(),d=o||u.getClosedNode();if(t&&d&&"IMG"==d.tagName)d.style.cssText+=";float:"+(t.style.cssFloat||t.style.styleFloat||"none")+";display:"+(t.style.display||"inline"),t=null;else if(!t){var c=u.collapsed;if(c){var p=e.document.createTextNode("match");u.insertNode(p).select()}e.__hasEnterExecCommand=!0;var h=e.options.removeFormatAttributes;e.options.removeFormatAttributes="",e.execCommand("removeformat"),e.options.removeFormatAttributes=h,e.__hasEnterExecCommand=!1,u=e.selection.getRange(),a.length&&l(u),p&&u.setStartBefore(p).collapse(!0),u.select(),p&&domUtils.remove(p)}e.undoManger&&e.undoManger.save(),e.removeListener("mouseup",i),n=0}e.addListener("reset",(function(){a=[],n=0})),e.commands["formatmatch"]={execCommand:function(r){if(n)return n=0,a=[],void e.removeListener("mouseup",i);var s=e.selection.getRange();if(t=s.getClosedNode(),!t||"IMG"!=t.tagName){s.collapse(!0).shrinkBoundary();var o=s.startContainer;a=domUtils.findParents(o,!0,(function(t){return!domUtils.isBlockElm(t)&&1==t.nodeType}));for(var l,u=0;l=a[u];u++)if("A"==l.tagName){a.splice(u,1);break}}e.addListener("mouseup",i),n=1},queryCommandState:function(){return n},notNeedUndo:1}},UE.plugin.register("searchreplace",(function(){var t=this,e={table:1,tbody:1,tr:1,ol:1,ul:1};function a(t,e,a){var n=e.searchStr;-1==e.dir&&(t=t.split("").reverse().join(""),n=n.split("").reverse().join(""),a=t.length-a);var i,r=new RegExp(n,"g"+(e.casesensitive?"":"i"));while(i=r.exec(t))if(i.index>=a)return-1==e.dir?t.length-i.index-e.searchStr.length:i.index;return-1}function n(t,n,i){var r,s,o=i.all||1==i.dir?"getNextDomNode":"getPreDomNode";domUtils.isBody(t)&&(t=t.firstChild);while(t){if(r=3==t.nodeType?t.nodeValue:t[browser.ie?"innerText":"textContent"],s=a(r,i,n),0,-1!=s)return{node:t,index:s};t=domUtils[o](t);while(t&&e[t.nodeName.toLowerCase()])t=domUtils[o](t,!0);t&&(n=-1==i.dir?(3==t.nodeType?t.nodeValue:t[browser.ie?"innerText":"textContent"]).length:0)}}function i(t,e,a){var n,r=0,s=t.firstChild,o=0;while(s){if(3==s.nodeType){if(o=s.nodeValue.replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length,r+=o,r>=e)return{node:s,index:o-(r-e)}}else if(!dtd.$empty[s.tagName]&&(o=s[browser.ie?"innerText":"textContent"].replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length,r+=o,r>=e&&(n=i(s,o-(r-e),a),n)))return n;s=domUtils.getNextDomNode(s)}}function r(t,e){var a,r=t.selection.getRange(),o=e.searchStr,l=t.document.createElement("span");if(l.innerHTML="$$ueditor_searchreplace_key$$",r.shrinkBoundary(!0),!r.collapsed){r.select();var u=t.selection.getText();if(new RegExp("^"+e.searchStr+"$",e.casesensitive?"":"i").test(u)){if(void 0!=e.replaceStr)return s(r,e.replaceStr),r.select(),!0;r.collapse(-1==e.dir)}}r.insertNode(l),r.enlargeToBlockElm(!0),a=r.startContainer;var d=a[browser.ie?"innerText":"textContent"].indexOf("$$ueditor_searchreplace_key$$");r.setStartBefore(l),domUtils.remove(l);var c=n(a,d,e);if(c){var p=i(c.node,c.index,o),h=i(c.node,c.index+o.length,o);return r.setStart(p.node,p.index).setEnd(h.node,h.index),void 0!==e.replaceStr&&s(r,e.replaceStr),r.select(),!0}r.setCursor()}function s(e,a){a=t.document.createTextNode(a),e.deleteContents().insertNode(a)}return{commands:{searchreplace:{execCommand:function(e,a){utils.extend(a,{all:!1,casesensitive:!1,dir:1},!0);var n=0;if(a.all){var i=t.selection.getRange(),s=t.body.firstChild;s&&1==s.nodeType?(i.setStart(s,0),i.shrinkBoundary(!0)):3==s.nodeType&&i.setStartBefore(s),i.collapse(!0).select(!0),void 0!==a.replaceStr&&t.fireEvent("saveScene");while(r(this,a))n++;n&&t.fireEvent("saveScene")}else void 0!==a.replaceStr&&t.fireEvent("saveScene"),r(this,a)&&n++,n&&t.fireEvent("saveScene");return n},notNeedUndo:1}}}})),UE.plugins["customstyle"]=function(){var t=this;t.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]}),t.commands["customstyle"]={execCommand:function(t,e){var a,n,i=this,r=e.tag,s=domUtils.findParent(i.selection.getStart(),(function(t){return t.getAttribute("label")}),!0),o={};for(var l in e)void 0!==e[l]&&(o[l]=e[l]);if(delete o.tag,s&&s.getAttribute("label")==e.label){if(a=this.selection.getRange(),n=a.createBookmark(),a.collapsed)if(dtd.$block[s.tagName]){var u=i.document.createElement("p");domUtils.moveChild(s,u),s.parentNode.insertBefore(u,s),domUtils.remove(s)}else domUtils.remove(s,!0);else{var d=domUtils.getCommonAncestor(n.start,n.end),c=domUtils.getElementsByTagName(d,r);new RegExp(r,"i").test(d.tagName)&&c.push(d);for(var p,h=0;p=c[h++];)if(p.getAttribute("label")==e.label){var g=domUtils.getPosition(p,n.start),f=domUtils.getPosition(p,n.end);if((g&domUtils.POSITION_FOLLOWING||g&domUtils.POSITION_CONTAINS)&&(f&domUtils.POSITION_PRECEDING||f&domUtils.POSITION_CONTAINS)&&dtd.$block[r]){u=i.document.createElement("p");domUtils.moveChild(p,u),p.parentNode.insertBefore(u,p)}domUtils.remove(p,!0)}s=domUtils.findParent(d,(function(t){return t.getAttribute("label")==e.label}),!0),s&&domUtils.remove(s,!0)}a.moveToBookmark(n).select()}else if(dtd.$block[r]){if(this.execCommand("paragraph",r,o,"customstyle"),a=i.selection.getRange(),!a.collapsed){a.collapse(),s=domUtils.findParent(i.selection.getStart(),(function(t){return t.getAttribute("label")==e.label}),!0);var m=i.document.createElement("p");domUtils.insertAfter(s,m),domUtils.fillNode(i.document,m),a.setStart(m,0).setCursor()}}else{if(a=i.selection.getRange(),a.collapsed)return s=i.document.createElement(r),domUtils.setAttributes(s,o),void a.insertNode(s).setStart(s,0).setCursor();n=a.createBookmark(),a.applyInlineStyle(r,o).moveToBookmark(n).select()}},queryCommandValue:function(){var t=domUtils.filterNodeList(this.selection.getStartElementPath(),(function(t){return t.getAttribute("label")}));return t?t.getAttribute("label"):""}},t.addListener("keyup",(function(e,a){var n=a.keyCode||a.which;if(32==n||13==n){var i=t.selection.getRange();if(i.collapsed){var r=domUtils.findParent(t.selection.getStart(),(function(t){return t.getAttribute("label")}),!0);if(r&&dtd.$block[r.tagName]&&domUtils.isEmptyNode(r)){var s=t.document.createElement("p");domUtils.insertAfter(r,s),domUtils.fillNode(t.document,s),domUtils.remove(r),i.setStart(s,0).setCursor()}}}}))},UE.plugins["catchremoteimage"]=function(){var me=this,ajax=UE.ajax;!1!==me.options.catchRemoteImageEnable&&(me.setOpt({catchRemoteImageEnable:!1}),me.addListener("afterpaste",(function(){me.fireEvent("catchRemoteImage")})),me.addListener("catchRemoteImage",(function(){for(var catcherLocalDomain=me.getOpt("catcherLocalDomain"),catcherActionUrl=me.getActionUrl(me.getOpt("catcherActionName")),catcherUrlPrefix=me.getOpt("catcherUrlPrefix"),catcherFieldName=me.getOpt("catcherFieldName"),remoteImages=[],imgs=domUtils.getElementsByTagName(me.document,"img"),test=function(t,e){if(-1!=t.indexOf(location.host)||/(^\.)|(^\/)/.test(t))return!0;if(e)for(var a,n=0;a=e[n++];)if(-1!==t.indexOf(a))return!0;return!1},i=0,ci;ci=imgs[i++];)if(!ci.getAttribute("word_img")){var src=ci.getAttribute("_src")||ci.src||"";/^(https?|ftp):/i.test(src)&&!test(src,catcherLocalDomain)&&remoteImages.push(src)}function catchremoteimage(t,e){var a=utils.serializeParam(me.queryCommandValue("serverparam"))||"",n=utils.formatUrl(catcherActionUrl+(-1==catcherActionUrl.indexOf("?")?"?":"&")+a),i=utils.isCrossDomainUrl(n),r={method:"POST",dataType:i?"jsonp":"",timeout:6e4,onsuccess:e["success"],onerror:e["error"]};r[catcherFieldName]=t,ajax.request(n,r)}remoteImages.length&&catchremoteimage(remoteImages,{success:function success(r){try{var info=void 0!==r.state?r:eval("("+r.responseText+")")}catch(e){return}var i,j,ci,cj,oldSrc,newSrc,list=info.list;for(i=0;ci=imgs[i++];)for(oldSrc=ci.getAttribute("_src")||ci.src||"",j=0;cj=list[j++];)if(oldSrc==cj.source&&"SUCCESS"==cj.state){newSrc=catcherUrlPrefix+cj.url,domUtils.setAttributes(ci,{src:newSrc,_src:newSrc});break}me.fireEvent("catchremotesuccess")},error:function(){me.fireEvent("catchremoteerror")}})})))},UE.plugin.register("snapscreen",(function(){var me=this,snapplugin;function getLocation(t){var e,a=document.createElement("a"),n=utils.serializeParam(me.queryCommandValue("serverparam"))||"";return a.href=t,browser.ie&&(a.href=a.href),e=a.search,n&&(e=e+(-1==e.indexOf("?")?"?":"&")+n,e=e.replace(/[&]+/gi,"&")),{port:a.port,hostname:a.hostname,path:a.pathname+e||+a.hash}}return{commands:{snapscreen:{execCommand:function execCommand(cmd){var url,local,res,lang=me.getLang("snapScreen_plugin");if(!snapplugin){var container=me.container,doc=me.container.ownerDocument||me.container.document;snapplugin=doc.createElement("object");try{snapplugin.type="application/x-pluginbaidusnap"}catch(e){return}snapplugin.style.cssText="position:absolute;left:-9999px;width:0;height:0;",snapplugin.setAttribute("width","0"),snapplugin.setAttribute("height","0"),container.appendChild(snapplugin)}function onSuccess(rs){try{if(rs=eval("("+rs+")"),"SUCCESS"==rs.state){var opt=me.options;me.execCommand("insertimage",{src:opt.snapscreenUrlPrefix+rs.url,_src:opt.snapscreenUrlPrefix+rs.url,alt:rs.title||"",floatStyle:opt.snapscreenImgAlign})}else alert(rs.state)}catch(e){alert(lang.callBackErrorMsg)}}url=me.getActionUrl(me.getOpt("snapscreenActionName")),local=getLocation(url),setTimeout((function(){try{res=snapplugin.saveSnapshot(local.hostname,local.path,local.port)}catch(e){return void me.ui._dialogs["snapscreenDialog"].open()}onSuccess(res)}),50)},queryCommandState:function(){return-1!=navigator.userAgent.indexOf("Windows",0)?0:-1}}}}})),UE.commands["insertparagraph"]={execCommand:function(t,e){var a,n=this,i=n.selection.getRange(),r=i.startContainer;while(r){if(domUtils.isBody(r))break;a=r,r=r.parentNode}if(a){var s=n.document.createElement("p");e?a.parentNode.insertBefore(s,a):a.parentNode.insertBefore(s,a.nextSibling),domUtils.fillNode(n.document,s),i.setStart(s,0).setCursor(!1,!0)}}},UE.plugin.register("webapp",(function(){var t=this;function e(e,a){return a?'<iframe class="edui-faked-webapp" title="'+e.title+'" '+(e.align&&!e.cssfloat?'align="'+e.align+'"':"")+(e.cssfloat?'style="float:'+e.cssfloat+'"':"")+'width="'+e.width+'" height="'+e.height+'"  scrolling="no" frameborder="0" src="'+e.url+'" logo_url = "'+e.logo+'"></iframe>':'<img title="'+e.title+'" width="'+e.width+'" height="'+e.height+'" src="'+t.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" _logo_url="'+e.logo+'" style="background:url('+e.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+e.url+'" '+(e.align&&!e.cssfloat?'align="'+e.align+'"':"")+(e.cssfloat?'style="float:'+e.cssfloat+'"':"")+"/>"}return{outputRule:function(t){utils.each(t.getNodesByTagName("img"),(function(t){var a;if("edui-faked-webapp"==t.getAttr("class")){a=e({title:t.getAttr("title"),width:t.getAttr("width"),height:t.getAttr("height"),align:t.getAttr("align"),cssfloat:t.getStyle("float"),url:t.getAttr("_url"),logo:t.getAttr("_logo_url")},!0);var n=UE.uNode.createElement(a);t.parentNode.replaceChild(n,t)}}))},inputRule:function(t){utils.each(t.getNodesByTagName("iframe"),(function(t){if("edui-faked-webapp"==t.getAttr("class")){var a=UE.uNode.createElement(e({title:t.getAttr("title"),width:t.getAttr("width"),height:t.getAttr("height"),align:t.getAttr("align"),cssfloat:t.getStyle("float"),url:t.getAttr("src"),logo:t.getAttr("logo_url")}));t.parentNode.replaceChild(a,t)}}))},commands:{webapp:{execCommand:function(t,a){var n=this,i=e(utils.extend(a,{align:"none"}),!1);n.execCommand("inserthtml",i)},queryCommandState:function(){var t=this,e=t.selection.getRange().getClosedNode(),a=e&&"edui-faked-webapp"==e.className;return a?1:0}}}}})),UE.plugins["template"]=function(){UE.commands["template"]={execCommand:function(t,e){e.html&&this.execCommand("inserthtml",e.html)}},this.addListener("click",(function(t,e){var a=e.target||e.srcElement,n=this.selection.getRange(),i=domUtils.findParent(a,(function(t){if(t.className&&domUtils.hasClass(t,"ue_t"))return t}),!0);i&&n.selectNode(i).shrinkBoundary().select()})),this.addListener("keydown",(function(t,e){var a=this.selection.getRange();if(!a.collapsed&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&!e.altKey){var n=domUtils.findParent(a.startContainer,(function(t){if(t.className&&domUtils.hasClass(t,"ue_t"))return t}),!0);n&&domUtils.removeClasses(n,["ue_t"])}}))},UE.plugin.register("music",(function(){var t=this;function e(e,a,n,i,r,s){return s?'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+e+'" width="'+a+'" height="'+n+'" '+(i&&!r?'align="'+i+'"':"")+(r?'style="float:'+r+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':"<img "+(i&&!r?'align="'+i+'"':"")+(r?'style="float:'+r+'"':"")+' width="'+a+'" height="'+n+'" _url="'+e+'" class="edui-faked-music" src="'+t.options.langPath+t.options.lang+'/images/music.png" />'}return{outputRule:function(t){utils.each(t.getNodesByTagName("img"),(function(t){var a;if("edui-faked-music"==t.getAttr("class")){var n=t.getStyle("float"),i=t.getAttr("align");a=e(t.getAttr("_url"),t.getAttr("width"),t.getAttr("height"),i,n,!0);var r=UE.uNode.createElement(a);t.parentNode.replaceChild(r,t)}}))},inputRule:function(t){utils.each(t.getNodesByTagName("embed"),(function(t){if("edui-faked-music"==t.getAttr("class")){var a=t.getStyle("float"),n=t.getAttr("align");html=e(t.getAttr("src"),t.getAttr("width"),t.getAttr("height"),n,a,!1);var i=UE.uNode.createElement(html);t.parentNode.replaceChild(i,t)}}))},commands:{music:{execCommand:function(t,a){var n=this,i=e(a.url,a.width||400,a.height||95,"none",!1);n.execCommand("inserthtml",i)},queryCommandState:function(){var t=this,e=t.selection.getRange().getClosedNode(),a=e&&"edui-faked-music"==e.className;return a?1:0}}}}})),UE.plugin.register("autoupload",(function(){function t(t,e){var a,n,i,r,s,o,l,u,d=e,c=/image\/\w+/i.test(t.type)?"image":"file",p="loading_"+(+new Date).toString(36);if(a=d.getOpt(c+"FieldName"),n=d.getOpt(c+"UrlPrefix"),i=d.getOpt(c+"MaxSize"),r=d.getOpt(c+"AllowFiles"),s=d.getActionUrl(d.getOpt(c+"ActionName")),l=function(t){var e=d.document.getElementById(p);e&&domUtils.remove(e),d.fireEvent("showmessage",{id:p,content:t,type:"error",timeout:4e3})},"image"==c?(o='<img class="loadingclass" id="'+p+'" src="'+d.options.themePath+d.options.theme+'/images/spacer.gif" title="'+(d.getLang("autoupload.loading")||"")+'" >',u=function(t){var e=n+t.url,a=d.document.getElementById(p);a&&(a.setAttribute("src",e),a.setAttribute("_src",e),a.setAttribute("title",t.title||""),a.setAttribute("alt",t.original||""),a.removeAttribute("id"),domUtils.removeClasses(a,"loadingclass"))}):(o='<p><img class="loadingclass" id="'+p+'" src="'+d.options.themePath+d.options.theme+'/images/spacer.gif" title="'+(d.getLang("autoupload.loading")||"")+'" ></p>',u=function(t){var e=n+t.url,a=d.document.getElementById(p),i=d.selection.getRange(),r=i.createBookmark();i.selectNode(a).select(),d.execCommand("insertfile",{url:e}),i.moveToBookmark(r).select()}),d.execCommand("inserthtml",o),d.getOpt(c+"ActionName"))if(t.size>i)l(d.getLang("autoupload.exceedSizeError"));else{var h=t.name?t.name.substr(t.name.lastIndexOf(".")):"";if(h&&"image"!=c||r&&-1==(r.join("")+".").indexOf(h.toLowerCase()+"."))l(d.getLang("autoupload.exceedTypeError"));else{var g=new XMLHttpRequest,f=new FormData,m=utils.serializeParam(d.queryCommandValue("serverparam"))||"",v=utils.formatUrl(s+(-1==s.indexOf("?")?"?":"&")+m);f.append(a,t,t.name||"blob."+t.type.substr("image/".length)),f.append("type","ajax"),g.open("post",v,!0),g.setRequestHeader("X-Requested-With","XMLHttpRequest"),g.addEventListener("load",(function(t){try{var e=new Function("return "+utils.trim(t.target.response))();"SUCCESS"==e.state&&e.url?u(e):l(e.state)}catch(a){l(d.getLang("autoupload.loadError"))}})),g.send(f)}}else l(d.getLang("autoupload.errorLoadConfig"))}function e(t){return t.clipboardData&&t.clipboardData.items&&1==t.clipboardData.items.length&&/^image\//.test(t.clipboardData.items[0].type)?t.clipboardData.items:null}function a(t){return t.dataTransfer&&t.dataTransfer.files?t.dataTransfer.files:null}return{outputRule:function(t){utils.each(t.getNodesByTagName("img"),(function(t){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(t.getAttr("class"))&&t.parentNode.removeChild(t)})),utils.each(t.getNodesByTagName("p"),(function(t){/\bloadpara\b/.test(t.getAttr("class"))&&t.parentNode.removeChild(t)}))},bindEvents:{ready:function(n){var i=this;window.FormData&&window.FileReader&&(domUtils.on(i.body,"paste drop",(function(n){var r,s=!1;if(r="paste"==n.type?e(n):a(n),r){var o,l=r.length;while(l--)o=r[l],o.getAsFile&&(o=o.getAsFile()),o&&o.size>0&&(t(o,i),s=!0);s&&n.preventDefault()}})),domUtils.on(i.body,"dragover",(function(t){"Files"==t.dataTransfer.types[0]&&t.preventDefault()})),utils.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document))}}}})),UE.plugin.register("autosave",(function(){var t=this,e=new Date,a=20,n=null;function i(i){var r;new Date-e<a||(i.hasContents()?(e=new Date,i._saveFlag=null,r=t.body.innerHTML,!1!==i.fireEvent("beforeautosave",{content:r})&&(t.setPreferences(n,r),i.fireEvent("afterautosave",{content:r}))):n&&t.removePreferences(n))}return{defaultOptions:{saveInterval:500},bindEvents:{ready:function(){var e="-drafts-data",a=null;a=t.key?t.key+e:(t.container.parentNode.id||"ue-common")+e,n=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+a},contentchange:function(){t.getOpt("enableAutoSave")&&n&&(t._saveFlag&&window.clearTimeout(t._saveFlag),t.options.saveInterval>0?t._saveFlag=window.setTimeout((function(){i(t)}),t.options.saveInterval):i(t))}},commands:{clearlocaldata:{execCommand:function(e,a){n&&t.getPreferences(n)&&t.removePreferences(n)},notNeedUndo:!0,ignoreContentChange:!0},getlocaldata:{execCommand:function(e,a){return n&&t.getPreferences(n)||""},notNeedUndo:!0,ignoreContentChange:!0},drafts:{execCommand:function(e,a){n&&(t.body.innerHTML=t.getPreferences(n)||"<p>"+domUtils.fillHtml+"</p>",t.focus(!0))},queryCommandState:function(){return n?null===t.getPreferences(n)?-1:0:-1},notNeedUndo:!0,ignoreContentChange:!0}}}})),UE.plugin.register("charts",(function(){var t=this;return{bindEvents:{chartserror:function(){}},commands:{charts:{execCommand:function(a,n){var i=domUtils.findParentByTagName(this.selection.getRange().startContainer,"table",!0),r=[],s={};if(!i)return!1;if(!e(i))return t.fireEvent("chartserror"),!1;for(var o in s.title=n.title||"",s.subTitle=n.subTitle||"",s.xTitle=n.xTitle||"",s.yTitle=n.yTitle||"",s.suffix=n.suffix||"",s.tip=n.tip||"",s.dataFormat=n.tableDataFormat||"",s.chartType=n.chartType||0,s)s.hasOwnProperty(o)&&r.push(o+":"+s[o]);i.setAttribute("data-chart",r.join(";")),domUtils.addClass(i,"edui-charts-table")},queryCommandState:function(t,a){var n=domUtils.findParentByTagName(this.selection.getRange().startContainer,"table",!0);return n&&e(n)?0:-1}}},inputRule:function(t){utils.each(t.getNodesByTagName("table"),(function(t){void 0!==t.getAttr("data-chart")&&t.setAttr("style")}))},outputRule:function(t){utils.each(t.getNodesByTagName("table"),(function(t){void 0!==t.getAttr("data-chart")&&t.setAttr("style","display: none;")}))}};function e(t){var e=null,a=0;if(t.rows.length<2)return!1;if(t.rows[0].cells.length<2)return!1;e=t.rows[0].cells,a=e.length;for(var n=0;r=e[n];n++)if("th"!==r.tagName.toLowerCase())return!1;var i;for(n=1;i=t.rows[n];n++){if(i.cells.length!=a)return!1;if("th"!==i.cells[0].tagName.toLowerCase())return!1;for(var r,s=1;r=i.cells[s];s++){var o=utils.trim(r.innerText||r.textContent||"");if(o=o.replace(new RegExp(UE.dom.domUtils.fillChar,"g"),"").replace(/^\s+|\s+$/g,""),!/^\d*\.?\d+$/.test(o))return!1}}return!0}})),UE.plugin.register("section",(function(){function t(t){this.tag="",this.level=-1,this.dom=null,this.nextSection=null,this.previousSection=null,this.parentSection=null,this.startAddress=[],this.endAddress=[],this.children=[]}function e(e){var a=new t;return utils.extend(a,e)}function a(t,e){for(var a=e,n=0;n<t.length;n++){if(!a.childNodes)return null;a=a.childNodes[t[n]]}return a}var n=this;return{bindMultiEvents:{type:"aftersetcontent afterscencerestore",handler:function(){n.fireEvent("updateSections")}},bindEvents:{ready:function(){n.fireEvent("updateSections"),domUtils.on(n.body,"drop paste",(function(){n.fireEvent("updateSections")}))},afterexeccommand:function(t,e){"paragraph"==e&&n.fireEvent("updateSections")},keyup:function(t,e){var a=this,n=a.selection.getRange();if(1!=n.collapsed)a.fireEvent("updateSections");else{var i=e.keyCode||e.which;13!=i&&8!=i&&46!=i||a.fireEvent("updateSections")}}},commands:{getsections:{execCommand:function(t,a){for(var n=a||["h1","h2","h3","h4","h5","h6"],i=0;i<n.length;i++)"string"==typeof n[i]?n[i]=function(t){return function(e){return e.tagName==t.toUpperCase()}}(n[i]):"function"!=typeof n[i]&&(n[i]=function(t){return null});function r(t){for(var e=0;e<n.length;e++)if(n[e](t))return e;return-1}var s=this,o=e({level:-1,title:"root"}),l=o;function u(t,a){for(var n,i,o,d=null,c=t.childNodes,p=0,h=c.length;p<h;p++)if(o=c[p],n=r(o),n>=0){var g=s.selection.getRange().selectNode(o).createAddress(!0).startAddress,f=e({tag:o.tagName,title:o.innerText||o.textContent||"",level:n,dom:o,startAddress:utils.clone(g,[]),endAddress:utils.clone(g,[]),children:[]});l.nextSection=f,f.previousSection=l,i=l;while(n<=i.level)i=i.parentSection;f.parentSection=i,i.children.push(f),d=l=f}else 1===o.nodeType&&u(o,a),d&&d.endAddress[d.endAddress.length-1]++}return u(s.body,o),o},notNeedUndo:!0},movesection:{execCommand:function(t,e,n,i){var r,s,o=this;if(e&&n&&-1!=n.level&&(r=i?n.endAddress:n.startAddress,s=a(r,o.body),r&&s&&!p(e.startAddress,e.endAddress,r))){var l,u,d=a(e.startAddress,o.body),c=a(e.endAddress,o.body);if(i){l=c;while(l&&!(domUtils.getPosition(d,l)&domUtils.POSITION_FOLLOWING)){if(u=l.previousSibling,domUtils.insertAfter(s,l),l==d)break;l=u}}else{l=d;while(l&&!(domUtils.getPosition(l,c)&domUtils.POSITION_FOLLOWING)){if(u=l.nextSibling,s.parentNode.insertBefore(l,s),l==c)break;l=u}}o.fireEvent("updateSections")}function p(t,e,a){for(var n=!1,i=!1,r=0;r<t.length;r++){if(r>=a.length)break;if(a[r]>t[r]){n=!0;break}if(a[r]<t[r])break}for(r=0;r<e.length;r++){if(r>=a.length)break;if(a[r]<t[r]){i=!0;break}if(a[r]>t[r])break}return n&&i}}},deletesection:{execCommand:function(t,e,a){var n=this;if(e){var i,r=l(e.startAddress),s=l(e.endAddress),o=r;if(a)domUtils.remove(o);else while(o&&domUtils.inDoc(s,n.document)&&!(domUtils.getPosition(o,s)&domUtils.POSITION_FOLLOWING))i=o.nextSibling,domUtils.remove(o),o=i;n.fireEvent("updateSections")}function l(t){for(var e=n.body,a=0;a<t.length;a++){if(!e.childNodes)return null;e=e.childNodes[t[a]]}return e}}},selectsection:{execCommand:function(t,e){if(!e&&!e.dom)return!1;var a=this,n=a.selection.getRange(),i={startAddress:utils.clone(e.startAddress,[]),endAddress:utils.clone(e.endAddress,[])};return i.endAddress[i.endAddress.length-1]++,n.moveToAddress(i).select().scrollToView(),!0},notNeedUndo:!0},scrolltosection:{execCommand:function(t,e){if(!e&&!e.dom)return!1;var a=this,n=a.selection.getRange(),i={startAddress:e.startAddress,endAddress:e.endAddress};return i.endAddress[i.endAddress.length-1]++,n.moveToAddress(i).scrollToView(),!0},notNeedUndo:!0}}}})),UE.plugin.register("simpleupload",(function(){var t,e=this,a=!1;function n(){var n=t.offsetWidth||20,i=t.offsetHeight||20,r=document.createElement("iframe"),s="display:block;width:"+n+"px;height:"+i+"px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";domUtils.on(r,"load",(function(){var t,o,l,u=(+new Date).toString(36);o=r.contentDocument||r.contentWindow.document,l=o.body,t=o.createElement("div"),t.innerHTML='<form id="edui_form_'+u+'" target="edui_iframe_'+u+'" method="POST" enctype="multipart/form-data" action="'+e.getOpt("serverUrl")+'" style="'+s+'"><input id="edui_input_'+u+'" type="file" accept="image/*" name="'+e.options.imageFieldName+'" style="'+s+'"></form><iframe id="edui_iframe_'+u+'" name="edui_iframe_'+u+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>',t.className="edui-"+e.options.theme,t.id=e.ui.id+"_iframeupload",l.style.cssText=s,l.style.width=n+"px",l.style.height=i+"px",l.appendChild(t),l.parentNode&&(l.parentNode.style.width=n+"px",l.parentNode.style.height=n+"px");var d,c=o.getElementById("edui_form_"+u),p=o.getElementById("edui_input_"+u),h=o.getElementById("edui_iframe_"+u);domUtils.on(p,"change",(function(){if(p.value){var t="loading_"+(+new Date).toString(36),a=utils.serializeParam(e.queryCommandValue("serverparam"))||"",n=e.getActionUrl(e.getOpt("imageActionName")),i=e.getOpt("imageAllowFiles");if(e.focus(),e.execCommand("inserthtml",'<img class="loadingclass" id="'+t+'" src="'+e.options.themePath+e.options.theme+'/images/spacer.gif" title="'+(e.getLang("simpleupload.loading")||"")+'" >'),e.getOpt("imageActionName")){var r=p.value,s=r?r.substr(r.lastIndexOf(".")):"";!s||i&&-1==(i.join("")+".").indexOf(s.toLowerCase()+".")?l(e.getLang("simpleupload.exceedTypeError")):(domUtils.on(h,"load",o),c.action=utils.formatUrl(n+(-1==n.indexOf("?")?"?":"&")+a),c.submit())}else errorHandler(e.getLang("autoupload.errorLoadConfig"))}function o(){try{var a,n,i,r=(h.contentDocument||h.contentWindow.document).body,s=r.innerText||r.textContent||"";n=new Function("return "+s)(),a=e.options.imageUrlPrefix+n.url,"SUCCESS"==n.state&&n.url?(i=e.document.getElementById(t),i.setAttribute("src",a),i.setAttribute("_src",a),i.setAttribute("title",n.title||""),i.setAttribute("alt",n.original||""),i.removeAttribute("id"),domUtils.removeClasses(i,"loadingclass")):l&&l(n.state)}catch(u){l&&l(e.getLang("simpleupload.loadError"))}c.reset(),domUtils.un(h,"load",o)}function l(a){if(t){var n=e.document.getElementById(t);n&&domUtils.remove(n),e.fireEvent("showmessage",{id:t,content:a,type:"error",timeout:4e3})}}})),e.addListener("selectionchange",(function(){clearTimeout(d),d=setTimeout((function(){var t=e.queryCommandState("simpleupload");p.disabled=-1==t&&"disabled"}),400)})),a=!0})),r.style.cssText=s,t.appendChild(r)}return{bindEvents:{ready:function(){utils.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)},simpleuploadbtnready:function(a,i){t=i,e.afterConfigReady(n)}},outputRule:function(t){utils.each(t.getNodesByTagName("img"),(function(t){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(t.getAttr("class"))&&t.parentNode.removeChild(t)}))},commands:{simpleupload:{queryCommandState:function(){return a?0:-1}}}}})),UE.plugin.register("serverparam",(function(){var t={};return{commands:{serverparam:{execCommand:function(e,a,n){void 0===a||null===a?t={}:utils.isString(a)?void 0===n||null===n?delete t[a]:t[a]=n:utils.isObject(a)?utils.extend(t,a,!0):utils.isFunction(a)&&utils.extend(t,a(),!0)},queryCommandValue:function(){return t||{}}}}}})),UE.plugin.register("insertfile",(function(){var t=this;function e(t){var e=t.substr(t.lastIndexOf(".")+1).toLowerCase(),a={rar:"icon_rar.gif",zip:"icon_rar.gif",tar:"icon_rar.gif",gz:"icon_rar.gif",bz2:"icon_rar.gif",doc:"icon_doc.gif",docx:"icon_doc.gif",pdf:"icon_pdf.gif",mp3:"icon_mp3.gif",xls:"icon_xls.gif",chm:"icon_chm.gif",ppt:"icon_ppt.gif",pptx:"icon_ppt.gif",avi:"icon_mv.gif",rmvb:"icon_mv.gif",wmv:"icon_mv.gif",flv:"icon_mv.gif",swf:"icon_mv.gif",rm:"icon_mv.gif",exe:"icon_exe.gif",psd:"icon_psd.gif",txt:"icon_txt.gif",jpg:"icon_jpg.gif",png:"icon_jpg.gif",jpeg:"icon_jpg.gif",gif:"icon_jpg.gif",ico:"icon_jpg.gif",bmp:"icon_jpg.gif"};return a[e]?a[e]:a["txt"]}return{commands:{insertfile:{execCommand:function(a,n){n=utils.isArray(n)?n:[n];var i,r,s,o,l="",u=t.getOpt("UEDITOR_HOME_URL"),d=u+("/"==u.substr(u.length-1)?"":"/")+"dialogs/attachment/fileTypeImages/";for(i=0;i<n.length;i++)r=n[i],s=d+e(r.url),o=r.title||r.url.substr(r.url.lastIndexOf("/")+1),l+='<p style="line-height: 16px;"><img style="vertical-align: middle; margin-right: 2px;" src="'+s+'" _src="'+s+'" /><a style="font-size:12px; color:#0066cc;" href="'+r.url+'" title="'+o+'">'+o+"</a></p>";t.execCommand("insertHtml",l)}}}}})),UE.plugins.xssFilter=function(){var t=UEDITOR_CONFIG,e=t.whitList;function a(t){var a=t.tagName,n=t.attrs;if(!e.hasOwnProperty(a))return t.parentNode.removeChild(t),!1;UE.utils.each(n,(function(n,i){-1===e[a].indexOf(i)&&t.setAttr(i)}))}e&&t.xssFilterRules&&(this.options.filterRules=function(){var t={};return UE.utils.each(e,(function(e,n){t[n]=function(t){return a(t)}})),t}());var n=[];UE.utils.each(e,(function(t,e){n.push(e)})),e&&t.inputXssFilter&&this.addInputRule((function(t){t.traversal((function(t){if("element"!==t.type)return!1;a(t)}))})),e&&t.outputXssFilter&&this.addOutputRule((function(t){t.traversal((function(t){if("element"!==t.type)return!1;a(t)}))}))};var baidu=baidu||{};baidu.editor=baidu.editor||{},UE.ui=baidu.editor.ui={},function(){var t=baidu.editor.browser,e=baidu.editor.dom.domUtils,a="$EDITORUI",n=window[a]={},i="ID"+a,r=0,s=baidu.editor.ui.uiUtils={uid:function(t){return t?t[i]||(t[i]=++r):++r},hook:function(t,e){var a;return t&&t._callbacks?a=t:(a=function(){var e;t&&(e=t.apply(this,arguments));var n=a._callbacks,i=n.length;while(i--){var r=n[i].apply(this,arguments);void 0===e&&(e=r)}return e},a._callbacks=[]),a._callbacks.push(e),a},createElementByHtml:function(t){var e=document.createElement("div");return e.innerHTML=t,e=e.firstChild,e.parentNode.removeChild(e),e},getViewportElement:function(){return t.ie&&t.quirks?document.body:document.documentElement},getClientRect:function(t){var a;try{a=t.getBoundingClientRect()}catch(r){a={left:0,top:0,height:0,width:0}}var n,i={left:Math.round(a.left),top:Math.round(a.top),height:Math.round(a.bottom-a.top),width:Math.round(a.right-a.left)};while((n=t.ownerDocument)!==document&&(t=e.getWindow(n).frameElement))a=t.getBoundingClientRect(),i.left+=a.left,i.top+=a.top;return i.bottom=i.top+i.height,i.right=i.left+i.width,i},getViewportRect:function(){var t=s.getViewportElement(),e=0|(window.innerWidth||t.clientWidth),a=0|(window.innerHeight||t.clientHeight);return{left:0,top:0,height:a,width:e,bottom:a,right:e}},setViewportOffset:function(t,a){var n=s.getFixedLayer();t.parentNode===n?(t.style.left=a.left+"px",t.style.top=a.top+"px"):e.setViewportOffset(t,a)},getEventOffset:function(t){var e=t.target||t.srcElement,a=s.getClientRect(e),n=s.getViewportOffsetByEvent(t);return{left:n.left-a.left,top:n.top-a.top}},getViewportOffsetByEvent:function(t){var a=t.target||t.srcElement,n=e.getWindow(a).frameElement,i={left:t.clientX,top:t.clientY};if(n&&a.ownerDocument!==document){var r=s.getClientRect(n);i.left+=r.left,i.top+=r.top}return i},setGlobal:function(t,e){return n[t]=e,a+'["'+t+'"]'},unsetGlobal:function(t){delete n[t]},copyAttributes:function(a,n){var i=n.attributes,r=i.length;while(r--){var s=i[r];"style"==s.nodeName||"class"==s.nodeName||t.ie&&!s.specified||a.setAttribute(s.nodeName,s.nodeValue)}n.className&&e.addClass(a,n.className),n.style.cssText&&(a.style.cssText+=";"+n.style.cssText)},removeStyle:function(t,e){if(t.style.removeProperty)t.style.removeProperty(e);else{if(!t.style.removeAttribute)throw"";t.style.removeAttribute(e)}},contains:function(t,e){return t&&e&&t!==e&&(t.contains?t.contains(e):16&t.compareDocumentPosition(e))},startDrag:function(t,e,a){a=a||document;var n=t.clientX,i=t.clientY;function r(t){var a=t.clientX-n,r=t.clientY-i;e.ondragmove(a,r,t),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}if(a.addEventListener){var s=function t(n){a.removeEventListener("mousemove",r,!0),a.removeEventListener("mouseup",t,!0),window.removeEventListener("mouseup",t,!0),e.ondragstop()};a.addEventListener("mousemove",r,!0),a.addEventListener("mouseup",s,!0),window.addEventListener("mouseup",s,!0),t.preventDefault()}else{var o=function t(){l.releaseCapture(),l.detachEvent("onmousemove",r),l.detachEvent("onmouseup",t),l.detachEvent("onlosecaptrue",t),e.ondragstop()},l=t.srcElement;l.setCapture(),l.attachEvent("onmousemove",r),l.attachEvent("onmouseup",o),l.attachEvent("onlosecaptrue",o),t.returnValue=!1}e.ondragstart()},getFixedLayer:function(){var e=document.getElementById("edui_fixedlayer");return null==e&&(e=document.createElement("div"),e.id="edui_fixedlayer",document.body.appendChild(e),t.ie&&t.version<=8?(e.style.position="absolute",l(),setTimeout(o)):e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.width="0",e.style.height="0"),e},makeUnselectable:function(e){if(t.opera||t.ie&&t.version<9){if(e.unselectable="on",e.hasChildNodes())for(var a=0;a<e.childNodes.length;a++)1==e.childNodes[a].nodeType&&s.makeUnselectable(e.childNodes[a])}else void 0!==e.style.MozUserSelect?e.style.MozUserSelect="none":void 0!==e.style.WebkitUserSelect?e.style.WebkitUserSelect="none":void 0!==e.style.KhtmlUserSelect&&(e.style.KhtmlUserSelect="none")}};function o(){var t=document.getElementById("edui_fixedlayer");s.setViewportOffset(t,{left:0,top:0})}function l(t){e.on(window,"scroll",o),e.on(window,"resize",baidu.editor.utils.defer(o,0,!0))}}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.EventBase,n=baidu.editor.ui.UIBase=function(){};n.prototype={className:"",uiName:"",initOptions:function(t){var a=this;for(var n in t)a[n]=t[n];this.id=this.id||"edui"+e.uid()},initUIBase:function(){this._globalKey=t.unhtml(e.setGlobal(this.id,this))},render:function(t){for(var a,n=this.renderHtml(),i=e.createElementByHtml(n),r=domUtils.getElementsByTagName(i,"*"),s="edui-"+(this.theme||this.editor.options.theme),o=document.getElementById("edui_fixedlayer"),l=0;a=r[l++];)domUtils.addClass(a,s);domUtils.addClass(i,s),o&&(o.className="",domUtils.addClass(o,s));var u=this.getDom();null!=u?(u.parentNode.replaceChild(i,u),e.copyAttributes(i,u)):("string"==typeof t&&(t=document.getElementById(t)),t=t||e.getFixedLayer(),domUtils.addClass(t,s),t.appendChild(i)),this.postRender()},getDom:function(t){return t?document.getElementById(this.id+"_"+t):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(t){var e="edui-"+this.uiName;return t.replace(/##/g,this.id).replace(/%%-/g,this.uiName?e+"-":"").replace(/%%/g,(this.uiName?e:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var t=this.getDom();t&&baidu.editor.dom.domUtils.remove(t),e.unsetGlobal(this.id)}},t.inherits(n,a)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.UIBase,a=baidu.editor.ui.Separator=function(t){this.initOptions(t),this.initSeparator()};a.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},t.inherits(a,e)}(),function(){var t=baidu.editor.utils,e=baidu.editor.dom.domUtils,a=baidu.editor.ui.UIBase,n=baidu.editor.ui.uiUtils,i=baidu.editor.ui.Mask=function(t){this.initOptions(t),this.initUIBase()};i.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var t=this;e.on(window,"resize",(function(){setTimeout((function(){t.isHidden()||t._fill()}))}))},show:function(t){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=t},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return"none"==this.getDom().style.display},_onMouseDown:function(){return!1},_onClick:function(t,e){this.fireEvent("click",t,e)},_fill:function(){var t=this.getDom(),e=n.getViewportRect();t.style.width=e.width+"px",t.style.height=e.height+"px"}},t.inherits(i,a)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,n=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup=function(t){this.initOptions(t),this.initPopup()},r=[];function s(t,e){for(var a=0;a<r.length;a++){var n=r[a];if(!n.isHidden()&&!1!==n.queryAutoHide(e)){if(t&&/scroll/gi.test(t.type)&&"edui-wordpastepop"==n.className)return;n.hide()}}r.length&&n.editor.fireEvent("afterhidepop")}i.postHide=s;var o=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];i.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),r.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return this.content?"string"==typeof this.content?this.content:this.content.renderHtml():""},_UIBase_postRender:n.prototype.postRender,postRender:function(){if(this.content instanceof n&&this.content.postRender(),this.captureWheel&&!this.captured){this.captured=!0;var t=(document.documentElement.clientHeight||document.body.clientHeight)-80,i=this.getDom().offsetHeight,r=e.getClientRect(this.combox.getDom()).top,s=this.getDom("content"),o=this.getDom("body").getElementsByTagName("iframe"),l=this;o.length&&(o=o[0]);while(r+i>t)i-=30;s.style.height=i+"px",o&&(o.style.height=i+"px"),window.XMLHttpRequest?a.on(s,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,t.wheelDelta?s.scrollTop-=t.wheelDelta/120*60:s.scrollTop-=t.detail/-3*60})):a.on(this.getDom(),"mousewheel",(function(t){t.returnValue=!1,l.getDom("content").scrollTop-=t.wheelDelta/120*60}))}this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var t=this.getDom("content");return e.getClientRect(t)},fitSize:function(){if(this.captureWheel&&this.sized)return this.__size;this.sized=!0;var t=this.getDom("body");t.style.width="",t.style.height="";var e=this.mesureSize();if(this.captureWheel){t.style.width=-(-20-e.width)+"px";var a=parseInt(this.getDom("content").style.height,10);!window.isNaN(a)&&(e.height=a)}else t.style.width=e.width+"px";return t.style.height=e.height+"px",this.__size=e,this.captureWheel&&(this.getDom("content").style.overflow="auto"),e},showAnchor:function(t,a){this.showAnchorRect(e.getClientRect(t),a)},showAnchorRect:function(t,n,i){this._doAutoRender();var r=e.getViewportRect();this.getDom().style.visibility="hidden",this._show();var s,l,u,d,c=this.fitSize();n?(s=this.canSideLeft&&t.right+c.width>r.right&&t.left>c.width,l=this.canSideUp&&t.top+c.height>r.bottom&&t.bottom>c.height,u=s?t.left-c.width:t.right,d=l?t.bottom-c.height:t.top):(s=this.canSideLeft&&t.right+c.width>r.right&&t.left>c.width,l=this.canSideUp&&t.top+c.height>r.bottom&&t.bottom>c.height,u=s?t.right-c.width:t.left,d=l?t.top-c.height:t.bottom);var p=this.getDom();e.setViewportOffset(p,{left:u,top:d}),a.removeClasses(p,o),p.className+=" "+o[2*(l?1:0)+(s?1:0)],this.editor&&(p.style.zIndex=1*this.editor.container.style.zIndex+10,baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=p.style.zIndex-1),this.getDom().style.visibility="visible"},showAt:function(t){var e=t.left,a=t.top,n={left:e,top:a,right:e,bottom:a,height:0,width:0};this.showAnchorRect(n,!1,!0)},_show:function(){if(this._hidden){var t=this.getDom();t.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(t){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,t||this.fireEvent("hide"))},queryAutoHide:function(t){return!t||!e.contains(this.getDom(),t)}},t.inherits(i,n),a.on(document,"mousedown",(function(t){var e=t.target||t.srcElement;s(t,e)})),a.on(window,"scroll",(function(t,e){s(t,e)}))}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.UIBase,a=baidu.editor.ui.ColorPicker=function(t){this.initOptions(t),this.noColorText=this.noColorText||this.editor.getLang("clearColor"),this.initUIBase()};a.prototype={getHtmlTpl:function(){return i(this.noColorText,this.editor)},_onTableClick:function(t){var e=t.target||t.srcElement,a=e.getAttribute("data-color");a&&this.fireEvent("pickcolor",a)},_onTableOver:function(t){var e=t.target||t.srcElement,a=e.getAttribute("data-color");a&&(this.getDom("preview").style.backgroundColor=a)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}},t.inherits(a,e);var n="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",");function i(t,e){for(var a='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+t+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+e.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >',i=0;i<n.length;i++)i&&i%10===0&&(a+="</tr>"+(60==i?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+e.getLang("standardColor")+"</td></tr>":"")+"<tr"+(60==i?' class="edui-colorpicker-tablefirstrow"':"")+">"),a+=i<70?'<td style="padding: 0 2px;"><a hidefocus title="'+n[i]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+n[i]+'" style="background-color:#'+n[i]+";border:solid #ccc;"+(i<10||i>=60?"border-width:1px;":i>=10&&i<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':"";return a+="</tr></table></div>",a}}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.ui.UIBase,n=baidu.editor.ui.TablePicker=function(t){this.initOptions(t),this.initTablePicker()};n.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:a.prototype.render,render:function(t){this._UIBase_render(t),this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(t,e){var a=this.getDom("overlay").style,n=this.lengthOfCellSide;a.width=t*n+"px",a.height=e*n+"px";var i=this.getDom("label");i.innerHTML=t+this.editor.getLang("t_col")+" x "+e+this.editor.getLang("t_row"),this.numCols=t,this.numRows=e},_onMouseOver:function(t,a){var n=t.relatedTarget||t.fromElement;e.contains(a,n)||a===n||(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="")},_onMouseOut:function(t,a){var n=t.relatedTarget||t.toElement;e.contains(a,n)||a===n||(this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row"),this.getDom("overlay").style.visibility="hidden")},_onMouseMove:function(t,a){this.getDom("overlay").style;var n=e.getEventOffset(t),i=this.lengthOfCellSide,r=Math.ceil(n.left/i),s=Math.ceil(n.top/i);this._track(r,s)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}},t.inherits(n,a)}(),function(){var t=baidu.editor.browser,e=baidu.editor.dom.domUtils,a=baidu.editor.ui.uiUtils,n='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(t.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var t=this._Stateful_dGetHtmlTpl();return t.replace(/stateful/g,(function(){return n}))},Stateful_onMouseEnter:function(t,e){this.target=e,this.isDisabled()&&!this.alwalysHoverable||(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(t,e){this.isDisabled()&&!this.alwalysHoverable||(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(t,e){var n=t.relatedTarget;a.contains(e,n)||e===n||this.Stateful_onMouseEnter(t,e)},Stateful_onMouseOut:function(t,e){var n=t.relatedTarget;a.contains(e,n)||e===n||this.Stateful_onMouseLeave(t,e)},Stateful_onMouseDown:function(t,e){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(t,e){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(t){return e.hasClass(this.getStateDom(),"edui-state-"+t)},addState:function(t){this.hasState(t)||(this.getStateDom().className+=" edui-state-"+t)},removeState:function(t){this.hasState(t)&&e.removeClasses(this.getStateDom(),["edui-state-"+t])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(t){!this.isDisabled()&&t?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(t){t?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.UIBase,a=baidu.editor.ui.Stateful,n=baidu.editor.ui.Button=function(t){if(t.name){var e=t.name,a=t.cssRules;t.className||(t.className="edui-for-"+e),t.cssRules=".edui-default  .edui-for-"+e+" .edui-icon {"+a+"}"}this.initOptions(t),this.initButton()};n.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,cssRules:"",initButton:function(){this.initUIBase(),this.Stateful_init(),this.cssRules&&t.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onMouseDown:function(t){var e=t.target||t.srcElement,a=e&&e.tagName&&e.tagName.toLowerCase();if("input"==a||"object"==a||"object"==a)return!1},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(t){var e=this.getDom("label");e.innerHTML=t}},t.inherits(n,e),t.extend(n.prototype,a)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=(baidu.editor.dom.domUtils,baidu.editor.ui.UIBase),n=baidu.editor.ui.Stateful,i=baidu.editor.ui.SplitButton=function(t){this.initOptions(t),this.initSplitButton()};i.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase(),this.Stateful_init();if(null!=this.popup){var t=this.popup;this.popup=null,this.setPopup(t)}},_UIBase_postRender:a.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(a){this.popup!==a&&(null!=this.popup&&this.popup.dispose(),a.addListener("show",t.bind(this._onPopupShow,this)),a.addListener("hide",t.bind(this._onPopupHide,this)),a.addListener("postrender",t.bind((function(){a.getDom("body").appendChild(e.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(e.getClientRect(this.getDom()).width+20)+'px"></div>')),a.getDom().className+=" "+this.className}),this)),this.popup=a)},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var t=e.getClientRect(this.getDom());t.top-=this.popup.SHADOW_RADIUS,t.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(t)},_onArrowClick:function(t,e){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},t.inherits(i,a),t.extend(i.prototype,n,!0)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.ui.ColorPicker,n=baidu.editor.ui.Popup,i=baidu.editor.ui.SplitButton,r=baidu.editor.ui.ColorButton=function(t){this.initOptions(t),this.initColorButton()};r.prototype={initColorButton:function(){var t=this;this.popup=new n({content:new a({noColorText:t.editor.getLang("clearColor"),editor:t.editor,onpickcolor:function(e,a){t._onPickColor(a)},onpicknocolor:function(e,a){t._onPickNoColor(a)}}),editor:t.editor}),this.initSplitButton()},_SplitButton_postRender:i.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.getDom("button_body").appendChild(e.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>')),this.getDom().className+=" edui-colorbutton"},setColor:function(t){this.getDom("colorlump").style.backgroundColor=t,this.color=t},_onPickColor:function(t){!1!==this.fireEvent("pickcolor",t)&&(this.setColor(t),this.popup.hide())},_onPickNoColor:function(t){!1!==this.fireEvent("picknocolor")&&this.popup.hide()}},t.inherits(r,i)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.Popup,a=baidu.editor.ui.TablePicker,n=baidu.editor.ui.SplitButton,i=baidu.editor.ui.TableButton=function(t){this.initOptions(t),this.initTableButton()};i.prototype={initTableButton:function(){var t=this;this.popup=new e({content:new a({editor:t.editor,onpicktable:function(e,a,n){t._onPickTable(a,n)}}),editor:t.editor}),this.initSplitButton()},_onPickTable:function(t,e){!1!==this.fireEvent("picktable",t,e)&&this.popup.hide()}},t.inherits(i,n)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.UIBase,a=baidu.editor.ui.AutoTypeSetPicker=function(t){this.initOptions(t),this.initAutoTypeSetPicker()};a.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var t=this.editor,e=t.options.autotypeset,a=t.getLang("autoTypeSet"),n="textAlignValue"+t.uid,i="imageBlockLineValue"+t.uid,r="symbolConverValue"+t.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(e["mergeEmptyline"]?"checked":"")+">"+a.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(e["removeEmptyline"]?"checked":"")+">"+a.delLine+'</td></tr><tr><td nowrap><input type="checkbox" name="removeClass" '+(e["removeClass"]?"checked":"")+">"+a.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(e["indent"]?"checked":"")+">"+a.indent+'</td></tr><tr><td nowrap><input type="checkbox" name="textAlign" '+(e["textAlign"]?"checked":"")+">"+a.alignment+'</td><td colspan="2" id="'+n+'"><input type="radio" name="'+n+'" value="left" '+(e["textAlign"]&&"left"==e["textAlign"]?"checked":"")+">"+t.getLang("justifyleft")+'<input type="radio" name="'+n+'" value="center" '+(e["textAlign"]&&"center"==e["textAlign"]?"checked":"")+">"+t.getLang("justifycenter")+'<input type="radio" name="'+n+'" value="right" '+(e["textAlign"]&&"right"==e["textAlign"]?"checked":"")+">"+t.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="imageBlockLine" '+(e["imageBlockLine"]?"checked":"")+">"+a.imageFloat+'</td><td nowrap id="'+i+'"><input type="radio" name="'+i+'" value="none" '+(e["imageBlockLine"]&&"none"==e["imageBlockLine"]?"checked":"")+">"+t.getLang("default")+'<input type="radio" name="'+i+'" value="left" '+(e["imageBlockLine"]&&"left"==e["imageBlockLine"]?"checked":"")+">"+t.getLang("justifyleft")+'<input type="radio" name="'+i+'" value="center" '+(e["imageBlockLine"]&&"center"==e["imageBlockLine"]?"checked":"")+">"+t.getLang("justifycenter")+'<input type="radio" name="'+i+'" value="right" '+(e["imageBlockLine"]&&"right"==e["imageBlockLine"]?"checked":"")+">"+t.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="clearFontSize" '+(e["clearFontSize"]?"checked":"")+">"+a.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(e["clearFontFamily"]?"checked":"")+">"+a.removeFontFamily+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(e["removeEmptyNode"]?"checked":"")+">"+a.removeHtml+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(e["pasteFilter"]?"checked":"")+">"+a.pasteFilter+'</td></tr><tr><td nowrap><input type="checkbox" name="symbolConver" '+(e["bdc2sb"]||e["tobdc"]?"checked":"")+">"+a.symbol+'</td><td id="'+r+'"><input type="radio" name="bdc" value="bdc2sb" '+(e["bdc2sb"]?"checked":"")+">"+a.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(e["tobdc"]?"checked":"")+">"+a.tobdc+'</td><td nowrap align="right"><button >'+a.run+"</button></td></tr></table></div></div>"},_UIBase_render:e.prototype.render},t.inherits(a,e)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.Popup,a=baidu.editor.ui.AutoTypeSetPicker,n=baidu.editor.ui.SplitButton,i=baidu.editor.ui.AutoTypeSetButton=function(t){this.initOptions(t),this.initAutoTypeSetButton()};function r(e){for(var a,n={},i=e.getDom(),r=e.editor.uid,s=null,o=null,l=domUtils.getElementsByTagName(i,"input"),u=l.length-1;a=l[u--];)if(s=a.getAttribute("type"),"checkbox"==s)if(o=a.getAttribute("name"),n[o]&&delete n[o],a.checked){var d=document.getElementById(o+"Value"+r);if(d){if(/input/gi.test(d.tagName))n[o]=d.value;else for(var c,p=d.getElementsByTagName("input"),h=p.length-1;c=p[h--];)if(c.checked){n[o]=c.value;break}}else n[o]=!0}else n[o]=!1;else n[a.getAttribute("value")]=a.checked;var g,f=domUtils.getElementsByTagName(i,"select");for(u=0;g=f[u++];){var m=g.getAttribute("name");n[m]=n[m]?g.value:""}t.extend(e.editor.options.autotypeset,n),e.editor.setPreferences("autotypeset",n)}i.prototype={initAutoTypeSetButton:function(){var t=this;this.popup=new e({content:new a({editor:t.editor}),editor:t.editor,hide:function(){!this._hidden&&this.getDom()&&(r(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}});var n=0;this.popup.addListener("postRenderAfter",(function(){var e=this;if(!n){var a=this.getDom(),i=a.getElementsByTagName("button")[0];i.onclick=function(){r(e),t.editor.execCommand("autotypeset"),e.hide()},domUtils.on(a,"click",(function(a){var n=a.target||a.srcElement,i=t.editor.uid;if(n&&"INPUT"==n.tagName){if("imageBlockLine"==n.name||"textAlign"==n.name||"symbolConver"==n.name)for(var s=n.checked,o=document.getElementById(n.name+"Value"+i),l=o.getElementsByTagName("input"),u={imageBlockLine:"none",textAlign:"left",symbolConver:"tobdc"},d=0;d<l.length;d++)s?l[d].value==u[n.name]&&(l[d].checked="checked"):l[d].checked=!1;if(n.name=="imageBlockLineValue"+i||n.name=="textAlignValue"+i||"bdc"==n.name){var c=n.parentNode.previousSibling.getElementsByTagName("input");c&&(c[0].checked=!0)}r(e)}})),n=1}})),this.initSplitButton()}},t.inherits(i,n)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.Popup,a=baidu.editor.ui.Stateful,n=baidu.editor.ui.UIBase,i=baidu.editor.ui.CellAlignPicker=function(t){this.initOptions(t),this.initSelected(),this.initCellAlignPicker()};i.prototype={initSelected:function(){var t={valign:{top:0,middle:1,bottom:2},align:{left:0,center:1,right:2},count:3};this.selected&&(this.selectedIndex=t.valign[this.selected.valign]*t.count+t.align[this.selected.align])},initCellAlignPicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){for(var t=["left","center","right"],e=9,a=null,n=-1,i=[],r=0;r<e;r++)a=this.selectedIndex===r?' class="edui-cellalign-selected" ':"",n=r%3,0===n&&i.push("<tr>"),i.push('<td index="'+r+'" '+a+' stateful><div class="edui-icon edui-'+t[n]+'"></div></td>'),2===n&&i.push("</tr>");return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">'+i.join("")+"</table></div></div>"},getStateDom:function(){return this.target},_onClick:function(t){var a=t.target||t.srcElement;/icon/.test(a.className)&&(this.items[a.parentNode.getAttribute("index")].onclick(),e.postHide(t))},_UIBase_render:n.prototype.render},t.inherits(i,n),t.extend(i.prototype,a,!0)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.Stateful,a=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,i=baidu.editor.ui.PastePicker=function(t){this.initOptions(t),this.initPastePicker()};i.prototype={initPastePicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(t){this.editor.ui._isTransfer=!0,this.editor.fireEvent("pasteTransfer",t)},_onClick:function(t){var e=domUtils.getNextDomNode(t),n=a.getViewportRect().height,i=a.getClientRect(e);i.top+i.height>n?e.style.top=-i.height-t.offsetHeight+"px":e.style.top="",/hidden/gi.test(domUtils.getComputedStyle(e,"visibility"))?(e.style.visibility="visible",domUtils.addClass(t,"edui-state-opened")):(e.style.visibility="hidden",domUtils.removeClasses(t,"edui-state-opened"))},_UIBase_render:n.prototype.render},t.inherits(i,n),t.extend(i.prototype,e,!0)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.ui.UIBase,n=baidu.editor.ui.Toolbar=function(t){this.initOptions(t),this.initToolbar()};n.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(t,e){void 0===e?this.items.push(t):this.items.splice(e,0,t)},getHtmlTpl:function(){for(var t=[],e=0;e<this.items.length;e++)t[e]=this.items[e].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+t.join("")+"</div>"},postRender:function(){for(var t=this.getDom(),a=0;a<this.items.length;a++)this.items[a].postRender();e.makeUnselectable(t)},_onMouseDown:function(t){var e=t.target||t.srcElement,a=e&&e.tagName&&e.tagName.toLowerCase();if("input"==a||"object"==a||"object"==a)return!1}},t.inherits(n,a)}(),function(){var t=baidu.editor.utils,e=baidu.editor.dom.domUtils,a=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup,r=baidu.editor.ui.Stateful,s=baidu.editor.ui.CellAlignPicker,o=baidu.editor.ui.Menu=function(t){this.initOptions(t),this.initMenu()},l={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};o.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var t=0;t<this.items.length;t++){var e=this.items[t];"-"==e?this.items[t]=this.getSeparator():e instanceof u||(e.editor=this.editor,e.theme=this.editor.options.theme,this.items[t]=this.createItem(e))}},getSeparator:function(){return l},createItem:function(t){return t.menu=this,new u(t)},_Popup_getContentHtmlTpl:i.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(0==this.items.length)return this._Popup_getContentHtmlTpl();for(var t=[],e=0;e<this.items.length;e++){var a=this.items[e];t[e]=a.renderHtml()}return'<div class="%%-body">'+t.join("")+"</div>"},_Popup_postRender:i.prototype.postRender,postRender:function(){for(var t=this,n=0;n<this.items.length;n++){var i=this.items[n];i.ownerMenu=this,i.postRender()}e.on(this.getDom(),"mouseover",(function(e){e=e||event;var n=e.relatedTarget||e.fromElement,i=t.getDom();a.contains(i,n)||i===n||t.fireEvent("over")})),this._Popup_postRender()},queryAutoHide:function(t){if(t){if(a.contains(this.getDom(),t))return!1;for(var e=0;e<this.items.length;e++){var n=this.items[e];if(!1===n.queryAutoHide(t))return!1}}},clearItems:function(){for(var t=0;t<this.items.length;t++){var e=this.items[t];clearTimeout(e._showingTimer),clearTimeout(e._closingTimer),e.subMenu&&e.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&e.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},t.inherits(o,i);var u=baidu.editor.ui.MenuItem=function(t){if(this.initOptions(t),this.initUIBase(),this.Stateful_init(),this.subMenu&&!(this.subMenu instanceof o))if(t.className&&-1!=t.className.indexOf("aligntd")){var a=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment"),this.subMenu=new i({content:new s(this.subMenu),parentMenu:a,editor:a.editor,destroy:function(){this.getDom()&&e.remove(this.getDom())}}),this.subMenu.addListener("postRenderAfter",(function(){e.on(this.getDom(),"mouseover",(function(){a.addState("opened")}))}))}else this.subMenu=new o(this.subMenu)};u.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var t=this;this.addListener("over",(function(){t.ownerMenu.fireEvent("submenuover",t),t.subMenu&&t.delayShowSubMenu()})),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",(function(){t.delayHideSubMenu()})),this.subMenu.addListener("over",(function(){clearTimeout(t._closingTimer),t._closingTimer=null,t.addState("opened")})),this.ownerMenu.addListener("hide",(function(){t.hideSubMenu()})),this.ownerMenu.addListener("submenuover",(function(e,a){a!==t&&t.delayHideSubMenu()})),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(e){return(!e||!a.contains(t.getDom(),e))&&this._bakQueryAutoHide(e)}),this.getDom().style.tabIndex="-1",a.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var t=this;t.isDisabled()||(t.addState("opened"),clearTimeout(t._showingTimer),clearTimeout(t._closingTimer),t._closingTimer=null,t._showingTimer=setTimeout((function(){t.showSubMenu()}),250))},delayHideSubMenu:function(){var t=this;t.isDisabled()||(t.removeState("opened"),clearTimeout(t._showingTimer),t._closingTimer||(t._closingTimer=setTimeout((function(){t.hasState("opened")||t.hideSubMenu(),t._closingTimer=null}),400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(t){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(t)},_onClick:function(t,e){this.hasState("disabled")||!1!==this.fireEvent("click",t,e)&&(this.subMenu?this.showSubMenu():i.postHide(t))},showSubMenu:function(){var t=a.getClientRect(this.getDom());t.right-=5,t.left+=2,t.width-=7,t.top-=4,t.bottom+=4,t.height+=8,this.subMenu.showAnchorRect(t,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},t.inherits(u,n),t.extend(u.prototype,r,!0)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.ui.Menu,n=baidu.editor.ui.SplitButton,i=baidu.editor.ui.Combox=function(t){this.initOptions(t),this.initCombox()};i.prototype={uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var t=this;this.items=this.items||[];for(var e=0;e<this.items.length;e++){var n=this.items[e];n.uiName="listitem",n.index=e,n.onclick=function(){t.selectByIndex(this.index)}}this.popup=new a({items:this.items,uiName:"list",editor:this.editor,captureWheel:!0,combox:this}),this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var t=e.getClientRect(this.getDom());t.top+=1,t.bottom-=1,t.height-=2,this.popup.showAnchorRect(t)},getValue:function(){return this.value},setValue:function(t){var e=this.indexByValue(t);-1!=e?(this.selectedIndex=e,this.setLabel(this.items[e].label),this.value=this.items[e].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(t)),this.value=t)},setLabel:function(t){this.getDom("button_body").innerHTML=t,this.label=t},getLabelForUnknowValue:function(t){return t},indexByValue:function(t){for(var e=0;e<this.items.length;e++)if(t==this.items[e].value)return e;return-1},getItem:function(t){return this.items[t]},selectByIndex:function(t){t<this.items.length&&!1!==this.fireEvent("select",t)&&(this.selectedIndex=t,this.value=this.items[t].value,this.setLabel(this.items[t].label))}},t.inherits(i,n)}(),function(){var t,e,a,n=baidu.editor.utils,i=baidu.editor.dom.domUtils,r=baidu.editor.ui.uiUtils,s=baidu.editor.ui.Mask,o=baidu.editor.ui.UIBase,l=baidu.editor.ui.Button,u=baidu.editor.ui.Dialog=function(t){if(t.name){var e=t.name,a=t.cssRules;t.className||(t.className="edui-for-"+e),a&&(t.cssRules=".edui-default .edui-for-"+e+" .edui-dialog-content  {"+a+"}")}this.initOptions(n.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(t,e){return e?this.onok():this.oncancel()},holdScroll:!1},t)),this.initDialog()};u.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var i=this,r=this.editor.options.theme;if(this.cssRules&&n.cssRule("edui-customize-"+this.name+"-style",this.cssRules),this.initUIBase(),this.modalMask=t||(t=new s({className:"edui-dialog-modalmask",theme:r,onclick:function(){a&&a.close(!1)}})),this.dragMask=e||(e=new s({className:"edui-dialog-dragmask",theme:r})),this.closeButton=new l({className:"edui-dialog-closebutton",title:i.closeDialog,theme:r,onclick:function(){i.close(!1)}}),this.fullscreen&&this.initResizeEvent(),this.buttons)for(var o=0;o<this.buttons.length;o++)this.buttons[o]instanceof l||(this.buttons[o]=new l(n.extend(this.buttons[o],{editor:this.editor},!0)))},initResizeEvent:function(){var t=this;i.on(window,"resize",(function(){t._hidden||void 0===t._hidden||(t.__resizeTimer&&window.clearTimeout(t.__resizeTimer),t.__resizeTimer=window.setTimeout((function(){t.__resizeTimer=null;var e=t.getDom(),a=t.getDom("content"),n=UE.ui.uiUtils.getClientRect(e),i=UE.ui.uiUtils.getClientRect(a),s=r.getViewportRect();a.style.width=s.width-n.width+i.width+"px",a.style.height=s.height-n.height+i.height+"px",e.style.width=s.width+"px",e.style.height=s.height+"px",t.fireEvent("resize")}),100))}))},fitSize:function(){var t=this.getDom("body"),e=this.mesureSize();return t.style.width=e.width+"px",t.style.height=e.height+"px",e},safeSetOffset:function(t){var e=this,a=e.getDom(),n=r.getViewportRect(),i=r.getClientRect(a),s=t.left;s+i.width>n.right&&(s=n.right-i.width);var o=t.top;o+i.height>n.bottom&&(o=n.bottom-i.height),a.style.left=Math.max(s,0)+"px",a.style.top=Math.max(o,0)+"px"},showAtCenter:function(){var t=r.getViewportRect();if(this.fullscreen){var e=this.getDom(),a=this.getDom("content");e.style.display="block";var n=UE.ui.uiUtils.getClientRect(e),s=UE.ui.uiUtils.getClientRect(a);e.style.left="-100000px",a.style.width=t.width-n.width+s.width+"px",a.style.height=t.height-n.height+s.height+"px",e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.left=0,this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}},document.documentElement.style.overflowX="hidden",document.documentElement.style.overflowY="hidden",document.body.style.overflowX="hidden",document.body.style.overflowY="hidden"}else{this.getDom().style.display="";var o=this.fitSize(),l=0|this.getDom("titlebar").offsetHeight,u=t.width/2-o.width/2,d=t.height/2-(o.height-l)/2-l,c=this.getDom();this.safeSetOffset({left:Math.max(0|u,0),top:Math.max(0|d,0)}),i.hasClass(c,"edui-state-centered")||(c.className+=" edui-state-centered")}this._show()},getContentHtml:function(){var t="";return"string"==typeof this.content?t=this.content:this.iframeUrl&&(t='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),t},getHtmlTpl:function(){var t="";if(this.buttons){for(var e=[],a=0;a<this.buttons.length;a++)e[a]=this.buttons[a].renderHtml();t='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+e.join("")+"</div></div>"}return'<div id="##" class="%%"><div '+(this.fullscreen?'class="%%-wrap edui-dialog-fullscreen-flag"':'class="%%"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+t+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var t=this;if(this.addListener("show",(function(){t.modalMask.show(this.getDom().style.zIndex-2)})),this.addListener("hide",(function(){t.modalMask.hide()})),this.buttons)for(var e=0;e<this.buttons.length;e++)this.buttons[e].postRender();i.on(window,"resize",(function(){setTimeout((function(){t.isHidden()||t.safeSetOffset(r.getClientRect(t.getDom()))}))})),this._hide()},mesureSize:function(){var t=this.getDom("body"),e=r.getClientRect(this.getDom("content")).width,a=t.style;return a.width=e,r.getClientRect(t)},_onTitlebarMouseDown:function(t,e){if(this.draggable){r.getViewportRect();var a,n=this;r.startDrag(t,{ondragstart:function(){a=r.getClientRect(n.getDom()),n.getDom("contmask").style.visibility="visible",n.dragMask.show(n.getDom().style.zIndex-1)},ondragmove:function(t,e){var i=a.left+t,r=a.top+e;n.safeSetOffset({left:i,top:r})},ondragstop:function(){n.getDom("contmask").style.visibility="hidden",i.removeClasses(n.getDom(),["edui-state-centered"]),n.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml(),this.fireEvent("dialogafterreset")},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*this.editor.container.style.zIndex+10),this._hidden=!1,this.fireEvent("show"),baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var t=this.getDom();t.style.display="none",t.style.zIndex="",t.style.width="",t.style.height="",this._hidden=!0,this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(t){this.render(),this.open()}if(this.showAtCenter(),this.iframeUrl)try{this.getDom("iframe").focus()}catch(e){}a=this},_onCloseButtonClick:function(t,e){this.close(!1)},close:function(t){if(!1!==this.fireEvent("close",t)){this.fullscreen&&(document.documentElement.style.overflowX=this._originalContext.html.overflowX,document.documentElement.style.overflowY=this._originalContext.html.overflowY,document.body.style.overflowX=this._originalContext.body.overflowX,document.body.style.overflowY=this._originalContext.body.overflowY,delete this._originalContext),this._hide();var e=this.getDom("content"),a=this.getDom("iframe");if(e&&a){var n=a.contentDocument||a.contentWindow.document;n&&(n.body.innerHTML=""),i.remove(e)}}}},n.inherits(u,o)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,n=baidu.editor.ui.MenuButton=function(t){this.initOptions(t),this.initMenuButton()};n.prototype={initMenuButton:function(){var t=this;this.uiName="menubutton",this.popup=new e({items:t.items,className:t.className,editor:t.editor}),this.popup.addListener("show",(function(){for(var e=this,a=0;a<e.items.length;a++)e.items[a].removeState("checked"),e.items[a].value==t._value&&(e.items[a].addState("checked"),this.value=t._value)})),this.initSplitButton()},setValue:function(t){this._value=t}},t.inherits(n,a)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.Popup,a=baidu.editor.ui.SplitButton,n=baidu.editor.ui.MultiMenuPop=function(t){this.initOptions(t),this.initMultiMenu()};n.prototype={initMultiMenu:function(){var t=this;this.popup=new e({content:"",editor:t.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+t.id+'_iframe" src="'+t.iframeUrl+'" frameborder="0"></iframe>',t.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*t.editor.container.style.zIndex+1))}}),this.onbuttonclick=function(){this.showPopup()},this.initSplitButton()}},t.inherits(n,a)}(),function(){var t,e=baidu.editor.ui,a=e.UIBase,n=e.uiUtils,i=baidu.editor.utils,r=baidu.editor.dom.domUtils,s=[],o=!1,l=e.ShortCutMenu=function(t){this.initOptions(t),this.initShortCutMenu()};function u(t){var e=t.target||t.srcElement,a=r.findParent(e,(function(t){return r.hasClass(t,"edui-shortcutmenu")||r.hasClass(t,"edui-popup")}),!0);if(!a)for(var n,i=0;n=s[i++];)n.hide()}l.postHide=u,l.prototype={isHidden:!0,SPACE:5,initShortCutMenu:function(){this.items=this.items||[],this.initUIBase(),this.initItems(),this.initEvent(),s.push(this)},initEvent:function(){var e=this,a=e.editor.document;r.on(a,"mousemove",(function(a){if(!1===e.isHidden){if(e.getSubMenuMark()||"contextmenu"==e.eventType)return;var n=!0,i=e.getDom(),r=i.offsetWidth,s=i.offsetHeight,o=r/2+e.SPACE,l=s/2,u=Math.abs(a.screenX-e.left),d=Math.abs(a.screenY-e.top);clearTimeout(t),t=setTimeout((function(){d>0&&d<l?e.setOpacity(i,"1"):d>l&&d<l+70?(e.setOpacity(i,"0.5"),n=!1):d>l+70&&d<l+140&&e.hide(),n&&u>0&&u<o?e.setOpacity(i,"1"):u>o&&u<o+70?e.setOpacity(i,"0.5"):u>o+70&&u<o+140&&e.hide()}))}})),browser.chrome&&r.on(a,"mouseout",(function(t){var a=t.relatedTarget||t.toElement;null!=a&&"HTML"!=a.tagName||e.hide()})),e.editor.addListener("afterhidepop",(function(){e.isHidden||(o=!0)}))},initItems:function(){if(i.isArray(this.items))for(var t=0,a=this.items.length;t<a;t++){var n=this.items[t].toLowerCase();e[n]&&(this.items[t]=new e[n](this.editor),this.items[t].className+=" edui-shortcutsubmenu ")}},setOpacity:function(t,e){browser.ie&&browser.version<9?t.style.filter="alpha(opacity = "+100*parseFloat(e)+");":t.style.opacity=e},getSubMenuMark:function(){o=!1;for(var t,e=n.getFixedLayer(),a=r.getElementsByTagName(e,"div",(function(t){return r.hasClass(t,"edui-shortcutsubmenu edui-popup")})),i=0;t=a[i++];)"none"!=t.style.display&&(o=!0);return o},show:function(t,e){var a=this,i={},s=this.getDom(),o=n.getFixedLayer();function l(t){t.left<0&&(t.left=0),t.top<0&&(t.top=0),s.style.cssText="position:absolute;left:"+t.left+"px;top:"+t.top+"px;"}function u(t){t.tagName||(t=t.getDom()),i.left=parseInt(t.style.left),i.top=parseInt(t.style.top),i.top-=s.offsetHeight+15,l(i)}if(a.eventType=t.type,s.style.cssText="display:block;left:-9999px","contextmenu"==t.type&&e){var d=r.getElementsByTagName(o,"div","edui-contextmenu")[0];d?u(d):a.editor.addListener("aftershowcontextmenu",(function(t,e){u(e)}))}else i=n.getViewportOffsetByEvent(t),i.top-=s.offsetHeight+a.SPACE,i.left+=a.SPACE+20,l(i),a.setOpacity(s,.2);a.isHidden=!1,a.left=t.screenX+s.offsetWidth/2-a.SPACE,a.top=t.screenY-s.offsetHeight/2-a.SPACE,a.editor&&(s.style.zIndex=1*a.editor.container.style.zIndex+10,o.style.zIndex=s.style.zIndex-1)},hide:function(){this.getDom()&&(this.getDom().style.display="none"),this.isHidden=!0},postRender:function(){if(i.isArray(this.items))for(var t,e=0;t=this.items[e++];)t.postRender()},getHtmlTpl:function(){var t;if(i.isArray(this.items)){t=[];for(var e=0;e<this.items.length;e++)t[e]=this.items[e].renderHtml();t=t.join("")}else t=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+t+"</div>"}},i.inherits(l,a),r.on(document,"mousedown",(function(t){u(t)})),r.on(window,"scroll",(function(t){u(t)}))}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.UIBase,a=baidu.editor.ui.Breakline=function(t){this.initOptions(t),this.initSeparator()};a.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}},t.inherits(a,e)}(),function(){var t=baidu.editor.utils,e=baidu.editor.dom.domUtils,a=baidu.editor.ui.UIBase,n=baidu.editor.ui.Message=function(t){this.initOptions(t),this.initMessage()};n.prototype={initMessage:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-message %%"> <div id="##_closer" class="edui-message-closer">×</div> <div id="##_body" class="edui-message-body edui-message-type-info"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-message-content">  </div> </div></div>'},reset:function(t){var e=this;t.keepshow||(clearTimeout(this.timer),e.timer=setTimeout((function(){e.hide()}),t.timeout||4e3)),void 0!==t.content&&e.setContent(t.content),void 0!==t.type&&e.setType(t.type),e.show()},postRender:function(){var t=this,a=this.getDom("closer");a&&e.on(a,"click",(function(){t.hide()}))},setContent:function(t){this.getDom("content").innerHTML=t},setType:function(t){t=t||"info";var e=this.getDom("body");e.className=e.className.replace(/edui-message-type-[\w-]+/,"edui-message-type-"+t)},getContent:function(){return this.getDom("content").innerHTML},getType:function(){var t=this.getDom("body").match(/edui-message-type-([\w-]+)/);return t?t[1]:""},show:function(){this.getDom().style.display="block"},hide:function(){var t=this.getDom();t&&(t.style.display="none",t.parentNode&&t.parentNode.removeChild(t))}},t.inherits(n,a)}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui,a=e.Dialog;e.buttons={},e.Dialog=function(t){var e=new a(t);return e.addListener("hide",(function(){if(e.editor){var t=e.editor;try{if(browser.gecko){var a=t.window.scrollY,n=t.window.scrollX;t.body.focus(),t.window.scrollTo(n,a)}else t.focus()}catch(i){}}})),e};for(var n={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"},i=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"],r=0;l=i[r++];)l=l.toLowerCase(),e[l]=function(t){return function(a){var n=new e.Button({className:"edui-for-"+t,title:a.options.labelMap[t]||a.getLang("labelMap."+t)||"",onclick:function(){a.execCommand(t)},theme:a.options.theme,showText:!1});return e.buttons[t]=n,a.addListener("selectionchange",(function(e,i,r){var s=a.queryCommandState(t);-1==s?(n.setDisabled(!0),n.setChecked(!1)):r||(n.setDisabled(!1),n.setChecked(s))})),n}}(l);e.cleardoc=function(t){var a=new e.Button({className:"edui-for-cleardoc",title:t.options.labelMap.cleardoc||t.getLang("labelMap.cleardoc")||"",theme:t.options.theme,onclick:function(){confirm(t.getLang("confirmClear"))&&t.execCommand("cleardoc")}});return e.buttons["cleardoc"]=a,t.addListener("selectionchange",(function(){a.setDisabled(-1==t.queryCommandState("cleardoc"))})),a};var s={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var o in s)(function(t,a){for(var n,i=0;n=a[i++];)(function(a){e[t.replace("float","")+a]=function(n){var i=new e.Button({className:"edui-for-"+t.replace("float","")+a,title:n.options.labelMap[t.replace("float","")+a]||n.getLang("labelMap."+t.replace("float","")+a)||"",theme:n.options.theme,onclick:function(){n.execCommand(t,a)}});return e.buttons[t]=i,n.addListener("selectionchange",(function(e,r,s){i.setDisabled(-1==n.queryCommandState(t)),i.setChecked(n.queryCommandValue(t)==a&&!s)})),i}})(n)})(o,s[o]);var l;for(r=0;l=["backcolor","forecolor"][r++];)e[l]=function(t){return function(a){var n=new e.ColorButton({className:"edui-for-"+t,color:"default",title:a.options.labelMap[t]||a.getLang("labelMap."+t)||"",editor:a,onpickcolor:function(e,n){a.execCommand(t,n)},onpicknocolor:function(){a.execCommand(t,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){a.execCommand(t,this.color)}});return e.buttons[t]=n,a.addListener("selectionchange",(function(){n.setDisabled(-1==a.queryCommandState(t))})),n}}(l);var u={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(var o in u)(function(a,i){for(var r,s=0;r=i[s++];)browser.opera&&"searchreplace"===r||function(i){e[i]=function(r,s,o){var l;s=s||(r.options.iframeUrlMap||{})[i]||n[i],o=r.options.labelMap[i]||r.getLang("labelMap."+i)||"",s&&(l=new e.Dialog(t.extend({iframeUrl:r.ui.mapUrl(s),editor:r,className:"edui-for-"+i,title:o,holdScroll:"insertimage"===i,fullscreen:/charts|preview/.test(i),closeDialog:r.getLang("closeDialog")},"ok"==a?{buttons:[{className:"edui-okbutton",label:r.getLang("ok"),editor:r,onclick:function(){l.close(!0)}},{className:"edui-cancelbutton",label:r.getLang("cancel"),editor:r,onclick:function(){l.close(!1)}}]}:{})),r.ui._dialogs[i+"Dialog"]=l);var u=new e.Button({className:"edui-for-"+i,title:o,onclick:function(){if(l)switch(i){case"wordimage":var t=r.execCommand("wordimage");t&&t.length&&(l.render(),l.open());break;case"scrawl":-1!=r.queryCommandState("scrawl")&&(l.render(),l.open());break;default:l.render(),l.open()}},theme:r.options.theme,disabled:"scrawl"==i&&-1==r.queryCommandState("scrawl")||"charts"==i});return e.buttons[i]=u,r.addListener("selectionchange",(function(){var t={edittable:1};if(!(i in t)){var e=r.queryCommandState(i);u.getDom()&&(u.setDisabled(-1==e),u.setChecked(e))}})),u}}(r.toLowerCase())})(o,u[o]);e.snapscreen=function(t,a,i){i=t.options.labelMap["snapscreen"]||t.getLang("labelMap.snapscreen")||"";var r=new e.Button({className:"edui-for-snapscreen",title:i,onclick:function(){t.execCommand("snapscreen")},theme:t.options.theme});if(e.buttons["snapscreen"]=r,a=a||(t.options.iframeUrlMap||{})["snapscreen"]||n["snapscreen"],a){var s=new e.Dialog({iframeUrl:t.ui.mapUrl(a),editor:t,className:"edui-for-snapscreen",title:i,buttons:[{className:"edui-okbutton",label:t.getLang("ok"),editor:t,onclick:function(){s.close(!0)}},{className:"edui-cancelbutton",label:t.getLang("cancel"),editor:t,onclick:function(){s.close(!1)}}]});s.render(),t.ui._dialogs["snapscreenDialog"]=s}return t.addListener("selectionchange",(function(){r.setDisabled(-1==t.queryCommandState("snapscreen"))})),r},e.insertcode=function(a,n,i){n=a.options["insertcode"]||[],i=a.options.labelMap["insertcode"]||a.getLang("labelMap.insertcode")||"";var r=[];t.each(n,(function(t,e){r.push({label:t,value:e,theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})}));var s=new e.Combox({editor:a,items:r,onselect:function(t,e){a.execCommand("insertcode",this.items[e].value)},onbuttonclick:function(){this.showPopup()},title:i,initValue:i,className:"edui-for-insertcode",indexByValue:function(t){if(t)for(var e,a=0;e=this.items[a];a++)if(-1!=e.value.indexOf(t))return a;return-1}});return e.buttons["insertcode"]=s,a.addListener("selectionchange",(function(t,e,n){if(!n){var r=a.queryCommandState("insertcode");if(-1==r)s.setDisabled(!0);else{s.setDisabled(!1);var o=a.queryCommandValue("insertcode");if(!o)return void s.setValue(i);o&&(o=o.replace(/['"]/g,"").split(",")[0]),s.setValue(o)}}})),s},e.fontfamily=function(a,n,i){if(n=a.options["fontfamily"]||[],i=a.options.labelMap["fontfamily"]||a.getLang("labelMap.fontfamily")||"",n.length){for(var r,s=0,o=[];r=n[s];s++){var l=a.getLang("fontfamily")[r.name]||"";(function(e,n){o.push({label:e,value:n,theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+t.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})})(r.label||l,r.val)}var u=new e.Combox({editor:a,items:o,onselect:function(t,e){a.execCommand("FontFamily",this.items[e].value)},onbuttonclick:function(){this.showPopup()},title:i,initValue:i,className:"edui-for-fontfamily",indexByValue:function(t){if(t)for(var e,a=0;e=this.items[a];a++)if(-1!=e.value.indexOf(t))return a;return-1}});return e.buttons["fontfamily"]=u,a.addListener("selectionchange",(function(t,e,n){if(!n){var i=a.queryCommandState("FontFamily");if(-1==i)u.setDisabled(!0);else{u.setDisabled(!1);var r=a.queryCommandValue("FontFamily");r&&(r=r.replace(/['"]/g,"").split(",")[0]),u.setValue(r)}}})),u}},e.fontsize=function(t,a,n){if(n=t.options.labelMap["fontsize"]||t.getLang("labelMap.fontsize")||"",a=a||t.options["fontsize"]||[],a.length){for(var i=[],r=0;r<a.length;r++){var s=a[r]+"px";i.push({label:s,value:s,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var o=new e.Combox({editor:t,items:i,title:n,initValue:n,onselect:function(e,a){t.execCommand("FontSize",this.items[a].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});return e.buttons["fontsize"]=o,t.addListener("selectionchange",(function(e,a,n){if(!n){var i=t.queryCommandState("FontSize");-1==i?o.setDisabled(!0):(o.setDisabled(!1),o.setValue(t.queryCommandValue("FontSize")))}})),o}},e.paragraph=function(a,n,i){if(i=a.options.labelMap["paragraph"]||a.getLang("labelMap.paragraph")||"",n=a.options["paragraph"]||[],!t.isEmptyObject(n)){var r=[];for(var s in n)r.push({value:s,label:n[s]||a.getLang("paragraph")[s],theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var o=new e.Combox({editor:a,items:r,title:i,initValue:i,className:"edui-for-paragraph",onselect:function(t,e){a.execCommand("Paragraph",this.items[e].value)},onbuttonclick:function(){this.showPopup()}});return e.buttons["paragraph"]=o,a.addListener("selectionchange",(function(t,e,n){if(!n){var i=a.queryCommandState("Paragraph");if(-1==i)o.setDisabled(!0);else{o.setDisabled(!1);var r=a.queryCommandValue("Paragraph"),s=o.indexByValue(r);-1!=s?o.setValue(r):o.setValue(o.initValue)}}})),o}},e.customstyle=function(t){var a=t.options["customstyle"]||[],n=t.options.labelMap["customstyle"]||t.getLang("labelMap.customstyle")||"";if(a.length){for(var i,r=t.getLang("customstyle"),s=0,o=[];i=a[s++];)(function(e){var a={};a.label=e.label?e.label:r[e.name],a.style=e.style,a.className=e.className,a.tag=e.tag,o.push({label:a.label,value:a,theme:t.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+a.tag+" "+(a.className?' class="'+a.className+'"':"")+(a.style?' style="'+a.style+'"':"")+">"+a.label+"</"+a.tag+"></div>"}})})(i);var l=new e.Combox({editor:t,items:o,title:n,initValue:n,className:"edui-for-customstyle",onselect:function(e,a){t.execCommand("customstyle",this.items[a].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(t){for(var e,a=0;e=this.items[a++];)if(e.label==t)return a-1;return-1}});return e.buttons["customstyle"]=l,t.addListener("selectionchange",(function(e,a,n){if(!n){var i=t.queryCommandState("customstyle");if(-1==i)l.setDisabled(!0);else{l.setDisabled(!1);var r=t.queryCommandValue("customstyle"),s=l.indexByValue(r);-1!=s?l.setValue(r):l.setValue(l.initValue)}}})),l}},e.inserttable=function(t,a,n){n=t.options.labelMap["inserttable"]||t.getLang("labelMap.inserttable")||"";var i=new e.TableButton({editor:t,title:n,className:"edui-for-inserttable",onpicktable:function(e,a,n){t.execCommand("InsertTable",{numRows:n,numCols:a,border:1})},onbuttonclick:function(){this.showPopup()}});return e.buttons["inserttable"]=i,t.addListener("selectionchange",(function(){i.setDisabled(-1==t.queryCommandState("inserttable"))})),i},e.lineheight=function(t){var a=t.options.lineheight||[];if(a.length){for(var n,i=0,r=[];n=a[i++];)r.push({label:n,value:n,theme:t.options.theme,onclick:function(){t.execCommand("lineheight",this.value)}});var s=new e.MenuButton({editor:t,className:"edui-for-lineheight",title:t.options.labelMap["lineheight"]||t.getLang("labelMap.lineheight")||"",items:r,onbuttonclick:function(){var e=t.queryCommandValue("LineHeight")||this.value;t.execCommand("LineHeight",e)}});return e.buttons["lineheight"]=s,t.addListener("selectionchange",(function(){var e=t.queryCommandState("LineHeight");if(-1==e)s.setDisabled(!0);else{s.setDisabled(!1);var a=t.queryCommandValue("LineHeight");a&&s.setValue((a+"").replace(/cm/,"")),s.setChecked(e)}})),s}};for(var d,c=["top","bottom"],p=0;d=c[p++];)(function(t){e["rowspacing"+t]=function(a){var n=a.options["rowspacing"+t]||[];if(!n.length)return null;for(var i,r=0,s=[];i=n[r++];)s.push({label:i,value:i,theme:a.options.theme,onclick:function(){a.execCommand("rowspacing",this.value,t)}});var o=new e.MenuButton({editor:a,className:"edui-for-rowspacing"+t,title:a.options.labelMap["rowspacing"+t]||a.getLang("labelMap.rowspacing"+t)||"",items:s,onbuttonclick:function(){var e=a.queryCommandValue("rowspacing",t)||this.value;a.execCommand("rowspacing",e,t)}});return e.buttons[t]=o,a.addListener("selectionchange",(function(){var e=a.queryCommandState("rowspacing",t);if(-1==e)o.setDisabled(!0);else{o.setDisabled(!1);var n=a.queryCommandValue("rowspacing",t);n&&o.setValue((n+"").replace(/%/,"")),o.setChecked(e)}})),o}})(d);for(var h,g=["insertorderedlist","insertunorderedlist"],f=0;h=g[f++];)(function(t){e[t]=function(a){var n=a.options[t],i=function(){a.execCommand(t,this.value)},r=[];for(var s in n)r.push({label:n[s]||a.getLang()[t][s]||"",value:s,theme:a.options.theme,onclick:i});var o=new e.MenuButton({editor:a,className:"edui-for-"+t,title:a.getLang("labelMap."+t)||"",items:r,onbuttonclick:function(){var e=a.queryCommandValue(t)||this.value;a.execCommand(t,e)}});return e.buttons[t]=o,a.addListener("selectionchange",(function(){var e=a.queryCommandState(t);if(-1==e)o.setDisabled(!0);else{o.setDisabled(!1);var n=a.queryCommandValue(t);o.setValue(n),o.setChecked(e)}})),o}})(h);e.fullscreen=function(t,a){a=t.options.labelMap["fullscreen"]||t.getLang("labelMap.fullscreen")||"";var n=new e.Button({className:"edui-for-fullscreen",title:a,theme:t.options.theme,onclick:function(){t.ui&&t.ui.setFullScreen(!t.ui.isFullScreen()),this.setChecked(t.ui.isFullScreen())}});return e.buttons["fullscreen"]=n,t.addListener("selectionchange",(function(){var e=t.queryCommandState("fullscreen");n.setDisabled(-1==e),n.setChecked(t.ui.isFullScreen())})),n},e["emotion"]=function(t,a){var i="emotion",r=new e.MultiMenuPop({title:t.options.labelMap[i]||t.getLang("labelMap."+i)||"",editor:t,className:"edui-for-"+i,iframeUrl:t.ui.mapUrl(a||(t.options.iframeUrlMap||{})[i]||n[i])});return e.buttons[i]=r,t.addListener("selectionchange",(function(){r.setDisabled(-1==t.queryCommandState(i))})),r},e.autotypeset=function(t){var a=new e.AutoTypeSetButton({editor:t,title:t.options.labelMap["autotypeset"]||t.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){t.execCommand("autotypeset")}});return e.buttons["autotypeset"]=a,t.addListener("selectionchange",(function(){a.setDisabled(-1==t.queryCommandState("autotypeset"))})),a},e["simpleupload"]=function(t){var a="simpleupload",n=new e.Button({className:"edui-for-"+a,title:t.options.labelMap[a]||t.getLang("labelMap."+a)||"",onclick:function(){},theme:t.options.theme,showText:!1});return e.buttons[a]=n,t.addListener("ready",(function(){var e=n.getDom("body"),a=e.children[0];t.fireEvent("simpleuploadbtnready",a)})),t.addListener("selectionchange",(function(e,i,r){var s=t.queryCommandState(a);-1==s?(n.setDisabled(!0),n.setChecked(!1)):r||(n.setDisabled(!1),n.setChecked(s))})),n}}(),function(){var t=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.ui.UIBase,n=baidu.editor.dom.domUtils,i=[];function r(t){this.initOptions(t),this.initEditorUI()}r.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars();var t=this.editor,e=this;t.addListener("ready",(function(){if(t.getDialog=function(e){return t.ui._dialogs[e+"Dialog"]},n.on(t.window,"scroll",(function(t){baidu.editor.ui.Popup.postHide(t)})),t.ui._actualFrameWidth=t.options.initialFrameWidth,UE.browser.ie&&6===UE.browser.version&&t.container.ownerDocument.execCommand("BackgroundImageCache",!1,!0),t.options.elementPathEnabled&&(t.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+t.getLang("elementPathTip")+":</div>"),t.options.wordCount){var a=function(){s(t,e),n.un(t.document,"click",arguments.callee)};n.on(t.document,"click",a),t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")}t.ui._scale(),t.options.scaleEnabled?(t.autoHeightEnabled&&t.disableAutoHeight(),e.enableScale()):e.disableScale(),t.options.elementPathEnabled||t.options.wordCount||t.options.scaleEnabled||(t.ui.getDom("elementpath").style.display="none",t.ui.getDom("wordcount").style.display="none",t.ui.getDom("scale").style.display="none"),t.selection.isFocus()&&t.fireEvent("selectionchange",!1,!0)})),t.addListener("mousedown",(function(t,e){var a=e.target||e.srcElement;baidu.editor.ui.Popup.postHide(e,a),baidu.editor.ui.ShortCutMenu.postHide(e)})),t.addListener("delcells",(function(){UE.ui["edittip"]&&new UE.ui["edittip"](t),t.getDialog("edittip").open()}));var a,i,r=!1;function s(t,e){t.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:t.options.wordCountMsg||t.getLang("wordCountMsg"),wordOverFlowMsg:t.options.wordOverFlowMsg||t.getLang("wordOverFlowMsg")});var a=t.options,n=a.maximumWords,i=a.wordCountMsg,r=a.wordOverFlowMsg,s=e.getDom("wordcount");if(a.wordCount){var o=t.getContentLength(!0);o>n?(s.innerHTML=r,t.fireEvent("wordcountoverflow")):s.innerHTML=i.replace("{#leave}",n-o).replace("{#count}",o)}}t.addListener("afterpaste",(function(){t.queryCommandState("pasteplain")||(baidu.editor.ui.PastePicker&&(a=new baidu.editor.ui.Popup({content:new baidu.editor.ui.PastePicker({editor:t}),editor:t,className:"edui-wordpastepop"}),a.render()),r=!0)})),t.addListener("afterinserthtml",(function(){clearTimeout(i),i=setTimeout((function(){if(a&&(r||t.ui._isTransfer)){if(a.isHidden()){var e=n.createElement(t.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),i=t.selection.getRange();i.insertNode(e);var s=getDomNode(e,"firstChild","previousSibling");s&&a.showAnchor(3==s.nodeType?s.parentNode:s),n.remove(e)}else a.show();delete t.ui._isTransfer,r=!1}}),200)})),t.addListener("contextmenu",(function(t,e){baidu.editor.ui.Popup.postHide(e)})),t.addListener("keydown",(function(t,e){a&&a.dispose(e);var n=e.keyCode||e.which;e.altKey&&90==n&&UE.ui.buttons["fullscreen"].onclick()})),t.addListener("wordcount",(function(t){s(this,e)})),t.addListener("selectionchange",(function(){t.options.elementPathEnabled&&e[(-1==t.queryCommandState("elementpath")?"dis":"en")+"ableElementPath"](),t.options.scaleEnabled&&e[(-1==t.queryCommandState("scale")?"dis":"en")+"ableScale"]()}));var o=new baidu.editor.ui.Popup({editor:t,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),t.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(e){this.hide(),t.ui._dialogs[e]&&t.ui._dialogs[e].open()},_onImgSetFloat:function(e){this.hide(),t.execCommand("imagefloat",e)},_setIframeAlign:function(t){var e=o.anchorEl,a=e.cloneNode(!0);switch(t){case-2:a.setAttribute("align","");break;case-1:a.setAttribute("align","left");break;case 1:a.setAttribute("align","right");break}e.parentNode.insertBefore(a,e),n.remove(e),o.anchorEl=a,o.showAnchor(o.anchorEl)},_updateIframe:function(){var e=t._iframe=o.anchorEl;n.hasClass(e,"ueditor_baidumap")?(t.selection.getRange().selectNode(e).select(),t.ui._dialogs.mapDialog.open(),o.hide()):(t.ui._dialogs.insertframeDialog.open(),o.hide())},_onRemoveButtonClick:function(e){t.execCommand(e),this.hide()},queryAutoHide:function(e){return e&&e.ownerDocument==t.document&&("img"==e.tagName.toLowerCase()||n.findParentByTagName(e,"a",!0))?e!==o.anchorEl:baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,e)}});o.render(),t.options.imagePopup&&(t.addListener("mouseover",(function(e,a){a=a||window.event;var n=a.target||a.srcElement;if(t.ui._dialogs.insertframeDialog&&/iframe/gi.test(n.tagName)){var i=o.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>");i?(o.getDom("content").innerHTML=i,o.anchorEl=n,o.showAnchor(o.anchorEl)):o.hide()}})),t.addListener("selectionchange",(function(e,a){if(a){var i="",r="",s=t.selection.getRange().getClosedNode(),l=t.ui._dialogs;if(s&&"IMG"==s.tagName){var u="insertimageDialog";if(-1==s.className.indexOf("edui-faked-video")&&-1==s.className.indexOf("edui-upload-video")||(u="insertvideoDialog"),-1!=s.className.indexOf("edui-faked-webapp")&&(u="webappDialog"),-1!=s.src.indexOf("http://api.map.baidu.com")&&(u="mapDialog"),-1!=s.className.indexOf("edui-faked-music")&&(u="musicDialog"),-1!=s.src.indexOf("http://maps.google.com/maps/api/staticmap")&&(u="gmapDialog"),s.getAttribute("anchorname")&&(u="anchorDialog",i=o.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+t.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+t.getLang("delete")+"</span></nobr>")),s.getAttribute("word_img")&&(t.word_img=[s.getAttribute("word_img")],u="wordimageDialog"),(n.hasClass(s,"loadingclass")||n.hasClass(s,"loaderrorclass"))&&(u=""),!l[u])return;r="<nobr>"+t.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+t.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+u+'\');" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>",!i&&(i=o.formatHtml(r))}if(t.ui._dialogs.linkDialog){var d,c=t.queryCommandValue("link");if(c&&(d=c.getAttribute("_href")||c.getAttribute("href",2))){var p=d;d.length>30&&(p=d.substring(0,20)+"..."),i&&(i+='<div style="height:5px;"></div>'),i+=o.formatHtml("<nobr>"+t.getLang("anthorMsg")+': <a target="_blank" href="'+d+'" title="'+d+'" >'+p+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+t.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+t.getLang("clear")+"</span></nobr>"),o.showAnchor(c)}}i?(o.getDom("content").innerHTML=i,o.anchorEl=s||c,o.showAnchor(o.anchorEl)):o.hide()}})))},_initToolbars:function(){for(var e=this.editor,a=this.toolbars||[],n=[],i=0;i<a.length;i++){for(var r=a[i],s=new baidu.editor.ui.Toolbar({theme:e.options.theme}),o=0;o<r.length;o++){var l=r[o],u=null;if("string"==typeof l){if(l=l.toLowerCase(),"|"==l&&(l="Separator"),"||"==l&&(l="Breakline"),baidu.editor.ui[l]&&(u=new baidu.editor.ui[l](e)),"fullscreen"==l){n&&n[0]?n[0].items.splice(0,0,u):u&&s.items.splice(0,0,u);continue}}else u=l;u&&u.id&&s.add(u)}n[i]=s}t.each(UE._customizeUI,(function(t,a){var n,i;if(t.id&&t.id!=e.key)return!1;n=t.execFn.call(e,e,a),n&&(i=t.index,void 0===i&&(i=s.items.length),s.add(n,i))})),this.toolbars=n},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div><div id="##_message_holder" class="%%-messageholder"></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this._dialogs["wordimageDialog"].open()},renderToolbarBoxHtml:function(){for(var t=[],e=0;e<this.toolbars.length;e++)t.push(this.toolbars[e].renderHtml());return t.join("")},setFullScreen:function(t){var e=this.editor,a=e.container.parentNode.parentNode;if(this._fullscreen!=t){if(this._fullscreen=t,this.editor.fireEvent("beforefullscreenchange",t),baidu.editor.browser.gecko)var n=e.selection.getRange().createBookmark();if(t){while("BODY"!=a.tagName){var r=baidu.editor.dom.domUtils.getComputedStyle(a,"position");i.push(r),a.style.position="static",a=a.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakEditorContaninerWidth=e.iframe.parentNode.offsetWidth,this._bakAutoHeight&&(e.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",window.scrollTo(0,window.scrollY),this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,e.iframe.parentNode.style.width="",this._updateFullScreen()}else{while("BODY"!=a.tagName)a.style.position=i.shift(),a=a.parentNode;this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(e.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,e.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px",window.scrollTo(0,this._bakScrollTop)}if(browser.gecko&&"true"===e.body.contentEditable){var s=document.createElement("input");document.body.appendChild(s),e.body.contentEditable=!1,setTimeout((function(){s.focus(),setTimeout((function(){e.body.contentEditable=!0,e.fireEvent("fullscreenchanged",t),e.selection.getRange().moveToBookmark(n).select(!0),baidu.editor.dom.domUtils.remove(s),t&&window.scroll(0,0)}),0)}),0)}"true"===e.body.contentEditable&&(this.editor.fireEvent("fullscreenchanged",t),this.triggerLayout())}},_updateFullScreen:function(){if(this._fullscreen){var t=e.getViewportRect();if(this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+t.width+"px;height:"+t.height+"px;z-index:"+(1*this.getDom().style.zIndex+100),e.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0}),this.editor.setHeight(t.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),!0),browser.gecko)try{window.onresize()}catch(a){}}},_updateElementPath:function(){var t,e=this.getDom("elementpath");if(this.elementPathEnabled&&(t=this.editor.queryCommandValue("elementpath"))){for(var a,n=[],i=0;a=t[i];i++)n[i]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+i+'&quot;);">'+a+"</span>");e.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+n.join(" &gt; ")+"</div>"}else e.style.display="none"},disableElementPath:function(){var t=this.getDom("elementpath");t.innerHTML="",t.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){var t=this.getDom("elementpath");t.style.display="",this.elementPathEnabled=!0,this._updateElementPath()},_scale:function(){var t=document,e=this.editor,a=e.container,i=e.document,r=this.getDom("toolbarbox"),s=this.getDom("bottombar"),o=this.getDom("scale"),l=this.getDom("scalelayer"),u=!1,d=null,c=0,p=e.options.minFrameWidth,h=0,g=0,f=0,m=0;function v(){d=n.getXY(a),c||(c=e.options.minFrameHeight+r.offsetHeight+s.offsetHeight),l.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+a.offsetWidth+"px;height:"+a.offsetHeight+"px;z-index:"+(e.options.zIndex+1),n.on(t,"mousemove",y),n.on(i,"mouseup",_),n.on(t,"mouseup",_)}var b=this;function y(e){D();var a=e||window.event;h=a.pageX||t.documentElement.scrollLeft+a.clientX,g=a.pageY||t.documentElement.scrollTop+a.clientY,f=h-d.x,m=g-d.y,f>=p&&(u=!0,l.style.width=f+"px"),m>=c&&(u=!0,l.style.height=m+"px")}function _(){u&&(u=!1,e.ui._actualFrameWidth=l.offsetWidth-2,a.style.width=e.ui._actualFrameWidth+"px",e.setHeight(l.offsetHeight-s.offsetHeight-r.offsetHeight-2,!0)),l&&(l.style.display="none"),D(),n.un(t,"mousemove",y),n.un(i,"mouseup",_),n.un(t,"mouseup",_)}function D(){browser.ie?t.selection.clear():window.getSelection().removeAllRanges()}this.editor.addListener("fullscreenchanged",(function(t,e){if(e)b.disableScale();else if(b.editor.options.scaleEnabled){b.enableScale();var a=b.editor.document.createElement("span");b.editor.body.appendChild(a),b.editor.body.style.height=Math.max(n.getXY(a).y,b.editor.iframe.offsetHeight-20)+"px",n.remove(a)}})),this.enableScale=function(){1!=e.queryCommandState("source")&&(o.style.display="",this.scaleEnabled=!0,n.on(o,"mousedown",v))},this.disableScale=function(){o.style.display="none",this.scaleEnabled=!1,n.un(o,"mousedown",v)}},isFullScreen:function(){return this._fullscreen},postRender:function(){a.prototype.postRender.call(this);for(var t=0;t<this.toolbars.length;t++)this.toolbars[t].postRender();var e,n=this,i=baidu.editor.dom.domUtils,r=function(){clearTimeout(e),e=setTimeout((function(){n._updateFullScreen()}))};i.on(window,"resize",r),n.addListener("destroy",(function(){i.un(window,"resize",r),clearTimeout(e)}))},showToolbarMsg:function(t,e){if(this.getDom("toolbarmsg_label").innerHTML=t,this.getDom("toolbarmsg").style.display="",!e){var a=this.getDom("upload_dialog");a.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(t){return t?t.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var t=this.getDom();"1"==t.style.zoom?t.style.zoom="100%":t.style.zoom="1"}},t.inherits(r,baidu.editor.ui.UIBase);var s={};UE.ui.Editor=function(e){var a=new UE.Editor(e);a.options.editor=a,t.loadFile(document,{href:a.options.themePath+a.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var i=a.render;return a.render=function(e){e.constructor===String&&(a.key=e,s[e]=a),t.domReady((function(){function t(){if(a.setOpt({labelMap:a.options.labelMap||a.getLang("labelMap")}),new r(a.options),e&&(e.constructor===String&&(e=document.getElementById(e)),e&&e.getAttribute("name")&&(a.options.textarea=e.getAttribute("name")),e&&/script|textarea/gi.test(e.tagName))){var t=document.createElement("div");e.parentNode.insertBefore(t,e);var s=e.value||e.innerHTML;a.options.initialContent=/^[\t\r\n ]*$/.test(s)?a.options.initialContent:s.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),e.className&&(t.className=e.className),e.style.cssText&&(t.style.cssText=e.style.cssText),/textarea/i.test(e.tagName)?(a.textarea=e,a.textarea.style.display="none"):e.parentNode.removeChild(e),e.id&&(t.id=e.id,n.removeAttributes(e,"id")),e=t,e.innerHTML=""}n.addClass(e,"edui-"+a.options.theme),a.ui.render(e);var o=a.options;a.container=a.ui.getDom();for(var l=n.findParents(e,!0),u=[],d=0;p=l[d];d++)u[d]=p.style.display,p.style.display="block";if(o.initialFrameWidth)o.minFrameWidth=o.initialFrameWidth;else{o.minFrameWidth=o.initialFrameWidth=e.offsetWidth;var c=e.style.width;/%$/.test(c)&&(o.initialFrameWidth=c)}o.initialFrameHeight?o.minFrameHeight=o.initialFrameHeight:o.initialFrameHeight=o.minFrameHeight=e.offsetHeight;var p;for(d=0;p=l[d];d++)p.style.display=u[d];e.style.height&&(e.style.height=""),a.container.style.width=o.initialFrameWidth+(/%$/.test(o.initialFrameWidth)?"":"px"),a.container.style.zIndex=o.zIndex,i.call(a,a.ui.getDom("iframeholder")),a.fireEvent("afteruiready")}a.langIsReady?t():a.addListener("langReady",t)}))},a},UE.getEditor=function(t,e){var a=s[t];return a||(a=s[t]=new UE.ui.Editor(e),a.render(t)),a},UE.delEditor=function(t){var e;(e=s[t])&&(e.key&&e.destroy(),delete s[t])},UE.registerUI=function(e,a,n,i){t.each(e.split(/\s+/),(function(t){UE._customizeUI[t]={id:i,execFn:a,index:n}}))}}(),UE.registerUI("message",(function(t){var e,a=baidu.editor.ui,n=a.Message,i=[],r=t;function s(){var t=r.ui.getDom("toolbarbox");t&&(e.style.top=t.offsetHeight+3+"px"),e.style.zIndex=Math.max(r.options.zIndex,r.iframe.style.zIndex)+1}r.addListener("ready",(function(){e=document.getElementById(r.ui.id+"_message_holder"),s(),setTimeout((function(){s()}),500)})),r.addListener("showmessage",(function(t,a){a=utils.isString(a)?{content:a}:a;var o=new n({timeout:a.timeout,type:a.type,content:a.content,keepshow:a.keepshow,editor:r}),l=a.id||"msg_"+(+new Date).toString(36);return o.render(e),i[l]=o,o.reset(a),s(),l})),r.addListener("updatemessage",(function(t,a,n){n=utils.isString(n)?{content:n}:n;var r=i[a];r.render(e),r&&r.reset(n)})),r.addListener("hidemessage",(function(t,e){var a=i[e];a&&a.hide()}))})),UE.registerUI("autosave",(function(t){var e=null,a=null;t.on("afterautosave",(function(){clearTimeout(e),e=setTimeout((function(){a&&t.trigger("hidemessage",a),a=t.trigger("showmessage",{content:t.getLang("autosave.success"),timeout:2e3})}),2e3)}))}))})()},"9f66":function(t,e,a){},a028:function(t,e,a){},a05f:function(t,e,a){"use strict";a.d(e,"a",(function(){return v})),a.d(e,"b",(function(){return b}));a("b4fb"),a("b130");var n=a("ce3c"),i=a("5748"),r=a("e793"),s=a("e8d2"),o=a("9f3a"),l=(a("43f5"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dplugin-box-icon-box"},[a("div",{staticClass:"dplugin-box-icon-warpbox"},[t.status.required&&!t.disabledRequired?a("div",{staticClass:"dplugin-box-icon"},[a("i",{staticClass:"iconfont iconRequired"})]):t._e(),t._v(" "),t.focusContent?a("div",{staticClass:"dplugin-box-icon iconzhuyi-box"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"left-start"}},[a("div",{attrs:{slot:"content"},domProps:{innerHTML:t._s(t.focusContent)},slot:"content"}),t._v(" "),a("i",{staticClass:"iconfont iconzhuyi"})])],1):t._e()])])}),u=[],d={props:{status:{type:Object,default:{}},focusContent:{type:String,default:""},disabledRequired:{type:Boolean,default:!1}}},c=d,p=a("9ca4"),h=Object(p["a"])(c,l,u,!1,null,null,null),g=h.exports,f=a("599e"),m=a("0227"),v={data:{boxClass:{"dplugin-box":!0,warning:!1,modeedit:!1,required:!1,oldrequired:!1,"dplugin-box-1":!1,"dplugin-box-2":!1},hiddenClass:{"dplugin-doneplugin":!0,"dplugin-hidden":!0,"dplugin-disappear":!1}},mixins:[f["a"],m["a"]],components:{pluginIcon:g},watch:{pluginUpdateInfo:function(t){t.key==this.pluginData.key&&this["pluginOtherMessage"]&&this["pluginOtherMessage"](t)}},props:["sendmessage","pluginData","forminfo","sendrtmessage"],computed:Object(r["a"])(Object(r["a"])({},Object(o["d"])("form",{allplugin:function(){var t=this.forminfo&&void 0!==this.forminfo.formId?this.forminfo.formId:"0";return this.$store.state.form.allplugin[t]},primaryUid:function(){return this.$store.state.form.primaryUid},starterDepartId:function(){return this.$store.state.form.starterDepartId}})),{},{getAllFocusContent:function(){var t="";if(this.pluginData.pkey&&this.pluginData.model){var e=this.allplugin.rtplugins[this.pluginData.model];t=this.pluginData.alertFoucsMsg?this.pluginData.alertFoucsMsg:e?e.alertFoucsMsg:""}else t=this.pluginData.alertFoucsMsg;return t},disabledNewRequired:function(){switch(this.mixRequiredType){case 0:return!1;case 1:return!0}}}),beforeUpdate:function(){},methods:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(o["c"])("form",["ADD_STARTLOADING"])),Object(o["b"])("form",["toReduceStartLoading","formSourceRun","isFormCanStatus"])),{},{postMessage:function(t){this.$emit("sendmessage",t)},postMethod:function(t,e){this.$emit("rtsendmessage",{method:t,data:e})},getLayoutStyle:function(){return{marginTop:this.pluginData.attr.style.marginTop,marginBottom:this.pluginData.attr.style.marginBottom,width:this.pluginData.attr.style.width,textAlign:this.pluginData.attr.style.textAlign}},getTextStyle:function(){return{fontSize:this.pluginData.attr.style.fontSize,fontFamily:this.pluginData.attr.style.fontFamily,fontWeight:this.pluginData.attr.style.fontWeight,fontStyle:this.pluginData.attr.style.fontStyle,color:this.pluginData.attr.style.color,textDecoration:this.pluginData.attr.style.textDecoration,textAlign:this.pluginData.attr.style.textAlign,lineHeight:this.pluginData.attr.style.lineHeight,letterSpacing:this.pluginData.attr.style.letterSpacing,height:this.pluginData.attr.style.height,minHeight:this.pluginData.attr.style.minHeight,boxShadow:this.pluginData.attr.style.boxShadow}},updateClassData:function(t){this.$set(this.boxClass,"warning",t.status.warning),this.$set(this.boxClass,"modeedit",t.status.modeedit),this.$set(this.boxClass,"required",t.status.required),this.$set(this.hiddenClass,"dplugin-disappear",t.status.disappear),this.disabledNewRequired&&this.$set(this.boxClass,"oldrequired",t.status.required);var e=0;this.getAllFocusContent&&!this.disabledFocus&&e++,t.status.required&&!this.disabledNewRequired&&e++,this.$set(this.boxClass,"dplugin-box-"+e,!!e)}})},b=function(t,e){var a;e=e||{},e.data=e.data?e.data:{},e.beforeUpdate=e.beforeUpdate?e.beforeUpdate:t.beforeUpdate,e.props=e.props?e.props:[],e.watch=e.watch?e.watch:{},e.methods=e.methods?e.methods:{},e.computed=e.computed?e.computed:{},e.mixins=e.mixins?e.mixins:[];var o=(a={data:function(){return Object(r["a"])(Object(r["a"])({},s["a"].copyObjFor(t.data)),s["a"].copyObjFor(e.data))},props:[].concat(Object(i["a"])(t.props),Object(i["a"])(e.props)),computed:Object(r["a"])(Object(r["a"])({},t.computed),e.computed),watch:Object(r["a"])(Object(r["a"])({},t.watch),e.watch),methods:Object(r["a"])(Object(r["a"])({},t.methods),e.methods)},Object(n["a"])(a,"computed",Object(r["a"])(Object(r["a"])({},t.computed),e.computed)),Object(n["a"])(a,"components",Object(r["a"])(Object(r["a"])({},t.components),e.components)),Object(n["a"])(a,"mixins",[].concat(Object(i["a"])(t.mixins),Object(i["a"])(e.mixins))),a);for(var l in e)["data","props","watch","methods","computed","components","mixins"].includes(l)||(o[l]=e[l]);return o}},a1fa:function(t,e,a){function n(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}a("f3dd"),a("0a51"),a("9b11"),a("e18c"),a("96db"),a("af86"),t.exports=n},a3ef:function(t,e,a){"use strict";var n=a("7ddb"),i=a.n(n);i.a},a423:function(t,e,a){t.exports=a.p+"static/img/74266593210240702.201aff12.png"},a4c7:function(t,e,a){var n=a("d890"),i=a("efe2"),r=a("f471"),s=a("5a9e").NATIVE_ARRAY_BUFFER_VIEWS,o=n.ArrayBuffer,l=n.Int8Array;t.exports=!s||!i((function(){l(1)}))||!i((function(){new l(-1)}))||!r((function(t){new l,new l(null),new l(1.5),new l(t)}),!0)||i((function(){return 1!==new l(new o(2),1,void 0).length}))},a4f9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("2d01"),i=s(n),r=a("858b");function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(t,a){return o(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,r.mod11)(t),a))}return u(e,t),e}(i.default);e.default=d},a5ee:function(t,e,a){},a7ef:function(t,e,a){"use strict";var n=a("5a9e"),i=a("58d8").right,r=n.aTypedArray,s=n.exportTypedArrayMethod;s("reduceRight",(function(t){return i(r(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},a92b:function(t,e,a){"use strict";function n(t){var e=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var a in e)e.hasOwnProperty(a)&&(a=e[a],"string"===typeof t[a]&&(t[a]=parseInt(t[a],10)));return"string"===typeof t["displayValue"]&&(t["displayValue"]="false"!=t["displayValue"]),t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},a9db:function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},ab0f:function(t,e,a){"use strict";var n=a("5a9e"),i=a("5dfd").findIndex,r=n.aTypedArray,s=n.exportTypedArrayMethod;s("findIndex",(function(t){return i(r(this),t,arguments.length>1?arguments[1]:void 0)}))},ab6e:function(t,e,a){"use strict";var n=a("5a9e"),i=a("19fc"),r=n.aTypedArray,s=n.exportTypedArrayMethod;s("copyWithin",(function(t,e){return i.call(r(this),t,e,arguments.length>2?arguments[2]:void 0)}))},ae04:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAYCAYAAACMcW/9AAAB4ElEQVRYR83VO0sDQRAA4Nm9LfMbBBEsBC1EEFGUJblcOEihP8Je8YnYiPhErf0Rlja729j4C6wUE1+o+AAtlMiaHTmJcsYkbi6R3FVX7Mx+Nzs7RwAAhBCCEOIG73F8KKU+UUqNI+JuHIEh03UAPUDE4ZhD34mUcg8AxmIPVUoNIOJhzKH7JABKKScAYDuOWES8SiQSnZ/QEnYaADZihj1mjI1wzm+/oaUxtUQIWYwJNo+IQ+l0+jrw/ICWKrsAAMstxt5prdt833/7cvyCthpLCDlzHGcgOO5wsSpCW4g9oZS6yWTyvPxEq0JbgL0wxnR5nvdSqe1qQoMApdQMIq7/c8/eaK3bwz1ZV0W/Fiul5hFx5Z+wuWKxOJTJZG5q5f+zoqE5OwcAq03G5hhjg+UXJ9LRh4Oa3Aa3hUKhI5vNvtp8vHVFm9wGl4yxXs75gw2y4sC3CWywsnmtdb/v+/c2e9Uc+DYJlFKTiLhlsza05hIAul3Xfa4z7vcvtJ4EQohZQsiaTUzwxwGAvlQq9WizPtJ4qpXYEpsv9eRTFGTkHi3fTEo5BQCbVRAXANAT5bjD+eq+9dUqUgV7ZIxJep53F7WSDV+mShsLIUYppSPGmASl9NRxnB3OeaFRZBD/ATVSvUcGtzefAAAAAElFTkSuQmCC"},ae6a:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("35e7"),r=o(i),s=a("9b97");function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function d(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=function(t){function e(t,a){return l(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s.C_START_CHAR+t,a))}return d(e,t),n(e,[{key:"valid",value:function(){return new RegExp("^"+s.C_CHARS+"+$").test(this.data)}}]),e}(r.default);e.default=c},b06a:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADBklEQVRYR+2WT0gUcRTHv2921nZ3RqmU7GIHjYjqkGREYLVtEXiIungICTt46VBJ9E93rYl2U5KgvAcVdahDERUVlTuZUIf0YgRlWkREhyLEGXfT2Xkx/ol2XXdmdhEvzfV93/d9eO/3e78hLPBHC1wf/wHy6kBQ4cXwaOsFwjoQyphpjD3iHbXF99HtSF0BBBUuI1G/RISGbIWYcZMNqVlV6IdTEMcAtR2JFV7D6CaiqlzmzDw0IYqh3lP+L04gHAFYLRe8Wh9AlU5MAR4eF+Sa3hb6Zad3BBCKjSoAnbEzy4hf7g7LzXY5tgD1t9nz84P+DYRldmYZcX1RsVT66DD9zpVnC7DtfGKLh1M9LotPypk8wXir/0VBAMGo1igQruYFADTGw/L1ggBCUW0/CDlN5ipgMg6oEflaQQDBaKJWoNTLfDpgmqhT2+THBQFMHsJBfQSA5AaCgUTSL5W+OkqJggCs5O0x7QIBx10BMK7EI3KTXY7tLbAMNilcEhD1t0SosDOcjuuGKVb3tPkG7fSOACyTYFSvIfB9IizPuYqBhADseR6Wn9oVt+KOASzxZoWX+kStA0RNlCWXgc/Mwj41EnjtpLgjgGB7ciWlJk4woVttlW+BiLdGxypEmA1MvHHaZIBJ6PfJgSfW5rMerqKU0WakqKvntDyQ9yEMxrQjBHQS4J0y4Xdgio4Y0r0+hcYyjTcoHCj26gcJHCbQEjBMBkfjhnwWCpnZQLKOYK3CReWidgNE9VnpGeMM9IJ4kIDvU2xYw0AdEcmzchgPTEOqVxVKZsayAoRio3cB2ut0jk50DDyMt0q7rRH+q58FEIqNHgKoy4mpW40JHFPD8sU5AXbEtHIT+ESA3625E721HVkUVqknA19n9GkdCEX1CIjPOTErQJP2o5IBoPWDUF2AuW0qM7+PR4pXz+qAdYVKvLqWbcHYuroUjExI0sw1/tuBne3JStM0hlx65SUXBLHqWYtvOG0T7upkaTypTW62ef9S8htVIS0NYN6LzlHA1WM0H5B/AJ4OBzDZIIsNAAAAAElFTkSuQmCC"},b1d4:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CODE39=void 0;var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("2986"),r=s(i);function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function u(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(t,a){return o(this,e),t=t.toUpperCase(),a.mod43&&(t+=f(v(t))),l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,a))}return u(e,t),n(e,[{key:"encode",value:function(){for(var t=h("*"),e=0;e<this.data.length;e++)t+=h(this.data[e])+"0";return t+=h("*"),{data:t,text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)}}]),e}(r.default),c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],p=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function h(t){return g(m(t))}function g(t){return p[t].toString(2)}function f(t){return c[t]}function m(t){return c.indexOf(t)}function v(t){for(var e=0,a=0;a<t.length;a++)e+=m(t[a]);return e%=43,e}e.CODE39=d},b476:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("35e7"),r=o(i),s=a("9b97");function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function d(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=function(t){function e(t,a){return l(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s.B_START_CHAR+t,a))}return d(e,t),n(e,[{key:"valid",value:function(){return new RegExp("^"+s.B_CHARS+"+$").test(this.data)}}]),e}(r.default);e.default=c},b497:function(t,e,a){"use strict";var n=a("5a9e"),i=a("5dfd").map,r=a("ef4c"),s=n.aTypedArray,o=n.aTypedArrayConstructor,l=n.exportTypedArrayMethod;l("map",(function(t){return i(s(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(o(r(t,t.constructor)))(e)}))}))},b523:function(t,e,a){"use strict";var n=a("5a9e"),i=n.aTypedArray,r=n.exportTypedArrayMethod,s=Math.floor;r("reverse",(function(){var t,e=this,a=i(e).length,n=s(a/2),r=0;while(r<n)t=e[r],e[r++]=e[--a],e[a]=t;return e}))},b722:function(t,e,a){"use strict";var n=a("1c8b"),i=a("d890"),r=a("1c2e9"),s=a("403f"),o="ArrayBuffer",l=r[o],u=i[o];n({global:!0,forced:u!==l},{ArrayBuffer:l}),s(o)},b842:function(t,e){var a,n="function"===typeof setImmediate;a=n?function(t){setImmediate(t)}:function(t){setTimeout(t,0)},t.exports=a},bdd1:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("25cd"),i=function(t,e,a){var i=t.split("").map((function(t,a){return n.BINARIES[e[a]]})).map((function(e,a){return e?e[t[a]]:""}));if(a){var r=t.length-1;i=i.map((function(t,e){return e<r?t+a:t}))}return i.join("")};e.default=i},bedb:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("dbb9"),r=o(i),s=a("8335");function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var u=function(){function t(e,a,n){l(this,t),this.canvas=e,this.encodings=a,this.options=n}return n(t,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var e=(0,r.default)(this.options,this.encodings[t].options);this.drawCanvasBarcode(e,this.encodings[t]),this.drawCanvasText(e,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,s.calculateEncodingAttributes)(this.encodings,this.options,t);var e=(0,s.getTotalWidthOfEncodings)(this.encodings),a=(0,s.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=e+this.options.marginLeft+this.options.marginRight,this.canvas.height=a,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,e){var a,n=this.canvas.getContext("2d"),i=e.data;a="top"==t.textPosition?t.marginTop+t.fontSize+t.textMargin:t.marginTop,n.fillStyle=t.lineColor;for(var r=0;r<i.length;r++){var s=r*t.width+e.barcodePadding;"1"===i[r]?n.fillRect(s,a,t.width,t.height):i[r]&&n.fillRect(s,a,t.width,t.height*i[r])}}},{key:"drawCanvasText",value:function(t,e){var a,n,i=this.canvas.getContext("2d"),r=t.fontOptions+" "+t.fontSize+"px "+t.font;t.displayValue&&(n="top"==t.textPosition?t.marginTop+t.fontSize-t.textMargin:t.height+t.textMargin+t.marginTop+t.fontSize,i.font=r,"left"==t.textAlign||e.barcodePadding>0?(a=0,i.textAlign="left"):"right"==t.textAlign?(a=e.width-1,i.textAlign="right"):(a=e.width/2,i.textAlign="center"),i.fillText(e.text,a,n))}},{key:"moveCanvasDrawing",value:function(t){var e=this.canvas.getContext("2d");e.translate(t.width,0)}},{key:"restoreCanvas",value:function(){var t=this.canvas.getContext("2d");t.restore()}}]),t}();e.default=u},c0a0:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAC5ElEQVRYR+2WP2gUURDGv7l9b4OJaGKC2sQiERGxMBAbMeAle4KCaJNCgsQijYWYQm1UVEwhiqDpBRUttFBEhcQ7E6IWKWKaqCAxUUTUQjBizOX2vduRPRLxcn/27V6Rxm3nm29+O+/N7BKW+aFlro//AJE6wMOo1Vps4xhtZY8bYoQ5Yen7FMf7sEcaCoCH0aCy8iqArhKF7khL9VIc301BjAE4iQ0uySECmsuZMzBls2qnBD6ZQBgB+C13s/IVAU0mpgxM21WqldrwI0hvBJBJinNEdDbILD/O12xH9wblBALwPViqTnwB0dogs7w482+pdD3tRaZcXiCASok2Bj0PVXxBTDHeJdv1SEUAbsrqBmI3ogCAvW47kb1VGcAz6xA4VtakdAHvsO1kb1YEoJJiJxO9iNIBAu+Rjh6oCGDhEv4EUU04CE7Lal1PO5CuCMBPzqTEJQKdCAeA67ajeoJyAqfAN+BRrHJ/yddEaAwyzMX9EWTdQrsxGaQ3AvBN3KeylWP8iEDry5tymoD90tHJoOJ+3Bgg92IDWKMseRHEPQAV5DLwkRgH7YQaNSluBMDD2Ki0PMnkDdkd2btEYB5Bo3ZFlwdsXyg0YVk8bs1nB/3N53+4FMkzzKq/KoGJyJfQTcljAF8GSOY6ALwFeX326uxDasXcUmMeQ7WeEUcYOAVQHZg9JvTZHfo8EbxiIEWPgN/Adr/K2wR0FqVndkF4CfAkM33LaYi2+HMP0MoCMPBj29KdFMf80lhRgExKPCDQAdNzNNEx8xPb0fv8I/xXXwDgJuVREPpNTMNqCHxcOvpKSQBOYZ2C+ADQirDmZnpOS0tvojg+L+rzOqCS4jQTXTAzi6rK/1HJA3BTchxAS1RrkzwG3lU5anNBB/wRUjNittiCMTEOo5G1qmZxjP92gFNoUpBTYYyiaiVUMzmYztuEPIgaHROLmy2qt1GeEHqM4pg1WsVGjhWIQn2MKqhTMvUPGX79IXZK25oAAAAASUVORK5CYII="},c12c:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("4194"),core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_find__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("fe59"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("b130"),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_last_index_of__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("6ae3"),core_js_modules_es_array_last_index_of__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_last_index_of__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("2eeb"),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("053b"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("fe8a"),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("08ba"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_7__),_form_controller_plugins_formPluginBase__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("a05f"),_helpers_upFileHelper_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("e9e4"),_matter_helpers_matterHelper__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("dc64");__webpack_exports__["a"]=Object(_form_controller_plugins_formPluginBase__WEBPACK_IMPORTED_MODULE_8__["b"])(_form_controller_plugins_formPluginBase__WEBPACK_IMPORTED_MODULE_8__["a"],{name:"dOcr",data:{showImg:!1,mapConfig:[]},watch:{pluginData:function(t){this.updateData(t)}},methods:{updateData:function(t){this.updateClassData(t)},uploadEvent:function(){this.pluginData.status.readonly||this.$refs.upload.click()},upload:function(t){var e=this,a=this.$refs.upload.files[0];if(a){var n=a.name.substring(a.name.lastIndexOf(".")+1).toLowerCase();["png","jpg","jpeg","bmp"].includes(n)?Object(_helpers_upFileHelper_js__WEBPACK_IMPORTED_MODULE_9__["a"])(a,"image").then((function(a){"SUCCESS"==a.state?(e.pluginData.data=a.url,e.postMessage(e.pluginData),e.getdataList(a.url)):e.$message({type:"error",message:"上传失败，请联系管理员",showClose:!0}),$(t.target).val("")}),(function(a){e.$message({type:"error",message:"上传失败，请联系管理员",showClose:!0}),$(t.target).val("")})):this.$message({type:"error",message:"只能上传 png、jpg、jpeg、bmp 类型文件",showClose:!0})}},getdataList:function(t){var e=this;Object.keys(this.pluginData.attr.data.mapConfig).length&&this.appFetch({url:"getOcrData",method:"get",data:{file:t,id:this.pluginData.attr.data.api,params:this.pluginData.attr.data.apiData}}).then((function(t){t.e?e.$message({type:"error",message:t.m,showClose:!0}):e.setPluginData(t.d)})).catch((function(t){e.$message({type:"error",message:"系统错误",showClose:!0})}))},setPluginData:function setPluginData(data){var nowMapConfig=this.pluginData.attr.data.mapConfig;for(var key in nowMapConfig){var nowData="";try{nowData=void 0!=eval("data.".concat(nowMapConfig[key]["key"]))?this.setData(eval("data.".concat(nowMapConfig[key]["key"])),nowMapConfig[key]["key"]):""}catch(error){}this.setPluginOneData(key,nowData)}},setData:function(t,e){var a=this.mapConfig.find((function(t){return t.key==e}));return a.map?a.map[t]:t},setPluginOneData:function(t,e){var a=this.allplugin.plugins[t];a&&("dRepeatTable"==a.type&&(e=this.repeatTableChangeData(t,e)),a.data=e,a=_matter_helpers_matterHelper__WEBPACK_IMPORTED_MODULE_10__["a"].setComPluginData(a),"dRepeatTable"==a.type&&(a.formtype="datasource"),this.postMessage(a),"dRepeatTable"==a.type&&this.$emit("ptablesendmessage",{type:"resetRtable",method:"resetInit",key:a.key}))},repeatTableChangeData:function(t,e){var a=[],n={},i=this;return n=this.pluginData.attr.data.mapConfig[t].children,e.length&&e.forEach((function(e){var r=i.getInitDataByPkey(t);for(var s in r){var o=n[s]?n[s].key?n[s].key:n[s]:"";o&&(r[s]=e[o])}a.push(r)})),a},getInitDataByPkey:function(t){var e=this.allplugin.plugins[t],a={},n=this;if(e){var i="v3"==this.forminfo.version?e.attr.data.tableData:e.attr.data;i.trs[1].tds.forEach((function(t){t.dataid&&(a[t.dataid]=n.allplugin.rtplugins[t.dataid].data)}))}return a},getMapConfig:function(t){var e=this;this.appFetch({url:"getOcrApiDetail",method:"get",data:{id:this.pluginData.attr.data.api}}).then((function(t){t.e?e.$message({type:"error",message:t.m,showClose:!0}):e.mapConfig=t.d.field})).catch((function(t){e.$message({type:"error",message:"系统错误",showClose:!0})}))}},mounted:function(){this.updateData(this.pluginData),!this.pluginData.status.formmodeedit&&this.pluginData.attr.data.api&&this.getMapConfig()}})},c3ba:function(t,e,a){"use strict";var n=a("5a9e").exportTypedArrayMethod,i=a("efe2"),r=a("d890"),s=r.Uint8Array,o=s&&s.prototype||{},l=[].toString,u=[].join;i((function(){l.call({})}))&&(l=function(){return u.call(this)});var d=o.toString!=l;n("toString",l,d)},c763:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.version?["v3"==t.version?a("formTableV3",{attrs:{watchmessage:t.newInfo},on:{sendmessage:t.toSendMessage}}):t._e(),t._v(" "),"v2"==t.version?a("formTableV2",{attrs:{watchmessage:t.newInfo},on:{sendmessage:t.toSendMessage}}):t._e()]:t._e()],2)},i=[],r=(a("71a9"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"t"},[a("div",{staticClass:"table_content"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showoutbox,expression:"!showoutbox"}],staticClass:"pageBox tablewarp",style:t.getStyle({width:t.pageSize.width}),attrs:{id:"pageBox"},on:{mousemove:function(e){return t.tdChangeMousemove(e)}}},[t._l(t.cutLineInfo,(function(e){return a("div",{directives:[{name:"show",rawName:"v-show",value:t.formmodeedit||t.isPrintMake,expression:"formmodeedit || isPrintMake"}],staticClass:"cutline",style:{top:e+"px"}})})),t._v(" "),t.tableData.tdModels?a("table",{class:t.formtableClass,style:t.getStyle(t.tableData.style,Object.assign({},{width:t.tableData.width+"px"},t.otherStyle)),attrs:{"data-id":t.tableData.id}},[a("tr",{staticClass:"toptr"},t._l(t.tableData.tdModels,(function(e){return a("td",{style:t.getStyle(e)})})),0),t._v(" "),t._l(t.tableData.trs,(function(e,n){return"print"!=e.type?a("tr",{directives:[{name:"show",rawName:"v-show",value:!e.isHide,expression:"!tr.isHide"}],style:t.getStyle(e.style,{},"table"),attrs:{"data-id":e.id}},t._l(e.tds,(function(e,n){return a("td",{directives:[{name:"show",rawName:"v-show",value:e.rowspan>0&&e.colspan>0,expression:"td.rowspan > 0 && td.colspan > 0"}],class:t.isSelect(e.id),style:t.getStyle(e.style,t.getTdStyleByTdInfo(e),"table"),attrs:{"data-id":e.id,rowspan:e.rowspan,colspan:e.colspan},on:{mouseover:function(a){return a.stopPropagation(),t.tdMouseover(e.id,a)},mousedown:function(a){a.stopPropagation(),t.tdMouserdown(e.id,a),t.tdChangeMousedown(a)},mouseup:function(a){t.tdMouseup(e.id,a),t.tdChangeMouseup(a),t.tdPrintMouseUp(a)},mousemove:function(e){return t.tdChangeMousemove(e)}}},[e.table.id?[a("table",{staticClass:"formtable formtablenoedit",style:t.getStyle({width:e.table.width},{},"table"),attrs:{"data-id":e.table.id}},[a("tr",{staticClass:"toptr"},t._l(e.table.tdModels,(function(e){return a("td",{style:t.getStyle(e)})})),0),t._v(" "),t._l(e.table.trs,(function(e,n){return["print"!=e.type?a("tr",{directives:[{name:"show",rawName:"v-show",value:!e.isHide,expression:"!ctr.isHide"}],style:t.getStyle(e.style,{},"table"),attrs:{"data-id":e.id}},t._l(e.tds,(function(e,i){return a("td",{directives:[{name:"show",rawName:"v-show",value:e.rowspan>0&&e.colspan>0,expression:"ctd.rowspan > 0 && ctd.colspan > 0"}],class:t.isSelect(e.id),style:t.getStyle(e.style,t.appCommonH.mergeObj(t.getOtherStyle(e.id,n,i,e.style),e.dataid?t.plugin.plugins[e.dataid].attr.style.tdStyle:{}),"table"),attrs:{"data-id":e.id,rowspan:e.rowspan,colspan:e.colspan},on:{mouseover:function(a){return a.stopPropagation(),t.tdMouseover(e.id,a)},mousedown:function(a){a.stopPropagation(),t.tdMouserdown(e.id,a),t.tdChangeMousedown(a)},mouseup:function(a){t.tdMouseup(e.id,a),t.tdChangeMouseup(a),t.tdPrintMouseUp(a)},mousemove:function(e){return t.tdChangeMousemove(e)}}},[e.dataid&&t.startDoPlugin?a("allPlugin",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,plugin:t.plugin,forminfo:t.formInfo,watchmessage:t.plugin.plugins[e.dataid]},on:{sendmessage:t.setPluginValue,sendrtmessage:t.rtPostMessage,tablesendmessage:t.tableSendMessage}}):t._e()],1)})),0):a("tr",{style:t.getStyle(e.style,{},"table"),attrs:{"data-id":e.id}},t._l(e.tds,(function(n,i){return a("td",{class:t.isSelect(n.id),style:t.getStyle(n.style,{position:"relative",padding:"0px",border:0},"table"),attrs:{"data-id":n.id,rowspan:n.rowspan,colspan:n.colspan},on:{mousedown:function(e){return e.stopPropagation(),t.tdMouserdown(n.id,e)},mouseup:function(e){t.tdMouseup(n.id,e),t.tdPrintMouseUp(e)}}},[t.isPrintMake?a("div",{staticClass:"printLine",on:{mousedown:function(a){return t.tdPrintMouseDown(a,e.id)}}}):t._e()])})),0)]}))],2)]:t._e(),t._v(" "),e.dataid&&t.startDoPlugin?a("allPlugin",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,plugin:t.plugin,forminfo:t.formInfo,watchmessage:t.plugin.plugins[e.dataid]},on:{sendmessage:t.setPluginValue,sendrtmessage:t.rtPostMessage,tablesendmessage:t.tableSendMessage}}):t._e()],2)})),0):a("tr",{style:t.getStyle(e.style,{},"table"),attrs:{"data-id":e.id}},t._l(e.tds,(function(n,i){return a("td",{class:t.isSelect(n.id),style:t.getStyle(n.style,{position:"relative",padding:"0px",border:0},"table"),attrs:{"data-id":n.id,rowspan:n.rowspan,colspan:n.colspan},on:{mousedown:function(e){return e.stopPropagation(),t.tdMouserdown(n.id,e)},mouseup:function(e){t.tdMouseup(n.id,e),t.tdPrintMouseUp(e)}}},[t.isPrintMake?a("div",{staticClass:"printLine",on:{mousedown:function(a){return t.tdPrintMouseDown(a,e.id)}}}):t._e()])})),0)}))],2):t._e(),t._v(" "),a("div",{staticClass:"clearboth"}),t._v(" "),a("div",{staticClass:"operationalert"},[a("ul",[a("li",{class:" "+(t.operationAlert.removeRow?"":"disbale"),on:{click:function(e){t.operationAlert.removeRow?t.removeRow():t.no}}},[t._v("\n\t\t\t\t\t\t删除当前行\n\t\t\t\t\t")]),t._v(" "),t.formmodeedit?[a("li",{staticClass:"insertTr",class:" "+(t.operationAlert.topAddRow?"":"disbale")},[t._v("\n\t\t\t\t\t\t\t上方插入"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.upRowNum,expression:"upRowNum"}],attrs:{type:"text"},domProps:{value:t.upRowNum},on:{input:[function(e){e.target.composing||(t.upRowNum=e.target.value)},function(e){return t.totopvalue("up",e)}]}}),t._v("行\n\t\t\t\t\t\t\t"),a("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){t.operationAlert.topAddRow?t.addRow("up"):t.no}}})]),t._v(" "),a("li",{staticClass:"insertTr",class:" "+(t.operationAlert.bottomAddRow?"":"disbale")},[t._v("\n\t\t\t\t\t\t\t下方插入"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.downRowNum,expression:"downRowNum"}],attrs:{type:"text"},domProps:{value:t.downRowNum},on:{input:[function(e){e.target.composing||(t.downRowNum=e.target.value)},function(e){return t.totopvalue("down",e)}]}}),t._v("行\n\t\t\t\t\t\t\t"),a("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){t.operationAlert.bottomAddRow?t.addRow("down"):t.no}}})]),t._v(" "),a("li",{class:" "+(t.operationAlert.removeCol?"":"disbale"),on:{click:function(e){t.operationAlert.removeCol?t.removeCol():t.no}}},[t._v("\n\t\t\t\t\t\t\t删除当前列\n\t\t\t\t\t\t")]),t._v(" "),a("li",{staticClass:"insertTr",class:" "+(t.operationAlert.leftAddCol?"":"disbale")},[t._v("\n\t\t\t\t\t\t\t左侧插入"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.leftColNum,expression:"leftColNum"}],attrs:{type:"text"},domProps:{value:t.leftColNum},on:{input:[function(e){e.target.composing||(t.leftColNum=e.target.value)},function(e){return t.totopvalue("left",e)}]}}),t._v("列\n\t\t\t\t\t\t\t"),a("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){t.operationAlert.leftAddCol?t.addCol("left"):t.no}}})]),t._v(" "),a("li",{staticClass:"insertTr",class:" "+(t.operationAlert.rightAddCol?"":"disbale")},[t._v("\n\t\t\t\t\t\t\t右侧插入"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.rightColNum,expression:"rightColNum"}],attrs:{type:"text"},domProps:{value:t.rightColNum},on:{input:[function(e){e.target.composing||(t.rightColNum=e.target.value)},function(e){return t.totopvalue("right",e)}]}}),t._v("列\n\t\t\t\t\t\t\t"),a("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){t.operationAlert.rightAddCol?t.addCol("right"):t.no}}})]),t._v(" "),a("li",{class:" "+(t.operationAlert.removeTable?"":"disbale"),on:{click:function(e){t.operationAlert.removeTable?t.removeTable():t.no}}},[t._v("\n\t\t\t\t\t\t\t删除当前表\n\t\t\t\t\t\t")])]:t._e(),t._v(" "),a("li",{class:" "+(t.operationAlert.prevPrint?"":"disbale"),on:{click:function(e){t.operationAlert.prevPrint?t.addRow("up",!0):t.no}}},[t._v("\n\t\t\t\t\t\t上方插入排版行\n\t\t\t\t\t")]),t._v(" "),a("li",{class:" "+(t.operationAlert.nextPrint?"":"disbale"),on:{click:function(e){t.operationAlert.nextPrint?t.addRow("down",!0):t.no}}},[t._v("\n\t\t\t\t\t\t下方插入排版行\n\t\t\t\t\t")])],2)]),t._v(" "),t.repeatOperationAlert.key?a("div",{staticClass:"rtoperationalert",style:t.repeatOperationAlert},[a("ul",[a("li",{class:" "+(t.repeatOperationAlert.removeRow?"":"disbale"),on:{click:function(e){t.repeatOperationAlert.removeRow?t.removeRepeatPrintRow():t.no}}},[t._v("\n\t\t\t\t\t\t删除当前行\n\t\t\t\t\t")]),t._v(" "),a("li",{class:" "+(t.repeatOperationAlert.prevPrint?"":"disbale"),on:{click:function(e){t.repeatOperationAlert.prevPrint?t.addRepeatPrintRow("prev"):t.no}}},[t._v("\n\t\t\t\t\t\t上方插入排版行\n\t\t\t\t\t")]),t._v(" "),a("li",{class:" "+(t.repeatOperationAlert.nextPrint?"":"disbale"),on:{click:function(e){t.repeatOperationAlert.nextPrint?t.addRepeatPrintRow("next"):t.no}}},[t._v("\n\t\t\t\t\t\t下方插入排版行\n\t\t\t\t\t")])])]):t._e()],2),t._v(" "),t.showoutbox?a("div",{staticClass:"outpluginbox"},[a("div",{staticClass:"contentbox"},t._l(t.setOutPluginList(t.plugin.plugins),(function(e,n){return a("div",{staticClass:"classBox"},[a("div",[t._v(t._s(e[0].pluginname)+"：")]),t._v(" "),a("div",{staticClass:"plugins"},[t._l(e,(function(e){return a("div",{staticClass:"plugin"},[a("div",{staticClass:"plugin_warp"},[a("allPlugin",{attrs:{rtupdateInfo:t.rtupdateInfo,plugin:t.plugin,forminfo:t.formInfo,watchmessage:e},on:{sendmessage:t.setPluginValue,sendrtmessage:t.rtPostMessage}})],1)])})),t._v(" "),a("div",{staticClass:"clear"})],2)])})),0)]):t._e(),t._v(" "),!t.formmodeedit&&t.startDoOutPlugin?a("div",{staticStyle:{display:"none"}},[a("ul",t._l(t.plugin.plugins,(function(e){return 1==e.classtype?a("li",[a("span",[t._v(t._s(e.pluginname)+"：")]),t._v(" "),a("allPlugin",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,plugin:t.plugin,forminfo:t.formInfo,watchmessage:e},on:{sendmessage:t.setPluginValue,tablesendmessage:t.tableSendMessage}})],1):t._e()})),0)]):t._e()]),t._v(" "),a("allPluginAttr",{attrs:{plugin:t.plugin,pluginSelect:t.selectPlugins,pageSize:t.pageSize,tableData:t.tableData,formModeData:t.formModeData},on:{sendmessage:t.setPluginValue}})],1)}),s=[],o=a("e793"),l=a("91cc"),u=a("62da"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin_content"},[a("div",{staticClass:"titlebox"},[a("span",[t._v(t._s(t.nowPlugin.key?"控件属性":"表格属性"))])]),t._v(" "),t.nowPlugin.key?t._e():a("ul",{staticClass:"plugins"},[t.formModeData.name?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("表单名称："+t._s(t.formModeData.name))])])]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("纸张类型："+t._s(t.pageSize.type))])])]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6)]),t._v(" "),t.nowPlugin.key?a("ul",{staticClass:"plugins"},[t.isShowAttr()&&t.nowPlugin&&"dRichText"!=t.nowPlugin.type?a("li",{staticClass:"plugin-item fontcs"},[a("div",{staticClass:"select_fontfamily select_box"},[a("div",{staticClass:"value"},[a("span",{attrs:{title:t.getNameByValue("fontFamilys",t.nowPlugin.attr.style.fontFamily)}},[t._v(t._s(t.getNameByValue("fontFamilys",t.nowPlugin.attr.style.fontFamily)))]),t._v(" "),a("i",{staticClass:"xiala"})]),t._v(" "),a("div",{staticClass:"options"},t._l(t.fontFamilys,(function(e){return a("span",{staticClass:"option",attrs:{title:e.name},on:{click:function(a){return t.setAttr("fontFamily",e.value)}}},[t._v(t._s(e.name))])})),0)]),t._v(" "),a("div",{staticClass:"select_fontsize select_box"},[a("div",{staticClass:"value"},[a("span",[t._v(t._s(t.getNameByValue("fontSizes",t.nowPlugin.attr.style.fontSize)))]),t._v(" "),a("i",{staticClass:"xiala_h"})]),t._v(" "),a("div",{staticClass:"options"},t._l(t.fontSizes,(function(e){return a("span",{staticClass:"option",on:{click:function(a){return t.setAttr("fontSize",e.value)}}},[t._v(t._s(e.name))])})),0)]),t._v(" "),a("div",{staticClass:"select_fontcolor select_box"},[a("el-color-picker",{attrs:{size:"mini"},model:{value:t.nowPlugin.attr.style.color,callback:function(e){t.$set(t.nowPlugin.attr.style,"color",e)},expression:"nowPlugin.attr.style.color"}})],1)]):t._e(),t._v(" "),t.isShowAttr()&&t.nowPlugin&&"dRichText"!=t.nowPlugin.type?a("li",{staticClass:"plugin-item fontstyle"},[a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("normal"==t.nowPlugin.attr.style.fontWeight?"":"selected")},[a("i",{staticClass:"plugin_icon jiachu",on:{click:function(e){return t.setAttr("fontWeight")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("normal"==t.nowPlugin.attr.style.fontStyle?"":"selected")},[a("i",{staticClass:"plugin_icon xieti",on:{click:function(e){return t.setAttr("fontStyle")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("none"==t.nowPlugin.attr.style.textDecoration?"":"selected")},[a("i",{staticClass:"plugin_icon xiahuaxian",on:{click:function(e){return t.setAttr("textDecoration")}}})])]),t._v(" "),t._m(7),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("left"==t.nowPlugin.attr.style.textAlign?"selected":"")},[a("i",{staticClass:"plugin_icon alignleft",on:{click:function(e){return t.setAttr("textAlign","left")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("center"==t.nowPlugin.attr.style.textAlign?"selected":"")},[a("i",{staticClass:"plugin_icon aligncenter",on:{click:function(e){return t.setAttr("textAlign","center")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("right"==t.nowPlugin.attr.style.textAlign?"selected":"")},[a("i",{staticClass:"plugin_icon alignright",on:{click:function(e){return t.setAttr("textAlign","right")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("justify"==t.nowPlugin.attr.style.textAlign?"selected":"")},[a("i",{staticStyle:{width:"40px",display:"inline-block"},on:{click:function(e){return t.setAttr("textAlign","justify")}}},[t._v("两端")])])])]):t._e(),t._v(" "),t.nowPlugin&&"dRichText"!=t.nowPlugin.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("移动端显示：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.mobileshow,expression:"nowPlugin.mobileshow"}],attrs:{type:"radio",name:"mobilestatus"},domProps:{value:!0,checked:t._q(t.nowPlugin.mobileshow,!0)},on:{change:[function(e){return t.$set(t.nowPlugin,"mobileshow",!0)},t.dataChange]}}),t._v("\n            \n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.mobileshow,expression:"nowPlugin.mobileshow"}],attrs:{type:"radio",name:"mobilestatus"},domProps:{value:!1,checked:t._q(t.nowPlugin.mobileshow,!1)},on:{change:[function(e){return t.$set(t.nowPlugin,"mobileshow",!1)},t.dataChange]}})])])]):t._e(),t._v(" "),t.nowPlugin&&"dRichText"!=t.nowPlugin.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("打印时是否重置颜色：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.printResetColor,expression:"nowPlugin.printResetColor"}],attrs:{type:"radio",name:"printResetColor"},domProps:{value:!0,checked:t._q(t.nowPlugin.printResetColor,!0)},on:{change:[function(e){return t.$set(t.nowPlugin,"printResetColor",!0)},t.dataChange]}}),t._v("\n            \n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.printResetColor,expression:"nowPlugin.printResetColor"}],attrs:{type:"radio",name:"printResetColor"},domProps:{value:!1,checked:t._q(t.nowPlugin.printResetColor,!1)},on:{change:[function(e){return t.$set(t.nowPlugin,"printResetColor",!1)},t.dataChange]}})])])]):t._e(),t._v(" "),a("li",{staticClass:"plugin-itembox"},[t.nowPlugin&&"dOneInput"==t.nowPlugin.type?a("dOneInputAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dIntegerInput"==t.nowPlugin.type?a("dIntegerInputAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dNumericInput"==t.nowPlugin.type?a("dNumericInputAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dmultiText"==t.nowPlugin.type?a("dmultiTextAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dmultiInputs"==t.nowPlugin.type?a("dmultiInputAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSelect"==t.nowPlugin.type?a("dSelectAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSelectV2"==t.nowPlugin.type?a("dSelectV2Attr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dInput"==t.nowPlugin.type?a("dInputAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRadio"==t.nowPlugin.type?a("dRadioAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dCheckbox"==t.nowPlugin.type?a("dCheckboxAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dImage"==t.nowPlugin.type?a("dImageAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dUser"==t.nowPlugin.type?a("dUserAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dCountryV2"==t.nowPlugin.type?a("dCountryV2Attr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dOpinion"==t.nowPlugin.type?a("dOpinionAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dCalendar"==t.nowPlugin.type?a("dCalendarAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dUserSearch"==t.nowPlugin.type?a("dUserSearchAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dLink"==t.nowPlugin.type?a("dLinkAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dFile"==t.nowPlugin.type?a("dFileAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,formModeData:t.formModeData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dDepart"==t.nowPlugin.type?a("dDepartAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dJoinSign"==t.nowPlugin.type?a("dJoinSignAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dProjectNumber"==t.nowPlugin.type?a("dProjectNumberAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dPasswd"==t.nowPlugin.type?a("dPasswdAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dBinding"==t.nowPlugin.type?a("dBindingAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dQuote"==t.nowPlugin.type?a("dQuoteAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSeal"==t.nowPlugin.type?a("dSealAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dMultiple"==t.nowPlugin.type?a("dMultipleAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dAvatar"==t.nowPlugin.type?a("dAvatarAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dCount"==t.nowPlugin.type?a("dCountAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRegion"==t.nowPlugin.type?a("dRegionAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dShowHide"==t.nowPlugin.type?a("dShowHideAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dPayment"==t.nowPlugin.type?a("dPaymentAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dQrcode"==t.nowPlugin.type?a("dQrcode",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRepeatTable"==t.nowPlugin.type?a("dRepeatTableAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dDataSource"==t.nowPlugin.type?a("dDataSourceAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSync"==t.nowPlugin.type?a("dSyncAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dShow"==t.nowPlugin.type?a("dShowAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dValidate"==t.nowPlugin.type?a("dValidateAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dAlert"==t.nowPlugin.type?a("dAlertAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dVariate"==t.nowPlugin.type?a("dVariateAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSerial"==t.nowPlugin.type?a("dSerialAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,formModeData:t.formModeData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dChildTable"==t.nowPlugin.type?a("dChildTableAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,formModeData:t.formModeData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dTableAttr"==t.nowPlugin.type?a("dTableAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,formModeData:t.formModeData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dOneColumnAttr"==t.nowPlugin.type?a("dOneColumnAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,formModeData:t.formModeData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dXImage"==t.nowPlugin.type?a("dXimageAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dConversion"==t.nowPlugin.type?a("dConversionAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRichText"==t.nowPlugin.type?a("dRichtextAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSubmit"==t.nowPlugin.type?a("dSubmitAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRoom"==t.nowPlugin.type?a("dRoomAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e()],1),t._v(" "),t.isShowAttr()?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("上间距：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.attr.style.marginTop,expression:"nowPlugin.attr.style.marginTop"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.attr.style.marginTop},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin.attr.style,"marginTop",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("下间距：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.attr.style.marginBottom,expression:"nowPlugin.attr.style.marginBottom"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.attr.style.marginBottom},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin.attr.style,"marginBottom",e.target.value)}}})])])]):t._e(),t._v(" "),t.isShowAttr()?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("行高：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.attr.style.lineHeight,expression:"nowPlugin.attr.style.lineHeight"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.attr.style.lineHeight},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin.attr.style,"lineHeight",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("文字间距：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.attr.style.letterSpacing,expression:"nowPlugin.attr.style.letterSpacing"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.attr.style.letterSpacing},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin.attr.style,"letterSpacing",e.target.value)}}})])])]):t._e(),t._v(" "),t.isPublic?t._e():[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("排序：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.sort,expression:"nowPlugin.sort"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.sort},on:{keyup:t.dataChange,input:[function(e){e.target.composing||t.$set(t.nowPlugin,"sort",e.target.value)},t.sortChange]}})])])]),t._v(" "),t.isShowAttr()?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("字段名称：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.key,expression:"nowPlugin.key"}],attrs:{type:"text",readonly:"readonly"},domProps:{value:t.nowPlugin.key},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin,"key",e.target.value)}}})])])]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("字段含义：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.description,expression:"nowPlugin.description"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.description},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin,"description",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"desc"},[t._v("（统计表格时使用，必填）")])])]),t._v(" "),t.isShowAttr()?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("组名称：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.groupname,expression:"nowPlugin.groupname"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.groupname},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin,"groupname",e.target.value)}}})])])]):t._e()],t._v(" "),a("li",{staticClass:"clearboth"})],2):t._e()])},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件多选快捷键：\n          "),a("strong",[t._v("shift + 鼠标单击")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件和表格取消选中快捷键：\n          "),a("strong",[t._v("shift + r")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件删除快捷键：\n          "),a("strong",[t._v("shift + d")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件复制快捷键：\n          "),a("strong",[t._v("shift + c")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件粘贴快捷键：\n          "),a("strong",[t._v("shift + v")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件剪切快捷键：\n          "),a("strong",[t._v("shift + x")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("前进后退支持的操作：")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("设置页类型")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("添加表")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("删除行")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("添加行")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("删除列")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("添加列")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("删除表")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("合并单元格")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("拆分单元格")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("隐藏边框")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("显示边框")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("添加组件")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("删除组件")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("重复表添加列")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("重复表删除列")]),t._v(" "),a("br"),t._v("  \n        "),a("span",{staticClass:"formtitle"},[t._v("删除重复表")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin"},[a("div",{staticClass:"xian"})])}],p=(a("fe59"),a("b130"),a("053b"),a("90aa"),a("08ba"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否解析空格：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.readTypes,(function(e,n){return[t._v("\n                        "+t._s(e.name)+" \n                        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isReadSpace,expression:"pluginAttrData.attr.data.isReadSpace"}],attrs:{name:"type",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.isReadSpace,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"isReadSpace",e.value)},t.dataChange]}}),t._v("\n                          \n                    ")]}))],2)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("内容：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.data,expression:"pluginAttrData.data"}],domProps:{value:t.pluginAttrData.data},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData,"data",e.target.value)}}})])])])]):t._e()}),h=[],g={name:"doneinputattr",props:["sendmessage","pluginAttrData"],data:function(){return{readTypes:[{name:"是",value:1},{name:"否",value:0}]}},mounted:function(){this.pluginAttrData.attr.data instanceof Array&&(this.pluginAttrData.attr.data=Object(o["a"])({},this.pluginAttrData.attr.data),this.pluginAttrData.attr.data.isReadSpace?this.pluginAttrData.attr.data.isReadSpace:this.pluginAttrData.attr.data.isReadSpace=0)},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}}},f=g,m=a("9ca4"),v=Object(m["a"])(f,p,h,!1,null,null,null),b=v.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("数据上限 ：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.wordlimit,expression:"pluginAttrData.attr.data.wordlimit"}],staticClass:"ctrl-item-input",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.wordlimit},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"wordlimit",e.target.value)}}})]),t._v(" 位\n    ")])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("最小值 ：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.minNum,expression:"pluginAttrData.attr.data.minNum"}],staticClass:"ctrl-item-input",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.minNum},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"minNum",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("最大值 ：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.maxNum,expression:"pluginAttrData.attr.data.maxNum"}],staticClass:"ctrl-item-input",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.maxNum},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"maxNum",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入框样式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.styleType,expression:"pluginAttrData.attr.data.styleType"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"styleType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:void 0}},[t._v("请选择")]),t._v(" "),t._l(t.styleTypes,(function(e,n){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}))],2)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeholder,expression:"pluginAttrData.attr.data.placeholder"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.placeholder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeholder",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("占位文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.data,expression:"pluginAttrData.data"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.data},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData,"data",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("关联组件显示大写金额：")]),t._v(" "),a("div",{staticStyle:{display:"inline-block",width:"173px"}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.bind,callback:function(e){t.$set(t.pluginAttrData.attr.data,"bind",e)},expression:"pluginAttrData.attr.data.bind"}},t._l(t.allPluginData,(function(t){return a("el-option",{key:t.key,attrs:{label:t.description||t.key,value:t.key}})})),1)],1)])])]):t._e()},_=[],D={name:"dInputattr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{styleTypes:[{name:"输入框",value:0},{name:"下划线",value:1}]}},computed:{allPluginData:function(){var t={};for(var e in this.pluginData)"dmultiText"!=this.pluginData[e].type&&"dOneInput"!=this.pluginData[e].type||(t[e]=this.pluginData[e]);return t}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}},mounted:function(){}},C=D,w=Object(m["a"])(C,y,_,!1,null,null,null),x=w.exports,k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("小数点后 ：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.wordlimit,expression:"pluginAttrData.attr.data.wordlimit"}],staticClass:"ctrl-item-input",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.wordlimit},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"wordlimit",e.target.value)}}})]),t._v(" 位\n    ")])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("最小值 ：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.minNum,expression:"pluginAttrData.attr.data.minNum"}],staticClass:"ctrl-item-input",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.minNum},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"minNum",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("最大值 ：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.maxNum,expression:"pluginAttrData.attr.data.maxNum"}],staticClass:"ctrl-item-input",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.maxNum},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"maxNum",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入框样式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.styleType,expression:"pluginAttrData.attr.data.styleType"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"styleType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:void 0}},[t._v("请选择")]),t._v(" "),t._l(t.styleTypes,(function(e,n){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}))],2)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeholder,expression:"pluginAttrData.attr.data.placeholder"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.placeholder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeholder",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("占位文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.data,expression:"pluginAttrData.data"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.data},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData,"data",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("关联组件显示大写金额：")]),t._v(" "),a("div",{staticStyle:{display:"inline-block",width:"173px"}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.bind,callback:function(e){t.$set(t.pluginAttrData.attr.data,"bind",e)},expression:"pluginAttrData.attr.data.bind"}},t._l(t.allPluginData,(function(t){return a("el-option",{key:t.key,attrs:{label:t.description||t.key,value:t.key}})})),1)],1)])])]):t._e()},S=[],A={name:"dInputattr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{styleTypes:[{name:"输入框",value:0},{name:"下划线",value:1}]}},computed:{allPluginData:function(){var t={};for(var e in this.pluginData)"dmultiText"!=this.pluginData[e].type&&"dOneInput"!=this.pluginData[e].type||(t[e]=this.pluginData[e]);return t}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}}},E=A,T=Object(m["a"])(E,k,S,!1,null,null,null),I=T.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"selfattrbox dselect-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("远程搜索：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          否 \n            "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isRemote,expression:"pluginAttrData.attr.data.isRemote"}],attrs:{name:"isRemote",type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.isRemote,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isRemote",!1)},t.dataChange]}}),t._v("\n            \n          是 \n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isRemote,expression:"pluginAttrData.attr.data.isRemote"}],attrs:{name:"isRemote",type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.isRemote,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isRemote",!0)},t.dataChange]}})])])]),t._v(" "),t.pluginAttrData.attr.data.isRemote?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("远程搜索API地址：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width remoteapi"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.remoteApi,expression:"pluginAttrData.attr.data.remoteApi"}],staticClass:"padding-left",attrs:{type:"text",placeholder:"如：/api/search/list"},domProps:{value:t.pluginAttrData.attr.data.remoteApi},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"remoteApi",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选项内容：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width remoteoptionstr"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.optionStr,expression:"pluginAttrData.attr.data.optionStr"}],staticClass:"padding-left",attrs:{type:"text",placeholder:"如：{name} + {value}，效果：姓名 + id"},domProps:{value:t.pluginAttrData.attr.data.optionStr},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"optionStr",e.target.value)}}})])])])]:t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入提示：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width remoteoptionstr"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeholder,expression:"pluginAttrData.attr.data.placeholder"}],staticClass:"padding-left",attrs:{type:"text",placeholder:"如：请选择课程"},domProps:{value:t.pluginAttrData.attr.data.placeholder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeholder",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入框样式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.borderStyle,expression:"pluginAttrData.attr.data.borderStyle"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"borderStyle",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.styleTypes,(function(e,n){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选项字体大小：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("div",{staticClass:"formline",staticStyle:{width:"70px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.fontSize,expression:"pluginAttrData.attr.data.fontSize"}],staticStyle:{width:"40px"},attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.fontSize},on:{input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"fontSize",e.target.value)}}}),t._v(" px\n        ")])])])]),t._v(" "),t._m(0),t._v(" "),a("li",{staticClass:"plugin-item"},[a("table",{staticClass:"plugin-table"},[t._m(1),t._v(" "),t._l(t.pluginAttrData.attr.data.options,(function(e,n){return a("tr",[a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].name,expression:"pluginAttrData.attr.data.options[index].name"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[n].name},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[n],"name",e.target.value)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].value,expression:"pluginAttrData.attr.data.options[index].value"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[n].value},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[n],"value",e.target.value)}}})]),t._v(" "),a("td",[a("input",{attrs:{type:"radio",name:"radio"},domProps:{checked:1==t.pluginAttrData.attr.data.options[n].default},on:{click:function(e){return t.selectdef(e,n)}}})]),t._v(" "),a("td",[[a("input",{ref:"wupload",refInFor:!0,staticStyle:{display:"none"},attrs:{type:"file",id:"upImg"},on:{change:function(e){return t.fileImg(n)}}}),t._v(" "),a("div",{staticClass:"Wuploader",on:{click:function(e){return t.imgclick(n)}}},[""!=t.pluginAttrData.attr.data.options[n].imgdata?a("img",{attrs:{src:t.pluginAttrData.attr.data.options[n].imgdata,alt:""}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])]],2),t._v(" "),a("td",{staticClass:"opera"},[a("i",{staticClass:"fa fa-arrow-circle-o-up",on:{click:function(e){return t.upRecord(t.pluginAttrData.attr.data.options,n)}}}),t._v(" "),a("i",{staticClass:"fa fa-arrow-circle-o-down",on:{click:function(e){return t.downRecord(t.pluginAttrData.attr.data.options,n)}}}),t._v(" "),a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.delselectone(n)}}})])])}))],2),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.addselect}},[t._v("新增")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.delselect}},[t._v("全删")])],1),t._v(" "),t._m(2),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(3),t._v(" "),t._l(t.pluginAttrData.attr.data.linkage,(function(e,n){return a("tr",[a("td",[a("div",{staticClass:"tdselectbox"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"linkone.value"}},t._l(t.pluginAttrData.attr.data.options,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1)]),t._v(" "),a("td",[t.pluginData?a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:function(a){return t.hideChange(e.pluginkey)}},model:{value:e.pluginkey,callback:function(a){t.$set(e,"pluginkey",a)},expression:"linkone.pluginkey"}},t._l(t.pluginData,(function(e,n){return t.pluginAttrData.key!==e.key?a("el-option",{key:e.key,attrs:{label:e.description,value:e.key}}):t._e()})),1):t._e()],1),t._v(" "),a("td",{staticClass:"opera textAlignC"},[a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.removeShowHide(n)}}})])])}))],2),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.addShowHide}},[t._v("新增")])],1)],2)},N=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选项列表：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：选项值不可为空字符串）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",[t._v("文字")]),t._v(" "),a("th",[t._v("赋值")]),t._v(" "),a("th",[t._v("默认")]),t._v(" "),a("th",[t._v("图片")]),t._v(" "),a("th",[t._v("操作")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("显隐控制：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：控制显隐的组件，不可设置为必填项）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("选中项")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("隐藏组件")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])}],R=(a("ea69"),a("1d8b")),B={name:"dSelectattr",data:function(){return{styleTypes:[{name:"输入框",value:"0"},{name:"下划线",value:"1"},{name:"无边框",value:"2"}],sizeTypes:["12px","13px","14px","15px","16px","17px","18px","19px"],imageUrl:""}},props:["sendmessage","pluginAttrData","pluginData"],methods:{imgclick:function(t){this.$refs.wupload[t].click()},fileImg:function(t){var e=this;if(0!=this.$refs.wupload[t].files.length){var a=this.$refs.wupload[t].files;console.log(a);var n=new FormData;n.append("upfile",e.$refs.wupload[t].files[0]);var i=R["a"].getApi("uploadindex")+"?category=image",r=new XMLHttpRequest;r.open("post",i),r.onload=function(a){var n=JSON.parse(a.currentTarget.response),i=self.appConfig.apiBaseUrl;"https://dev-workflow.campusapp.com.cn"==self.appConfig.apiBaseUrl&&(i="dev-workflowimg.campusapp.com.cn"),"test.office.rlstech.cn"!=window.location.hostname&&(i=JSON.parse(window.sessionStorage.officeDb_getSiteConfig).imghost),"SUCCESS"==n.state&&(console.log(n,"成功"),e.pluginAttrData.attr.data.options[t].imgdata=i+"/"+n.url,e.dataChange())},r.send(n)}},addShowHide:function(){this.pluginAttrData.attr.data.linkage.push({value:"",pluginkey:""}),this.dataChange()},removeShowHide:function(t){void 0!==t&&this.pluginAttrData.attr.data.linkage.splice(t,1)[0];var e={};this.pluginAttrData.attr.data.linkage.forEach((function(t){e[t.pluginkey]||(e[t.pluginkey]=!0)})),this.pluginAttrData.attr.data.allPlugin=e,this.dataChange()},hideChange:function(t){this.removeShowHide(),this.dataChange()},dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},selectdef:function(t,e){if(0==this.pluginAttrData.attr.data.options[e].default){for(var a in this.pluginAttrData.attr.data.options)this.pluginAttrData.attr.data.options[a].default=0;this.pluginAttrData.attr.data.options[e].default=1,this.$set(this.pluginAttrData,"data",{value:this.pluginAttrData.attr.data.options[e].value,name:this.pluginAttrData.attr.data.options[e].name})}else this.pluginAttrData.attr.data.options[e].default=0,$(t.currentTarget).attr("checked",!1),this.$set(this.pluginAttrData,"data",{});this.dataChange()},addselect:function(){var t=this.pluginAttrData.attr.data.options.length+1;this.pluginAttrData.attr.data.options.push({name:"选项"+t,value:String(t),default:0,imgdata:""}),this.dataChange()},delselect:function(){this.pluginAttrData.attr.data.options=[],this.dataChange()},delselectone:function(t){this.pluginAttrData.attr.data.options.splice(t,1),this.dataChange()},upRecord:function(t,e){0!=e&&this.swapItems(t,e,e-1)},downRecord:function(t,e){e!=t.length-1&&this.swapItems(t,e,e+1)},swapItems:function(t,e,a){return t[e]=t.splice(a,1,t[e])[0],this.dataChange(),t}},created:function(){for(var t=0;t<this.pluginAttrData.attr.data.options.length;t++)this.pluginAttrData.attr.data.options[t].imgdata||(this.pluginAttrData.attr.data.options[t].imgdata="")},mounted:function(){}},O=B,M=(a("ffbb"),Object(m["a"])(O,P,N,!1,null,null,null)),L=M.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"selfattrbox dselect-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否多选：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n              否 \n              "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isMultiple,expression:"pluginAttrData.attr.data.isMultiple"}],attrs:{name:"isMultiple",type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.isMultiple,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isMultiple",!1)},function(e){return t.dataChange("isMultiple")}]}}),t._v("\n                \n              是 \n              "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isMultiple,expression:"pluginAttrData.attr.data.isMultiple"}],attrs:{name:"isMultiple",type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.isMultiple,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isMultiple",!0)},function(e){return t.dataChange("isMultiple")}]}})])])]),t._v(" "),t.pluginAttrData.attr.data.isMultiple?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("多选限制数：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width remoteapi"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.multipleLimit,expression:"pluginAttrData.attr.data.multipleLimit"}],staticClass:"padding-left",attrs:{type:"number",placeholder:"0为不限，其他正整数为限制次数"},domProps:{value:t.pluginAttrData.attr.data.multipleLimit},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"multipleLimit",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选中值展现形式：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n                选项列表 \n                  "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.multipleType,expression:"pluginAttrData.attr.data.multipleType"}],attrs:{name:"multipleType",type:"radio"},domProps:{value:0,checked:t._q(t.pluginAttrData.attr.data.multipleType,0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"multipleType",0)},t.dataChange]}}),t._v("\n                  \n                合并展示 \n                "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.multipleType,expression:"pluginAttrData.attr.data.multipleType"}],attrs:{name:"multipleType",type:"radio"},domProps:{value:1,checked:t._q(t.pluginAttrData.attr.data.multipleType,1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"multipleType",1)},t.dataChange]}})])])])]:t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("远程搜索：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          否 \n            "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isRemote,expression:"pluginAttrData.attr.data.isRemote"}],attrs:{name:"isRemote",type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.isRemote,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isRemote",!1)},t.dataChange]}}),t._v("\n            \n          是 \n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isRemote,expression:"pluginAttrData.attr.data.isRemote"}],attrs:{name:"isRemote",type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.isRemote,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isRemote",!0)},t.dataChange]}})])])]),t._v(" "),t.pluginAttrData.attr.data.isRemote?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("远程搜索API地址：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width remoteapi"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.remoteApi,expression:"pluginAttrData.attr.data.remoteApi"}],staticClass:"padding-left",attrs:{type:"text",placeholder:"如：/api/search/list"},domProps:{value:t.pluginAttrData.attr.data.remoteApi},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"remoteApi",e.target.value)}}})])])])]:t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选项内容：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width remoteoptionstr"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.optionStr,expression:"pluginAttrData.attr.data.optionStr"}],staticClass:"padding-left",attrs:{type:"text",placeholder:"如：{name} + {value}，效果：姓名 + id"},domProps:{value:t.pluginAttrData.attr.data.optionStr},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"optionStr",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入提示：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width remoteoptionstr"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeholder,expression:"pluginAttrData.attr.data.placeholder"}],staticClass:"padding-left",attrs:{type:"text",placeholder:"如：请选择课程"},domProps:{value:t.pluginAttrData.attr.data.placeholder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeholder",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入框样式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.borderStyle,expression:"pluginAttrData.attr.data.borderStyle"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"borderStyle",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.styleTypes,(function(e,n){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选项字体大小：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("div",{staticClass:"formline",staticStyle:{width:"70px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.fontSize,expression:"pluginAttrData.attr.data.fontSize"}],staticStyle:{width:"40px"},attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.fontSize},on:{input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"fontSize",e.target.value)}}}),t._v(" px\n        ")])])])]),t._v(" "),t._m(0),t._v(" "),a("li",{staticClass:"plugin-item"},[a("table",{staticClass:"plugin-table"},[t._m(1),t._v(" "),t._l(t.pluginAttrData.attr.data.options,(function(e,n){return a("tr",[a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].name,expression:"pluginAttrData.attr.data.options[index].name"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[n].name},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[n],"name",e.target.value)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].value,expression:"pluginAttrData.attr.data.options[index].value"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[n].value},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[n],"value",e.target.value)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].default,expression:"pluginAttrData.attr.data.options[index].default"}],attrs:{type:"checkbox",name:"checkboxDefault","true-value":1,"false-value":0},domProps:{checked:Array.isArray(t.pluginAttrData.attr.data.options[n].default)?t._i(t.pluginAttrData.attr.data.options[n].default,null)>-1:t._q(t.pluginAttrData.attr.data.options[n].default,1)},on:{change:[function(e){var a=t.pluginAttrData.attr.data.options[n].default,i=e.target,r=i.checked?1:0;if(Array.isArray(a)){var s=null,o=t._i(a,s);i.checked?o<0&&t.$set(t.pluginAttrData.attr.data.options[n],"default",a.concat([s])):o>-1&&t.$set(t.pluginAttrData.attr.data.options[n],"default",a.slice(0,o).concat(a.slice(o+1)))}else t.$set(t.pluginAttrData.attr.data.options[n],"default",r)},function(e){return t.selectdef()}]}})]),t._v(" "),a("td",[[a("input",{ref:"wupload",refInFor:!0,staticStyle:{display:"none"},attrs:{type:"file",id:"upImg"},on:{change:function(e){return t.fileImg(n)}}}),t._v(" "),a("div",{staticClass:"Wuploader",on:{click:function(e){return t.imgclick(n)}}},[""!=t.pluginAttrData.attr.data.options[n].imgdata?a("img",{attrs:{src:t.pluginAttrData.attr.data.options[n].imgdata,alt:""}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])]],2),t._v(" "),a("td",{staticClass:"opera"},[a("i",{staticClass:"fa fa-arrow-circle-o-up",on:{click:function(e){return t.upRecord(t.pluginAttrData.attr.data.options,n)}}}),t._v(" "),a("i",{staticClass:"fa fa-arrow-circle-o-down",on:{click:function(e){return t.downRecord(t.pluginAttrData.attr.data.options,n)}}}),t._v(" "),a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.delselectone(n)}}})])])}))],2),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.addselect}},[t._v("新增")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.delselect}},[t._v("全删")])],1)],2)},F=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选项列表：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：选项值不可为空字符串）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",[t._v("文字")]),t._v(" "),a("th",[t._v("赋值")]),t._v(" "),a("th",[t._v("默认")]),t._v(" "),a("th",[t._v("图片")]),t._v(" "),a("th",[t._v("操作")])])}],H={name:"dSelectattr",data:function(){return{styleTypes:[{name:"输入框",value:"0"},{name:"下划线",value:"1"},{name:"无边框",value:"2"}],sizeTypes:["12px","13px","14px","15px","16px","17px","18px","19px"],imageUrl:""}},props:["sendmessage","pluginAttrData","pluginData"],methods:{imgclick:function(t){this.$refs.wupload[t].click()},fileImg:function(t){var e=this;if(0!=this.$refs.wupload[t].files.length){this.$refs.wupload[t].files;var a=new FormData;a.append("upfile",e.$refs.wupload[t].files[0]);var n=R["a"].getApi("uploadindex")+"?category=image",i=new XMLHttpRequest;i.open("post",n),i.onload=function(a){var n=JSON.parse(a.currentTarget.response),i=self.appConfig.apiBaseUrl;"https://dev-workflow.campusapp.com.cn"==self.appConfig.apiBaseUrl&&(i="dev-workflowimg.campusapp.com.cn"),"test.office.rlstech.cn"!=window.location.hostname&&(i=JSON.parse(window.sessionStorage.officeDb_getSiteConfig).imghost),"SUCCESS"==n.state&&(console.log(n,"成功"),e.pluginAttrData.attr.data.options[t].imgdata=i+"/"+n.url,e.dataChange())},i.send(a)}},dataChange:function(t){switch(t){case"isMultiple":this.pluginAttrData.attr.data.isMultiple||(this.pluginAttrData.attr.data.multipleLimit=1);break}this.$emit("sendmessage",this.pluginAttrData)},selectdef:function(){var t=[];this.pluginAttrData.attr.data.options.forEach((function(e){e.default&&t.push(e)})),this.pluginAttrData.data=t,this.dataChange()},addselect:function(){var t=this.pluginAttrData.attr.data.options.length+1;this.pluginAttrData.attr.data.options.push({name:"选项"+t,value:String(t),default:0,imgdata:""}),this.dataChange()},delselect:function(){this.pluginAttrData.attr.data.options=[],this.dataChange()},delselectone:function(t){this.pluginAttrData.attr.data.options.splice(t,1),this.dataChange()},upRecord:function(t,e){0!=e&&this.swapItems(t,e,e-1)},downRecord:function(t,e){e!=t.length-1&&this.swapItems(t,e,e+1)},swapItems:function(t,e,a){return t[e]=t.splice(a,1,t[e])[0],this.dataChange(),t}},created:function(){for(var t=0;t<this.pluginAttrData.attr.data.options.length;t++)this.pluginAttrData.attr.data.options[t].imgdata||(this.pluginAttrData.attr.data.options[t].imgdata="")},mounted:function(){}},j=H,W=(a("cfc2"),Object(m["a"])(j,U,F,!1,null,null,null)),z=W.exports,V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否解析空格：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.readTypes,(function(e){return[t._v("\n                        "+t._s(e.name)+" \n                        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isReadSpace,expression:"pluginAttrData.attr.data.isReadSpace"}],attrs:{name:"type",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.isReadSpace,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"isReadSpace",e.value)},t.dataChange]}}),t._v("\n                          \n                    ")]}))],2)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("内容：")]),t._v(" "),a("div",{staticClass:"forminput formtextarea"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.nowValue,expression:"nowValue"}],staticClass:"ctrl-resize",class:t.pluginAttrData.key+"dmultiTextAttr",attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.nowValue},on:{keyup:function(e){return t.dataChange(e,"content")},input:function(e){e.target.composing||(t.nowValue=e.target.value)}}})])])])]):t._e()},q=[],G={props:["sendmessage","pluginAttrData"],data:function(){return{readTypes:[{name:"是",value:1},{name:"否",value:0}],nowValue:""}},watch:{pluginAttrData:function(t){this.nowValue=t.data}},methods:{dataChange:function(t,e){this.pluginAttrData.data=this.nowValue,this.$emit("sendmessage",this.pluginAttrData),this.changesize()},changesize:function(){$("."+this.pluginAttrData.key+"dmultiTextAttr").height(0),$("."+this.pluginAttrData.key+"dmultiTextAttr").height($("."+this.pluginAttrData.key+"dmultiTextAttr").prop("scrollHeight"))}},mounted:function(){this.nowValue=this.pluginAttrData.data,this.changesize()}},K=G,X=Object(m["a"])(K,V,q,!1,null,null,null),Y=X.exports,J=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入框样式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.styleType,expression:"pluginAttrData.attr.data.styleType"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"styleType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:void 0}},[t._v("请选择")]),t._v(" "),t._l(t.styleTypes,(function(e,n){return a("option",{domProps:{value:e.value}},[t._v("\n            "+t._s(e.name)+"\n          ")])}))],2)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("高度：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.style.minHeight,expression:"pluginAttrData.attr.style.minHeight"}],staticClass:"ctrl-resize",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.style.minHeight},on:{keyup:function(e){return t.changeheight(e,"height")},input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.style,"minHeight",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("内容限制：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.limitTypes,(function(e){return[t._v("\n          "+t._s(e.name)+"\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.limitHeightType,expression:"pluginAttrData.attr.data.limitHeightType"}],attrs:{name:"type",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.limitHeightType,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"limitHeightType",e.value)},t.dataChange]}}),t._v("   \n        ")]}))],2)])]),t._v(" "),t.pluginAttrData.attr.data.limitHeightType?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("超限提示：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.limitHeightErrorMsg,expression:"pluginAttrData.attr.data.limitHeightErrorMsg"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.limitHeightErrorMsg},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"limitHeightErrorMsg",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("超限解除提示：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.limitHeightRightMsg,expression:"pluginAttrData.attr.data.limitHeightRightMsg"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.limitHeightRightMsg},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"limitHeightRightMsg",e.target.value)}}})])])])]:t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认文字：")]),t._v(" "),a("div",[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeholder,expression:"pluginAttrData.attr.data.placeholder"}],staticStyle:{"max-width":"310px"},domProps:{value:t.pluginAttrData.attr.data.placeholder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeholder",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("占位文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.data,expression:"pluginAttrData.data"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.data},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData,"data",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("字数限制：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n        最小：\n        "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.minWord,expression:"pluginAttrData.attr.data.minWord",modifiers:{trim:!0}}],staticClass:"plugin-item_input",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.minWord},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"minWord",e.target.value.trim())},function(e){return t.setWord("minWord")}],blur:function(e){return t.$forceUpdate()}}}),t._v("   最大：\n        "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.maxWord,expression:"pluginAttrData.attr.data.maxWord",modifiers:{trim:!0}}],staticClass:"plugin-item_input",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.maxWord},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"maxWord",e.target.value.trim())},function(e){return t.setWord("maxWord")}],blur:function(e){return t.$forceUpdate()}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item",class:{common_disabled_grey:!t.pluginAttrData.attr.data.minWord&&!t.pluginAttrData.attr.data.maxWord}},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("前台显示字数范围：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("label",{attrs:{for:"isWordLinmit_1"}},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isWordLinmit,expression:"pluginAttrData.attr.data.isWordLinmit"}],attrs:{id:"isWordLinmit_1",type:"radio",name:"isWordLinmit"},domProps:{value:1,checked:t._q(t.pluginAttrData.attr.data.isWordLinmit,1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isWordLinmit",1)},t.dataChange]}})]),t._v("\n          \n        "),a("label",{attrs:{for:"isWordLinmit_0"}},[t._v("\n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isWordLinmit,expression:"pluginAttrData.attr.data.isWordLinmit"}],attrs:{id:"isWordLinmit_0",type:"radio",name:"isWordLinmit"},domProps:{value:0,checked:t._q(t.pluginAttrData.attr.data.isWordLinmit,0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isWordLinmit",0)},t.dataChange]}})])])])])],2):t._e()},Z=[],Q=(a("e35a"),a("5e9f"),{props:["sendmessage","pluginAttrData"],data:function(){return{styleTypes:[{name:"输入框",value:0},{name:"下划线",value:1}],limitTypes:[{name:"可超过高度",value:0},{name:"不可超过高度",value:1}]}},created:function(){void 0==this.pluginAttrData.attr.data.isWordLinmit&&(this.pluginAttrData.attr.data.isWordLinmit=1,this.dataChange())},methods:{changeheight:function(t,e){"height"==e&&("ArrowUp"==t.code?this.pluginAttrData.attr.style.minHeight++:"ArrowDown"==t.code&&this.pluginAttrData.attr.style.minHeight>24?this.pluginAttrData.attr.style.minHeight--:this.pluginAttrData.attr.style.minHeight+=t.target.innerText),this.dataChange()},dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},setWord:function(t){this.pluginAttrData.attr.data[t]=this.pluginAttrData.attr.data[t].replace(/\D/g,""),this.dataChange()}}}),tt=Q,et=Object(m["a"])(tt,J,Z,!1,null,null,null),at=et.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文字上限：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.wordlimit,expression:"pluginAttrData.attr.data.wordlimit"}],staticClass:"ctrl-item-input",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.wordlimit},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"wordlimit",e.target.value)}}})]),t._v(" 个字符\n    ")])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入框类型：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.value,expression:"pluginAttrData.attr.data.value"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"value",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.data.type,(function(e,n){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入框样式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.styleType,expression:"pluginAttrData.attr.data.styleType"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"styleType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:void 0}},[t._v("请选择")]),t._v(" "),t._l(t.styleTypes,(function(e,n){return a("option",{domProps:{value:e.value}},[t._v("\n            "+t._s(e.name)+"\n          ")])}))],2)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeholder,expression:"pluginAttrData.attr.data.placeholder"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.placeholder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeholder",e.target.value)}}})])])]),t._v(" "),6==t.pluginAttrData.attr.data.value?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[t._m(0),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.linkText,expression:"pluginAttrData.attr.data.linkText",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.linkText},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"linkText",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])])]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("占位文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.data,expression:"pluginAttrData.data"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.data},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData,"data",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("字数限制：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n        最小：\n        "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.minWord,expression:"pluginAttrData.attr.data.minWord",modifiers:{trim:!0}}],staticClass:"plugin-item_input",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.minWord},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"minWord",e.target.value.trim())},function(e){return t.setWord("minWord")}],blur:function(e){return t.$forceUpdate()}}}),t._v("\n         \n        最大：\n        "),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.maxWord,expression:"pluginAttrData.attr.data.maxWord",modifiers:{trim:!0}}],staticClass:"plugin-item_input",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.maxWord},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"maxWord",e.target.value.trim())},function(e){return t.setWord("maxWord")}],blur:function(e){return t.$forceUpdate()}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item",class:{common_disabled_grey:!t.pluginAttrData.attr.data.minWord&&!t.pluginAttrData.attr.data.maxWord}},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("前台显示字数范围：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("label",{attrs:{for:"isWordLinmit_1"}},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isWordLinmit,expression:"pluginAttrData.attr.data.isWordLinmit"}],attrs:{id:"isWordLinmit_1",type:"radio",name:"isWordLinmit"},domProps:{value:1,checked:t._q(t.pluginAttrData.attr.data.isWordLinmit,1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isWordLinmit",1)},t.dataChange]}})]),t._v("\n          \n        "),a("label",{attrs:{for:"isWordLinmit_0"}},[t._v("\n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isWordLinmit,expression:"pluginAttrData.attr.data.isWordLinmit"}],attrs:{id:"isWordLinmit_0",type:"radio",name:"isWordLinmit"},domProps:{value:0,checked:t._q(t.pluginAttrData.attr.data.isWordLinmit,0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isWordLinmit",0)},t.dataChange]}})])])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("联想搜索：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("label",{attrs:{for:"isSearch_1"}},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isSearch,expression:"pluginAttrData.attr.data.isSearch"}],attrs:{id:"isSearch_1",type:"radio",name:"isSearch"},domProps:{value:1,checked:t._q(t.pluginAttrData.attr.data.isSearch,1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isSearch",1)},t.dataChange]}})]),t._v("\n          \n        "),a("label",{attrs:{for:"isSearch_0"}},[t._v("\n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isSearch,expression:"pluginAttrData.attr.data.isSearch"}],attrs:{id:"isSearch_0",type:"radio",name:"isSearch"},domProps:{value:0,checked:t._q(t.pluginAttrData.attr.data.isSearch,0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isSearch",0)},t.dataChange]}})])])])]),t._v(" "),a("li",{staticClass:"plugin-item",class:{common_disabled_grey:1!=t.pluginAttrData.attr.data.isSearch}},[a("div",{staticClass:"formitem"},[t._v("\n             "),a("span",{staticClass:"formtitle"},[t._v("搜索API地址：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.api,expression:"pluginAttrData.attr.data.api"}],staticClass:"padding-left",attrs:{disabled:1!=t.pluginAttrData.attr.data.isSearch,type:"text",placeholder:"GET请求参数为keyword"},domProps:{value:t.pluginAttrData.attr.data.api},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"api",e.target.value)}}})])])])]):t._e()},it=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"formtitle"},[t._v("链接文字："),a("span",{staticClass:"desc"},[t._v("(只读状态，有文案显示文案，没有显示链接)")])])}],rt={name:"dInputattr",props:["sendmessage","pluginAttrData"],data:function(){return{styleTypes:[{name:"输入框",value:0},{name:"下划线",value:1}],isWordLinmit:1}},created:function(){void 0==this.pluginAttrData.attr.data.isWordLinmit&&(this.pluginAttrData.attr.data.isWordLinmit=1,this.dataChange()),void 0==this.pluginAttrData.attr.data.isSearch&&(this.$set(this.pluginAttrData.attr.data,"isSearch",0),this.dataChange())},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},setWord:function(t){this.pluginAttrData.attr.data[t]=this.pluginAttrData.attr.data[t].replace(/\D/g,""),this.dataChange()}}},st=rt,ot=Object(m["a"])(st,nt,it,!1,null,null,null),lt=ot.exports,ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"selfattrbox dselect-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选项间隔：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.Optionmargin,expression:"pluginAttrData.attr.data.Optionmargin"}],staticClass:"ctrl-item-input big-input",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.Optionmargin},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"Optionmargin",e.target.value)}}})])])]),t._v(" "),t._m(0),t._v(" "),a("li",{staticClass:"plugin-item"},[a("table",{staticClass:"plugin-table"},[t._m(1),t._v(" "),t._l(t.pluginAttrData.attr.data.options,(function(e,n){return a("tr",[a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].name,expression:"pluginAttrData.attr.data.options[index].name"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[n].name},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[n],"name",e.target.value)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].value,expression:"pluginAttrData.attr.data.options[index].value"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[n].value},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[n],"value",e.target.value)}}})]),t._v(" "),a("td",[a("input",{attrs:{type:"radio",name:"radio"},domProps:{checked:e.default},on:{click:function(e){return t.selectdef(e,n)}}})]),t._v(" "),a("td",{staticClass:"opera"},[a("i",{staticClass:"fa fa-arrow-circle-o-up",on:{click:function(e){return t.upRecord(t.pluginAttrData.attr.data.options,n)}}}),t._v(" "),a("i",{staticClass:"fa fa-arrow-circle-o-down",on:{click:function(e){return t.downRecord(t.pluginAttrData.attr.data.options,n)}}}),t._v(" "),a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.delselectone(n)}}})])])}))],2),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.addselect}},[t._v("新增")]),a("el-button",{attrs:{size:"mini"},on:{click:t.delselect}},[t._v("全删")])],1),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("布局方向：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.layoutdirection,expression:"pluginAttrData.attr.data.layoutdirection"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"layoutdirection",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{attrs:{value:"inherit"}},[t._v("自适应")]),t._v(" "),a("option",{attrs:{value:"nowrap"}},[t._v("横向")]),t._v(" "),a("option",{attrs:{value:"initial"}},[t._v("纵向")])])])])]),t._v(" "),t._m(2),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(3),t._v(" "),t._l(t.pluginAttrData.attr.data.linkage,(function(e,n){return a("tr",[a("td",[a("div",{staticClass:"tdselectbox"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"linkone.value"}},t._l(t.pluginAttrData.attr.data.options,(function(t,e){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1)]),t._v(" "),a("td",[t.pluginData?a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:function(a){return t.hideChange(e.pluginkey)}},model:{value:e.pluginkey,callback:function(a){t.$set(e,"pluginkey",a)},expression:"linkone.pluginkey"}},t._l(t.pluginData,(function(e,n){return t.pluginAttrData.key!==e.key?a("el-option",{key:e.key,attrs:{label:e.description,value:e.key}}):t._e()})),1):t._e()],1),t._v(" "),a("td",{staticClass:"opera textAlignC"},[a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.removeShowHide(n)}}})])])}))],2),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.addShowHide}},[t._v("新增")])],1)])},dt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选项列表：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：选项值不可为空字符串）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",[t._v("文字")]),t._v(" "),a("th",[t._v("赋值")]),t._v(" "),a("th",[t._v("默认")]),t._v(" "),a("th",[t._v("操作")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("显隐控制：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：控制显隐的组件，不可设置为必填项）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("选中项")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("隐藏组件")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])}],ct={name:"dRadioattr",data:function(){return{}},props:["sendmessage","pluginAttrData","pluginData"],methods:{addShowHide:function(){this.pluginAttrData.attr.data.linkage.push({value:"",pluginkey:""}),this.dataChange()},removeShowHide:function(t){void 0!==t&&this.pluginAttrData.attr.data.linkage.splice(t,1)[0];var e={};this.pluginAttrData.attr.data.linkage.forEach((function(t){e[t.pluginkey]||(e[t.pluginkey]=!0)})),this.pluginAttrData.attr.data.allPlugin=e,this.dataChange()},hideChange:function(t){this.removeShowHide(),this.dataChange()},dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},selectdef:function(t,e){if(0==this.pluginAttrData.attr.data.options[e].default){for(var a in this.pluginAttrData.attr.data.options)this.pluginAttrData.attr.data.options[a].default=0;this.pluginAttrData.attr.data.options[e].default=1,this.$set(this.pluginAttrData,"data",{value:this.pluginAttrData.attr.data.options[e].value,name:this.pluginAttrData.attr.data.options[e].name})}else this.pluginAttrData.attr.data.options[e].default=0,$(t.currentTarget).attr("checked",!1),this.$set(this.pluginAttrData,"data",{});this.dataChange()},addselect:function(){var t=this.pluginAttrData.attr.data.options.length+1;this.pluginAttrData.attr.data.options.push({name:"选项"+t,value:t+"",default:0}),this.dataChange()},delselect:function(){this.pluginAttrData.attr.data.options=[],this.dataChange()},delselectone:function(t){this.pluginAttrData.attr.data.options.splice(t,1),this.dataChange()},upRecord:function(t,e){0!=e&&this.swapItems(t,e,e-1)},downRecord:function(t,e){e!=t.length-1&&this.swapItems(t,e,e+1)},swapItems:function(t,e,a){return t[e]=t.splice(a,1,t[e])[0],this.dataChange(),t}}},pt=ct,ht=Object(m["a"])(pt,ut,dt,!1,null,null,null),gt=ht.exports,ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"selfattrbox dselect-attr"},[void 0!=t.pluginAttrData.attr.data.Optionmargin?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("只读显示设置：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("label",{attrs:{for:"CreadonlySetH"}},[t._v("\n\t\t\t\t\t\t只显示勾选项\n\t\t\t\t\t\t"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.readonlyShow,expression:"pluginAttrData.attr.data.readonlyShow"}],attrs:{type:"radio",name:"readonlySet",id:"CreadonlySetH"},domProps:{value:0,checked:t._q(t.pluginAttrData.attr.data.readonlyShow,0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"readonlyShow",0)},t.dataChange]}})]),t._v(" "),a("label",{attrs:{for:"CreadonlySetS"}},[t._v("\n\t\t\t\t\t\t全部显示\n\t\t\t\t\t\t"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.readonlyShow,expression:"pluginAttrData.attr.data.readonlyShow"}],attrs:{type:"radio",name:"readonlySet",id:"CreadonlySetS"},domProps:{value:1,checked:t._q(t.pluginAttrData.attr.data.readonlyShow,1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"readonlyShow",1)},t.dataChange]}})])])])]):t._e(),t._v(" "),void 0!=t.pluginAttrData.attr.data.Optionmargin?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选项间隔：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.Optionmargin,expression:"pluginAttrData.attr.data.Optionmargin"}],staticClass:"ctrl-item-input big-input",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.Optionmargin},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"Optionmargin",e.target.value)}}})])])]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("table",{staticClass:"plugin-table"},[t._m(0),t._v(" "),t._l(t.pluginAttrData.attr.data.options,(function(e,n){return a("tr",[a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].name,expression:"pluginAttrData.attr.data.options[index].name"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[n].name},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[n],"name",e.target.value)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].value,expression:"pluginAttrData.attr.data.options[index].value"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[n].value},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[n],"value",e.target.value)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[n].default,expression:"pluginAttrData.attr.data.options[index].default"}],attrs:{type:"checkbox","true-value":1,"false-value":0},domProps:{checked:Array.isArray(t.pluginAttrData.attr.data.options[n].default)?t._i(t.pluginAttrData.attr.data.options[n].default,null)>-1:t._q(t.pluginAttrData.attr.data.options[n].default,1)},on:{change:[function(e){var a=t.pluginAttrData.attr.data.options[n].default,i=e.target,r=i.checked?1:0;if(Array.isArray(a)){var s=null,o=t._i(a,s);i.checked?o<0&&t.$set(t.pluginAttrData.attr.data.options[n],"default",a.concat([s])):o>-1&&t.$set(t.pluginAttrData.attr.data.options[n],"default",a.slice(0,o).concat(a.slice(o+1)))}else t.$set(t.pluginAttrData.attr.data.options[n],"default",r)},function(e){return t.selectdef(e,n)}]}})]),t._v(" "),a("td",{staticClass:"opera"},[a("i",{staticClass:"fa fa-arrow-circle-o-up",on:{click:function(e){return t.upRecord(t.pluginAttrData.attr.data.options,n)}}}),t._v(" "),a("i",{staticClass:"fa fa-arrow-circle-o-down",on:{click:function(e){return t.downRecord(t.pluginAttrData.attr.data.options,n)}}}),t._v(" "),a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.delselectone(n)}}})])])}))],2),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:t.addselect}},[t._v("新增")]),a("el-button",{attrs:{size:"mini"},on:{click:t.delselect}},[t._v("全删")])],1),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("最多选择")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.max,expression:"pluginAttrData.attr.data.max"}],attrs:{type:"number",name:"",index:"max"},domProps:{value:t.pluginAttrData.attr.data.max},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"max",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("最少选择")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.min,expression:"pluginAttrData.attr.data.min"}],attrs:{type:"number",name:"",index:"min"},domProps:{value:t.pluginAttrData.attr.data.min},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"min",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("布局：")]),t._v(" "),a("div",{staticClass:"select_default dCalendarAttr"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.block,expression:"pluginAttrData.attr.data.block"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"block",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{attrs:{value:"0"}},[t._v("横向")]),t._v(" "),a("option",{attrs:{value:"1"}},[t._v("纵向")])])])])])])},mt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",[t._v("文字")]),t._v(" "),a("th",[t._v("赋值")]),t._v(" "),a("th",[t._v("默认")]),t._v(" "),a("th",[t._v("操作")])])}],vt={name:"dCheckboxattr",data:function(){return{}},props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},selectdef:function(t,e){var a=[];this.pluginAttrData.attr.data.options.forEach((function(t){t.default&&a.push({value:t.value,name:t.name})})),this.pluginAttrData.data=a,this.dataChange()},addselect:function(){var t=this.pluginAttrData.attr.data.options.length+1;this.pluginAttrData.attr.data.options.push({name:"选项"+t,value:t+"",default:0}),this.dataChange()},delselect:function(){this.pluginAttrData.attr.data.options=[],this.dataChange()},delselectone:function(t){this.pluginAttrData.attr.data.options.splice(t,1),this.dataChange()},upRecord:function(t,e){0!=e&&this.swapItems(t,e,e-1)},downRecord:function(t,e){e!=t.length-1&&this.swapItems(t,e,e+1)},swapItems:function(t,e,a){return t[e]=t.splice(a,1,t[e])[0],this.dataChange(),t},chooseNum:function(t){"max"==t.target.getAttribute("index")&&(this.pluginAttrData.attr.data.max=parseInt(t.target.value)),this.dataChange()}}},bt=vt,yt=Object(m["a"])(bt,ft,mt,!1,null,null,null),_t=yt.exports,Dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("点击是否放大图片：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n        是\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.enlargeImage,expression:"pluginAttrData.attr.data.enlargeImage"}],attrs:{type:"radio",name:"enlargeImage",id:""},domProps:{value:1,checked:t._q(t.pluginAttrData.attr.data.enlargeImage,1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"enlargeImage",1)},t.dataChange]}}),t._v("\n          \n        否\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.enlargeImage,expression:"pluginAttrData.attr.data.enlargeImage"}],attrs:{type:"radio",name:"enlargeImage",id:""},domProps:{value:0,checked:t._q(t.pluginAttrData.attr.data.enlargeImage,0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"enlargeImage",0)},t.dataChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文件名称：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.name,expression:"pluginAttrData.attr.data.name"}],staticClass:"ctrl-item-input dimageattr",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.name},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"name",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item updateimg"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("上传文件：")]),t._v(" "),a("label",{attrs:{for:t.pluginAttrData.key}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){return e.stopPropagation(),t.clickupdate(e)}}},[t._v("上传图片")]),t._v(" "),a("input",{attrs:{type:"file",id:t.pluginAttrData.key},on:{change:t.updateimage}})],1)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("图片宽度：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.width,expression:"pluginAttrData.attr.data.width"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.width},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"width",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("高度：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.height,expression:"pluginAttrData.attr.data.height"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.height},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"height",e.target.value)}}})])])])]):t._e()},Ct=[],wt=(a("6ae3"),{name:"doneinputattr",props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},updateimage:function(t){var e=t.currentTarget,a=this,n=e.files[0].name.lastIndexOf("."),i=e.files[0].name.substring(n).toLowerCase();if(".png"==i||".jpg"==i||".jpeg"==i||".gif"==i||".svg"==i){var r=R["a"].getApi("uploadindex")+"?category=image";if(void 0!=e.files[0]){var s=new FormData;s.append("upfile",e.files[0]);var o=new XMLHttpRequest;o.open("post",r),o.onload=function(t){var n=JSON.parse(t.currentTarget.response);if("SUCCESS"==n.state){var i=JSON.parse(window.sessionStorage.officeDb_getSiteConfig).imghost;a.pluginAttrData.attr.data.name=e.files[0].name,a.pluginAttrData.data=i+"/"+n.url,a.dataChange(),$(e).val("")}else a.$message.info({message:"上传失败，请稍后重试！"}),$(e).val("")},o.onerror=function(t){a.$message.info({message:"上传失败，请稍后重试！"})},o.send(s)}}else a.$message.info({message:"仅支持png,jpg,jpeg,gif,svg格式的文件！"})},clickupdate:function(t){$("#"+this.pluginAttrData.key).click()}},mounted:function(){this.dataChange()}}),xt=wt,kt=Object(m["a"])(xt,Dt,Ct,!1,null,null,null),St=kt.exports,At=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入框样式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.styleType,expression:"pluginAttrData.attr.data.styleType"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"styleType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:void 0}},[t._v("请选择")]),t._v(" "),t._l(t.styleTypes,(function(e,n){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}))],2)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文字上限：")]),t._v(" "),a("div",{staticClass:"formline vertical-align"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.wordlimit,expression:"pluginAttrData.attr.data.wordlimit"}],staticClass:"ctrl-item-input float-left",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.wordlimit},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"wordlimit",e.target.value)}}}),t._v(" "),a("span",{staticClass:"formtitle position-absolute"},[t._v("个字符")])])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("信息类型：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",size:"mini"},on:{change:function(e){return t.dataChange("信息类型")}},model:{value:t.pluginAttrData.attr.data.userType,callback:function(e){t.$set(t.pluginAttrData.attr.data,"userType",e)},expression:"pluginAttrData.attr.data.userType"}},t._l(t.infoClass,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("信息来源：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",size:"mini"},on:{change:function(e){return t.dataChange("信息来源")}},model:{value:t.selectorsValue,callback:function(e){t.selectorsValue=e},expression:"selectorsValue"}},t._l(t.infoFrom,(function(t,e,n){return a("el-option",{key:n,attrs:{label:t.name,value:t.relation+t.id}})})),1)],1)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[t._m(0),t._v(" "),a("div",{staticClass:"formline no-border"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.ischange,expression:"pluginAttrData.attr.data.ischange"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"ischange",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.data.change,(function(e,n){return a("option",{domProps:{value:e}},[t._v(t._s(e))])})),0)])])])]):t._e()},Et=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"formtitle"},[t._v("允许修改："),a("span",{staticClass:"redColor"},[t._v("（即将弃用）")])])}],Tt=(a("4194"),a("ecb4"),a("f7f9")),It={name:"dUserattr",props:["sendmessage","pluginAttrData"],data:function(){return{infoFrom:[],selectorsValue:"",infoClass:[],styleTypes:[{name:"输入框",value:0},{name:"下划线",value:1}]}},created:function(){this.getRelation(),this.getColumnList(),this.setSelectors()},methods:{dataChange:function(t){var e=this;"信息来源"==t&&(this.selectorsValue?this.pluginAttrData.attr.data.selectors=this.infoFrom.find((function(t){return t.relation+t.id==e.selectorsValue})):this.pluginAttrData.attr.data.selectors=""),this.pluginAttrData.attr.data.express=this.pluginAttrData.attr.data.selectors.relation+"."+this.pluginAttrData.attr.data.selectors.id+"."+this.pluginAttrData.attr.data.userType,this.pluginAttrData.attr.data.name=this.pluginAttrData.attr.data.selectors.name+"."+this.infoClass[this.pluginAttrData.attr.data.userType],this.pluginAttrData.attr.data.name.indexOf("undefined")>-1&&(this.pluginAttrData.attr.data.name=""),this.$emit("sendmessage",this.pluginAttrData)},getRelation:function(){var t=this;this.appFetch({url:"getRelation",method:"get",data:{relation:"all"}},(function(e){0==e.e?t.infoFrom=e.d:console.error("人员信息控件获取信息来源失败")}),(function(t){console.error("人员信息控件获取信息来源失败")}))},getColumnList:function(){var t=this;this.appFetch({url:"getBindColumn",method:"GET"},(function(e){0==e.e?t.infoClass=e.d["userinfo"]["fields"]:console.error("人员信息控件获取字段列表失败")}),(function(){console.error("人员信息控件获取字段列表失败")}))},setSelectors:function(){"object"==Object(Tt["a"])(this.pluginAttrData.attr.data.selectors)&&(this.selectorsValue=this.pluginAttrData.attr.data.selectors.relation+this.pluginAttrData.attr.data.selectors.id)}},watch:{pluginAttrData:function(t){this.setSelectors()}}},Pt=It,Nt=Object(m["a"])(Pt,At,Et,!1,null,null,null),Rt=Nt.exports,Bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否多选：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.multiple,expression:"pluginAttrData.attr.data.multiple"}],attrs:{type:"radio",name:"countryMultiple"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.multiple,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"multiple",!0)},t.dataChange]}}),t._v("\n            \n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.multiple,expression:"pluginAttrData.attr.data.multiple"}],attrs:{type:"radio",name:"countryMultiple"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.multiple,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"multiple",!1)},t.dataChange]}})])])])]):t._e()},Ot=[],Mt={name:"dCheckboxattr",data:function(){return{}},props:["sendmessage","pluginAttrData","pluginData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}}},Lt=Mt,Ut=Object(m["a"])(Lt,Bt,Ot,!1,null,null,null),Ft=Ut.exports,$t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("显示审批时间")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n\t\t\t\t\t显示 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.showdate,expression:"pluginAttrData.attr.data.showdate"}],attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.showdate,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"showdate",!0)},t.dataChange]}}),t._v("\n\t\t\t\t\t  \n\t\t\t\t\t隐藏 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.showdate,expression:"pluginAttrData.attr.data.showdate"}],attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.showdate,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"showdate",!1)},t.dataChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("布局方向：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.layouttype,expression:"pluginAttrData.attr.data.layouttype"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"layouttype",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{attrs:{value:"inherit"}},[t._v("自适应")]),t._v(" "),a("option",{attrs:{value:"nowrap"}},[t._v("横向")]),t._v(" "),a("option",{attrs:{value:"initial"}},[t._v("纵向")])])])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文字设置：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[0].name,expression:"pluginAttrData.attr.data.options[0].name"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[0].name},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[0],"name",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.options[1].name,expression:"pluginAttrData.attr.data.options[1].name"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.options[1].name},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.options[1],"name",e.target.value)}}})])])])]):t._e()},Ht=[],jt={name:"dOpinionattr",props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}}},Wt=jt,zt=Object(m["a"])(Wt,$t,Ht,!1,null,null,null),Vt=zt.exports,qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeholder,expression:"pluginAttrData.attr.data.placeholder"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.placeholder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeholder",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("日期格式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.datetype,expression:"pluginAttrData.attr.data.datetype"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"datetype",e.target.multiple?a:a[0])},t.changedatetype]}},t._l(t.pluginAttrData.attr.data.type,(function(e,n){return a("option",{domProps:{value:n}},[t._v(t._s(e))])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("时间格式：")]),t._v(" "),a("div",{staticClass:"select_default dCalendarAttr"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.dateformat,expression:"pluginAttrData.attr.data.dateformat"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"dateformat",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.data[t.pluginAttrData.attr.data.datetype+"options"],(function(e){return a("option",{domProps:{value:e}},[t._v("\n\t\t\t\t\t\t"+t._s("MM dd, yyyy"==e?e+"（英文）":e)+"\n\t\t\t\t\t")])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("显示语言：")]),t._v(" "),a("div",{staticClass:"select_default dCalendarAttr"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.languageType,expression:"pluginAttrData.attr.data.languageType"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"languageType",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.language,(function(e,n){return a("option",{domProps:{value:n}},[t._v(t._s(e))])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认值：")]),t._v(" "),a("div",{staticClass:"select_default dCalendarAttr"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.defaulttime,expression:"pluginAttrData.attr.data.defaulttime"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"defaulttime",e.target.multiple?a:a[0])},t.setDefaulttime]}},[a("option",{attrs:{value:"notime"}},[t._v("空")]),t._v(" "),a("option",{attrs:{value:"thistime"}},[t._v("当前时间")]),t._v(" "),a("option",{attrs:{value:"cyclictime"}},[t._v("循环时间")]),t._v(" "),a("option",{attrs:{value:"delayedtime"}},[t._v("延后时间")])])])])]),t._v(" "),t._e(),t._v(" "),"cyclictime"==t.pluginAttrData.attr.data.defaulttime?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("年：")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"50px"}},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.cyclictimeY,expression:"pluginAttrData.attr.data.cyclictimeY",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.cyclictimeY},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"cyclictimeY",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("月：")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"50px"}},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.cyclictimeM,expression:"pluginAttrData.attr.data.cyclictimeM",modifiers:{trim:!0}}],attrs:{disabled:"year"==t.pluginAttrData.attr.data.datetype,type:"text"},domProps:{value:t.pluginAttrData.attr.data.cyclictimeM},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"cyclictimeM",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("日：")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"50px"}},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.cyclictimeD,expression:"pluginAttrData.attr.data.cyclictimeD",modifiers:{trim:!0}}],attrs:{disabled:"month"==t.pluginAttrData.attr.data.datetype||"year"==t.pluginAttrData.attr.data.datetype,type:"text"},domProps:{value:t.pluginAttrData.attr.data.cyclictimeD},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"cyclictimeD",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])])]),t._v(" "),t._m(0)]:t._e(),t._v(" "),"delayedtime"==t.pluginAttrData.attr.data.defaulttime?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("当前时间 +")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.delayedtimeDays,expression:"pluginAttrData.attr.data.delayedtimeDays"}],attrs:{type:"text",placeholder:"输入天数"},domProps:{value:t.pluginAttrData.attr.data.delayedtimeDays},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"delayedtimeDays",e.target.value)},function(e){return t.handleNumber("delayedtimeDays")}],change:t.dataChange}})])])]):t._e(),t._v(" "),t._m(1),t._v(" "),a("li",{staticClass:"plugin-item",staticStyle:{"padding-left":"10px"}},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("当前控件类型：")]),t._v(" "),a("div",{staticClass:"select_default dCalendarAttr"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.thistimeType,expression:"pluginAttrData.attr.data.thistimeType"}],attrs:{disabled:!!t.pluginAttrData.attr.data.thistimeBind&&t.pluginAttrData.attr.data.isthistimeBind},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"thistimeType",e.target.multiple?a:a[0])},t.changePlugin]}},[a("option",{attrs:{value:""}},[t._v("空")]),t._v(" "),a("option",{attrs:{value:"start"}},[t._v("开始时间")]),t._v(" "),a("option",{attrs:{value:"end"}},[t._v("结束时间")])])])])]),t._v(" "),a("li",{staticClass:"plugin-item",staticStyle:{"padding-left":"10px"}},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("关联时间控件：")]),t._v(" "),a("div",{staticClass:"select_default dCalendarAttr"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.thistimeBind,expression:"pluginAttrData.attr.data.thistimeBind"}],attrs:{disabled:!!t.pluginAttrData.attr.data.thistimeBind&&t.pluginAttrData.attr.data.isthistimeBind},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"thistimeBind",e.target.multiple?a:a[0])},t.changePlugin]}},[a("option",{attrs:{value:""}},[t._v("空")]),t._v(" "),t._l(t.pluginData,(function(e,n){return"Calendar"==e.columnType&&e.key!=t.pluginAttrData.key?a("option",{domProps:{value:e.key}},[t._v(t._s(e.description||e.key))]):t._e()}))],2)])])]),t._v(" "),a("li",{staticClass:"plugin-item",staticStyle:{"padding-left":"10px"}},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("可选天数:")]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("最小天数：")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"40px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.thistimeMin,expression:"pluginAttrData.attr.data.thistimeMin"}],attrs:{type:"text",disabled:"start"==t.pluginAttrData.attr.data.thistimeType},domProps:{value:t.pluginAttrData.attr.data.thistimeMin},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"thistimeMin",e.target.value)},function(e){return t.handleNumber("thistimeMin")}],change:t.changePlugin}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("最大天数：")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"40px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.thistimeMax,expression:"pluginAttrData.attr.data.thistimeMax"}],attrs:{type:"text",disabled:"start"==t.pluginAttrData.attr.data.thistimeType},domProps:{value:t.pluginAttrData.attr.data.thistimeMax},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"thistimeMax",e.target.value)},function(e){return t.handleNumber("thistimeMax")}],change:t.changePlugin}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("可选日期范围:")]),t._v(" "),a("div",{staticClass:"select_default dCalendarAttr"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.disableType,expression:"pluginAttrData.attr.data.disableType"}],attrs:{name:"fontFamily",disabled:"end"==t.pluginAttrData.attr.data.thistimeType},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"disableType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:null}},[t._v("空")]),t._v(" "),a("option",{attrs:{value:"absolute"}},[t._v("绝对时间")]),t._v(" "),a("option",{attrs:{value:"relative"}},[t._v("相对时间")])])])])]),t._v(" "),a("li",{staticClass:"plugin-item",staticStyle:{"padding-left":"10px"}},["relative"==t.pluginAttrData.attr.data.disableType?a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("申请时间前")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"40px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.beforeDays,expression:"pluginAttrData.attr.data.beforeDays"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.beforeDays},on:{change:t.changePlugin,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"beforeDays",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("天，申请时间后")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"40px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.laterDays,expression:"pluginAttrData.attr.data.laterDays"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.laterDays},on:{change:t.changePlugin,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"laterDays",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("天")])]):"absolute"==t.pluginAttrData.attr.data.disableType?a("div",{staticClass:"formitem"},[a("div",[a("el-date-picker",{staticStyle:{width:"145px"},attrs:{size:"mini",placeholder:"开始日期时间"},on:{change:t.changePlugin},model:{value:t.pluginAttrData.attr.data.beforeTime,callback:function(e){t.$set(t.pluginAttrData.attr.data,"beforeTime",e)},expression:"pluginAttrData.attr.data.beforeTime"}}),t._v(" "),a("el-date-picker",{staticStyle:{width:"145px"},attrs:{size:"mini",placeholder:"结束日期时间"},on:{change:t.changePlugin},model:{value:t.pluginAttrData.attr.data.laterTime,callback:function(e){t.$set(t.pluginAttrData.attr.data,"laterTime",e)},expression:"pluginAttrData.attr.data.laterTime"}})],1)]):t._e()]),t._v(" "),"notime"==t.pluginAttrData.attr.data.defaulttime&&1==t.pluginAttrData.attr.data.editappro?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[t._m(2),t._v(" "),a("div",{staticClass:"formline formline_small"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.datarange[0],expression:"pluginAttrData.attr.data.datarange[0]"}],attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.datarange[0]},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.datarange,0,e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("天至第")]),t._v(" "),a("div",{staticClass:"formline formline_small"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.datarange[1],expression:"pluginAttrData.attr.data.datarange[1]"}],attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.datarange[1]},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data.datarange,1,e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("天")])])]):t._e()],2):t._e()},Gt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("填写规则：")]),t._v(" "),a("div",{staticStyle:{"font-size":"12px"}},[a("p",[t._v("{0}：当前， {1}：当前+1， {2}：当前+2， {-1}：当前-1")]),t._v(" "),a("p",[t._v("示例：")]),t._v(" "),a("p",[t._v("每年5月12日：年：{0}    月：5    日：12")]),t._v(" "),a("p",[t._v("明年每月9号：年：{1}    月：{0}    日：9")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formitem"},[t._v("开始结束时间规则设置：")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"formtitle"},[t._v("选择范围"),a("span",{staticClass:"redColor"},[t._v("(即将弃用)")]),t._v("：今天起第")])}],Kt={name:"dCalendarAttr",data:function(){return{thistimeBind:"",language:{"zh-CN":"中文",en:"英文"}}},props:["sendmessage","pluginAttrData","pluginData"],mounted:function(){this.thistimeBind=this.pluginAttrData.attr.data.thistimeBind,"end"==this.pluginAttrData.attr.data.thistimeType&&(this.pluginAttrData.attr.data.disableType=null)},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData),"end"==this.pluginAttrData.attr.data.thistimeType&&(this.pluginAttrData.attr.data.disableType=null)},changedatetype:function(){this.pluginAttrData.attr.data.dateformat=this.pluginAttrData.attr.data[this.pluginAttrData.attr.data.datetype+"options"][0],this.pluginAttrData.data=null,this.dataChange()},changePlugin:function(){var t=this.pluginAttrData.attr.data,e=t.thistimeType,a=t.thistimeBind;if(e&&a&&this.pluginData[a]){var n=JSON.parse(JSON.stringify(this.pluginData[a]));n.attr.data.thistimeType="start"==e?"end":"start",n.attr.data.thistimeBind=this.pluginAttrData.key,n.attr.data.thistimeMin=this.pluginAttrData.attr.data.thistimeMin,n.attr.data.thistimeMax=this.pluginAttrData.attr.data.thistimeMax,n.attr.data.isthistimeBind||this.pluginAttrData.attr.data.isthistimeBind||(n.attr.data.isthistimeBind=!0),"end"==n.attr.data.thistimeType&&(n.attr.data.disableType=null),this.$emit("sendmessage",n)}if(this.thistimeBind&&this.thistimeBind!=a){var i=JSON.parse(JSON.stringify(this.pluginData[this.thistimeBind]));i.attr.data.thistimeType="",i.attr.data.thistimeBind="",i.attr.data.thistimeMin="",i.attr.data.thistimeMax="",i.attr.data.isthistimeBind=!1,this.$emit("sendmessage",i)}this.thistimeBind=a,this.dataChange()},handleNumber:function(t){var e=/^\+?[1-9][0-9]*$/;e.test(this.pluginAttrData.attr.data[t])||(this.pluginAttrData.attr.data[t]="")},setDefaulttime:function(){this.dataChange()}}},Xt=Kt,Yt=Object(m["a"])(Xt,qt,Gt,!1,null,null,null),Jt=Yt.exports,Zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd dinput-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否显示校外人员：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.setStaff,expression:"pluginAttrData.attr.data.setStaff"}],staticStyle:{height:"auto"},attrs:{type:"radio",name:"setStaff"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.setStaff,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"setStaff",!0)},t.dataChange]}}),t._v("\n            \n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.setStaff,expression:"pluginAttrData.attr.data.setStaff"}],staticStyle:{height:"auto"},attrs:{type:"radio",name:"setStaff"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.setStaff,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"setStaff",!1)},t.dataChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("div",{staticClass:"formtitle"},[t._v("下拉列表内容：")]),t._v(" "),a("div",{staticClass:"formradio rangeBox"},[a("el-radio",{attrs:{label:"1"},on:{change:t.rangeChange},model:{value:t.pluginAttrData.attr.data.selectShow,callback:function(e){t.$set(t.pluginAttrData.attr.data,"selectShow",e)},expression:"pluginAttrData.attr.data.selectShow"}},[t._v("姓名+部门")]),a("br"),t._v(" "),a("el-radio",{attrs:{label:"2"},on:{change:t.rangeChange},model:{value:t.pluginAttrData.attr.data.selectShow,callback:function(e){t.$set(t.pluginAttrData.attr.data,"selectShow",e)},expression:"pluginAttrData.attr.data.selectShow"}},[t._v("姓名+工号")]),a("br"),t._v(" "),a("el-radio",{attrs:{label:"3"},on:{change:t.rangeChange},model:{value:t.pluginAttrData.attr.data.selectShow,callback:function(e){t.$set(t.pluginAttrData.attr.data,"selectShow",e)},expression:"pluginAttrData.attr.data.selectShow"}},[t._v("姓名+工号+部门")]),a("br"),t._v(" "),a("el-radio",{attrs:{label:"4"},on:{change:t.rangeChange},model:{value:t.pluginAttrData.attr.data.selectShow,callback:function(e){t.$set(t.pluginAttrData.attr.data,"selectShow",e)},expression:"pluginAttrData.attr.data.selectShow"}},[t._v("姓名+部门+邮箱")])],1)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("div",{staticClass:"formtitle"},[t._v("选中后显示的内容：")]),t._v(" "),a("div",{staticClass:"formradio rangeBox"},[a("el-checkbox",{attrs:{label:"name"},model:{value:t.pluginAttrData.attr.data.readShow,callback:function(e){t.$set(t.pluginAttrData.attr.data,"readShow",e)},expression:"pluginAttrData.attr.data.readShow"}},[t._v("姓名")]),t._v(" "),a("el-checkbox",{attrs:{label:"number"},model:{value:t.pluginAttrData.attr.data.readShow,callback:function(e){t.$set(t.pluginAttrData.attr.data,"readShow",e)},expression:"pluginAttrData.attr.data.readShow"}},[t._v("工号")]),t._v(" "),a("el-checkbox",{attrs:{label:"college"},model:{value:t.pluginAttrData.attr.data.readShow,callback:function(e){t.$set(t.pluginAttrData.attr.data,"readShow",e)},expression:"pluginAttrData.attr.data.readShow"}},[t._v("部门")]),t._v(" "),a("el-checkbox",{attrs:{label:"email"},model:{value:t.pluginAttrData.attr.data.readShow,callback:function(e){t.$set(t.pluginAttrData.attr.data,"readShow",e)},expression:"pluginAttrData.attr.data.readShow"}},[t._v("邮箱")])],1)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("范围维度：")]),t._v(" "),a("div",{staticClass:"formradio rangeBox"},[a("el-checkbox-group",{on:{change:t.rangeChange},model:{value:t.pluginAttrData.attr.data.sRangeTypes,callback:function(e){t.$set(t.pluginAttrData.attr.data,"sRangeTypes",e)},expression:"pluginAttrData.attr.data.sRangeTypes"}},t._l(t.rangeTypes,(function(e,n){return a("el-checkbox",{key:n,attrs:{label:n}},[t._v("\n\t\t\t\t\t    \t"+t._s(e)+"\n\t\t\t\t\t    ")])})),1)],1)])]),t._v(" "),t._l(t.pluginAttrData.attr.data.sRangeTypes,(function(e){return"relation"!=e?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v(t._s(t.rangeTypes[e])+"范围：")]),t._v(" "),a("div",{staticClass:"select_default selectedranges"},[t._l(t.pluginAttrData.attr.data[e],(function(e){return a("span",[t._v(t._s(e.name))])})),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-setting",circle:""},on:{click:function(a){return t.selectRange(e)}}})],2)])]):t._e()})),t._v(" "),t.pluginAttrData.attr.data.sRangeTypes.includes("relation")?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("变量范围：")]),t._v(" "),a("div",{staticClass:"select_default rangeselect"},[a("el-select",{attrs:{size:"mini",multiple:!0,placeholder:"请选择"},model:{value:t.pluginAttrData.attr.data.relation,callback:function(e){t.$set(t.pluginAttrData.attr.data,"relation",e)},expression:"pluginAttrData.attr.data.relation"}},t._l(t.relations,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t.key}})})),1)],1)])]):t._e(),t._v(" "),t.nowRangeType?a("newpop",{attrs:{showConf:t.showConf,settype:t.settype,hasChooseList:t.nowSelect},on:{getBackData:t.selectRangeed}}):t._e()],2):t._e()},Qt=[],te=(a("b4fb"),a("97d6")),ee={name:"dUserSearchattr",props:["sendmessage","pluginAttrData"],data:function(){return{rangeTypes:{depart_ids:"部门",job_id:"岗位",tag_id:"标签",uids:"用户",relation:"变量"},relations:[{name:"无",key:""}],nowRangeType:"",nowSelect:[],showConf:{},deFaultshowConf:{showStruct:!0,showDepart:!0,showJob:!0,showTag:!0,showPerson:!0,mode:""},settype:"all"}},components:{newpop:te["g"]},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},rangeChange:function(){for(var t in console.log(this.rangeTypes,"this.rangeTypes"),console.log(this.pluginAttrData,"pluginAttrData"),this.rangeTypes)this.pluginAttrData.attr.data.sRangeTypes.includes(t)||(this.pluginAttrData.attr.data[t]=[])},selectRange:function(t){switch(this.settype="all",t){case"depart_ids":this.showConf=Object(o["a"])(Object(o["a"])({},this.deFaultshowConf),{showDepart:!0});break;case"job_id":this.showConf=Object(o["a"])(Object(o["a"])({},this.deFaultshowConf),{showJob:!0});break;case"tag_id":this.showConf=Object(o["a"])(Object(o["a"])({},this.deFaultshowConf),{showTag:!0});break;case"uids":this.settype="users",this.showConf=Object(o["a"])(Object(o["a"])({},this.deFaultshowConf),{showPerson:!0});break}this.nowSelect=this.pluginAttrData.attr.data[t],this.nowRangeType=t},getRelation:function(){var t=this;this.appFetch({url:"searchUserRelation",method:"GET"},(function(e){if(0==e.e){var a=[];e.d.forEach((function(t){a.push({name:t.name,key:t.relation+"."+t.id})})),t.relations=t.relations.concat(a)}else t.$message.error({message:e.m,showClose:!0})}),(function(e){t.$message.error({message:"获取关系失败！",showClose:!0})}))},selectRangeed:function(t){if(t){var e=[];t.forEach((function(t){e.push({id:t.id,name:t.name})})),this.pluginAttrData.attr.data[this.nowRangeType]=e}this.nowRangeType=""}},mounted:function(){this.getRelation()}},ae=ee,ne=(a("0d91"),Object(m["a"])(ae,Zt,Qt,!1,null,null,null)),ie=ne.exports,re=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd dinput-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("数据来源")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n                    本地编辑 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.dataSource,expression:"pluginAttrData.attr.data.dataSource"}],attrs:{type:"radio"},domProps:{value:0,checked:t._q(t.pluginAttrData.attr.data.dataSource,0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"dataSource",0)},t.dataChange]}}),t._v("\n                      \n                    数据源 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.dataSource,expression:"pluginAttrData.attr.data.dataSource"}],attrs:{type:"radio"},domProps:{value:1,checked:t._q(t.pluginAttrData.attr.data.dataSource,1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"dataSource",1)},t.dataChange]}})])])]),t._v(" "),t.pluginAttrData.attr.data.dataSource?t._e():[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("链接类型")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n                        指定地址 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.type,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"type",!0)},t.dataChange]}}),t._v("\n                          \n                        上传附件 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.type,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"type",!1)},t.dataChange]}})])])]),t._v(" "),t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文字：")]),t._v(" "),a("div",{staticClass:"formline vertical-align"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.text,expression:"pluginAttrData.attr.data.text"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.text},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"text",e.target.value)}}})])])]):t._e(),t._v(" "),t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("地址：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.href,expression:"pluginAttrData.attr.data.href"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.href},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"href",e.target.value)}}})])])]):t._e(),t._v(" "),t.pluginAttrData.attr.data.type?t._e():a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文件名称：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.text,expression:"pluginAttrData.attr.data.text"}],staticClass:"ctrl-item-input dimageattr",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.text},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"text",e.target.value)}}})])])]),t._v(" "),t.pluginAttrData.attr.data.type?t._e():a("li",{staticClass:"plugin-item updateimg"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("上传附件：")]),t._v(" "),a("label",{attrs:{for:t.pluginAttrData.key}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){return e.stopPropagation(),t.clickupdate(e)}}},[t._v("上传附件")]),t._v(" "),a("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"file",id:t.pluginAttrData.key},on:{change:t.updateimage}})],1)])])]],2):t._e()},se=[],oe={name:"dUserattr",props:["sendmessage","pluginAttrData"],data:function(){return{}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},updateimage:function(t){var e=t.currentTarget,a=this,n=R["a"].getApi("uploadindex")+"?category=all";if(void 0!=e.files[0]){var i=new FormData;i.append("upfile",e.files[0]);var r=new XMLHttpRequest;r.open("post",n),r.onload=function(t){var n=JSON.parse(t.currentTarget.response);"SUCCESS"==n.state?(a.pluginAttrData.attr.data.text=e.files[0].name,a.pluginAttrData.attr.data.href=a.appConfig.upFileUrl+n.url,a.dataChange(),$(e).val("")):(a.$message.info({message:"上传失败，请稍后重试！"}),$(e).val(""))},r.onerror=function(t){a.$message.info({message:"上传失败，请稍后重试！"})},r.send(i)}},clickupdate:function(t){$("#"+this.pluginAttrData.key).click()}}},le=oe,ue=Object(m["a"])(le,re,se,!1,null,null,null),de=ue.exports,ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"selfattrbox dselect-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("按钮文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.buttontext,expression:"pluginAttrData.attr.data.buttontext"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.buttontext},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"buttontext",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("上传文件容量：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.MBlimit,expression:"pluginAttrData.attr.data.MBlimit"}],attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.MBlimit},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"MBlimit",e.target.value)}}})]),t._v(" MB\n\t\t\t")])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("word文档支持预览")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n\t\t\t\t\t是 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isHasPreview,expression:"pluginAttrData.attr.data.isHasPreview"}],attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.isHasPreview,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isHasPreview",!0)},t.dataChange]}}),t._v("\n\t\t\t\t\t  \n\t\t\t\t\t否 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isHasPreview,expression:"pluginAttrData.attr.data.isHasPreview"}],attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.isHasPreview,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isHasPreview",!1)},t.dataChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("图片支持预览")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n\t\t\t\t\t是 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isPhotoPreview,expression:"pluginAttrData.attr.data.isPhotoPreview"}],attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.isPhotoPreview,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isPhotoPreview",!0)},t.dataChange]}}),t._v("\n\t\t\t\t\t  \n\t\t\t\t\t否 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isPhotoPreview,expression:"pluginAttrData.attr.data.isPhotoPreview"}],attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.isPhotoPreview,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isPhotoPreview",!1)},t.dataChange]}})])])]),t._v(" "),void 0!=t.pluginAttrData.attr.data.islimit?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("限制文件类型")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n\t\t\t\t\t限制 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.islimit,expression:"pluginAttrData.attr.data.islimit"}],attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.islimit,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"islimit",!0)},t.dataChange]}}),t._v("\n\t\t\t\t\t  \n\t\t\t\t\t不限 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.islimit,expression:"pluginAttrData.attr.data.islimit"}],attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.islimit,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"islimit",!1)},t.dataChange]}})])])]):t._e(),t._v(" "),void 0!=t.pluginAttrData.attr.data.islimit&&t.pluginAttrData.attr.data.islimit?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选择允许上传的文件类型：")]),t._v(" "),t._l(t.pluginAttrData.attr.data.limitALL,(function(e,n){return a("label",{staticClass:"fileTypeList",attrs:{for:""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.Haslimit,expression:"pluginAttrData.attr.data.Haslimit"}],attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.pluginAttrData.attr.data.Haslimit)?t._i(t.pluginAttrData.attr.data.Haslimit,e)>-1:t.pluginAttrData.attr.data.Haslimit},on:{change:[function(a){var n=t.pluginAttrData.attr.data.Haslimit,i=a.target,r=!!i.checked;if(Array.isArray(n)){var s=e,o=t._i(n,s);i.checked?o<0&&t.$set(t.pluginAttrData.attr.data,"Haslimit",n.concat([s])):o>-1&&t.$set(t.pluginAttrData.attr.data,"Haslimit",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.pluginAttrData.attr.data,"Haslimit",r)},t.dataChange]}}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])}))],2)]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("最大上传附件数：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：不设置或者设置为0为不限制）")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.maxNum,expression:"pluginAttrData.attr.data.maxNum",modifiers:{trim:!0}}],attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.maxNum},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"maxNum",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem plugin_file_attr_water"},[a("span",{staticClass:"formtitle"},[t._v("水印设置：")]),t._v(" "),0!=t.pluginAttrData.attr.data.formList.length?[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.water_mark_type,expression:"pluginAttrData.attr.data.water_mark_type"}],attrs:{type:"radio",value:"1"},domProps:{checked:t._q(t.pluginAttrData.attr.data.water_mark_type,"1")},on:{change:function(e){return t.$set(t.pluginAttrData.attr.data,"water_mark_type","1")}}}),t._v(" "),a("span",[t._v("文字水印")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择表单",size:"small"},on:{change:t.changeForm},model:{value:t.pluginAttrData.attr.data.currFormId,callback:function(e){t.$set(t.pluginAttrData.attr.data,"currFormId",e)},expression:"pluginAttrData.attr.data.currFormId"}},[a("el-option",{attrs:{label:"当前表单",value:0}}),t._v(" "),t._l(t.pluginAttrData.attr.data.formList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.form_id}})}))],2)],1),t._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.water_mark_type,expression:"pluginAttrData.attr.data.water_mark_type"}],staticStyle:{opacity:"0"},attrs:{type:"radio",value:"1"},domProps:{checked:t._q(t.pluginAttrData.attr.data.water_mark_type,"1")},on:{change:function(e){return t.$set(t.pluginAttrData.attr.data,"water_mark_type","1")}}}),t._v(" "),a("span",{staticStyle:{opacity:"0"}},[t._v("文字水印")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择组件",size:"small"},model:{value:t.pluginAttrData.attr.data.water_mark_text_key,callback:function(e){t.$set(t.pluginAttrData.attr.data,"water_mark_text_key",e)},expression:"pluginAttrData.attr.data.water_mark_text_key"}},t._l(t.pluginAttrData.attr.data.currPlugins,(function(t,e){return a("el-option",{key:e,attrs:{label:t.description?t.description:t.key,value:t.waterKey?t.waterKey:t.key}})})),1)],1)]:a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.water_mark_type,expression:"pluginAttrData.attr.data.water_mark_type"}],attrs:{type:"radio",value:"1"},domProps:{checked:t._q(t.pluginAttrData.attr.data.water_mark_type,"1")},on:{change:function(e){return t.$set(t.pluginAttrData.attr.data,"water_mark_type","1")}}}),t._v(" "),a("span",[t._v("文字水印")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择组件",size:"small"},model:{value:t.pluginAttrData.attr.data.water_mark_text_key,callback:function(e){t.$set(t.pluginAttrData.attr.data,"water_mark_text_key",e)},expression:"pluginAttrData.attr.data.water_mark_text_key"}},t._l(t.pluginAttrData.attr.data.currPlugins,(function(t,e){return a("el-option",{key:e,attrs:{label:t.description?t.description:t.key,value:t.waterKey?t.waterKey:t.key}})})),1)],1),t._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.water_mark_type,expression:"pluginAttrData.attr.data.water_mark_type"}],attrs:{type:"radio",value:"2"},domProps:{checked:t._q(t.pluginAttrData.attr.data.water_mark_type,"2")},on:{change:function(e){return t.$set(t.pluginAttrData.attr.data,"water_mark_type","2")}}}),t._v(" "),a("span",[t._v("图文水印")]),t._v(" "),a("button",{on:{click:t.upFile}},[t._v("上传图片")]),t._v(" "),a("input",{ref:"upFile",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:t.handleFile}}),t._v(" "),t.pluginAttrData.attr.data.water_mark_image?a("div",{staticClass:"fileImage"},[a("img",{attrs:{src:t.siteConfig.imghost+"/"+t.pluginAttrData.attr.data.water_mark_image,alt:""}})]):t._e()])],2)])])},pe=[],he=(a("2eeb"),a("e9e4")),ge={name:"dFileAttr",data:function(){return{waterTextKey:["Text","MultiText","Input","MultiInput"]}},props:["sendmessage","pluginAttrData","pluginData","formModeData"],mounted:function(){if(this.getFormList(),void 0==this.pluginAttrData.attr.data.maxNum&&(this.pluginAttrData.attr.data.maxNum=0),"0"==this.pluginAttrData.attr.data.currFormId){var t=[];for(var e in this.pluginData)this.waterTextKey.includes(this.pluginData[e].columnType)&&t.push(this.pluginData[e]);this.pluginAttrData.attr.data.currPlugins=t}void 0==this.pluginAttrData.attr.data.isPhotoPreview&&(this.pluginAttrData.attr.data.isPhotoPreview=!0)},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},upFile:function(){this.$refs.upFile.click()},handleFile:function(){var t=this;this.$refs.upFile.files[0]&&Object(he["a"])(this.$refs.upFile.files[0],"image").then((function(e){"SUCCESS"==e.state?t.pluginAttrData.attr.data.water_mark_image=e.url:t.msg=e.state}),(function(t){console.log("req",t)}))},getFormList:function(){var t=this;this.appFetch({url:"vBpmnFormList",method:"get",data:{bpmn_id:this.$route.query.bpmn_id}},(function(e){if(0==e.e)if(-1!=e.d.list.map((function(t){return t.form_id})).indexOf(t.formModeData.id)&&e.d.list.splice(e.d.list.map((function(t){return t.form_id})).indexOf(t.formModeData.id),1),t.pluginAttrData.attr.data.formList=e.d.list,0==t.pluginAttrData.attr.data.formList.length){var a=[];for(var n in t.pluginData)t.waterTextKey.includes(t.pluginData[n].columnType)&&a.push(t.pluginData[n]);t.pluginAttrData.attr.data.currPlugins=a}else t.pluginAttrData.attr.data.currFormId>0&&t.changeForm();else console.error(e.m)}),(function(t){console.error("系统错误")}))},changeForm:function(t){var e=this;if(void 0==t||(this.pluginAttrData.attr.data.water_mark_text_key="",0!=this.pluginAttrData.attr.data.currFormId))this.appFetch({url:"fBpmnCom",method:"get",data:{type:"text",form_version_id:this.pluginAttrData.attr.data.formList.find((function(t){return t.form_id==e.pluginAttrData.attr.data.currFormId})).form_version_id}},(function(t){if(0==t.e){var a=[];for(var n in t.d.components)e.waterTextKey.includes(t.d.components[n].columnType)&&a.push(t.d.components[n]);a.forEach((function(t){t.waterKey="form"+e.pluginAttrData.attr.data.currFormId+"_"+t.key})),e.pluginAttrData.attr.data.currPlugins=a}else console.error(t.m)}),(function(t){console.error("系统错误")}));else{var a=[];for(var n in this.pluginData)this.waterTextKey.includes(this.pluginData[n].columnType)&&a.push(this.pluginData[n]);this.pluginAttrData.attr.data.currPlugins=a}}}},fe=ge,me=(a("6c22"),Object(m["a"])(fe,ce,pe,!1,null,null,null)),ve=me.exports,be=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"selfattrbox dselect-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("类型：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"type",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.data.typeoptions,(function(e,n){return a("option",{domProps:{value:n}},[t._v(t._s(e))])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v(t._s(t.pluginAttrData.attr.data.typeoptions[t.pluginAttrData.attr.data.type])+"权限：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("el-button",{staticClass:"plus_but",staticStyle:{"font-size":"12px"},attrs:{type:"primary",size:"mini",icon:"el-icon-plus",circle:""},on:{click:t.showdeparttree}})],1),t._v(" "),a("div",{staticStyle:{"font-size":"12px","padding-left":"10px"}},[a("div",{staticStyle:{"margin-top":"5px"}},[a("span",[t._v("部门范围：")]),t._v(" "),t._l(t.pluginAttrData.attr.data.departlimit,(function(e,n){return a("span",[t._v(t._s(e.name)+" ")])}))],2),t._v(" "),"oneUser"==t.pluginAttrData.attr.data.type||"multiUser"==t.pluginAttrData.attr.data.type?a("div",{staticStyle:{"margin-top":"5px"}},[a("span",[t._v("标签范围：")]),t._v(" "),t._l(t.pluginAttrData.attr.data.teamLimit,(function(e,n){return a("span",[t._v(t._s(e.name)+" ")])}))],2):t._e()])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("自动展开层级：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.hierarchy,expression:"pluginAttrData.attr.data.hierarchy"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"hierarchy",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.hierarchyList,(function(e,n){return n<=t.departTierMax?a("option",{domProps:{value:n}},[t._v(t._s(e))]):t._e()})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("el-checkbox",{model:{value:t.pluginAttrData.attr.data.showHierarchy,callback:function(e){t.$set(t.pluginAttrData.attr.data,"showHierarchy",e)},expression:"pluginAttrData.attr.data.showHierarchy"}},[t._v("只显示已勾选的层级")])],1)]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否默认带出数据：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.bringOutData,expression:"pluginAttrData.attr.data.bringOutData"}],attrs:{type:"radio",name:"bringOutData"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.bringOutData,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"bringOutData",!0)},t.dataChange]}}),t._v("\n            \n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.bringOutData,expression:"pluginAttrData.attr.data.bringOutData"}],attrs:{type:"radio",name:"bringOutData"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.bringOutData,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"bringOutData",!1)},t.dataChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("提示文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.promptTest,expression:"pluginAttrData.attr.data.promptTest",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.promptTest},on:{input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"promptTest",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])])]),t._v(" "),a("el-dialog",{staticClass:"dDepartAttrdialog",attrs:{title:"选择部门权限",visible:t.dialogVisible,"lock-scroll":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"left"},[a("div",[a("span",{class:{active:"depart"==t.tab},on:{click:function(e){return t.toggle("depart")}}},[t._v("部门")]),t._v(" "),"oneUser"==t.pluginAttrData.attr.data.type||"multiUser"==t.pluginAttrData.attr.data.type?a("span",{class:{active:"team"==t.tab},on:{click:function(e){return t.toggle("team")}}},[t._v("标签")]):t._e()]),t._v(" "),a("div",{staticClass:"left_tree",class:{active:"depart"==t.tab}},["depart"==t.tab?a("el-input",{staticClass:"left_tree_search",attrs:{size:"small",placeholder:"关键词搜索",clearable:""},model:{value:t.filterText,callback:function(e){t.filterText="string"===typeof e?e.trim():e},expression:"filterText"}}):t._e(),t._v(" "),"depart"==t.tab?a("el-tree",{ref:"tree",attrs:{data:t.depart,"default-expanded-keys":[0],props:t.defaultProps,"node-key":"id","expand-on-click-node":!1,"filter-node-method":t.filterNode},on:{"node-click":t.handleNodeClick}}):a("el-tree",{attrs:{data:t.team,props:t.defaultProps,"default-expanded-keys":[0],"node-key":"id","expand-on-click-node":!1},on:{"node-click":t.handleNodeClick}})],1)]),t._v(" "),a("div",{staticClass:"right"},[a("div",[t._v("\n        已选\n        "),a("a",{attrs:{href:"javascript:;"},on:{click:t.handleEmpty}},[t._v("清空")])]),t._v(" "),a("ul",{staticClass:"dDepartAttrdialogright"},["depart"==t.tab?t._l(t.departlimit,(function(e,n){return a("li",{attrs:{title:e.name}},[t._v("\n            "+t._s(e.name)+"\n            "),a("i",{staticClass:"el-icon-close",on:{click:function(e){return t.deldepartlimit(n)}}})])})):t._l(t.teamLimit,(function(e,n){return a("li",{attrs:{title:e.name}},[t._v("\n            "+t._s(e.name)+"\n            "),a("i",{staticClass:"el-icon-close",on:{click:function(e){return t.delTeamLimit(n)}}})])}))],2)]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.chooseDepart}},[t._v("确 定")])],1)])],1)},ye=[],_e=(a("dbb3"),{name:"dDepartAttr",data:function(){return{depart:[],team:[],dialogVisible:!1,defaultProps:{children:"children",label:"name"},departlimit:[],teamLimit:[],bringOutData:!0,tab:"depart",hierarchyList:{1:"一级",2:"二级",3:"三级",4:"四级",5:"五级",6:"六级"},departTier:1,departTierMax:1,filterText:""}},props:["sendmessage","pluginAttrData"],created:function(){var t=this,e=this;e.appFetch({method:"post",url:"allDepartment",data:{}},(function(t){0==t.e&&(e.depart=t.d,e.initShowChangeDepart(e.depart))}),(function(t){e.$message.error({message:t.e})})),this.appFetch({url:"allTeam",method:"get",data:{}},(function(e){0==e.e?t.team=e.d:t.$message({message:e.m,type:"error",showClose:!0})}),(function(e){t.$message({message:"系统错误，请联系管理员",type:"error",showClose:!0})})),void 0==this.pluginAttrData.attr.data.bringOutData&&(this.pluginAttrData.attr.data.bringOutData=!0)},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},showdeparttree:function(){this.filterText="",this.tab="depart",this.defaultProps.children="children",this.dialogVisible=!0,this.departlimit=JSON.parse(JSON.stringify(this.pluginAttrData.attr.data.departlimit)),this.teamLimit=this.pluginAttrData.attr.data.teamLimit?JSON.parse(JSON.stringify(this.pluginAttrData.attr.data.teamLimit)):[]},handleNodeClick:function(t){"depart"==this.tab?this.departlimit.find((function(e){return e.id==t.id}))||this.departlimit.push({name:t.name,id:t.id}):this.teamLimit.find((function(e){return e.id==t.id}))||this.teamLimit.push({name:t.name,id:t.id})},deldepartlimit:function(t){this.departlimit.splice(t,1)},chooseDepart:function(){this.dialogVisible=!1,this.pluginAttrData.attr.data.departlimit=JSON.parse(JSON.stringify(this.departlimit)),this.pluginAttrData.attr.data.teamLimit=JSON.parse(JSON.stringify(this.teamLimit)),this.dataChange()},initShowChangeDepart:function(t){for(var e in t)void 0!=t[e].children?(this.initShowChangeDepart(t[e].children),++this.departTier):(this.departTier>this.departTierMax&&(this.departTierMax=this.departTier),this.departTier=1)},toggle:function(t){var e=this;this.tab=t,"depart"==this.tab?(this.defaultProps.children="children",this.$nextTick((function(){e.$refs.tree.filter(e.filterText)}))):this.defaultProps.children="teams"},handleEmpty:function(){"depart"==this.tab?this.departlimit=[{name:"根部门",id:0}]:this.teamLimit=[]},delTeamLimit:function(t){this.teamLimit.splice(t,1)},filterNode:function(t,e){return!t||-1!=e.name.indexOf(t)}},watch:{filterText:function(t){this.$refs.tree.filter(t)}}}),De=_e,Ce=(a("8b99"),Object(m["a"])(De,be,ye,!1,null,"567d9b89",null)),we=Ce.exports,xe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("设置：")]),t._v(" "),a("div",{staticClass:"formline no-border"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.express,expression:"pluginAttrData.attr.data.express"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"express",e.target.multiple?a:a[0])},t.select]}},[a("option",{attrs:{value:""}},[t._v("无")]),t._v(" "),a("option",{attrs:{value:"creator"}},[t._v("发起者.头像")]),t._v(" "),a("option",{attrs:{value:"assignee"}},[t._v("审批者.头像")])])])])]),t._v(" "),void 0!=t.pluginAttrData.attr.data.smallsize?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文件大小： 最小值")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"20px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.smallsize,expression:"pluginAttrData.attr.data.smallsize"}],staticStyle:{width:"20px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.smallsize},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"smallsize",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("Mb   最大值")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"20px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.size,expression:"pluginAttrData.attr.data.size"}],staticStyle:{width:"20px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.size},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"size",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("Mb")])])]):a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文件大小：")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"20px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.size,expression:"pluginAttrData.attr.data.size"}],staticStyle:{width:"20px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.size},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"size",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("Mb")])])]),t._v(" "),void 0!=t.pluginAttrData.attr.data.islimit?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("限制文件类型")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n\t\t\t\t\t限制 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.islimit,expression:"pluginAttrData.attr.data.islimit"}],attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.islimit,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"islimit",!0)},t.dataChange]}}),t._v("\n\t\t\t\t\t  \n\t\t\t\t\t不限 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.islimit,expression:"pluginAttrData.attr.data.islimit"}],attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.islimit,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"islimit",!1)},t.dataChange]}})])])]):t._e(),t._v(" "),void 0!=t.pluginAttrData.attr.data.islimit&&t.pluginAttrData.attr.data.islimit?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选择允许上传的文件类型：")]),t._v(" "),t._l(t.pluginAttrData.attr.data.limitALL,(function(e,n){return a("label",{staticClass:"fileTypeList",attrs:{for:""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.Haslimit,expression:"pluginAttrData.attr.data.Haslimit"}],attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.pluginAttrData.attr.data.Haslimit)?t._i(t.pluginAttrData.attr.data.Haslimit,e)>-1:t.pluginAttrData.attr.data.Haslimit},on:{change:[function(a){var n=t.pluginAttrData.attr.data.Haslimit,i=a.target,r=!!i.checked;if(Array.isArray(n)){var s=e,o=t._i(n,s);i.checked?o<0&&t.$set(t.pluginAttrData.attr.data,"Haslimit",n.concat([s])):o>-1&&t.$set(t.pluginAttrData.attr.data,"Haslimit",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.pluginAttrData.attr.data,"Haslimit",r)},t.dataChange]}}),t._v("\n\t\t\t        "+t._s(e)+"\n\t\t        ")])}))],2)]):t._e(),t._v(" "),void 0!=t.pluginAttrData.attr.data.showexpress?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否显示文字描述：")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n\t\t\t\t\t显示 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.showexpress,expression:"pluginAttrData.attr.data.showexpress"}],attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.showexpress,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"showexpress",!0)},t.dataChange]}}),t._v("\n\t\t\t\t\t  \n\t\t\t\t\t不显示 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.showexpress,expression:"pluginAttrData.attr.data.showexpress"}],attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.showexpress,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"showexpress",!1)},t.dataChange]}})])])]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("pc端图片宽高： 宽度")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"30px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.width,expression:"pluginAttrData.attr.data.width"}],staticStyle:{width:"30px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.width},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"width",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("px   高度")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"30px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.height,expression:"pluginAttrData.attr.data.height"}],staticStyle:{width:"30px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.height},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"height",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("px")])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("移动端图片宽高： 宽度")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"30px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.mobileWidth,expression:"pluginAttrData.attr.data.mobileWidth"}],staticStyle:{width:"30px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.mobileWidth},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"mobileWidth",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("rem   高度")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"30px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.mobileHeight,expression:"pluginAttrData.attr.data.mobileHeight"}],staticStyle:{width:"30px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.mobileHeight},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"mobileHeight",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("rem")])])])]):t._e()},ke=[],Se={name:"doneinputattr",props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},updateimage:function(t){var e=t.currentTarget,a=this,n=e.files[0].name.lastIndexOf("."),i=e.files[0].name.substring(n).toLowerCase();if(".png"==i||".jpg"==i||".jpeg"==i||".gif"==i||".svg"==i){if(void 0!=e.files[0]){var r=new FormData;r.append("upfile",e.files[0]);var s=new XMLHttpRequest;s.open("post","https://dev-officeflow.rlstech.cn/api/upload/index?category=image"),s.onload=function(t){var n=JSON.parse(t.currentTarget.response);"SUCCESS"==n.state?(a.pluginAttrData.attr.data.name=e.files[0].name,a.pluginAttrData.data="https://dev-officeflowimg.rlstech.cn/"+n.url,a.dataChange(),$(e).val("")):(a.$message.info({message:"上传失败，请稍后重试！"}),$(e).val(""))},s.onerror=function(t){a.$message.info({message:"上传失败，请稍后重试！"})},s.send(r)}}else a.$message.info({message:"仅支持png,jpg,jpeg,gif,svg格式的文件！"})},clickupdate:function(t){$("#"+this.pluginAttrData.key).click()},select:function(){console.log("this.pluginAttrData.attr.data.express",this.pluginAttrData.attr.data),""===this.pluginAttrData.attr.data.express&&(this.pluginAttrData.data=""),console.log(this.pluginAttrData,"this.pluginAttrData"),this.dataChange()}},mounted:function(){console.log("pluginAttrData",this.pluginAttrData),this.dataChange()}},Ae=Se,Ee=Object(m["a"])(Ae,xe,ke,!1,null,null,null),Te=Ee.exports,Ie=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("控件宽度：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.width,expression:"pluginAttrData.attr.data.width"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.width},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"width",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("高度：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.height,expression:"pluginAttrData.attr.data.height"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.height},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"height",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("开头格式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.preFormat,expression:"pluginAttrData.attr.data.preFormat"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"preFormat",e.target.multiple?a:a[0])},t.dataChange]}},[t._l(t.pluginAttrData.attr.data.preoptions,(function(e,n){return a("option",{domProps:{value:n}},[t._v(t._s(e))])})),t._v(" "),a("option",{attrs:{value:"3"}},[t._v("审批部门-审批人")])],2)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("结尾格式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.endFormat,expression:"pluginAttrData.attr.data.endFormat"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"endFormat",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.data.endoptions,(function(e,n){return a("option",{domProps:{value:n}},[t._v(t._s(e))])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("提示文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeHolder,expression:"pluginAttrData.attr.data.placeHolder"}],staticClass:"ctrl-item-input dimageattr",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.placeHolder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeHolder",e.target.value)}}})])])])]):t._e()},Pe=[],Ne={name:"dJoinSignattr",props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}},mounted:function(){this.dataChange()}},Re=Ne,Be=Object(m["a"])(Re,Ie,Pe,!1,null,null,null),Oe=Be.exports,Me=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("开头字符：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.front,expression:"pluginAttrData.attr.data.front"}],staticClass:"ctrl-item-input dimageattr",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.front},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"front",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.year,expression:"pluginAttrData.attr.data.year"}],attrs:{type:"checkbox","true-value":"1","false-value":"0"},domProps:{checked:Array.isArray(t.pluginAttrData.attr.data.year)?t._i(t.pluginAttrData.attr.data.year,null)>-1:t._q(t.pluginAttrData.attr.data.year,"1")},on:{change:[function(e){var a=t.pluginAttrData.attr.data.year,n=e.target,i=n.checked?"1":"0";if(Array.isArray(a)){var r=null,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.data,"year",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.data,"year",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.data,"year",i)},t.dataChange]}}),t._v("年份\n\t\t        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.month,expression:"pluginAttrData.attr.data.month"}],attrs:{type:"checkbox","true-value":"1","false-value":"0"},domProps:{checked:Array.isArray(t.pluginAttrData.attr.data.month)?t._i(t.pluginAttrData.attr.data.month,null)>-1:t._q(t.pluginAttrData.attr.data.month,"1")},on:{change:[function(e){var a=t.pluginAttrData.attr.data.month,n=e.target,i=n.checked?"1":"0";if(Array.isArray(a)){var r=null,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.data,"month",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.data,"month",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.data,"month",i)},t.dataChange]}}),t._v("月份\n\t\t        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.day,expression:"pluginAttrData.attr.data.day"}],attrs:{type:"checkbox","true-value":"1","false-value":"0"},domProps:{checked:Array.isArray(t.pluginAttrData.attr.data.day)?t._i(t.pluginAttrData.attr.data.day,null)>-1:t._q(t.pluginAttrData.attr.data.day,"1")},on:{change:[function(e){var a=t.pluginAttrData.attr.data.day,n=e.target,i=n.checked?"1":"0";if(Array.isArray(a)){var r=null,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.data,"day",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.data,"day",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.data,"day",i)},t.dataChange]}}),t._v("日期\n            ")])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("自增编号位数：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.numberLength,expression:"pluginAttrData.attr.data.numberLength"}],staticClass:"ctrl-item-input big-input",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.numberLength},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"numberLength",e.target.value)}}})])])])]):t._e()},Le=[],Ue={name:"dProjectNumberAttr",props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}},mounted:function(){this.dataChange()}},Fe=Ue,$e=Object(m["a"])(Fe,Me,Le,!1,null,null,null),He=$e.exports,je=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("密码长度：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.passwdLength,expression:"pluginAttrData.attr.data.passwdLength"}],staticClass:"ctrl-item-input",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.data.passwdLength},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"passwdLength",e.target.value)}}})])]),t._v(" 个字符\n        ")]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否随机生成密码：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n                    是 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isRandom,expression:"pluginAttrData.attr.data.isRandom"}],attrs:{type:"radio",value:"1"},domProps:{checked:t._q(t.pluginAttrData.attr.data.isRandom,"1")},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isRandom","1")},t.dataChange]}}),t._v("\n\t\t\t\t\t否 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.isRandom,expression:"pluginAttrData.attr.data.isRandom"}],attrs:{type:"radio",value:"2"},domProps:{checked:t._q(t.pluginAttrData.attr.data.isRandom,"2")},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"isRandom","2")},t.dataChange]}})])])]),t._v(" "),"1"==t.pluginAttrData.attr.data.isRandom?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},t._l(t.pluginAttrData.attr.data.options,(function(e,n){return a("label",{attrs:{for:""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.passwdFormat,expression:"pluginAttrData.attr.data.passwdFormat"}],attrs:{type:"checkbox"},domProps:{value:n,checked:Array.isArray(t.pluginAttrData.attr.data.passwdFormat)?t._i(t.pluginAttrData.attr.data.passwdFormat,n)>-1:t.pluginAttrData.attr.data.passwdFormat},on:{change:[function(e){var a=t.pluginAttrData.attr.data.passwdFormat,i=e.target,r=!!i.checked;if(Array.isArray(a)){var s=n,o=t._i(a,s);i.checked?o<0&&t.$set(t.pluginAttrData.attr.data,"passwdFormat",a.concat([s])):o>-1&&t.$set(t.pluginAttrData.attr.data,"passwdFormat",a.slice(0,o).concat(a.slice(o+1)))}else t.$set(t.pluginAttrData.attr.data,"passwdFormat",r)},t.dataChange]}}),t._v("\n\t\t\t        "+t._s(e)+"\n\t\t        ")])})),0)]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认密码：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.data,expression:"pluginAttrData.data"}],staticClass:"ctrl-item-input big-input",attrs:{type:"text"},domProps:{value:t.pluginAttrData.data},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData,"data",e.target.value)}}})])])])]):t._e()},We=[],ze={name:"dPasswdAttr",props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}},mounted:function(){this.dataChange()}},Ve=ze,qe=Object(m["a"])(Ve,je,We,!1,null,null,null),Ge=qe.exports,Ke=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("签章类型：")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.sealType,expression:"pluginAttrData.attr.data.sealType"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"sealType",e.target.multiple?a:a[0])},t.sealNameFn]}},t._l(t.pluginAttrData.attr.data.sealClass,(function(e,n){return a("option",{key:n,domProps:{value:e.value}},[t._v("\n\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t")])})),0)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("提示文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.defaultText,expression:"pluginAttrData.attr.data.defaultText"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.defaultText},on:{blur:t.cutOutfun,keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"defaultText",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"desc",domProps:{textContent:t._s("说明：每行最多5个字符，最大三行，使用<br />换行")}})])]),t._v(" "),2==t.pluginAttrData.attr.data.sealType?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选择公章：")]),t._v(" "),a("input",{attrs:{type:"button",name:"选择公章",value:"选择公章"},on:{click:t.bigSealFn}})]),t._v(" "),t.bigSeal?a("div",{staticClass:"fixed-middle"},[a("span",{staticClass:"seal-close",on:{click:function(e){t.bigSeal=0,t.departList=[]}}},[t._v("x")]),t._v(" "),a("div",[a("p",{staticClass:"headSeal"},[t._v("选择公章")]),t._v(" "),a("div",{staticClass:"seal-content"},[a("div",{staticClass:"seal-content-left"},[a("ul",{staticClass:"tab"},[a("li",{class:{active:1==t.tab},on:{click:function(e){t.tab=1}}},[t._v("部门")]),t._v(" "),a("li",{class:{active:2==t.tab},on:{click:function(e){t.tab=2}}},[t._v("变量")])]),t._v(" "),a("el-tree",{directives:[{name:"show",rawName:"v-show",value:1==t.tab,expression:"tab == 1"}],attrs:{data:t.deparTree,props:t.defaultProps,"node-key":"id","expand-on-click-node":!1,"default-expanded-keys":[0]},on:{"node-click":t.handleNodeClick}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2==t.tab,expression:"tab == 2"}],staticClass:"variable"},t._l(t.variable,(function(e,n){return a("p",{key:n,class:{active:!!t.active2&&t.active2.split(".")[0]==e.id},on:{click:function(a){return t.heandleAttr(e)}}},[t._v(t._s(e.name))])})),0)],1),t._v(" "),a("div",{staticClass:"seal-content-right"},[a("ul",[t._l(t.departList,(function(e,n){return 1==t.tab?a("li",{key:n,class:{"seal-content-right-li":1,"seal-content-right-choose":1},on:{click:function(a){return t.getDepartSealFn(a,e)}}},[a("span",{class:{"seal-content-right-li-choose":t.active.id==e.id}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t\t\t")])]):t._e()})),t._v(" "),t._l(t.sealType,(function(e,n){return 2==t.tab?a("li",{key:n,class:{"seal-content-right-li":1,"seal-content-right-choose":1},on:{click:function(a){return t.heandleAttrS(e)}}},[a("span",{class:{"seal-content-right-li-choose":!!t.active2&&t.active2.split(".")[1]==e.id}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t\t\t")])]):t._e()}))],2)])]),t._v(" "),a("div",{staticClass:"seal-foot"},[a("span",{staticClass:"seal-foot-sure",on:{click:t.sealFootSureFn}},[t._v("确定")])])])]):t._e()]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("左偏移值：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.style.left,expression:"pluginAttrData.attr.style.left"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.style.left},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.style,"left",e.target.value)}}})])])])]):t._e()},Xe=[],Ye=(a("9302"),a("77ad"),a("fe8a"),a("0d7a"),{name:"dsealAttr",props:["sendmessage","pluginAttrData"],data:function(){return{bigSeal:0,defaultProps:{children:"children",label:"name"},deparTree:[],departList:[],active:{id:0,name:""},active2:"",tab:1,variable:[{id:"starter",name:"发起者"},{id:"assignee",name:"审批者"}],sealType:[{id:"political_party",name:"党章"},{id:"government",name:"行政章"}]}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},clickupdate:function(t){$("#"+this.pluginAttrData.key).click()},sealNameFn:function(){1==this.pluginAttrData.attr.data.sealType?(this.pluginAttrData.attr.data.sealId=0,this.pluginAttrData.attr.data.sealName="",this.pluginAttrData.attr.data.defaultText="点击盖章<br />(人名章)"):this.pluginAttrData.attr.data.defaultText="点击盖章<br />",this.dataChange()},bigSealFn:function(){var t=this;this.active={id:this.pluginAttrData.attr.data.sealId,name:this.pluginAttrData.attr.data.sealName},this.active2=this.pluginAttrData.attr.data.sealAttribute?this.pluginAttrData.attr.data.sealAttribute:"",this.appFetch({method:"post",url:"departSeal"},(function(e){0==e.e?(t.deparTree=[e.d],t.bigSeal=1):t.$message(e.m)}),(function(e){t.$message("系统错误")}))},getDepartSealFn:function(t,e){this.active.id==e.id?(this.active.id=0,this.active.name=""):(this.active.id=e.id,this.active.name=e.name),this.dataChange()},sealFootSureFn:function(){0!=Object.keys(this.active).length&&(this.pluginAttrData.attr.data.sealId=this.active.id,this.pluginAttrData.attr.data.sealName=this.active.name);var t=this.active2.split("."),e=1;t.forEach((function(t){t||(e=0)})),e&&(this.pluginAttrData.attr.data.sealAttribute=this.active2),this.dataChange(),this.bigSeal=0},handleNodeClick:function(t){"根部门"!=t.name&&(this.departList=t.seal)},heandleAttr:function(t){if(""==this.active2)this.active2=t.id+".";else{var e=this.active2.split(".");e[0]=t.id,this.active2=e.join(".")}},heandleAttrS:function(t){if(""==this.active2)this.active2="."+t.id;else{var e=this.active2.split(".");e[1]=t.id,this.active2=e.join(".")}},cutOutfun:function(){var t="",e="";t=this.pluginAttrData.attr.data.defaultText,t=t.replace(/\s+/g,""),e=this.lineFun(t),this.pluginAttrData.attr.data.defaultText=e,this.dataChange()},lineFun:function(t){if(-1!=t.indexOf("<br/>")){var e=t.split("<br/>");1==this.pluginAttrData.attr.data.sealType?e.length>3&&(e=e.slice(0,3)):e.length>2&&(e=e.slice(0,2));for(var a=0;a<e.length;a++)e[a].length>5&&(e[a]=e[a].slice(0,5));return e.join("<br/>")}return t.length>5?t.slice(0,5):t}},mounted:function(){this.dataChange()},created:function(){this._this=this},components:{}}),Je=Ye,Ze=(a("01a5"),Object(m["a"])(Je,Ke,Xe,!1,null,"d6a4a510",null)),Qe=Ze.exports,ta=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定类型：")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],staticClass:"form_Select",attrs:{disabled:"disabled"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"type",e.target.multiple?a:a[0])},t.typeChange]}},t._l(t.typeList,(function(e){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])})),0)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定类型：")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.mode,expression:"pluginAttrData.attr.data.mode"}],staticClass:"form_Select",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"mode",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.modes,(function(e){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])})),0)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定Api：")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.api,expression:"pluginAttrData.attr.data.api"}],staticClass:"form_Select",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"api",e.target.multiple?a:a[0])},t.columnTypeChange]}},[a("option",{attrs:{value:""}},[t._v("请选择Api")]),t._v(" "),t._l(t.columnTypes,(function(e){return a("option",{domProps:{value:e.key}},[t._v(t._s(e.name))])}))],2)])]),t._v(" "),t.pluginAttrData.attr.data.api?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("设置绑定：")]),t._v(" "),a("table",[t._m(0),t._v(" "),t._l(t.pluginAttrData.attr.data.bindList,(function(e,n){return a("tr",[a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.pluginkey,expression:"bindone.pluginkey"}],staticClass:"form_Select",on:{change:[function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"pluginkey",a.target.multiple?n:n[0])},t.dataChange]}},[a("option",{attrs:{value:""}},[t._v("请选择控件")]),t._v(" "),t._l(t.inputList,(function(e){return a("option",{domProps:{value:e.key}},[t._v("\n                                    "+t._s(e.description)+"\n                                ")])}))],2)]),t._v(" "),a("td",{staticClass:"bindingColumnTd"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.columnKey,expression:"bindone.columnKey"}],staticClass:"form_Select",on:{change:[function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"columnKey",a.target.multiple?n:n[0])},t.dataChange]}},[a("option",{attrs:{value:""}},[t._v("请选择字段")]),t._v(" "),t._l(t.columnList,(function(e,n){return a("option",{domProps:{value:n}},[t._v("\n                                    "+t._s(e)+"\n                                ")])}))],2),t._v(" "),a("button",{staticClass:"delbutton",on:{click:function(e){return t.clearThis(n)}}},[t._v("删除")])])])})),t._v(" "),a("tr",[a("td",[a("button",{on:{click:t.add}},[t._v("新增")]),t._v(" "),a("button",{on:{click:t.clearAll}},[t._v("全删")])]),t._v(" "),a("td")])],2)])]):t._e()]):t._e()},ea=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{staticClass:"formtitle-td"},[t._v("控件")]),t._v(" "),a("td",{staticClass:"formtitle-td"},[t._v("字段")])])}],aa={name:"dBindingAttr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{typeList:[{name:"普通绑定",value:1},{name:"重复表内绑定",value:2}],modes:[{name:"精准查询",value:"absolute"},{name:"模糊查询",value:"like"}],columnTypes:{},inputList:[],columnList:{}}},watch:{pluginData:function(t,e){this.findInput()}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},findInput:function(){this.setType();var t=[];switch(this.pluginAttrData.attr.data.type){case 1:for(var e in this.pluginData)-1===e.indexOf("Input")||this.pluginData[e].pkey||t.push(this.pluginData[e]);break;case 2:for(var e in this.pluginData)-1!==e.indexOf("Input")&&this.pluginData[e].pkey==this.pluginAttrData.pkey&&t.push(this.pluginData[e]);break}this.inputList=t},typeChange:function(){this.pluginAttrData.attr.data.bindList=[],this.findInput(),this.dataChange()},modeChange:function(){this.dataChange()},add:function(){this.pluginAttrData.attr.data.bindList.push({pluginkey:"",columnKey:""}),this.dataChange()},clearThis:function(t){this.pluginAttrData.attr.data.bindList.splice(t,1),this.dataChange()},clearAll:function(){this.pluginAttrData.attr.data.bindList=[],this.dataChange()},setType:function(){this.pluginAttrData.attr.data.type=this.pluginAttrData.pkey?2:1},columnTypeChange:function(t){if(!this.pluginAttrData.attr.data.api)return!1;t&&this.clearAll(),this.columnList=this.columnTypes[this.pluginAttrData.attr.data.api].fields},getColumnList:function(){var t=this;this.appFetch({url:"getBindColumn",method:"GET"},(function(e){0==e.e?(t.columnTypes=e.d,t.columnTypeChange()):console.error("绑定控件获取字段列表失败")}),(function(){console.error("绑定控件获取字段列表失败")}))}},mounted:function(){this.findInput(),this.setType(),this.getColumnList();var t=this;setTimeout((function(){t.dataChange()}),200)}},na=aa,ia=Object(m["a"])(na,ta,ea,!1,null,null,null),ra=ia.exports,sa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("输入框样式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.styleType,expression:"pluginAttrData.attr.data.styleType"}],attrs:{name:"",id:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"styleType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:void 0}},[t._v("请选择")]),t._v(" "),t._l(t.styleTypes,(function(e,n){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}))],2)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("引用内容：")]),t._v(" "),a("div",{staticClass:"formitem-div",on:{click:t.yinyong}},[a("span",{staticStyle:{display:"inline-block","font-size":"12px",width:"100%",height:"100%",overflow:"scroll"}},t._l(t.rule,(function(e){return a("span",[t._v(t._s(e))])})),0)])]),t._v(" "),t.show?a("div",{staticClass:"box-Quote"},[a("div",[a("div",[a("span",{staticClass:"top-header"},[t._v("公式设置("+t._s("string"==t.pluginAttrData.attr.data.type?"内容引用":"公式计算")+")")]),t._v(" "),a("span",{staticClass:"x",on:{click:t.clear}},[t._v("x")])]),t._v(" "),a("div",{staticStyle:{position:"relative","margin-left":"10px"}},[a("div",{staticClass:"left-box"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchName,expression:"searchName",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入表单名称"},domProps:{value:t.searchName},on:{input:function(e){e.target.composing||(t.searchName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("ul",t._l(t.formFiles,(function(e,n){return a("li",{key:n,on:{click:function(a){return t.filterRight(a,e)}}},[t._v(t._s(e.name))])})),0)]),t._v(" "),a("div",{staticClass:"right-box"},[a("ul",t._l(t.formList,(function(e,n){return a("li",{class:{},on:{click:function(a){return t.getGet(e)}}},[a("span",[t._v(t._s(e.description))])])})),0)])]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("div",{staticStyle:{width:"95%",height:"103px",border:"1px solid #666",margin:"0 auto","text-align":"left",overflow:"hidden","padding-right":"5px","box-sizing":"border-box"}},t._l(t.rule,(function(e,n){return a("span",{key:n,staticClass:"form_span"},[t._v("\n              "+t._s(e)+"\n              "),a("i",{on:{click:function(e){return t.clearRule(n)}}},[t._v("×")])])})),0)]),t._v(" "),"formula"==t.pluginAttrData.attr.data.type?a("div",[t._m(0)]):t._e(),t._v(" "),a("div",{staticStyle:{"text-align":"center","padding-bottom":"5px"}},[a("div",{staticStyle:{display:"inline-block"}},[a("span",{staticClass:"clear",on:{click:t.clear}},[t._v("取消")]),t._v(" "),a("span",{staticClass:"makeSure",on:{click:t.makeSureFn}},[t._v("确定")])])])])]):t._e()])]):t._e()},oa=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("\n            运算符号：\n            "),a("span",[t._v("+")]),t._v(" "),a("span",[t._v("-")]),t._v(" "),a("span",[t._v("*")]),t._v(" "),a("span",[t._v("/")])])}],la=(a("f3dd"),a("0a51"),a("f4e3"),{name:"dQuoteAttr",props:["sendmessage","pluginAttrData"],data:function(){return{show:!1,_this:"",model:"",inChoose:-1,attrRule:"",rule:"",form:"",formList:[],formData:"",textareaX:0,formId:"",searchName:"",formFiles:[],styleTypes:[{name:"输入框",value:0},{name:"下划线",value:1}]}},watch:{searchName:function(){this.getFormFiles(),this.formList=[]},pluginAttrData:{handler:function(t){this.initData(t)},deep:!0}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},yinyong:function(){this.show=!this.show,this.show&&(this.initData(this.pluginAttrData),this.formList=[],this.searchName="",this.getFormFiles())},getFormFiles:function(){var t=this;this.appFetch({method:"GET",url:"vBpmnFormList",data:{bpmn_id:this.$route.query.bpmn_id}},(function(e){0==e.e?t.formFiles=e.d.list:t.$message.error(e.m)}),(function(e){t.$message.error("系统错误")}))},getFormList:function(t){var e=this;this.appFetch({url:"fBpmnCom",method:"get",data:{form_version_id:t}},(function(t){if(0==t.e){var a={},n=t.d.components,i=["Count","Calendar","Country","CountryV2","Depart","ProjectNumber","User","UserSearch","Binding","Select","Serial","Input","MultiInput","Quote","Radio","Passwd","Region","Show","Integer","Numeric","Checkbox"];for(var r in n){var s=n[r].columnType;i.includes(s)&&!n[r].pkey&&(a[r]=n[r])}e.formList=a}else e.$message.error({message:t.m})}),(function(t){e.$message.error({message:"系统错误"})}))},clearRule:function(t){this.attrRule.splice(t,1),this.rule.splice(t,1)},radioChange:function(t){this.pluginAttrData.attr.data.type=t.target.value},getGet:function(t){this.attrRule.push("{form"+this.form.form_id+"."+t.key+"}"),this.rule.push("{"+this.form.name+"_"+t.description+"}")},textareaFn:function(t){this.textareaX=t.target.selectionStart},makeSureFn:function(){for(var t="",e="",a=0;a<this.attrRule.length;a++)t+=this.attrRule[a],e+=this.rule[a];this.pluginAttrData.attr.data.rule=t,this.pluginAttrData.rule=e,this.$emit("sendmessage",this.pluginAttrData),this.show=!1},clear:function(){this.show=!1,this.initData(this.pluginAttrData)},filterRight:function(t,e){this.form=e,$(t.target).addClass("active").siblings().removeClass("active"),this.getFormList(e.form_version_id)},initData:function(t){var e=/{([\s\S]*?)}/g;if(!t.rule)return this.rule=[],this.attrRule=[],!1;this.rule=t.rule.match(e)||[],this.attrRule=t.attr.data.rule.match(e)||[]}},created:function(){this._this=this,this.initData(this.pluginAttrData)},components:{}}),ua=la,da=(a("35a3"),Object(m["a"])(ua,sa,oa,!1,null,"42ad9fbf",null)),ca=da.exports,pa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd dinput-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("API地址：")]),t._v(" "),a("div",{staticClass:"formline vertical-align link-width"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.api,expression:"pluginAttrData.attr.data.api"}],staticClass:"padding-left",attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.api},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"api",e.target.value)}}})])])])]):t._e()},ha=[],ga={name:"dMultipleAttr",props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}},mounted:function(){this.dataChange()}},fa=ga,ma=Object(m["a"])(fa,pa,ha,!1,null,null,null),va=ma.exports,ba=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("设置：")]),t._v(" "),a("div",{staticClass:"formarea",on:{click:t.openDialog}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.rule,expression:"pluginAttrData.attr.data.rule"}],attrs:{disabled:""},domProps:{value:t.pluginAttrData.attr.data.rule},on:{input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"rule",e.target.value)}}})]),t._v(" "),a("el-dialog",{attrs:{title:"计算设置",visible:t.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showDialog=e},close:t.closeDialog}},[t.pluginAttrData?a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"计算类型"}},[a("el-radio-group",{on:{change:function(e){return t.typeChange()}},model:{value:t.pluginAttrData.attr.data.type,callback:function(e){t.$set(t.pluginAttrData.attr.data,"type",e)},expression:"pluginAttrData.attr.data.type"}},t._l(t.pluginAttrData.attr.data.types,(function(e,n){return a("el-radio",{key:n,attrs:{label:e.value}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t\t\t")])})),1)],1),t._v(" "),"nrtablecount"==t.pluginAttrData.attr.data.type?a("el-form-item",{attrs:{label:"组件列表"}},[t._l(t.pluginData,(function(e){return e.pkey||e.key==t.pluginAttrData.key?t._e():[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertPlugin("plugin",e.key)}}},[t._v(t._s(e.description))]),t._v(" \n\t\t\t\t\t\t\t")]}))],2):t._e(),t._v(" "),"nrtablecount"!=t.pluginAttrData.attr.data.type?a("el-form-item",{attrs:{label:"重复表"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.pluginAttrData.attr.data.rtableKey,callback:function(e){t.$set(t.pluginAttrData.attr.data,"rtableKey",e)},expression:"pluginAttrData.attr.data.rtableKey"}},t._l(t.pluginData,(function(e){return"dRepeatTable"==e.type?a("el-option",{key:e.key,attrs:{label:e.description,value:e.key}}):t._e()})),1)],1):t._e(),t._v(" "),t.pluginAttrData.attr.data.rtableKey&&"nrtablecount"!=t.pluginAttrData.attr.data.type?a("el-form-item",{attrs:{label:"组件列表"}},[t._l(t.pluginData,(function(e){return e.pkey&&e.pkey==t.pluginAttrData.attr.data.rtableKey?[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertPlugin("plugin",e.key,e.pkey)}}},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(e.description)+"\n\t\t\t\t\t\t\t\t")]),t._v(" \n\t\t\t\t\t\t\t")]:t._e()}))],2):t._e(),t._v(" "),"rtablesum"==t.pluginAttrData.attr.data.type?a("el-form-item",{attrs:{label:"参数转化"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.handleRule,expression:"pluginAttrData.attr.data.handleRule"}],attrs:{cols:"80",rows:"5"},domProps:{value:t.pluginAttrData.attr.data.handleRule},on:{input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"handleRule",e.target.value)}}}),t._v(" "),a("p",[t._v("示例：'{p_data}'.indexOf('周') !== -1 ? +('{p_data}'.replace('周', '')) : 0 如果数据中有周字，去掉周字参数运算，没有周字则当成0运算")])]):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"当前公式"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.rule,expression:"rule"}],attrs:{cols:"80",rows:"5"},domProps:{value:t.rule},on:{mouseup:t.updateStartX,keyup:t.updateStartX,input:function(e){e.target.composing||(t.rule=e.target.value)}}})]),t._v(" "),a("el-form-item",{attrs:{label:"方法列表"}},[t._l(t.pluginAttrData.attr.data.methods,(function(e){return[a("el-tooltip",{key:e.methodName,staticClass:"item",attrs:{effect:"dark",content:e.description,placement:"top"}},[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertFunc("func",e.methodName)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t\t\t")])]),t._v("\n\t\t\t\t\t\t\t\t \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t")]}))],2)],1):t._e(),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.okDialog}},[t._v("确 定")])],1)],1)],1)]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("关联组件显示大写金额：")]),t._v(" "),a("div",{staticStyle:{display:"inline-block",width:"173px"}},[a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.bind,callback:function(e){t.$set(t.pluginAttrData.attr.data,"bind",e)},expression:"pluginAttrData.attr.data.bind"}},t._l(t.allPluginData,(function(t){return a("el-option",{key:t.key,attrs:{label:t.description||t.key,value:t.key}})})),1)],1)])])]):t._e()},ya=[],_a=a("f69e"),Da={name:"dCheckboxattr",data:function(){return{showDialog:!1,rule:"",startX:0}},props:["sendmessage","pluginAttrData","pluginData"],computed:{allPluginData:function(){var t={};for(var e in this.pluginData)"dmultiText"!=this.pluginData[e].type&&"dOneInput"!=this.pluginData[e].type||(t[e]=this.pluginData[e]);return t}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},openDialog:function(){this.showDialog=!0,this.rule=this.pluginAttrData.attr.data.rule},closeDialog:function(){this.showDialog=!1},okDialog:function(){var t=_a["a"].checkFormula(this.rule,this.pluginAttrData.attr.data.keyval);if(t)return this.$message({message:"公式错误，存在无用变量或方法:"+t,type:"error"}),!1;this.showDialog=!1,this.pluginAttrData.attr.data.rule=this.rule,this.dataChange()},typeChange:function(t){"nrtablecount"==this.pluginAttrData.attr.data.type&&(this.pluginAttrData.attr.data.rtableKey="",this.pluginAttrData.attr.data.rule=""),"rtablesum"!=this.pluginAttrData.attr.data.type&&(this.pluginAttrData.attr.data.conditionRule=""),this.dataChange()},insertPlugin:function(t,e,a){var n=_a["a"].getStrByKey(e,"plugin");this.pluginAttrData.attr.data.keyval[n]={type:t,key:e,pkey:a,evalVar:"_this.keyVal."+e+"Data"},this.updateNowRule(n)},insertFunc:function(t,e){var a=_a["a"].getStrByKey(e,"func");this.pluginAttrData.attr.data.keyval[_a["a"].getStrByKey(e,"func")]={type:t,key:e,evalMethod:"_this."+e},this.updateNowRule(a)},updateStartX:function(t){this.startX=t.target.selectionStart},updateNowRule:function(t){var e=this.rule.substring(0,this.startX),a=this.rule.substring(this.startX);this.rule=e+t+a},addMethods:function(){this.pluginAttrData.attr.data.methods=_a["a"].methods}},mounted:function(){this.addMethods()}},Ca=Da,wa=Object(m["a"])(Ca,ba,ya,!1,null,null,null),xa=wa.exports,ka=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"selfattrbox dselect-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("填写格式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.limitval,expression:"pluginAttrData.attr.data.limitval"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"limitval",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.data.limit,(function(e,n,i){return a("option",{domProps:{value:n}},[t._v(t._s(e))])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("设置地址方式：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.types,(function(e){return[t._v("\n          "+t._s(e.name)+"\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.type,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"type",e.value)},t.dataChange]}}),t._v("   \n        ")]}))],2)])]),t._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:1==t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type == 1"}],staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("div",{staticClass:"formradio"},[t._l(t.places,(function(e){return[t._v("\n          "+t._s(e.name)+"\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.place,expression:"pluginAttrData.attr.data.place"}],attrs:{type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.place,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"place",e.value)},t.dataChange]}}),t._v("   \n        ")]}))],2)])]),t._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:0==t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type == 0"}],staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("设置不显示省份：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",multiple:"",size:"mini"},on:{change:t.changeRegion},model:{value:t.hideProvinces,callback:function(e){t.hideProvinces=e},expression:"hideProvinces"}},t._l(t.regioninfo,(function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),1)],1)])])])},Sa=[],Aa=a("5557"),Ea={name:"dRegionattr",data:function(){return{types:[{name:"手动填写",value:0},{name:"定位",value:1}],places:[{name:"点击获取定位",value:0},{name:"自动获取定位",value:1}],regioninfo:[],hideProvinces:[]}},props:["sendmessage","pluginAttrData","pluginData"],created:function(){this.hideProvinces=this.pluginAttrData.attr.data.hideProvinces?this.pluginAttrData.attr.data.hideProvinces:[],this.getRegion()},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},getRegion:function(){var t=this;Aa["a"].getSItem("dRegionAttrRegion")?this.regioninfo=Aa["a"].getSItem("dRegionAttrRegion"):this.appFetch({method:"GET",url:"region"}).then((function(e){0==e.e?(t.regioninfo=e.d,Aa["a"].setSItem("dRegionAttrRegion",t.regioninfo)):t.$message.error({message:e.e})}))},changeRegion:function(){this.pluginAttrData.attr.data.hideProvinces=this.hideProvinces,this.dataChange()}}},Ta=Ea,Ia=Object(m["a"])(Ta,ka,Sa,!1,null,null,null),Pa=Ia.exports,Na=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("设置条件：")]),t._v(" "),a("table",[t._m(0),t._v(" "),t._l(t.pluginAttrData.attr.data.conditions,(function(e,n){return e?a("tr",[a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"condition.name"}],staticClass:"width100",attrs:{disabled:0==n,type:"text"},domProps:{value:e.name},on:{keyup:t.dataChange,input:function(a){a.target.composing||t.$set(e,"name",a.target.value)}}})]),t._v(" "),a("td",{staticClass:"bindingColumnTd"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.expression,expression:"condition.expression"}],staticClass:"width100",attrs:{readonly:"",type:"text"},domProps:{value:e.expression},on:{click:function(e){return t.openDialog(n)},input:function(a){a.target.composing||t.$set(e,"expression",a.target.value)}}})]),t._v(" "),a("td",[0!=n?a("button",{staticClass:"delbutton",on:{click:function(e){return t.clearThisCon(n)}}},[t._v("删除")]):t._e()])]):t._e()})),t._v(" "),a("tr",[a("td",[a("button",{on:{click:t.addCon}},[t._v("新增")])]),t._v(" "),a("td"),t._v(" "),a("td")])],2),t._v(" "),a("el-dialog",{attrs:{title:"计算设置",visible:t.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showDialog=e},close:t.closeDialog}},[t.pluginAttrData?a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"组件列表"}},[t._l(t.pluginData,(function(e){return e.pkey||e.key==t.pluginAttrData.key?t._e():[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertPlugin("plugin",e.key)}}},[t._v(t._s(e.description))]),t._v(" \n            ")]}))],2),t._v(" "),a("el-form-item",{attrs:{label:"当前公式"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.rule,expression:"rule"}],attrs:{cols:"80",rows:"5"},domProps:{value:t.rule},on:{mouseup:t.updateStartX,keyup:t.updateStartX,input:function(e){e.target.composing||(t.rule=e.target.value)}}})]),t._v(" "),a("el-form-item",{attrs:{label:"方法列表"}},[t._l(t.pluginAttrData.attr.data.methods,(function(e){return[a("el-tooltip",{key:e.methodName,staticClass:"item",attrs:{effect:"dark",content:e.description,placement:"top"}},[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertFunc("func",e.methodName)}}},[t._v("\n                  "+t._s(e.name)+"\n                ")])]),t._v("\n               \n            ")]}))],2)],1):t._e(),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.okDialog}},[t._v("确 定")])],1)],1)],1)]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[t._m(1),t._v(" "),a("table",[t._m(2),t._v(" "),t._l(t.pluginAttrData.attr.data.controls,(function(e,n){return a("tr",[a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.conkey,expression:"control.conkey"}],on:{change:[function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"conkey",a.target.multiple?n:n[0])},t.dataChange]}},[a("option",{attrs:{value:""}},[t._v("请选择条件")]),t._v(" "),t._l(t.pluginAttrData.attr.data.conditions,(function(e,n){return e?a("option",{domProps:{value:n}},[t._v("\n                "+t._s(e.name)+"\n              ")]):t._e()}))],2)]),t._v(" "),a("td",{staticClass:"bindingColumnTd"},[a("button",{on:{click:function(e){return t.openSetInfo(n)}}},[t._v("点击设置("+t._s(e.setInfo.plugins&&e.setInfo.plugins.length?"已设置":"未设置")+")")])]),t._v(" "),a("td",[a("button",{staticClass:"delbutton",on:{click:function(e){return t.clearControl(n)}}},[t._v("删除")])])])})),t._v(" "),a("tr",[a("td",[a("button",{on:{click:t.addControl}},[t._v("新增")])]),t._v(" "),a("td"),t._v(" "),a("td")])],2),t._v(" "),a("el-dialog",{attrs:{title:"显隐设置",visible:t.showSetInfo,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showSetInfo=e},close:t.closeSetInfo}},[t.pluginAttrData?a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"搜索:",size:"small"}},[a("el-input",{attrs:{placeholder:"请输入组名称"},model:{value:t.searchInfo,callback:function(e){t.searchInfo=e},expression:"searchInfo"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),t._v(" "),a("el-form-item",{attrs:{label:"全选/不选:",size:"small"}},[a("el-button",{on:{click:function(e){return t.selectAll(!0)}}},[t._v("全选")]),t._v(" "),a("el-button",{on:{click:function(e){return t.selectAll(!1)}}},[t._v("全不选")])],1),t._v(" "),a("el-form-item",{attrs:{label:"组件列表:",size:"small"}},[a("el-checkbox-group",{model:{value:t.checks,callback:function(e){t.checks=e},expression:"checks"}},[t._l(t.pluginData,(function(e){return t.isShow(e)?[a("el-checkbox",{key:e.key,attrs:{label:e.key}},[t._v("\n                  "+t._s(e.description)+"\n                ")])]:t._e()}))],2)],1),t._v(" "),a("el-form-item",{attrs:{label:"显隐设置:",size:"small"}},[a("el-radio",{attrs:{label:1},model:{value:t.showHideStatus,callback:function(e){t.showHideStatus=e},expression:"showHideStatus"}},[t._v("显示")]),t._v(" "),a("el-radio",{attrs:{label:0},model:{value:t.showHideStatus,callback:function(e){t.showHideStatus=e},expression:"showHideStatus"}},[t._v("隐藏")]),t._v(" "),a("el-radio",{attrs:{label:2},model:{value:t.showHideStatus,callback:function(e){t.showHideStatus=e},expression:"showHideStatus"}},[t._v("不干预")])],1),t._v(" "),a("el-form-item",{attrs:{label:"是否必填:",size:"small"}},[a("el-radio",{attrs:{label:1},model:{value:t.isRequired,callback:function(e){t.isRequired=e},expression:"isRequired"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:0},model:{value:t.isRequired,callback:function(e){t.isRequired=e},expression:"isRequired"}},[t._v("否")]),t._v(" "),a("el-radio",{attrs:{label:2},model:{value:t.isRequired,callback:function(e){t.isRequired=e},expression:"isRequired"}},[t._v("不干预")])],1),t._v(" "),a("el-form-item",{attrs:{label:"清空数据:",size:"small"}},[a("el-radio",{attrs:{label:1},model:{value:t.isEmpty,callback:function(e){t.isEmpty=e},expression:"isEmpty"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:0},model:{value:t.isEmpty,callback:function(e){t.isEmpty=e},expression:"isEmpty"}},[t._v("否")]),t._v(" "),a("el-radio",{attrs:{label:2},model:{value:t.isEmpty,callback:function(e){t.isEmpty=e},expression:"isEmpty"}},[t._v("不干预")])],1)],1):t._e(),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeSetInfo}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.okSetInfo}},[t._v("确 定")])],1)],1)],1)])]):t._e()},Ra=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{staticClass:"formtitle-td"},[t._v("名称")]),t._v(" "),a("td",{staticClass:"formtitle-td"},[t._v("表达式")]),t._v(" "),a("td",{staticClass:"formtitle-td"},[t._v("操作")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"formtitle"},[t._v("设置显隐："),a("span",{staticClass:"desc"},[t._v("（如需设置默认条件，需放在第一个）")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{staticClass:"formtitle-td"},[t._v("条件")]),t._v(" "),a("td",{staticClass:"formtitle-td"},[t._v("控制")]),t._v(" "),a("td",{staticClass:"formtitle-td"},[t._v("操作")])])}],Ba={name:"dshowhideattr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{showDialog:!1,rule:"",startX:0,nowkey:"",showSetInfo:!1,nowInfoKey:"",setInfo:[],searchInfo:"",checks:[],showHideStatus:1,isRequired:0,isEmpty:0}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},addCon:function(){this.pluginAttrData.attr.data.num++,this.$set(this.pluginAttrData.attr.data.conditions,this.pluginAttrData.attr.data.num,{name:"",expression:""}),this.dataChange()},clearThisCon:function(t){this.$delete(this.pluginAttrData.attr.data.conditions,t)},openDialog:function(t){console.log(t),this.nowkey=t,this.showDialog=!0,this.rule=this.pluginAttrData.attr.data.conditions[this.nowkey].expression},closeDialog:function(){this.showDialog=!1},okDialog:function(){var t=_a["a"].checkFormula(this.rule,this.pluginAttrData.attr.data.keyval);if(t)return this.$message({message:"公式错误，存在无用变量或方法:"+t,type:"error"}),!1;this.showDialog=!1,this.pluginAttrData.attr.data.conditions[this.nowkey].expression=this.rule,this.dataChange()},insertPlugin:function(t,e){var a=_a["a"].getStrByKey(e,"plugin");this.pluginAttrData.attr.data.keyval[a]={type:t,key:e,evalVar:"_this.keyVal."+e+"Data"},this.updateNowRule(a)},insertFunc:function(t,e){var a=_a["a"].getStrByKey(e,"func");this.pluginAttrData.attr.data.keyval[_a["a"].getStrByKey(e,"func")]={type:t,key:e,evalMethod:"_this."+e},this.updateNowRule(a)},updateStartX:function(t){this.startX=t.target.selectionStart},updateNowRule:function(t){var e=this.rule.substring(0,this.startX),a=this.rule.substring(this.startX);this.rule=e+t+a},addControl:function(){this.$set(this.pluginAttrData.attr.data.controls,this.pluginAttrData.attr.data.controls.length,{conkey:"",setInfo:{}}),this.dataChange()},clearControl:function(t){this.$delete(this.pluginAttrData.attr.data.controls,t)},openSetInfo:function(t){this.nowInfoKey=t,this.showSetInfo=!0,this.setInfo=this.pluginAttrData.attr.data.controls[this.nowInfoKey].setInfo,this.checks=this.setInfo.plugins?this.setInfo.plugins:[],this.showHideStatus=this.setInfo.isShow,this.isRequired=this.setInfo.isRequired,this.isEmpty=this.setInfo.isEmpty},closeSetInfo:function(){this.showSetInfo=!1},okSetInfo:function(){this.showSetInfo=!1,this.pluginAttrData.attr.data.controls[this.nowInfoKey].setInfo={isShow:this.showHideStatus,isRequired:this.isRequired,isEmpty:this.isEmpty,plugins:this.checks},this.dataChange()},isShow:function(t){return!t.pkey&&t.key!=this.pluginAttrData.key&&(t.groupname&&-1!==t.groupname.indexOf(this.searchInfo)||-1!==t.description.indexOf(this.searchInfo))},selectAll:function(t){if(t){var e=[];for(var a in this.pluginData){var n=this.pluginData[a];this.isShow(n)&&e.push(a)}this.checks=e}else this.checks=[]},addMethods:function(){this.pluginAttrData.attr.data.methods=_a["a"].methods}},mounted:function(){this.addMethods()}},Oa=Ba,Ma=Object(m["a"])(Oa,Na,Ra,!1,null,null,null),La=Ma.exports,Ua=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("商品列表：")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.goods_id,expression:"pluginAttrData.attr.data.goods_id"}],staticStyle:{"max-width":"240px"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"goods_id",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.data.goodList,(function(e,n){return a("option",{key:n,domProps:{value:e.id}},[t._v(t._s(e.goods_name))])})),0)])]),t._v(" "),2==t.pluginAttrData.attr.data.pay_type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("关联表单控件：")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.component_key,expression:"pluginAttrData.attr.data.component_key"}],staticStyle:{"max-width":"200px"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"component_key",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginData,(function(e,n){return"dInput"==e.type?a("option",{key:n,domProps:{value:e.key}},[t._v(t._s(e.description))]):t._e()})),0)])]):t._e()]):t._e()},Fa=[],$a={name:"dPaymentattr",props:["sendmessage","pluginAttrData","pluginData"],methods:{dataChange:function(){var t=this;this.pluginAttrData.attr.data.goodList.forEach((function(e){t.pluginAttrData.attr.data.goods_id==e.id&&(t.pluginAttrData.attr.data.goods_name=e.goods_name,t.pluginAttrData.attr.data.pay_type=e.pay_type)})),this.$emit("sendmessage",this.pluginAttrData)}},mounted:function(){this.dataChange()}},Ha=$a,ja=Object(m["a"])(Ha,Ua,Fa,!1,null,null,null),Wa=ja.exports,za=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"selfattrbox dselect-attr"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("条码类型:")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.code_type,expression:"pluginAttrData.attr.data.code_type"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"code_type",e.target.multiple?a:a[0])},t.SelectChange]}},[a("option",{attrs:{value:"Qr"}},[t._v("二维码")]),t._v(" "),a("option",{attrs:{value:"Br"}},[t._v("条形码")])])])])]),t._v(" "),"Br"==t.pluginAttrData.attr.data.code_type?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("条形码类型:")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.Br_data,expression:"pluginAttrData.attr.data.Br_data"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"Br_data",e.target.multiple?a:a[0])},t.attrChange]}},t._l(t.br_DataAll,(function(e,n){return a("option",{key:n,domProps:{value:e}},[t._v(t._s(e))])})),0),t._v(" "),a("i",{directives:[{name:"popover",rawName:"v-popover:popoverhelper",arg:"popoverhelper"}],staticClass:"helpericon1 el-icon-question"}),t._v(" "),a("el-popover",{ref:"popoverhelper",attrs:{placement:"top-start",width:"400",trigger:"hover"}},[t._v("\n\t\t\t\t\tCODE128（推荐）：支持字母、数字和符号。\n\t\t\t\t\t"),a("br"),t._v(" CODE39（推荐）：支持字母、数字和部分符号。\n\t\t\t\t\t"),a("br"),t._v(" EAN-13：表示13位数字。\n\t\t\t\t\t"),a("br"),t._v(" EAN-8：表示8位数字。\n\t\t\t\t\t"),a("br"),t._v(" UPC (A)：只能表示数字。\n\t\t\t\t\t"),a("br"),t._v(" ITF-14：14位数字字符。\n\t\t\t\t\t"),a("br"),t._v(" MSI：仅支持数字编码。\n\t\t\t\t\t"),a("br"),t._v(" Pharmacode：仅支持数字编码。\n\t\t\t\t\t"),a("br"),t._v(" Codabar：支持数字、部分英文字母及部分符号。\n\t\t\t\t")])],1)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("条形码高度:")]),t._v(" "),a("div",{staticClass:"select_default"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.Br_height,expression:"pluginAttrData.attr.data.Br_height"}],staticStyle:{width:"50px"},attrs:{type:"test"},domProps:{value:t.pluginAttrData.attr.data.Br_height},on:{keyup:function(e){return e.preventDefault(),t.compatibility(e)},change:t.attrChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"Br_height",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("指定内容:")]),t._v(" "),a("div",{staticClass:"select_default"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.appoint,expression:"pluginAttrData.attr.data.appoint"}],staticStyle:{width:"140px"},attrs:{type:"text",placeholder:"可支持数字、字母及符号"},domProps:{value:t.pluginAttrData.attr.data.appoint},on:{change:t.attrChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"appoint",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否显示条形码值:")]),t._v(" "),a("div",{staticClass:"formradio"},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.Br_if,expression:"pluginAttrData.attr.data.Br_if"}],attrs:{type:"radio",name:"like",value:"true"},domProps:{checked:t._q(t.pluginAttrData.attr.data.Br_if,"true")},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"Br_if","true")},t.attrChange]}}),t._v("是")]),t._v(" "),a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.Br_if,expression:"pluginAttrData.attr.data.Br_if"}],attrs:{type:"radio",name:"like",value:"false"},domProps:{checked:t._q(t.pluginAttrData.attr.data.Br_if,"false")},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"Br_if","false")},t.attrChange]}}),t._v("否")])])])])]:t._e(),t._v(" "),"Qr"==t.pluginAttrData.attr.data.code_type?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("大小：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.size,expression:"pluginAttrData.attr.data.size"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"size",e.target.multiple?a:a[0])},t.attrChange]}},[a("option",{attrs:{value:"100"}},[t._v("100")]),t._v(" "),a("option",{attrs:{value:"150"}},[t._v("150")]),t._v(" "),a("option",{attrs:{value:"200"}},[t._v("200")])])])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("二维码地址：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{name:"fontFamily"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"type",e.target.multiple?a:a[0])},function(e){return t.attrChange("type")}]}},[a("option",{attrs:{value:"currForm"}},[t._v("当前表单")]),t._v(" "),a("option",{attrs:{value:"custom"}},[t._v("自定义")])])])])]),t._v(" "),"custom"==t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("内容/地址：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.url,expression:"pluginAttrData.attr.data.url",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.url},on:{change:t.attrChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"url",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])])]):t._e()]:t._e()],2)},Va=[],qa={name:"dQrcodeAttr",data:function(){return{br_DataAll:["CODE128","CODE39","EAN13","EAN8","EAN5","EAN2","UPC","ITF","ITF14","MSI","MSI10","MSI11","MSI1010","MSI1110","pharmacode","codabar"]}},props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},compatibility:function(){this.pluginAttrData.attr.data.Br_height=this.pluginAttrData.attr.data.Br_height.replace(/[^\d]/g,""),this.attrChange()},SelectChange:function(){"Qr"==this.pluginAttrData.attr.data.code_type?this.pluginAttrData.attr.data.appoint="":this.pluginAttrData.attr.data.url="",this.attrChange()},attrChange:function(t){"Qr"==this.pluginAttrData.attr.data.code_type&&"currForm"==this.pluginAttrData.attr.data.type&&t&&(this.pluginAttrData.attr.data.url=""),this.dataChange()}},created:function(){}},Ga=qa,Ka=Object(m["a"])(Ga,za,Va,!1,null,null,null),Xa=Ka.exports,Ya=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key&&t.pluginAttrData.attr.setInfo?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("按钮显示：")]),t._v(" "),a("div",{staticClass:"formlinebox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.add,expression:"pluginAttrData.attr.setInfo.buttons.add"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.add)?t._i(t.pluginAttrData.attr.setInfo.buttons.add,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.add},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.add,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"add",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"add",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"add",i)},t.dataChange]}}),t._v("添加\n\t\t\t\t\t  \n\t\t\t\t\t"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.del,expression:"pluginAttrData.attr.setInfo.buttons.del"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.del)?t._i(t.pluginAttrData.attr.setInfo.buttons.del,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.del},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.del,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"del",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"del",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"del",i)},t.dataChange]}}),t._v("删除\n\t\t\t\t\t  \n\t\t\t\t\t"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.export,expression:"pluginAttrData.attr.setInfo.buttons.export"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.export)?t._i(t.pluginAttrData.attr.setInfo.buttons.export,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.export},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.export,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"export",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"export",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"export",i)},t.dataChange]}}),t._v("导出\n\t\t\t\t\t  \n\t\t\t\t\t"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.refresh,expression:"pluginAttrData.attr.setInfo.buttons.refresh"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.refresh)?t._i(t.pluginAttrData.attr.setInfo.buttons.refresh,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.refresh},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.refresh,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"refresh",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"refresh",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"refresh",i)},t.dataChange]}}),t._v("同步\n\t\t\t\t\t  \n\t\t\t\t\t"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.sort,expression:"pluginAttrData.attr.setInfo.buttons.sort"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.sort)?t._i(t.pluginAttrData.attr.setInfo.buttons.sort,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.sort},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.sort,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"sort",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"sort",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"sort",i)},t.dataChange]}}),t._v("排序\n\t\t\t\t\t  \n\t\t\t\t\t"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.copy,expression:"pluginAttrData.attr.setInfo.buttons.copy"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.copy)?t._i(t.pluginAttrData.attr.setInfo.buttons.copy,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.copy},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.copy,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"copy",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"copy",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"copy",i)},t.dataChange]}}),t._v("复制"),a("br"),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.import,expression:"pluginAttrData.attr.setInfo.buttons.import"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.import)?t._i(t.pluginAttrData.attr.setInfo.buttons.import,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.import},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.import,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"import",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"import",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"import",i)},t.dataChange]}}),t._v("导入:\n\t\t\t\t\t"),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.importType,expression:"pluginAttrData.attr.setInfo.importType"}],staticStyle:{width:"100px","margin-left":"34px"},attrs:{disabled:!t.pluginAttrData.attr.setInfo.buttons.import},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.setInfo,"importType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:0}},[t._v("追加导入")]),t._v(" "),a("option",{domProps:{value:1}},[t._v("覆盖导入")])]),a("br"),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.showIndex,expression:"pluginAttrData.attr.setInfo.showIndex"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.showIndex)?t._i(t.pluginAttrData.attr.setInfo.showIndex,!0)>-1:t.pluginAttrData.attr.setInfo.showIndex},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.showIndex,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo,"showIndex",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo,"showIndex",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo,"showIndex",i)},t.dataChange]}}),t._v("自增序号：\n\t\t\t\t\t"),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.indexAssembly,expression:"pluginAttrData.attr.setInfo.indexAssembly"}],staticStyle:{width:"100px"},attrs:{disabled:!t.pluginAttrData.attr.setInfo.showIndex},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.setInfo,"indexAssembly",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.setInfo.indexList,(function(e,n){return a("option",{key:n,domProps:{value:n}},[t._v(t._s(e))])})),0)])]),t._v(" "),a("div",{staticClass:"formitem"},[a("div",{staticClass:"formtitle"},[t._v("添加范围：")]),t._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[t._v("最小行数:"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.minline,expression:"pluginAttrData.attr.setInfo.minline"}],staticStyle:{width:"50px","margin-left":"10px"},attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.setInfo.minline},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo,"minline",e.target.value)},function(e){return t.dataChange()}]}})]),t._v(" "),a("span",{staticStyle:{"margin-left":"28px"}},[t._v("最大行数:"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.maxline,expression:"pluginAttrData.attr.setInfo.maxline"}],staticStyle:{width:"50px","margin-left":"10px"},attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.setInfo.maxline},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo,"maxline",e.target.value)},function(e){return t.dataChange()}]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("div",{staticClass:"formtitle"},[t._v("\n\t\t\t\t\t移动端添加按钮文案："),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.m_addContent,expression:"pluginAttrData.attr.setInfo.m_addContent"}],staticStyle:{width:"138px","margin-left":"10px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.setInfo.m_addContent},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo,"m_addContent",e.target.value)},function(e){return t.dataChange()}]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("pc端每页显示行数：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：不设置或者设置为0，不显示分页，设置分页时不支持数据源行内交互）")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.pageSize,expression:"pluginAttrData.attr.setInfo.pageSize"}],attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.setInfo.pageSize},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo,"pageSize",e.target.value)}}})])])]),t._v(" "),t.pluginAttrData.attr.setInfo.buttons.import?[t._m(0),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(1),t._v(" "),t._l(t.pluginAttrData.attr.setInfo.importBind,(function(e,n){return a("tr",[a("td",{staticClass:"textAlignC"},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.pluginData[n].description)+"\t\t\t\t\t\n\t\t\t\t\t\t")]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.importBind[n],expression:"pluginAttrData.attr.setInfo.importBind[impkey]"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.setInfo.importBind[n]},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo.importBind,n,e.target.value)}}})])])}))],2)])]:t._e(),t._v(" "),t.pluginAttrData.attr.setInfo.buttons.export?[t._m(2),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(3),t._v(" "),t._l(t.pluginAttrData.attr.setInfo.exportBind,(function(e,n){return a("tr",[a("td",{staticClass:"textAlignC"},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.pluginData[n].description)+"\t\t\t\t\t\n\t\t\t\t\t\t")]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.exportBind[n],expression:"pluginAttrData.attr.setInfo.exportBind[impkey]"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.setInfo.exportBind[n]},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo.exportBind,n,e.target.value)}}})])])}))],2)])]:t._e()],2):t._e()},Ja=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定导入列：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：没有绑定列名的列，将不导入数据）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("选中列")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("列名")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定导出列：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：没有绑定列名的列，将不导出数据）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("选中列")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("列名")])])}],Za={name:"dRepeatTable",props:["sendmessage","pluginAttrData","pluginData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},setImportPlugin:function(){var t=this,e={};this.pluginAttrData.attr.data.trs[1].tds.forEach((function(a){if(!a.dataid)return!1;e[a.dataid]=t.pluginAttrData.attr.setInfo.importBind[a.dataid]?t.pluginAttrData.attr.setInfo.importBind[a.dataid]:t.pluginData[a.dataid].description})),this.pluginAttrData.attr.setInfo.importBind=e,this.dataChange()},seteExportPlugin:function(){this.pluginAttrData.attr.setInfo.exportBind={};var t=this,e={};this.pluginAttrData.attr.data.trs[1].tds.forEach((function(a){if(!a.dataid)return!1;e[a.dataid]=t.pluginAttrData.attr.setInfo.exportBind[a.dataid]?t.pluginAttrData.attr.setInfo.exportBind[a.dataid]:t.pluginData[a.dataid].description})),this.pluginAttrData.attr.setInfo.exportBind=e,this.dataChange()},seteIndexPlugin:function(){this.pluginAttrData.attr.setInfo.indexList={};var t=this,e={};this.pluginAttrData.attr.data.trs[1].tds.forEach((function(a){if(!a.dataid)return!1;-1==a.dataid.indexOf("Input")&&-1==a.dataid.indexOf("Integer")&&-1==a.dataid.indexOf("Text")||(e[a.dataid]=t.pluginAttrData.attr.setInfo.indexList[a.dataid]?t.pluginAttrData.attr.setInfo.indexList[a.dataid]:t.pluginData[a.dataid].description)})),this.pluginAttrData.attr.setInfo.indexList=e,this.dataChange()},completionAttr:function(){this.pluginAttrData.attr.setInfo||this.$set(this.pluginAttrData.attr,"setInfo",{buttons:{import:!1,refresh:!1,sort:!1,add:!0,del:!0},importBind:{}}),this.dataChange()}},mounted:function(){this.completionAttr(),this.setImportPlugin(),this.seteExportPlugin(),this.seteIndexPlugin()}},Qa=Za,tn=Object(m["a"])(Qa,Ya,Ja,!1,null,null,null),en=tn.exports,an=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("请求方式：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.types,(function(e){return[t._v("\n                        "+t._s(e.name)+" \n                        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{name:"type",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.type,e.value)},on:{click:t.typeChange,change:[function(a){return t.$set(t.pluginAttrData.attr.data,"type",e.value)},t.attrChange]}}),t._v("\n                          \n                    ")]}))],2)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("允许执行的状态：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-checkbox-group",{on:{change:t.attrChange},model:{value:t.pluginAttrData.attr.data.runStatus,callback:function(e){t.$set(t.pluginAttrData.attr.data,"runStatus",e)},expression:"pluginAttrData.attr.data.runStatus"}},t._l(t.runStatusList,(function(e){return a("el-checkbox",{key:e.value,attrs:{label:e.value}},[t._v("\n                            "+t._s(e.name)+"\n                        ")])})),1)],1)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("交互范围：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.activeTypes,(function(e){return 1!==e.value||1==e.value&&2==t.pluginAttrData.attr.data.type?[t._v("\n                        "+t._s(e.name)+" \n                        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.activeType,expression:"pluginAttrData.attr.data.activeType"}],attrs:{name:"activeType",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.activeType,e.value)},on:{click:t.activeTypeChange,change:[function(a){return t.$set(t.pluginAttrData.attr.data,"activeType",e.value)},t.attrChange]}})]:t._e()}))],2)])]),t._v(" "),1==t.pluginAttrData.attr.data.activeType?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("重复表：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:t.filterPlugins},model:{value:t.pluginAttrData.attr.data.selectRetable,callback:function(e){t.$set(t.pluginAttrData.attr.data,"selectRetable",e)},expression:"pluginAttrData.attr.data.selectRetable"}},t._l(t.pluginData,(function(e){return"dRepeatTable"==e.type?a("el-option",{key:e.key,attrs:{label:t.getPluginName(e),value:e.key}}):t._e()})),1)],1)])]):t._e(),t._v(" "),t._m(0),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(1),t._v(" "),t._l(t.pluginAttrData.attr.data.conditions,(function(e,n){return a("tr",[a("td",{staticClass:"textAlignC"},[a("el-input",{attrs:{size:"mini",placeholder:"默认default"},on:{input:t.attrChange},model:{value:e.key,callback:function(a){t.$set(e,"key",a)},expression:"convalue.key"}})],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"convalue.type"}],on:{change:[function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(e,"type",a.target.multiple?n:n[0])},t.attrChange]}},[a("option",{attrs:{value:""}},[t._v("请选择")]),t._v(" "),t._l(t.paramTypes,(function(e){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])}))],2)]),t._v(" "),a("td",{staticClass:"textAlignC"},[0===e.type?a("el-input",{attrs:{size:"mini",placeholder:"参数值"},on:{input:t.attrChange},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"convalue.value"}}):a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:t.attrChange},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"convalue.value"}},t._l(t.canPlugins,(function(e){return t.fictitiousPlugins.includes(e.key)?t._e():a("el-option",{key:e.key,attrs:{label:t.getPluginName(e),value:e.key}})})),1)],1),t._v(" "),a("td",{},[a("span",{on:{click:function(e){return t.deleteCon(n)}}},[t._v("删除")])])])})),t._v(" "),a("tr",[a("td",{attrs:{colspan:"4"}},[a("span",{on:{click:t.addCon}},[t._v("新增")])])])],2)]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("结果控件：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:function(e){return t.resultKeyChange()}},model:{value:t.pluginAttrData.attr.data.resultKey,callback:function(e){t.$set(t.pluginAttrData.attr.data,"resultKey",e)},expression:"pluginAttrData.attr.data.resultKey"}},t._l(t.canPlugins,(function(e){return a("el-option",{key:e.key,attrs:{label:t.getPluginName(e),value:e.key}})})),1)],1)])]),t._v(" "),t.pluginAttrData.attr.data.resultKey?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定属性：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.targetColumn,expression:"pluginAttrData.attr.data.targetColumn"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"targetColumn",e.target.multiple?a:a[0])},t.attrChange]}},t._l(t.columns,(function(e){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])})),0)])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("数据源2：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:function(e){return t.sourceChange()}},model:{value:t.pluginAttrData.attr.data.sourceid,callback:function(e){t.$set(t.pluginAttrData.attr.data,"sourceid",e)},expression:"pluginAttrData.attr.data.sourceid"}},t._l(t.canSourceList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)])])]:t._e(),t._v(" "),t.configIsShow()?[t._m(2),t._v(" "),t._l(t.configList,(function(e,n){return[a("li",{staticClass:"plugin-item select-tablebox"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v(t._s(e.name)+"：")]),t._v(" "),a("div",{staticClass:"formradio"},["select"==e.type?a("div",{staticClass:"configrow"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.configChange},model:{value:t.pluginAttrData.attr.data.sourceConfig[n].value,callback:function(e){t.$set(t.pluginAttrData.attr.data.sourceConfig[n],"value",e)},expression:"pluginAttrData.attr.data.sourceConfig[ckey].value"}},t._l(e.values,(function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1):t._e()])])])]}))]:t._e(),t._v(" "),t.mapConfigIsShow()?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("数据绑定到列：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("\n                    (注意：没有绑定列名的列，将不写入数据，"),a("span",{staticClass:"redColor"},[t._v("如果列名出现“组件消失”字样，请点击下方按钮刷新绑定，并保存当前表单。")]),t._v("）\n                    "),a("br"),t._v(" "),a("span",{staticClass:"redColor"},[t._v("\n                        2、下拉、单选、多选补充设置，先设置属性，后设置组件data。\n                    ")]),t._v(" "),a("br"),t._v(" "),a("br"),t._v(" "),a("span",{staticClass:"redColor toCursor",on:{click:t.refreshPluginMap}},[t._v("\n                        点击刷新绑定\n                    ")])])])]),t._v(" "),-1!==t.pluginAttrData.attr.data.resultKey.indexOf("RepeatTable")?a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(3),t._v(" "),t._l(t.pluginAttrData.attr.data.mapConfig,(function(e,n){return a("tr",[a("td",{staticClass:"textAlignC"},[t.pluginData[n]?a("span",[t._v("\n                                "+t._s(t.pluginData[n].description)+"\n                            ")]):a("span",{staticClass:"redColor"},[t._v("\n                                组件消失\n                            ")])]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.mapConfig[n],expression:"pluginAttrData.attr.data.mapConfig[mapkey]"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data.mapConfig,n,e.target.multiple?a:a[0])},t.attrChange]}},[a("option",{attrs:{value:""}},[t._v("请选择")]),t._v(" "),t._l(t.mapConfig,(function(e){return a("option",{domProps:{value:e.key}},[t._v(t._s(e.value))])}))],2)])])}))],2)]):a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(4),t._v(" "),t._l(t.pluginAttrData.attr.data.mapConfig,(function(e,n){return[a("tr",[a("td",{staticClass:"textAlignC"},[t.pluginData[n]?a("span",[t._v("\n                                    "+t._s(t.getPluginName(t.pluginData[n]))+"\n                                ")]):a("span",{staticClass:"redColor"},[t._v("\n                                    组件消失\n                                ")])]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.attrChange},model:{value:e.key,callback:function(a){t.$set(e,"key",a)},expression:"mapConfigOne.key"}},t._l(t.mapConfig,(function(t){return a("el-option",{key:t.key,attrs:{label:t.value,value:t.key}})})),1)],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.attrChange},model:{value:e.targetColumn,callback:function(a){t.$set(e,"targetColumn",a)},expression:"mapConfigOne.targetColumn"}},[a("el-option",{key:"",attrs:{label:"继承全局设置",value:""}}),t._v(" "),t._l(t.columns,(function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})}))],2)],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("span",{on:{click:function(e){return t.delMapConfig(n)}}},[t._v("删除")]),t._v(" "),t.isSetTow(n)?a("span",{staticClass:"redColor",on:{click:function(e){return t.addOtherMap(n)}}},[t._v("补充")]):t._e()])]),t._v(" "),void 0!==e.twoKey?a("tr",[t._m(5,!0),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.attrChange},model:{value:e.twoKey,callback:function(a){t.$set(e,"twoKey",a)},expression:"mapConfigOne.twoKey"}},t._l(t.mapConfig,(function(t){return a("el-option",{key:t.key,attrs:{label:t.value,value:t.key}})})),1)],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.attrChange},model:{value:e.twoTargetColumn,callback:function(a){t.$set(e,"twoTargetColumn",a)},expression:"mapConfigOne.twoTargetColumn"}},[a("el-option",{key:"",attrs:{label:"继承全局设置",value:""}}),t._v(" "),t._l(t.columns,(function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})}))],2)],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("span",{staticClass:"redColor",on:{click:function(e){return t.delOtherMap(n)}}},[t._v("删除补充")])])]):t._e(),t._v(" "),-1!==n.indexOf("RepeatTable")&&e.key?a("tr",[a("td",{attrs:{colspan:"4"}},[a("table",{staticClass:"select-table select-rtable"},[t._m(6,!0),t._v(" "),t._l(t.pluginAttrData.attr.data.mapConfig[n].childrens,(function(i,r){return[a("tr",[a("td",{staticClass:"textAlignC"},[t.pluginData[r]?a("span",[t._v("\n                                                    "+t._s(t.pluginData[r].description)+"\n                                                ")]):a("span",{staticClass:"redColor"},[t._v("\n                                                    组件消失\n                                                ")])]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.attrChange},model:{value:i.key,callback:function(e){t.$set(i,"key",e)},expression:"cMapConfigOne.key"}},t._l(t.getChildMap(e.key),(function(t){return a("el-option",{key:t.key,attrs:{label:t.value,value:t.key}})})),1)],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.attrChange},model:{value:i.targetColumn,callback:function(e){t.$set(i,"targetColumn",e)},expression:"cMapConfigOne.targetColumn"}},[a("el-option",{key:"",attrs:{label:"继承全局设置",value:""}}),t._v(" "),t._l(t.columns,(function(e){return 2!==e.value?a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}}):t._e()}))],2)],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("span",{on:{click:function(e){return t.delMapConfig(r,n)}}},[t._v("删除")])])])]})),t._v(" "),a("tr",[a("td",{attrs:{colspan:"2"}},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},model:{value:t.selectCPluginKey,callback:function(e){t.selectCPluginKey=e},expression:"selectCPluginKey"}},t._l(t.pluginData,(function(e){return e.pkey!=n||["dOneInput","dmultiText"].includes(e.type)?t._e():a("el-option",{key:e.key,attrs:{label:t.getPluginName(e),value:e.key}})})),1)],1),t._v(" "),a("td",{attrs:{colspan:"2"}},[a("span",{on:{click:function(e){return t.addMapConfig(n)}}},[t._v("新增")])])])],2)])]):t._e()]})),t._v(" "),a("tr",[a("td",{attrs:{colspan:"2"}},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},model:{value:t.selectPluginKey,callback:function(e){t.selectPluginKey=e},expression:"selectPluginKey"}},t._l(t.canPlugins,(function(e){return t.pluginAttrData.attr.data.mapConfig[e.key]||t.fictitiousPlugins.includes(e.key)?t._e():a("el-option",{key:e.key,attrs:{label:t.getPluginName(e),value:e.key}})})),1)],1),t._v(" "),a("td",{attrs:{colspan:"2"}},[a("span",{on:{click:function(e){return t.addMapConfig("")}}},[t._v("新增")])])])],2)])]:t._e()],2):t._e()},nn=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("条件控件："),a("span",{staticClass:"desc"},[t._v("（默认为参数名为default）")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("参数名")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("参数类型")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("参数值")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("配置项："),a("span",{staticClass:"desc"},[t._v("（根据业务需求选择不同的选项）")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("列组件名")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("数据字段名")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("组件")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("字段")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("属性")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{staticClass:"textAlignC"},[a("span",[t._v(" ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("组件")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("字段")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("属性")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])}],rn={name:"ddatasourceattr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{paramTypes:[{name:"自定义",value:0},{name:"组件",value:1}],types:[{name:"静默",value:1},{name:"触发",value:2}],activeTypes:[{name:"其他",value:0},{name:"重复表内部交互",value:1}],columns:[{name:"组件data",value:1},{name:"单选、多选、下拉选项列表",value:2}],runStatusList:[{name:"表单初始加载时",value:1},{name:"表单初始加载完成时",value:2},{name:"上次填报加载完成时",value:3}],sourceList:[],canSourceList:[],configList:{},canPlugins:[],mapConfig:[],fictitiousPlugins:["autoplugin","setplugin","setrplugin"],autoplugin:{key:"autoplugin",description:"自动绑定组件",type:"dAutoplugin"},setplugin:{key:"setplugin",description:"手动绑定组件",type:"dSetplugin"},setrplugin:{key:"setrplugin",description:"重复表行内交互",type:"dSetRplugin"},selectPluginKey:"",selectCPluginKey:""}},watch:{"pluginAttrData.key":function(){this.changePlugin()},pluginData:function(){this.filterPlugins()}},methods:{isSetTow:function(t){return["Select","Radio","Checkbox","SelectV2"].includes(t.split("_")[0])},addOtherMap:function(t,e){t&&(e?(this.pluginAttrData.attr.data.mapConfig[t].childrens[e].twoKey="",this.pluginAttrData.attr.data.mapConfig[t].childrens[e].twoTargetColumn=""):(this.pluginAttrData.attr.data.mapConfig[t].twoKey="",this.pluginAttrData.attr.data.mapConfig[t].twoTargetColumn=""),this.$set(this.pluginAttrData.attr.data.mapConfig,t,this.appCommonH.copyObj(this.pluginAttrData.attr.data.mapConfig[t])),this.attrChange())},delOtherMap:function(t,e){t&&(e?(this.$delete(this.pluginAttrData.attr.data.mapConfig[t].childrens[e],"twoKey"),this.$delete(this.pluginAttrData.attr.data.mapConfig[t].childrens[e],"twoTargetColumn")):(this.$delete(this.pluginAttrData.attr.data.mapConfig[t],"twoKey",""),this.$delete(this.pluginAttrData.attr.data.mapConfig[t],"twoTargetColumn","")))},addMapConfig:function(t){var e={key:"",targetColumn:""};t?this.$set(this.pluginAttrData.attr.data.mapConfig[t].childrens,this.selectCPluginKey,this.appCommonH.copyObj(e)):(this.$set(this.pluginAttrData.attr.data.mapConfig,this.selectPluginKey,this.appCommonH.copyObj(e)),-1!==this.selectPluginKey.indexOf("RepeatTable")&&this.$set(this.pluginAttrData.attr.data.mapConfig[this.selectPluginKey],"childrens",{})),this.selectPluginKey="",this.selectCPluginKey="",this.attrChange()},delMapConfig:function(t,e){e?this.$delete(this.pluginAttrData.attr.data.mapConfig[e].childrens,t):this.$delete(this.pluginAttrData.attr.data.mapConfig,t),this.attrChange()},getPluginName:function(t){var e="";return t.pkey?(this.pluginData[t.pkey]&&(e+=this.pluginData[t.pkey].description),e+="."+t.description):e=t.description,e},deleteCon:function(t){this.pluginAttrData.attr.data.conditions.splice(t,1)},addCon:function(){this.pluginAttrData.attr.data.conditions.push({key:"",type:1,value:""})},getDataSourceList:function(){var t=this;this.appFetch({url:"getDataSourceList",method:"get"},(function(e){0==e.e?(t.sourceList=e.d,t.changePlugin()):console.error("获取数据源列表失败")}),(function(){console.error("获取数据源列表失败")}))},changePlugin:function(){this.filterSources(),this.filterConfig(),this.getMapByConfig()},typeChange:function(){this.$set(this.pluginAttrData.attr.data,"activeType",0),this.filterPlugins(),this.resetInfo()},activeTypeChange:function(t){1==this.pluginAttrData.attr.data.activeType&&(this.canPlugins=[]),this.resetInfo()},resetInfo:function(){this.$set(this.pluginAttrData.attr.data,"selectRetable",""),this.$set(this.pluginAttrData.attr.data,"sourceid",""),this.$set(this.pluginAttrData.attr.data,"sourceConfig",{}),this.$set(this.pluginAttrData.attr.data,"conditions",[]),this.$set(this.pluginAttrData.attr.data,"resultKey",""),this.$set(this.pluginAttrData.attr.data,"targetColumn",1),this.$set(this.pluginAttrData.attr.data,"mapConfig",{}),this.selectPluginKey="",this.selectCPluginKey="",this.canSourceList=[],this.configList={},this.attrChange()},resultKeyChange:function(){this.filterSources(),this.pluginAttrData.attr.data.sourceid="",this.pluginAttrData.attr.data.targetColumn=1,this.pluginAttrData.attr.data.sourceConfig={},this.pluginAttrData.attr.data.mapConfig={},this.configList={},this.mapConfig=[],this.attrChange()},sourceChange:function(){this.configList={},this.mapConfig=[],this.pluginAttrData.attr.data.sourceConfig={},this.pluginAttrData.attr.data.mapConfig={},this.filterConfig(),this.resetConfigSet(),this.resetPluginMap(),this.getMapByConfig(),this.attrChange()},configChange:function(){this.getMapByConfig(),this.resetPluginMap(),this.attrChange()},getMapByConfig:function(){var t={},e=this;if(this.fictitiousPlugins.includes(this.pluginAttrData.attr.data.resultKey)||-1!==this.pluginAttrData.attr.data.resultKey.indexOf("RepeatTable")){var a=this.pluginAttrData.attr.data.sourceConfig,n={id:this.pluginAttrData.attr.data.sourceid,configure:{}};if(!$.isEmptyObject(a))for(var i in a){if(a[i].required&&!a[i].value)return!1;a[i].value&&(n.configure[i]=a[i].value)}return this.appFetch({url:"getColumnMap",method:"POST",data:n},(function(t){0==t.e?e.mapConfig=t.d:console.error("获取数据源字典失败")}),(function(){console.error("获取数据源字典失败")})),!1}this.mapConfig=t},getChildMap:function(t){var e=this.mapConfig.filter((function(e){return e.key==t&&e.children}));return e.length?e[0].children:[]},filterPlugins:function(){var t=[],e=this;if(this.pluginAttrData.attr.data.selectRetable)for(var a in t=[this.setrplugin],this.pluginData){var n=this.pluginData[a];n.pkey!=this.pluginAttrData.attr.data.selectRetable||["dOneInput","dmultiText"].includes(n.type)||t.push(n)}else for(var a in this.fictitiousPlugins.forEach((function(a){e[a]&&t.push(e[a])})),this.pluginData){n=this.pluginData[a];n.pkey||n.classtype&&"dVariate"!=n.type||["dOneInput","dmultiText"].includes(n.type)||t.push(n)}this.canPlugins=t},filterSources:function(){var t=[];if(this.pluginAttrData.attr.data.resultKey){var e=this.pluginData[this.pluginAttrData.attr.data.resultKey];this.fictitiousPlugins.includes(this.pluginAttrData.attr.data.resultKey)&&(e=this[this.pluginAttrData.attr.data.resultKey]),e&&this.sourceList.forEach((function(a){a.componentType.includes(e.type)&&t.push(a)}))}this.canSourceList=t},filterConfig:function(){var t={};if(this.pluginAttrData.attr.data.sourceid)for(var e in this.canSourceList)this.canSourceList[e].id==this.pluginAttrData.attr.data.sourceid&&(t=this.canSourceList[e].configure);this.configList=t},resetConfigSet:function(){var t={};for(var e in this.configList)t[e]={value:"",required:this.configList[e].require};this.pluginAttrData.attr.data.sourceConfig=t},resetPluginMap:function(){var t={};if(-1!==this.pluginAttrData.attr.data.resultKey.indexOf("RepeatTable")){var e=this.pluginData[this.pluginAttrData.attr.data.resultKey],a=e.attr.data.tableData?e.attr.data.tableData:e.attr.data;a.trs[1].tds.forEach((function(e){if(!e.dataid)return!1;t[e.dataid]=""}))}this.pluginAttrData.attr.data.mapConfig=t,this.attrChange()},refreshPluginMap:function(){var t={},e=this.pluginAttrData.attr.data.mapConfig;if(-1!==this.pluginAttrData.attr.data.resultKey.indexOf("RepeatTable")){var a=this.pluginData[this.pluginAttrData.attr.data.resultKey],n=a.attr.data.tableData?a.attr.data.tableData:a.attr.data;n.trs[1].tds.forEach((function(a){if(!a.dataid)return!1;t[a.dataid]=e[a.dataid]?e[a.dataid]:""}))}this.pluginAttrData.attr.data.mapConfig=t,this.attrChange()},mapConfigIsShow:function(){return!$.isEmptyObject(this.mapConfig)},configIsShow:function(){return!$.isEmptyObject(this.configList)},attrChange:function(){this.$emit("sendmessage",this.pluginAttrData)}},mounted:function(){this.getDataSourceList(),this.filterPlugins()}},sn=rn,on=Object(m["a"])(sn,an,nn,!1,null,null,null),ln=on.exports,un=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("按钮名称：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.buttonName,expression:"pluginAttrData.attr.data.buttonName"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.buttonName},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"buttonName",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("使用方式：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.types,(function(e){return[t._v("\n                    "+t._s(e.name)+" \n                    "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{name:"type",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.type,e.value)},on:{click:t.dataChange,change:function(a){return t.$set(t.pluginAttrData.attr.data,"type",e.value)}}}),t._v("\n                      \n                ")]}))],2)])]),t._v(" "),0==t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("目标组件：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{size:"mini",filterable:"",placeholder:"请选择"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.targetPlugin,callback:function(e){t.$set(t.pluginAttrData.attr.data,"targetPlugin",e)},expression:"pluginAttrData.attr.data.targetPlugin"}},t._l(t.pluginData,(function(e){return t.isShow(e)?a("el-option",{key:e.key,attrs:{label:e.description,value:e.key}}):t._e()})),1)],1)])]):t._e(),t._v(" "),1==t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("data中用作显示的字段：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.nameColumn,expression:"pluginAttrData.attr.data.nameColumn",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.nameColumn},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"nameColumn",e.target.value.trim())},t.dataChange],blur:function(e){return t.$forceUpdate()}}})])])]):t._e()]):t._e()},dn=[],cn={name:"dSyncattr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{types:[{name:"数据同步",value:0},{name:"数据占位",value:1}]}},methods:{dataChange:function(t){this.$emit("sendmessage",this.pluginAttrData)},isShow:function(t){var e=["dShow"];return!(t.pkey||t.classtype||!e.includes(t.type))}}},pn=cn,hn=Object(m["a"])(pn,un,dn,!1,null,null,null),gn=hn.exports,fn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div")},mn=[],vn={name:"dShowattr",props:["sendmessage","pluginAttrData"],methods:{dataChange:function(t){this.$emit("sendmessage",this.pluginAttrData)}}},bn=vn,yn=Object(m["a"])(bn,fn,mn,!1,null,null,null),_n=yn.exports,Dn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("方式：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          "+t._s(t.types[1].name)+" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{name:"type",type:"radio"},domProps:{value:t.types[1].value,checked:t._q(t.pluginAttrData.attr.data.type,t.types[1].value)},on:{click:t.typeChange,change:function(e){return t.$set(t.pluginAttrData.attr.data,"type",t.types[1].value)}}})]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          "+t._s(t.types[0].name)+" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{name:"type",type:"radio"},domProps:{value:t.types[0].value,checked:t._q(t.pluginAttrData.attr.data.type,t.types[0].value)},on:{click:t.typeChange,change:function(e){return t.$set(t.pluginAttrData.attr.data,"type",t.types[0].value)}}})]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          "+t._s(t.types[2].name)+" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{name:"type",type:"radio"},domProps:{value:t.types[2].value,checked:t._q(t.pluginAttrData.attr.data.type,t.types[2].value)},on:{click:t.typeChange,change:function(e){return t.$set(t.pluginAttrData.attr.data,"type",t.types[2].value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("报错级别：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          "+t._s(t.errorLevels[0].name)+" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.errorlevel,expression:"pluginAttrData.attr.data.errorlevel"}],attrs:{name:"errorlevel",type:"radio"},domProps:{value:t.errorLevels[0].value,checked:t._q(t.pluginAttrData.attr.data.errorlevel,t.errorLevels[0].value)},on:{click:t.typeChange,change:function(e){return t.$set(t.pluginAttrData.attr.data,"errorlevel",t.errorLevels[0].value)}}})]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          "+t._s(t.errorLevels[1].name)+" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.errorlevel,expression:"pluginAttrData.attr.data.errorlevel"}],attrs:{name:"errorlevel",type:"radio"},domProps:{value:t.errorLevels[1].value,checked:t._q(t.pluginAttrData.attr.data.errorlevel,t.errorLevels[1].value)},on:{click:t.typeChange,change:function(e){return t.$set(t.pluginAttrData.attr.data,"errorlevel",t.errorLevels[1].value)}}})])])]),t._v(" "),1==t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("验证格式：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.method,callback:function(e){t.$set(t.pluginAttrData.attr.data,"method",e)},expression:"pluginAttrData.attr.data.method"}},t._l(t.regulars,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)])]):t._e(),t._v(" "),1==t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("条件控件：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.validateKey,callback:function(e){t.$set(t.pluginAttrData.attr.data,"validateKey",e)},expression:"pluginAttrData.attr.data.validateKey"}},t._l(t.canPlugins,(function(t){return a("el-option",{key:t.key,attrs:{label:t.description,value:t.key}})})),1)],1)])]):t._e(),t._v(" "),2==t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("设置公式：")]),t._v(" "),a("div",{staticClass:"formarea",on:{click:t.openDialog}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.rule,expression:"pluginAttrData.attr.data.rule"}],attrs:{disabled:""},domProps:{value:t.pluginAttrData.attr.data.rule},on:{input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"rule",e.target.value)}}})]),t._v(" "),a("el-dialog",{attrs:{title:"计算设置",visible:t.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showDialog=e},close:t.closeDialog}},[t.pluginAttrData?a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"组件列表"}},[t._l(t.pluginData,(function(e){return e.pkey||1==e.classtype&&"dVariate"!=e.type||["MultiText","dOneInput"].includes(e.type)?t._e():[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertPlugin("plugin",e.key)}}},[t._v(t._s(e.description))]),t._v(" \n              ")]}))],2),t._v(" "),a("el-form-item",{attrs:{label:"转化方法"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.functionStr,expression:"functionStr"}],attrs:{cols:"80",rows:"5"},domProps:{value:t.functionStr},on:{input:function(e){e.target.composing||(t.functionStr=e.target.value)}}}),t._v(" "),a("p",[t._v("此处自定义用于复杂转化的方法，在规则处调用，规则处调用方式如下$selfFunction(组件1的值, 组件2的值)，参数个数根据实际情况设置")])]),t._v(" "),a("el-form-item",{attrs:{label:"当前公式"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.rule,expression:"rule"}],attrs:{cols:"80",rows:"5"},domProps:{value:t.rule},on:{mouseup:t.updateStartX,keyup:t.updateStartX,input:function(e){e.target.composing||(t.rule=e.target.value)}}})]),t._v(" "),a("el-form-item",{attrs:{label:"方法列表"}},[t._l(t.methods,(function(e){return[a("el-tooltip",{key:e.methodName,staticClass:"item",attrs:{effect:"dark",content:e.description,placement:"top"}},[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertFunc("func",e.methodName)}}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])]),t._v("\n                 \n              ")]}))],2)],1):t._e(),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.okDialog}},[t._v("确 定")])],1)],1)],1)]):t._e(),t._v(" "),3==t.pluginAttrData.attr.data.type?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("接口：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.apiChange},model:{value:t.pluginAttrData.attr.data.apiId,callback:function(e){t.$set(t.pluginAttrData.attr.data,"apiId",e)},expression:"pluginAttrData.attr.data.apiId"}},t._l(t.apiList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)])]),t._v(" "),t.nowApi.id?[t.nowApi.configures.length?a("li",{staticClass:"plugin-item"},[t._m(0)]):t._e(),t._v(" "),t.nowApi.configures.length?a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(1),t._v(" "),t._l(t.nowApi.configures,(function(e){return a("tr",[a("td",{staticClass:"textAlignC"},[a("span",[t._v("\n                  "+t._s(e.name)+"\n                ")])]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.apiParams[e.key],callback:function(a){t.$set(t.pluginAttrData.attr.data.apiParams,e.key,a)},expression:"pluginAttrData.attr.data.apiParams[config.key]"}},t._l(t.pluginData,(function(e){return e.pkey||e.classtype||["dOneInput","dmultiText"].includes(e.type)?t._e():a("el-option",{key:e.key,attrs:{label:e.description,value:e.key}})})),1)],1)])}))],2)]):t._e()]:t._e()]:t._e(),t._v(" "),3!=t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("提示信息：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.alert,expression:"pluginAttrData.attr.data.alert"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.alert},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"alert",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"desc"},[t._v("（可以是纯文字，也可以是html）")])])]):t._e()],2):t._e()},Cn=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定组件到参数：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("\n              (注意：绑定的组件将作为参数值传递给接口）\n            ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("参数名")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("组件")])])}],wn=a("eead"),xn={name:"dValidate",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{types:[{name:"固定格式验证",value:1},{name:"公式验证",value:2},{name:"接口验证",value:3}],errorLevels:[{name:"错误",value:0},{name:"警告",value:1}],showDialog:!1,rule:"",functionStr:"",startX:0,methods:[],regulars:[],canPlugins:[],apiList:[]}},watch:{pluginData:function(){this.filterPlugins()}},computed:{nowApi:function(){var t={},e=this;return this.apiList.length&&this.apiList.forEach((function(a){a.id==e.pluginAttrData.attr.data.apiId&&(t=a)})),t}},methods:{typeChange:function(){switch(this.pluginAttrData.attr.data.alert="",this.pluginAttrData.attr.data.type){case 1:this.pluginAttrData.attr.data.rule="",this.pluginAttrData.attr.data.keyval={},this.pluginAttrData.attr.data.apiParams={},this.pluginAttrData.attr.data.apiId="";break;case 2:this.pluginAttrData.attr.data.method="",this.pluginAttrData.attr.data.validateKey="",this.pluginAttrData.attr.data.apiParams={},this.pluginAttrData.attr.data.apiId="";break;case 3:this.pluginAttrData.attr.data.method="",this.pluginAttrData.attr.data.validateKey="",this.pluginAttrData.attr.data.rule="",this.pluginAttrData.attr.data.keyval={};break}},dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},openDialog:function(){this.showDialog=!0,this.rule=this.pluginAttrData.attr.data.rule,this.functionStr=this.pluginAttrData.attr.data.functionStr},closeDialog:function(){this.showDialog=!1},okDialog:function(){var t=_a["a"].checkFormula(this.rule,this.pluginAttrData.attr.data.keyval);if(t)return this.$message({message:"公式错误，存在无用变量或方法:"+t,type:"error"}),!1;this.showDialog=!1,this.pluginAttrData.attr.data.rule=this.rule,this.pluginAttrData.attr.data.functionStr=this.functionStr,this.dataChange()},insertPlugin:function(t,e,a){var n=_a["a"].getStrByKey(e,"plugin");this.pluginAttrData.attr.data.keyval[n]={type:t,key:e,pkey:a,evalVar:"_this.keyVal."+e+"Data"},this.updateNowRule(n)},insertFunc:function(t,e){var a=_a["a"].getStrByKey(e,"func");this.pluginAttrData.attr.data.keyval[_a["a"].getStrByKey(e,"func")]={type:t,key:e,evalMethod:"_this."+e},this.updateNowRule(a)},updateStartX:function(t){this.startX=t.target.selectionStart},updateNowRule:function(t){var e=this.rule.substring(0,this.startX),a=this.rule.substring(this.startX);this.rule=e+t+a},addMethods:function(){this.methods=_a["a"].methods},filterPlugins:function(){var t=[];for(var e in this.pluginData){var a=this.pluginData[e];a.pkey||a.classtype||["dOneInput","dmultiText"].includes(a.type)||t.push(a)}this.canPlugins=t},getApiList:function(){var t=this;this.appFetch({url:"getvalidatorList",method:"get"},(function(e){0==e.e?t.apiList=e.d.list:console.error("获取验证列表失败")}),(function(){console.error("获取验证列表失败")}))},apiChange:function(){this.initApiParams(),this.dataChange()},initApiParams:function(){var t={},e=this.pluginAttrData.attr.data.apiParams;this.pluginAttrData.attr.data.apiId&&this.nowApi.configures&&this.nowApi.configures.forEach((function(a){t[a.key]=e[a.key]?e[a.key]:""})),this.pluginAttrData.attr.data.apiParams=t}},mounted:function(){this.getApiList(),this.addMethods(),this.filterPlugins(),this.regulars=wn["a"].regulars}},kn=xn,Sn=Object(m["a"])(kn,Dn,Cn,!1,null,null,null),An=Sn.exports,En=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("数据来源：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n                    接口提供 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.defaultOrApi,expression:"pluginAttrData.attr.data.defaultOrApi"}],attrs:{value:"1",name:"defaultOrApi",type:"radio"},domProps:{checked:t._q(t.pluginAttrData.attr.data.defaultOrApi,"1")},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"defaultOrApi","1")},t.sourceChange]}}),t._v("\n                      \n                    本地编辑 "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.defaultOrApi,expression:"pluginAttrData.attr.data.defaultOrApi"}],attrs:{value:"2",name:"defaultOrApi",type:"radio"},domProps:{checked:t._q(t.pluginAttrData.attr.data.defaultOrApi,"2")},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"defaultOrApi","2")},t.sourceChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("显示时机：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.types,(function(e,n){return t.isShowType(e.value)?[a("span",[t._v(t._s(e.name))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{name:"type",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.type,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"type",e.value)},t.typeChange]}}),t._v(" "),n!==t.types.length-1?[t._v(" ")]:t._e()]:t._e()}))],2)])]),t._v(" "),"1"==t.pluginAttrData.attr.data.defaultOrApi?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("接口：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.apiChange},model:{value:t.pluginAttrData.attr.data.apiId,callback:function(e){t.$set(t.pluginAttrData.attr.data,"apiId",e)},expression:"pluginAttrData.attr.data.apiId"}},t._l(t.apiList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)])]),t._v(" "),t.nowApi.id?[t.nowApi.data.length?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("提示变量列表：")]),t._v(" "),a("div",{staticClass:"desc"},[t._l(t.nowApi.data,(function(e){return a("p",[t._v(t._s(e.name)+"：$"+t._s(e.key))])})),t._v(" "),a("p",{staticClass:"redColor"},[t._v("示例：如填写提示内容为”这是一个提示内容$var1“，变量$var1值为1，最终提示为”这是一个提示内容1“")])],2)])]):t._e(),t._v(" "),t.nowApi.arguments.length?a("li",{staticClass:"plugin-item"},[t._m(0)]):t._e(),t._v(" "),t.nowApi.arguments.length?a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(1),t._v(" "),t._l(t.nowApi.arguments,(function(e){return a("tr",[a("td",{staticClass:"textAlignC"},[a("span",[t._v("\n                                    "+t._s(e.name)+"\n                                ")])]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.apiParams[e.key].type,expression:"pluginAttrData.attr.data.apiParams[argument.key].type"}],on:{change:[function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data.apiParams[e.key],"type",a.target.multiple?n:n[0])},t.attrChange]}},t._l(t.paramTypes,(function(e){return a("option",{domProps:{value:e.value}},[t._v(t._s(e.name))])})),0)]),t._v(" "),a("td",{staticClass:"textAlignC"},[1===t.pluginAttrData.attr.data.apiParams[e.key].type?a("el-input",{attrs:{size:"mini",placeholder:"参数值"},on:{input:t.attrChange},model:{value:t.pluginAttrData.attr.data.apiParams[e.key].value,callback:function(a){t.$set(t.pluginAttrData.attr.data.apiParams[e.key],"value",a)},expression:"pluginAttrData.attr.data.apiParams[argument.key].value"}}):a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:t.attrChange},model:{value:t.pluginAttrData.attr.data.apiParams[e.key].value,callback:function(a){t.$set(t.pluginAttrData.attr.data.apiParams[e.key],"value",a)},expression:"pluginAttrData.attr.data.apiParams[argument.key].value"}},t._l(t.pluginData,(function(e){return e.classtype||["dOneInput","dmultiText"].includes(e.type)?t._e():a("el-option",{key:e.key,attrs:{label:t.getDesc(e),value:e.key}})})),1)],1)])}))],2)]):t._e()]:t._e()]:[3!=t.pluginAttrData.attr.data.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("错误类型：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.errorTypes,(function(e){return[a("span",[t._v(t._s(e.name))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.errorType,expression:"pluginAttrData.attr.data.errorType"}],attrs:{name:"errorType",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.errorType,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"errorType",e.value)},t.errorChange]}}),t._v("\n                                                         \n                        ")]}))],2)])]):t._e()],t._v(" "),3!=t.pluginAttrData.attr.data.type&&"alert"!=t.pluginAttrData.attr.data.errorType?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("按钮跳转：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.butSkip,(function(e,n){return[a("span",[t._v(t._s(e.name))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.skipValue,expression:"pluginAttrData.attr.data.skipValue"}],attrs:{name:"skipType",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.skipValue,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"skipValue",e.value)},t.skipChange]}})]}))],2)]),t._v(" "),1==t.pluginAttrData.attr.data.skipValue?a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("地址：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.urlSite,expression:"pluginAttrData.attr.data.urlSite"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.urlSite},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"urlSite",e.target.value)},t.attrChange]}})])]):t._e()])]:t._e(),t._v(" "),4==t.pluginAttrData.attr.data.type?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("设置：")]),t._v(" "),a("div",{staticClass:"formarea",on:{click:t.openDialog}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.condition,expression:"pluginAttrData.attr.data.condition"}],attrs:{disabled:""},domProps:{value:t.pluginAttrData.attr.data.condition},on:{input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"condition",e.target.value)}}})])])]),t._v(" "),a("el-dialog",{attrs:{title:"条件设置",visible:t.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showDialog=e},close:t.closeDialog}},[t.pluginAttrData?a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"组件列表"}},[t._l(t.pluginData,(function(e){return e.pkey||"dRepeatTable"==e.type||e.key==t.pluginAttrData.key?t._e():[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertPlugin("plugin",e.key)}}},[t._v("\n                                "+t._s(e.description)+"\n                            ")]),t._v("\n                             \n                        ")]}))],2),t._v(" "),a("el-form-item",{attrs:{label:"当前公式"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.condition,expression:"condition"}],attrs:{cols:"80",rows:"5"},domProps:{value:t.condition},on:{mouseup:t.updateStartX,keyup:t.updateStartX,input:function(e){e.target.composing||(t.condition=e.target.value)}}})]),t._v(" "),a("el-form-item",{attrs:{label:"方法列表"}},[t._l(t.pluginAttrData.attr.data.methods,(function(e){return[a("el-tooltip",{key:e.methodName,staticClass:"item",attrs:{effect:"dark",content:e.description,placement:"top"}},[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertFunc("func",e.methodName)}}},[t._v("\n                                    "+t._s(e.name)+"\n                                ")])]),t._v("\n                                                               \n                        ")]}))],2)],1):t._e(),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.okDialog}},[t._v("确 定")])],1)],1)]:t._e(),t._v(" "),3==t.pluginAttrData.attr.data.type?[t._m(2),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(3),t._v(" "),t._l(t.pluginAttrData.attr.data.pluginAlerts,(function(e){return a("tr",[a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:t.attrChange},model:{value:e.key,callback:function(a){t.$set(e,"key",a)},expression:"pluginOne.key"}},t._l(t.pluginData,(function(e){return["dInput","dmultiInputs","dNumericInput","dIntegerInput","dSelect","dSelectV2"].includes(e.type)?a("el-option",{key:e.key,attrs:{label:t.getPluginName(e),value:e.key}}):t._e()})),1)],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-input",{attrs:{size:"mini",placeholder:"提示信息"},on:{input:t.attrChange},model:{value:e.msg,callback:function(a){t.$set(e,"msg",a)},expression:"pluginOne.msg"}})],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("span",{on:{click:t.delPlugin}},[t._v("删除")])])])})),t._v(" "),a("tr",[a("td",{attrs:{colspan:"3"}},[a("span",{on:{click:t.addPlugin}},[t._v("新增")])])])],2)])]:[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("'继续填写'按钮文案：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.btn,expression:"pluginAttrData.attr.data.btn"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.btn},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"btn",e.target.value)},t.attrChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("提示标题：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.alertTitle,expression:"pluginAttrData.attr.data.alertTitle"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.alertTitle},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"alertTitle",e.target.value)},t.attrChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("提示内容：")]),t._v(" "),a("div",{staticClass:"formarea"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.alertContent,expression:"pluginAttrData.attr.data.alertContent"}],domProps:{value:t.pluginAttrData.attr.data.alertContent},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"alertContent",e.target.value)},t.attrChange]}})])])])],t._v(" "),t.affirmIf?[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否开启提示确认:")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.affirm,(function(e){return[a("span",[t._v(t._s(e.name))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.affirmValue,expression:"pluginAttrData.attr.data.affirmValue"}],attrs:{name:"affirm",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.affirmValue,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"affirmValue",e.value)},t.affirmChange]}})]}))],2)]),t._v(" "),1==t.pluginAttrData.attr.data.affirmValue?a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("提示确认内容:")]),t._v(" "),a("div",{staticClass:"formarea"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.affirmContent,expression:"pluginAttrData.attr.data.affirmContent"}],domProps:{value:t.pluginAttrData.attr.data.affirmContent},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"affirmContent",e.target.value)},t.attrChange]}})])]):t._e()])]:t._e()],2):t._e()},Tn=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定组件到参数：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("\n                        (注意：绑定的组件将作为参数值传递给接口）\n                        ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("参数名")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("参数类型")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("组件")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定提示到控件：")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("组件")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("提示信息")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])}],In={name:"dalertattr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{paramTypes:[{name:"自定义",value:1},{name:"组件",value:0}],types:[{name:"加载完成",value:1},{name:"输入完成",value:2},{name:"获得焦点",value:3},{name:"满足条件",value:4}],errorTypes:[{name:"错误提示",value:"error"},{name:"警告提示",value:"warning"},{name:"友情提示",value:"alert"}],apiList:[],showDialog:!1,condition:"",startX:0,butSkip:[{name:"默认",value:0},{name:"自定义跳转",value:1}],affirm:[{name:"是",value:1},{name:"否",value:0}],skipValue:0}},computed:{nowApi:function(){var t={},e=this;return this.apiList.length&&this.apiList.forEach((function(a){a.id==e.pluginAttrData.attr.data.apiId&&(t=a)})),t},affirmIf:function(){return"2"==this.pluginAttrData.attr.data.defaultOrApi?"3"!=this.pluginAttrData.attr.data.type&&"alert"==this.pluginAttrData.attr.data.errorType:"3"!=this.pluginAttrData.attr.data.type}},methods:{getDesc:function(t){return t.pkey?this.pluginData[t.pkey].description+"."+t.description:t.description},isShowType:function(t){return 2==t?1==this.pluginAttrData.attr.data.defaultOrApi:4!=t||2==this.pluginAttrData.attr.data.defaultOrApi},getApiList:function(){var t=this;this.appFetch({url:"getnoticeList",method:"get"},(function(e){0==e.e?t.apiList=e.d.list:console.error("获取提示验证列表失败")}),(function(){console.error("获取提示验证列表失败")}))},sourceChange:function(){this.pluginAttrData.attr.data.type=1,this.pluginAttrData.attr.data.alertTitle="",this.pluginAttrData.attr.data.alertContent="",this.pluginAttrData.attr.data.pluginAlerts=[],this.pluginAttrData.attr.data.condition="",this.pluginAttrData.attr.data.keyval={},this.pluginAttrData.attr.data.errorType="warning",this.pluginAttrData.attr.data.skipValue=0,this.pluginAttrData.attr.data.urlSite="",this.pluginAttrData.attr.data.affirmValue=0,this.pluginAttrData.attr.data.affirmContent="",this.attrChange()},typeChange:function(){3==this.pluginAttrData.attr.data.type?(this.pluginAttrData.attr.data.alertTitle="",this.pluginAttrData.attr.data.alertContent="",this.pluginAttrData.attr.data.skipValue=0,this.pluginAttrData.attr.data.urlSite="",this.pluginAttrData.attr.data.affirmValue=0,this.pluginAttrData.attr.data.affirmContent=""):this.pluginAttrData.attr.data.pluginAlerts=[],4!=this.pluginAttrData.attr.data.type&&(this.pluginAttrData.attr.data.condition=""),this.attrChange()},errorChange:function(){"alert"!=this.pluginAttrData.attr.data.errorType&&(this.pluginAttrData.attr.data.affirmValue=0,this.pluginAttrData.attr.data.affirmContent=""),this.attrChange()},affirmChange:function(){this.pluginAttrData.attr.data.affirmContent="",this.attrChange()},apiChange:function(){this.initApiParams(),this.attrChange()},skipChange:function(){this.pluginAttrData.attr.data.skipValue||(this.pluginAttrData.attr.data.urlSite=""),this.attrChange()},initApiParams:function(){var t={},e=this.pluginAttrData.attr.data.apiParams;this.pluginAttrData.attr.data.apiId&&this.nowApi.arguments&&this.nowApi.arguments.forEach((function(a){t[a.key]={key:a.key,type:0,value:e[a.key]?e[a.key]:""}})),this.pluginAttrData.attr.data.apiParams=t},addPlugin:function(){this.pluginAttrData.attr.data.pluginAlerts.push({key:"",msg:""}),this.attrChange()},delPlugin:function(t){this.pluginAttrData.attr.data.pluginAlerts.splice(t,1),this.attrChange()},attrChange:function(){this.$emit("sendmessage",this.pluginAttrData)},getPluginName:function(t){var e="";return t.pkey&&this.pluginData[t.pkey]?e+=this.pluginData[t.pkey].description+"."+t.description:e=t.description,e},openDialog:function(){this.showDialog=!0,this.condition=this.pluginAttrData.attr.data.condition},closeDialog:function(){this.showDialog=!1},okDialog:function(){var t=_a["a"].checkFormula(this.condition,this.pluginAttrData.attr.data.keyval);if(t)return this.$message({message:"公式错误，存在无用变量或方法:"+t,type:"error"}),!1;this.showDialog=!1,this.pluginAttrData.attr.data.condition=this.condition,this.attrChange()},insertPlugin:function(t,e,a){var n=_a["a"].getStrByKey(e,"plugin");this.pluginAttrData.attr.data.keyval[n]={type:t,key:e,pkey:a,evalVar:"_this.keyVal."+e+"Data"},this.updateNowCondition(n)},insertFunc:function(t,e){var a=_a["a"].getStrByKey(e,"func");this.pluginAttrData.attr.data.keyval[_a["a"].getStrByKey(e,"func")]={type:t,key:e,evalMethod:"_this."+e},this.updateNowCondition(a)},updateStartX:function(t){this.startX=t.target.selectionStart},updateNowCondition:function(t){var e=this.condition.substring(0,this.startX),a=this.condition.substring(this.startX);this.condition=e+t+a},addMethods:function(){this.pluginAttrData.attr.data.methods=_a["a"].methods}},mounted:function(){this.addMethods(),this.getApiList()}},Pn=In,Nn=Object(m["a"])(Pn,En,Tn,!1,null,null,null),Rn=Nn.exports,Bn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"}):t._e()},On=[],Mn={name:"dVariateAttr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{}},computed:{},methods:{},mounted:function(){}},Ln=Mn,Un=Object(m["a"])(Ln,Bn,On,!1,null,null,null),Fn=Un.exports,$n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"div_flex"},[a("label",{staticStyle:{display:"inline-block"},attrs:{for:t.pluginAttrData.key+"_format"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{id:t.pluginAttrData.key+"_format",type:"radio",name:"ruleOrRandom",value:"format"},domProps:{checked:t._q(t.pluginAttrData.attr.data.type,"format")},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"type","format")},t.changeType]}}),t._v(" "),a("span",{staticStyle:{"font-size":"12px"}},[t._v("规则编号")])]),t._v(" "),a("label",{staticStyle:{display:"inline-block"},attrs:{for:t.pluginAttrData.key+"_unique"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.type,expression:"pluginAttrData.attr.data.type"}],attrs:{id:t.pluginAttrData.key+"_unique",type:"radio",name:"ruleOrRandom",value:"unique"},domProps:{checked:t._q(t.pluginAttrData.attr.data.type,"unique")},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"type","unique")},t.changeType]}}),t._v(" "),a("span",{staticStyle:{"font-size":"12px"}},[t._v("随机编号")])])])]),t._v(" "),"format"==t.pluginAttrData.attr.data.type?[a("div",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("编码格式：")]),t._v(" "),a("div",[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.formater,expression:"pluginAttrData.attr.data.formater"}],attrs:{placeholder:"请填写正确的编码格式"},domProps:{value:t.pluginAttrData.attr.data.formater},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"formater",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选择编码格式：")]),t._v(" "),a("div",t._l(t.format,(function(e,n){return a("span",{key:n,staticStyle:{display:"block","margin-right":"10px"},on:{click:function(a){return t.addFormater(e)}}},[a("i",{staticClass:"el-icon-circle-plus",staticStyle:{"font-size":"12px",color:"#4285f4"}}),t._v(" "),a("span",{staticStyle:{"font-size":"12px"}},[t._v(t._s(e.name))]),t._v(" "),a("span",[t._v(t._s(e.label))])])})),0)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("自增编号位数")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"72px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.serial_length,expression:"pluginAttrData.attr.data.serial_length"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.serial_length},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"serial_length",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("初始化数值")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"72px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.serial_init,expression:"pluginAttrData.attr.data.serial_init"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.serial_init},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"serial_init",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("重置时间：")]),t._v(" "),a("div",{staticClass:"select_default"},t._l(t.reset,(function(e,n){return a("label",{key:n,staticStyle:{display:"inline-block"},attrs:{for:""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.serial_reset,expression:"pluginAttrData.attr.data.serial_reset"}],attrs:{type:"radio",name:"reset"},domProps:{value:e.label,checked:t._q(t.pluginAttrData.attr.data.serial_reset,e.label)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"serial_reset",e.label)},t.dataChange]}}),t._v(" "),a("span",{staticStyle:{"font-size":"12px"}},[t._v(t._s(e.name))])])})),0)])])]:[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("组合条件：")]),t._v(" "),a("div",{staticClass:"select_default"},t._l(t.uniqueArr,(function(e,n){return a("label",{key:n,staticStyle:{display:"inline-block"},attrs:{for:""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.formater,expression:"pluginAttrData.attr.data.formater"}],attrs:{type:"checkbox",name:"reset"},domProps:{value:e.label,checked:Array.isArray(t.pluginAttrData.attr.data.formater)?t._i(t.pluginAttrData.attr.data.formater,e.label)>-1:t.pluginAttrData.attr.data.formater},on:{change:[function(a){var n=t.pluginAttrData.attr.data.formater,i=a.target,r=!!i.checked;if(Array.isArray(n)){var s=e.label,o=t._i(n,s);i.checked?o<0&&t.$set(t.pluginAttrData.attr.data,"formater",n.concat([s])):o>-1&&t.$set(t.pluginAttrData.attr.data,"formater",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.pluginAttrData.attr.data,"formater",r)},t.dataChange]}}),t._v(" "),a("span",{staticStyle:{"font-size":"12px"}},[t._v(t._s(e.name))])])})),0)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("自增编号位数")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"72px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.serial_length,expression:"pluginAttrData.attr.data.serial_length"}],attrs:{type:"number",min:"10"},domProps:{value:t.pluginAttrData.attr.data.serial_length},on:{change:t.dataChange,input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"serial_length",e.target.value)},function(e){return t.totopvalue(e)}]}})])])])],t._v(" "),t.show?a("div",{staticClass:"box-Quote"},[a("div",[a("div",[a("span",{staticClass:"top-header"},[t._v("获取表单内容")]),t._v(" "),a("span",{staticClass:"x",on:{click:t.clear}},[t._v("x")])]),t._v(" "),a("div",{staticStyle:{position:"relative","margin-left":"10px"}},[a("div",{staticClass:"left-box"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchName,expression:"searchName",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入表单名称"},domProps:{value:t.searchName},on:{input:function(e){e.target.composing||(t.searchName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("ul",t._l(t.formFiles,(function(e,n){return a("li",{key:n,on:{click:function(a){return t.filterRight(a,e)}}},[t._v(t._s(e.form_name))])})),0)]),t._v(" "),a("div",{staticClass:"right-box"},[a("ul",t._l(t.formList,(function(e,n){return a("li",{class:{},on:{click:function(a){return t.getGet(e)}}},[a("span",[t._v(t._s(e.description))])])})),0)])]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("div",{staticStyle:{width:"95%",height:"103px",border:"1px solid #666",margin:"0 auto","text-align":"left",overflow:"hidden","padding-right":"5px","box-sizing":"border-box"}},t._l(t.rule,(function(e,n){return a("span",{key:n,staticClass:"form_span"},[t._v(t._s(e)+" "),a("i",{on:{click:function(e){return t.clearRule(n)}}},[t._v("×")])])})),0)]),t._v(" "),a("div",{staticStyle:{"text-align":"center","padding-bottom":"5px"}},[a("div",{staticStyle:{display:"inline-block"}},[a("span",{staticClass:"clear",on:{click:t.clear}},[t._v("取消")]),t._v(" "),a("span",{staticClass:"makeSure",on:{click:t.makeSureFn}},[t._v("确定")])])])])]):t._e()],2):t._e()},Hn=[],jn={name:"dSerialAttr",props:["sendmessage","pluginAttrData"],data:function(){return{format:[{name:"年",label:"{date.Y}"},{name:"月",label:"{date.m}"},{name:"年月",label:"{date.Y}{date.m}"},{name:"日期",label:"{date.Y}{date.m}{date.d}"},{name:"自增编号",label:"{No}"},{name:"获取表单内容",label:"{表单id.组件key}",form:!0},{name:"根据表单内容编号",label:"{表单id.组件key.No}",form:!0}],reset:[{name:"每年",label:"year"},{name:"每月",label:"month"},{name:"每日",label:"day"}],uniqueArr:[{name:"数字",label:"number"},{name:"小写字母",label:"lower"},{name:"大写字母",label:"upper"}],formFiles:[],searchName:"",formList:[],attrRule:[],rule:[],show:!1,formOrformNo:!1}},watch:{searchName:function(){this.getFormFiles(),this.formList=[]}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},getFormFiles:function(){var t=this;this.appFetch({url:"bpmnSearchForm",method:"GET",data:{app_id:this.$route.query.app_id,bpmn_id:this.$route.query.bpmn_id,name:this.searchName}},(function(e){0==e.e?t.formFiles=e.d.data:t.$message("表单列表获取失败，请联系管理员")}),(function(){t.$message("表单列表获取失败，请联系管理员")}))},filterRight:function(t,e){this.form=e,$(t.target).addClass("active").siblings().removeClass("active"),this.getFormList(e.form_version_id)},getFormList:function(t){var e=this;this.appFetch({url:"fBpmnCom",method:"GET",data:{form_version_id:t}},(function(t){var a={},n=t.d.components;for(var i in n){var r=n[i].columnType,s=["Input","MultiInput","Quote","Binding","Select","Radio","Passwd","Count","Region","User","Calendar"];s.includes(r)&&(a[i]=n[i])}e.formList=a,console.log(e.formList)}),(function(t){console.log(t)}))},clear:function(){this.show=!1},makeSureFn:function(){for(var t="",e=0;e<this.attrRule.length;e++)t+=this.attrRule[e];this.pluginAttrData.attr.data.formater+=t,this.show=!1,this.dataChange()},getGet:function(t){this.formOrformNo?(this.attrRule.push("{form"+this.form.form_id+"."+t.key+"}"),this.rule.push("{"+this.form.form_name+"_"+t.description+"}")):(this.attrRule.push("{form"+this.form.form_id+"."+t.key+".No}"),this.rule.push("{"+this.form.form_name+"_"+t.description+".No}"))},handelShow:function(){this.show=!this.show,this.show&&(this.formList=[],this.searchName="",this.attrRule=[],this.rule=[],this.getFormFiles())},clearRule:function(t){this.attrRule.splice(t,1),this.rule.splice(t,1)},addFormater:function(t){t.form?("获取表单内容"==t.name?this.formOrformNo=!0:this.formOrformNo=!1,this.handelShow()):this.pluginAttrData.attr.data.formater+=t.label,this.$emit("sendmessage",this.pluginAttrData)},changeType:function(){"format"==this.pluginAttrData.attr.data.type?(this.pluginAttrData.attr.data.formater="",this.pluginAttrData.attr.data.serial_length=6):(this.pluginAttrData.attr.data.formater=["number","lower","upper"],this.pluginAttrData.attr.data.serial_length=10),this.dataChange()},totopvalue:function(t){this.pluginAttrData.attr.data.serial_length=t.target.value.replace(/[^\d]/g,"")}},created:function(){}},Wn=jn,zn=(a("efc5"),Object(m["a"])(Wn,$n,Hn,!1,null,"15c5e721",null)),Vn=zn.exports,qn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("可写按钮名称：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.writeButtonName,expression:"pluginAttrData.attr.data.writeButtonName",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.writeButtonName},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"writeButtonName",e.target.value.trim())},t.attrChange],blur:function(e){return t.$forceUpdate()}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("可读按钮名称：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.readButtonName,expression:"pluginAttrData.attr.data.readButtonName",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.readButtonName},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"readButtonName",e.target.value.trim())},t.attrChange],blur:function(e){return t.$forceUpdate()}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[t._m(0),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.disableDSourceKeys,expression:"pluginAttrData.attr.data.disableDSourceKeys",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.disableDSourceKeys},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"disableDSourceKeys",e.target.value.trim())},t.attrChange],blur:function(e){return t.$forceUpdate()}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("表单id来源：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.idFormTypes,(function(e){return[t._v("\n                        "+t._s(e.name)+" \n                        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.idFormType,expression:"pluginAttrData.attr.data.idFormType"}],attrs:{name:"idFormType",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.idFormType,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"idFormType",e.value)},t.typeChange]}}),t._v("\n                          \n                    ")]}))],2)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:t.pluginAttrData.attr.data.hideBtn,callback:function(e){t.$set(t.pluginAttrData.attr.data,"hideBtn",e)},expression:"pluginAttrData.attr.data.hideBtn"}},[t._v("隐藏确定取消按钮")])],1)]),t._v(" "),1==t.pluginAttrData.attr.data.idFormType?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("表单id：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.pluginAttrData.attr.data.formId,expression:"pluginAttrData.attr.data.formId",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.formId},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"formId",e.target.value.trim())},t.attrChange],blur:function(e){return t.$forceUpdate()}}})])])]):t._e(),t._v(" "),0==t.pluginAttrData.attr.data.idFormType?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("组件：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:t.pluginChange},model:{value:t.pluginAttrData.attr.data.pluginKey,callback:function(e){t.$set(t.pluginAttrData.attr.data,"pluginKey",e)},expression:"pluginAttrData.attr.data.pluginKey"}},t._l(t.pluginData,(function(e){return e.key===t.pluginAttrData.key||e.pkey||["dOneInput","dmultiText"].includes(e.type)?t._e():a("el-option",{key:e.key,attrs:{value:e.key,label:e.description}})})),1)],1)])]):t._e(),t._v(" "),0==t.pluginAttrData.attr.data.idFormType&&-1!==t.pluginAttrData.attr.data.pluginKey.indexOf("RepeatTable")?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("子组件：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},model:{value:t.pluginAttrData.attr.data.childKey,callback:function(e){t.$set(t.pluginAttrData.attr.data,"childKey",e)},expression:"pluginAttrData.attr.data.childKey"}},t._l(t.pluginData,(function(e){return e.pkey!=t.pluginAttrData.attr.data.pluginKey||["dOneInput","dmultiText","dChildTable"].includes(e.type)?t._e():a("el-option",{key:e.key,attrs:{value:e.key,label:e.description}})})),1)],1)])]):t._e()]):t._e()},Gn=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"formtitle"},[t._v("二次打开禁用子表数据源列表"),a("span",{staticClass:"redColor"},[t._v("（以竖杠”|“间隔），如：DataSource_3|DataSource_2")]),t._v("：")])}],Kn={name:"dchildtable",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{idFormTypes:[{name:"控件",value:0},{name:"自定义",value:1}]}},methods:{typeChange:function(){this.pluginAttrData.attr.data.formId="",this.pluginAttrData.attr.data.pluginKey="",this.pluginAttrData.attr.data.childKey="",this.attrChange()},pluginChange:function(){this.pluginAttrData.attr.data.childKey="",this.attrChange()},attrChange:function(){this.$emit("sendmessage",this.pluginAttrData)}}},Xn=Kn,Yn=Object(m["a"])(Xn,qn,Gn,!1,null,null,null),Jn=Yn.exports,Zn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key&&t.pluginAttrData.attr.setInfo?a("ul",{staticClass:"plugins"}):t._e()},Qn=[],ti={name:"dTable",props:["sendmessage","pluginAttrData","pluginData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}},mounted:function(){}},ei=ti,ai=Object(m["a"])(ei,Zn,Qn,!1,null,null,null),ni=ai.exports,ii=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key&&t.pluginAttrData.attr.setInfo?a("ul",{staticClass:"plugins"}):t._e()},ri=[],si={name:"dOneColumn",props:["sendmessage","pluginAttrData","pluginData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}},mounted:function(){}},oi=si,li=Object(m["a"])(oi,ii,ri,!1,null,null,null),ui=li.exports,di=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("按钮文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.buttest,expression:"pluginAttrData.attr.data.buttest"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.buttest},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"buttest",e.target.value)}}})])])]),t._v(" "),void 0!=t.pluginAttrData.attr.data.smallsize?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文件大小： 最小值")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"20px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.smallsize,expression:"pluginAttrData.attr.data.smallsize"}],staticStyle:{width:"20px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.smallsize},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"smallsize",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("Mb   最大值")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"20px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.size,expression:"pluginAttrData.attr.data.size"}],staticStyle:{width:"20px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.size},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"size",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("Mb")])])]):a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文件大小：")]),t._v(" "),a("div",{staticClass:"formline",staticStyle:{width:"20px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.size,expression:"pluginAttrData.attr.data.size"}],staticStyle:{width:"20px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.size},on:{change:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"size",e.target.value)}}})]),t._v(" "),a("span",{staticClass:"formtitle"},[t._v("Mb")])])]),t._v(" "),void 0!=t.pluginAttrData.attr.data.islimit?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("限制文件类型")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n          限制\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.islimit,expression:"pluginAttrData.attr.data.islimit"}],attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.islimit,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"islimit",!0)},t.dataChange]}}),t._v("\n            \n          不限\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.islimit,expression:"pluginAttrData.attr.data.islimit"}],attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.islimit,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"islimit",!1)},t.dataChange]}})])])]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("只读状态时展示样式")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n          平铺展开\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.readonlyStyle,expression:"pluginAttrData.attr.data.readonlyStyle"}],attrs:{type:"radio",name:"readonlyStyle"},domProps:{value:0,checked:t._q(t.pluginAttrData.attr.data.readonlyStyle,0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"readonlyStyle",0)},t.dataChange]}}),t._v("\n            \n          轮播图\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.readonlyStyle,expression:"pluginAttrData.attr.data.readonlyStyle"}],attrs:{type:"radio",name:"readonlyStyle"},domProps:{value:1,checked:t._q(t.pluginAttrData.attr.data.readonlyStyle,1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"readonlyStyle",1)},t.dataChange]}})])])]),t._v(" "),void 0!=t.pluginAttrData.attr.data.islimit&&t.pluginAttrData.attr.data.islimit?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选择允许上传的文件类型：")]),t._v(" "),t._l(t.pluginAttrData.attr.data.limitALL,(function(e,n){return a("label",{staticClass:"fileTypeList",attrs:{for:""}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.Haslimit,expression:"pluginAttrData.attr.data.Haslimit"}],attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.pluginAttrData.attr.data.Haslimit)?t._i(t.pluginAttrData.attr.data.Haslimit,e)>-1:t.pluginAttrData.attr.data.Haslimit},on:{change:[function(a){var n=t.pluginAttrData.attr.data.Haslimit,i=a.target,r=!!i.checked;if(Array.isArray(n)){var s=e,o=t._i(n,s);i.checked?o<0&&t.$set(t.pluginAttrData.attr.data,"Haslimit",n.concat([s])):o>-1&&t.$set(t.pluginAttrData.attr.data,"Haslimit",n.slice(0,o).concat(n.slice(o+1)))}else t.$set(t.pluginAttrData.attr.data,"Haslimit",r)},t.dataChange]}}),t._v("\n          "+t._s(e)+"\n        ")])}))],2)]):t._e(),t._v(" "),void 0!=t.pluginAttrData.attr.data.showexpress?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("是否显示文字描述：")]),t._v(" "),a("div",{staticClass:"formradio dradiostyle"},[t._v("\n          显示\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.showexpress,expression:"pluginAttrData.attr.data.showexpress"}],attrs:{type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.data.showexpress,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"showexpress",!0)},t.dataChange]}}),t._v("\n            \n          不显示\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.showexpress,expression:"pluginAttrData.attr.data.showexpress"}],attrs:{type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.data.showexpress,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.data,"showexpress",!1)},t.dataChange]}})])])]):t._e()]):t._e()},ci=[],pi={name:"doneinputattr",props:["sendmessage","pluginAttrData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},updateimage:function(t){var e=t.currentTarget,a=this,n=e.files[0].name.lastIndexOf("."),i=e.files[0].name.substring(n).toLowerCase();if(".png"==i||".jpg"==i||".jpeg"==i||".gif"==i||".svg"==i){if(void 0!=e.files[0]){var r=new FormData;r.append("upfile",e.files[0]);var s=new XMLHttpRequest;s.open("post","https://dev-officeflow.rlstech.cn/api/upload/index?category=image"),s.onload=function(t){var n=JSON.parse(t.currentTarget.response);"SUCCESS"==n.state?(a.pluginAttrData.attr.data.name=e.files[0].name,a.pluginAttrData.data="https://dev-officeflowimg.rlstech.cn/"+n.url,a.dataChange(),$(e).val("")):(a.$message.info({message:"上传失败，请稍后重试！"}),$(e).val(""))},s.onerror=function(t){a.$message.info({message:"上传失败，请稍后重试！"})},s.send(r)}}else a.$message.info({message:"仅支持png,jpg,jpeg,gif,svg格式的文件！"})},clickupdate:function(t){$("#"+this.pluginAttrData.key).click()},init:function(){void 0==this.pluginAttrData.attr.data.readonlyStyle&&(this.pluginAttrData.attr.data.readonlyStyle=0)}},computed:{nowkeys:function(){return this.pluginAttrData.key}},mounted:function(){this.dataChange()},watch:{nowkeys:function(){this.init()}},created:function(){this.init()}},hi=pi,gi=Object(m["a"])(hi,di,ci,!1,null,null,null),fi=gi.exports,mi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("目标控件：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:function(e){return t.dataChange()}},model:{value:t.pluginAttrData.attr.data.targetPlugin,callback:function(e){t.$set(t.pluginAttrData.attr.data,"targetPlugin",e)},expression:"pluginAttrData.attr.data.targetPlugin"}},t._l(t.pluginData,(function(e){return e.pkey||"dRepeatTable"==e.type||e.key==t.pluginAttrData.key?t._e():a("el-option",{key:e.key,attrs:{label:e.description,value:e.key}})})),1)],1)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("设置：")]),t._v(" "),a("div",{staticClass:"formarea",on:{click:t.openDialog}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.rule,expression:"pluginAttrData.attr.data.rule"}],attrs:{disabled:""},domProps:{value:t.pluginAttrData.attr.data.rule},on:{input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"rule",e.target.value)}}})]),t._v(" "),a("el-dialog",{attrs:{title:"计算设置",visible:t.showDialog,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showDialog=e},close:t.closeDialog}},[t.pluginAttrData?a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"组件列表"}},[t._l(t.pluginData,(function(e){return e.pkey||e.key==t.pluginAttrData.key?t._e():[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertPlugin("plugin",e.key)}}},[t._v(t._s(e.description))]),t._v(" \n\t\t\t\t\t\t\t")]}))],2),t._v(" "),a("el-form-item",{attrs:{label:"转化方法"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.functionStr,expression:"functionStr"}],attrs:{cols:"80",rows:"5"},domProps:{value:t.functionStr},on:{input:function(e){e.target.composing||(t.functionStr=e.target.value)}}}),t._v(" "),a("p",[t._v("此处自定义用于复杂转化的方法，在规则处调用，规则处调用方式如下$selfFunction(组件1的值, 组件2的值)，参数个数根据实际情况设置")])]),t._v(" "),a("el-form-item",{attrs:{label:"当前公式"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.rule,expression:"rule"}],attrs:{cols:"80",rows:"5"},domProps:{value:t.rule},on:{mouseup:t.updateStartX,keyup:t.updateStartX,input:function(e){e.target.composing||(t.rule=e.target.value)}}})]),t._v(" "),a("el-form-item",{attrs:{label:"方法列表"}},[t._l(t.pluginAttrData.attr.data.methods,(function(e){return[a("el-tooltip",{key:e.methodName,staticClass:"item",attrs:{effect:"dark",content:e.description,placement:"top"}},[a("span",{staticClass:"diaelename",on:{click:function(a){return t.insertFunc("func",e.methodName)}}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t\t\t")])]),t._v("\n\t\t\t\t\t\t\t\t \t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t")]}))],2)],1):t._e(),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.okDialog}},[t._v("确 定")])],1)],1)],1)])]):t._e()},vi=[],bi={name:"dConversion",data:function(){return{showDialog:!1,rule:"",functionStr:"",startX:0}},props:["sendmessage","pluginAttrData","pluginData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},openDialog:function(){this.showDialog=!0,this.rule=this.pluginAttrData.attr.data.rule,this.functionStr=this.pluginAttrData.attr.data.functionStr?this.pluginAttrData.attr.data.functionStr:""},closeDialog:function(){this.showDialog=!1},okDialog:function(){var t=_a["a"].checkFormula(this.rule,this.pluginAttrData.attr.data.keyval);if(t)return this.$message({message:"公式错误，存在无用变量或方法:"+t,type:"error"}),!1;this.showDialog=!1,this.pluginAttrData.attr.data.rule=this.rule,this.pluginAttrData.attr.data.functionStr=this.functionStr,this.dataChange()},insertPlugin:function(t,e,a){var n=_a["a"].getStrByKey(e,"plugin");this.pluginAttrData.attr.data.keyval[n]={type:t,key:e,pkey:a,evalVar:"_this.keyVal."+e+"Data"},this.updateNowRule(n)},insertFunc:function(t,e){var a=_a["a"].getStrByKey(e,"func");this.pluginAttrData.attr.data.keyval[_a["a"].getStrByKey(e,"func")]={type:t,key:e,evalMethod:"_this."+e},this.updateNowRule(a)},updateStartX:function(t){this.startX=t.target.selectionStart},updateNowRule:function(t){var e=this.rule.substring(0,this.startX),a=this.rule.substring(this.startX);this.rule=e+t+a},addMethods:function(){this.pluginAttrData.attr.data.methods=_a["a"].methods}},mounted:function(){this.addMethods()}},yi=bi,_i=Object(m["a"])(yi,mi,vi,!1,null,null,null),Di=_i.exports,Ci=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("高度：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.style.minHeight,expression:"pluginAttrData.attr.style.minHeight"}],staticClass:"ctrl-resize",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.style.minHeight},on:{keyup:function(e){return t.changeheight(e,"height")},input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.style,"minHeight",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("内容限制：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.limitTypes,(function(e){return[t._v("\n                        "+t._s(e.name)+"\n                        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.limitHeightType,expression:"pluginAttrData.attr.data.limitHeightType"}],attrs:{name:"type",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.limitHeightType,e.value)},on:{change:[function(a){return t.$set(t.pluginAttrData.attr.data,"limitHeightType",e.value)},t.dataChange]}}),t._v("\n                          \n                    ")]}))],2)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeholder,expression:"pluginAttrData.attr.data.placeholder"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.placeholder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeholder",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("占位文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.data,expression:"pluginAttrData.data"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.data},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData,"data",e.target.value)}}})])])])]):t._e()},wi=[],xi={props:["sendmessage","pluginAttrData"],data:function(){return{limitTypes:[{name:"可超过高度",value:0},{name:"不可超过高度",value:1}]}},methods:{changeheight:function(t,e){"height"==e&&("ArrowUp"==t.code?this.pluginAttrData.attr.style.minHeight++:"ArrowDown"==t.code&&this.pluginAttrData.attr.style.minHeight>24?this.pluginAttrData.attr.style.minHeight--:this.pluginAttrData.attr.style.minHeight+=t.target.innerText),this.dataChange()},dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}}},ki=xi,Si=Object(m["a"])(ki,Ci,wi,!1,null,null,null),Ai=Si.exports,Ei=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("按钮文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.btnName,expression:"pluginAttrData.attr.data.btnName"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.btnName},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"btnName",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("接口：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.request_url,expression:"pluginAttrData.attr.data.request_url"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.request_url},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"request_url",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("跳转地址：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.jump_url,expression:"pluginAttrData.attr.data.jump_url"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.jump_url},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"jump_url",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[a("span",[t._v("是否需要确认：")]),t._v(" "),a("el-radio",{staticStyle:{"margin-right":"10px"},attrs:{label:1},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.is_hintMessage,callback:function(e){t.$set(t.pluginAttrData.attr.data,"is_hintMessage",e)},expression:"pluginAttrData.attr.data.is_hintMessage"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:0},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.is_hintMessage,callback:function(e){t.$set(t.pluginAttrData.attr.data,"is_hintMessage",e)},expression:"pluginAttrData.attr.data.is_hintMessage"}},[t._v("否")])],1),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.hintMessage,expression:"pluginAttrData.attr.data.hintMessage"}],attrs:{type:"text",placeholder:"提示内容"},domProps:{value:t.pluginAttrData.attr.data.hintMessage},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"hintMessage",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("响应动作：")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.response_action,expression:"pluginAttrData.attr.data.response_action"}],staticStyle:{width:"100px"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"response_action",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{attrs:{value:"jump",disabled:0==t.pluginAttrData.attr.data.jump_url.length}},[t._v("跳转")]),t._v(" "),a("option",{attrs:{value:"refresh"}},[t._v("刷新")]),t._v(" "),a("option",{attrs:{value:"close"}},[t._v("关闭窗口")]),t._v(" "),a("option",{attrs:{value:"hint"}},[t._v("弹窗提示")]),t._v(" "),a("option",{attrs:{value:"rdatasource"}},[t._v("刷新数据源")])])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("数据源1：")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.rsdatasuorce,expression:"pluginAttrData.attr.data.rsdatasuorce"}],staticStyle:{width:"100px"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"rsdatasuorce",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{attrs:{value:""}},[t._v("请选择")]),t._v(" "),t._l(t.dataSourceList,(function(e){return a("option",{domProps:{value:e.key}},[t._v("\n                            "+t._s(e.description)+"\n                        ")])}))],2)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("请求方式：")]),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.method,expression:"pluginAttrData.attr.data.method"}],staticStyle:{width:"100px"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"method",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{attrs:{value:"GET"}},[t._v("GET")]),t._v(" "),a("option",{attrs:{value:"POST"}},[t._v("POST")])])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.pluginAttrData.attr.data.is_validate,callback:function(e){t.$set(t.pluginAttrData.attr.data,"is_validate",e)},expression:"pluginAttrData.attr.data.is_validate"}},[t._v("提交时需验证表单必填项")])],1)]),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(0),t._v(" "),t._l(t.pluginAttrData.attr.data.params,(function(e,n){return a("tr",{key:n},[a("td",[a("div",{staticClass:"tdselectbox"},[a("el-input",{attrs:{size:"mini"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.params[n].param_name,callback:function(e){t.$set(t.pluginAttrData.attr.data.params[n],"param_name",e)},expression:"pluginAttrData.attr.data.params[index].param_name"}})],1)]),t._v(" "),a("td",[t.pluginDataShow?a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.params[n].component,callback:function(e){t.$set(t.pluginAttrData.attr.data.params[n],"component",e)},expression:"pluginAttrData.attr.data.params[index].component"}},t._l(t.pluginDataShow,(function(e,n,i){return t.pluginAttrData.key!==n?a("el-option",{key:i,attrs:{label:e.description,value:n}}):t._e()})),1):t._e()],1),t._v(" "),a("td",[t.pluginDataShow?a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.dataChange},model:{value:e.type,callback:function(a){t.$set(e,"type",a)},expression:"item.type"}},[a("el-option",{attrs:{label:"接口",value:1}}),t._v(" "),a("el-option",{attrs:{label:"跳转地址",value:2}})],1):t._e()],1),t._v(" "),a("td",{staticClass:"opera textAlignC"},[a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.delselectone(n,1)}}})])])}))],2),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.addselect(1)}}},[t._v("新增")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.delselect(1)}}},[t._v("全删")])],1),t._v(" "),t._m(1),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(2),t._v(" "),t._l(t.pluginAttrData.attr.data.custom,(function(e,n){return a("tr",{key:n},[a("td",[a("div",{staticClass:"tdselectbox"},[a("el-input",{attrs:{size:"mini"},on:{change:t.dataChange},model:{value:e.param_name,callback:function(a){t.$set(e,"param_name",a)},expression:"item.param_name"}})],1)]),t._v(" "),a("td",[a("div",{staticClass:"tdselectbox"},[a("el-input",{attrs:{size:"mini"},on:{change:t.dataChange},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)]),t._v(" "),a("td",[t.pluginDataShow?a("el-select",{attrs:{size:"mini",placeholder:"请选择"},on:{change:t.dataChange},model:{value:e.type,callback:function(a){t.$set(e,"type",a)},expression:"item.type"}},[a("el-option",{attrs:{label:"接口",value:1}}),t._v(" "),a("el-option",{attrs:{label:"跳转地址",value:2}})],1):t._e()],1),t._v(" "),a("td",{staticClass:"opera textAlignC"},[a("i",{staticClass:"el-icon-error",on:{click:function(e){return t.delselectone(n,2)}}})])])}))],2),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.addselect(2)}}},[t._v("新增")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.delselect(2)}}},[t._v("全删")])],1)]):t._e()},Ti=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC",staticStyle:{width:"70px"}},[t._v("参数名称：")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("选择控件：")]),t._v(" "),a("th",{staticClass:"textAlignC",staticStyle:{width:"80px"}},[t._v("参数位置:")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("span",{staticClass:"formtitle"},[t._v("自定义参数：")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("参数名")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("值(环境变量)")]),t._v(" "),a("th",{staticClass:"textAlignC",staticStyle:{width:"80px"}},[t._v("参数位置:")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])}],Ii={name:"dInputattr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{pluginDataShow:{},selectKeys:{},isInRepeat:!1}},watch:{pluginAttrData:function(){this.initData()}},mounted:function(){this.initData()},computed:{dataSourceList:function(){var t=[];for(var e in this.pluginData)this.pluginData.hasOwnProperty(e)&&["DataSource"].includes(this.pluginData[e].columnType)&&t.push(this.pluginData[e]);return t}},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},initData:function(){for(var t in void 0==this.pluginAttrData.attr.data.is_hintMessage&&(this.pluginAttrData.attr.data.is_hintMessage=0,this.pluginAttrData.attr=JSON.parse(JSON.stringify(this.pluginAttrData.attr))),this.pluginDataShow={},this.pluginData)this.pluginData.hasOwnProperty(t)&&!["Table","Text","MultiText"].includes(this.pluginData[t].columnType)&&(this.pluginDataShow[t]=this.pluginData[t]);this.pluginAttrData.attr.data.custom.forEach((function(t){t.type||(t.type=1)})),this.pluginAttrData.attr.data.params.forEach((function(t){t.type||(t.type=1)})),this.submitinRepeat(),this.isInRepeat&&(this.pluginDataShow=this.selectKeys)},addselect:function(t){1==t?(Object.keys(this.pluginAttrData.attr.data).includes("params")||this.$set(this.pluginAttrData.attr.data,"params",[]),this.pluginAttrData.attr.data.params.push({param_name:"",component:"",type:1})):2==t&&(Object.keys(this.pluginAttrData.attr.data).includes("custom")||this.$set(this.pluginAttrData.attr.data,"custom",[]),this.pluginAttrData.attr.data.custom.push({param_name:"",value:"",type:1})),this.dataChange()},delselect:function(t){1==t?this.pluginAttrData.attr.data.params=[{param_name:"",component:"",type:1}]:2==t&&(this.pluginAttrData.attr.data.custom=[{param_name:"",value:"",type:1}]),this.dataChange()},delselectone:function(t,e){if(1==e)var a=this.pluginAttrData.attr.data.params;else if(2==e)a=this.pluginAttrData.attr.data.custom;a.splice(t,1),this.dataChange()},submitinRepeat:function(){var t=this,e=this.pluginData;for(var a in e)if(e.hasOwnProperty(a)&&a.includes("RepeatTable")){var n=!1,i={};e[a].attr.data.tableData.trs[1].tds.forEach((function(e){if(!e.dataid)return!1;window.retable.plugins[e.dataid].key==t.pluginAttrData.key?(t.isInRepeat=!0,n=!0):i[e.dataid]={description:window.retable.plugins[e.dataid].description}})),n&&(t.selectKeys=i,t.selectKeys[a]={description:e[a].description})}}}},Pi=Ii,Ni=Object(m["a"])(Pi,Ei,Ti,!1,null,null,null),Ri=Ni.exports,Bi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("最多选择场次：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.maxRoom,expression:"pluginAttrData.attr.data.maxRoom"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.maxRoom},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"maxRoom",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("会议室选择方式：")]),t._v(" "),a("div",{staticClass:"select_default"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.getIdType,expression:"pluginAttrData.attr.data.getIdType"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.data,"getIdType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:1}},[t._v("控件内选择")]),t._v(" "),a("option",{domProps:{value:2}},[t._v("自定义")])])])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[t._m(0),t._v(" "),a("div",{staticClass:"select_default"},[a("el-input",{staticStyle:{width:"100px"},attrs:{size:"mini",disabled:1==t.pluginAttrData.attr.data.getIdType},model:{value:t.pluginAttrData.attr.data.roomId,callback:function(e){t.$set(t.pluginAttrData.attr.data,"roomId",e)},expression:"pluginAttrData.attr.data.roomId"}})],1)])])]):t._e()},Oi=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"formtitle"},[t._v("自定义RoomId"),a("span",{staticStyle:{color:"red"}},[t._v("(支持环境变量)")]),t._v(":")])}],Mi={name:"dInputattr",props:["sendmessage","pluginAttrData","pluginData"],data:function(){return{}},mounted:function(){},methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}}},Li=Mi,Ui=Object(m["a"])(Li,Bi,Oi,!1,null,null,null),Fi=Ui.exports,$i={name:"allPluginAttr",components:{dOneInputAttr:b,dIntegerInputAttr:x,dNumericInputAttr:I,dSelectAttr:L,dSelectV2Attr:z,dmultiTextAttr:Y,dmultiInputAttr:at,dInputAttr:lt,dRadioAttr:gt,dCheckboxAttr:_t,dImageAttr:St,dUserAttr:Rt,dCountryV2Attr:Ft,dOpinionAttr:Vt,dCalendarAttr:Jt,dUserSearchAttr:ie,dLinkAttr:de,dFileAttr:ve,dDepartAttr:we,dAvatarAttr:Te,dJoinSignAttr:Oe,dProjectNumberAttr:He,dPasswdAttr:Ge,dSealAttr:Qe,dBindingAttr:ra,dQuoteAttr:ca,dMultipleAttr:va,dCountAttr:xa,dRegionAttr:Pa,dShowHideAttr:La,dPaymentAttr:Wa,dQrcode:Xa,dRepeatTableAttr:en,dDataSourceAttr:ln,dSyncAttr:gn,dShowAttr:_n,dValidateAttr:An,dAlertAttr:Rn,dVariateAttr:Fn,dSerialAttr:Vn,dChildTableAttr:Jn,dTableAttr:ni,dOneColumnAttr:ui,dXimageAttr:fi,dConversionAttr:Di,dRichtextAttr:Ai,dSubmitAttr:Ri,dRoomAttr:Fi},props:["sendmessage","plugin","pluginSelect","pageSize","tableData","formModeData"],data:function(){return{fontFamilys:[{name:"宋体",value:"SimSun"},{name:"黑体",value:"SimHei"},{name:"微软雅黑",value:"微软雅黑"},{name:"华文仿宋",value:"STFangsong"},{name:"华文宋体",value:"STsong"},{name:"小标宋",value:"FZXiaoBiaoSong-B05S"},{name:"仿宋_GB2312",value:"FangSong_GB2312"},{name:"楷体_GB2312",value:"KaiTi_GB2312"},{name:"arial",value:"arial"},{name:"calibri",value:"calibri"},{name:"times new roman",value:"times new roman"}],fontSizes:[{name:"初号",value:56},{name:"小初",value:48},{name:"一号",value:34},{name:"小一",value:32},{name:"二号",value:29},{name:"小二",value:24},{name:"三号",value:21},{name:"小三",value:20},{name:"19px",value:19},{name:"四号",value:18},{name:"小四",value:16},{name:"五号",value:14},{name:"小五",value:13},{name:"12px",value:12}],isPublic:!1,initAttrData:{key:"public",mobileshow:!0,attr:{style:{fontSize:14,fontFamily:"微软雅黑",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",textAlign:"left",marginTop:0,marginBottom:0,lineHeight:20,letterSpacing:0}}},nowPlugin:{},allPluginData:{},noShowAttr:[]}},watch:{plugin:function(t){this.updateData()},pluginSelect:function(t){this.updateData(),0==t.length?this.nowPlugin={}:1==t.length?this.nowPlugin=this.allPluginData[t[0]]:t.length>1&&(this.nowPlugin=this.appCommonH.copyObj(this.initAttrData)),this.isPublic=t.length>1}},methods:{isShowAttr:function(){return!this.nowPlugin.classtype&&!this.noShowAttr.includes(this.nowPlugin.type)},sortChange:function(){isNaN(this.nowPlugin.sort)?this.nowPlugin.sort=0:this.nowPlugin.sort=+this.nowPlugin.sort},updateData:function(){this.allPluginData=Object(o["a"])(Object(o["a"])({},this.plugin.plugins),this.plugin.rtplugins)},postMessage:function(t){$.isEmptyObject(t)||(this.nowPlugin=t),this.dataChange()},getNameByValue:function(t,e){var a="无";return this[t]&&this[t].forEach((function(t){t.value==e&&(a=t.name)})),a},setAttr:function(t,e){var a=this.nowPlugin.attr.style;switch(t){case"fontWeight":a.fontWeight="normal"==a.fontWeight?"bold":"normal";break;case"fontStyle":a.fontStyle="normal"==a.fontStyle?"italic":"normal";break;case"textDecoration":a.textDecoration="none"==a.textDecoration?"underline":"none";break;case"textAlign":a.textAlign=e;break;case"fontFamily":a.fontFamily=e;break;case"fontSize":a.fontSize=e;break}this.dataChange()},dataChange:function(){if("public"===this.nowPlugin.key){var t=this;this.pluginSelect.forEach((function(e){var a=t.appCommonH.copyObj(t.allPluginData[e]);a.mobileshow=t.nowPlugin.mobileshow,a.attr.style=Object(o["a"])(Object(o["a"])({},a.attr.style),t.nowPlugin.attr.style),t.$emit("sendmessage",a)}))}else this.$emit("sendmessage",this.nowPlugin)}},mounted:function(){this.updateData(),window.pluginVm=this}},Hi=$i,ji=Object(m["a"])(Hi,d,c,!1,null,null,null),Wi=ji.exports,zi=Object(o["a"])({name:"formtable",components:{allPlugin:u["a"],allPluginAttr:Wi}},l["a"]),Vi=zi,qi=Object(m["a"])(Vi,r,s,!1,null,null,null),Gi=qi.exports,Ki=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"t"},[a("div",{staticClass:"table_content"},[a("div",{staticClass:"pageBoxV3 pageBox tablewarp",style:t.appCommonH.getStyle(Object.assign({},{width:t.formBaseInfo.width},t.pageStyle)),attrs:{id:"pageBox","data-id":"table_"+t.nowModeId},on:{mouseup:function(e){return t.tdChangeMouseup(e)},mousemove:function(e){return t.tdChangeMousemove(e)}}},[a("div",{staticClass:"watermark"}),t._v(" "),(t.isShowTopAlert||t.formmodeedit)&&t.formBaseInfo.printForm.topALert?a("div",{staticClass:"topAlert",domProps:{innerHTML:t._s(t.formBaseInfo.printForm.topALert)}}):t._e(),t._v(" "),t._l(t.layoutPluginSort,(function(e){return[t.startDoPlugin?a("allPluginV3",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,rtupdateInfo:t.rtupdateInfo,plugin:t.plugin,forminfo:t.formInfo,watchmessage:t.plugin.plugins[e]},on:{sendmessage:t.setPluginValue,sendrtmessage:t.rtPostMessage,tablesendmessage:t.tableSendMessage}}):t._e()]}))],2),t._v(" "),a("div",{staticClass:"operationalert"},[a("ul",[a("li",{class:" "+(t.operationAlert.removeRow?"":"disbale"),on:{click:function(e){t.operationAlert.removeRow?t.removeRow():t.no}}},[t._v("\n\t\t\t\t\t\t删除当前行\n\t\t\t\t\t")]),t._v(" "),t.formmodeedit?[a("li",{staticClass:"insertTr",class:" "+(t.operationAlert.topAddRow?"":"disbale")},[t._v("\n\t\t\t\t\t\t\t上方插入"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.upRowNum,expression:"upRowNum"}],attrs:{type:"text"},domProps:{value:t.upRowNum},on:{input:[function(e){e.target.composing||(t.upRowNum=e.target.value)},function(e){return t.totopvalue("up",e)}]}}),t._v("行\n\t\t\t\t\t\t\t"),a("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){t.operationAlert.topAddRow?t.addRow("up"):t.no}}})]),t._v(" "),a("li",{staticClass:"insertTr",class:" "+(t.operationAlert.bottomAddRow?"":"disbale")},[t._v("\n\t\t\t\t\t\t\t下方插入"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.downRowNum,expression:"downRowNum"}],attrs:{type:"text"},domProps:{value:t.downRowNum},on:{input:[function(e){e.target.composing||(t.downRowNum=e.target.value)},function(e){return t.totopvalue("down",e)}]}}),t._v("行\n\t\t\t\t\t\t\t"),a("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){t.operationAlert.bottomAddRow?t.addRow("down"):t.no}}})]),t._v(" "),a("li",{class:" "+(t.operationAlert.removeCol?"":"disbale"),on:{click:function(e){t.operationAlert.removeCol?t.removeCol():t.no}}},[t._v("\n\t\t\t\t\t\t\t删除当前列\n\t\t\t\t\t\t")]),t._v(" "),a("li",{staticClass:"insertTr",class:" "+(t.operationAlert.leftAddCol?"":"disbale")},[t._v("\n\t\t\t\t\t\t\t左侧插入"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.leftColNum,expression:"leftColNum"}],attrs:{type:"text"},domProps:{value:t.leftColNum},on:{input:[function(e){e.target.composing||(t.leftColNum=e.target.value)},function(e){return t.totopvalue("left",e)}]}}),t._v("列\n\t\t\t\t\t\t\t"),a("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){t.operationAlert.leftAddCol?t.addCol("left"):t.no}}})]),t._v(" "),a("li",{staticClass:"insertTr",class:" "+(t.operationAlert.rightAddCol?"":"disbale")},[t._v("\n\t\t\t\t\t\t\t右侧插入"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.rightColNum,expression:"rightColNum"}],attrs:{type:"text"},domProps:{value:t.rightColNum},on:{input:[function(e){e.target.composing||(t.rightColNum=e.target.value)},function(e){return t.totopvalue("right",e)}]}}),t._v("列\n\t\t\t\t\t\t\t"),a("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){t.operationAlert.rightAddCol?t.addCol("right"):t.no}}})]),t._v(" "),a("li",{class:" "+(t.operationAlert.removeTable?"":"disbale"),on:{click:function(e){t.operationAlert.removeTable?t.removeTable():t.no}}},[t._v("\n\t\t\t\t\t\t\t删除当前表\n\t\t\t\t\t\t")]),t._v(" "),a("li",{class:" "+(t.operationAlert.selectTable?"":"disbale"),on:{click:function(e){t.operationAlert.selectTable?t.selectTable():t.no}}},[t._v("\n\t\t\t\t\t\t\t选中当前表\n\t\t\t\t\t\t")])]:t._e()],2)]),t._v(" "),t.showoutbox?a("div",{staticClass:"outpluginbox"},[a("div",{staticClass:"contentbox"},t._l(t.setOutPluginList(t.plugin.plugins),(function(e,n){return a("div",{staticClass:"classBox"},[a("div",[t._v(t._s(e[0].pluginname)+"：")]),t._v(" "),a("div",{staticClass:"plugins"},[t._l(e,(function(e){return a("div",{staticClass:"plugin"},[a("div",{staticClass:"plugin_warp"},[a("allPluginV3",{attrs:{rtupdateInfo:t.rtupdateInfo,plugin:t.plugin,forminfo:t.formInfo,watchmessage:e},on:{sendmessage:t.setPluginValue,sendrtmessage:t.rtPostMessage}})],1)])})),t._v(" "),a("div",{staticClass:"clear"})],2)])})),0)]):t._e(),t._v(" "),!t.formmodeedit&&t.startDoOutPlugin?a("div",{staticStyle:{display:"none"}},[a("ul",t._l(t.plugin.plugins,(function(e){return 1==e.classtype?a("li",[a("span",[t._v(t._s(e.pluginname)+"：")]),t._v(" "),t.startDoOutPlugin?a("allPluginV3",{attrs:{pluginUpdateInfo:t.pluginUpdateInfo,plugin:t.plugin,forminfo:t.formInfo,watchmessage:e},on:{sendmessage:t.setPluginValue,tablesendmessage:t.tableSendMessage}}):t._e()],1):t._e()})),0)]):t._e()]),t._v(" "),t.formmodeedit?a("allPluginV3Attr",{attrs:{plugin:t.plugin,pluginSelect:t.selectPlugins,formBaseInfo:t.formBaseInfo,formModeData:t.formModeData},on:{sendmessage:t.setPluginValue}}):t._e(),t._v(" "),a("el-dialog",{attrs:{"custom-class":"module_info",title:"模块设置（移动端）",center:"","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,visible:t.isShowModuleSet},on:{"update:visible":function(e){t.isShowModuleSet=e}}},[a("div",{staticClass:"add_module"},[a("p",[t._v("\n\t\t\t\t\t模块：\n\t\t\t\t\t"),a("span",{staticStyle:{display:"inline-block",width:"200px"}},[a("el-input",{attrs:{placeholder:"请输入模块名称",type:"input",size:"small"},model:{value:t.addModuleName,callback:function(e){t.addModuleName="string"===typeof e?e.trim():e},expression:"addModuleName"}})],1),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.addModuleInfo(t.addModuleName)}}},[t._v("添加")])],1)]),t._v(" "),t.newModuleInfo.length?a("el-tabs",{attrs:{type:"card",closable:""},on:{"tab-remove":t.reduceModuleInfo},model:{value:t.selectModulekey,callback:function(e){t.selectModulekey=e},expression:"selectModulekey"}},[t._l(t.newModuleInfo,(function(e,n){return a("el-tab-pane",{key:e.key,attrs:{label:e.name,name:e.key}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n\t\t\t\t\t\t（"+t._s(n+1)+"）"+t._s(e.name)+"\n\t\t\t\t\t")]),t._v(" "),a("p",[t._v("\n\t\t\t\t\t\t搜索组件：\n\t\t\t\t\t\t"),a("span",{staticClass:"module_search"},[a("el-input",{attrs:{placeholder:"组名称或者组件名称",type:"input",size:"small"},model:{value:t.searchPName,callback:function(e){t.searchPName="string"===typeof e?e.trim():e},expression:"searchPName"}})],1),t._v("\n\t\t\t\t\t\t  \n\t\t\t\t\t\t模块名称：\n\t\t\t\t\t\t"),a("span",{staticClass:"module_name"},[a("el-input",{attrs:{placeholder:"模块名称",type:"input",size:"small"},model:{value:e.name,callback:function(a){t.$set(e,"name","string"===typeof a?a.trim():a)},expression:"moduleOne.name"}})],1),t._v("\n\t\t\t\t\t\t  \n\t\t\t\t\t\t调整位置：\n\t\t\t\t\t\t"),a("span",{staticClass:"module_postion"},[a("el-input",{attrs:{placeholder:"位置",type:"number",size:"small"},model:{value:t.moduleIndex,callback:function(e){t.moduleIndex="string"===typeof e?e.trim():e},expression:"moduleIndex"}})],1),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.sortModuleInfo(n)}}},[t._v("调整")])],1),t._v(" "),a("br"),t._v(" "),a("p",{staticClass:"plugin_list"},[t._v("\n\t\t\t\t\t\t组件列表：\n\t\t\t\t\t\t"),t.modulePlugins.length?t._l(t.modulePlugins,(function(n){return a("el-checkbox",{key:n.key,attrs:{disabled:t.moduleDisablePlugins.includes(n.key),label:n.key},model:{value:e.plugins,callback:function(a){t.$set(e,"plugins",a)},expression:"moduleOne.plugins"}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(n.description)+"\n\t\t\t\t\t\t\t")])})):[t._v("\n\t\t\t\t\t\t\t暂无符合条件的组件\n\t\t\t\t\t\t")]],2)])})),t._v(" "),a("br"),t._v(" "),a("p",{staticClass:"text_center"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){return t.setModuleCallback(!1)}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.setModuleCallback(!0)}}},[t._v("确定")])],1)],2):a("p",{},[t._v("\n\t\t\t\t暂无模块\n\t\t\t")])],1)],1)},Xi=[],Yi=(a("133e"),a("ddf9")),Ji=a("87fb"),Zi=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin_content"},[a("div",{staticClass:"titlebox"},[a("span",[t._v(t._s(t.nowPlugin.key?"控件属性":"表格属性"))])]),t._v(" "),t.nowPlugin.key?t._e():a("ul",{staticClass:"plugins"},[t.formBaseInfo.name?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("表单名称："+t._s(t.formBaseInfo.name))])])]):t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("纸张类型："+t._s(t.formBaseInfo.type))])])]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("环境变量：")]),t._v(" "),a("br"),t._v(" "),a("span",{staticClass:"formtitle"},[a("span",{staticClass:"redColor"},[t._v("1、重复表点开子表，当前重复表行的环境变量：")]),a("br"),t._v(" "),a("span",[t._v("\n            $EVN.childrow_指定列的key，如：$EVN.childrow_Input_1\n          ")]),t._v(" "),a("br"),a("br"),t._v(" "),a("span",{staticClass:"redColor"},[t._v("2、当前url中的参数环境变量：")]),a("br"),t._v(" "),a("span",[t._v("\n            $EVN.url_指定的参数名，如：$EVN.url_id\n          ")]),t._v(" "),a("br"),a("br"),t._v(" "),a("span",{staticClass:"redColor"},[t._v("3、当前事项环境变量：")]),a("br"),t._v(" "),t._l(t.evns,(function(e){return[a("span",[t._v("\n              参数："+t._s(e.name)+"，变量名：$EVN.matter_"+t._s(e.key)+"\n            ")]),a("br")]})),t._v(" "),a("span",{staticClass:"redColor"},[t._v("4、当前表单控件环境变量：")]),a("br"),t._v(" "),t._m(6),a("br")],2)])])]),t._v(" "),t.nowPlugin.key?a("ul",{staticClass:"plugins"},[t.isShowAttr()&&t.nowPlugin&&"dRichText"!=t.nowPlugin.type?a("li",{staticClass:"plugin-item fontcs"},[a("div",{staticClass:"select_fontfamily select_box"},[a("div",{staticClass:"value"},[a("span",{attrs:{title:t.getNameByValue("fontFamilys",t.nowPlugin.attr.style.fontFamily)}},[t._v(t._s(t.getNameByValue("fontFamilys",t.nowPlugin.attr.style.fontFamily)))]),t._v(" "),a("i",{staticClass:"xiala"})]),t._v(" "),a("div",{staticClass:"options"},t._l(t.fontFamilys,(function(e){return a("span",{staticClass:"option",attrs:{title:e.name},on:{click:function(a){return t.setAttr("fontFamily",e.value)}}},[t._v(t._s(e.name))])})),0)]),t._v(" "),a("div",{staticClass:"select_fontsize select_box"},[a("div",{staticClass:"value"},[a("span",[t._v(t._s(t.getNameByValue("fontSizes",t.nowPlugin.attr.style.fontSize)))]),t._v(" "),a("i",{staticClass:"xiala_h"})]),t._v(" "),a("div",{staticClass:"options"},t._l(t.fontSizes,(function(e){return a("span",{staticClass:"option",on:{click:function(a){return t.setAttr("fontSize",e.value)}}},[t._v(t._s(e.name))])})),0)]),t._v(" "),a("div",{staticClass:"select_fontcolor select_box"},[a("el-color-picker",{attrs:{size:"mini"},on:{change:t.dataChange},model:{value:t.nowPlugin.attr.style.color,callback:function(e){t.$set(t.nowPlugin.attr.style,"color",e)},expression:"nowPlugin.attr.style.color"}})],1)]):t._e(),t._v(" "),t.isShowAttr()&&t.nowPlugin&&"dRichText"!=t.nowPlugin.type?a("li",{staticClass:"plugin-item fontstyle"},[a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("normal"==t.nowPlugin.attr.style.fontWeight?"":"selected")},[a("i",{staticClass:"plugin_icon jiachu",on:{click:function(e){return t.setAttr("fontWeight")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("normal"==t.nowPlugin.attr.style.fontStyle?"":"selected")},[a("i",{staticClass:"plugin_icon xieti",on:{click:function(e){return t.setAttr("fontStyle")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("none"==t.nowPlugin.attr.style.textDecoration?"":"selected")},[a("i",{staticClass:"plugin_icon xiahuaxian",on:{click:function(e){return t.setAttr("textDecoration")}}})])]),t._v(" "),t._m(7),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("left"==t.nowPlugin.attr.style.textAlign?"selected":"")},[a("i",{staticClass:"plugin_icon alignleft",on:{click:function(e){return t.setAttr("textAlign","left")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("center"==t.nowPlugin.attr.style.textAlign?"selected":"")},[a("i",{staticClass:"plugin_icon aligncenter",on:{click:function(e){return t.setAttr("textAlign","center")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("right"==t.nowPlugin.attr.style.textAlign?"selected":"")},[a("i",{staticClass:"plugin_icon alignright",on:{click:function(e){return t.setAttr("textAlign","right")}}})])]),t._v(" "),a("div",{staticClass:"plugin"},[a("div",{class:"plugin_warp "+("justify"==t.nowPlugin.attr.style.textAlign?"selected":"")},[a("i",{staticStyle:{width:"40px",display:"inline-block"},on:{click:function(e){return t.setAttr("textAlign","justify")}}},[t._v("两端")])])])]):t._e(),t._v(" "),t.nowPlugin&&"dRichText"!=t.nowPlugin.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("移动端显示：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.mobileshow,expression:"nowPlugin.mobileshow"}],attrs:{type:"radio",name:"mobilestatus"},domProps:{value:!0,checked:t._q(t.nowPlugin.mobileshow,!0)},on:{change:[function(e){return t.$set(t.nowPlugin,"mobileshow",!0)},t.dataChange]}}),t._v("\n            \n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.mobileshow,expression:"nowPlugin.mobileshow"}],attrs:{type:"radio",name:"mobilestatus"},domProps:{value:!1,checked:t._q(t.nowPlugin.mobileshow,!1)},on:{change:[function(e){return t.$set(t.nowPlugin,"mobileshow",!1)},t.dataChange]}})])])]):t._e(),t._v(" "),t.nowPlugin.mobileshow?[t.isShowAttr()&&t.nowPlugin&&"dRichText"!=t.nowPlugin.type?a("li",{staticClass:"plugin-item fontcs mobile_title_style"},[a("div",{staticClass:"select_fontfamily select_box"},[a("div",{staticClass:"value"},[a("span",{attrs:{title:t.getNameByValue("fontFamilys",t.nowPlugin.attr.style.mobileTitleStyle.fontFamily)}},[t._v(t._s(t.getNameByValue("fontFamilys",t.nowPlugin.attr.style.mobileTitleStyle.fontFamily)))]),t._v(" "),a("i",{staticClass:"xiala"})]),t._v(" "),a("div",{staticClass:"options"},t._l(t.fontFamilys,(function(e){return a("span",{staticClass:"option",attrs:{title:e.name},on:{click:function(a){return t.setAttr("mt_fontFamily",e.value)}}},[t._v(t._s(e.name))])})),0)]),t._v(" "),a("div",{staticClass:"select_fontsize select_box"},[a("div",{staticClass:"value"},[a("span",[t._v(t._s(t.getNameByValue("fontSizes",t.nowPlugin.attr.style.mobileTitleStyle.fontSize)))]),t._v(" "),a("i",{staticClass:"xiala_h"})]),t._v(" "),a("div",{staticClass:"options"},t._l(t.fontSizes,(function(e){return a("span",{staticClass:"option",on:{click:function(a){return t.setAttr("mt_fontSize",e.value)}}},[t._v(t._s(e.name))])})),0)]),t._v(" "),a("div",{staticClass:"select_fontcolor select_box"},[a("el-color-picker",{attrs:{size:"mini"},on:{change:t.dataChange},model:{value:t.nowPlugin.attr.style.mobileTitleStyle.color,callback:function(e){t.$set(t.nowPlugin.attr.style.mobileTitleStyle,"color",e)},expression:"nowPlugin.attr.style.mobileTitleStyle.color"}})],1),t._v(" "),a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("行高：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.attr.style.mobileTitleStyle.lineHeight,expression:"nowPlugin.attr.style.mobileTitleStyle.lineHeight"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.attr.style.mobileTitleStyle.lineHeight},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin.attr.style.mobileTitleStyle,"lineHeight",e.target.value)}}})])])]):t._e()]:t._e(),t._v(" "),t.nowPlugin&&"dRichText"!=t.nowPlugin.type?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("打印时是否重置颜色：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._v("\n          是\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.printResetColor,expression:"nowPlugin.printResetColor"}],attrs:{type:"radio",name:"printResetColor"},domProps:{value:!0,checked:t._q(t.nowPlugin.printResetColor,!0)},on:{change:[function(e){return t.$set(t.nowPlugin,"printResetColor",!0)},t.dataChange]}}),t._v("\n            \n          否\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.printResetColor,expression:"nowPlugin.printResetColor"}],attrs:{type:"radio",name:"printResetColor"},domProps:{value:!1,checked:t._q(t.nowPlugin.printResetColor,!1)},on:{change:[function(e){return t.$set(t.nowPlugin,"printResetColor",!1)},t.dataChange]}})])])]):t._e(),t._v(" "),a("li",{staticClass:"plugin-itembox"},[t.nowPlugin&&"dOneInput"==t.nowPlugin.type?a("dOneInputAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dIntegerInput"==t.nowPlugin.type?a("dIntegerInputAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dNumericInput"==t.nowPlugin.type?a("dNumericInputAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dmultiText"==t.nowPlugin.type?a("dmultiTextAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dmultiInputs"==t.nowPlugin.type?a("dmultiInputAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSelect"==t.nowPlugin.type?a("dSelectAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSelectV2"==t.nowPlugin.type?a("dSelectV2Attr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dInput"==t.nowPlugin.type?a("dInputAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRadio"==t.nowPlugin.type?a("dRadioAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dCheckbox"==t.nowPlugin.type?a("dCheckboxAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dImage"==t.nowPlugin.type?a("dImageAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dXImage"==t.nowPlugin.type?a("dXimageAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dUser"==t.nowPlugin.type?a("dUserAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dCountryV2"==t.nowPlugin.type?a("dCountryV2Attr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dOpinion"==t.nowPlugin.type?a("dOpinionAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dCalendar"==t.nowPlugin.type?a("dCalendarAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dUserSearch"==t.nowPlugin.type?a("dUserSearchAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dLink"==t.nowPlugin.type?a("dLinkAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dFile"==t.nowPlugin.type?a("dFileAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,formModeData:t.formModeData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dDepart"==t.nowPlugin.type?a("dDepartAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dJoinSign"==t.nowPlugin.type?a("dJoinSignAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dProjectNumber"==t.nowPlugin.type?a("dProjectNumberAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dPasswd"==t.nowPlugin.type?a("dPasswdAttr",{attrs:{pluginAttrData:t.nowPlugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dBinding"==t.nowPlugin.type?a("dBindingAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dQuote"==t.nowPlugin.type?a("dQuoteAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSeal"==t.nowPlugin.type?a("dSealAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dMultiple"==t.nowPlugin.type?a("dMultipleAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dAvatar"==t.nowPlugin.type?a("dAvatarAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dCount"==t.nowPlugin.type?a("dCountAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRegion"==t.nowPlugin.type?a("dRegionAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dShowHide"==t.nowPlugin.type?a("dShowHideAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dPayment"==t.nowPlugin.type?a("dPaymentAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dQrcode"==t.nowPlugin.type?a("dQrcode",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRepeatTable"==t.nowPlugin.type?a("dRepeatTableAttrV3",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dDataSource"==t.nowPlugin.type?a("dDataSourceAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSync"==t.nowPlugin.type?a("dSyncAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dShow"==t.nowPlugin.type?a("dShowAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dValidate"==t.nowPlugin.type?a("dValidateAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dAlert"==t.nowPlugin.type?a("dAlertAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dVariate"==t.nowPlugin.type?a("dVariateAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSerial"==t.nowPlugin.type?a("dSerialAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dChildTable"==t.nowPlugin.type?a("dChildTableAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dTable"==t.nowPlugin.type?a("dTableAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dOneColumn"==t.nowPlugin.type?a("dOneColumnAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dArticle"==t.nowPlugin.type?a("dArticleAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData,plugin:t.plugin},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dConversion"==t.nowPlugin.type?a("dConversionAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRichText"==t.nowPlugin.type?a("dRichtextAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dSubmit"==t.nowPlugin.type?a("dSubmitAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dRoom"==t.nowPlugin.type?a("dRoomAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e(),t._v(" "),t.nowPlugin&&"dOcr"==t.nowPlugin.type?a("dOcrAttr",{attrs:{pluginAttrData:t.nowPlugin,pluginData:t.allPluginData},on:{sendmessage:t.postMessage}}):t._e()],1),t._v(" "),t.isShowAttr()?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("上间距：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.attr.style.marginTop,expression:"nowPlugin.attr.style.marginTop"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.attr.style.marginTop},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin.attr.style,"marginTop",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("下间距：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.attr.style.marginBottom,expression:"nowPlugin.attr.style.marginBottom"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.attr.style.marginBottom},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin.attr.style,"marginBottom",e.target.value)}}})])])]):t._e(),t._v(" "),t.isShowAttr()?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("行高：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.attr.style.lineHeight,expression:"nowPlugin.attr.style.lineHeight"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.attr.style.lineHeight},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin.attr.style,"lineHeight",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"formitem marginLeft20"},[a("span",{staticClass:"formtitle"},[t._v("文字间距：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.attr.style.letterSpacing,expression:"nowPlugin.attr.style.letterSpacing"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.attr.style.letterSpacing},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin.attr.style,"letterSpacing",e.target.value)}}})])])]):t._e(),t._v(" "),t.isPublic?t._e():[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("排序：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.sort,expression:"nowPlugin.sort"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.sort},on:{keyup:t.dataChange,input:[function(e){e.target.composing||t.$set(t.nowPlugin,"sort",e.target.value)},t.sortChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("字段名称：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.key,expression:"nowPlugin.key"}],attrs:{type:"text",readonly:"readonly"},domProps:{value:t.nowPlugin.key},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin,"key",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("字段含义：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.description,expression:"nowPlugin.description"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.description},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin,"description",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"desc"},[t._v("（统计表格时使用，必填）")])])]),t._v(" "),t.isShowAttr()?a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("组名称：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.nowPlugin.groupname,expression:"nowPlugin.groupname"}],attrs:{type:"text"},domProps:{value:t.nowPlugin.groupname},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.nowPlugin,"groupname",e.target.value)}}})])])]):t._e()],t._v(" "),a("li",{staticClass:"clearboth"})],2):t._e()])},Qi=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件多选快捷键：\n          "),a("strong",[t._v("shift + 鼠标单击")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件和表格取消选中快捷键：\n          "),a("strong",[t._v("shift + r")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件删除快捷键：\n          "),a("strong",[t._v("shift + d")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件复制快捷键：\n          "),a("strong",[t._v("shift + c")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件粘贴快捷键：\n          "),a("strong",[t._v("shift + v")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("\n          组件剪切快捷键：\n          "),a("strong",[t._v("shift + x")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t._v("\n            1.$EVN.formData_all+表单id   表单所有控件data"),a("br"),t._v("\n            如：$EVN.formData_all1818\n            2.$EVN.formData+表单id_控件字段名称，"),a("br"),t._v("\n            如：$EVN.formData1818_Input_1\n            3.$EVN.formData+表单id_控件字段名称.对象key，"),a("br"),t._v("\n            如：$EVN.formData1818_Select_63.value\n          ")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"plugin"},[a("div",{staticClass:"xian"})])}],tr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key&&t.pluginAttrData.attr.setInfo?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("按钮显示：")]),t._v(" "),a("div",{staticClass:"formlinebox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.add,expression:"pluginAttrData.attr.setInfo.buttons.add"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.add)?t._i(t.pluginAttrData.attr.setInfo.buttons.add,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.add},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.add,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"add",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"add",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"add",i)},t.dataChange]}}),t._v("添加\n          \n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.del,expression:"pluginAttrData.attr.setInfo.buttons.del"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.del)?t._i(t.pluginAttrData.attr.setInfo.buttons.del,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.del},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.del,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"del",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"del",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"del",i)},t.dataChange]}}),t._v("删除\n          \n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.export,expression:"pluginAttrData.attr.setInfo.buttons.export"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.export)?t._i(t.pluginAttrData.attr.setInfo.buttons.export,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.export},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.export,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"export",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"export",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"export",i)},t.dataChange]}}),t._v("导出\n          \n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.sort,expression:"pluginAttrData.attr.setInfo.buttons.sort"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.sort)?t._i(t.pluginAttrData.attr.setInfo.buttons.sort,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.sort},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.sort,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"sort",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"sort",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"sort",i)},t.dataChange]}}),t._v("排序\n          \n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.copy,expression:"pluginAttrData.attr.setInfo.buttons.copy"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.copy)?t._i(t.pluginAttrData.attr.setInfo.buttons.copy,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.copy},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.copy,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"copy",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"copy",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"copy",i)},t.dataChange]}}),t._v("复制\n          \n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.listSort,expression:"pluginAttrData.attr.setInfo.buttons.listSort"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.listSort)?t._i(t.pluginAttrData.attr.setInfo.buttons.listSort,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.listSort},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.listSort,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"listSort",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"listSort",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"listSort",i)},t.dataChange]}}),t._v("指定列排序\n        "),a("br"),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.refresh,expression:"pluginAttrData.attr.setInfo.buttons.refresh"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.refresh)?t._i(t.pluginAttrData.attr.setInfo.buttons.refresh,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.refresh},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.refresh,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"refresh",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"refresh",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"refresh",i)},t.dataChange]}}),t._v("同步\n        "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.refreshType,expression:"pluginAttrData.attr.setInfo.refreshType"}],staticStyle:{width:"100px"},attrs:{disabled:!t.pluginAttrData.attr.setInfo.buttons.refresh},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.setInfo,"refreshType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:0}},[t._v("覆盖同步")]),t._v(" "),a("option",{domProps:{value:1}},[t._v("指定数据追加同步")])]),t._v(" "),a("br"),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.buttons.import,expression:"pluginAttrData.attr.setInfo.buttons.import"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.buttons.import)?t._i(t.pluginAttrData.attr.setInfo.buttons.import,!0)>-1:t.pluginAttrData.attr.setInfo.buttons.import},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.buttons.import,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"import",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo.buttons,"import",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo.buttons,"import",i)},t.dataChange]}}),t._v("导入:\n        "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.importType,expression:"pluginAttrData.attr.setInfo.importType"}],staticStyle:{width:"100px","margin-left":"34px"},attrs:{disabled:!t.pluginAttrData.attr.setInfo.buttons.import},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.setInfo,"importType",e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:0}},[t._v("追加导入")]),t._v(" "),a("option",{domProps:{value:1}},[t._v("覆盖导入")]),t._v(" "),a("option",{domProps:{value:2}},[t._v("按列导入")])]),t._v(" "),a("br"),t._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.lock,expression:"pluginAttrData.attr.setInfo.lock"},{name:"show",rawName:"v-show",value:2==t.pluginAttrData.attr.setInfo.importType,expression:"pluginAttrData.attr.setInfo.importType == 2"}],staticStyle:{width:"100px","margin-left":"85px"},attrs:{disabled:!t.pluginAttrData.attr.setInfo.buttons.import},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.setInfo,"lock",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.setInfo.importBind,(function(e,n){return a("option",{key:n,domProps:{value:e}},[t._v(t._s(e))])})),0),t._v(" "),a("br"),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.showIndex,expression:"pluginAttrData.attr.setInfo.showIndex"}],attrs:{type:"checkbox"},domProps:{value:!0,checked:Array.isArray(t.pluginAttrData.attr.setInfo.showIndex)?t._i(t.pluginAttrData.attr.setInfo.showIndex,!0)>-1:t.pluginAttrData.attr.setInfo.showIndex},on:{change:[function(e){var a=t.pluginAttrData.attr.setInfo.showIndex,n=e.target,i=!!n.checked;if(Array.isArray(a)){var r=!0,s=t._i(a,r);n.checked?s<0&&t.$set(t.pluginAttrData.attr.setInfo,"showIndex",a.concat([r])):s>-1&&t.$set(t.pluginAttrData.attr.setInfo,"showIndex",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.pluginAttrData.attr.setInfo,"showIndex",i)},t.dataChange]}}),t._v("自增序号：\n        "),a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.indexAssembly,expression:"pluginAttrData.attr.setInfo.indexAssembly"}],staticStyle:{width:"100px"},attrs:{disabled:!t.pluginAttrData.attr.setInfo.showIndex},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.setInfo,"indexAssembly",e.target.multiple?a:a[0])},t.dataChange]}},t._l(t.pluginAttrData.attr.setInfo.indexList,(function(e,n){return a("option",{key:n,domProps:{value:n}},[t._v(t._s(e))])})),0)])]),t._v(" "),a("div",{staticClass:"formitem"},[a("div",{staticClass:"formtitle"},[t._v("添加范围：")]),t._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[t._v("\n        最小行数:\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.minline,expression:"pluginAttrData.attr.setInfo.minline"}],staticStyle:{width:"50px","margin-left":"10px"},attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.setInfo.minline},on:{change:function(e){return t.dataChange()},input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo,"minline",e.target.value)}}})]),t._v(" "),a("span",{staticStyle:{"margin-left":"28px"}},[t._v("\n        最大行数:\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.maxline,expression:"pluginAttrData.attr.setInfo.maxline"}],staticStyle:{width:"50px","margin-left":"10px"},attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.setInfo.maxline},on:{change:function(e){return t.dataChange()},input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo,"maxline",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("div",{staticClass:"formtitle"},[t._v("\n        移动端添加按钮文案：\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.m_addContent,expression:"pluginAttrData.attr.setInfo.m_addContent"}],staticStyle:{width:"138px","margin-left":"10px"},attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.setInfo.m_addContent},on:{input:[function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo,"m_addContent",e.target.value)},function(e){return t.dataChange()}]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("div",{staticClass:"formtitle"},[t._v("\n        无数据时自动添加一行：\n        否\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.initAddOne,expression:"pluginAttrData.attr.setInfo.initAddOne"}],attrs:{name:"defaultOrApi",type:"radio"},domProps:{value:!1,checked:t._q(t.pluginAttrData.attr.setInfo.initAddOne,!1)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.setInfo,"initAddOne",!1)},t.dataChange]}}),t._v("\n          \n        是\n        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.initAddOne,expression:"pluginAttrData.attr.setInfo.initAddOne"}],attrs:{name:"defaultOrApi",type:"radio"},domProps:{value:!0,checked:t._q(t.pluginAttrData.attr.setInfo.initAddOne,!0)},on:{change:[function(e){return t.$set(t.pluginAttrData.attr.setInfo,"initAddOne",!0)},t.dataChange]}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("pc端每页显示行数：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：不设置或者设置为0，不显示分页）")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.pageSize,expression:"pluginAttrData.attr.setInfo.pageSize"}],attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.setInfo.pageSize},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo,"pageSize",e.target.value)}}})])])]),t._v(" "),t._m(0),t._v(" "),t.pluginAttrData.attr.setInfo.depriveObj?a("li",{staticClass:"plugin-item select-tablebox"},[a("el-checkbox-group",{on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.setInfo.depriveObj,callback:function(e){t.$set(t.pluginAttrData.attr.setInfo,"depriveObj",e)},expression:"pluginAttrData.attr.setInfo.depriveObj"}},[t._l(t.pluginAttrData.attr.setInfo.importBind,(function(e,n){return[a("el-checkbox",{attrs:{label:n}},[t._v(t._s(t.pluginData[n].description))])]}))],2)],1):t._e(),t._v(" "),t.pluginAttrData.attr.setInfo.buttons.import?[t._m(1),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(2),t._v(" "),t._l(t.pluginAttrData.attr.setInfo.importBind,(function(e,n){return a("tr",[a("td",{staticClass:"textAlignC"},[t._v(t._s(t.pluginData[n].description))]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.importBind[n],expression:"pluginAttrData.attr.setInfo.importBind[impkey]"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.setInfo.importBind[n]},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo.importBind,n,e.target.value)}}})])])}))],2)])]:t._e(),t._v(" "),t.pluginAttrData.attr.setInfo.buttons.export?[t._m(3),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(4),t._v(" "),t._l(t.pluginAttrData.attr.setInfo.exportBind,(function(e,n){return a("tr",[a("td",{staticClass:"textAlignC"},[t._v(t._s(t.pluginData[n].description))]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.exportBind[n],expression:"pluginAttrData.attr.setInfo.exportBind[impkey]"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.setInfo.exportBind[n]},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.setInfo.exportBind,n,e.target.value)}}})])])}))],2)])]:t._e(),t._v(" "),t.pluginAttrData.attr.setInfo.buttons.listSort?[t._m(5),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(6),t._v(" "),t._l(t.pluginAttrData.attr.setInfo.sortBind,(function(e,n){return a("tr",[a("td",{staticClass:"textAlignC"},[t._v(t._s(t.pluginData[n].description))]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.setInfo.sortBind[n],expression:"pluginAttrData.attr.setInfo.sortBind[impkey]"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.pluginAttrData.attr.setInfo.sortBind,n,e.target.multiple?a:a[0])},t.dataChange]}},[a("option",{domProps:{value:0}},[t._v("默认")]),t._v(" "),a("option",{domProps:{value:1}},[t._v("正倒序排序")])])])])}))],2)])]:t._e()],2):t._e()},er=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("选中剥夺列：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：选中的列在重复表可写状态，列宽会根据操作列的显示变小）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定导入列：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：没有绑定列名的列，将不导入数据）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("选中列")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("列名")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定导出列：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：没有绑定列名的列，将不导出数据）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("选中列")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("列名")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定列表排序：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("(注意：请导入绑定列名的列，排序需手动进行排序）")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("选中列")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("排列规则")])])}],ar={name:"dRepeatTable",props:["sendmessage","pluginAttrData","pluginData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},setImportPlugin:function(){var t=this,e={};this.pluginAttrData.attr.data.tableData.trs[1].tds.forEach((function(a){if(!a.dataid)return!1;e[a.dataid]=void 0!=t.pluginAttrData.attr.setInfo.importBind[a.dataid]?t.pluginAttrData.attr.setInfo.importBind[a.dataid]:t.pluginData[a.dataid].description})),this.pluginAttrData.attr.setInfo.importBind=e,this.dataChange()},seteIndexPlugin:function(){this.pluginAttrData.attr.setInfo.indexList={};var t=this,e={};this.pluginAttrData.attr.data.tableData.trs[1].tds.forEach((function(a){if(!a.dataid)return!1;-1==a.dataid.indexOf("Input")&&-1==a.dataid.indexOf("Integer")&&-1==a.dataid.indexOf("Text")||(e[a.dataid]=t.pluginAttrData.attr.setInfo.indexList[a.dataid]||t.pluginData[a.dataid].description)})),this.pluginAttrData.attr.setInfo.indexList=e,this.dataChange()},seteExportPlugin:function(){var t=this,e={};this.pluginAttrData.attr.data.tableData.trs[1].tds.forEach((function(a){if(!a.dataid)return!1;e[a.dataid]=void 0!=t.pluginAttrData.attr.setInfo.exportBind[a.dataid]?t.pluginAttrData.attr.setInfo.exportBind[a.dataid]:t.pluginData[a.dataid].description})),this.pluginAttrData.attr.setInfo.exportBind=e,this.dataChange()},setSortPlugin:function(){var t=this,e={};this.pluginAttrData.attr.data.tableData.trs[0].tds.forEach((function(a){if(!a.dataid)return!1;-1!=a.dataid.indexOf("Text")&&(e[a.dataid]=t.pluginAttrData.attr.setInfo.sortBind[a.dataid]?t.pluginAttrData.attr.setInfo.sortBind[a.dataid]:t.pluginData[a.dataid].attr.data.showSort)})),this.pluginAttrData.attr.setInfo.sortBind=e,this.dataChange()}},mounted:function(){this.setImportPlugin(),this.seteExportPlugin(),this.seteIndexPlugin(),this.setSortPlugin()}},nr=ar,ir=Object(m["a"])(nr,tr,er,!1,null,null,null),rr=ir.exports,sr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key?a("ul",{staticClass:"ul-ctrl-selfbd"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("边框：")]),t._v(" "),a("div",{staticClass:"formradio"},[t._l(t.borderTypes,(function(e){return[t._v("\n                        "+t._s(e.name)+" \n                        "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.borderType,expression:"pluginAttrData.attr.data.borderType"}],attrs:{name:"type",type:"radio"},domProps:{value:e.value,checked:t._q(t.pluginAttrData.attr.data.borderType,e.value)},on:{click:t.dataChange,change:function(a){return t.$set(t.pluginAttrData.attr.data,"borderType",e.value)}}}),t._v("\n                          \n                    ")]}))],2)])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认高度：")]),t._v(" "),a("div",{staticClass:"formline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.style.minHeight,expression:"pluginAttrData.attr.style.minHeight"}],staticClass:"ctrl-resize",attrs:{type:"number"},domProps:{value:t.pluginAttrData.attr.style.minHeight},on:{keyup:function(e){return t.changeheight(e,"height")},input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.style,"minHeight",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("默认文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.placeholder,expression:"pluginAttrData.attr.data.placeholder"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.attr.data.placeholder},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"placeholder",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("占位文字：")]),t._v(" "),a("div",{staticClass:"forminput"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.data,expression:"pluginAttrData.data"}],attrs:{type:"text"},domProps:{value:t.pluginAttrData.data},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData,"data",e.target.value)}}})])])])]):t._e()},or=[],lr={name:"articleAttr",props:["sendmessage","pluginAttrData"],data:function(){return{borderTypes:[{name:"显示",value:1},{name:"不显示",value:0}]}},methods:{changeheight:function(t,e){"height"==e&&("ArrowUp"==t.code?this.pluginAttrData.attr.style.minHeight++:"ArrowDown"==t.code&&this.pluginAttrData.attr.style.minHeight>24?this.pluginAttrData.attr.style.minHeight--:this.pluginAttrData.attr.style.minHeight+=t.target.innerText),this.dataChange()},dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)}}},ur=lr,dr=Object(m["a"])(ur,sr,or,!1,null,null,null),cr=dr.exports,pr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.pluginAttrData.key&&t.pluginAttrData.attr.setInfo?a("ul",{staticClass:"plugins"},[a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("文字描述：")]),t._v(" "),a("div",{staticClass:"forminput formtextarea"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.pluginAttrData.attr.data.desc,expression:"pluginAttrData.attr.data.desc"}],domProps:{value:t.pluginAttrData.attr.data.desc},on:{keyup:t.dataChange,input:function(e){e.target.composing||t.$set(t.pluginAttrData.attr.data,"desc",e.target.value)}}})])])]),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("绑定API：")]),t._v(" "),a("div",{staticClass:"formradio"},[a("el-select",{attrs:{size:"mini",filterable:"",placeholder:"请选择"},on:{change:function(e){return t.apiChange(1)}},model:{value:t.pluginAttrData.attr.data.api,callback:function(e){t.$set(t.pluginAttrData.attr.data,"api",e)},expression:"pluginAttrData.attr.data.api"}},t._l(t.apis,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1)],1)])]),t._v(" "),a("a",{staticClass:"redColor toCursor",staticStyle:{"font-size":"12px"},attrs:{href:"javascript:;"},on:{click:function(e){t.dialogVisibleExplain=!0}}},[t._v("点击查看数据说明")]),t._v(" "),t.pluginAttrData.attr.data.api?[t._m(0),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},t._l(t.apiParam,(function(e,n){return a("tr",{key:n},[a("td",{staticClass:"textAlignC"},[1==e.required?a("span",{staticClass:"redColor"},[t._v("*")]):t._e(),t._v("\n            "+t._s(e.name)+"\n          ")]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择","popper-class":"ocr_attr_select"},on:{change:t.dataChange},model:{value:t.pluginAttrData.attr.data.apiData[e.field],callback:function(a){t.$set(t.pluginAttrData.attr.data.apiData,e.field,a)},expression:"pluginAttrData.attr.data.apiData[item.field]"}},t._l(e.range,(function(e,n){return a("el-option",{key:n,attrs:{label:e.key,value:e.value}},[a("span",{staticClass:"ocr_attr_select_label",attrs:{title:e.key}},[t._v(t._s(e.key))])])})),1)],1)])})),0)])]:t._e(),t._v(" "),a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("数据绑定到列：")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("\n        (注意：没有绑定列名的列，将不写入数据，如果列名出现“组件消失”字样，请点击下方按钮刷新绑定，并保存当前表单。）\n        "),a("br"),t._v(" "),a("span",{staticClass:"redColor toCursor",on:{click:t.refreshPluginMap}},[t._v("点击刷新绑定")])])])]),t._v(" "),a("li",{staticClass:"plugin-item select-tablebox"},[a("table",{staticClass:"select-table"},[t._m(1),t._v(" "),t._l(t.pluginAttrData.attr.data.mapConfig,(function(e,n){return[a("tr",{key:n},[a("td",{staticClass:"textAlignC"},[t.pluginData[n]?a("span",[t._v(t._s(t.getPluginName(t.pluginData[n])))]):a("span",{staticClass:"redColor"},[t._v("组件消失")])]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择","popper-class":"ocr_attr_select"},on:{change:t.dataChange},model:{value:e.key,callback:function(a){t.$set(e,"key",a)},expression:"mapConfigOne.key"}},t._l(t.mapConfig,(function(e,n){return a("el-option",{key:n,attrs:{label:e.value,value:e.key}},[a("span",{staticClass:"ocr_attr_select_label",attrs:{title:e.value}},[t._v(t._s(e.value))])])})),1)],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("span",{on:{click:function(e){return t.delMapConfig(n)}}},[t._v("删除")])])]),t._v(" "),n.includes("RepeatTable")&&e.key&&t.cMapConfig(e.key)?[a("tr",{key:"c_"+n},[a("td",{attrs:{colspan:"3"}},[a("table",{staticClass:"select-table select-rtable"},[t._m(2,!0),t._v(" "),t._l(e.children,(function(i,r){return[a("tr",{key:r},[a("td",{staticClass:"textAlignC"},[t.pluginData[n]?a("span",[t._v(t._s(t.getPluginName(t.pluginData[r])))]):a("span",{staticClass:"redColor"},[t._v("组件消失")])]),t._v(" "),a("td",{staticClass:"textAlignC"},[a("el-select",{attrs:{size:"mini",placeholder:"请选择","popper-class":"ocr_attr_select"},on:{change:t.dataChange},model:{value:i.key,callback:function(e){t.$set(i,"key",e)},expression:"cMapConfigOne.key"}},t._l(t.cMapConfig(e.key),(function(e){return a("el-option",{key:e.key,attrs:{label:e.value,value:e.key}},[a("span",{staticClass:"ocr_attr_select_label",attrs:{title:e.value}},[t._v(t._s(e.value))])])})),1)],1),t._v(" "),a("td",{staticClass:"textAlignC"},[a("span",{on:{click:function(e){return t.delMapConfig(r,n)}}},[t._v("删除")])])])]})),t._v(" "),a("tr",[a("td",{attrs:{colspan:"2"}},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},model:{value:t.selectCPluginKey,callback:function(e){t.selectCPluginKey=e},expression:"selectCPluginKey"}},[t._l(t.pluginData,(function(e){return[e.pkey!=n||["dOneInput","dmultiText"].includes(e.type)?t._e():a("el-option",{key:e.key,attrs:{label:t.getPluginName(e),value:e.key}})]}))],2)],1),t._v(" "),a("td",{attrs:{colspan:"1"}},[a("span",{on:{click:function(e){return t.addMapConfig(n)}}},[t._v("新增")])])])],2)])])]:t._e()]})),t._v(" "),a("tr",[a("td",{attrs:{colspan:"2"}},[a("el-select",{attrs:{filterable:"",size:"mini",placeholder:"请选择"},model:{value:t.selectPluginKey,callback:function(e){t.selectPluginKey=e},expression:"selectPluginKey"}},[t._l(t.canPlugins,(function(e){return[t.pluginAttrData.attr.data.mapConfig[e.key]?t._e():a("el-option",{key:e.key,attrs:{label:t.getPluginName(e),value:e.key}})]}))],2)],1),t._v(" "),a("td",{attrs:{colspan:"1"}},[a("span",{on:{click:function(e){return t.addMapConfig("")}}},[t._v("新增")])])])],2)]),t._v(" "),a("el-dialog",{staticClass:"d_ocr_attr_dialog",attrs:{title:"数据说明",visible:t.dialogVisibleExplain,width:"500px"},on:{"update:visible":function(e){t.dialogVisibleExplain=e}}},[t._v("\n    【银行卡类型】\n    "),a("br"),t._v("0:不能识别; 1: 借记卡; 2: 信用卡\n    "),a("br"),t._v(" "),a("br"),t._v("【图像方向】\n    "),a("br"),t._v("- -1:未定义;\n    "),a("br"),t._v("- 0:正向;\n    "),a("br"),t._v("- 1: 逆时针90度;\n    "),a("br"),t._v("- 2:逆时针180度;\n    "),a("br"),t._v("- 3:逆时针270度\n    "),a("br"),t._v(" "),a("br"),t._v("【是否开启身份证风险类型】\n    "),a("br"),t._v("是否开启身份证风险类型(身份证复印件、临时身份证、身份证翻拍、修改过的身份证)功能\n    "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.dialogVisibleExplain=!1}}},[t._v("关 闭")])],1)])],2):t._e()},hr=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"plugin-item"},[a("div",{staticClass:"formitem"},[a("span",{staticClass:"formtitle"},[t._v("API请求参数：")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("组件")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("字段")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("th",{staticClass:"textAlignC"},[t._v("组件")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("字段")]),t._v(" "),a("th",{staticClass:"textAlignC"},[t._v("操作")])])}],gr={name:"dOcrattr",data:function(){return{apis:[],dialogVisibleExplain:!1,canPlugins:[],selectPluginKey:"",selectCPluginKey:"",mapConfig:[],apiParam:[]}},props:["sendmessage","pluginAttrData","pluginData"],methods:{dataChange:function(){this.$emit("sendmessage",this.pluginAttrData)},filterPlugins:function(){var t=[];for(var e in this.pluginData){var a=this.pluginData[e];a.pkey||a.classtype&&"dVariate"!=a.type||["dOneInput","dmultiText","dOcr","dTable"].includes(a.type)||t.push(a)}this.canPlugins=t},getOcrApi:function(){var t=this;this.appFetch({url:"getOcrApi",method:"get"}).then((function(e){e.e?t.$message({type:"error",message:e.m,showClose:!0}):t.apis=e.d})).catch((function(e){t.$message({type:"error",message:"系统错误",showClose:!0})}))},addMapConfig:function(t){if((t||this.selectPluginKey)&&(!t||this.selectCPluginKey)){var e={key:""};t?this.$set(this.pluginAttrData.attr.data.mapConfig[t].children,this.selectCPluginKey,this.appCommonH.copyObj(e)):(this.$set(this.pluginAttrData.attr.data.mapConfig,this.selectPluginKey,this.appCommonH.copyObj(e)),-1!==this.selectPluginKey.indexOf("RepeatTable")&&this.$set(this.pluginAttrData.attr.data.mapConfig[this.selectPluginKey],"children",{})),this.selectPluginKey="",this.selectCPluginKey="",this.dataChange()}},delMapConfig:function(t,e){e?this.$delete(this.pluginAttrData.attr.data.mapConfig[e].children,t):this.$delete(this.pluginAttrData.attr.data.mapConfig,t),this.dataChange()},refreshPluginMap:function(){this.pluginAttrData.attr.data.mapConfig={},this.dataChange()},getPluginName:function(t){var e="";return t.pkey?(this.pluginData[t.pkey]&&(e+=this.pluginData[t.pkey].description),e+="."+t.description):e=t.description,e},apiChange:function(t){var e=this;this.appFetch({url:"getOcrApiDetail",method:"get",data:{id:this.pluginAttrData.attr.data.api}}).then((function(a){a.e?e.$message({type:"error",message:a.m,showClose:!0}):(e.mapConfig=a.d.field,e.apiParam=a.d.param,t&&(e.pluginAttrData.attr.data.apiData={},e.apiParam.forEach((function(t){1==t.required&&(e.pluginAttrData.attr.data.apiData[t.field]=t.range[0].value)}))),e.dataChange())})).catch((function(t){e.$message({type:"error",message:"系统错误",showClose:!0})}))},cMapConfig:function(t){var e=this.mapConfig.find((function(e){return e.key==t}));return!!e&&e.children}},mounted:function(){this.filterPlugins(),this.getOcrApi(),this.pluginAttrData.attr.data.api&&this.apiChange(0)},watch:{pluginAttrData:function(){this.getOcrApi(),this.pluginAttrData.attr.data.api&&this.apiChange(0)}}},fr=gr,mr=(a("6153"),Object(m["a"])(fr,pr,hr,!1,null,null,null)),vr=mr.exports,br={name:"allPluginAttr",components:{dOneInputAttr:b,dIntegerInputAttr:x,dNumericInputAttr:I,dSelectAttr:L,dSelectV2Attr:z,dmultiTextAttr:Y,dmultiInputAttr:at,dInputAttr:lt,dRadioAttr:gt,dCheckboxAttr:_t,dImageAttr:St,dUserAttr:Rt,dCountryV2Attr:Ft,dOpinionAttr:Vt,dCalendarAttr:Jt,dUserSearchAttr:ie,dLinkAttr:de,dFileAttr:ve,dDepartAttr:we,dAvatarAttr:Te,dJoinSignAttr:Oe,dProjectNumberAttr:He,dPasswdAttr:Ge,dSealAttr:Qe,dBindingAttr:ra,dQuoteAttr:ca,dMultipleAttr:va,dCountAttr:xa,dRegionAttr:Pa,dShowHideAttr:La,dPaymentAttr:Wa,dQrcode:Xa,dRepeatTableAttrV3:rr,dDataSourceAttr:ln,dSyncAttr:gn,dShowAttr:_n,dValidateAttr:An,dAlertAttr:Rn,dVariateAttr:Fn,dSerialAttr:Vn,dChildTableAttr:Jn,dTableAttr:ni,dOneColumnAttr:ui,dArticleAttr:cr,dXimageAttr:fi,dConversionAttr:Di,dRichtextAttr:Ai,dSubmitAttr:Ri,dRoomAttr:Fi,dOcrAttr:vr},props:["sendmessage","plugin","pluginSelect","formBaseInfo","formModeData"],data:function(){return{fontFamilys:[{name:"宋体",value:"SimSun"},{name:"黑体",value:"SimHei"},{name:"微软雅黑",value:"微软雅黑"},{name:"华文仿宋",value:"STFangsong"},{name:"华文宋体",value:"STsong"},{name:"小标宋",value:"FZXiaoBiaoSong-B05S"},{name:"仿宋_GB2312",value:"FangSong_GB2312"},{name:"楷体_GB2312",value:"KaiTi_GB2312"},{name:"arial",value:"arial"},{name:"calibri",value:"calibri"},{name:"times new roman",value:"times new roman"}],fontSizes:[{name:"初号",value:56},{name:"小初",value:48},{name:"一号",value:34},{name:"小一",value:32},{name:"二号",value:29},{name:"小二",value:24},{name:"三号",value:21},{name:"小三",value:20},{name:"19px",value:19},{name:"四号",value:18},{name:"小四",value:16},{name:"五号",value:14},{name:"小五",value:13},{name:"12px",value:12}],isPublic:!1,initAttrData:{key:"public",mobileshow:!0,printResetColor:!0,attr:{style:{fontSize:14,fontFamily:"微软雅黑",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",textAlign:"left",marginTop:0,marginBottom:0,lineHeight:20,letterSpacing:0,mobileTitleStyle:{fontSize:14,fontFamily:"微软雅黑",color:"#878787",lineHeight:22}}}},nowPlugin:{},allPluginData:{},noShowAttr:[],evns:{}}},watch:{plugin:function(t){this.updateData()},pluginSelect:function(t){this.updateData(),0==t.length?this.nowPlugin={}:1==t.length?(this.nowPlugin=this.allPluginData[t[0]],this.repairAttr()):t.length>1&&(this.nowPlugin=this.appCommonH.copyObj(this.initAttrData)),this.isPublic=t.length>1}},methods:{repairAttr:function(){this.nowPlugin.attr&&!this.nowPlugin.attr.style.mobileTitleStyle&&this.$set(this.nowPlugin.attr.style,"mobileTitleStyle",{fontSize:14,fontFamily:"微软雅黑",color:"#878787",lineHeight:22})},getEvn:function(){var t=this;this.appFetch({url:"getMatterEvn",method:"get",data:{}},(function(e){0==e.e?t.evns=e.d:console.error("获取事项环境变量失败："+e.m)}),(function(){console.error("获取事项环境变量失败")}))},isShowAttr:function(){return!this.nowPlugin.classtype&&!this.noShowAttr.includes(this.nowPlugin.type)},sortChange:function(){isNaN(this.nowPlugin.sort)?this.nowPlugin.sort=0:this.nowPlugin.sort=+this.nowPlugin.sort},updateData:function(){this.allPluginData=Object(o["a"])(Object(o["a"])({},this.plugin.plugins),this.plugin.rtplugins)},postMessage:function(t){$.isEmptyObject(t)||(this.nowPlugin=t),this.dataChange()},getNameByValue:function(t,e){var a="无";return this[t]&&this[t].forEach((function(t){t.value==e&&(a=t.name)})),a},setAttr:function(t,e){var a=this.nowPlugin.attr.style;switch(t){case"fontWeight":a.fontWeight="normal"==a.fontWeight?"bold":"normal";break;case"fontStyle":a.fontStyle="normal"==a.fontStyle?"italic":"normal";break;case"textDecoration":a.textDecoration="none"==a.textDecoration?"underline":"none";break;case"textAlign":a.textAlign=e;break;case"fontFamily":a.fontFamily=e;break;case"fontSize":a.fontSize=e;break;case"mt_fontFamily":a.mobileTitleStyle.fontFamily=e;break;case"mt_fontSize":a.mobileTitleStyle.fontSize=e;break}this.dataChange()},dataChange:function(){if("public"===this.nowPlugin.key){var t=this;this.pluginSelect.forEach((function(e){var a=t.appCommonH.copyObj(t.allPluginData[e]);a.mobileshow=t.nowPlugin.mobileshow,a.printResetColor=t.nowPlugin.printResetColor,a.attr.style=Object(o["a"])(Object(o["a"])({},a.attr.style),t.nowPlugin.attr.style),t.$emit("sendmessage",a)}))}else this.$emit("sendmessage",this.nowPlugin)}},mounted:function(){this.updateData(),this.getEvn(),void 0==this.nowPlugin.printResetColor&&(this.nowPlugin.printResetColor=!0)}},yr=br,_r=(a("3fd3"),Object(m["a"])(yr,Zi,Qi,!1,null,null,null)),Dr=_r.exports,Cr=Object(o["a"])({name:"formtable",components:{allPluginV3:Ji["a"],allPluginV3Attr:Dr}},Yi["a"]),wr=Cr,xr=Object(m["a"])(wr,Ki,Xi,!1,null,null,null),kr=xr.exports,Sr={name:"allFromTable",components:{formTableV2:Gi,formTableV3:kr},props:["sendmessage","watchmessage"],data:function(){return{version:"",newInfo:{},isInit:!1}},watch:{watchmessage:function(t){if(!t)return this.newInfo={},this.version="",this.isInit=!1,!1;if(this.version=t.version?t.version:this.version,this.newInfo=t,!this.isInit){this.isInit=!0;var e=this;setTimeout((function(){e.newInfo=e.appCommonH.copyObj(t)}),200)}}},methods:{toSendMessage:function(t){this.$emit("sendmessage",t)}}},Ar=Sr,Er=Object(m["a"])(Ar,n,i,!1,null,null,null);e["a"]=Er.exports},c7e6:function(t,e,a){"use strict";var n=a("3da3"),i=a("2732");t.exports="".repeat||function(t){var e=String(i(this)),a="",r=n(t);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(a+=e);return a}},ca199:function(t,e,a){"use strict";var n=a("cbd5"),i=a.n(n);i.a},cb98:function(t,e,a){},cbd5:function(t,e,a){},cd24:function(t,e,a){"use strict";function n(t){return t.marginTop=t.marginTop||t.margin,t.marginBottom=t.marginBottom||t.margin,t.marginRight=t.marginRight||t.margin,t.marginLeft=t.marginLeft||t.margin,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},cecc:function(t,e,a){"use strict";var n=a("cb98"),i=a.n(n);i.a},cfc2:function(t,e,a){"use strict";var n=a("9f66"),i=a.n(n);i.a},cfd1:function(t,e,a){"use strict";var n=a("5a9e"),i=a("45af").indexOf,r=n.aTypedArray,s=n.exportTypedArrayMethod;s("indexOf",(function(t){return i(r(this),t,arguments.length>1?arguments[1]:void 0)}))},d104:function(t,e,a){"use strict";var n=a("d890"),i=a("5a9e"),r=a("a133"),s=a("90fb"),o=s("iterator"),l=n.Uint8Array,u=r.values,d=r.keys,c=r.entries,p=i.aTypedArray,h=i.exportTypedArrayMethod,g=l&&l.prototype[o],f=!!g&&("values"==g.name||void 0==g.name),m=function(){return u.call(p(this))};h("entries",(function(){return c.call(p(this))})),h("keys",(function(){return d.call(p(this))})),h("values",m,!f),h(o,m,!f)},d432:function(t,e,a){},d6bb:function(t,e,a){"use strict";var n=a("b842");t.exports=function(t,e,a){t&&n((function(){t.apply(a||null,e||[])}))}},d77f:function(t,e){t.exports="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof DataView},d838:function(t,e,a){var n=a("26a2");n("Uint32",(function(t){return function(e,a,n){return t(this,e,a,n)}}))},db0a:function(t,e,a){"use strict";var n=a("5a9e"),i=a("5dfd").filter,r=a("ef4c"),s=n.aTypedArray,o=n.aTypedArrayConstructor,l=n.exportTypedArrayMethod;l("filter",(function(t){var e=i(s(this),t,arguments.length>1?arguments[1]:void 0),a=r(this,this.constructor),n=0,l=e.length,u=new(o(a))(l);while(l>n)u[n]=e[n++];return u}))},dbb9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t};e.default=function(t,e){return n({},t,e)}},dc64:function(t,e,a){"use strict";a("fe59"),a("b130"),a("053b"),a("e35a"),a("90aa"),a("0d7a"),a("08ba");var n=a("f7f9"),i=a("e8d2");e["a"]={getAgentParams:function(t,e){if(e=e||1,1==e){var a={primary_uid:0,starter_depart_id:0};t.id&&(a.primary_uid=t.id),t.depart_id&&(a.starter_depart_id=t.depart_id)}else{a={agent_uid:0,agent_department_id:0};t.id&&(a.agent_uid=t.id),t.depart_id&&(a.agent_department_id=t.depart_id)}return a},getScene:function(t,e,a){return"launch"==t?"read":"read"==t?"archive"==e?a?"archive_edit":"archive":"notify":void 0},compatibleData:function(t,e){if(!e||!e.plugins||!e.rtplugins)return t;for(var a in t){var n=a.split("_")[0],r=e.plugins[a]?i["a"].copyObj(e.plugins[a]):"";r&&(["Radio","Select","Checkbox"].includes(n)&&(r.data=t[a],t[a]=this.setComPluginData(r).data))}return t},specialPlugins:["dRadio","dSelect","dCheckbox","dSelectV2"],isSpecialPlugin:function(t){var e=t.split("_")[0];return this.specialPlugins.includes(e)},setComPluginData:function(t){if(this.specialPlugins.includes(t.type)&&("string"===typeof t.data||"number"===typeof t.data||t.data instanceof Array)){var e=t.attr.data.options;switch(e=e||[],t.type){case"dRadio":case"dSelect":var a={};e.forEach((function(e){t.data==e.value&&(a.name=e.name,a.value=e.value)})),t.data=a;break;case"dSelectV2":case"dCheckbox":var n=t.data instanceof Array?t.data:[t.data],i=(a=[],{});e.forEach((function(t){i[t.value]=t})),n.forEach((function(t){var e={};"string"===typeof t||"number"===typeof t?i[t]&&i[t].name&&(e={value:t,name:i[t]?i[t].name:""}):e=t,void 0!==e.value&&a.push(e)})),t.data=a;break}}return t},archiveEditContrast:function(t,e){var a={};for(var n in t)if(e[n])for(var r in a[n]={},t[n]){var s=t[n][r],o=e[n][r];this.paramContrast(s,o,r)&&(a[n][r]=s)}else a[n]=i["a"].copyObj(t[n]);return a},paramContrast:function(t,e,a){if("undefined"==e)return t;if(a.includes("Select")||a.includes("Radio")){if(t.value!=e.value)return t}else if("object"==Object(n["a"])(t)){if(JSON.stringify(t)!=JSON.stringify(e))return t}else if(t!=e)return t;return!1},getFormLength:function(t,e){var a={};return t.length<Math.floor((e-11)/260)?(a.width="230px",a["margin-right"]="30px"):t.length>=Math.floor((e-11)/230)-1&&t.length<Math.floor((e-11)/120)?(a.width="calc(".concat(100/(t.length+1),"% - 11px)"),a["margin-right"]="10px"):(a.width="110px",a["margin-right"]="10px"),a}}},ddf9:function(t,e,a){"use strict";a("f3dd"),a("0a51"),a("b4fb"),a("dbb3"),a("4194"),a("fe59"),a("b130"),a("ecb4"),a("ea69"),a("fe8a"),a("e18c"),a("1c2e"),a("08ba");var n=a("5748"),i=a("e793"),r=a("ce3c"),s=a("6a58"),o=a.n(s),l=(a("90aa"),{setSize:function(t){this.formBaseInfo.width=t.width,this.formBaseInfo.height=t.height,this.formBaseInfo.type=t.type,this.setHistory("setSize")},setPrintForm:function(t){this.formBaseInfo.printForm=t.data},tableSendMessage:function(t){this[t.type]&&this[t.type](t)},toShowoutbox:function(t){this.showoutbox=t.show},pluginToDoInfo:function(t){this.pluginUpdateInfo=t},doAppEvent:function(t){t.data&&t.data.method&&this.postMessage(t.data)},resetRtable:function(t){var e=this;this.resetTableList.push({method:t.method,key:t.key,data:t}),this.resetTableBar||(this.resetTableBar=setInterval((function(){1==e.resetTableList.length&&(clearInterval(e.resetTableBar),e.resetTableBar=null),e.resetTableList.length&&(e.rtupdateInfo=e.resetTableList.shift())}),100))},updateTrStatus:function(t){var e=this.getPluginType(t.key),a=this.plugin[e][t.key];if(!a)return!1;if(a.lkey&&-1!==a.lkey.indexOf("OneColumn"))return this.plugin.plugins[a.lkey].status.isshow=a.status.isshow,!1;for(var n in this.eleidsrelation.table){var i=this.getTableData(n);for(var r in i.trs){var s=i.trs[r],o=[],l=[];for(var u in s.tds){var d=s.tds[u];if(d.dataid){o.push(d.dataid);a=this.plugin.plugins[d.dataid];a&&!a.status.isshow&&l.push(d.dataid)}}if(o.includes(t.key)){var c=this.isCanHideMegerTD(s.tds);JSON.stringify(o)==JSON.stringify(l)?c&&(i.trs[r].isHide=!0):i.trs[r].isHide=!1}}}},isCanHideMegerTD:function(t){var e=!0,a={};for(var n in this.plugin.plugins){var i=this.plugin.plugins[n];a[i.tdid]=i}for(var r in t){var s=t[r];if(0===s.colspan&&0===s.rowspan){for(var o in this.mergeInfo){var l=this.mergeInfo[o],u=(i=a[o],{});for(var d in this.plugin.plugins)this.plugin.plugins.hasOwnProperty(d)&&this.plugin.plugins[d].tdid==o&&(u=this.plugin.plugins[d]);if(l.mergeIds.includes(s.id)&&i&&(i.status.isshow||u.status.isshow)){e=!1;break}}if(!e)break}}return e},getStyle:function(t,e,a,n,i,r){return"table"!=a||this.formmodeedit||("dashed"==t.borderStyle&&(t.borderColor="transparent",!t.borderTopStyle&&t.borderTopColor&&(t.borderTopColor="transparent"),!t.borderBottomStyle&&t.borderBottomColor&&(t.borderBottomColor="transparent")),"dashed"==t.borderTopStyle&&(t.borderTopColor="transparent"),"dashed"==t.borderBottomStyle&&(t.borderBottomColor="transparent"),"dashed"==t.borderLeftStyle&&(t.borderLeftColor="transparent"),"dashed"==t.borderRightStyle&&(t.borderRightColor="transparent")),this.appCommonH.getStyle(t,e)},checkTdIsHas:function(t){return!!this.eleidsrelation["td"][t]},getLayoutPluginSort:function(){var t=[];return $(".dplugin-layout").each((function(e,a){t.push($(a).attr("data-key"))})),t}}),u=(a("e35a"),a("0d7a"),{addTable:function(t){var e=this.appCommonH.copyObj(this.initTable);this._setTableBaseInfo(e,t.attr.data),this._setTableTdModel(e,0,e.colnum),this._addTableTr(e,0,e.rownum),t.attr.data.tableData=e,this.setHistory("addTable")},addOneColumn:function(t){t.attr.data.width=this.formBaseInfo.width-2*t.attr.data.margin+1,t.tableId=this.getTableId("table","","",""),t.trId=this.getTableId("tr","","",t.tableId),t.id=this.getTableId("td","",t.trId,t.tableId)},_setTableBaseInfo:function(t,e){t.rownum=e.rownum,t.colnum=e.colnum,t.width=this.formBaseInfo.width-2*e.margin,t.id=this.getTableId("table","","","")},_setTableTdModel:function(t,e,a,n){var i=0;if(void 0===n){i=t.width%t.colnum;n=Math.floor(t.width/t.colnum)}for(var r=0;r<a;r++){if(0==r)var s=n+i;else s=n;t.tdModels.splice(e+r,0,{width:s})}},_addTableTr:function(t,e,a){for(var n=null,i=0;i<a;i++)n=this._getTrData(t.colnum,t.id),t.trs.splice(e+i,0,n)},_getTrData:function(t,e){var a=this.appCommonH.copyObj(this.initTr);a.style.height=this.tableStyle.defaultHeight,a.id=this.getTableId("tr","","",e);for(var n=0;n<t;n++)a.tds.push(this._getTdData(e,a.id));return a},_getTdData:function(t,e){var a=this.appCommonH.copyObj(this.initTd);return a.style.borderColor=this.tableStyle.borderColor,a.style.borderStyle=this.tableStyle.borderStyle,a.style.borderWidth=this.tableStyle.borderWidth,a.id=this.getTableId("td","",e,t),a},getTableId:function(t,e,a,n){t=void 0!==t?t:"table";var i=+Math.random().toString().substring(2),r=(new Date).getTime(),s=t+"_"+(r+i);return this.eleidsrelation[t][s]={table:n,tr:a,td:e},s},checkTdCanSelect:function(t){var e=!0,a=this.selectById("table",t),n=this.getTableData(a);return n.trs.forEach((function(a,n){a.tds.forEach((function(a,n){a.dataid&&t==a.id&&(e=!1)}))})),e},getTableData:function(t){var e={};for(var a in this.plugin.plugins){var n=this.plugin.plugins[a];if(["dTable","dRepeatTable"].includes(n.type)&&n.attr.data.tableData.id==t)return n.attr.data.tableData}return e},getTrIndexByTdid:function(t){return $('[data-id="'+t+'"]').parent("tr").index()},getTdIndexByTdid:function(t){return $('[data-id="'+t+'"]').index()},selectById:function(t,e){var a=e.split("_")[0];return this.eleidsrelation[a]&&this.eleidsrelation[a][e]?this.eleidsrelation[a][e][t]:""},changeCursor:function(t){$("body").css({cursor:t})},changeBorderCollapse:function(t){$('[data-id="'+t+'"]').css({borderSpacing:"1px"}),setTimeout((function(){$('[data-id="'+t+'"]').css({borderSpacing:"0px"})}),50)},changeTableWidth:function(t,e){$('[data-id="'+t+'"]').css({width:e+"px"})},tdChangeMousemove:function(t){if(!this.formmodeedit)return!1;var e=t.target;if("TD"!=t.target.tagName&&"DIV"!=t.target.tagName||(t.offsetX>=e.offsetWidth-10?this.changeCursor("col-resize"):this.changeCursor("default")),this.tdChangeInfo.nowTarget){var a=t.x-this.tdChangeInfo.oldEventX;if(a=Math.floor(a),"TD"==this.tdChangeInfo.nowTarget.tagName){var n=$(this.tdChangeInfo.nowTarget).index(),i=this.getTableData(this.selectById("table",$(this.tdChangeInfo.nowTarget).attr("data-id"))),r=i.tdModels[n].width+a,s=i.tdModels[n].width;r=Math.floor(r),r=r<10?10:r,i.tdModels[n].width=r,i.width=Math.floor(i.width+(r-s)),this.changeTableWidth(i.id,i.width),this.SET_SELECTTD(this.selectData)}else if("DIV"==this.tdChangeInfo.nowTarget.tagName){var o=$(this.tdChangeInfo.nowTarget).attr("data-key"),l=this.plugin.plugins[o];r=l.attr.data.width+a;r=r<100?100:r,l.attr.data.width=r}this.tdChangeInfo.oldEventX=t.x}return!1},tdChangeMousedown:function(t){if(!this.formmodeedit)return!1;t.offsetX>=t.target.offsetWidth-10&&("TD"==t.target.tagName||"DIV"==t.target.tagName)&&(this.selectData.start.id="",this.selectData.selectIds=[],this.SET_SELECTTD(this.selectData),this.tdChangeInfo.nowTarget=t.target,this.tdChangeInfo.oldEventX=t.x)},tdChangeMouseup:function(t){this.tdChangeInfo.nowTarget=null,this.tdChangeInfo.oldEventX=0,this.changeCursor("default")}}),d=a("69c6"),c=a("6367"),p=a("2744"),h={removePlugin:function(){if(!this.selectPlugins.length)return!1;var t=this;this.selectPlugins.forEach((function(e){t.delPlugin(e)})),this.setHistory("removePlugin")},addPlugin:function(t){if(t.type&&p["a"][t.type]){if(1==this.selectPlugins.length&&1!=this.selectData.selectIds.length&&1!=this.rtselectData.length&&(this.delPluginSelectTd(this.selectPlugins[0]),this.setPluginAttr(this.selectPlugins[0],!1)),1==this.selectData.selectIds.length){var e=this,a=this.selectData.selectIds[0],n=$('[data-id="'+this.selectData.tableid+'"]').attr("data-key"),i=n&&this.plugin.plugins[n]?this.plugin.plugins[n]:null;if(!i)return!1;switch(i.type){case"dTable":var r=this.getTableData(this.selectData.tableid);r.trs.forEach((function(n,r){n.tds.forEach((function(n,r){a==n.id&&(n.dataid=t.isshear?t.key:e.createPluginNum(t.columnType),e.addPluginData(n.dataid,t,a,"plugins",void 0,i.key))}))})),this.changeBorderCollapse(r.id);break;case"dRepeatTable":r=i.attr.data.tableData;r.trs.forEach((function(n,r){n.tds.forEach((function(n,r){a==n.id&&(n.dataid=t.isshear?t.key:e.createPluginNum(t.columnType),e.addPluginData(n.dataid,t,a,"rtplugins",i.key,i.key))}))}));break;case"dOneColumn":i.dataid=t.isshear?t.key:e.createPluginNum(t.columnType),this.addPluginData(i.dataid,t,a,"plugins",void 0,i.key);break}this.removeSelect()}this.selectPlugins=this.appCommonH.copyObj(this.selectPlugins),this.plugin={nowNum:this.plugin.nowNum,plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins},this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:{plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins}}),this.setHistory("addPlugin")}},addOutPlugin:function(t){if(t.type&&p["a"][t.type]){var e=this.createPluginNum(t.columnType);this.addPluginData(e,t,"","plugins")}},createPluginNum:function(t){return this.plugin.nowNum++,t+"_"+this.plugin.nowNum},addPluginData:function(t,e,a,n,r,s){var o=this.appCommonH.copyObj(this.initPlugin);switch(e=this.appCommonH.copyObj(e),o.tdid=a,o.key=t,o.columnType=e.columnType,o.classtype=void 0!==e.classtype?e.classtype:o.classtype,e.isLayout&&(o.isLayout=e.isLayout),void 0!==e.description&&(o.description=e.description),void 0!==e.initdata&&(o.initdata=e.initdata,o.data=e.initdata),(e.iscopy||e.isshear)&&(o.data=e.data),void 0!==e.type&&(o.type=e.type),void 0!==e.pluginname&&(o.pluginname=e.pluginname),void 0!==e.mobileshow&&(o.mobileshow=e.mobileshow),void 0===e.sort||e.iscopy?o.sort=10*this.plugin.nowNum+2e3:o.sort=e.sort,void 0!==e.attr&&(e.attr.style&&(o.attr.style=Object(i["a"])(Object(i["a"])({},o.attr.style),e.attr.style)),e.attr.data&&(o.attr.data=Object(i["a"])(Object(i["a"])({},o.attr.data),e.attr.data)),e.attr.setInfo&&(o.attr.setInfo=Object(i["a"])(Object(i["a"])({},o.attr.setInfo),e.attr.setInfo))),void 0!==e.status&&(o.status=Object(i["a"])(Object(i["a"])({},o.status),e.status)),void 0!==r&&(o.pkey=r),void 0!==s&&(o.lkey=s),o=this.appCommonH.copyObj(o),"rtplugins"==n&&this.plugin[n]instanceof Array&&(this.plugin[n]={}),this.$set(this.plugin[n],t,o),o.type){case"dTable":this.addTable(o);break;case"dOneColumn":this.addOneColumn(o);break;case"dRepeatTable":this.addRepeatTable(o);break;case"dArticle":o.attr.borderColor=this.tableStyle.borderColor;break}["dTable","dOneColumn","dRepeatTable","dPageSplit"].includes(o.type)?this.$set(this.layoutPluginSort,this.layoutPluginSort.length,o.key):this.addSelectPlugin(t,!0)},delPageSplit:function(t){this.delLayoutPlugin(t.key)},delLayoutPlugin:function(t){this.plugin.plugins[t]&&this.$delete(this.plugin.plugins,t)},delPlugin:function(t){var e=this.getPluginType(t),a=this.plugin[e][t];if(!a)return!1;if(this.$delete(this.plugin[e],a.key),a.lkey){var n={},i=this.plugin.plugins[a.lkey];["dTable","dRepeatTable"].includes(i.type)?(n=a.pkey?this.plugin.plugins[a.lkey].attr.data.tableData:this.getTableData(this.selectById("table",a.tdid)),n.trs.forEach((function(t,e){t.tds.forEach((function(t,e){a.tdid==t.id&&(t.dataid="")}))}))):i.dataid=""}if(this.selectPlugins.includes(t)){var r=[];this.selectPlugins.forEach((function(e){e!==t&&r.push(e)})),this.selectPlugins=r}},addSelectPlugin:function(t,e){if(this.selectPlugins.includes(t))return!1;var a=this;e&&(this.selectPlugins.forEach((function(t){a.selectPlugins.includes(t)&&a.setPluginAttr(t,!1)})),this.selectPlugins=[]),this.selectPlugins.push(t),this.selectPlugins=this.appCommonH.copyObj(this.selectPlugins),this.selectPlugins.forEach((function(t){a.setPluginAttr(t,!0)}))},removeAllSelectPlugin:function(){if(!this.selectPlugins.length)return!1;var t=this;this.selectPlugins.forEach((function(e){t.setPluginAttr(e,!1)})),this.selectPlugins=[]},setPluginAttr:function(t,e){var a=this.getPluginType(t);if(a&&!this.plugin[a][t]||!a)return!1;var n=this.appCommonH.copyObj(this.plugin[a][t]);n.status.modeedit=e,n.status.modeedit&&(n.status.warning=!1),this.$set(this.plugin[a],t,this.appCommonH.copyObj(n))},setPluginValue:function(t,e){var a=this;e=this.getPluginType(t.key);t.key&&e&&this.plugin[e][t.key]&&(this.plugin[e][t.key]=this.appCommonH.copyObj(t),this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:{plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins}})),setTimeout((function(){var e={};if(e[t.key]=t.data,c["a"].add(e,"formData"+a.nowModeId),window["tablevm"+a.nowModeId]){var n={},i=window["tablevm"+a.nowModeId].plugin.plugins;for(var r in i)i.hasOwnProperty(r)&&!["dTable","dmultiText","dOneInput"].includes(i[r].type)&&(n[r]=i[r].data);c["a"].add({all:n},"formData"+a.nowModeId),c["a"].add({all:n},"fomeData")}}),500)},getPluginType:function(t){return this.plugin.plugins[t]?"plugins":this.plugin.rtplugins[t]?"rtplugins":""},delPluginSelectTd:function(t){var e=this.getPluginByKey(t);e&&(this.delPlugin(t),-1!==e.lkey.indexOf("OneColumn")?this.noTdMouserdown({eleid:e.tdid,e:{target:$('[data-id="'+e.tdid+'"]')}}):this.tdMouserdown({eleid:e.tdid,e:{target:$('[data-id="'+e.tdid+'"]')}}),this.tdMouseup())},getPluginByKey:function(t){var e=null;return this.plugin.plugins[t]&&(e=this.plugin.plugins[t]),this.plugin.rtplugins[t]&&(e=this.plugin.rtplugins[t]),e},copyPlugin:function(){1==this.selectPlugins.length?(this.copyPluginData=this.getPluginByKey(this.selectPlugins[0]),this.copyPluginData.iscopy=!0,this.$message({type:"success",message:"复制成功"})):this.selectPlugins.length>1?this.$message({type:"warning",message:"不可同时复制多个组件"}):this.$message({type:"warning",message:"未发现可复制组件"})},pastePlugin:function(){this.copyPluginData.columnType&&(this.addPlugin(this.copyPluginData),this.copyPluginData.isshear&&(this.copyPluginData={}))},shearPlugin:function(){1==this.selectPlugins.length?(this.copyPluginData=this.getPluginByKey(this.selectPlugins[0]),this.copyPluginData.isshear=!0,this.delPlugin(this.selectPlugins[0]),this.$message({type:"success",message:"剪切成功"})):this.selectPlugins.length>1?this.$message({type:"warning",message:"不可同时剪切多个组件"}):this.$message({type:"warning",message:"未发现可剪切组件"})},setOutPluginList:function(t){var e={};for(var a in t)1==t[a].classtype&&(e[t[a].type]||(e[t[a].type]=[]),e[t[a].type].push(t[a]));return e}},g={noTdMouserdown:function(t){var e=t.eleid;t.e;if(!this.formmodeedit)return!1;var a=$('[data-id="'+e+'"]').attr("data-key"),n=this.plugin.plugins[a];if(n.dataid)return!1;this.selectData.tableid&&this.changeBorderCollapse(this.selectData.tableid),this.selectData.tableid=n.tableId,this.selectData.start.id=e,this.selectData.start=Object(i["a"])(Object(i["a"])({},this.selectData.start),{row:0,col:0}),this.removeSelect(),this.selectData.selectIds.push(e),this.selectData.selectIds=this.appCommonH.copyObj(this.selectData.selectIds),this.changeBorderCollapse(this.selectData.tableid),this.SET_SELECTTD(this.selectData)},tdMouserdown:function(t){var e=t.eleid,a=t.e;return!!this.formmodeedit&&(!!this.checkTdCanSelect(e)&&(this.changeBorderCollapse(this.selectData.tableid),this.selectData.tableid=this.selectById("table",e),this.selectData.start.id=e,this.selectData.start=Object(i["a"])(Object(i["a"])({},this.selectData.start),this.getRowCol(a,"start")),this.removeSelect(),this.selectData.selectIds.push(e),this.selectData.selectIds=this.appCommonH.copyObj(this.selectData.selectIds),this.changeBorderCollapse(this.selectData.tableid),void this.SET_SELECTTD(this.selectData)))},tdMouseover:function(t){var e=t.eleid,a=t.e;return!!this.formmodeedit&&(!(!this.checkTdCanSelect(e)||!this.selectData.start.id||this.selectById("table",e)!=this.selectData.tableid)&&(this.selectData.end.id=e,this.selectData.end=Object(i["a"])(Object(i["a"])({},this.selectData.end),this.getRowCol(a,"end")),this.setSelectTd(this.selectData.tableid,this.selectData.start.row,this.selectData.end.row,this.selectData.start.col,this.selectData.end.col),this.SET_SELECTTD(this.selectData),!1))},tdMouseup:function(){return this.selectData.start.id="",!1},toMouseout:function(t){this.selectData.tableid==t&&this.tdMouseup()},getRowCol:function(t,e){var a=$(t.target).attr("data-id"),n=this.mergeInfo[a]?this.mergeInfo[a]:null,i=0,r=0;return n?(i=n["row"+this.appCommonH.firstUppercase(e)],r=n["col"+this.appCommonH.firstUppercase(e)]):(i=$(t.target).parent("tr").index(),r=$(t.target).index()),{row:i,col:r}},getMinMax:function(t,e,a,n){var i={minrow:0,maxrow:0,mincol:0,maxcol:0};return e>=t?(i.minrow=t,i.maxrow=e):(i.minrow=e,i.maxrow=t),n>=a?(i.mincol=a,i.maxcol=n):(i.mincol=n,i.maxcol=a),i},checkCanMerge:function(){var t=this,e=!0;return this.selectData.selectIds.forEach((function(a){var n=t.mergeInfo[a]?t.mergeInfo[a]:null;for(var i in t.mergeInfo)if(t.mergeInfo[i].mergeIds.includes(a)){n=t.mergeInfo[i];break}if(n&&n.mergeIds.forEach((function(a){if(!t.selectData.selectIds.includes(a))return e=!1,!1})),!e)return!1})),e},saveMergeInfo:function(t,e,a,n,i,r){t==e?(this.mergeInfo[e]={},this.mergeInfo[e].rowStart=a,this.mergeInfo[e].rowEnd=n,this.mergeInfo[e].colStart=i,this.mergeInfo[e].colEnd=r,this.mergeInfo[e].mergeIds=[]):this.mergeInfo[e].mergeIds.push(t)},mergeTd:function(){var t=this,e=this.getTableData(this.selectData.tableid),a="",n=this.getMinMax(this.selectData.start.row,this.selectData.end.row,this.selectData.start.col,this.selectData.end.col),i=n.minrow,r=n.maxrow,s=n.mincol,o=n.maxcol;e.trs.forEach((function(e,n){e.tds.forEach((function(e,l){n>=i&&n<=r&&l>=s&&l<=o&&(n==i&&l==s?(e.rowspan=r-i+1,e.colspan=o-s+1,a=e.id):(e.rowspan=0,e.colspan=0),t.mergeInfo[e.id]&&delete t.mergeInfo[e.id],t.saveMergeInfo(e.id,a,i,r,s,o))}))})),this.removeSelect(),this.changeBorderCollapse(e.id),this.setHistory("mergeTd")},sliptTd:function(){if(!this.selectData.selectIds.length)return!1;var t=this.selectData.selectIds[0],e=(this.selectById("table",t),this.mergeInfo[t].mergeIds),a=this.getTableData(this.selectData.tableid);a.trs.forEach((function(a,n){a.tds.forEach((function(a,n){(t==a.id||e.includes(a.id))&&(a.rowspan=1,a.colspan=1)}))})),delete this.mergeInfo[t],this.removeSelect(),this.changeBorderCollapse(a.id),this.setHistory("sliptTd")},removeResetMergeInfo:function(){var t=this;for(var e in this.mergeInfo){var a=!1,n=this.mergeInfo[e],i=this.appCommonH.copyObj(n.mergeIds),r=[],s=-1,o=-1;if(i.push(e),i.forEach((function(n,i){if(t.eleidsrelation.td[n]){var l=t.getTrIndexByTdid(n),u=t.getTdIndexByTdid(n);n!==e&&r.push(n),s=l>s?l:s,o=u>o?u:o}else a=!0})),a){n.mergeIds=r,n.rowEnd=s,n.colEnd=o,0===n.mergeIds.length&&this.$delete(this.mergeInfo,e);var l=this.selectById("table",e),u=this.getTableData(l);u.trs.forEach((function(t,a){t.tds.forEach((function(t,a){t.id==e&&(t.rowspan=n.rowEnd-n.rowStart+1,t.colspan=n.colEnd-n.colStart+1)}))})),t.changeBorderCollapse(u.id)}}},addResetMergeInfo:function(){var t=this;for(var e in this.mergeInfo){var a=this.mergeInfo[e],n=this.getTrIndexByTdid(e),i=-1,r=this.getTdIndexByTdid(e),s=-1;if(a.mergeIds.forEach((function(e,a){var n=t.getTrIndexByTdid(e),r=t.getTdIndexByTdid(e);i=n>i?n:i,s=r>s?r:s})),a.rowEnd!==i||a.colEnd!==s){a.rowStart=n,a.rowEnd=i,a.colStart=r,a.colEnd=s;var o=this.selectById("table",e),l=this.getTableData(o);n=a.rowStart,i=a.rowEnd,r=a.colStart,s=a.colEnd;l.trs.forEach((function(a,o){a.tds.forEach((function(a,l){o>=n&&o<=i&&l>=r&&l<=s&&(o==n&&l==r?(a.rowspan=i-n+1,a.colspan=s-r+1):(a.rowspan=0,a.colspan=0),t.mergeInfo[a.id]&&delete t.mergeInfo[a.id],t.saveMergeInfo(a.id,e,n,i,r,s))}))})),this.changeBorderCollapse(l.id)}}},perfectMergeInfo:function(){var t={};for(var e in this.eleidsrelation.table){var a=this.getTableData(e);a.trs.forEach((function(e,a){e.tds.forEach((function(e,n){for(var i in(e.rowspan>1||e.colspan>1)&&(t[e.id]={rowStart:a,rowEnd:a+e.rowspan-1,colStart:n,colEnd:n+e.colspan-1,mergeIds:[]}),t){var r=t[i];a>=r.rowStart&&a<=r.rowEnd&&n>=r.colStart&&n<=r.colEnd&&(a==r.rowStart&&n==r.colStart||r.mergeIds.push(e.id))}}))}))}JSON.stringify(this.mergeInfo)==JSON.stringify(t)?this.$message({type:"warning",message:"未发现可修复合并数据"}):(this.mergeInfo=t,this.$message({type:"success",message:"修复成功"}))}},f={setSelectTd:function(t,e,a,n,i){var r=this.getTableData(t),s=[],o=this.getMinMax(e,a,n,i),l=o.minrow,u=o.maxrow,d=o.mincol,c=o.maxcol;r.trs.forEach((function(t,e){t.tds.forEach((function(t,a){e>=l&&e<=u&&a>=d&&a<=c&&(s.includes(t.id)||s.push(t.id))}))})),this.selectData.selectIds=s},removeSelect:function(t){this.selectData.selectIds=[],this.SET_SELECTTD(this.selectData)},isSelect:function(t){return this.selectData.selectIds.includes(t)&&this.formmodeedit?"selected":""}},m=(a("5e9f"),{checkAlertStatus:function(t){if(1!==this.selectData.selectIds.length&&!t)return!1;this.operationAlert={removeRow:!0,topAddRow:!0,bottomAddRow:!0,removeCol:!0,leftAddCol:!0,rightAddCol:!0,removeTable:!0,selectTable:!0};var e=this.selectData.selectIds[0]?this.selectData.selectIds[0]:t,a=this.getTrIndexByTdid(e),n=this.getTdIndexByTdid(e),i=this.selectById("table",e),r=$('[data-id="'+i+'"]')?$('[data-id="'+i+'"]').attr("data-key").split("_")[0]:"";if(!r)return!1;switch(r){case"Table":var s=this.getTableData(i);this.operationAlert.removeRow=this.checkRemoveRow(e,a,n,i,s),this.operationAlert.removeCol=this.checkRemoveCol(e,a,n,i,s),this.operationAlert.selectTable=!1;break;case"RepeatTable":s=this.getTableData(i);this.operationAlert.removeRow=!1,this.operationAlert.topAddRow=!1,this.operationAlert.bottomAddRow=!1,this.operationAlert.removeCol=this.checkRemoveCol(e,a,n,i,s),this.operationAlert.selectTable=!0;break;case"OneColumn":this.operationAlert={removeRow:!1,topAddRow:!1,bottomAddRow:!1,removeCol:!1,leftAddCol:!1,rightAddCol:!1,removeTable:!0,selectTable:!1};break}return!0},checkRemoveRow:function(t,e,a,n,i){var r=this,s=!0;return s=this.forEachMerge((function(t,a,i,s,o){var l=r.getTrIndexByTdid(o);return l!=e||s.rowStart==s.rowEnd||i!=n})),1==i.trs.length&&(s=!1),s},checkRemoveCol:function(t,e,a,n,i){var r=this,s=!0;return s=this.forEachMerge((function(e,n,i,s,o){var l=r.getTdIndexByTdid(o);return t!=o||l!=a||s.colStart==s.colEnd})),1==i.trs[0].tds.length&&(s=!1),s},forEachMerge:function(t){var e=this,a=!0;for(var n in this.mergeInfo){var i=this.appCommonH.copyObj(this.mergeInfo[n].mergeIds);i.unshift(n),i.forEach((function(i){var r=e.getTrIndexByTdid(i),s=e.getTdIndexByTdid(i),o=e.selectById("table",i);t(r,s,o,e.mergeInfo[n],n)||(a=!1)}))}return a},totopvalue:function(t,e){"up"==t?this.upRowNum=e.target.value.replace(/[^\d]/g,""):"down"==t?this.downRowNum=e.target.value.replace(/[^\d]/g,""):"left"==t?this.leftColNum=e.target.value.replace(/[^\d]/g,""):"right"==t&&(this.rightColNum=e.target.value.replace(/[^\d]/g,""))},removeRow:function(){var t=this.selectData.selectIds[0],e=$('[data-id="'+t+'"]').parent("tr").attr("data-id"),a=this.getTableData(this.selectById("table",t)),n=[];a.rownum=+a.rownum-1,a.trs.forEach((function(t){t.id!==e?n.push(t):t})),a.trs=n,this.removeEleidTr(e),this.removeSelect(),this.changeBorderCollapse(a.id),this.$nextTick((function(){this.removeResetMergeInfo(),this.setHistory("removeRow")}))},addRow:function(t){var e=this,a=this.selectData.selectIds[0],n=this.selectById("table",a),i=($('[data-id="'+a+'"]').parent("tr").attr("data-id"),this.getTrIndexByTdid(a)),r=this.getTableData(n),s=[],o=(this.mergeInfo[a],[]),l="up"==t?this.upRowNum:this.downRowNum;if(!l)return this.$message("请输入行数"),!1;if(l<1||l>100)return this.$message("批量插入只能是整数1-100之间"),!1;for(var u=0;u<l;u++)o.push(e["_getTrData"](r.colnum,n));console.log(i,t,o),r.rownum=+r.rownum+ +e.upRowNum,r.trs.forEach((function(e,a){"up"==t&&a==i?(s.push.apply(s,o),s.push(e)):"down"==t&&a==i?(s.push(e),s.push.apply(s,o)):s.push(e)})),r.trs=s,r=this.appCommonH.copyObj(r),this.removeSelect(),this.changeBorderCollapse(r.id),this.$nextTick((function(){this.addResetMergeInfo(),this.setHistory("addRow")})),$(".operationalert").hide(),this.upRowNum=1,this.downRowNum=1},removeCol:function(){var t=this,e=this.selectData.selectIds[0],a=this.getTdIndexByTdid(e),n=this.getTableData(this.selectById("table",e)),i=a;n.colnum=+n.colnum-1;var r=n.tdModels.splice(i,1)[0];n.width=n.width-r.width,this.changeTableWidth(n.id,n.width),n.trs.forEach((function(e,a){var n=e.tds.splice(i,1);t.removeEleidTd(n[0].id)})),n=this.appCommonH.copyObj(n),this.removeSelect(),this.changeBorderCollapse(n.id),this.$nextTick((function(){this.removeResetMergeInfo(),this.setHistory("removeCol")}))},addCol:function(t){var e,a=this,n=this.selectData.selectIds[0],i=this.getTdIndexByTdid(n),r=this.getTableData(this.selectById("table",n)),s=i+1+("right"==t?0:-1),o="left"==t?this.leftColNum:this.rightColNum,l=[];if(!o)return this.$message("请输入列数"),!1;if(o<1||o>100)return this.$message("批量插入只能是整数1-100之间"),!1;for(var u=0;u<o;u++)l.push({width:this.tableStyle.defaultWidth});r.colnum=+r.colnum+ +o,r.width=r.width+this.tableStyle.defaultWidth*o,(e=r.tdModels).splice.apply(e,[s,0].concat(l)),this.changeTableWidth(r.id,r.width),r.trs.forEach((function(t,e){for(var n,i=[],l=0;l<o;l++)i.push(a._getTdData(r.id,t.id));(n=t.tds).splice.apply(n,[s,0].concat(i))})),r=this.appCommonH.copyObj(r),this.removeSelect(),this.changeBorderCollapse(r.id),this.$nextTick((function(){this.addResetMergeInfo(),this.setHistory("addCol")})),$(".operationalert").hide(),this.leftColNum=1,this.rightColNum=1},removeTable:function(){var t=this.selectData.selectIds[0],e=this.selectById("table",t);this.delLayoutPlugin($('[data-id="'+e+'"]').attr("data-key")),this.removeSelect(),this.removeTableInfo(e),this.setHistory("removeTable")},selectTable:function(){var t=this.selectData.selectIds[0],e=this.selectById("table",t);this.addSelectPlugin($('[data-id="'+e+'"]').attr("data-key"),!0)},removeTableById:function(t){this.delLayoutPlugin($('[data-id="'+t+'"]').attr("data-key")),this.removeSelect(),this.removeTableInfo(t),this.setHistory("removeTable")},removeTableInfo:function(t){for(var e in this.mergeInfo)this.selectById("table",e)==t&&delete this.mergeInfo[e];this.removeEleidTable(t)},removeEleidTable:function(t){for(var e in this.eleidsrelation)if("td"!=e)for(var a in this.eleidsrelation[e])"table"==e?a==t&&delete this.eleidsrelation[e][a]:this.eleidsrelation[e][a].table==t&&"tr"==e&&this.removeEleidTr(a)},removeEleidTr:function(t){for(var e in this.eleidsrelation)if("table"!=e)for(var a in this.eleidsrelation[e])"tr"==e?a==t&&delete this.eleidsrelation[e][a]:"td"==e&&this.eleidsrelation[e][a].tr==t&&this.removeEleidTd(a)},removeEleidTd:function(t){for(var e in this.eleidsrelation)if("td"==e)for(var a in this.eleidsrelation[e])for(var n in a==t&&delete this.eleidsrelation[e][a],this.eleidsrelation.table)this.eleidsrelation.table[n].td==t&&this.removeEleidTable(n)}}),v={rtPostMessage:function(t){t.method&&this[t.method]&&this[t.method](t.data)}},b={addRepeatTable:function(t){var e=this.appCommonH.copyObj(this.initTable);this._rtsetTableBaseInfo(e,t),this._rtsetTableTdModel(e,0,e.colnum),this._addTableTr(e,0,e.rownum),t.attr.data.tableData=e,this.setHistory("addTable")},_rtsetTableBaseInfo:function(t,e){t.rownum=e.attr.data.rownum,t.colnum=e.attr.data.colnum,t.width=this.formBaseInfo.width-2*e.attr.data.margin,t.id=this.getTableId("table","","","")},_rtsetTableTdModel:function(t,e,a,n){var i=0,r=t.colnum-1;if(void 0===n){i=t.width%r;n=Math.floor(t.width/r)}for(var s=0;s<a;s++){if(0==s)var o=n+i;else o=n;s!=a-1?t.tdModels.splice(e+s,0,{width:o}):t.tdModels.splice(e+s,0,{width:0})}}},y=(a("77ad"),{toOld:function(){if(this.formHistory.nowIndex<=0)return!1;this.formHistory.nowIndex=this.formHistory.nowIndex-1,this.loadHistory()},toNew:function(){if(this.formHistory.nowIndex>=this.formHistory.list.length-1)return!1;this.formHistory.nowIndex=this.formHistory.nowIndex+1,this.loadHistory()},loadHistory:function(){var t=this.formHistory.list[this.formHistory.nowIndex];this.eleidsrelation=this.appCommonH.copyObj(t.eleidsrelation),this.mergeInfo=this.appCommonH.copyObj(t.mergeInfo),this.formBaseInfo=this.appCommonH.copyObj(t.formBaseInfo),this.plugin={plugins:this.appCommonH.copyObj(t.plugins),rtplugins:this.appCommonH.copyObj(t.rtplugins),nowNum:this.plugin.nowNum},this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:this.appCommonH.copyObj(this.plugin)})},setHistory:function(t){this.formHistory.list.push(this.appCommonH.copyObj({type:t,eleidsrelation:this.eleidsrelation,mergeInfo:this.mergeInfo,formBaseInfo:this.formBaseInfo,plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins})),this.formHistory.list.length>5&&(this.formHistory.list=this.formHistory.list.slice(-5)),this.formHistory.nowIndex=this.formHistory.list.length-1}}),_=(a("053b"),a("e10c")),D=a.n(_),C=a("eead"),w=a("f69e"),x={initFormMode:function(t){if(this.nowModeId=t.fid?t.fid:0,this.appId=t.appid,this.bpmnId=t.bpmnid,this.fVId=t.fVId,this.published=t.published,this.formmodeedit=!0,this.nowModeId){var e=this;this.getFormMode().then((function(){e.plugin=e.pluginCopy}))}else this.loadEvent(),this.postMessage({method:"updateModeId",fid:this.nowModeId,appid:this.appId,bpmnId:this.bpmnId,name:this.formName,version:this.version,printForm:this.formBaseInfo.printForm})},saveFormMode:function(t){if(this.appCommonH.isEmptyObj(this.plugin.plugins))return this.$message("表格不可为空"),!1;var e={};if(t.id?e=this.formModeData:(e.app_id=t.appId?t.appId:void 0,e.bpmn_id=t.bpmnId?t.bpmnId:void 0),e.name=t.name,this.delNoUsePlugin(),!this.checkPluginDesc())return this.$message({type:"error",message:"请设置字段含义"}),!1;e.table={tableData:this.tableData,eleidsrelation:this.eleidsrelation,mergeInfo:this.mergeInfo,formBaseInfo:this.formBaseInfo,layoutPluginSort:this.getLayoutPluginSort(),moduleInfo:this.moduleInfo},e.plugins=this.setPluginStatus(this.appCommonH.copyObj(this.plugin),{warning:!1,modeedit:!1,formmodeedit:!0}),e.table=JSON.stringify(e.table),e.plugins=JSON.stringify(e.plugins);var a=this,n="",i={};return 2==this.$route.query.matterType&&this.$route.query.isClone?(this.cloneFrom(e),!1):(e.id?(n=this.published?"saveFormAttr":"updateFormModel",i={form_version_id:this.fVId,table:e.table,plugins:e.plugins,name:e.name}):(n="createFormModel",i={bpmn_id:e.bpmn_id,app_id:e.app_id,table:e.table,plugins:e.plugins,name:e.name,version:this.version}),this.appFetch({url:n,method:"POST",data:i},(function(t){0==t.e?(a.nowModeId||(a.formName=e.name,a.nowModeId=t.d.form_id,a.fVId=t.d.form_version_id,a.formModeData={id:a.nowModeId,name:e.name,app_id:e.app_id,bpmn_id:e.bpmn_id}),a.$message({message:"保存成功",type:"success"}),a.postMessage({method:"saveFormFileSuccess",id:t.d.form_id})):a.$message(t.m)}),(function(t){a.$message("保存表单失败，请联系管理员")})))},cloneFrom:function(t){var e={form_id:t.id,bpmn_id:t.bpmn_id,app_id:t.app_id,table:t.table,plugins:t.plugins,name:t.name,old_version_id:this.fVId},a=this;this.appFetch({url:"createNewForm",method:"POST",data:e},(function(e){0==e.e?(a.$message({type:"success",message:e.m,showClose:!0}),setTimeout((function(){window.location.href="".concat(a.appConfig.baseUrl,"form/editform?id=").concat(t.id,"&app_id=").concat(t.app_id,"&bpmn_id=").concat(t.bpmn_id,"&fVId=").concat(e.d.form_version_id,"&matterType=2")}),2e3)):a.$message({type:"error",message:e.m,showClose:!0})}),(function(t){a.$message({message:"保存表单失败，请联系管理员",showClose:!0})}))},getFormMode:function(t,e){var a=this,n=e&&e.isqrcode,i=e&&e.isToPdfMode,r=e&&e.secret;i=i?1:void 0,r=r?e.secret:void 0,a.setFormInfo("formId",this.nowModeId),a.ADD_STARTLOADING(),window["tablevm"+a.nowModeId]=a,this.setPluginsEvn(e);var s=n?"codeGetForm":"getFromMode",o={id:this.nowModeId,bpmn_id:this.bpmnId?this.bpmnId:void 0,inst_id:t,preview:i,secret:r};return 2==this.$route.query.matterType&&(s="getFormOneDetail",o={id:this.fVId?this.fVId:this.$route.query.fVId?this.$route.query.fVId:0}),this.appFetch({url:s,method:"GET",data:o},(function(t){0==t.e&&t.d.table?(a.formModeData=t.d,a.formModeData.bpmn_id=a.bpmnId?a.bpmnId:void 0,a.fVId=a.fVId?a.fVId:t.d.form_version_id,a.loadForm(t.d),a.loadEvent()):a.$message("获取表单失败，请联系管理员"),a.toReduceStartLoading()}),(function(t){a.toReduceStartLoading(),a.$message("获取表单失败，请联系管理员")}))},initFormData:function(t){var e=this;this.nowModeId=t.fid,this.instId=t.inst_id,this.appId=t.appId,this.bpmnId=t.bpmnId,this.nodeId=t.nodeId,this.fVId=t.fVId?t.fVId:0,this.formmodeedit=!1;var a=void 0===t.ispc||t.ispc;this.pluginStatus={ispc:a,formmodeedit:!1};var n=this;this.startDoPlugin=!1,this.setFormInfo("instId",this.instId),this.setFormInfo("appId",this.appId),this.setFormInfo("bpmnId",this.bpmnId),this.setFormInfo("nodeId",this.nodeId),this.setFormInfo("sessId",t.sess_id?t.sess_id:0),this.setFormInfo("matterType",t.matter_type?t.matter_type:1),this.setFormInfo("version",this.version),this.setFormInfo("isPrintMode",!!t.isPrintMode),c["a"].getMatterEvn({appId:n.formInfo.appId?n.formInfo.appId:void 0,instId:n.formInfo.instId?n.formInfo.instId:void 0,taskId:n.$route.query.task_id?n.$route.query.task_id:void 0,sessId:n.formInfo.sessId?n.formInfo.sessId:void 0},(function(){e.getFormMode(t.inst_id,t).then((function(){n.setPluginAuth(t,"plugins"),n.setPluginAuth(t,"rtplugins"),t.isPrintMode&&n.printSetColor(),n.plugin=n.pluginCopy,n.SET_ALLPLUGINS({id:n.nowModeId,allplugin:{plugins:n.plugin.plugins,rtplugins:n.plugin.rtplugins}}),n.startDoPlugin=!0,n.rtupdateInfo={method:"resetInit"},n.$nextTick((function(){n.startDoOutPlugin=!0})),t.isBrowserPrint&&setTimeout((function(){window.print()}),200)}))}))},initPrintPreview:function(t){this.nowModeId=t.fid,this.bpmnId=t.bpmnId,this.formmodeedit=!1,this.pluginStatus={readonly:!0,formmodeedit:this.formmodeedit};var e=this;this.setFormInfo("isPrintMode",!0),this.getFormMode().then((function(){e.printSetColor(),e.plugin=e.pluginCopy}))},setPluginsEvn:function(t){if(t){var e={},a=t.formData;for(var n in a)a.hasOwnProperty(n)&&(e[n]=a[n]);c["a"].add(e,"formData"+this.nowModeId),c["a"].add({all:e},"formData"+this.nowModeId)}},initExPreview:function(t){this.nowModeId=t.fid,this.bpmnId=t.bpmnId,this.formmodeedit=!1,this.pluginStatus={formmodeedit:this.formmodeedit};var e=this;this.getFormMode().then((function(){e.plugin=e.pluginCopy}))},initMobilePreview:function(t){this.nowModeId=t.fid,this.bpmnId=t.bpmnId,this.formmodeedit=!1,this.pluginStatus={ispc:!1,formmodeedit:this.formmodeedit};var e=this;this.getFormMode().then((function(){e.plugin=e.pluginCopy}))},getSaveFormData:function(t){if(this.setPluginStatusNew(this.plugin,{warning:!1}),t.isCheck){if(!this.checkDataRequired())return!1;if(!this.checkPluginValidate())return!1;if(!this.checkLimitHeight())return!1;if(!this.validateWordNumber())return!1}this.postMessage({method:t.callback,did:this.nowModeId,status:"success",data:this.getFormData()})},refreshSetColor:function(){for(var t in this.plugin.plugins)["dTable","dRepeatTable"].includes(this.plugin.plugins[t].type)&&this.setTableColor(this.plugin.plugins[t].attr.data.tableData,this.tableStyle.borderColor,!0)},toExportForm:function(){if(this.appCommonH.isEmptyObj(this.plugin.plugins))return this.$message("表格不可为空"),!1;var t={};if(this.delNoUsePlugin(),!this.checkPluginDesc())return this.$message({type:"error",message:"请设置字段含义"}),!1;t.table={eleidsrelation:this.eleidsrelation,mergeInfo:this.mergeInfo,formBaseInfo:this.formBaseInfo,layoutPluginSort:this.getLayoutPluginSort(),moduleInfo:this.moduleInfo},t.plugins=this.setPluginStatus(this.appCommonH.copyObj(this.plugin),{warning:!1,modeedit:!1,formmodeedit:!0}),t.table=t.table,t.plugins=t.plugins;var e=new Blob([JSON.stringify(t)],{type:"text/plain;charset=utf-8"});D.a.saveAs(e,"导出表单.txt")},toImportForm:function(t){try{var e=JSON.parse(t.data);if(!e.plugins||!e.table.layoutPluginSort||!e.table.eleidsrelation||!e.table.mergeInfo||!e.table.formBaseInfo)return this.$message({type:"error",message:"导入的文件已损坏"}),!1;this.eleidsrelation=e.table.eleidsrelation,this.mergeInfo=e.table.mergeInfo,this.formBaseInfo=e.table.formBaseInfo,this.layoutPluginSort=e.table.layoutPluginSort,this.moduleInfo=e.table.moduleInfo,this.plugin=e.plugins,this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:{plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins}}),this.$message({type:"success",message:"导入成功"})}catch(a){this.$message({type:"error",message:"导入的文件已损坏"})}},setFormData:function(t){for(var e in this.plugin.plugins)t.formData[e]&&(this.plugin.plugins[e].data=t.formData[e],this.plugin.plugins[e]=Object(i["a"])(Object(i["a"])({},{key:this.plugin.plugins[e].key}),this.plugin.plugins[e]));this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:{plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins}}),this.rtupdateInfo={method:"resetInit"}},saveDraft:function(t){var e=this;this.appFetch({url:"saveFormDraft",method:"POST",data:{id:t.did,app_id:this.appId,form_id:this.nowModeId,form_data:this.getFormData(),name:t.name}},(function(t){0==t.e?(e.postMessage({method:"saveDraftSuccess"}),e.postMessage({method:"getDraftList"}),e.$message({message:"保存成功",type:"success"})):e.$message(t.m)}),(function(t){e.$message("保存草稿失败")}))},heavyLoad:function(t){this.setPluginData(t,"plugins"),this.plugin={nowNum:this.plugin.plugins.nowNum,plugins:this.plugin.plugins,rtplugins:this.plugin.rtplugins},this.onlySetFormStatus({fid:this.nowModeId,status:3}),this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:this.plugin}),this.rtupdateInfo={method:"resetInit"},this.onlySetFormStatus({fid:this.nowModeId,status:2})}},k={delNoUsePlugin:function(){for(var t in this.plugin.plugins){var e=this.plugin.plugins[t];this.checkTdIsHas(e.tdid)||1==e.classtype||e.isLayout||this.$delete(this.plugin.plugins,t)}for(var t in this.plugin.rtplugins){var a=this.plugin.rtplugins[t];this.checkTdIsHas(a.tdid)||this.$delete(this.plugin.rtplugins,t)}},checkPluginDesc:function(){var t=!0;for(var e in this.plugin.plugins)this.plugin.plugins[e].description?this.plugin.plugins[e].status.warning&&(this.plugin.plugins[e].status.warning=!1,this.$set(this.plugin.plugins,e,this.appCommonH.copyObj(this.plugin.plugins[e]))):(this.plugin.plugins[e].status.warning=!0,this.$set(this.plugin.plugins,e,this.appCommonH.copyObj(this.plugin.plugins[e])),t=!1);return t},setPluginStatus:function(t,e){for(var a in t.plugins)for(var n in t.plugins[a].status)void 0!==e[n]&&(t.plugins[a].status[n]=e[n]);for(var i in t.rtplugins)for(var r in t.rtplugins[i].status)void 0!==e[r]&&(t.rtplugins[i].status[r]=e[r]);return t},setPluginStatusNew:function(t,e){for(var a in t.plugins){var n=!1;for(var r in t.plugins[a].status)void 0!==e[r]&&t.plugins[a].status[r]!=e[r]&&(n=!0,t.plugins[a].status[r]=e[r]);n&&this.$set(t.plugins,a,Object(i["a"])(Object(i["a"])({},{key:a}),t.plugins[a]))}},loadForm:function(t){if(t.table=JSON.parse(t.table),t.plugins=JSON.parse(t.plugins),!$.isEmptyObject(t.plugins.plugins)&&!this.pluginStatus.ispc){var e=[],a=[],n={};for(var r in t.plugins.plugins){var s=t.plugins.plugins[r];e[s.sort]||(e[s.sort]=[]),e[s.sort].push(s)}e.forEach((function(t){t&&t.length&&(a=a.concat(t))})),a.forEach((function(t){n[t.key]=t})),t.plugins.plugins=n}this.initFormStatus({fid:this.nowModeId,plugins:t.plugins.plugins}),this.formName=t.name,this.eleidsrelation=t.table.eleidsrelation,this.mergeInfo=t.table.mergeInfo?t.table.mergeInfo:{},this.formBaseInfo=Object(i["a"])(Object(i["a"])({},{printForm:{}}),t.table.formBaseInfo),this.layoutPluginSort=t.table.layoutPluginSort,this.moduleInfo=t.table.moduleInfo?t.table.moduleInfo:[],this.SET_TABLEPAGEINFO({fid:this.nowModeId,data:t.table.formBaseInfo});var o=this.setPluginStatus(Object(i["a"])(Object(i["a"])({},this.plugin),t.plugins),this.pluginStatus);this.SET_ALLPLUGINS({id:this.nowModeId,allplugin:o}),this.pluginCopy=o,this.setSortKeys();var l=this;this.postMessage({oid:"setsize",data:{method:"setType",sizeType:this.formBaseInfo.type}}),setTimeout((function(){l.postMessage({method:"updateModeId",fid:l.nowModeId,appid:l.appId,bpmnId:l.bpmnId,name:l.formName,version:l.version,printForm:l.formBaseInfo.printForm})}),200)},setSortKeys:function(){var t=this,e={},a=[],n=0;for(var i in this.pluginCopy.plugins)(this.pluginCopy.plugins[i].tdid||"dRepeatTable"==this.pluginCopy.plugins[i].type)&&(n++,e[i]=n,a.push(i));this.moduleInfo.length?this.moduleInfo.forEach((function(a,n){t.sortKeys.push("module_"+n);var i=[];a.plugins.forEach((function(t){i.push(t)})),i.sort((function(t,a){return e[t]-e[a]})),t.sortKeys=t.sortKeys.concat(i)})):this.sortKeys=a},getModuleInfoByIndex:function(t){var e=t.split("_")[1];return{name:this.moduleInfo[e].name,key:this.moduleInfo[e].key}},setFormInfo:function(t,e){this.$set(this.formInfo,t,e)},setPluginAuth:function(t,e){for(var a in this.pluginCopy[e]){!t.formData[a]&&0!==t.formData[a]||this.pluginCopy[e][a].pkey||(this.pluginCopy[e][a].data=t.formData[a]);var n=t.formAuth[a]?t.formAuth[a]:t.formAuth.defaultAuth;this.pluginCopy[e][a].classtype&&t.formAuth.outDefaultAuth&&!t.formAuth[a]&&(n=t.formAuth.outDefaultAuth),n&&(this.pluginCopy[e][a].status=Object(i["a"])(Object(i["a"])({},this.pluginCopy[e][a].status),this.getStatusByType(n)))}},getStatusByType:function(t){var e={};switch(t){case"forbidden":e={isshow:!1,readonly:!1,required:!1,disappear:!1,issave:!1};break;case"hidden":e={isshow:!1,readonly:!1,required:!1,disappear:!0,issave:!0};break;case"front_readonly":e={isshow:!0,readonly:!0,required:!1,disappear:!1,issave:!0};break;case"readable":e={isshow:!0,readonly:!0,required:!1,disappear:!1,issave:!1};break;case"writable":e={isshow:!0,readonly:!1,required:!1,disappear:!1,issave:!0};break;case"require":e={isshow:!0,readonly:!1,required:!0,disappear:!1,issave:!0};break}return e},printSetColor:function(){for(var t in this.pluginCopy.plugins)["dTable","dRepeatTable"].includes(this.pluginCopy.plugins[t].type)&&this.setTableColor(this.pluginCopy.plugins[t].attr.data.tableData,this.printBorderColor),["dArticle"].includes(this.pluginCopy.plugins[t].type)&&(this.pluginCopy.plugins[t].attr.borderColor=this.printBorderColor);this.printSetTextColor()},printSetTextColor:function(){for(var t in this.pluginCopy.plugins)1!=this.pluginCopy.plugins[t].printResetColor&&void 0!=this.pluginCopy.plugins[t].printResetColor||(this.pluginCopy.plugins[t].attr.style.color=this.printTextColor);for(var t in this.pluginCopy.rtplugins)1!=this.pluginCopy.rtplugins[t].printResetColor&&void 0!=this.pluginCopy.rtplugins[t].printResetColor||(this.pluginCopy.rtplugins[t].attr.style.color=this.printTextColor)},setTableColor:function(t,e,a){var n=this;t.trs.forEach((function(t){t.tds.forEach((function(t){n.setTableTdColor(t,e,a)}))})),this.changeBorderCollapse(t.id)},setTableTdColor:function(t,e,a){(t.style.borderColor==this.tableStyle.borderColor||t.style.borderColor==this.tableStyle.oldborderColor||a)&&(t.style.borderColor=e),(t.style.borderTopColor==this.tableStyle.borderColor||t.style.borderTopColor==this.tableStyle.oldborderColor||a)&&(t.style.borderTopColor=e),(t.style.borderBottomColor==this.tableStyle.borderColor||t.style.borderBottomColor==this.tableStyle.oldborderColor||a)&&(t.style.borderBottomColor=e),(t.style.borderColor&&-1!==t.style.borderColor.indexOf(this.tableStyle.borderColor)||a)&&(t.style.borderColor=t.style.borderColor.replace(this.tableStyle.borderColor,e))},getFormData:function(t){var e={};for(var a in this.plugin.plugins)if(this.plugin.plugins[a].status.issave){var n=this.plugin.plugins[a],i={};"dRepeatTable"==n.type&&n.data[0]&&n.data[0].id?(i=this.appCommonH.copyObj(this.plugin.plugins[a].data),i.forEach((function(t){delete t["id"]}))):i=this.plugin.plugins[a].data,e[a]=t?JSON.stringify(i):i}return e},checkDataRequired:function(){var t=this.plugin.plugins,e=!0,a="";for(var n in t)if(t[n].showHideSet)if(t[n].status.warning&&(t[n].status.warning=!1,this.$set(t,n,Object(i["a"])(Object(i["a"])({},{key:t[n].key}),t[n]))),"dRepeatTable"==t[n].type)if(t[n].status.required&&!t[n].data.length)a||(a="必须填写"+t[n].description),e=!1;else{var r=C["a"].dRepeatTable(t[n],this.plugin.rtplugins);this.checkRtableIsMust(t[n])&&r.length&&(a||(a="重复表"),this.apiValidate({errordata:r,isAlert:!0}),e=!1)}else t[n].status.required&&!C["a"].checkValue(t[n])&&(a||(a="必须填写"+t[n].description),t[n].status.warning=!0,this.$set(t,n,Object(i["a"])(Object(i["a"])({},{key:t[n].key}),t[n])),e=!1);return e||this.postMessage({method:"getDataCallback",did:this.nowModeId,status:"warning",warningmsg:"重复表"==a?"":a}),e},checkRtableIsMust:function(t){var e=!1;for(var a in this.plugin.rtplugins)this.plugin.rtplugins[a].pkey==t.key&&this.plugin.rtplugins[a].status.required&&(e=!0);return e},apiValidate:function(t){if(t.errordata&&t.errordata.length){var e="",a=this,n={};t.errordata.forEach((function(r,s){var o=!!a.plugin.plugins[r.key]&&a.plugin.plugins[r.key];o=o||a.plugin.rtplugins[r.key],o=o||!1;if(!o)return!0;var l=!!o.pkey&&a.plugin.plugins[o.pkey];switch("validator"==r.type?a.validateWarning(o,r):void 0!==r.row&&l?(n[l.key]=n[l.key]?n[l.key]:[],n[l.key].push({row:r.row,key:r.key})):(o.status.warning=!0,a.$set(a.plugin.plugins,r.key,Object(i["a"])(Object(i["a"])({},{key:o.key}),o))),r.type){case"require":e+="<p>必须填写"+(void 0!==r.row?a.getRtTableAlertPrefix(o,r.row):o.description)+"</p>";break;case"sensitive":e+="<p>"+r.error+"</p>";break;case"validator":e+="<p>"+r.message+"</p>";break}s<t.errordata.length-1&&(e+="<br />")})),$.isEmptyObject(n)||(this.rtupdateInfo={method:"showRequired",data:n}),e&&t.isAlert&&(this.$message.error({dangerouslyUseHTMLString:!0,message:e,showClose:!0}),$(".el-message .el-message__closeBtn").css({top:"15px"}))}},validateWarning:function(t,e){var a=t.attr.data.apiParams;for(var n in e.errorComponent&&e.errorComponent.length&&(a=e.errorComponent),a){var r=a[n];t=!!this.plugin.plugins[r]&&this.plugin.plugins[r];t&&(t.status.warning=!0,this.$set(this.plugin.plugins,r,Object(i["a"])(Object(i["a"])({},{key:t.key}),t)))}},getRtTableAlertPrefix:function(t,e){var a="重复表",n=this.plugin.plugins[t.pkey];return a+"“"+n.description+"”第"+(e+1)+"行的“"+t.description+"”"},getDataPluginCopy:function(t){var e={plugins:{},rtplugins:{}};for(var a in t.plugins){var n=t.plugins[a];["dTable","dOneColumn"].includes(n.type)||(e.plugins[a]=n)}for(var a in t.rtplugins){n=t.rtplugins[a];isNaN(n.key)&&(e.rtplugins[a]=n)}return this.appCommonH.copyObj(e)},checkPluginValidate:function(){var t=this.plugin.plugins;for(var e in t){var a=t[e];if("dValidate"===a.type&&!a.status.readonly)switch(a.attr.data.type){case 2:var n=!1;if(n=-1!==a.attr.data.rule.indexOf("$selfFunction")&&a.attr.data.functionStr?w["a"].getFuncResult(a.attr.data.rule,a.attr.data.functionStr,this.getCheckKeyVal(a),this.getDataPluginCopy(this.plugin),this.formInfo.formId):!!w["a"].getResult(a.attr.data.rule,this.getCheckKeyVal(a),this.getDataPluginCopy(this.plugin)),n){if(1===a.attr.data.errorlevel){this.ADD_WARNING({fid:this.nowModeId,warningmsg:a.attr.data.alert});break}return this.postMessage({method:"getDataCallback",did:this.nowModeId,status:"warning",warningmsg:a.attr.data.alert}),!1}break;case 1:var i=t[a.attr.data.validateKey];if(!i)return!0;n=C["a"].checkRegular(i.data,a.attr.data.method);if(!n){if(i.status.warning=!0,this.$set(t,a.attr.data.validateKey,this.appCommonH.copyObj(i)),1===a.attr.data.errorlevel){this.ADD_WARNING({fid:this.nowModeId,warningmsg:a.attr.data.alert});break}return this.postMessage({method:"getDataCallback",did:this.nowModeId,status:"warning",warningmsg:a.attr.data.alert}),!1}break}}return!0},checkLimitHeight:function(){for(var t in this.plugin.plugins){var e=this.plugin.plugins[t];if("dmultiInputs"==e.type&&!e.status.readonly&&e.attr.data.isLimited)return e.status.warning=!0,this.$set(this.plugin.plugins,e.key,this.appCommonH.copyObj(e)),this.postMessage({method:"getDataCallback",did:this.nowModeId,status:"warning",warningmsg:e.attr.data.limitHeightErrorMsg}),!1}return!0},validateWordNumber:function(){for(var t in this.plugin.plugins){var e=this.plugin.plugins[t],a=["dmultiInputs","dInput"];if(a.includes(e.type)&&!e.status.readonly&&(e.attr.data.minWord||e.attr.data.maxWord)&&e.data&&!this.appCommonH.validateWordNumber(e.data,e.attr.data.maxWord,e.attr.data.minWord))return this.postMessage({method:"getDataCallback",did:this.nowModeId,status:"warning",warningmsg:"".concat(e.description,"：请输入规定的字数")}),!1}return!0},getCheckKeyVal:function(t){var e={};for(var a in t.attr.data.keyval){var n=t.attr.data.keyval[a];"plugin"==n.type?(e[a]=n.evalVar,e[n.key+"Data"]=this.plugin.plugins[n.key]?this.plugin.plugins[n.key].data:""):e[a]=n.evalMethod}return e},setPluginData:function(t,e){for(var a in this.plugin[e])t.formData[a]&&!this.plugin[e][a].pkey&&(this.plugin[e][a].data=t.formData[a])}},S=a("897d"),A=a.n(S),E=a("599e"),T=a("0227"),I=a("9f3a");e["a"]={mixins:[E["a"],T["a"]],data:function(){var t,e=this;return{formHistory:{nowIndex:-1,list:[]},pageStyle:{padding:"20px 0px"},plugin:{nowNum:0,plugins:{},rtplugins:{}},pluginCopy:{},initPlugin:{tdid:"",key:"",pkey:"",description:"",initdata:{},data:{},columnType:"",type:"",pluginname:"",mobileshow:!0,printResetColor:!0,bringOutData:!0,sort:1e3,groupname:"",classtype:0,attr:{style:{fontSize:14,fontFamily:"微软雅黑",fontWeight:"normal",fontStyle:"normal",color:e.mixStyleColor,textDecoration:"none",textAlign:"left",marginTop:0,marginBottom:0,lineHeight:20,letterSpacing:0,mobileTitleStyle:{fontSize:14,fontFamily:"微软雅黑",color:"#878787",lineHeight:22}},data:{},setInfo:{}},status:{isshow:!0,readonly:!1,required:!1,prohibit:!1,warning:!1,modeedit:!1,formmodeedit:!0,ispc:!0}},initTable:{id:"",style:{margin:"0 auto",marginTop:"-20px"},rownum:0,colnum:0,width:0,tdid:"",tdModels:[],trs:[]},initTr:{id:"",style:{height:0},tds:[]},initTd:{id:"",rowspan:1,colspan:1,style:(t={borderColor:""},Object(r["a"])(t,"borderColor","#000"),Object(r["a"])(t,"borderStyle","solid"),t),table:{},dataid:""},tableStyle:{borderWidth:1,oldborderColor:"#DCDFE6",borderColor:"#BBBBBB",borderStyle:"solid",defaultWidth:50,defaultHeight:35,printDefaultHeight:20},tdChangeInfo:{nowTarget:null,oldEventX:0},selectData:{tableid:"",start:{id:"",row:0,col:0},end:{id:"",row:0,col:0},selectIds:[]},eleidsrelation:{table:{},tr:{},td:{}},layoutPluginSort:[],operationAlert:{removeRow:!0,addRow:!0,removeCol:!0,addCol:!0,removeTable:!0},upRowNum:1,downRowNum:1,leftColNum:1,rightColNum:1,mergeInfo:{},selectPlugins:[],rtselectData:[],rtupdateInfo:{},pluginUpdateInfo:{},formmodeedit:!1,resetTableList:[],resetTableBar:null,sortKeys:[],showoutbox:!1,startDoPlugin:!0,startDoOutPlugin:!1,formBaseInfo:{name:"",width:0,height:0,type:"",printForm:{}},pluginStatus:{isshow:!0,readonly:!1,required:!1,disappear:!1,warning:!1,modeedit:!1,formmodeedit:!0,ispc:!0},printBorderColor:"#000",printTextColor:"#000",formInfo:{},formModeData:{},version:"v3",nowModeId:0,fVId:0,published:!1,formName:"",appId:0,instId:0,bpmnId:0,nodeId:"",isShowTopAlert:!1,isShowModuleSet:!1,moduleInfo:[],newModuleInfo:[],selectModulekey:"",addModuleName:"",searchPName:"",moduleIndex:""}},props:["sendmessage","watchmessage"],computed:Object(i["a"])(Object(i["a"])({},Object(I["d"])("form",{})),{},{modulePlugins:function(){var t=[];for(var e in this.plugin.plugins){var a=this.plugin.plugins[e];["Table","Text","MultiText"].includes(a.columnType)||a.classtype||this.searchPName&&-1==a.description.indexOf(this.searchPName)&&-1==a.groupname.indexOf(this.searchPName)||t.push(a)}return t},moduleDisablePlugins:function(){var t=this;if(this.selectModulekey){var e=this.newModuleInfo.filter((function(e){return e.key!=t.selectModulekey})),a=[];return e.forEach((function(t){a=[].concat(Object(n["a"])(a),Object(n["a"])(t.plugins))})),a}return[]},modules_show:function(){var t=this,e={},a=0;return this.moduleInfo.forEach((function(n){var i=!1;n.plugins.forEach((function(e){var a=t.plugin.plugins[e];a&&a.mobileshow&&a.status.isshow&&!a.classtype&&(i=!0)})),i&&a++,e[n.key]=i})),{is_show:e,show_module:a>1}}}),watch:{watchmessage:function(t){t.method&&"function"==typeof this[t.method]&&this[t.method](t)},"selectData.selectIds":function(t){this.selectTdChange(t.length)},"selectData.selectIds.length":function(t){this.selectTdChange(t)},selectPlugins:function(t){this.selectPluginChange(t.length)},"selectPlugins.length":function(t){this.selectPluginChange(t)},"formHistory.nowIndex":function(t){if(-1==t)return!1;this.postMessage({oid:"tonew",data:{method:"setStatus",status:t<this.formHistory.list.length-1}});var e=this;setTimeout((function(){e.postMessage({oid:"toold",data:{method:"setStatus",status:e.formHistory.list.length>1&&0!==t}})}),200)},nowModeId:function(t){this.postMessage({method:"updateModeId",fid:t,appid:this.appId,bpmnid:this.bpmnId,name:this.formName,printForm:this.formBaseInfo.printForm})}},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])(Object(i["a"])({},l),u),d["a"]),h),g),f),m),b),v),y),x),k),Object(I["c"])("form",["SET_SELECTTD","SET_ALLPLUGINS","ADD_STARTLOADING","SET_TABLEPAGEINFO","SET_FORMLOADED","ADD_WARNING","REPEAT_OPERATIONALERT","SET_FORMSTATUS"])),Object(I["c"])("matter",["FORM_MATTER"])),Object(I["b"])("form",["toReduceStartLoading","initFormStatus","onlySetFormStatus"])),{},{addModuleInfo:function(t){if(!t)return this.$message.error({message:"模块名称不可为空",showClose:!0}),!1;var e="module_"+A()(Math.random().toString());this.newModuleInfo.push({name:t,key:e,plugins:[]}),this.addModuleName="",this.selectModulekey=e},reduceModuleInfo:function(t){this.newModuleInfo=this.newModuleInfo.filter((function(e){return e.key!=t})),this.selectModulekey==t&&this.newModuleInfo.length&&(this.selectModulekey=this.newModuleInfo[0].key)},showModuleSet:function(){this.selectModulekey=this.moduleInfo.length?this.moduleInfo[0].key:"",this.newModuleInfo=this.appCommonH.copyObj(this.moduleInfo),this.moduleIndex="",this.isShowModuleSet=!0},setModuleCallback:function(t){t&&(this.moduleInfo=this.appCommonH.copyObj(this.newModuleInfo)),this.isShowModuleSet=!1},sortModuleInfo:function(t){if(!this.moduleIndex||this.moduleIndex<=0)return this.$message.error({message:"请输入正确的跳转位置",showClose:!0}),!1;var e=this.moduleIndex>this.newModuleInfo.length?this.newModuleInfo.length:this.moduleIndex,a=this.newModuleInfo.splice(t,1)[0];this.newModuleInfo.splice(e-1,0,a),this.moduleIndex=""},slideToggle_module:function(){$(".module_dropdown ul").slideToggle(200,(function(){$(".module_dropdown ul").is(":visible")?$(".dropdown_link i").removeClass("el-icon-arrow-down").addClass("el-icon-arrow-up"):$(".dropdown_link i").removeClass("el-icon-arrow-up").addClass("el-icon-arrow-down")}))},to_anchor:function(t){this.slideToggle_module();var e=$("#"+t).offset().top,a=Object.keys(tablevm.$store.state.form.allplugin).length>1,n=a?100:50;e-=$(window).scrollTop()>=50?n:a?50:0,$(window).scrollTop(e)},selectPluginChange:function(t){var e=this;this.postMessage({oid:"removeplugin",data:{method:"setStatus",status:!!t}}),setTimeout((function(){e.postMessage({oid:"removeselect",data:{method:"setStatus",status:!!t}})}),50)},selectTdChange:function(t){var e=this;this.postMessage({oid:"removeselect",data:{method:"setStatus",status:!!this.rtselectData.length||!!this.selectData.selectIds.length||!!this.selectPlugins.length}}),setTimeout((function(){e.postMessage({oid:"sliptrc",data:{method:"setStatus",status:1==t&&e.mergeInfo[e.selectData.selectIds[0]]}})}),100),setTimeout((function(){e.postMessage({oid:"mergerc",data:{method:"setStatus",status:t>1&&e.checkCanMerge()}})}),50)},postMessage:function(t,e){e=e||"operation",this.$emit("sendmessage",t,e)},loadWatermark:function(){if(this.formmodeedit||!this.formInfo.isPrintMode||!this.formBaseInfo.printForm)return!1;var t=this.formBaseInfo.printForm.watermark,e=this.formBaseInfo.printForm.watermarkRatio;setTimeout((function(){var a=$(".pageBox").height()+200,n=$(".pageBox").find(".dplugin-layout:eq(0)").width();$(".watermark").css({width:n,height:a,position:"absolute"});for(var i=.8*n,r=i*e,s=Math.ceil(a/r),o="",l=1;l<=s;l++)o+='<img src="'+t+'" />';$(".watermark").html(o)}),200)},loadTopAlertStart:function(){var t=this,e=$(".main-middle-tablist").offset();$(window).scroll((function(){var a="table_"+t.nowModeId,n=$(this).scrollTop(),i=$('[data-id="'+a+'"]'),r=i.find(".topAlert"),s=r.offset();s.top-n<=e.top?(i.find(".topAlertClone").length||(i.find(".topAlert").clone().addClass("topAlertClone").appendTo(i),i.find(".topAlert").css({opacity:0})),i.find(".topAlertClone").css({position:"fixed",width:i.width(),top:e.top,left:s.left,zIndex:1001,opacity:1})):i.find(".topAlertClone").length&&(i.find(".topAlertClone").remove(),i.find(".topAlert").css({opacity:1}))})),$(".main-middle-tabtit ul li").click((function(){$(".main-middle-tablist ul li").each((function(){!$(this).hasClass("active")&&$(this).find(".topAlertClone")&&$(this).find(".topAlertClone").css({opacity:0})})),setTimeout((function(){$(window).trigger("scroll"),$(".main-middle-tablist ul li").each((function(){$(this).hasClass("active")&&$(this).find(".topAlertClone")&&$(this).find(".topAlertClone").css({opacity:1})}))}),50)}))},loadTopAlertExam:function(){var t=this,e=$(".main-middle-tablist").offset(),a=0,n=0;$(".main-middle-tablist").scroll((function(){var i="table_"+t.nowModeId,r=$('[data-id="'+i+'"]'),s=r.find(".topAlert"),o=s.offset();return n=$(this).scrollTop(),o.top-n<=e.top||a>=145?(r.find(".topAlertClone").length||(r.find(".topAlert").clone().addClass("topAlertClone").appendTo(r),r.find(".topAlert").css({opacity:0})),r.find(".topAlertClone").css({position:"fixed",width:r.width(),top:e.top-(a>145?145:a),left:o.left,zIndex:1001,opacity:1})):r.find(".topAlertClone").length&&(r.find(".topAlertClone").remove(),r.find(".topAlert").css({opacity:1})),!1})),$(window).scroll((function(){a=$(this).scrollTop(),$(".main-middle-tablist").trigger("scroll")})),$(".main-middle-tabtit ul li").click((function(){$(".main-middle-tablist ul li").each((function(){!$(this).hasClass("active")&&$(this).find(".topAlertClone")&&$(this).find(".topAlertClone").css({opacity:0})})),setTimeout((function(){$(".main-middle-tablist").trigger("scroll"),$(".main-middle-tablist ul li").each((function(){$(this).hasClass("active")&&$(this).find(".topAlertClone")&&$(this).find(".topAlertClone").css({opacity:1})}))}),50)}))},loadEvent:function(){var t=this;if(this.loadWatermark(),setTimeout((function(){var e=!!$('[data-id="table_'+t.nowModeId+'"]').parents(".el-dialog__body").length;$(".main-middle-tablist").length&&t.formBaseInfo.printForm.topALert&&!e&&(t.isShowTopAlert=!0,t.$nextTick((function(){$(".notifyDetial").length?this.loadTopAlertExam():this.loadTopAlertStart()})))}),200),!this.formmodeedit)return!1;var e=this;function a(t){var a=$(".operationalert .insertTr"),n=$(".operationalert input"),i=$(".operationalert i");!$(".operationalert").is(":visible")||a.is(t.target)||n.is(t.target)||i.is(t.target)||($(".operationalert").hide(),e.upRowNum=1,e.downRowNum=1,e.leftColNum=1,e.rightColNum=1)}$(document).on("mouseleave",".pageBox",(function(t){return e.tdChangeMouseup(t),!1})),$(document).on("mouseleave",".formtable",(function(t){return e.toMouseout($(this).attr("data-id")),!1})),$(document).on("contextmenu",".pageBox",(function(t){var a=null,n="TD"==t.target.tagName?$(t.target):$(t.target).parents("td").length?$(t.target).parents("td")[0]:$(t.target).parents("td");if(n=$(n),n.length&&n.find(".dplugin-box").length){var i=n.find(".dplugin-box").attr("data-key"),r=e.getPluginByKey(i);a=r.tdid,a&&(e.selectData.selectIds=[a])}if(!e.checkAlertStatus(a))return!1;var s=".table_content",o=$(".pageBox").offset(),l=(o.left,o.top+$(s).scrollTop()),u=o.left+$(".pageBox").width(),d=l-20+($(s).outerHeight()>$(".pageBox").height()?$(".pageBox").height():$(s).outerHeight()),c={width:$(".operationalert").width(),height:$(".operationalert").height()},p=t.clientY,h=t.clientX;return u-t.clientX<c.width&&(h=t.clientX-c.width-2),d-t.clientY<c.height&&(p=t.clientY-c.height-2),$(".operationalert").css({top:p+"px",left:h+"px"}).show(),!1})),$(document).on("click","body",(function(t){a(t)}));var n=e.formmodeedit?".table_content":window;function i(){var t=o()([document.querySelector("#pageBox")],{moves:function(t,e,a){return a.classList.contains("moveelement")},ignoreInputTextSelection:!0}),e=!1;t.on("drag",(function(t,a){e=!0})),t.on("dragend",(function(t){e=!1})),document.onmousemove=function(t){if(!$(t.target).parents("#pageBox").length)return!0;if(!e)return!1;var a=$(".table_content").offset(),n=($(".table_content").width(),$(".table_content").height()),i=$(".table_content").scrollTop(),r=a.top,s=a.top+n;t.pageY>s?$(".table_content").scrollTop(i+(t.pageY-s)):t.pageY<r&&$(".table_content").scrollTop(i-(r-t.pageY))}}function r(){$(".form_content").length&&($(".form_content .content_box").height($(window).height()-$(".header_box").height()-30),$(".form_content .content_box .table_content").width($(window).width()-360-30-10),$(".form_content .plugin_content, .form_content .table_content").height($(window).height()-$(".header_box").height()-30))}$(n).scroll((function(t){a(t)})),$(document).on("mouseover",".operationalert li",(function(){return $(this).hasClass("active")||($(this).siblings("li").removeClass("active"),$(this).addClass("active")),!1})),$(document).on("mouseleave",".operationalert",(function(){return $(this).find(".active").removeClass("active"),!1})),$(document).on("click",".dplugin-box",(function(t){e.addSelectPlugin($(this).attr("data-key"),!t.shiftKey)})),$(document).keydown((function(t){if($(".form_content").length&&t.shiftKey)switch(t.keyCode){case 68:e.removePlugin();break;case 82:e.removeSelect(),e.removeAllSelectPlugin();break;case 67:e.copyPlugin();break;case 86:e.pastePlugin();break;case 88:e.shearPlugin();break}})),i(),r(),$(window).resize(r)}}),beforeDestory:function(){$(document).off("mouseleave",".formtable"),$(document).off("mouseleave",".pageBox"),$(document).off("mousemove",".pageBox"),$(document).off("mouseup",".pageBox"),$(document).off("contextmenu","table"),$(document).off("mouseover",".operationalert li"),$(document).off("mouseleave",".operationalert"),$(document).off("click",".dplugin-box"),$(document).off("click",".ctrl-close")},mounted:function(){window.tablevm=this,this.initPlugin.attr.style.color=this.mixStyleColor}}},e026:function(t,e){var a=1/0,n=Math.abs,i=Math.pow,r=Math.floor,s=Math.log,o=Math.LN2,l=function(t,e,l){var u,d,c,p=new Array(l),h=8*l-e-1,g=(1<<h)-1,f=g>>1,m=23===e?i(2,-24)-i(2,-77):0,v=t<0||0===t&&1/t<0?1:0,b=0;for(t=n(t),t!=t||t===a?(d=t!=t?1:0,u=g):(u=r(s(t)/o),t*(c=i(2,-u))<1&&(u--,c*=2),t+=u+f>=1?m/c:m*i(2,1-f),t*c>=2&&(u++,c/=2),u+f>=g?(d=0,u=g):u+f>=1?(d=(t*c-1)*i(2,e),u+=f):(d=t*i(2,f-1)*i(2,e),u=0));e>=8;p[b++]=255&d,d/=256,e-=8);for(u=u<<e|d,h+=e;h>0;p[b++]=255&u,u/=256,h-=8);return p[--b]|=128*v,p},u=function(t,e){var n,r=t.length,s=8*r-e-1,o=(1<<s)-1,l=o>>1,u=s-7,d=r-1,c=t[d--],p=127&c;for(c>>=7;u>0;p=256*p+t[d],d--,u-=8);for(n=p&(1<<-u)-1,p>>=-u,u+=e;u>0;n=256*n+t[d],d--,u-=8);if(0===p)p=1-l;else{if(p===o)return n?NaN:c?-a:a;n+=i(2,e),p-=l}return(c?-1:1)*n*i(2,p-e)};t.exports={pack:l,unpack:u}},e10c:function(t,e,a){var n,i=i||function(t){"use strict";if(!("undefined"===typeof t||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,a=function(){return t.URL||t.webkitURL||t},n=e.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in n,r=function(t){var e=new MouseEvent("click");t.dispatchEvent(e)},s=/constructor/i.test(t.HTMLElement)||t.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(e){(t.setImmediate||t.setTimeout)((function(){throw e}),0)},u="application/octet-stream",d=4e4,c=function(t){var e=function(){"string"===typeof t?a().revokeObjectURL(t):t.remove()};setTimeout(e,d)},p=function(t,e,a){e=[].concat(e);var n=e.length;while(n--){var i=t["on"+e[n]];if("function"===typeof i)try{i.call(t,a||t)}catch(r){l(r)}}},h=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},g=function(e,l,d){d||(e=h(e));var g,f=this,m=e.type,v=m===u,b=function(){p(f,"writestart progress write writeend".split(" "))},y=function(){if((o||v&&s)&&t.FileReader){var n=new FileReader;return n.onloadend=function(){var e=o?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;"),a=t.open(e,"_blank");a||(t.location.href=e),e=void 0,f.readyState=f.DONE,b()},n.readAsDataURL(e),void(f.readyState=f.INIT)}if(g||(g=a().createObjectURL(e)),v)t.location.href=g;else{var i=t.open(g,"_blank");i||(t.location.href=g)}f.readyState=f.DONE,b(),c(g)};if(f.readyState=f.INIT,i)return g=a().createObjectURL(e),void setTimeout((function(){n.href=g,n.download=l,r(n),b(),c(g),f.readyState=f.DONE}));y()},f=g.prototype,m=function(t,e,a){return new g(t,e||t.name||"download",a)};return"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,a){return e=e||t.name||"download",a||(t=h(t)),navigator.msSaveOrOpenBlob(t,e)}:(f.abort=function(){},f.readyState=f.INIT=0,f.WRITING=1,f.DONE=2,f.error=f.onwritestart=f.onprogress=f.onwrite=f.onabort=f.onerror=f.onwriteend=null,m)}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */t.exports?t.exports.saveAs=i:null!==a("a9db")&&null!==a("1531")&&(n=function(){return i}.call(e,a,e,t),void 0===n||(t.exports=n))},e195:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ITF14=e.ITF=void 0;var n=a("eaf2"),i=o(n),r=a("0df1"),s=o(r);function o(t){return t&&t.__esModule?t:{default:t}}e.ITF=i.default,e.ITF14=s.default},e1d9:function(t,e,a){var n=a("2118");t.exports=function(t){if("number"!=typeof t&&"Number"!=n(t))throw TypeError("Incorrect invocation");return+t}},e281:function(t,e,a){},e4f2:function(t,e,a){"use strict";var n=a("57eb"),i=a.n(n);i.a},e671:function(t,e,a){"use strict";var n=a("5a9e"),i=a("d88d"),r=a("7aeb"),s=a("3553"),o=a("efe2"),l=n.aTypedArray,u=n.exportTypedArrayMethod,d=o((function(){new Int8Array(1).set({})}));u("set",(function(t){l(this);var e=r(arguments.length>1?arguments[1]:void 0,1),a=this.length,n=s(t),o=i(n.length),u=0;if(o+e>a)throw RangeError("Wrong length");while(u<o)this[e+u]=n[u++]}),d)},e673:function(t,e,a){"use strict";e["a"]={data:function(){return{mixHideMDetailBtn:[337,347],mixMIndexHeigth:{height:"calc(100vh - 0.5rem - 0.43rem)"}}}}},e89f:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("35e7"),r=o(i),s=a("9b97");function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function d(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=function(t){function e(t,a){return l(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s.A_START_CHAR+t,a))}return d(e,t),n(e,[{key:"valid",value:function(){return new RegExp("^"+s.A_CHARS+"+$").test(this.data)}}]),e}(r.default);e.default=c},eaf2:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),i=a("f477"),r=a("2986"),s=o(r);function o(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function d(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=function(t){function e(){return l(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return d(e,t),n(e,[{key:"valid",value:function(){return-1!==this.data.search(/^([0-9]{2})+$/)}},{key:"encode",value:function(){var t=this,e=this.data.match(/.{2}/g).map((function(e){return t.encodePair(e)})).join("");return{data:i.START_BIN+e+i.END_BIN,text:this.text}}},{key:"encodePair",value:function(t){var e=i.BINARIES[t[1]];return i.BINARIES[t[0]].split("").map((function(t,a){return("1"===t?"111":"1")+("1"===e[a]?"000":"0")})).join("")}}]),e}(s.default);e.default=c},ebc3:function(t,e,a){},ec74:function(t,e,a){"use strict";var n=a("2842"),i=a.n(n);i.a},ee62:function(module,exports,__webpack_require__){(function(global){(function(){var global=this;function Mtils(){var Mtils={constant:{CONTROL_KEY:{BACK_SPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACE:32,END:35,HOME:36,INSERT:45,PAGE_UP:33,PAGE_DOWN:34,DELETE:46,CONTEXT_MENU:93,8:"BACK_SPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",20:"CAPS_LOCK",27:"ESC",32:"SPACE",35:"END",36:"HOME",45:"INSERT",33:"PAGE_UP",34:"PAGE_DOWN",46:"DELETE",93:"CONTEXT_MENU"},WOMAN:0,MAN:1,BASE_DECIMAL:"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_@",PY_MAPS:{a:"啊阿锕",ai:"埃挨哎唉哀皑癌蔼矮艾碍爱隘诶捱嗳嗌嫒瑷暧砹锿霭",an:"鞍氨安俺按暗岸胺案谙埯揞犴庵桉铵鹌顸黯",ang:"肮昂盎",ao:"凹敖熬翱袄傲奥懊澳坳拗嗷噢岙廒遨媪骜聱螯鏊鳌鏖",ba:"芭捌扒叭吧笆八疤巴拔跋靶把耙坝霸罢爸茇菝萆捭岜灞杷钯粑鲅魃",bai:"白柏百摆佰败拜稗薜掰鞴",ban:"斑班搬扳般颁板版扮拌伴瓣半办绊阪坂豳钣瘢癍舨",bang:"邦帮梆榜膀绑棒磅蚌镑傍谤蒡螃",bao:"苞胞包褒雹保堡饱宝抱报暴豹鲍爆勹葆宀孢煲鸨褓趵龅",bo:"剥薄玻菠播拨钵波博勃搏铂箔伯帛舶脖膊渤泊驳亳蕃啵饽檗擘礴钹鹁簸跛",bei:"杯碑悲卑北辈背贝钡倍狈备惫焙被孛陂邶埤蓓呗怫悖碚鹎褙鐾",ben:"奔苯本笨畚坌锛",beng:"崩绷甭泵蹦迸唪嘣甏",bi:"逼鼻比鄙笔彼碧蓖蔽毕毙毖币庇痹闭敝弊必辟壁臂避陛匕仳俾芘荜荸吡哔狴庳愎滗濞弼妣婢嬖璧贲畀铋秕裨筚箅篦舭襞跸髀",bian:"鞭边编贬扁便变卞辨辩辫遍匾弁苄忭汴缏煸砭碥稹窆蝙笾鳊",biao:"标彪膘表婊骠飑飙飚灬镖镳瘭裱鳔",bie:"鳖憋别瘪蹩鳘",bin:"彬斌濒滨宾摈傧浜缤玢殡膑镔髌鬓",bing:"兵冰柄丙秉饼炳病并禀邴摒绠枋槟燹",bu:"捕卜哺补埠不布步簿部怖拊卟逋瓿晡钚醭",ca:"擦嚓礤",cai:"猜裁材才财睬踩采彩菜蔡",can:"餐参蚕残惭惨灿骖璨粲黪",cang:"苍舱仓沧藏伧",cao:"操糙槽曹草艹嘈漕螬艚",ce:"厕策侧册测刂帻恻",ceng:"层蹭噌",cha:"插叉茬茶查碴搽察岔差诧猹馇汊姹杈楂槎檫钗锸镲衩",chai:"拆柴豺侪茈瘥虿龇",chan:"搀掺蝉馋谗缠铲产阐颤冁谄谶蒇廛忏潺澶孱羼婵嬗骣觇禅镡裣蟾躔",chang:"昌猖场尝常长偿肠厂敞畅唱倡伥鬯苌菖徜怅惝阊娼嫦昶氅鲳",chao:"超抄钞朝嘲潮巢吵炒怊绉晁耖",che:"车扯撤掣彻澈坼屮砗",chen:"郴臣辰尘晨忱沉陈趁衬称谌抻嗔宸琛榇肜胂碜龀",cheng:"撑城橙成呈乘程惩澄诚承逞骋秤埕嵊徵浈枨柽樘晟塍瞠铖裎蛏酲",chi:"吃痴持匙池迟弛驰耻齿侈尺赤翅斥炽傺墀芪茌搋叱哧啻嗤彳饬沲媸敕胝眙眵鸱瘛褫蚩螭笞篪豉踅踟魑",chong:"充冲虫崇宠茺忡憧铳艟",chou:"抽酬畴踌稠愁筹仇绸瞅丑俦圳帱惆溴妯瘳雠鲋",chu:"臭初出橱厨躇锄雏滁除楚础储矗搐触处亍刍憷绌杵楮樗蜍蹰黜",chuan:"揣川穿椽传船喘串掾舛惴遄巛氚钏镩舡",chuang:"疮窗幢床闯创怆",chui:"吹炊捶锤垂陲棰槌",chun:"春椿醇唇淳纯蠢促莼沌肫朐鹑蝽",chuo:"戳绰蔟辶辍镞踔龊",ci:"疵茨磁雌辞慈瓷词此刺赐次荠呲嵯鹚螅糍趑",cong:"聪葱囱匆从丛偬苁淙骢琮璁枞",cu:"凑粗醋簇猝殂蹙",cuan:"蹿篡窜汆撺昕爨",cui:"摧崔催脆瘁粹淬翠萃悴璀榱隹",cun:"村存寸磋忖皴",cuo:"撮搓措挫错厝脞锉矬痤鹾蹉躜",da:"搭达答瘩打大耷哒嗒怛妲疸褡笪靼鞑",dai:"呆歹傣戴带殆代贷袋待逮怠埭甙呔岱迨逯骀绐玳黛",dan:"耽担丹单郸掸胆旦氮但惮淡诞弹蛋亻儋卩萏啖澹檐殚赕眈瘅聃箪",dang:"当挡党荡档谠凼菪宕砀铛裆",dao:"刀捣蹈倒岛祷导到稻悼道盗叨啁忉洮氘焘忑纛",de:"德得的锝",deng:"蹬灯登等瞪凳邓噔嶝戥磴镫簦",di:"堤低滴迪敌笛狄涤翟嫡抵底地蒂第帝弟递缔氐籴诋谛邸坻莜荻嘀娣柢棣觌砥碲睇镝羝骶",dian:"颠掂滇碘点典靛垫电佃甸店惦奠淀殿丶阽坫埝巅玷癜癫簟踮",diao:"碉叼雕凋刁掉吊钓调轺铞蜩粜貂",die:"跌爹碟蝶迭谍叠佚垤堞揲喋渫轶牒瓞褶耋蹀鲽鳎",ding:"丁盯叮钉顶鼎锭定订丢仃啶玎腚碇町铤疔耵酊",dong:"东冬董懂动栋侗恫冻洞垌咚岽峒夂氡胨胴硐鸫",dou:"兜抖斗陡豆逗痘蔸钭窦窬蚪篼酡",du:"都督毒犊独读堵睹赌杜镀肚度渡妒芏嘟渎椟橐牍蠹笃髑黩",duan:"端短锻段断缎彖椴煅簖",dui:"堆兑队对怼憝碓",dun:"墩吨蹲敦顿囤钝盾遁炖砘礅盹镦趸",duo:"掇哆多夺垛躲朵跺舵剁惰堕咄哚缍柁铎裰踱",e:"蛾峨鹅俄额讹娥恶厄扼遏鄂饿噩谔垩垭苊莪萼呃愕屙婀轭曷腭硪锇锷鹗颚鳄",en:"恩蒽摁唔嗯",er:"而儿耳尔饵洱二贰迩珥铒鸸鲕",fa:"发罚筏伐乏阀法珐垡砝",fan:"藩帆番翻樊矾钒繁凡烦反返范贩犯饭泛蘩幡犭梵攵燔畈蹯",fang:"坊芳方肪房防妨仿访纺放匚邡彷钫舫鲂",fei:"菲非啡飞肥匪诽吠肺废沸费芾狒悱淝妃绋绯榧腓斐扉祓砩镄痱蜚篚翡霏鲱",fen:"芬酚吩氛分纷坟焚汾粉奋份忿愤粪偾瀵棼愍鲼鼢",feng:"丰封枫蜂峰锋风疯烽逢冯缝讽奉凤俸酆葑沣砜",fu:"佛否夫敷肤孵扶拂辐幅氟符伏俘服浮涪福袱弗甫抚辅俯釜斧脯腑府腐赴副覆赋复傅付阜父腹负富讣附妇缚咐匐凫郛芙苻茯莩菔呋幞滏艴孚驸绂桴赙黻黼罘稃馥虍蚨蜉蝠蝮麸趺跗鳆",ga:"噶嘎蛤尬呷尕尜旮钆",gai:"该改概钙盖溉丐陔垓戤赅胲",gan:"干甘杆柑竿肝赶感秆敢赣坩苷尴擀泔淦澉绀橄旰矸疳酐",gang:"冈刚钢缸肛纲岗港戆罡颃筻",gong:"杠工攻功恭龚供躬公宫弓巩汞拱贡共蕻廾咣珙肱蚣蛩觥",gao:"篙皋高膏羔糕搞镐稿告睾诰郜蒿藁缟槔槁杲锆",ge:"哥歌搁戈鸽胳疙割革葛格阁隔铬个各鬲仡哿塥嗝纥搿膈硌铪镉袼颌虼舸骼髂",gei:"给",gen:"根跟亘茛哏艮",geng:"耕更庚羹埂耿梗哽赓鲠",gou:"钩勾沟苟狗垢构购够佝诟岣遘媾缑觏彀鸲笱篝鞲",gu:"辜菇咕箍估沽孤姑鼓古蛊骨谷股故顾固雇嘏诂菰哌崮汩梏轱牯牿胍臌毂瞽罟钴锢瓠鸪鹄痼蛄酤觚鲴骰鹘",gua:"刮瓜剐寡挂褂卦诖呱栝鸹",guai:"乖拐怪哙",guan:"棺关官冠观管馆罐惯灌贯倌莞掼涫盥鹳鳏",guang:"光广逛犷桄胱疒",gui:"瑰规圭硅归龟闺轨鬼诡癸桂柜跪贵刽匦刿庋宄妫桧炅晷皈簋鲑鳜",gun:"辊滚棍丨衮绲磙鲧",guo:"锅郭国果裹过馘蠃埚掴呙囗帼崞猓椁虢锞聒蜮蜾蝈",ha:"哈",hai:"骸孩海氦亥害骇咴嗨颏醢",han:"酣憨邯韩含涵寒函喊罕翰撼捍旱憾悍焊汗汉邗菡撖阚瀚晗焓颔蚶鼾",hen:"夯痕很狠恨",hang:"杭航沆绗珩桁",hao:"壕嚎豪毫郝好耗号浩薅嗥嚆濠灏昊皓颢蚝",he:"呵喝荷菏核禾和何合盒貉阂河涸赫褐鹤贺诃劾壑藿嗑嗬阖盍蚵翮",hei:"嘿黑",heng:"哼亨横衡恒訇蘅",hong:"轰哄烘虹鸿洪宏弘红黉讧荭薨闳泓",hou:"喉侯猴吼厚候后堠後逅瘊篌糇鲎骺",hu:"呼乎忽瑚壶葫胡蝴狐糊湖弧虎唬护互沪户冱唿囫岵猢怙惚浒滹琥槲轷觳烀煳戽扈祜鹕鹱笏醐斛",hua:"花哗华猾滑画划化话劐浍骅桦铧稞",huai:"槐徊怀淮坏还踝",huan:"欢环桓缓换患唤痪豢焕涣宦幻郇奂垸擐圜洹浣漶寰逭缳锾鲩鬟",huang:"荒慌黄磺蝗簧皇凰惶煌晃幌恍谎隍徨湟潢遑璜肓癀蟥篁鳇",hui:"灰挥辉徽恢蛔回毁悔慧卉惠晦贿秽会烩汇讳诲绘诙茴荟蕙哕喙隳洄彗缋珲晖恚虺蟪麾",hun:"荤昏婚魂浑混诨馄阍溷缗",huo:"豁活伙火获或惑霍货祸攉嚯夥钬锪镬耠蠖",ji:"击圾基机畸稽积箕肌饥迹激讥鸡姬绩缉吉极棘辑籍集及急疾汲即嫉级挤几脊己蓟技冀季伎祭剂悸济寄寂计记既忌际妓继纪居丌乩剞佶佴脔墼芨芰萁蒺蕺掎叽咭哜唧岌嵴洎彐屐骥畿玑楫殛戟戢赍觊犄齑矶羁嵇稷瘠瘵虮笈笄暨跻跽霁鲚鲫髻麂",jia:"嘉枷夹佳家加荚颊贾甲钾假稼价架驾嫁伽郏拮岬浃迦珈戛胛恝铗镓痂蛱笳袈跏",jian:"歼监坚尖笺间煎兼肩艰奸缄茧检柬碱硷拣捡简俭剪减荐槛鉴践贱见键箭件健舰剑饯渐溅涧建僭谏谫菅蒹搛囝湔蹇謇缣枧柙楗戋戬牮犍毽腱睑锏鹣裥笕箴翦趼踺鲣鞯",jiang:"僵姜将浆江疆蒋桨奖讲匠酱降茳洚绛缰犟礓耩糨豇",jiao:"蕉椒礁焦胶交郊浇骄娇嚼搅铰矫侥脚狡角饺缴绞剿教酵轿较叫佼僬茭挢噍峤徼姣纟敫皎鹪蛟醮跤鲛",jie:"窖揭接皆秸街阶截劫节桔杰捷睫竭洁结解姐戒藉芥界借介疥诫届偈讦诘喈嗟獬婕孑桀獒碣锴疖袷颉蚧羯鲒骱髫",jin:"巾筋斤金今津襟紧锦仅谨进靳晋禁近烬浸尽卺荩堇噤馑廑妗缙瑾槿赆觐钅锓衿矜",jing:"劲荆兢茎睛晶鲸京惊精粳经井警景颈静境敬镜径痉靖竟竞净刭儆阱菁獍憬泾迳弪婧肼胫腈旌",jiong:"炯窘冂迥扃",jiu:"揪究纠玖韭久灸九酒厩救旧臼舅咎就疚僦啾阄柩桕鹫赳鬏",ju:"鞠拘狙疽驹菊局咀矩举沮聚拒据巨具距踞锯俱句惧炬剧倨讵苣苴莒掬遽屦琚枸椐榘榉橘犋飓钜锔窭裾趄醵踽龃雎鞫",juan:"捐鹃娟倦眷卷绢鄄狷涓桊蠲锩镌隽",jue:"撅攫抉掘倔爵觉决诀绝厥劂谲矍蕨噘崛獗孓珏桷橛爝镢蹶觖",jun:"均菌钧军君峻俊竣浚郡骏捃狻皲筠麇",ka:"喀咖卡佧咔胩",ke:"咯坷苛柯棵磕颗科壳咳可渴克刻客课岢恪溘骒缂珂轲氪瞌钶疴窠蝌髁",kai:"开揩楷凯慨剀垲蒈忾恺铠锎",kan:"刊堪勘坎砍看侃凵莰莶戡龛瞰",kang:"康慷糠扛抗亢炕坑伉闶钪",kao:"考拷烤靠尻栲犒铐",ken:"肯啃垦恳垠裉颀",keng:"吭忐铿",kong:"空恐孔控倥崆箜",kou:"抠口扣寇芤蔻叩眍筘",ku:"枯哭窟苦酷库裤刳堀喾绔骷",kua:"夸垮挎跨胯侉",kuai:"块筷侩快蒯郐蒉狯脍",kuan:"宽款髋",kuang:"匡筐狂框矿眶旷况诓诳邝圹夼哐纩贶",kui:"亏盔岿窥葵奎魁傀馈愧溃馗匮夔隗揆喹喟悝愦阕逵暌睽聩蝰篑臾跬",kun:"坤昆捆困悃阃琨锟醌鲲髡",kuo:"括扩廓阔蛞",la:"垃拉喇蜡腊辣啦剌摺邋旯砬瘌",lai:"莱来赖崃徕涞濑赉睐铼癞籁",lan:"蓝婪栏拦篮阑兰澜谰揽览懒缆烂滥啉岚懔漤榄斓罱镧褴",lang:"琅榔狼廊郎朗浪莨蒗啷阆锒稂螂",lao:"捞劳牢老佬姥酪烙涝唠崂栳铑铹痨醪",le:"勒乐肋仂叻嘞泐鳓",lei:"雷镭蕾磊累儡垒擂类泪羸诔荽咧漯嫘缧檑耒酹",ling:"棱冷拎玲菱零龄铃伶羚凌灵陵岭领另令酃塄苓呤囹泠绫柃棂瓴聆蛉翎鲮",leng:"楞愣",li:"厘梨犁黎篱狸离漓理李里鲤礼莉荔吏栗丽厉励砾历利傈例俐痢立粒沥隶力璃哩俪俚郦坜苈莅蓠藜捩呖唳喱猁溧澧逦娌嫠骊缡珞枥栎轹戾砺詈罹锂鹂疠疬蛎蜊蠡笠篥粝醴跞雳鲡鳢黧",lian:"俩联莲连镰廉怜涟帘敛脸链恋炼练挛蔹奁潋濂娈琏楝殓臁膦裢蠊鲢",liang:"粮凉梁粱良两辆量晾亮谅墚椋踉靓魉",liao:"撩聊僚疗燎寥辽潦了撂镣廖料蓼尥嘹獠寮缭钌鹩耢",lie:"列裂烈劣猎冽埒洌趔躐鬣",lin:"琳林磷霖临邻鳞淋凛赁吝蔺嶙廪遴檩辚瞵粼躏麟",liu:"溜琉榴硫馏留刘瘤流柳六抡偻蒌泖浏遛骝绺旒熘锍镏鹨鎏",long:"龙聋咙笼窿隆垄拢陇弄垅茏泷珑栊胧砻癃",lou:"楼娄搂篓漏陋喽嵝镂瘘耧蝼髅",lu:"芦卢颅庐炉掳卤虏鲁麓碌露路赂鹿潞禄录陆戮垆摅撸噜泸渌漉璐栌橹轳辂辘氇胪镥鸬鹭簏舻鲈",lv:"驴吕铝侣旅履屡缕虑氯律率滤绿捋闾榈膂稆褛",luan:"峦孪滦卵乱栾鸾銮",lue:"掠略锊",lun:"轮伦仑沦纶论囵",luo:"萝螺罗逻锣箩骡裸落洛骆络倮荦摞猡泺椤脶镙瘰雒",ma:"妈麻玛码蚂马骂嘛吗唛犸嬷杩麽",mai:"埋买麦卖迈脉劢荬咪霾",man:"瞒馒蛮满蔓曼慢漫谩墁幔缦熳镘颟螨鳗鞔",mang:"芒茫盲忙莽邙漭朦硭蟒",meng:"氓萌蒙檬盟锰猛梦孟勐甍瞢懵礞虻蜢蠓艋艨黾",miao:"猫苗描瞄藐秒渺庙妙喵邈缈缪杪淼眇鹋蜱",mao:"茅锚毛矛铆卯茂冒帽貌贸侔袤勖茆峁瑁昴牦耄旄懋瞀蛑蝥蟊髦",me:"么",mei:"玫枚梅酶霉煤没眉媒镁每美昧寐妹媚坶莓嵋猸浼湄楣镅鹛袂魅",men:"门闷们扪玟焖懑钔",mi:"眯醚靡糜迷谜弥米秘觅泌蜜密幂芈冖谧蘼嘧猕獯汨宓弭脒敉糸縻麋",mian:"棉眠绵冕免勉娩缅面沔湎腼眄",mie:"蔑灭咩蠛篾",min:"民抿皿敏悯闽苠岷闵泯珉",ming:"明螟鸣铭名命冥茗溟暝瞑酩",miu:"谬",mo:"摸摹蘑模膜磨摩魔抹末莫墨默沫漠寞陌谟茉蓦馍嫫镆秣瘼耱蟆貊貘",mou:"谋牟某厶哞婺眸鍪",mu:"拇牡亩姆母墓暮幕募慕木目睦牧穆仫苜呒沐毪钼",na:"拿哪呐钠那娜纳内捺肭镎衲箬",nai:"氖乃奶耐奈鼐艿萘柰",nan:"南男难囊喃囡楠腩蝻赧",nao:"挠脑恼闹孬垴猱瑙硇铙蛲",ne:"淖呢讷",nei:"馁",nen:"嫩能枘恁",ni:"妮霓倪泥尼拟你匿腻逆溺伲坭猊怩滠昵旎祢慝睨铌鲵",nian:"蔫拈年碾撵捻念廿辇黏鲇鲶",niang:"娘酿",niao:"鸟尿茑嬲脲袅",nie:"捏聂孽啮镊镍涅乜陧蘖嗫肀颞臬蹑",nin:"您柠",ning:"狞凝宁拧泞佞蓥咛甯聍",niu:"牛扭钮纽狃忸妞蚴",nong:"脓浓农侬",nu:"奴努怒呶帑弩胬孥驽",nv:"女恧钕衄",nuan:"暖",nuenue:"虐",nue:"疟谑",nuo:"挪懦糯诺傩搦喏锘",ou:"哦欧鸥殴藕呕偶沤怄瓯耦",pa:"啪趴爬帕怕琶葩筢",pai:"拍排牌徘湃派俳蒎",pan:"攀潘盘磐盼畔判叛爿泮袢襻蟠蹒",pang:"乓庞旁耪胖滂逄",pao:"抛咆刨炮袍跑泡匏狍庖脬疱",pei:"呸胚培裴赔陪配佩沛掊辔帔淠旆锫醅霈",pen:"喷盆湓",peng:"砰抨烹澎彭蓬棚硼篷膨朋鹏捧碰坯堋嘭怦蟛",pi:"砒霹批披劈琵毗啤脾疲皮匹痞僻屁譬丕陴邳郫圮鼙擗噼庀媲纰枇甓睥罴铍痦癖疋蚍貔",pian:"篇偏片骗谝骈犏胼褊翩蹁",piao:"飘漂瓢票剽嘌嫖缥殍瞟螵",pie:"撇瞥丿苤氕",pin:"拼频贫品聘拚姘嫔榀牝颦",ping:"乒坪苹萍平凭瓶评屏俜娉枰鲆",po:"坡泼颇婆破魄迫粕叵鄱溥珀钋钷皤笸",pou:"剖裒踣",pu:"扑铺仆莆葡菩蒲埔朴圃普浦谱曝瀑匍噗濮璞氆镤镨蹼",qi:"期欺栖戚妻七凄漆柒沏其棋奇歧畦崎脐齐旗祈祁骑起岂乞企启契砌器气迄弃汽泣讫亟亓圻芑萋葺嘁屺岐汔淇骐绮琪琦杞桤槭欹祺憩碛蛴蜞綦綮趿蹊鳍麒",qia:"掐恰洽葜",qian:"牵扦钎铅千迁签仟谦乾黔钱钳前潜遣浅谴堑嵌欠歉佥阡芊芡荨掮岍悭慊骞搴褰缱椠肷愆钤虔箝",qiang:"枪呛腔羌墙蔷强抢嫱樯戗炝锖锵镪襁蜣羟跫跄",qiao:"橇锹敲悄桥瞧乔侨巧鞘撬翘峭俏窍劁诮谯荞愀憔缲樵毳硗跷鞒",qie:"切茄且怯窃郄唼惬妾挈锲箧",qin:"钦侵亲秦琴勤芹擒禽寝沁芩蓁蕲揿吣嗪噙溱檎螓衾",qing:"青轻氢倾卿清擎晴氰情顷请庆倩苘圊檠磬蜻罄箐謦鲭黥",qiong:"琼穷邛茕穹筇銎",qiu:"秋丘邱球求囚酋泅俅氽巯艽犰湫逑遒楸赇鸠虬蚯蝤裘糗鳅鼽",qu:"趋区蛆曲躯屈驱渠取娶龋趣去诎劬蕖蘧岖衢阒璩觑氍祛磲癯蛐蠼麴瞿黢",quan:"圈颧权醛泉全痊拳犬券劝诠荃獾悛绻辁畎铨蜷筌鬈",que:"缺炔瘸却鹊榷确雀阙悫",qun:"裙群逡",ran:"然燃冉染苒髯",rang:"瓤壤攘嚷让禳穰",rao:"饶扰绕荛娆桡",ruo:"惹若弱",re:"热偌",ren:"壬仁人忍韧任认刃妊纫仞荏葚饪轫稔衽",reng:"扔仍",ri:"日",rong:"戎茸蓉荣融熔溶容绒冗嵘狨缛榕蝾",rou:"揉柔肉糅蹂鞣",ru:"茹蠕儒孺如辱乳汝入褥蓐薷嚅洳溽濡铷襦颥",ruan:"软阮朊",rui:"蕊瑞锐芮蕤睿蚋",run:"闰润",sa:"撒洒萨卅仨挲飒",sai:"腮鳃塞赛噻",san:"三叁伞散彡馓氵毵糁霰",sang:"桑嗓丧搡磉颡",sao:"搔骚扫嫂埽臊瘙鳋",se:"瑟色涩啬铩铯穑",sen:"森",seng:"僧",sha:"莎砂杀刹沙纱傻啥煞脎歃痧裟霎鲨",shai:"筛晒酾",shan:"珊苫杉山删煽衫闪陕擅赡膳善汕扇缮剡讪鄯埏芟潸姗骟膻钐疝蟮舢跚鳝",shang:"墒伤商赏晌上尚裳垧绱殇熵觞",shao:"梢捎稍烧芍勺韶少哨邵绍劭苕潲蛸笤筲艄",she:"奢赊蛇舌舍赦摄射慑涉社设厍佘猞畲麝",shen:"砷申呻伸身深娠绅神沈审婶甚肾慎渗诜谂吲哂渖椹矧蜃",sheng:"声生甥牲升绳省盛剩胜圣丞渑媵眚笙",shi:"师失狮施湿诗尸虱十石拾时什食蚀实识史矢使屎驶始式示士世柿事拭誓逝势是嗜噬适仕侍释饰氏市恃室视试谥埘莳蓍弑唑饣轼耆贳炻礻铈铊螫舐筮豕鲥鲺",shou:"收手首守寿授售受瘦兽扌狩绶艏",shu:"蔬枢梳殊抒输叔舒淑疏书赎孰熟薯暑曙署蜀黍鼠属术述树束戍竖墅庶数漱恕倏塾菽忄沭涑澍姝纾毹腧殳镯秫鹬",shua:"刷耍唰涮",shuai:"摔衰甩帅蟀",shuan:"栓拴闩",shuang:"霜双爽孀",shui:"谁水睡税",shun:"吮瞬顺舜恂",shuo:"说硕朔烁蒴搠嗍濯妁槊铄",si:"斯撕嘶思私司丝死肆寺嗣四伺似饲巳厮俟兕菥咝汜泗澌姒驷缌祀祠锶鸶耜蛳笥",song:"松耸怂颂送宋讼诵凇菘崧嵩忪悚淞竦",sou:"搜艘擞嗽叟嗖嗾馊溲飕瞍锼螋",su:"苏酥俗素速粟僳塑溯宿诉肃夙谡蔌嗉愫簌觫稣",suan:"酸蒜算",sui:"虽隋随绥髓碎岁穗遂隧祟蓑冫谇濉邃燧眭睢",sun:"孙损笋荪狲飧榫跣隼",suo:"梭唆缩琐索锁所唢嗦娑桫睃羧",ta:"塌他它她塔獭挞蹋踏闼溻遢榻沓",tai:"胎苔抬台泰酞太态汰邰薹肽炱钛跆鲐",tan:"坍摊贪瘫滩坛檀痰潭谭谈坦毯袒碳探叹炭郯蕈昙钽锬覃",tang:"汤塘搪堂棠膛唐糖傥饧溏瑭铴镗耥螗螳羰醣",thang:"倘躺淌",theng:"趟烫",tao:"掏涛滔绦萄桃逃淘陶讨套挑鼗啕韬饕",te:"特",teng:"藤腾疼誊滕",ti:"梯剔踢锑提题蹄啼体替嚏惕涕剃屉荑悌逖绨缇鹈裼醍",tian:"天添填田甜恬舔腆掭忝阗殄畋钿蚺",tiao:"条迢眺跳佻祧铫窕龆鲦",tie:"贴铁帖萜餮",ting:"厅听烃汀廷停亭庭挺艇莛葶婷梃蜓霆",tong:"通桐酮瞳同铜彤童桶捅筒统痛佟僮仝茼嗵恸潼砼",tou:"偷投头透亠",tu:"凸秃突图徒途涂屠土吐兔堍荼菟钍酴",tuan:"湍团疃",tui:"推颓腿蜕褪退忒煺",tun:"吞屯臀饨暾豚窀",tuo:"拖托脱鸵陀驮驼椭妥拓唾乇佗坨庹沱柝砣箨舄跎鼍",wa:"挖哇蛙洼娃瓦袜佤娲腽",wai:"歪外",wan:"豌弯湾玩顽丸烷完碗挽晚皖惋宛婉万腕剜芄苋菀纨绾琬脘畹蜿箢",wang:"汪王亡枉网往旺望忘妄罔尢惘辋魍",wei:"威巍微危韦违桅围唯惟为潍维苇萎委伟伪尾纬未蔚味畏胃喂魏位渭谓尉慰卫倭偎诿隈葳薇帏帷崴嵬猥猬闱沩洧涠逶娓玮韪軎炜煨熨痿艉鲔",wen:"瘟温蚊文闻纹吻稳紊问刎愠阌汶璺韫殁雯",weng:"嗡翁瓮蓊蕹",wo:"挝蜗涡窝我斡卧握沃莴幄渥杌肟龌",wu:"巫呜钨乌污诬屋无芜梧吾吴毋武五捂午舞伍侮坞戊雾晤物勿务悟误兀仵阢邬圬芴庑怃忤浯寤迕妩骛牾焐鹉鹜蜈鋈鼯",xi:"昔熙析西硒矽晰嘻吸锡牺稀息希悉膝夕惜熄烯溪汐犀檄袭席习媳喜铣洗系隙戏细僖兮隰郗茜葸蓰奚唏徙饩阋浠淅屣嬉玺樨曦觋欷熹禊禧钸皙穸蜥蟋舾羲粞翕醯鼷",xia:"瞎虾匣霞辖暇峡侠狭下厦夏吓掀葭嗄狎遐瑕硖瘕罅黠",xian:"锨先仙鲜纤咸贤衔舷闲涎弦嫌显险现献县腺馅羡宪陷限线冼藓岘猃暹娴氙祆鹇痫蚬筅籼酰跹",xiang:"相厢镶香箱襄湘乡翔祥详想响享项巷橡像向象芗葙饷庠骧缃蟓鲞飨",xiao:"萧硝霄削哮嚣销消宵淆晓小孝校肖啸笑效哓咻崤潇逍骁绡枭枵筱箫魈",xie:"楔些歇蝎鞋协挟携邪斜胁谐写械卸蟹懈泄泻谢屑偕亵勰燮薤撷廨瀣邂绁缬榭榍歙躞",xin:"薪芯锌欣辛新忻心信衅囟馨莘歆铽鑫",xing:"星腥猩惺兴刑型形邢行醒幸杏性姓陉荇荥擤悻硎",xiong:"兄凶胸匈汹雄熊芎",xiu:"休修羞朽嗅锈秀袖绣莠岫馐庥鸺貅髹",xu:"墟戌需虚嘘须徐许蓄酗叙旭序畜恤絮婿绪续讴诩圩蓿怵洫溆顼栩煦砉盱胥糈醑",xuan:"轩喧宣悬旋玄选癣眩绚儇谖萱揎馔泫洵渲漩璇楦暄炫煊碹铉镟痃",xue:"靴薛学穴雪血噱泶鳕",xun:"勋熏循旬询寻驯巡殉汛训讯逊迅巽埙荀薰峋徇浔曛窨醺鲟",ya:"压押鸦鸭呀丫芽牙蚜崖衙涯雅哑亚讶伢揠吖岈迓娅琊桠氩砑睚痖",yan:"焉咽阉烟淹盐严研蜒岩延言颜阎炎沿奄掩眼衍演艳堰燕厌砚雁唁彦焰宴谚验厣靥赝俨偃兖讠谳郾鄢芫菸崦恹闫阏洇湮滟妍嫣琰晏胭腌焱罨筵酽魇餍鼹",yang:"殃央鸯秧杨扬佯疡羊洋阳氧仰痒养样漾徉怏泱炀烊恙蛘鞅",yao:"邀腰妖瑶摇尧遥窑谣姚咬舀药要耀夭爻吆崾徭瀹幺珧杳曜肴鹞窈繇鳐",ye:"椰噎耶爷野冶也页掖业叶曳腋夜液谒邺揶馀晔烨铘",yi:"一壹医揖铱依伊衣颐夷遗移仪胰疑沂宜姨彝椅蚁倚已乙矣以艺抑易邑屹亿役臆逸肄疫亦裔意毅忆义益溢诣议谊译异翼翌绎刈劓佾诒圪圯埸懿苡薏弈奕挹弋呓咦咿噫峄嶷猗饴怿怡悒漪迤驿缢殪贻旖熠钇镒镱痍瘗癔翊衤蜴舣羿翳酏黟",yin:"茵荫因殷音阴姻吟银淫寅饮尹引隐印胤鄞堙茚喑狺夤氤铟瘾蚓霪龈",ying:"英樱婴鹰应缨莹萤营荧蝇迎赢盈影颖硬映嬴郢茔莺萦撄嘤膺滢潆瀛瑛璎楹鹦瘿颍罂",yo:"哟唷",yong:"拥佣臃痈庸雍踊蛹咏泳涌永恿勇用俑壅墉慵邕镛甬鳙饔",you:"幽优悠忧尤由邮铀犹油游酉有友右佑釉诱又幼卣攸侑莸呦囿宥柚猷牖铕疣蝣鱿黝鼬",yu:"迂淤于盂榆虞愚舆余俞逾鱼愉渝渔隅予娱雨与屿禹宇语羽玉域芋郁吁遇喻峪御愈欲狱育誉浴寓裕预豫驭禺毓伛俣谀谕萸蓣揄喁圄圉嵛狳饫庾阈妪妤纡瑜昱觎腴欤於煜燠聿钰鹆瘐瘀窳蝓竽舁雩龉",yuan:"鸳渊冤元垣袁原援辕园员圆猿源缘远苑愿怨院塬沅媛瑗橼爰眢鸢螈鼋",yue:"曰约越跃钥岳粤月悦阅龠樾刖钺",yun:"耘云郧匀陨允运蕴酝晕韵孕郓芸狁恽纭殒昀氲",za:"匝砸杂拶咂",zai:"栽哉灾宰载再在咱崽甾",zan:"攒暂赞瓒昝簪糌趱錾",zang:"赃脏葬奘戕臧",zao:"遭糟凿藻枣早澡蚤躁噪造皂灶燥唣缫",ze:"责择则泽仄赜啧迮昃笮箦舴",zei:"贼",zen:"怎谮",zeng:"增憎曾赠缯甑罾锃",zha:"扎喳渣札轧铡闸眨栅榨咋乍炸诈揸吒咤哳怍砟痄蚱齄",zhai:"摘斋宅窄债寨砦",zhan:"瞻毡詹粘沾盏斩辗崭展蘸栈占战站湛绽谵搌旃",zhang:"樟章彰漳张掌涨杖丈帐账仗胀瘴障仉鄣幛嶂獐嫜璋蟑",zhao:"招昭找沼赵照罩兆肇召爪诏棹钊笊",zhe:"遮折哲蛰辙者锗蔗这浙谪陬柘辄磔鹧褚蜇赭",zhen:"珍斟真甄砧臻贞针侦枕疹诊震振镇阵缜桢榛轸赈胗朕祯畛鸩",zheng:"蒸挣睁征狰争怔整拯正政帧症郑证诤峥钲铮筝",zhi:"芝枝支吱蜘知肢脂汁之织职直植殖执值侄址指止趾只旨纸志挚掷至致置帜峙制智秩稚质炙痔滞治窒卮陟郅埴芷摭帙忮彘咫骘栉枳栀桎轵轾攴贽膣祉祗黹雉鸷痣蛭絷酯跖踬踯豸觯",zhong:"中盅忠钟衷终种肿重仲众冢锺螽舂舯踵",zhou:"舟周州洲诌粥轴肘帚咒皱宙昼骤啄着倜诹荮鬻纣胄碡籀舳酎鲷",zhu:"珠株蛛朱猪诸诛逐竹烛煮拄瞩嘱主著柱助蛀贮铸筑住注祝驻伫侏邾苎茱洙渚潴驺杼槠橥炷铢疰瘃蚰竺箸翥躅麈",zhua:"抓",zhuai:"拽",zhuan:"专砖转撰赚篆抟啭颛",zhuang:"桩庄装妆撞壮状丬",zhui:"椎锥追赘坠缀萑骓缒",zhun:"谆准",zhuo:"捉拙卓桌琢茁酌灼浊倬诼廴蕞擢啜浞涿杓焯禚斫",zi:"兹咨资姿滋淄孜紫仔籽滓子自渍字谘嵫姊孳缁梓辎赀恣眦锱秭耔笫粢觜訾鲻髭",zong:"鬃棕踪宗综总纵腙粽",zou:"邹走奏揍鄹鲰",zu:"租足卒族祖诅阻组俎菹啐徂驵蹴",zuan:"钻纂攥缵",zui:"嘴醉最罪",zun:"尊遵撙樽鳟",zuo:"昨左佐柞做作坐座阝阼胙祚酢",cou:"薮楱辏腠",nang:"攮哝囔馕曩",o:"喔",dia:"嗲",chuai:"嘬膪踹",cen:"岑涔",diu:"铥",nou:"耨",fou:"缶",bia:"髟"}},validation:{isDecimal:function(t){t=t||String(this);var e=/^[0-9]+\.[0-9]+$/;return e.test(t)},isInteger:function(t){t=t||String(this);var e=/^[0-9]+$/;return e.test(t)},isNumber:function(t){t=t||String(this);var e=/^[0-9]+(\.[0-9]+)?$/;return e.test(t)},isQQ:function(t){t=t||String(this);var e=/^[1-9][0-9]{4,10}$/;return e.test(t)},isEnglish:function(t){t=t||String(this);var e=/^[a-zA-Z]+$/;return e.test(t)},isIpV4:function(t){t=t||String(this);var e=/^([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])$/;return e.test(t)},isUrl:function(t,e){t=t||String(this),e=e||!1;var a=/^\b(((https?|ftp):\/\/)?[-a-z0-9]+(\.[-a-z0-9]+)*\.(?:com|edu|gov|int|mil|net|org|biz|info|name|museum|asia|coop|aero|[a-z][a-z]|((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d))\b(\/[-a-z0-9_:\@&?=+,.!\/~%\$]*)?)$/i,n=/^((https?|ftp):\/\/)(www\.)?\S{0,30}\.\S+$/i;return!(!n.test(t)||e)||!(!a.test(t)||!e)},isEmail:function(t){return t=t||String(this),/^([a-zA-Z0-9_-]{1,16})@([a-zA-Z0-9]{1,9})(\.[a-zA-Z0-9]{1,9}){0,3}(\.(?:com|net|org|edu|gov|mil|cn|us)){1,4}$/.test(t)},isContainsSpecialChar:function(t){if(t){var e=RegExp(/[(\s)(\`)(\~)(\!)(\@)(\#)(\$)(\%)(\^)(\&)(\*)(\()(\))(\-)(\_)(\+)(\=)(\[)(\])(\{)(\})(\|)(\\)(\;)(\:)(\')(\")(\,)(\.)(\/)(\<)(\>)(\?)(\)]+/),a=RegExp(/[(\·)(\~)(\！)(\￥)(\%)(\……)(\&)(\*)(\（)(\）)(\——)(\【)(\】)(\；)(\：)(\”)(\“)(\’)(\，)(\《)(\。)(\》)(\？)(\、)(\‘)(\’)]+/);return t=t||String(this),e.test(t)||a.test(t)}return null},isMobile:function(t){t=t||String(this);var e=t.length;return 11==e&&/^1\d{10}$/.test(t)},isTelephone:function(t){return t=t||String(this),null!=t.match(/^(([0\+]\d{2,3}-)?(0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/)},isChinese:function(t){return t=t||String(this),/^[\u4E00-\u9FA5]*$/.test(t)},isCreditCode:function(t){var e=/^[0-9A-Z]+$/;if(18!=t.length||0==e.test(t))return!1;for(var a,n,i=0,r=[1,3,9,27,19,26,16,17,20,29,25,13,8,24,10,30,28],s="0123456789ABCDEFGHJKLMNPQRTUWXY",o=0;o<t.length-1;o++)a=t.substring(o,o+1),n=s.indexOf(a),i+=n*r[o];var l=31-i%31;31==l&&(l=0);var u="0,1,2,3,4,5,6,7,8,9,A,B,C,D,E,F,G,H,J,K,L,M,N,P,Q,R,T,U,W,X,Y",d=u.split(",");l=d[l];var c=t.substring(17,18);return l==c},isBankCard:function(t){if(t=t||String(this),""==t.trim()||void 0==t)return!1;for(var e=t.substr(t.length-1,1),a=t.substr(0,t.length-1),n=new Array,i=a.length-1;i>-1;i--)n.push(a.substr(i,1));for(var r=new Array,s=new Array,o=new Array,l=0;l<n.length;l++)(l+1)%2==1?2*parseInt(n[l])<9?r.push(2*parseInt(n[l])):s.push(2*parseInt(n[l])):o.push(n[l]);for(var u=new Array,d=new Array,c=0;c<s.length;c++)u.push(parseInt(s[c])%10),d.push(parseInt(s[c])/10);for(var p=0,h=0,g=0,f=0,m=0,v=0;v<r.length;v++)p+=parseInt(r[v]);for(var b=0;b<o.length;b++)h+=parseInt(o[b]);for(var y=0;y<u.length;y++)g+=parseInt(u[y]),f+=parseInt(d[y]);m=parseInt(p)+parseInt(h)+parseInt(g)+parseInt(f);var _=parseInt(m)%10==0?10:parseInt(m)%10,D=10-_;return e==D},isIdCard:function(t,e){t=t||String(this);var a=function(){var e,a=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1),n=new Array("1","0","X","9","8","7","6","5","4","3","2"),r=new Array,s=0,o=t.length,l=t;if(15!=o&&18!=o)return!1;for(i=0;i<o;i++){if(r[i]=l.charAt(i),(r[i]<"0"||r[i]>"9")&&17!=i)return!1;i<17&&(r[i]=r[i]*a[i])}if(18==o){var u=l.substring(6,14);if(!/^[0-9]{8}$/.test(u))return!1;h=u.substring(0,4),c=u.substring(4,6),p=u.substring(6,8);var d=[31,28,31,30,31,30,31,31,30,31,30,31];if(h<1700||h>2500)return!1;if((h%4==0&&h%100!=0||h%400==0)&&(d[1]=29),c<1||c>12)return!1;if(p<1||p>d[c-1])return!1;for(i=0;i<17;i++)s+=r[i];if(e=n[s%11],r[17]!=e)return!1}else{var c,p,h,g=l.substring(6,12);if(!/^[0-9]{6}$/.test(g))return!1;if(h=g.substring(0,2),c=g.substring(2,4),p=g.substring(4,6),!/^\d{2}$/.test(h))return!1;if(c<1||c>12)return!1;if(p<1||p>31)return!1}return!0};if(t&&a(t)){if(void 0!=e){var n=void 0,r=0;if(15==t.length?r=t.substring(t.length-1,t.length):18==t.length&&(r=t.substr(t.length-2,1)),n=0==r%2?0:1,e!=n)return!1}return!0}return!1}},security:{uuid:function(t,e){var a,n,i,r;if(a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[],n=void 0,e=e||a.length,t){n=0;while(n<t)r[n]=a[0|Math.random()*e],n++}else{i=void 0,r[8]=r[13]=r[18]=r[23]="-",r[14]="4",n=0;while(n<36)r[n]||(i=0|16*Math.random(),r[n]=a[19===n?3&i|8:i]),n++}return r.join("")},checkerPasswordStrength:function(t){var e=/[^ \f\n\r\t\v\da-zA-Z]/,a=/\d/,n=/[a-zA-Z]/,i=/^[^ \f\n\r\t\v\da-zA-Z]+$/,r=/^\d+$/,s=/^[a-zA-Z]+$/;if(6<=t.length){if(e.test(t)&&a.test(t)&&n.test(t)){if(8>t.length)return{level:"2",desc:"检测提示：您的密码强度较差！"};if(12>t.length)return{level:"3",desc:"检测提示：您的密码强度良好！"};if(15>t.length)return{level:"4",desc:"检测提示：您的密码强度很高！"};if(15<=t.length)return{level:"5",desc:"检测提示：您的密码强度极高！"}}if(e.test(t)&&a.test(t)||e.test(t)&&n.test(t)||a.test(t)&&n.test(t)){if(8>t.length)return{level:"2",desc:"检测提示：您的密码强度较差！"};if(12>t.length)return{level:"3",desc:"检测提示：您的密码强度良好！"};if(15>t.length)return{level:"4",desc:"检测提示：您的密码强度很高！"};if(15<=t.length)return{level:"4",desc:"检测提示：您的密码强度很高！"}}return(i.test(t)||r.test(t)||s.test(t))&&8<=t.length?{level:"2",desc:"检测提示：您的密码强度较差！"}:{level:"1",desc:"检测提示：您的密码过于简单！"}}return{level:"-1",desc:"检测提示：通常您的密码应该在6位以上！"}},random:function(t){var e,a,n=!0;if(t){while(n)if(a=Math.random(),a>.1)return e=Math.floor(a*Math.pow(10,t)),n=!1,e}else while(n)if(a=Math.random(),a>.1)return e=Math.floor(a*Math.pow(10,5)),n=!1,e},randomBetween:function(t,e){var a,n;return t&&e?(n=t+Math.floor(Math.random()*(e-t+1)),n):t||e?t?(a=1e5,n=t+Math.floor(Math.random()*a),n):void 0:(n=Math.floor(1e5*Math.random()),n)},hex_sha256:function(t){var e,a,n,i=function(t,e){return e>>>t|e<<32-t},r=function(t,e,a){return t&e^~t&a},s=function(t,e,a){return t&e^t&a^e&a},o=function(t){return i(2,t)^i(13,t)^i(22,t)},l=function(t){return i(6,t)^i(11,t)^i(25,t)},u=function(t){return i(7,t)^i(18,t)^t>>>3},d=function(t){return i(17,t)^i(19,t)^t>>>10},c=function(t,e){return t[15&e]+=d(t[e+14&15])+t[e+9&15]+u(t[e+1&15])},p=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),h="0123456789abcdef",g=function(t,e){var a=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(a>>16);return n<<16|65535&a},f=function(){e=new Array(8),a=new Array(2),n=new Array(64),a[0]=a[1]=0,e[0]=1779033703,e[1]=3144134277,e[2]=1013904242,e[3]=2773480762,e[4]=1359893119,e[5]=2600822924,e[6]=528734635,e[7]=1541459225},m=function(){var t,a,i,u,d,h,f,m,v,b,y=new Array(16);t=e[0],a=e[1],i=e[2],u=e[3],d=e[4],h=e[5],f=e[6],m=e[7];for(var _=0;_<16;_++)y[_]=n[3+(_<<2)]|n[2+(_<<2)]<<8|n[1+(_<<2)]<<16|n[_<<2]<<24;for(var D=0;D<64;D++)v=m+l(d)+r(d,h,f)+p[D],v+=D<16?y[D]:c(y,D),b=o(t)+s(t,a,i),m=f,f=h,h=d,d=g(u,v),u=i,i=a,a=t,t=g(v,b);e[0]+=t,e[1]+=a,e[2]+=i,e[3]+=u,e[4]+=d,e[5]+=h,e[6]+=f,e[7]+=m},v=function(t,e){var i,r,s=0;r=a[0]>>3&63;var o=63&e;for((a[0]+=e<<3)<e<<3&&a[1]++,a[1]+=e>>29,i=0;i+63<e;i+=64){for(var l=r;l<64;l++)n[l]=t.charCodeAt(s++);m(),r=0}for(l=0;l<o;l++)n[l]=t.charCodeAt(s++)},b=function(){var t=a[0]>>3&63;if(n[t++]=128,t<=56)for(var e=t;e<56;e++)n[e]=0;else{for(e=t;e<64;e++)n[e]=0;m();for(e=0;e<56;e++)n[e]=0}n[56]=a[1]>>>24&255,n[57]=a[1]>>>16&255,n[58]=a[1]>>>8&255,n[59]=255&a[1],n[60]=a[0]>>>24&255,n[61]=a[0]>>>16&255,n[62]=a[0]>>>8&255,n[63]=255&a[0],m()},y=function(){for(var t=new String,a=0;a<8;a++)for(var n=28;n>=0;n-=4)t+=h.charAt(e[a]>>>n&15);return t};return f(),v(t,t.length),b(),y()},base64_decode:function(t){var e,a,n,i,r,s,o,l="",u=0,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=function(t){var e="",a=0,n=c1=c2=0;while(a<t.length)n=t.charCodeAt(a),n<128?(e+=String.fromCharCode(n),a++):n>191&&n<224?(c2=t.charCodeAt(a+1),e+=String.fromCharCode((31&n)<<6|63&c2),a+=2):(c2=t.charCodeAt(a+1),c3=t.charCodeAt(a+2),e+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),a+=3);return e};t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(u<t.length)i=d.indexOf(t.charAt(u++)),r=d.indexOf(t.charAt(u++)),s=d.indexOf(t.charAt(u++)),o=d.indexOf(t.charAt(u++)),e=i<<2|r>>4,a=(15&r)<<4|s>>2,n=(3&s)<<6|o,l+=String.fromCharCode(e),64!=s&&(l+=String.fromCharCode(a)),64!=o&&(l+=String.fromCharCode(n));return l=c(l),l},base64_encode:function(t){var e,a,n,i,r,s,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",a=0;a<t.length;a++){var n=t.charCodeAt(a);n<128?e+=String.fromCharCode(n):n>127&&n<2048?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},d="",c=0;t=u(t);while(c<t.length)e=t.charCodeAt(c++),a=t.charCodeAt(c++),n=t.charCodeAt(c++),i=e>>2,r=(3&e)<<4|a>>4,s=(15&a)<<2|n>>6,o=63&n,isNaN(a)?s=o=64:isNaN(n)&&(o=64),d=d+l.charAt(i)+l.charAt(r)+l.charAt(s)+l.charAt(o);return d},hex_sha1:function(t){var e=0,a=8,n=function(t){for(var a=e?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<4*t.length;i++)n+=a.charAt(t[i>>2]>>8*(3-i%4)+4&15)+a.charAt(t[i>>2]>>8*(3-i%4)&15);return n},i=function(t,e){return t<<e|t>>>32-e},r=function(t,e){t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e;for(var a=Array(80),n=1732584193,r=-271733879,s=-1732584194,d=271733878,c=-1009589776,p=0;p<t.length;p+=16){for(var h=n,g=r,f=s,m=d,v=c,b=0;b<80;b++){a[b]=b<16?t[p+b]:i(a[b-3]^a[b-8]^a[b-14]^a[b-16],1);var y=o(o(i(n,5),l(b,r,s,d)),o(o(c,a[b]),u(b)));c=d,d=s,s=i(r,30),r=n,n=y}n=o(n,h),r=o(r,g),s=o(s,f),d=o(d,m),c=o(c,v)}return Array(n,r,s,d,c)},s=function(t){for(var e=Array(),n=(1<<a)-1,i=0;i<t.length*a;i+=a)e[i>>5]|=(t.charCodeAt(i/a)&n)<<24-i%32;return e},o=function(t,e){var a=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(a>>16);return n<<16|65535&a},l=function(t,e,a,n){return t<20?e&a|~e&n:t<40?e^a^n:t<60?e&a|e&n|a&n:e^a^n},u=function(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514};return n(r(s(t),t.length*a))},hex_md5:function(t){var e=8,a=0,n=function(t,e,a,n,i,r){return c(p(c(c(e,t),c(n,r)),i),a)},i=function(t,e,a,i,r,s,o){return n(e&a|~e&i,t,e,r,s,o)},r=function(t,e,a,i,r,s,o){return n(e&i|a&~i,t,e,r,s,o)},s=function(t,e,a,i,r,s,o){return n(e^a^i,t,e,r,s,o)},o=function(t,e,a,i,r,s,o){return n(a^(e|~i),t,e,r,s,o)},l=function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var a=1732584193,n=-271733879,l=-1732584194,u=271733878,d=0;d<t.length;d+=16){var p=a,h=n,g=l,f=u;a=i(a,n,l,u,t[d+0],7,-680876936),u=i(u,a,n,l,t[d+1],12,-389564586),l=i(l,u,a,n,t[d+2],17,606105819),n=i(n,l,u,a,t[d+3],22,-1044525330),a=i(a,n,l,u,t[d+4],7,-176418897),u=i(u,a,n,l,t[d+5],12,1200080426),l=i(l,u,a,n,t[d+6],17,-1473231341),n=i(n,l,u,a,t[d+7],22,-45705983),a=i(a,n,l,u,t[d+8],7,1770035416),u=i(u,a,n,l,t[d+9],12,-1958414417),l=i(l,u,a,n,t[d+10],17,-42063),n=i(n,l,u,a,t[d+11],22,-1990404162),a=i(a,n,l,u,t[d+12],7,1804603682),u=i(u,a,n,l,t[d+13],12,-40341101),l=i(l,u,a,n,t[d+14],17,-1502002290),n=i(n,l,u,a,t[d+15],22,1236535329),a=r(a,n,l,u,t[d+1],5,-165796510),u=r(u,a,n,l,t[d+6],9,-1069501632),l=r(l,u,a,n,t[d+11],14,643717713),n=r(n,l,u,a,t[d+0],20,-373897302),a=r(a,n,l,u,t[d+5],5,-701558691),u=r(u,a,n,l,t[d+10],9,38016083),l=r(l,u,a,n,t[d+15],14,-660478335),n=r(n,l,u,a,t[d+4],20,-405537848),a=r(a,n,l,u,t[d+9],5,568446438),u=r(u,a,n,l,t[d+14],9,-1019803690),l=r(l,u,a,n,t[d+3],14,-187363961),n=r(n,l,u,a,t[d+8],20,1163531501),a=r(a,n,l,u,t[d+13],5,-1444681467),u=r(u,a,n,l,t[d+2],9,-51403784),l=r(l,u,a,n,t[d+7],14,1735328473),n=r(n,l,u,a,t[d+12],20,-1926607734),a=s(a,n,l,u,t[d+5],4,-378558),u=s(u,a,n,l,t[d+8],11,-2022574463),l=s(l,u,a,n,t[d+11],16,1839030562),n=s(n,l,u,a,t[d+14],23,-35309556),a=s(a,n,l,u,t[d+1],4,-1530992060),u=s(u,a,n,l,t[d+4],11,1272893353),l=s(l,u,a,n,t[d+7],16,-155497632),n=s(n,l,u,a,t[d+10],23,-1094730640),a=s(a,n,l,u,t[d+13],4,681279174),u=s(u,a,n,l,t[d+0],11,-358537222),l=s(l,u,a,n,t[d+3],16,-722521979),n=s(n,l,u,a,t[d+6],23,76029189),a=s(a,n,l,u,t[d+9],4,-640364487),u=s(u,a,n,l,t[d+12],11,-421815835),l=s(l,u,a,n,t[d+15],16,530742520),n=s(n,l,u,a,t[d+2],23,-995338651),a=o(a,n,l,u,t[d+0],6,-198630844),u=o(u,a,n,l,t[d+7],10,1126891415),l=o(l,u,a,n,t[d+14],15,-1416354905),n=o(n,l,u,a,t[d+5],21,-57434055),a=o(a,n,l,u,t[d+12],6,1700485571),u=o(u,a,n,l,t[d+3],10,-1894986606),l=o(l,u,a,n,t[d+10],15,-1051523),n=o(n,l,u,a,t[d+1],21,-2054922799),a=o(a,n,l,u,t[d+8],6,1873313359),u=o(u,a,n,l,t[d+15],10,-30611744),l=o(l,u,a,n,t[d+6],15,-1560198380),n=o(n,l,u,a,t[d+13],21,1309151649),a=o(a,n,l,u,t[d+4],6,-145523070),u=o(u,a,n,l,t[d+11],10,-1120210379),l=o(l,u,a,n,t[d+2],15,718787259),n=o(n,l,u,a,t[d+9],21,-343485551),a=c(a,p),n=c(n,h),l=c(l,g),u=c(u,f)}return Array(a,n,l,u)},u=(n=function(t,e,a,n,i,r){return c(p(c(c(e,t),c(n,r)),i),a)},function(t){for(var e=a?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<4*t.length;i++)n+=e.charAt(t[i>>2]>>i%4*8+4&15)+e.charAt(t[i>>2]>>i%4*8&15);return n}),d=function(t){for(var a=Array(),n=(1<<e)-1,i=0;i<t.length*e;i+=e)a[i>>5]|=(t.charCodeAt(i/e)&n)<<i%32;return a},c=function(t,e){var a=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(a>>16);return n<<16|65535&a},p=function(t,e){return t<<e|t>>>32-e};return u(l(d(t),t.length*e))}},extention:{extend:function(){var t,e,a,n,i,r,s=arguments[0]||{},o=1,l=arguments.length,u=!1;for("boolean"===typeof s&&(u=s,s=arguments[1]||{},o=2),Mtils.isObject(s)||(s={});o<l;o++)if(null!=(i=arguments[o]))for(n in i)t=s[n],a=i[n],s!==a&&(u&&a&&(jQuery.isPlainObject(a)||(e=jQuery.isArray(a)))?(e?(e=!1,r=t&&jQuery.isArray(t)?t:[]):r=t&&jQuery.isPlainObject(t)?t:{},s[n]=jQuery.extend(u,r,a)):void 0!==a&&(s[n]=a));return s},includes:function(t,e){return 1==arguments.length&&Mtils.extention!==this?(e=t,-1!==this.indexOf(e)):2===arguments.length?-1!==t.indexOf(e):void 0},strToJson:function(t){return new Function("return "+t)()},now:function(t){var e=null,a=null;if("file:"!=location.protocol){try{a=new ActiveXObject("microsoft.xmlhttp")}catch(n){try{a=new XMLHttpRequest}catch(i){console.log("你的浏览器中不支持异步对象，请换浏览器")}}a.open("HEAD",location.href,!1),a.send(null),e=a.getResponseHeader("Date")}else e=(new Date).getTime();return e?(e=new Date(e).getTime(),t?Mtils.extention.formatDate(e,t):e):null},accAdd:function(t,e){var a,n,i,r;try{a=t.toString().split(".")[1].length}catch(o){a=0}try{n=e.toString().split(".")[1].length}catch(o){n=0}if(r=Math.abs(a-n),i=Math.pow(10,Math.max(a,n)),r>0){var s=Math.pow(10,r);a>n?(t=Number(t.toString().replace(".","")),e=Number(e.toString().replace(".",""))*s):(t=Number(t.toString().replace(".",""))*s,e=Number(e.toString().replace(".","")))}else t=Number(t.toString().replace(".","")),e=Number(e.toString().replace(".",""));return(t+e)/i},accSub:function(t,e){var a,n,i,r;try{a=t.toString().split(".")[1].length}catch(s){a=0}try{n=e.toString().split(".")[1].length}catch(s){n=0}return i=Math.pow(10,Math.max(a,n)),r=a>=n?a:n,((t*i-e*i)/i).toFixed(r)},accMul:function(t,e){var a=0,n=t.toString(),i=e.toString();try{a+=n.split(".")[1].length}catch(r){}try{a+=i.split(".")[1].length}catch(r){}return Number(n.replace(".",""))*Number(i.replace(".",""))/Math.pow(10,a)},accDiv:function(t,e){var a,n,i=0,r=0;try{i=t.toString().split(".")[1].length}catch(s){}try{r=e.toString().split(".")[1].length}catch(s){}return a=Number(t.toString().replace(".","")),n=Number(e.toString().replace(".","")),a/n*Math.pow(10,r-i)},formatDate:function(t,e){this!==Mtils.extention?(e=t||"yyyy-MM-dd",t=this):e=e||"yyyy-MM-dd";var a=new Date(t),n={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return e},uniqueArray:function(t){var e=t||this;if(void 0===e||null===e||0===e.length)return[];e.sort();for(var a=[e[0]],n=1;n<e.length;n++)e[n]!==a[a.length-1]&&a.push(e[n]);return a},rtrim:function(t){return t=t||String(this),t.replace(/(\s*|　*)$/,"")},ltrim:function(t){return t=t||String(this),t.replace(/^(\s*|　*)/,"")},atrim:function(t){return t=t||String(this),t.replace(/\s+/g,"")},replaceAll:function(t,e,a){return this!==Mtils.extention&&(a=e,e=t,t=this),t.replace(new RegExp(e,"gm"),a)},isObject:function(t){return null!==t&&"[object Object]"===Mtils.utils.getVarType(t)},isWindow:function(t){return t&&t.window===t},isFile:function(t){return"[object File]"===Mtils.utils.getVarType(t)},isFormData:function(t){return"[object FormData]"===Mtils.utils.getVarType(t)},isRegExp:function(t){return"[object RegExp]"===Mtils.utils.getVarType(t)},isArray:Array.isArray,isNaN:function(t){return Mtils.isNumber(t)&&t!==t},isNumber:function(t){return"[object Number]"===Mtils.utils.getVarType(t)},isFunction:function(t){return"[object Function]"===Mtils.utils.getVarType(t)},isDate:function(t){return"[object Date]"===Mtils.utils.getVarType(t)},isString:function(t){return"[object String]"===Mtils.utils.getVarType(t)}},browser:{version:function(){var t=navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Firefox")>-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")>-1,weChat:t.indexOf("MicroMessenger")>-1}},getUrlParam:function(t){var e=new Object;if(t){var a=t.split("?")[1];if(a){a=a.split("&");for(var n=0;n<a.length;n++)e[a[n].split("=")[0]]=a[n].split("=")[1]}}else{a=location.search.substring(1);if(a){a=a.split("&");for(n=0;n<a.length;n++)e[a[n].split("=")[0]]=a[n].split("=")[1]}}return e},delAllCookie:function(){try{var t=document.cookie.match(/[^ =;]+(?=\=)/g);if(t)for(var e=0;e<t.length;e++)document.cookie=t[e]+"=null;path=/;expires="+new Date(0).toGMTString()}catch(a){return!1}return!0},delCookie:function(t){try{var e=new Date;e.setTime(e.getTime()-1e4),document.cookie=t+"=null;path=/;expires="+e.toGMTString()+";"}catch(a){return!1}return!0},setCookie:function(t,e,a){var n=new Date;try{n.setTime(n.getTime()+60*a*1e3),document.cookie=a?t+"="+decodeURIComponent(e)+";path=/;expires="+n.toGMTString()+";":t+"="+decodeURIComponent(e)+";path=/;"}catch(i){return!1}return!0},getCookie:function(t){var e=document.cookie.match(new RegExp("(^| )"+t+"=([^;]*)(;|$)"));return null!=e?decodeURI(e[2]):null}},utils:{clearEmpty:function(){var t,e,a,n=arguments[0]||this,i=[];if(!Mtils.isObject(n)&&!Mtils.isArray(n))return n;if(Mtils.isObject(n))for(t in n)Mtils.isEmpty(n[t])?Reflect&&Reflect.deleteProperty?Reflect.deleteProperty(n,t):delete n[t]:(Mtils.isObject(n)||Mtils.isArray(n))&&Mtils.utils.clearEmpty(n[t]);if(Mtils.isArray(n)){for(i=[],e=0,a=n.length;e<a;e++)Mtils.isEmpty(n[e])||i.push(n[e]);n=i}return n},getById:function(t,e){var a,n=[],i=this,r=[],s=[];e=e||"id";return Mtils.isEmpty(t)?n[0]:(Mtils.isArray(t)?r=r.concat(t):r.push(t),r.forEach((function(t){a={},Mtils.isObject(t)&&t[e]&&(a[e]=t[e],s.push(a)),(Mtils.isString(t)||Mtils.isNumber(t))&&(a[e]=t,s.push(a))})),n=Mtils.findInArray(s,i),Mtils.isArray(t)?n:n[0])},findInArray:function(t,e,a){var n,i,r=[],s=[];return e=e||this,void 0===t&&(r=e),Array.isArray(e)?(Mtils.isArray(t)?s=s.concat(t):s.push(t),s.forEach((function(t){Mtils.isObject(t)&&(n=Object.keys(t)),r=r.concat(e.filter((function(e){if(typeof e===typeof t)if(Mtils.isString(t)){if(!0===a){if(i=new RegExp(t),i.test(e))return!0}else if(e===t)return!0}else if(Mtils.isObject(t)){if(n.every((function(n){if(!0===a&&Mtils.isString(e[n])&&Mtils.isString(t[n])){if(i=new RegExp(t[n]),i.test(e[n]))return!0}else if(e[n]===t[n])return!0})))return!0}else if(e===t)return!0})))})),r):r},isDefined:function(t){return"undefined"!==typeof t},cache:function(t,e,a){if(!(t&&e&&arguments.length>1)){n=localStorage.mtilsData||"{}";return n=JSON.parse(n),n[t]}var n=localStorage.mtilsData||"{}";n=JSON.parse(n),!a&&Mtils.utils.isObject(e)&&e[t]&&!n[e[t]]?n[e[t]]=e:a&&(n[e[a]]=e),n[t]=e,localStorage.mtilsData=JSON.stringify(n)},copy:function(t){return JSON.parse(JSON.stringify(t))},ChainCallManager:function(){var t=function(){this.methodsRunIndex=0,this.methods=[],this.autoCall=!1,this.next=this.callNext=function(t){return this.autoCall||(this.methodsRunIndex++,this.methods[this.methodsRunIndex]&&this.methods[this.methodsRunIndex].call(this,t)),this},this.then=function(t){return t&&"function"===typeof t&&this.methods.push(t),this},this.start=function(t){this.autoCall=!1,this.methods[this.methodsRunIndex].call(this,t)},this.run=function(t){var e=t||void 0;this.autoCall=!0;for(var a=0;a<this.methods.length;a++)this.methodsRunIndex=a,e=this.methods[this.methodsRunIndex].call(this,e)}};return new t},makeMap:function(t,e){var a,n={},i=Mtils.extention.trim(t).split(",");for(a=0;a<i.length;a++)n[i[a]]=e;return n},getVarType:function(t){return Object.prototype.toString.call(t)},isEmpty:function(t){return void 0===t||(null===t||(!!Mtils.isNaN(t)||(!(!Mtils.isString(t)||0!==t.length)||(!(!Mtils.isArray(t)||0!==t.length)||!(!Mtils.isObject(t)||0!==Object.keys(t).length)))))},extractPropertyValuesInArray:function(t,e,a){var n=[];if(t&&Array.isArray(t))for(var i,r=0;r<t.length;r++)i=t[r],e&&"object"==typeof i?i[e]?n.push(i[e]):void 0!=a&&n.push(a):i?n.push(String(i)):void 0!=a&&n.push(a);return n},decimalConversion:function(t,e,a){var n,i=Mtils.constant.BASE_DECIMAL,r=0,s="";if(void 0==t||!String(t).replace(/ /gi,""))return"";if(!e)return"";try{e&&(e=Number(e)),a&&(a=Number(a)),n=String(t);for(var o=0,l=1;o<n.length;o++,l++)r+=i.indexOf(n.charAt(o))*Math.pow(e,n.length-l);if("10"==a||!a)return r;while(0!=r)n=r%a,s=i.charAt(n)+s,r=(r-n)/a;return s}catch(u){return console.log(u),""}},makePy:function(t,e){var a,n,i,r,s,o,l="";for(e=e||!1,o=Mtils.constant.PY_MAPS,a=0;a<t.length;a++){for(i in n=t.substr(a,1),r=!1,o)if(Mtils.extention.isString(o[i])&&-1!=o[i].indexOf(n)){s=i.substr(0,1).toUpperCase(),l+=1==e?s:s+i.substr(1,i.length).toLowerCase(),r=!0;break}r||(l+=n)}return l},calcAge:function(t,e){if(e=e||new Date,t&&e)try{var a;return"string"!==typeof t&&"number"!==typeof e||(t=new Date(t)),"string"!==typeof e&&"number"!==typeof e||(e=new Date(e)),a=e.getFullYear()-t.getFullYear(),0>=a?a=0:0<a&&(t.getMonth()==e.getMonth()?t.getDate()>e.getDate()&&a--:t.getMonth()>=e.getMonth()&&a--),a+""}catch(n){return console.log("Invalid Date, please input like '1992-08-12' or '1992/12/12'"),""}return""},setObjectPropertyVal:function(obj,propName,propVal,isCreate){if(obj&&propName)if(propName.length>0&&"object"==typeof obj){for(var props=propName.split("."),varStr="obj",i=0,attr;i<props.length;i++)if(attr=props[i],varStr+="."+attr,isCreate)try{void 0==eval(varStr)&&eval(varStr+"={}")}catch(e){console.log(e)}varStr+="=propVal";try{eval(varStr)}catch(e){console.log(e)}}else console.log("obj is not object or propName not value");else console.log("params error")},getObjectPropertyVal:function(obj,propName,defaultVal){if(obj&&propName)if(propName.length>0&&"object"==typeof obj){for(var props=propName.split("."),varStr="obj",i=0;i<props.length;i++)if(varStr+="."+props[i],null!=defaultVal||void 0!=defaultVal)try{if(void 0==eval(varStr))return defaultVal}catch(e){console.log(e)}try{var tmp=eval(varStr);return null==tmp||void 0==tmp?defaultVal:tmp}catch(e){console.log(e)}}else console.log("obj is not object or propName not value");else console.log("params error")},getByteLength:function(t){if(t=t||String(this),Mtils.utils.isString(t)){var e=0,a=0;if(t)for(var n=0;n<t.length;n++)null!=t.substring(n,n+1).match(/[^\x00-\xff]/gi)?e+=1:a+=1;return 2*e+a}return 0},formatMoney:function(e,a){a=a>0&&a<=20?a:2,e=parseFloat((e+"").replace(/[^\d\.-]/g,"")).toFixed(a)+"";var n=e.split(".")[0].split("").reverse(),r=e.split(".")[1];for(t="",i=0;i<n.length;i++)t+=n[i]+((i+1)%3==0&&i+1!=n.length?",":"");return t.split("").reverse().join("")+"."+r},strIntro:function(t,e){return t.length>e?t.substr(0,e)+"...":t}}};return window.ChainCallManager=Mtils.ChainCallManager=Mtils.utils.ChainCallManager,window.isDefined=Mtils.isDefined=Mtils.utils.isDefined,window.isEmpty=Mtils.isEmpty=Mtils.utils.isEmpty,window.strToJson=Mtils.strToJson=Mtils.extention.strToJson,Mtils.copy=Mtils.utils.copy,Mtils.cache=Mtils.utils.cache,Mtils.makeMap=Mtils.utils.makeMap,Mtils.extend=Mtils.extention.extend,Mtils.findInArray=Mtils.utils.findInArray,Mtils.getById=Mtils.utils.getById,Mtils.isObject=Mtils.extention.isObject,Mtils.isArray=Mtils.extention.isArray,Mtils.isNaN=Mtils.extention.isNaN,Mtils.isString=Mtils.extention.isString,Mtils.isDate=Mtils.extention.isDate,Mtils.isFunction=Mtils.extention.isFunction,Mtils.isNumber=Mtils.extention.isNumber,Mtils.isWindow=Mtils.extention.isWindow,Mtils.isFile=Mtils.extention.isFile,Mtils.isFormData=Mtils.extention.isFormData,Mtils.isRegExp=Mtils.extention.isRegExp,Mtils.unique=Mtils.extention.uniqueArray,Mtils.includes=Mtils.extention.includes,Mtils.clearEmpty=Mtils.utils.clearEmpty,Mtils.uuid=Mtils.security.uuid,Mtils.isEmpty(Math)||(Math.accAdd=Mtils.extention.accAdd),Mtils.isEmpty(Math)||(Math.accSub=Mtils.extention.accSub),Mtils.isEmpty(Math)||(Math.accMul=Mtils.extention.accMul),Mtils.isEmpty(Math)||(Math.accDiv=Mtils.extention.accDiv),Mtils.isEmpty(Date.prototype.formatDate)&&(Date.prototype.formatDate=Date.prototype.format=Mtils.extention.formatDate),Mtils.isEmpty(Date.prototype.now)&&(Date.prototype.now=Mtils.now=Mtils.extention.now),Mtils.isEmpty(String.prototype.rtrim)&&(String.prototype.rtrim=Mtils.extention.rtrim),Mtils.isEmpty(String.prototype.ltrim)&&(String.prototype.ltrim=Mtils.extention.ltrim),Mtils.isEmpty(String.prototype.atrim)&&(String.prototype.atrim=Mtils.extention.atrim),Mtils.isEmpty(String.prototype.replaceAll)&&(String.prototype.replaceAll=Mtils.extention.replaceAll),Mtils.isEmpty(String.prototype.includes)&&(String.prototype.includes=Mtils.extention.includes),Mtils}var myModule=Mtils();module.exports=myModule}).call(this||("undefined"!==typeof window?window:global))}).call(this,__webpack_require__("532c"))},eead:function(t,e,a){"use strict";a("b4fb"),a("fe59"),a("053b"),a("08ba");var n=a("f7f9"),i=a("e8d2");e["a"]={regulars:[{id:1,name:"域名",rule:/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/},{id:2,name:"网址",rule:/^(?=^.{3,255}$)(http(s)?:\/\/)?(www\.)?[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:\d+)*(\/\w+\.\w+)*([\?&]\w+=\w*)*$/},{id:3,name:"字母",rule:/^([a-z][A-Z])+$/},{id:4,name:"手机号",rule:/^1[0-9]{10}$/},{id:5,name:"邮箱",rule:/^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/},{id:6,name:"身份证",rule15:/^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}$/,rule18:/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/},{id:7,name:"银行卡",rule:/^([1-9]{1})(\d{11}|\d{15}|\d{16}|\d{17}|\d{18})$/}],checkRegular:function(t,e){var a="";this.regulars.forEach((function(n){if(n.id==e)if(6==n.id)switch(t.length){case 15:a=n.rule15;break;case 18:a=n.rule18;break;default:return!1}else a=n.rule}));try{if(a&&a.test(t))return!0}catch(n){}return!1},checkValue:function(t){if(t)return this[t.type]?this[t.type](t):"object"==Object(n["a"])(t.data)?!$.isEmptyObject(t.data):!!t.data},dUserSearch:function(t){return t.data&&t.data.uid&&t.data.name},dCalendar:function(t){return"object"==Object(n["a"])(t.data)?t.data instanceof Date:!!t.data},dCountry:function(t){return t.data&&t.data.id&&t.data.name},dCountryV2:function(t){return t.data&&t.data.length},dOpinion:function(t){return t.data&&t.data.date&&t.data.option},dRegion:function(t){return!!t.data.address},dShow:function(t){return t.data&&t.data.id},dCount:function(t){return t.data&&""!==t.data.value},dMultiple:function(t){return t.data.length},dRepeatTable:function(t,e){var a=t.data?t.data:[],n=(a.length&&a[0],[]),r=this;return a.forEach((function(a,s){var o=[],l=!1;for(var u in a){var d=!!e[u]&&e[u];d&&(d=i["a"].copyObj(d),d.data=a[u],d&&r.checkValue(d)&&(l=!0),d&&d.status.required&&!r.checkValue(d)&&o.push({error:"必须填写",key:u,row:s,type:"require"}))}(l||t.status.required)&&(n=n.concat(o))})),n},dRadio:function(t){return t.data.value},dSelect:function(t){return t.data.value},dSelectV2:function(t){return t.data.length},dSync:function(t){return t.data&&t.data.id&&t.data.name}}},efc5:function(t,e,a){"use strict";var n=a("46c1"),i=a.n(n);i.a},f1ac:function(t,e){},f30b:function(t,e,a){"use strict";var n=a("5a9e"),i=a("45af").includes,r=n.aTypedArray,s=n.exportTypedArrayMethod;s("includes",(function(t){return i(r(this),t,arguments.length>1?arguments[1]:void 0)}))},f477:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.START_BIN="1010",e.END_BIN="11101",e.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]},f55f:function(t,e,a){"use strict";var n=a("fb5c"),i=a.n(n);i.a},f62cd:function(t,e,a){"use strict";(function(e){var a=[],n="",i=/^on/;for(n in e)i.test(n)&&a.push(n.slice(2));t.exports=a}).call(this,a("532c"))},f69e:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("fe59"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("b130"),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("ecb4"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("2eeb"),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("053b"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("513c"),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("e18c"),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_regexp_constructor__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("84c2"),core_js_modules_es_regexp_constructor__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_regexp_constructor__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("e35a"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("1c2e"),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("90aa"),core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("5e9f"),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("0d7a"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("08ba"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_13__),mathjs__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("25f0"),mathjs__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(mathjs__WEBPACK_IMPORTED_MODULE_14__),js_md5__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("897d"),js_md5__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(js_md5__WEBPACK_IMPORTED_MODULE_15__),_form_controller_plugins_pluginValidate__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("eead"),moment__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("35f4e"),moment__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_17__),_form_helpers_moneyToCapital__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("3412");mathjs__WEBPACK_IMPORTED_MODULE_14___default.a.config({number:"BigNumber",precision:20});var countObj={plugin:{},methods:[{name:"日期年差",description:"两个时间的年数相减，时间组件必须是日期时间或日期，示例：dateYearMinus($time1, $time2)",methodName:"dateYearMinus"},{name:"日期月差",description:"两个时间的月数相减，时间组件必须是日期时间或日期，示例：dateMonthMinus($time1, $time2)",methodName:"dateMonthMinus"},{name:"日期日差",description:"两个时间的天数相减，时间组件必须是日期时间或日期，示例：dateDayMinus($time1, $time2)",methodName:"dateDayMinus"},{name:"字符串转数字",description:"将字符串转为数字，非数字时间戳不可转化，示例：toNumber($str)",methodName:"toNumber"},{name:"数字运算",description:"解决js精度计算问题，支持+、-、*、、四则运算示例：mathPrecision($num1, '+', $num2)",methodName:"mathPrecision"},{name:"重复表为空",description:"判断重复表是否为空 repeatTableIsEmpty(pluginData)",methodName:"repeatTableIsEmpty"},{name:"数据变动",description:"判断数据相对于初始数据是否变动， dataChange(pluginData, 'pluginkey')",methodName:"dataChange"},{name:"日期日差排除六日",description:"两个时间的天数相减，时间组件必须是日期时间或日期，示例：dateDayMinusSaturday($time1, $time2)",methodName:"dateDayMinusSaturday"},{name:"日期转星期",description:"将日期格式转为星期，时间组件必须是日期时间或日期，周一至周日对应为1~7，示例：toWeek($time)",methodName:"toWeek"},{name:"是否存在复选框内",description:"判断复选框内是否存在某值，存在:1,不存在:2，示例：inCheckBox(pluginData,$data)",methodName:"inCheckBox"},{name:"是否存在重复表内",description:"判断重复表内是否存在某值，存在:1,不存在:2，示例：inRepeaTable(pluginData,'pluginkey',$data)",methodName:"inRepeaTable"},{name:"获取文本长度",description:"解决使用length文本长度不准确，实例：getPostWordCount(pluginData)",methodName:"getPostWordCount"},{name:"小写金额转大写",description:"把小写金额转换成大写显示，示例：moneyToCapital(pluginData)",methodName:"moneyToCapital"}],changeData:{},getStrByKey:function(t,e){var a=this.getPrefix(e);return"{"+a+"_"+t+"}"},getKeyByStr:function(t,e){var a=this.getPrefix(e);t=t.replace(a+"_","")},getPrefix:function(t){return"plugin"==t?"p":"f"},checkFormula:function(t,e){for(var a in e)t=t.replace(new RegExp(a,"g"),"");if(-1!==t.indexOf("{")){var n=t.split("{")[1];return"{"+n}return!1},getResult:function getResult(formulaStr,keyVal,plugin){var _this=this;for(var key in this.plugin=plugin,this.keyVal=keyVal,keyVal){var keys=key.toString().split("_");switch(keys[0]){case"Checkbox":this.keyVal[key]instanceof Array&&(this.keyVal[key]=this.keyVal[key].map((function(t){return t.value})));break;case"Count":case"Select":case"Radio":this.keyVal[key]=this.keyVal[key].value;break;case"CountryV2":this.keyVal[key]=this.keyVal[key].map((function(t){return t.name}));break}-1!==key.indexOf("{")&&(formulaStr=formulaStr.replace(new RegExp(key,"g"),keyVal[key]))}formulaStr=formulaStr.replace(new RegExp("&amp;","g"),"&");try{return eval("("+formulaStr+")")}catch($error){"undefined"!==typeof debugCount&&console.log($error.message)}},getFuncResult:function getFuncResult(formulaStr,functionStr,keyVal,plugin,formId){var _this=this,funcName="_this.function"+js_md5__WEBPACK_IMPORTED_MODULE_15___default()(Math.random().toString());functionStr=funcName+"="+functionStr,this.formId=formId;try{eval("("+functionStr+")"),formulaStr=formulaStr.replace(new RegExp(/\$selfFunction/,"g"),funcName);var result=this.getResult(formulaStr,keyVal,plugin);return eval("(delete "+funcName+")"),result}catch($error){console.log($error.message)}},getDate:function(t){return new Date(t)},dataChange:function(t,e){return void 0!==this.changeData[e]?this.changeData[e]!=t:(this.changeData[e]=t,!1)},repeatTableIsEmpty:function(t){if(!(t instanceof Array))return!1;for(var e in t){var a=t[e];for(var n in a){var i=this.plugin.rtplugins[n];if(i.data=a[n],_form_controller_plugins_pluginValidate__WEBPACK_IMPORTED_MODULE_16__["a"].checkValue(i))return!1}}return!0},mathPrecision:function(t,e,a){for(var n="",i=0;i<arguments.length;i++)n+=arguments[i]+" ";return["+","-","*","/"].includes(e)?"/"===e&&0==a?0:+mathjs__WEBPACK_IMPORTED_MODULE_14___default.a.eval(n):""},dateYearMinus:function(t,e){return t=t.toString(),e=e.toString(),t=this.getDate(t),e=this.getDate(e),e.getFullYear()-t.getFullYear()},dateMonthMinus:function(t,e){return t=t.toString(),e=e.toString(),t=this.getDate(t),e=this.getDate(e),12*e.getFullYear()+e.getMonth()-(12*t.getFullYear()+t.getMonth())},toWeek:function(t){var e=this.getDate(t.toString()).getDay();return 0==e?7:e},inCheckBox:function(t,e){return t.map((function(t){return String(t)})).includes(String(e))?1:2},inRepeaTable:function(t,e,a){var n=2;return t.forEach((function(t){String(t[e])==String(a)&&(n=1)})),n},dateDayMinusSaturday:function(t,e){var a=moment__WEBPACK_IMPORTED_MODULE_17___default()(e).diff(moment__WEBPACK_IMPORTED_MODULE_17___default()(t)),n=moment__WEBPACK_IMPORTED_MODULE_17___default.a.duration(a),i=n.asDays()+1,r=Math.floor(n.asWeeks()),s=moment__WEBPACK_IMPORTED_MODULE_17___default()(t).add(7*r,"days").format("YYYY-MM-DD"),o=moment__WEBPACK_IMPORTED_MODULE_17___default()(e).add(7*r,"days").format("YYYY-MM-DD"),l=2*r;if(t==e)return[0,1].includes(new Date(t).getDay())||null==t?0:1;if(s!==t){var u=moment__WEBPACK_IMPORTED_MODULE_17___default()(s).format("d"),d=moment__WEBPACK_IMPORTED_MODULE_17___default()(o).format("d");if(r<1&&u>d)return i-l-2;"6"===u?(l++,d>=0&&l++):"0"===u&&(l++,"6"===d&&l++)}else{var c=moment__WEBPACK_IMPORTED_MODULE_17___default()(s).format("d");"0"!==c&&"6"!==c||l++}return 6==new Date(e).getDay()&&l++,i-l},dateDayMinus:function(t,e){return t=t.toString(),e=e.toString(),t=this.getDate(t),e=this.getDate(e),Math.ceil((e.getTime()-t.getTime())/864e5)},toNumber:function(t){return isNaN(t)?t:Number(t)},getPostWordCount:function(t){var e=0;try{t=t.replace(/(\r\n+|\s+|　+)/g,"龘"),t=t.replace(/[\x00-\xff]/g,"m"),t=t.replace(/m+/g,"*"),t=t.replace(/龘+/g,""),e=t.length}catch(a){}return console.log(e),e},moneyToCapital:function(t){var e=t.replace(/\,/g,"");if(!isNaN(+e))return e?Object(_form_helpers_moneyToCapital__WEBPACK_IMPORTED_MODULE_18__["a"])(e):""}};__webpack_exports__["a"]=countObj},f74a:function(t,e,a){"use strict";var n=a("5a9e"),i=n.aTypedArray,r=n.exportTypedArrayMethod,s=[].join;r("join",(function(t){return s.apply(i(this),arguments)}))},f7f2:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MSI1110=e.MSI1010=e.MSI11=e.MSI10=e.MSI=void 0;var n=a("2d01"),i=h(n),r=a("3f17"),s=h(r),o=a("a4f9"),l=h(o),u=a("8b80"),d=h(u),c=a("88ab"),p=h(c);function h(t){return t&&t.__esModule?t:{default:t}}e.MSI=i.default,e.MSI10=s.default,e.MSI11=l.default,e.MSI1010=d.default,e.MSI1110=p.default},fa41:function(t,e,a){"use strict";var n=a("3553"),i=a("e1d6"),r=a("d88d");t.exports=function(t){var e=n(this),a=r(e.length),s=arguments.length,o=i(s>1?arguments[1]:void 0,a),l=s>2?arguments[2]:void 0,u=void 0===l?a:i(l,a);while(u>o)e[o++]=t;return e}},fb5c:function(t,e,a){},fc6e:function(t,e,a){"use strict";var n=a("5a9e"),i=a("5dfd").forEach,r=n.aTypedArray,s=n.exportTypedArrayMethod;s("forEach",(function(t){i(r(this),t,arguments.length>1?arguments[1]:void 0)}))},fd11:function(t,e,a){"use strict";var n=a("1c8b"),i=a("5197"),r=a("0496");n({target:"String",proto:!0,forced:r("bold")},{bold:function(){return i(this,"b","","")}})},ffbb:function(t,e,a){"use strict";var n=a("ebc3"),i=a.n(n);i.a}}]);